//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_f "github.com/unidoc/unioffice/common/logger";_eec "github.com/unidoc/unioffice/common/tempstorage";_eee "github.com/unidoc/unioffice/internal/convertutils";_cf "github.com/unidoc/unioffice/measurement";_cg "github.com/unidoc/unioffice/schema/soo/dml";
_ba "github.com/unidoc/unioffice/schema/soo/dml/chart";_g "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_ee "github.com/unidoc/unioffice/schema/soo/sml";_c "github.com/unidoc/unioffice/spreadsheet";_bd "github.com/unidoc/unioffice/spreadsheet/formula";
_ab "github.com/unidoc/unioffice/spreadsheet/reference";_a "github.com/unidoc/unipdf/v3/creator";_af "github.com/unidoc/unipdf/v3/model";_e "image";_d "math";_bb "strconv";);

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_eee .FontStyle ;func (_ged *convertContext )imageFromAnchor (_ace *anchor ,_eaf ,_abee float64 )_e .Image {if _ace ._cgbd !=nil {return _ace ._cgbd ;};if _ace ._edea !=nil {_abb ,_cae :=_eee .MakeImageFromChartSpace (_ace ._edea ,_eaf ,_abee ,_ged ._efc ,_ged ._gdg );
if _cae !=nil {_f .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_cae );return nil ;
};return _abb ;};return nil ;};func (_ddg *convertContext )makeCols (){_ccdg :=_ddg ._abef ;_cce :=_ccdg .X ();_fe :=[]*colInfo {};_fff :=[]colWidthRange {};if _fag :=_cce .Cols ;len (_fag )> 0{for _ ,_fcg :=range _fag [0].Col {_bbb :=_de ;if _fcb :=_fcg .WidthAttr ;
_fcb !=nil {if *_fcb > 0.83{*_fcb -=0.83;};if *_fcb <=1{_bbb =*_fcb *11;}else {_bbb =5+*_fcb *6;};};_bec :=int (_fcg .MinAttr -1);_cgg :=int (_fcg .MaxAttr -1);_fff =append (_fff ,colWidthRange {_gacb :_bec ,_afcg :_cgg ,_ebee :_bbb ,_fdfb :_ddg .getStyle (_fcg .StyleAttr )});
};};_fab :=0;for _cab :=0;_cab <=_ddg ._gae ;_cab ++{if _cab < _ddg ._aegg ||(_cab > _ddg ._aafd &&_ddg ._aafd > 0){continue ;};var _afe float64 ;var _ggbe *style ;if _fab >=len (_fff ){_afe =_de ;}else {_fbc :=_fff [_fab ];if _cab >=_fbc ._gacb &&_cab <=_fbc ._afcg {_afe =_fbc ._ebee ;
_ggbe =_fbc ._fdfb ;if _cab ==_fbc ._afcg {_fab ++;};}else {_afe =_de ;};};_fe =append (_fe ,&colInfo {_bga :_afe ,_babe :_ggbe });};_dad :=0.0;for _ ,_df :=range _fe {_dad +=_df ._bga ;};_ddg ._gaef =1.0;if _dad > _ddg ._fcbcf {_ddg ._gaef =_ddg ._fcbcf /_dad ;
for _ ,_ebd :=range _fe {_ebd ._bga *=_ddg ._gaef ;};};_ddg ._bfb =_fe ;};const _ac =0.64;const _cc =0.25;func (_agdd *convertContext )getColorFromTheme (_adg uint32 )string {_ffeg :=_agdd ._gdg .Themes ();if len (_ffeg )!=0{_adfd :=_ffeg [0];if _ecbc :=_adfd .ThemeElements ;
_ecbc !=nil {if _gaac :=_ecbc .ClrScheme ;_gaac !=nil {switch _adg {case 0:return _eee .GetColorStringFromDmlColor (_gaac .Lt1 );case 1:return _eee .GetColorStringFromDmlColor (_gaac .Dk1 );case 2:return _eee .GetColorStringFromDmlColor (_gaac .Lt2 );case 3:return _eee .GetColorStringFromDmlColor (_gaac .Dk2 );
case 4:return _eee .GetColorStringFromDmlColor (_gaac .Accent1 );case 5:return _eee .GetColorStringFromDmlColor (_gaac .Accent2 );case 6:return _eee .GetColorStringFromDmlColor (_gaac .Accent3 );case 7:return _eee .GetColorStringFromDmlColor (_gaac .Accent4 );
case 8:return _eee .GetColorStringFromDmlColor (_gaac .Accent5 );case 9:return _eee .GetColorStringFromDmlColor (_gaac .Accent6 );};};};};return "";};func _dffd (_gcc []*symbol )float64 {_ggbc :=0.0;for _ ,_fcbc :=range _gcc {_ggbc +=_fcbc ._bedf ;};return _ggbc ;
};const _cfc =3;

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_af .PdfFont ){_eee .RegisterFont (name ,style ,font );};func _bcac (_aedc *symbol ){_egge :=_a .New ();_gefb :=_egge .NewStyledParagraph ();_gefb .SetMargins (0,0,0,0);_ccdge :=_gefb .Append (_aedc ._bgbf );
if _aedc ._bcdd !=nil {_ccdge .Style =*_aedc ._bcdd ;};_aedc ._aafc =_gefb .Height ();if _aedc ._bedf ==0{_aedc ._bedf =_gefb .Width ();};};type mergedCell struct{_cagfg uint32 ;_gdae uint32 ;_bea uint32 ;_cgb uint32 ;_bag float64 ;_dgga float64 ;};var _gg =_acea (1);
func (_eabe *convertContext )drawPage (_gefe *page ){_badd :=_eabe ._eeac ;_eccf :=_eabe ._gac ;for _ ,_egad :=range _gefe ._eced {_gcb :=_eabe ._dedg [_egad ._acc ];for _ ,_bcb :=range _egad ._bcggd {var _cfa float64 ;if _egad ._acc > 1{_cfa =_eabe ._dedg [_egad ._acc -1]._bdga ;
};var _gda ,_feafd float64 ;if _eag :=_bcb ._gcgg ;_eag !=nil {_gda =_eag ._acac ;};if _dafe :=_bcb ._dbbc ;_dafe !=nil {_feafd =_dafe ._acac ;};_cccg :=_badd +_gcb ._afec -0.5*(_cfa -_gda );_ddgf :=_badd +_gcb ._afec +_gcb ._eacg +0.5*(_gcb ._bdga +_feafd );
_bdd :=_eccf +_bcb ._fgde ;_fdff :=_bdd +_bcb ._cbdd ;if _bcb ._dceg !=nil &&_bcb ._dceg !=_a .ColorBlack {_eee .FillRectangle (_eabe ._gbf ,_bdd ,_cccg ,_fdff -_bdd ,_ddgf -_cccg ,_bcb ._dceg );};};};for _ ,_eae :=range _gefe ._eced {_bbdg :=_eabe ._dedg [_eae ._acc ];
for _ ,_agc :=range _eae ._bcggd {_eed :=_agc ._ddeg < _agc ._fgde ;_ggg :=_agc ._ecaa > _agc ._fgde +_agc ._cde ;var _bfgd ,_bdba bool ;for _ ,_aaaa :=range _agc ._bcfde {for _ ,_bfec :=range _aaaa ._cfee {if _eed &&!_bfgd {_bfgd =_bfec ._gbfd < 0;};if _ggg &&!_bdba {_bdba =_agc ._cde < _bfec ._gbfd +_bfec ._bedf ;
};if _agc ._fgde +_bfec ._gbfd >=_agc ._ddeg &&_agc ._fgde +_bfec ._gbfd +_bfec ._bedf <=_agc ._ecaa {_bdbd :=_eabe ._gbf .NewStyledParagraph ();_feda :=_eccf +_agc ._fgde +_bfec ._gbfd ;_caa :=_badd +_bbdg ._afec +_aaaa ._eafa -_bfec ._aafc -_acea (0.5);
_bdbd .SetPos (_feda ,_caa );var _dfe *_a .TextChunk ;if _bfec ._ddeb !=""{_dfe =_bdbd .AddExternalLink (_bfec ._bgbf ,_bfec ._ddeb );}else {_dfe =_bdbd .Append (_bfec ._bgbf );};if _bfec ._bcdd !=nil {_dfe .Style =*_bfec ._bcdd ;};_eabe ._gbf .Draw (_bdbd );
};};};var _ecfe ,_fedf ,_ffac ,_edg ,_cda ,_cccd float64 ;var _aac ,_dcdg ,_ffc ,_ggbf _a .Color ;if _bdde :=_agc ._gcgg ;_bdde !=nil {_ecfe =_bdde ._acac ;_aac =_bdde ._efef ;};if _ddba :=_agc ._dbbc ;_ddba !=nil {_fedf =_ddba ._acac ;_dcdg =_ddba ._efef ;
};if _dge :=_agc ._dbbb ;_dge !=nil {_ffac =_dge ._acac ;_cda =_ffac /2;_ffc =_dge ._efef ;};if _eeb :=_agc ._fdb ;_eeb !=nil {_edg =_eeb ._acac ;_cccd =_edg /2;_ggbf =_eeb ._efef ;};var _aecd float64 ;if _eae ._acc > 1{_aecd =_eabe ._dedg [_eae ._acc -1]._bdga ;
};_efa :=_badd +_bbdg ._afec -0.5*(_aecd -_ecfe );_cbgb :=_badd +_bbdg ._afec +_bbdg ._eacg +0.5*(_bbdg ._bdga +_fedf );_bgdf :=_eccf +_agc ._fgde ;_acdb :=_bgdf +_agc ._cbdd ;_eee .DrawLine (_eabe ._gbf ,_bgdf ,_efa ,_acdb ,_efa ,_ecfe ,_aac );_eee .DrawLine (_eabe ._gbf ,_bgdf ,_cbgb ,_acdb ,_cbgb ,_fedf ,_dcdg );
if !_bfgd {_eee .DrawLine (_eabe ._gbf ,_bgdf -_cda ,_efa ,_bgdf -_cda ,_cbgb ,_ffac ,_ffc );};if !_bdba {_eee .DrawLine (_eabe ._gbf ,_acdb -_cccd ,_efa ,_acdb -_cccd ,_cbgb ,_edg ,_ggbf );};};};for _ ,_dbc :=range _gefe ._ggff {if _dbc !=nil {_eabe ._gbf .Draw (_dbc );
};};};const _dc =0.0;const _ce =2;func _acea (_fdaa float64 )float64 {return _fdaa *_cf .Millimeter };func (_ecb *convertContext )makePagespans (){_ecb ._dced =[]*pagespan {};_gad :=0.0;_bde :=0;for _faa ,_fea :=range _ecb ._bfb {_feaf :=_fea ._bga ;if _gad +_feaf <=_ecb ._fcbcf {_fea ._gcba =_gad ;
_gad +=_feaf ;}else {_fea ._gcba =0;_ecb ._dced =append (_ecb ._dced ,&pagespan {_dfa :_gad ,_geg :_bde ,_addf :_faa });_gad =_feaf ;_bde =_faa ;};};_ecb ._dced =append (_ecb ._dced ,&pagespan {_dfa :_gad ,_geg :_bde ,_addf :len (_ecb ._bfb )});};func (_bee *convertContext )makeRows (){_ea :=[]*rowInfo {};
_ddbd :=_bee ._abef .Rows ();_bcfc :=0;_gbb :=0.0;for _bcg ,_fcc :=range _ddbd {if _bcg < _bee ._cgeb ||(_bcg > _bee ._ebb &&_bee ._ebb > 0){continue ;};_bcfc ++;_fcbe :=int (_fcc .RowNumber ());if _fcbe > _bcfc {for _fad :=_bcfc ;_fad < _fcbe ;_fad ++{_ea =append (_ea ,&rowInfo {_eacg :_eeg /_bc });
_gbb +=_eeg /_bc ;};_bcfc =_fcbe ;};var _eac float64 ;if _fcc .X ().HtAttr ==nil {_eac =_eeg ;}else {_eac =*_fcc .X ().HtAttr ;};_ea =append (_ea ,&rowInfo {_eacg :_eac /_bc ,_gffd :true ,_aeef :_bee .getStyle (_fcc .X ().SAttr )});_gbb +=_eac /_bc ;};
for _ef :=len (_ea );_ef < _bee ._ecbd ;_ef ++{_ea =append (_ea ,&rowInfo {_eacg :_eeg /_bc });_gbb +=_eeg /_bc ;};if _bee ._dga ||_gbb > _bee ._eagb {for _ ,_efg :=range _ea {_efg ._eacg *=_bee ._gaef ;};};_bee ._dedg =_ea ;};func (_aece *convertContext )getSymbolsFromR (_cbc []*_ee .CT_RElt ,_cgfa *style )[]*symbol {_defc :=[]*symbol {};
for _ ,_daa :=range _cbc {_abeb :=_aece .combineCellStyleWithRPrElt (_cgfa ,_daa .RPr );for _ ,_cdbg :=range _daa .T {_defc =append (_defc ,&symbol {_bgbf :string (_cdbg ),_bcdd :_aece .makeTextStyleFromCellStyle (_abeb )});};};return _defc ;};func (_gde *convertContext )makePages (){for _ ,_eega :=range _gde ._dced {for _ ,_ded :=range _gde ._agd {_eega ._gcbd =append (_eega ._gcbd ,&page {_eced :[]*pageRow {},_cfbe :_eega ,_cfca :_ded });
};};};func (_cebdf *convertContext )combineCellStyleWithRPrElt (_aacd *style ,_gfdcg *_ee .CT_RPrElt )*style {_ggc :=*_aacd ;_fgce :=_cebdf .getStyleFromRPrElt (_gfdcg );if _fgce ==nil {return &_ggc ;};if _fgce ._bdca !=nil {_ggc ._bdca =_fgce ._bdca ;
};if _fgce ._bdab !=nil {_ggc ._bdab =_fgce ._bdab ;};if _fgce ._fgdf !=nil {_ggc ._fgdf =_fgce ._fgdf ;};if _fgce ._efed !=nil {_ggc ._efed =_fgce ._efed ;};if _fgce ._bcd !=nil {_ggc ._bcd =_fgce ._bcd ;};if _fgce ._addb !=nil {_ggc ._addb =_fgce ._addb ;
};if _fgce ._bdabg !=nil {_ggc ._bdabg =_fgce ._bdabg ;};if _fgce ._addg !=nil {_ggc ._addg =_fgce ._addg ;};return &_ggc ;};const _ad =1.5;type convertContext struct{_gbf *_a .Creator ;_gdg *_c .Workbook ;_efc *_cg .Theme ;_abef *_c .Sheet ;_badg *_c .StyleSheet ;
_ecbd int ;_gae int ;_dced []*pagespan ;_ffd *page ;_bfb []*colInfo ;_dedg []*rowInfo ;_agd []*rowspan ;_eeac float64 ;_gac float64 ;_eagb float64 ;_fcbcf float64 ;_ggaad []*mergedCell ;_ceg []*anchor ;_gaef float64 ;_aegg int ;_aafd int ;_cgeb int ;_ebb int ;
_dga bool ;};func _dgb (_cfg []*symbol )float64 {_gfg :=0.0;for _ ,_aadc :=range _cfg {if _aadc ._aafc > _gfg {_gfg =_aadc ._aafc ;};};return _gfg ;};type cell struct{_dgde _ee .ST_CellType ;_gfbd int ;_fgde float64 ;_bcfde []*line ;_cde float64 ;_cbdd float64 ;
_afdb float64 ;_ddeg float64 ;_ecaa float64 ;_dgbf *_a .TextStyle ;_gcgg *border ;_dbbc *border ;_dbbb *border ;_fdb *border ;_bbea bool ;_adbc bool ;_dceg _a .Color ;};func (_cbe *convertContext )getStyleFromRPrElt (_gfag *_ee .CT_RPrElt )*style {if _gfag ==nil {return nil ;
};_dgbb :=&style {};_dgbb ._fgdf =&_gfag .RFont .ValAttr ;if _afg :=_gfag .B ;_afg !=nil {_gcfa :=_afg .ValAttr ==nil ||*_afg .ValAttr ;_dgbb ._efed =&_gcfa ;};if _gaefd :=_gfag .I ;_gaefd !=nil {_cgc :=_gaefd .ValAttr ==nil ||*_gaefd .ValAttr ;_dgbb ._bcd =&_cgc ;
};if _fcga :=_gfag .U ;_fcga !=nil {_egdd :=_fcga .ValAttr ==_ee .ST_UnderlineValuesSingle ||_fcga .ValAttr ==_ee .ST_UnderlineValuesUnset ;_dgbb ._addb =&_egdd ;};if _efgf :=_gfag .VertAlign ;_efgf !=nil {_dcab :=_efgf .ValAttr ==_g .ST_VerticalAlignRunSuperscript ;
_dgbb ._bdabg =&_dcab ;_ebef :=_efgf .ValAttr ==_g .ST_VerticalAlignRunSubscript ;_dgbb ._addg =&_ebef ;};if _bcbb :=_gfag .Sz ;_bcbb !=nil {_eff :=_bcbb .ValAttr ;_dgbb ._bdab =&_eff ;};if _ecac :=_gfag .Color ;_ecac !=nil {_dgbb ._bdca =_cbe .getColorStringFromSmlColor (_ecac );
};return _dgbb ;};var _bc =3.025/_acea (1);func (_add *convertContext )getImage (_dca _e .Image ,_dabg ,_bcfa ,_ccdb ,_gbca ,_edeg ,_cdd float64 ,_ccde _eee .ImgPart )*_a .Image {_gbca +=_add ._eeac ;_ccdb +=_add ._gac ;_fgfa ,_ceba :=_eee .GetImage (_add ._gbf ,_dca ,_dabg ,_bcfa ,_ccdb ,_gbca ,_edeg ,_cdd ,_ccde );
if _ceba !=nil {_f .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_ceba );return nil ;};return _fgfa ;};func (_badfa *convertContext )makeTextStyleFromCellStyle (_bgg *style )*_a .TextStyle {_cgd :=_badfa ._gbf .NewTextStyle ();
if _bgg ==nil {_cgd .FontSize =_eee .DefaultFontSize ;_cgd .Font =_eee .AssignStdFontByName (_cgd ,_eee .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_cgd ;};if _ffg (_bgg ._addb ){_cgd .Underline =true ;_cgd .UnderlineStyle =_a .TextDecorationLineStyle {Offset :0.5,Thickness :_acea (1/32)};
};var _dbca FontStyle ;if _ffg (_bgg ._efed )&&_ffg (_bgg ._bcd ){_dbca =FontStyle_BoldItalic ;}else if _ffg (_bgg ._efed ){_dbca =FontStyle_Bold ;}else if _ffg (_bgg ._bcd ){_dbca =FontStyle_Italic ;}else {_dbca =FontStyle_Regular ;};_bcff :="\u0064e\u0066\u0061\u0075\u006c\u0074";
if _bgg ._fgdf !=nil {_bcff =*_bgg ._fgdf ;};if _ade ,_acgb :=_eee .StdFontsMap [_bcff ];_acgb {_cgd .Font =_eee .AssignStdFontByName (_cgd ,_ade [_dbca ]);}else if _eggg :=_eee .GetRegisteredFont (_bcff ,_dbca );_eggg !=nil {_cgd .Font =_eggg ;}else {_f .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_bcff ,_dbca );
_cgd .Font =_eee .AssignStdFontByName (_cgd ,_eee .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_dbca ]);};if _bgg ._bdab !=nil {_cgd .FontSize =_d .Round (*_bgg ._bdab *_badfa ._gaef );};if _bgg ._bdca !=nil {_cgd .Color =_a .ColorRGBFromHex (*_bgg ._bdca );
};if _bgg ._bdabg !=nil &&*_bgg ._bdabg {_cgd .FontSize *=_ac ;}else if _bgg ._addg !=nil &&*_bgg ._addg {_cgd .FontSize *=_ac ;};return &_cgd ;};const _de =64.0;func (_fcgb *convertContext )fillPages (){for _aae ,_gcf :=range _fcgb ._agd {_dff :=_fcgb ._dedg [_gcf ._cbd :_gcf ._gffb ];
for _ebf ,_ffa :=range _dff {_fbcc :=0;_eea :=0.0;_def :=[]*cell {};if _ffa ._gffd {for _ ,_cag :=range _ffa ._gffc {_bfg :=_fcgb ._dced [_fbcc ];_fcgb ._ffd =_bfg ._gcbd [_aae ];_fcgb ._ffd ._gfdg =true ;_bbdc :=_cag ._cbdd ;if _eea +_bbdc > _bfg ._dfa {_fcgb .addRowToPage (_def ,_ebf );
_def =[]*cell {_cag };_eea =_bbdc ;_fbcc ++;}else {_cag ._fgde =_eea ;_def =append (_def ,_cag );_eea +=_bbdc ;};};if len (_def )> 0{_eecf :=_fcgb ._dced [_fbcc ];_fcgb ._ffd =_eecf ._gcbd [_aae ];_fcgb ._ffd ._gfdg =true ;_fcgb .addRowToPage (_def ,_ebf );
};};};};};func (_fgca *convertContext )alignSymbolsHorizontally (_aga *cell ,_ggbed _ee .ST_HorizontalAlignment ){if _ggbed ==_ee .ST_HorizontalAlignmentUnset {switch _aga ._dgde {case _ee .ST_CellTypeB :_ggbed =_ee .ST_HorizontalAlignmentCenter ;case _ee .ST_CellTypeN :_ggbed =_ee .ST_HorizontalAlignmentRight ;
default:_ggbed =_ee .ST_HorizontalAlignmentLeft ;};};var _afdd float64 ;for _ ,_beecf :=range _aga ._bcfde {switch _ggbed {case _ee .ST_HorizontalAlignmentLeft :_afdd =_cfc ;case _ee .ST_HorizontalAlignmentRight :_bcgg :=_dffd (_beecf ._cfee );_afdd =_aga ._cde -_cfc -_bcgg ;
case _ee .ST_HorizontalAlignmentCenter :_age :=_dffd (_beecf ._cfee );_afdd =(_aga ._cde -_age )/2;};for _ ,_badf :=range _beecf ._cfee {_badf ._gbfd +=_afdd ;};};};type symbol struct{_bgbf string ;_gbfd float64 ;_aafc float64 ;_bedf float64 ;_bcdd *_a .TextStyle ;
_ddeb string ;};type colWidthRange struct{_gacb int ;_afcg int ;_ebee float64 ;_fdfb *style ;};var _aafcb =map[uint32 ]_a .PageSize {1:_a .PageSize {8.5*_cf .Inch ,11*_cf .Inch },2:_a .PageSize {8.5*_cf .Inch ,11*_cf .Inch },3:_a .PageSize {11*_cf .Inch ,17*_cf .Inch },4:_a .PageSize {17*_cf .Inch ,11*_cf .Inch },5:_a .PageSize {8.5*_cf .Inch ,14*_cf .Inch },6:_a .PageSize {5.5*_cf .Inch ,8.5*_cf .Inch },7:_a .PageSize {7.5*_cf .Inch ,10*_cf .Inch },8:_a .PageSize {_acea (297),_acea (420)},9:_a .PageSize {_acea (210),_acea (297)},10:_a .PageSize {_acea (210),_acea (297)},11:_a .PageSize {_acea (148),_acea (210)},70:_a .PageSize {_acea (105),_acea (148)},12:_a .PageSize {_acea (250),_acea (354)},13:_a .PageSize {_acea (182),_acea (257)},14:_a .PageSize {8.5*_cf .Inch ,13*_cf .Inch },20:_a .PageSize {4.125*_cf .Inch ,9.5*_cf .Inch },27:_a .PageSize {_acea (110),_acea (220)},28:_a .PageSize {_acea (162),_acea (229)},34:_a .PageSize {_acea (250),_acea (176)},29:_a .PageSize {_acea (324),_acea (458)},30:_a .PageSize {_acea (229),_acea (324)},31:_a .PageSize {_acea (114),_acea (162)},37:_a .PageSize {3.88*_cf .Inch ,7.5*_cf .Inch },43:_a .PageSize {_acea (100),_acea (148)},69:_a .PageSize {_acea (200),_acea (148)}};
func (_aff *convertContext )makeRowspans (){var _fgcf float64 ;_deb :=0;for _cgf ,_cga :=range _aff ._dedg {_acfb :=_cga ._eacg +_cga ._bdga ;if _fgcf +_acfb <=_aff ._eagb {_cga ._afec =_fgcf ;_fgcf +=_acfb ;}else {_aff ._agd =append (_aff ._agd ,&rowspan {_abge :_fgcf ,_cbd :_deb ,_gffb :_cgf });
_deb =_cgf ;_cga ._afec =0;_fgcf =_acfb ;};};_aff ._agd =append (_aff ._agd ,&rowspan {_abge :_fgcf ,_cbd :_deb ,_gffb :len (_aff ._dedg )});};type rowInfo struct{_afec float64 ;_gffd bool ;_eacg float64 ;_aeef *style ;_gffc []*cell ;_bdga float64 ;};type page struct{_eced []*pageRow ;
_gfdg bool ;_ggff []*_a .Image ;_cfbe *pagespan ;_cfca *rowspan ;};func (_cebd *convertContext )alignSymbolsVertically (_eacc *cell ,_dda _ee .ST_VerticalAlignment ){var _daag float64 ;switch _dda {case _ee .ST_VerticalAlignmentTop :_daag =_ce ;if _eacc ._bbea {_daag -=_ad ;
}else if _eacc ._adbc {_daag +=4*_ad ;};for _ ,_ecg :=range _eacc ._bcfde {_daag +=_ecg ._dbe ;_ecg ._eafa =_daag ;_daag +=_gg ;};case _ee .ST_VerticalAlignmentCenter :_deee :=0.0;for _ ,_dfg :=range _eacc ._bcfde {_deee +=_dfg ._dbe +_acea (1);};_daag =0.5*(_eacc ._afdb -_deee );
if _eacc ._bbea {_daag -=2*_ad ;}else if _eacc ._adbc {_daag +=2*_ad ;};for _ ,_cdcc :=range _eacc ._bcfde {_daag +=_cdcc ._dbe +0.5*_gg ;_cdcc ._eafa =_daag ;_daag +=0.5*_gg ;};default:_daag =_eacc ._afdb -_ce ;if _eacc ._bbea {_daag -=4*_ad ;}else if _eacc ._adbc {_daag +=_ad ;
};for _fda :=len (_eacc ._bcfde )-1;_fda >=0;_fda --{_eacc ._bcfde [_fda ]._eafa =_daag ;_daag -=_eacc ._bcfde [_fda ]._dbe ;_daag -=_gg ;};};};type colInfo struct{_gcba float64 ;_bga float64 ;_babe *style ;};func (_da *convertContext )makeAnchors (){_abd ,_eb :=_da ._abef .GetDrawing ();
if _abd !=nil {for _ ,_dd :=range _abd .EG_Anchor {_gbe :=&anchor {};if _bg :=_dd .TwoCellAnchor ;_bg !=nil {_bcfd ,_ddb :=_bg .From ,_bg .To ;if _bcfd ==nil ||_ddb ==nil {return ;};_gbe ._dead =int (_bcfd .Row );_gbe ._dabf =_eee .FromSTCoordinate (_bcfd .RowOff );
_gbe ._bddg =int (_bcfd .Col );_gbe ._fee =_eee .FromSTCoordinate (_bcfd .ColOff );_gbe ._ccbe =int (_ddb .Row );_gbe ._ecfeb =_eee .FromSTCoordinate (_ddb .RowOff );_gbe ._dbf =int (_ddb .Col );_gbe ._afb =_eee .FromSTCoordinate (_ddb .ColOff );if _bbg :=_bg .Choice ;
_bbg !=nil {if _ge :=_bbg .Pic ;_ge !=nil {if _be :=_ge .BlipFill ;_be !=nil {if _db :=_be .Blip ;_db !=nil {if _gga :=_db .EmbedAttr ;_gga !=nil {for _ ,_aeg :=range _eb .X ().Relationship {if _aeg .IdAttr ==*_gga {for _ ,_aa :=range _da ._gdg .Images {if _aa .Target ()==_aeg .TargetAttr {_afc ,_aee :=_eec .Open (_aa .Path ());
if _aee !=nil {_f .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_aee );continue ;};_gcd ,_ ,_aee :=_e .Decode (_afc );if _aee !=nil {_f .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_aee );
continue ;};_gbe ._cgbd =_gcd ;};};};};};};};}else if _gge :=_bbg .GraphicFrame ;_gge !=nil {if _ca :=_gge .Graphic ;_ca !=nil {if _eg :=_ca .GraphicData ;_eg !=nil {for _ ,_dee :=range _eg .Any {if _aag ,_dde :=_dee .(*_ba .Chart );_dde {for _ ,_ccd :=range _eb .X ().Relationship {if _ccd .IdAttr ==_aag .IdAttr {_egg :=_da ._gdg .GetChartByTargetId (_ccd .TargetAttr );
if _egg !=nil {_gbe ._edea =_egg ;};};};};};};};};};};if _gbe ._cgbd !=nil ||_gbe ._edea !=nil {_da ._ceg =append (_da ._ceg ,_gbe );};};};};func (_fbg *convertContext )getStyleFromCell (_cbcd _c .Cell ,_fca ,_abebd *style )*style {_fbdf :=_cbcd .X ();
_aaca :=_fbg .getStyle (_fbdf .SAttr );_faad (_aaca ,_fca );_faad (_aaca ,_abebd );return _aaca ;};type pageRow struct{_acc int ;_bcggd []*cell ;};func (_adf *convertContext )distributeAnchors (){for _ ,_ecf :=range _adf ._ceg {_bgd ,_bacf :=_ecf ._dead ,_ecf ._dabf ;
_ece ,_ebe :=_ecf ._bddg ,_ecf ._fee ;_ffea ,_daf :=_ecf ._ccbe ,_ecf ._ecfeb ;_eaca ,_dadg :=_ecf ._dbf ,_ecf ._afb ;if _bgd < _adf ._cgeb ||(_ffea > _adf ._ebb &&_adf ._ebb > 0){continue ;};if _ece < _adf ._aegg ||(_eaca > _adf ._aafd &&_adf ._aafd > 0){continue ;
};var _egd ,_fbe ,_dfd ,_cagf *page ;for _ ,_ede :=range _adf ._dced {for _ ,_gbc :=range _ede ._gcbd {if _bgd >=_gbc ._cfca ._cbd &&_bgd < _gbc ._cfca ._gffb {if _ece >=_gbc ._cfbe ._geg &&_ece < _gbc ._cfbe ._addf {_gbc ._gfdg =true ;_egd =_gbc ;};if _eaca >=_gbc ._cfbe ._geg &&_eaca < _gbc ._cfbe ._addf {_gbc ._gfdg =true ;
_fbe =_gbc ;};};if _ffea >=_gbc ._cfca ._cbd &&_ffea < _gbc ._cfca ._gffb {if _ece >=_gbc ._cfbe ._geg &&_ece < _gbc ._cfbe ._addf {_gbc ._gfdg =true ;_cagf =_gbc ;};if _eaca >=_gbc ._cfbe ._geg &&_eaca < _gbc ._cfbe ._addf {_gbc ._gfdg =true ;_dfd =_gbc ;
};};};};_fadb :=_egd !=_fbe ;_acd :=_egd !=_cagf ;if _fadb &&_acd {_agb :=_adf ._bfb [_ece ]._gcba +_cf .FromEMU (_ebe );_bca :=_egd ._cfbe ._dfa ;_dea :=_adf ._bfb [_eaca ]._gcba +_cf .FromEMU (_dadg );_gfa :=_adf ._dedg [_bgd ]._afec +_cf .FromEMU (_bacf );
_egff :=float64 (_egd ._cfca ._abge );_gcdc :=_adf ._dedg [_ffea ]._afec +_cf .FromEMU (_daf );_fac :=_dea +_bca -_agb ;_agg :=_gcdc +_egff -_gfa ;_dgf :=_adf .imageFromAnchor (_ecf ,_fac ,_agg );_egd ._ggff =append (_egd ._ggff ,_adf .getImage (_dgf ,_agg ,_fac ,_agb ,_gfa ,_bca -_agb ,_egff -_gfa ,_eee .ImgPart_lt ));
_fbe ._ggff =append (_fbe ._ggff ,_adf .getImage (_dgf ,_agg ,_fac ,0,_gfa ,_bca -_agb ,_egff -_gfa ,_eee .ImgPart_rt ));_cagf ._ggff =append (_cagf ._ggff ,_adf .getImage (_dgf ,_agg ,_fac ,_agb ,0,_bca -_agb ,_egff -_gfa ,_eee .ImgPart_lb ));_dfd ._ggff =append (_dfd ._ggff ,_adf .getImage (_dgf ,_agg ,_fac ,0,0,_bca -_agb ,_egff -_gfa ,_eee .ImgPart_rb ));
}else if _fadb {_fbd :=_adf ._dedg [_bgd ]._afec +_cf .FromEMU (_bacf );_efe :=_adf ._dedg [_ffea ]._afec +_cf .FromEMU (_daf );_gcg :=_adf ._bfb [_ece ]._gcba +_cf .FromEMU (_ebe );_baa :=_egd ._cfbe ._dfa ;_ggaa :=_adf ._bfb [_eaca ]._gcba +_cf .FromEMU (_dadg );
_eab :=_ggaa +_baa -_gcg ;_aad :=_efe -_fbd ;_cdb :=_adf .imageFromAnchor (_ecf ,_eab ,_aad );_egd ._ggff =append (_egd ._ggff ,_adf .getImage (_cdb ,_aad ,_eab ,_gcg ,_fbd ,_baa -_gcg ,0,_eee .ImgPart_l ));_fbe ._ggff =append (_fbe ._ggff ,_adf .getImage (_cdb ,_aad ,_eab ,0,_fbd ,_baa -_gcg ,0,_eee .ImgPart_r ));
}else if _acd {_gfc :=_adf ._bfb [_ece ]._gcba +_cf .FromEMU (_ebe );_cccf :=_adf ._bfb [_eaca ]._gcba +_cf .FromEMU (_dadg );_egffa :=_adf ._dedg [_bgd ]._afec +_cf .FromEMU (_bacf );_cdc :=float64 (_egd ._cfca ._abge );_cfb :=_adf ._dedg [_ffea ]._afec +_cf .FromEMU (_daf );
_eace :=_cccf -_gfc ;_fffb :=_cfb +_cdc -_egffa ;_cdf :=_adf .imageFromAnchor (_ecf ,_eace ,_fffb );_egd ._ggff =append (_egd ._ggff ,_adf .getImage (_cdf ,_fffb ,_eace ,_gfc ,_egffa ,0,_cdc -_egffa ,_eee .ImgPart_t ));_cagf ._ggff =append (_cagf ._ggff ,_adf .getImage (_cdf ,_fffb ,_eace ,_gfc ,0,0,_cdc -_egffa ,_eee .ImgPart_b ));
}else {_dbb :=_adf ._bfb [_ece ]._gcba +_cf .FromEMU (_ebe );_bcad :=_adf ._bfb [_eaca ]._gcba +_cf .FromEMU (_dadg );_eba :=_adf ._dedg [_bgd ]._afec +_cf .FromEMU (_bacf );_cge :=_adf ._dedg [_ffea ]._afec +_cf .FromEMU (_daf );_ceb :=_bcad -_dbb ;_ccee :=_cge -_eba ;
_beec :=_adf .imageFromAnchor (_ecf ,_ceb ,_ccee );_egd ._ggff =append (_egd ._ggff ,_adf .getImage (_beec ,_ccee ,_ceb ,_dbb ,_eba ,0,0,_eee .ImgPart_whole ));};};};type line struct{_eafa float64 ;_cfee []*symbol ;_dbe float64 ;};type style struct{_cabf *string ;
_bdca *string ;_bdab *float64 ;_fgdf *string ;_efed *bool ;_bcd *bool ;_addb *bool ;_bdabg *bool ;_addg *bool ;_geda *border ;_cgea *border ;_bbe *border ;_beg *border ;_egb bool ;_caeb _ee .ST_VerticalAlignment ;_daaf _ee .ST_HorizontalAlignment ;};type pagespan struct{_dfa float64 ;
_gcbd []*page ;_geg int ;_addf int ;};func (_egf *convertContext )determineMaxIndexes (){var _bda ,_fd int ;_bda =int (_egf ._abef .MaxColumnIdx ());_ddd :=_egf ._abef .Rows ();if len (_ddd )> 0{_fd =int (_ddd [len (_ddd )-1].RowNumber ());};for _ ,_ebg :=range _egf ._ceg {if _ebg ._ccbe >=_fd {_fd =_ebg ._ccbe +1;
};if _ebg ._dbf >=_bda {_bda =_ebg ._dbf +1;};};_egf ._ecbd =_fd ;_egf ._gae =_bda ;};func (_abeg *convertContext )getBorder (_fdgf *_ee .CT_BorderPr )*border {_ggaf :=&border {};switch _fdgf .StyleAttr {case _ee .ST_BorderStyleHair :_ggaf ._acac =_fa /2;
case _ee .ST_BorderStyleThin :_ggaf ._acac =_fa ;case _ee .ST_BorderStyleMedium :_ggaf ._acac =_fa *2;case _ee .ST_BorderStyleThick :_ggaf ._acac =_fa *4;};if _ggaf ._acac ==0.0{return nil ;};if _gba :=_fdgf .Color ;_gba !=nil {_fbbe :=_abeg .getColorStringFromSmlColor (_gba );
if _fbbe !=nil {_ggaf ._efef =_a .ColorRGBFromHex (*_fbbe );}else {_ggaf ._efef =_a .ColorBlack ;};};return _ggaf ;};func (_dcgb *convertContext )getStyle (_fdfbb *uint32 )*style {_aeee :=&style {};_gca :=false ;if _fdfbb !=nil {_adc :=_dcgb ._badg .GetCellStyle (*_fdfbb );
if _adc .GetFill ()!=nil &&_adc .GetFill ().PatternFill !=nil &&_adc .GetFill ().PatternFill .FgColor !=nil {_aeee ._cabf =_dcgb .getColorStringFromSmlColor (_adc .GetFill ().PatternFill .FgColor );};_fcdc :=_adc .GetFont ();for _ ,_fdg :=range _fcdc .Name {if _fdg !=nil {_aeee ._fgdf =&_fdg .ValAttr ;
_gca =true ;break ;};};for _ ,_edga :=range _fcdc .B {if _edga !=nil {_accc :=_edga .ValAttr ==nil ||*_edga .ValAttr ;_aeee ._efed =&_accc ;_gca =true ;break ;};};for _ ,_bfgb :=range _fcdc .I {if _bfgb !=nil {_gdgc :=_bfgb .ValAttr ==nil ||*_bfgb .ValAttr ;
_aeee ._bcd =&_gdgc ;_gca =true ;break ;};};for _ ,_dadgc :=range _fcdc .U {if _dadgc !=nil {_edc :=_dadgc .ValAttr ==_ee .ST_UnderlineValuesSingle ||_dadgc .ValAttr ==_ee .ST_UnderlineValuesUnset ;_aeee ._addb =&_edc ;_gca =true ;break ;};};for _ ,_fbfa :=range _fcdc .Sz {if _fbfa !=nil {_fedd :=_fbfa .ValAttr ;
_aeee ._bdab =&_fedd ;_gca =true ;break ;};};for _ ,_cef :=range _fcdc .VertAlign {if _cef !=nil {_cfeb :=_cef .ValAttr ==_g .ST_VerticalAlignRunSuperscript ;_aeee ._bdabg =&_cfeb ;_aaac :=_cef .ValAttr ==_g .ST_VerticalAlignRunSubscript ;_aeee ._addg =&_aaac ;
_gca =true ;break ;};};for _ ,_ecca :=range _fcdc .Color {if _ecca !=nil {_aeee ._bdca =_dcgb .getColorStringFromSmlColor (_ecca );_gca =true ;break ;};};_bdcg :=_adc .GetBorder ();if _bdcg .Top !=nil {_aeee ._geda =_dcgb .getBorder (_bdcg .Top );_gca =true ;
};if _bdcg .Bottom !=nil {_aeee ._cgea =_dcgb .getBorder (_bdcg .Bottom );_gca =true ;};if _bdcg .Left !=nil {_aeee ._bbe =_dcgb .getBorder (_bdcg .Left );_gca =true ;};if _bdcg .Right !=nil {_aeee ._beg =_dcgb .getBorder (_bdcg .Right );_gca =true ;};
if _adc .Wrapped (){_aeee ._egb =true ;_gca =true ;};if _gedb :=_adc .GetVerticalAlignment ();_gedb !=_ee .ST_VerticalAlignmentUnset {_aeee ._caeb =_gedb ;_gca =true ;};if _feb :=_adc .GetHorizontalAlignment ();_feb !=_ee .ST_HorizontalAlignmentUnset {_aeee ._daaf =_feb ;
_gca =true ;};};if _gca {return _aeee ;};return nil ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_c .Sheet )*_a .Creator {_gf :=s .X ();if _gf ==nil {return nil ;};var _cb _a .PageSize ;_fg :=true ;_bcf :=false ;if _gf .SheetPr !=nil &&_gf .SheetPr .PageSetUpPr !=nil &&_gf .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_gf .SheetPr .PageSetUpPr .FitToPageAttr {_bcf =true ;
};if _fgc :=_gf .PageSetup ;_fgc !=nil {_fg =_fgc .OrientationAttr ==_ee .ST_OrientationLandscape ;if _bad :=_fgc .PaperSizeAttr ;_bad !=nil {_cb =_aafcb [*_bad ];};};if (_cb ==_a .PageSize {}){_cb =_a .PageSizeA4 ;};if _fg {_cb [0],_cb [1]=_cb [1],_cb [0];
};_ggb :=_a .New ();_ggb .SetPageSize (_cb );var _ae ,_ed ,_fc ,_ggbd float64 ;if _gfd :=_gf .PageMargins ;_gfd !=nil {_fc =_gfd .LeftAttr ;_ggbd =_gfd .RightAttr ;_ae =_gfd .TopAttr ;_ed =_gfd .BottomAttr ;};if _fc < _cc {_fc =_cc ;};if _ggbd < _cc {_ggbd =_cc ;
};if _ae < _dc {_ae =_dc ;};if _ed < _dc {_ed =_dc ;};_ae *=_cf .Inch ;_ed *=_cf .Inch ;_fc *=_cf .Inch ;_ggbd *=_cf .Inch ;_ggb .SetPageMargins (_fc ,_ggbd ,_ae ,_ed );_dg :=s .Workbook ();var _baf *_cg .Theme ;if len (_dg .Themes ())> 0{_baf =_dg .Themes ()[0];
};var _bcc ,_ff ,_gb ,_ec int ;for _ ,_dgd :=range _dg .DefinedNames (){if _dgd .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_cea ,_bdb ,_ga ,_fgd :=_eee .ParseExcelRange (_dgd .Content ());if _fgd ==nil &&s .Name ()==_cea {_bcc =int (_bdb .ColumnIdx );
_ff =int (_ga .ColumnIdx );_gb =int (_bdb .RowIdx );_ec =int (_ga .RowIdx );};};};_fb :=&convertContext {_gbf :_ggb ,_abef :s ,_gdg :s .Workbook (),_efc :_baf ,_badg :&s .Workbook ().StyleSheet ,_eeac :_ae ,_gac :_fc ,_eagb :_cb [1]-_ed -_ae ,_fcbcf :_cb [0]-_ggbd -_fc ,_aegg :_bcc ,_aafd :_ff ,_cgeb :_gb ,_ebb :_ec ,_dga :_bcf };
_fb .makeAnchors ();_fb .determineMaxIndexes ();if _fb ._ecbd ==0&&_fb ._gae ==0{_ggb .NewPage ();return _ggb ;};_fb .makeCols ();_fb .makeRows ();_fb .makeMergedCells ();_fb .makeCells ();_fb .makePagespans ();_fb .makeRowspans ();_fb .makePages ();_fb .fillPages ();
_fb .distributeAnchors ();_fb .drawSheet (_fg );return _ggb ;};var _fa =_acea (0.0625);func _faad (_ffcb ,_aaad *style ){if _aaad ==nil {return ;};if _ffcb ==nil {_ffcb =_aaad ;return ;};if _ffcb ._cabf ==nil {_ffcb ._cabf =_aaad ._cabf ;};if _ffcb ._fgdf ==nil {_ffcb ._fgdf =_aaad ._fgdf ;
};if _ffcb ._bdca ==nil {_ffcb ._bdca =_aaad ._bdca ;};if _ffcb ._bdab ==nil {_ffcb ._bdab =_aaad ._bdab ;};if _ffcb ._efed ==nil {_ffcb ._efed =_aaad ._efed ;};if _ffcb ._bcd ==nil {_ffcb ._bcd =_aaad ._bcd ;};if _ffcb ._addb ==nil {_ffcb ._addb =_aaad ._addb ;
};if _ffcb ._bdabg ==nil {_ffcb ._bdabg =_aaad ._bdabg ;};if _ffcb ._addg ==nil {_ffcb ._addg =_aaad ._addg ;};if _ffcb ._geda ==nil {_ffcb ._geda =_aaad ._geda ;};if _ffcb ._cgea ==nil {_ffcb ._cgea =_aaad ._cgea ;};if _ffcb ._bbe ==nil {_ffcb ._bbe =_aaad ._bbe ;
};if _ffcb ._beg ==nil {_ffcb ._beg =_aaad ._beg ;};if _ffcb ._caeb ==_ee .ST_VerticalAlignmentUnset {_ffcb ._caeb =_aaad ._caeb ;};if _ffcb ._daaf ==_ee .ST_HorizontalAlignmentUnset {_ffcb ._daaf =_aaad ._daaf ;};};func (_fage *convertContext )makeMergedCells (){_aec :=[]*mergedCell {};
for _ ,_bdbf :=range _fage ._abef .MergedCells (){_ddc ,_bff ,_cfcd :=_ab .ParseRangeReference (_bdbf .Reference ());if _cfcd !=nil {_f .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_cfcd );
continue ;};_bge :=mergedCell {_cagfg :_ddc .RowIdx ,_gdae :_ddc .ColumnIdx ,_bea :_bff .RowIdx ,_cgb :_bff .ColumnIdx };for _bac :=_bge ._gdae -1;_bac < _bge ._cgb ;_bac ++{_bge ._bag +=_fage ._bfb [_bac ]._bga ;};for _cd :=_bge ._cagfg -1;_cd < _bge ._bea ;
_cd ++{_bge ._dgga +=_fage ._dedg [_cd ]._eacg ;};_aec =append (_aec ,&_bge );};_fage ._ggaad =_aec ;};func (_fae *convertContext )drawSheet (_cdg bool ){for _ccaf ,_cbf :=range _fae ._dced {_gfdc :=len (_cbf ._gcbd );if _ccaf ==len (_fae ._dced )-1{for _bbfg :=len (_cbf ._gcbd )-1;
_bbfg >=0;_bbfg --{if !_cbf ._gcbd [_bbfg ]._gfdg {_gfdc =_bbfg ;};};};_gged :=_cbf ._gcbd [:_gfdc ];for _ ,_aeb :=range _gged {_fae ._gbf .NewPage ();if _cdg {_fae ._gbf .RotateDeg (270);};_fae .drawPage (_aeb );};};};func (_acb *convertContext )getColorStringFromSmlColor (_cgge *_ee .CT_Color )*string {var _gcaa string ;
if _cgge .RgbAttr !=nil {_gcaa =*_cgge .RgbAttr ;}else if _cgge .IndexedAttr !=nil &&*_cgge .IndexedAttr < 64{_gcaa =_aea [*_cgge .IndexedAttr ];}else if _cgge .ThemeAttr !=nil {_ada :=*_cgge .ThemeAttr ;_gcaa =_acb .getColorFromTheme (_ada );};if _gcaa ==""{return nil ;
};if len (_gcaa )> 6{_gcaa =_gcaa [(len (_gcaa )-6):];};if _cgge .TintAttr !=nil {_dgdg :=*_cgge .TintAttr ;_gcaa =_eee .AdjustColorByTint (_gcaa ,_dgdg );};_gcaa ="\u0023"+_gcaa ;return &_gcaa ;};func (_acfa *convertContext )addRowToPage (_aca []*cell ,_eedf int ){_egadc :=0.0;
_cdga :=_acfa ._fcbcf ;for _ ,_gag :=range _aca {if len (_gag ._bcfde )!=0{_gag ._ddeg =_egadc ;_egadc =_gag ._fgde +_gag ._cde ;};};for _aacf :=len (_aca )-1;_aacf >=0;_aacf --{_ecfa :=_aca [_aacf ];if len (_ecfa ._bcfde )!=0{_ecfa ._ecaa =_cdga ;_cdga =_ecfa ._fgde ;
};};_acfa ._ffd ._eced =append (_acfa ._ffd ._eced ,&pageRow {_acc :_eedf ,_bcggd :_aca });};const _eeg =15.0;func (_bbga *convertContext )getSymbolsFromString (_agbg string ,_fgcg *style )[]*symbol {_fede :=[]*symbol {};_fcgd :=_bbga .makeTextStyleFromCellStyle (_fgcg );
for _ ,_bfa :=range _agbg {_fede =append (_fede ,&symbol {_bgbf :string (_bfa ),_bcdd :_fcgd });};return _fede ;};type border struct{_acac float64 ;_efef _a .Color ;};func (_abde *convertContext )getContentFromCell (_dgg *_c .Sheet ,_aebc _c .Cell ,_efea *style ,_gcdd float64 ,_cfe bool )([]*line ,_ee .ST_CellType ){_gfcd :=_aebc .X ();
var _fbb []*symbol ;switch _gfcd .TAttr {case _ee .ST_CellTypeS :_dcg :=_gfcd .V ;if _dcg !=nil {_gggg ,_ccag :=_bb .Atoi (*_dcg );if _ccag ==nil {_aaf :=_abde ._gdg .SharedStrings .X ().Si [_gggg ];if _aaf .T !=nil {_fbb =_abde .getSymbolsFromString (*_aaf .T ,_efea );
}else if _aaf .R !=nil {_fbb =_abde .getSymbolsFromR (_aaf .R ,_efea );};};};case _ee .ST_CellTypeB :_cabe :=_gfcd .V ;if _cabe !=nil {if *_cabe =="\u0030"{_fbb =_abde .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_efea );}else {_fbb =_abde .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_efea );
};};case _ee .ST_CellTypeStr :if _gfcd .F !=nil {_fga :=_bd .NewEvaluator ();_bdbab :=_dgg .FormulaContext ().Cell (_aebc .Reference (),_fga );_fbb =_abde .getSymbolsFromString (_bdbab .Value (),_efea );};default:_fbb =_abde .getSymbolsFromString (_aebc .GetFormattedValue (),_efea );
};_ggf :=0.0;_badc :=0.0;var _baba []*line ;var _acg bool ;if _efea !=nil {if _efea ._bdabg !=nil {if *_efea ._bdabg {_acg =true ;};};if _efea ._addg !=nil {if *_efea ._addg {_acg =true ;};};};if _cfe {_baba =[]*line {};_ebdd :=_gcdd -2*_cfc ;_ebfa :=[]*symbol {};
for _ ,_dfdf :=range _fbb {_bcac (_dfdf );if _ggf +_dfdf ._bedf >=_ebdd {_fabd :=_dgb (_ebfa );if _acg {_fabd /=_ac ;};_baba =append (_baba ,&line {_eafa :_badc ,_cfee :_ebfa ,_dbe :_fabd });_ebfa =[]*symbol {_dfdf };_ggf =_dfdf ._bedf ;_badc +=_fabd ;
}else {_dfdf ._gbfd =_ggf ;_ggf +=_dfdf ._bedf ;_ebfa =append (_ebfa ,_dfdf );};};_dcc :=_dgb (_ebfa );if _acg {_dcc /=_ac ;};if len (_ebfa )> 0{_baba =append (_baba ,&line {_eafa :_badc ,_cfee :_ebfa ,_dbe :_dcc });};}else {for _ ,_dcdf :=range _fbb {_bcac (_dcdf );
_dcdf ._gbfd =_ggf ;_ggf +=_dcdf ._bedf ;};if len (_fbb )> 0{_baba =[]*line {&line {_cfee :_fbb ,_dbe :_dgb (_fbb )}};};};_eagf :=_gfcd .TAttr ;if _eagf ==_ee .ST_CellTypeUnset {_eagf =_ee .ST_CellTypeN ;};return _baba ,_eagf ;};func _ffg (_caac *bool )bool {return _caac !=nil &&*_caac };
const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _eee .RegisterFontsFromDirectory (dirName );};func (_gd *convertContext )makeCells (){_adbg :=_gd ._abef ;_ddcb :=_adbg .Rows ();_afa :=0;for _cbg ,_cgga :=range _gd ._dedg {if _cbg < _gd ._cgeb ||(_cbg > _gd ._ebb &&_gd ._ebb > 0){continue ;
};_cgga ._gffc =[]*cell {};_ccc :=0.0;_dcd :=_cgga ._aeef ;if _cgga ._gffd {_ffe :=_ddcb [_afa ];_afa ++;_bbf :=_cgga ._eacg ;for _ ,_bfe :=range _ffe .Cells (){_aedg ,_gaa :=_ab .ParseCellReference (_bfe .Reference ());if _gaa !=nil {_f .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_gaa );
continue ;};if int (_aedg .ColumnIdx )< _gd ._aegg ||(int (_aedg .ColumnIdx )> _gd ._aafd &&_gd ._aafd > 0){continue ;};_cggg :=_gd ._bfb [_aedg .ColumnIdx ];_acf :=_cggg ._bga ;_afd :=_acf ;_ecc :=_cggg ._babe ;var _dcdd ,_fabc ,_aba ,_eca bool ;for _ ,_fed :=range _gd ._ggaad {if _aedg .RowIdx >=_fed ._cagfg &&_aedg .RowIdx <=_fed ._bea &&_aedg .ColumnIdx >=_fed ._gdae &&_aedg .ColumnIdx <=_fed ._cgb {if _aedg .ColumnIdx ==_fed ._gdae &&_aedg .RowIdx ==_fed ._cagfg {_acf =_fed ._bag ;
_bbf =_fed ._dgga ;};_dcdd =_aedg .RowIdx !=_fed ._cagfg ;_fabc =_aedg .RowIdx !=_fed ._bea ;_aba =_aedg .ColumnIdx !=_fed ._gdae ;_eca =_aedg .ColumnIdx !=_fed ._cgb ;};};_bgf :=_gd .getStyleFromCell (_bfe ,_dcd ,_ecc );var _edb ,_fdf ,_dfc bool ;var _ega ,_bbbd ,_gfb ,_gdd *border ;
var _dce _ee .ST_VerticalAlignment ;var _fcd _ee .ST_HorizontalAlignment ;if _bgf !=nil {if !_dcdd {_ega =_bgf ._geda ;};if !_fabc {_bbbd =_bgf ._cgea ;};if !_aba {_gfb =_bgf ._bbe ;};if !_eca {_gdd =_bgf ._beg ;};if _bbbd !=nil &&_bbbd ._acac > _ccc {_ccc =_bbbd ._acac ;
};_dce =_bgf ._caeb ;_fcd =_bgf ._daaf ;if _bgf ._bdabg !=nil {_edb =*_bgf ._bdabg ;};if _bgf ._addg !=nil {_fdf =*_bgf ._addg ;};_dfc =_bgf ._egb ;};var _cca _a .Color ;if _bgf !=nil &&_bgf ._cabf !=nil {_cca =_a .ColorRGBFromHex (*_bgf ._cabf );};_bgec ,_bgc :=_gd .getContentFromCell (_adbg ,_bfe ,_bgf ,_acf ,_dfc );
_bce :=&cell {_dgde :_bgc ,_cde :_acf ,_cbdd :_afd ,_afdb :_bbf ,_bcfde :_bgec ,_gcgg :_ega ,_dbbc :_bbbd ,_dbbb :_gfb ,_fdb :_gdd ,_bbea :_edb ,_adbc :_fdf ,_dceg :_cca };_gd .alignSymbolsHorizontally (_bce ,_fcd );_gd .alignSymbolsVertically (_bce ,_dce );
_cgga ._gffc =append (_cgga ._gffc ,_bce );};};_cgga ._bdga =_ccc ;};};type anchor struct{_cgbd _e .Image ;_edea *_ba .ChartSpace ;_dead int ;_dabf int64 ;_bddg int ;_fee int64 ;_ccbe int ;_ecfeb int64 ;_dbf int ;_afb int64 ;};type rowspan struct{_abge float64 ;
_cbd int ;_gffb int ;};var _aea =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
