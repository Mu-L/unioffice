//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_af "github.com/unidoc/unioffice/common/logger";_fb "github.com/unidoc/unioffice/common/tempstorage";_b "github.com/unidoc/unioffice/internal/convertutils";_d "github.com/unidoc/unioffice/measurement";_f "github.com/unidoc/unioffice/schema/soo/dml";
_cb "github.com/unidoc/unioffice/schema/soo/dml/chart";_ac "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_ceg "github.com/unidoc/unioffice/schema/soo/sml";_ef "github.com/unidoc/unioffice/spreadsheet";_ab "github.com/unidoc/unioffice/spreadsheet/formula";
_gg "github.com/unidoc/unioffice/spreadsheet/reference";_g "github.com/unidoc/unipdf/v3/creator";_e "github.com/unidoc/unipdf/v3/model";_a "image";_cf "math";_ce "sort";_cc "strconv";);func (_cgfe *convertContext )getSymbolsFromString (_gef string ,_cgfb *style )[]*symbol {_adeed :=[]*symbol {};
_dcb :=_cgfe .makeTextStyleFromCellStyle (_cgfb );for _ ,_eecg :=range _gef {_adeed =append (_adeed ,&symbol {_cgdg :string (_eecg ),_fabe :_dcb });};return _adeed ;};func _age (_deea *symbol ){_cbfe :=_g .New ();_bad :=_cbfe .NewStyledParagraph ();_bad .SetMargins (0,0,0,0);
_dde :=_bad .Append (_deea ._cgdg );if _deea ._fabe !=nil {_dde .Style =*_deea ._fabe ;};_deea ._badfd =_bad .Height ();if _deea ._afg ==0{_deea ._afg =_bad .Width ();};};func (_aaa *convertContext )getSymbolsFromR (_aff []*_ceg .CT_RElt ,_agea *style )[]*symbol {_aeaf :=[]*symbol {};
for _ ,_ddb :=range _aff {_bbb :=_aaa .combineCellStyleWithRPrElt (_agea ,_ddb .RPr );for _ ,_fdfd :=range _ddb .T {_aeaf =append (_aeaf ,&symbol {_cgdg :string (_fdfd ),_fabe :_aaa .makeTextStyleFromCellStyle (_bbb )});};};return _aeaf ;};func _edgb (_gecf []*symbol )float64 {_fdbe :=0.0;
for _ ,_ddcc :=range _gecf {if _ddcc ._badfd > _fdbe {_fdbe =_ddcc ._badfd ;};};return _fdbe ;};func (_gbbg *convertContext )makeTextStyleFromCellStyle (_agaac *style )*_g .TextStyle {_gaed :=_gbbg ._daag .NewTextStyle ();if _agaac ==nil {_gaed .FontSize =_b .DefaultFontSize ;
_gaed .Font =_b .AssignStdFontByName (_gaed ,_b .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_gaed ;};if _bbbd (_agaac ._cegc ){_gaed .Underline =true ;_gaed .UnderlineStyle =_g .TextDecorationLineStyle {Offset :0.5,Thickness :_dbbfd (1/32)};
};var _gbdf FontStyle ;if _bbbd (_agaac ._dbgc )&&_bbbd (_agaac ._efdf ){_gbdf =FontStyle_BoldItalic ;}else if _bbbd (_agaac ._dbgc ){_gbdf =FontStyle_Bold ;}else if _bbbd (_agaac ._efdf ){_gbdf =FontStyle_Italic ;}else {_gbdf =FontStyle_Regular ;};_bcgd :="\u0064e\u0066\u0061\u0075\u006c\u0074";
if _agaac ._bgf !=nil {_bcgd =*_agaac ._bgf ;};if _dcef ,_degb :=_b .StdFontsMap [_bcgd ];_degb {_gaed .Font =_b .AssignStdFontByName (_gaed ,_dcef [_gbdf ]);}else if _dga :=_b .GetRegisteredFont (_bcgd ,_gbdf );_dga !=nil {_gaed .Font =_dga ;}else {_af .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_bcgd ,_gbdf );
_gaed .Font =_b .AssignStdFontByName (_gaed ,_b .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_gbdf ]);};if _agaac ._gbga !=nil {_gaed .FontSize =_cf .Round (*_agaac ._gbga *_gbbg ._efe );};if _agaac ._dcd !=nil {_gaed .Color =_g .ColorRGBFromHex (*_agaac ._dcd );
};if _agaac ._fcga !=nil &&*_agaac ._fcga {_gaed .FontSize *=_ff ;}else if _agaac ._gbgd !=nil &&*_agaac ._gbgd {_gaed .FontSize *=_ff ;};return &_gaed ;};func (_fc *convertContext )makeMergedCells (){_eac :=[]*mergedCell {};for _ ,_dbc :=range _fc ._eecgb .MergedCells (){_edfc ,_afe ,_dgb :=_gg .ParseRangeReference (_dbc .Reference ());
if _dgb !=nil {_af .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_dgb );continue ;};_bgb :=mergedCell {_bcf :_edfc .RowIdx ,_bdd :_edfc .ColumnIdx ,_bccc :_afe .RowIdx ,_ada :_afe .ColumnIdx };
for _fag :=_bgb ._bdd -1;_fag < _bgb ._ada ;_fag ++{_bgb ._geba +=_fc ._eea [_fag ]._bca ;};for _dccb :=_bgb ._bcf -1;_dccb < _bgb ._bccc ;_dccb ++{_bgb ._aca +=_fc ._dfga [_dccb ]._abbaa ;};_eac =append (_eac ,&_bgb );};_fc ._fded =_eac ;};const _df =0.0;
func (_fecg *convertContext )getStyle (_dgdde *uint32 )*style {_bace :=&style {};_aacb :=false ;if _dgdde !=nil {_aeae :=_fecg ._cff .GetCellStyle (*_dgdde );if _fecg ._cff .GetNumberFormat (_aeae .NumberFormat ()).GetFormat ()=="\u003b\u003b\u003b"{_bace ._acbc =true ;
};if _aeae .GetFill ()!=nil &&_aeae .GetFill ().PatternFill !=nil {if _aeae .GetFill ().PatternFill .FgColor !=nil {_bace ._gfeee =_fecg .getColorStringFromSmlColor (_aeae .GetFill ().PatternFill .FgColor );}else if _aeae .GetFill ().PatternFill .BgColor !=nil {_bace ._gfeee =_fecg .getColorStringFromSmlColor (_aeae .GetFill ().PatternFill .BgColor );
};};_ggdf :=_aeae .GetFont ();for _ ,_cedd :=range _ggdf .Name {if _cedd !=nil {_bace ._bgf =&_cedd .ValAttr ;_aacb =true ;break ;};};for _ ,_abage :=range _ggdf .B {if _abage !=nil {_fbfe :=_abage .ValAttr ==nil ||*_abage .ValAttr ;_bace ._dbgc =&_fbfe ;
_aacb =true ;break ;};};for _ ,_bdfc :=range _ggdf .I {if _bdfc !=nil {_cdda :=_bdfc .ValAttr ==nil ||*_bdfc .ValAttr ;_bace ._efdf =&_cdda ;_aacb =true ;break ;};};for _ ,_aacbe :=range _ggdf .U {if _aacbe !=nil {_gdeg :=_aacbe .ValAttr ==_ceg .ST_UnderlineValuesSingle ||_aacbe .ValAttr ==_ceg .ST_UnderlineValuesUnset ;
_bace ._cegc =&_gdeg ;_aacb =true ;break ;};};for _ ,_fae :=range _ggdf .Sz {if _fae !=nil {_beea :=_fae .ValAttr ;_bace ._gbga =&_beea ;_aacb =true ;break ;};};for _ ,_caeg :=range _ggdf .VertAlign {if _caeg !=nil {_aegd :=_caeg .ValAttr ==_ac .ST_VerticalAlignRunSuperscript ;
_bace ._fcga =&_aegd ;_acfb :=_caeg .ValAttr ==_ac .ST_VerticalAlignRunSubscript ;_bace ._gbgd =&_acfb ;_aacb =true ;break ;};};for _ ,_fgca :=range _ggdf .Color {if _fgca !=nil {_bace ._dcd =_fecg .getColorStringFromSmlColor (_fgca );_aacb =true ;break ;
};};_ddfb :=_aeae .GetBorder ();if _ddfb .Top !=nil {_bace ._eedf =_fecg .getBorder (_ddfb .Top );_aacb =true ;};if _ddfb .Bottom !=nil {_bace ._bac =_fecg .getBorder (_ddfb .Bottom );_aacb =true ;};if _ddfb .Left !=nil {_bace ._bba =_fecg .getBorder (_ddfb .Left );
_aacb =true ;};if _ddfb .Right !=nil {_bace ._afdf =_fecg .getBorder (_ddfb .Right );_aacb =true ;};if _aeae .Wrapped (){_bace ._eadc =true ;_aacb =true ;};if _bcce :=_aeae .GetVerticalAlignment ();_bcce !=_ceg .ST_VerticalAlignmentUnset {_bace ._bbbb =_bcce ;
_aacb =true ;};if _cdcd :=_aeae .GetHorizontalAlignment ();_cdcd !=_ceg .ST_HorizontalAlignmentUnset {_bace ._bbge =_cdcd ;_aacb =true ;};};if _aacb {return _bace ;};return nil ;};type anchor struct{_acge _a .Image ;_agfd *_cb .ChartSpace ;_fcgd int ;_abdf int64 ;
_ffa int ;_dgeg int64 ;_ecfd int ;_baff int64 ;_geaa int ;_ebbf int64 ;};func (_ebbd *convertContext )getDxfStyle (_ffae *uint32 )*style {_fbbf :=&style {};_bfd :=false ;if _ffae !=nil {var _aaf *_ceg .CT_Dxf ;for _cee ,_cfce :=range _ebbd ._cff .X ().Dxfs .Dxf {if uint32 (_cee )==*_ffae {_aaf =_cfce ;
};};if _aaf ==nil {return nil ;};if _aaf .Fill !=nil &&_aaf .Fill .PatternFill !=nil {if _aaf .Fill .PatternFill .FgColor !=nil {_fbbf ._gfeee =_ebbd .getColorStringFromSmlColor (_aaf .Fill .PatternFill .FgColor );}else if _aaf .Fill .PatternFill .BgColor !=nil {_fbbf ._gfeee =_ebbd .getColorStringFromSmlColor (_aaf .Fill .PatternFill .BgColor );
};};_cdab :=_aaf .Font ;for _ ,_aagd :=range _cdab .Name {if _aagd !=nil {_fbbf ._bgf =&_aagd .ValAttr ;_bfd =true ;break ;};};for _ ,_fbdc :=range _cdab .B {if _fbdc !=nil {_eada :=_fbdc .ValAttr ==nil ||*_fbdc .ValAttr ;_fbbf ._dbgc =&_eada ;_bfd =true ;
break ;};};for _ ,_dgac :=range _cdab .I {if _dgac !=nil {_bcd :=_dgac .ValAttr ==nil ||*_dgac .ValAttr ;_fbbf ._efdf =&_bcd ;_bfd =true ;break ;};};for _ ,_bfdc :=range _cdab .U {if _bfdc !=nil {_eba :=_bfdc .ValAttr ==_ceg .ST_UnderlineValuesSingle ||_bfdc .ValAttr ==_ceg .ST_UnderlineValuesUnset ;
_fbbf ._cegc =&_eba ;_bfd =true ;break ;};};for _ ,_efaa :=range _cdab .Sz {if _efaa !=nil {_ecgg :=_efaa .ValAttr ;_fbbf ._gbga =&_ecgg ;_bfd =true ;break ;};};for _ ,_bdfdc :=range _cdab .VertAlign {if _bdfdc !=nil {_ebag :=_bdfdc .ValAttr ==_ac .ST_VerticalAlignRunSuperscript ;
_fbbf ._fcga =&_ebag ;_eafe :=_bdfdc .ValAttr ==_ac .ST_VerticalAlignRunSubscript ;_fbbf ._gbgd =&_eafe ;_bfd =true ;break ;};};for _ ,_beede :=range _cdab .Color {if _beede !=nil {_fbbf ._dcd =_ebbd .getColorStringFromSmlColor (_beede );_bfd =true ;break ;
};};_dbagc :=_aaf .Border ;if _dbagc !=nil {if _dbagc .Top !=nil {_fbbf ._eedf =_ebbd .getBorder (_dbagc .Top );_bfd =true ;};if _dbagc .Bottom !=nil {_fbbf ._bac =_ebbd .getBorder (_dbagc .Bottom );_bfd =true ;};if _dbagc .Left !=nil {_fbbf ._bba =_ebbd .getBorder (_dbagc .Left );
_bfd =true ;};if _dbagc .Right !=nil {_fbbf ._afdf =_ebbd .getBorder (_dbagc .Right );_bfd =true ;};};if _aaf .Alignment !=nil {if _cbae :=_aaf .Alignment .VerticalAttr ;_cbae !=_ceg .ST_VerticalAlignmentUnset {_fbbf ._bbbb =_cbae ;_bfd =true ;};if _ggbf :=_aaf .Alignment .HorizontalAttr ;
_ggbf !=_ceg .ST_HorizontalAlignmentUnset {_fbbf ._bbge =_ggbf ;_bfd =true ;};};};if _bfd {return _fbbf ;};return nil ;};func (_fbga *convertContext )alignSymbolsVertically (_aaac *cell ,_afbg _ceg .ST_VerticalAlignment ){var _dcfc float64 ;switch _afbg {case _ceg .ST_VerticalAlignmentTop :_dcfc =_ad ;
if _aaac ._dbgd {_dcfc -=_fa ;}else if _aaac ._cbga {_dcfc +=4*_fa ;};for _ ,_fgac :=range _aaac ._bfg {_dcfc +=_fgac ._gdd ;_fgac ._bggc =_dcfc ;_dcfc +=_gf ;};case _ceg .ST_VerticalAlignmentCenter :_fadf :=0.0;for _ ,_fgf :=range _aaac ._bfg {_fadf +=_fgf ._gdd +_dbbfd (1);
};_dcfc =0.5*(_aaac ._geb -_fadf );if _aaac ._dbgd {_dcfc -=2*_fa ;}else if _aaac ._cbga {_dcfc +=2*_fa ;};for _ ,_eddd :=range _aaac ._bfg {_dcfc +=_eddd ._gdd +0.5*_gf ;_eddd ._bggc =_dcfc ;_dcfc +=0.5*_gf ;};default:_dcfc =_aaac ._geb -_ad ;if _aaac ._dbgd {_dcfc -=4*_fa ;
}else if _aaac ._cbga {_dcfc +=_fa ;};for _gcfc :=len (_aaac ._bfg )-1;_gcfc >=0;_gcfc --{_aaac ._bfg [_gcfc ]._bggc =_dcfc ;_dcfc -=_aaac ._bfg [_gcfc ]._gdd ;_dcfc -=_gf ;};};};func (_efb *convertContext )makeAnchors (){_faa ,_gfe :=_efb ._eecgb .GetDrawing ();
if _faa !=nil {for _ ,_caf :=range _faa .EG_Anchor {_aba :=&anchor {};if _daa :=_caf .TwoCellAnchor ;_daa !=nil {_ddg ,_cac :=_daa .From ,_daa .To ;if _ddg ==nil ||_cac ==nil {return ;};_aba ._fcgd =int (_ddg .Row );_aba ._abdf =_b .FromSTCoordinate (_ddg .RowOff );
_aba ._ffa =int (_ddg .Col );_aba ._dgeg =_b .FromSTCoordinate (_ddg .ColOff );_aba ._ecfd =int (_cac .Row );_aba ._baff =_b .FromSTCoordinate (_cac .RowOff );_aba ._geaa =int (_cac .Col );_aba ._ebbf =_b .FromSTCoordinate (_cac .ColOff );if _ge :=_daa .Choice ;
_ge !=nil {if _gdfg :=_ge .Pic ;_gdfg !=nil {if _ebb :=_gdfg .BlipFill ;_ebb !=nil {if _cef :=_ebb .Blip ;_cef !=nil {if _dac :=_cef .EmbedAttr ;_dac !=nil {for _ ,_gfb :=range _gfe .X ().Relationship {if _gfb .IdAttr ==*_dac {for _ ,_be :=range _efb ._ebef .Images {if _be .Target ()==_gfb .TargetAttr {_bf ,_ggc :=_fb .Open (_be .Path ());
if _ggc !=nil {_af .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_ggc );continue ;};_fff ,_ ,_ggc :=_a .Decode (_bf );if _ggc !=nil {_af .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_ggc );
continue ;};_aba ._acge =_fff ;};};};};};};};}else if _ba :=_ge .GraphicFrame ;_ba !=nil {if _bdf :=_ba .Graphic ;_bdf !=nil {if _aa :=_bdf .GraphicData ;_aa !=nil {for _ ,_fba :=range _aa .Any {if _cge ,_dbb :=_fba .(*_cb .Chart );_dbb {for _ ,_gdfgf :=range _gfe .X ().Relationship {if _gdfgf .IdAttr ==_cge .IdAttr {_adb :=_efb ._ebef .GetChartByTargetId (_gdfgf .TargetAttr );
if _adb !=nil {_aba ._agfd =_adb ;};};};};};};};};};};if _aba ._acge !=nil ||_aba ._agfd !=nil {_efb ._fbba =append (_efb ._fbba ,_aba );};};};};type pagespan struct{_fcf float64 ;_fffe []*page ;_baf int ;_dgbe int ;};func _caa (_cged []*symbol )float64 {_badf :=0.0;
for _ ,_gae :=range _cged {_badf +=_gae ._afg ;};return _badf ;};type symbol struct{_cgdg string ;_gdfb float64 ;_badfd float64 ;_afg float64 ;_fabe *_g .TextStyle ;_afef string ;};func (_caea *convertContext )getContentFromCell (_dccaf *_ef .Sheet ,_cfe _ef .Cell ,_abba *style ,_adbf float64 ,_bcg ,_bdbf bool )([]*line ,_ceg .ST_CellType ){if _bdbf {return []*line {},_ceg .ST_CellTypeS ;
};_dge :=_cfe .X ();var _bbcfd []*symbol ;switch _dge .TAttr {case _ceg .ST_CellTypeS :_dbf :=_dge .V ;if _dbf !=nil {_defa ,_ebd :=_cc .Atoi (*_dbf );if _ebd ==nil {_bcee :=_caea ._ebef .SharedStrings .X ().Si [_defa ];if _bcee .T !=nil {_bbcfd =_caea .getSymbolsFromString (*_bcee .T ,_abba );
}else if _bcee .R !=nil {_bbcfd =_caea .getSymbolsFromR (_bcee .R ,_abba );};};};case _ceg .ST_CellTypeB :_gfea :=_dge .V ;if _gfea !=nil {if *_gfea =="\u0030"{_bbcfd =_caea .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_abba );}else {_bbcfd =_caea .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_abba );
};};case _ceg .ST_CellTypeStr :if _dge .F !=nil {_faab :=_ab .NewEvaluator ();_fbeb :=_dccaf .FormulaContext ().Cell (_cfe .Reference (),_faab );_bbcfd =_caea .getSymbolsFromString (_fbeb .Value (),_abba );};default:_bbcfd =_caea .getSymbolsFromString (_cfe .GetFormattedValue (),_abba );
};_bbcac :=0.0;_efg :=0.0;var _cafe []*line ;var _adeeg bool ;if _abba !=nil {if _abba ._fcga !=nil {if *_abba ._fcga {_adeeg =true ;};};if _abba ._gbgd !=nil {if *_abba ._gbgd {_adeeg =true ;};};};if _bcg {_cafe =[]*line {};_ede :=_adbf -2*_bd ;_gbg :=[]*symbol {};
for _ ,_ddf :=range _bbcfd {_age (_ddf );if _bbcac +_ddf ._afg >=_ede {_cbb :=_edgb (_gbg );if _adeeg {_cbb /=_ff ;};_cafe =append (_cafe ,&line {_bggc :_efg ,_adfd :_gbg ,_gdd :_cbb });_gbg =[]*symbol {_ddf };_bbcac =_ddf ._afg ;_efg +=_cbb ;}else {_ddf ._gdfb =_bbcac ;
_bbcac +=_ddf ._afg ;_gbg =append (_gbg ,_ddf );};};_bbfa :=_edgb (_gbg );if _adeeg {_bbfa /=_ff ;};if len (_gbg )> 0{_cafe =append (_cafe ,&line {_bggc :_efg ,_adfd :_gbg ,_gdd :_bbfa });};}else {for _ ,_fdg :=range _bbcfd {_age (_fdg );_fdg ._gdfb =_bbcac ;
_bbcac +=_fdg ._afg ;};if len (_bbcfd )> 0{_cafe =[]*line {&line {_adfd :_bbcfd ,_gdd :_edgb (_bbcfd )}};};};_bdbb :=_dge .TAttr ;if _bdbb ==_ceg .ST_CellTypeUnset {_bdbb =_ceg .ST_CellTypeN ;};return _cafe ,_bdbb ;};func (_cfge *convertContext )drawPage (_ffe *page ){_edc :=_cfge ._fcge ;
_adce :=_cfge ._acfed ;for _ ,_dceb :=range _ffe ._ccff {_afa :=_cfge ._dfga [_dceb ._ebde ];for _ ,_agaa :=range _dceb ._aacc {var _gbc float64 ;if _dceb ._ebde > 1{_gbc =_cfge ._dfga [_dceb ._ebde -1]._agga ;};var _bdc ,_fbbb float64 ;if _fcg :=_agaa ._eagd ;
_fcg !=nil {_bdc =_fcg ._cegd ;};if _dfc :=_agaa ._fea ;_dfc !=nil {_fbbb =_dfc ._cegd ;};_eab :=_edc +_afa ._ecf -0.5*(_gbc -_bdc );_effd :=_edc +_afa ._ecf +_afa ._abbaa +0.5*(_afa ._agga +_fbbb );_fabg :=_adce +_agaa ._adge ;_fbg :=_fabg +_agaa ._gfead ;
if _agaa ._aeafg !=nil &&_agaa ._aeafg !=_g .ColorBlack {_b .FillRectangle (_cfge ._daag ,_fabg ,_eab ,_fbg -_fabg ,_effd -_eab ,_agaa ._aeafg );};};};for _ ,_fdc :=range _ffe ._ccff {_adgd :=_cfge ._dfga [_fdc ._ebde ];for _ ,_adea :=range _fdc ._aacc {_cdc :=_adea ._dbag < _adea ._adge ;
_dfad :=_adea ._dff > _adea ._adge +_adea ._cdcf ;var _ecd ,_adgf bool ;for _ ,_cba :=range _adea ._bfg {for _ ,_gdg :=range _cba ._adfd {if _cdc &&!_ecd {_ecd =_gdg ._gdfb < 0;};if _dfad &&!_adgf {_adgf =_adea ._cdcf < _gdg ._gdfb +_gdg ._afg ;};if _adea ._adge +_gdg ._gdfb >=_adea ._dbag &&_adea ._adge +_gdg ._gdfb +_gdg ._afg <=_adea ._dff {_edga :=_cfge ._daag .NewStyledParagraph ();
_gcd :=_adce +_adea ._adge +_gdg ._gdfb ;_dfeb :=_edc +_adgd ._ecf +_cba ._bggc -_gdg ._badfd -_dbbfd (0.5);_edga .SetPos (_gcd ,_dfeb );var _afcb *_g .TextChunk ;if _gdg ._afef !=""{_afcb =_edga .AddExternalLink (_gdg ._cgdg ,_gdg ._afef );}else {_afcb =_edga .Append (_gdg ._cgdg );
};if _gdg ._fabe !=nil {_afcb .Style =*_gdg ._fabe ;};_cfge ._daag .Draw (_edga );};};};var _adca ,_beb ,_acfe ,_ffg ,_ggda ,_gac float64 ;var _agfb ,_daecd ,_fegb ,_bbcf _g .Color ;if _dada :=_adea ._eagd ;_dada !=nil {_adca =_dada ._cegd ;_agfb =_dada ._agab ;
};if _ggf :=_adea ._fea ;_ggf !=nil {_beb =_ggf ._cegd ;_daecd =_ggf ._agab ;};if _gfbb :=_adea ._gbgaf ;_gfbb !=nil {_acfe =_gfbb ._cegd ;_ggda =_acfe /2;_fegb =_gfbb ._agab ;};if _ged :=_adea ._agca ;_ged !=nil {_ffg =_ged ._cegd ;_gac =_ffg /2;_bbcf =_ged ._agab ;
};var _gga float64 ;if _fdc ._ebde > 1{_gga =_cfge ._dfga [_fdc ._ebde -1]._agga ;};_abaa :=_edc +_adgd ._ecf -0.5*(_gga -_adca );_fdef :=_edc +_adgd ._ecf +_adgd ._abbaa +0.5*(_adgd ._agga +_beb );_afac :=_adce +_adea ._adge ;_fec :=_afac +_adea ._gfead ;
_b .DrawLine (_cfge ._daag ,_afac ,_abaa ,_fec ,_abaa ,_adca ,_agfb );_b .DrawLine (_cfge ._daag ,_afac ,_fdef ,_fec ,_fdef ,_beb ,_daecd );if !_ecd {_b .DrawLine (_cfge ._daag ,_afac -_ggda ,_abaa ,_afac -_ggda ,_fdef ,_acfe ,_fegb );};if !_adgf {_b .DrawLine (_cfge ._daag ,_fec -_gac ,_abaa ,_fec -_gac ,_fdef ,_ffg ,_bbcf );
};};};for _ ,_bbca :=range _ffe ._bgba {if _bbca !=nil {_cfge ._daag .Draw (_bbca );};};};func (_ffbe *convertContext )imageFromAnchor (_ebbb *anchor ,_cea ,_fbf float64 )_a .Image {if _ebbb ._acge !=nil {return _ebbb ._acge ;};if _ebbb ._agfd !=nil {_cdg ,_agc :=_b .MakeImageFromChartSpace (_ebbb ._agfd ,_cea ,_fbf ,_ffbe ._ceda ,_ffbe ._ebef );
if _agc !=nil {_af .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_agc );
return nil ;};return _cdg ;};return nil ;};type line struct{_bggc float64 ;_adfd []*symbol ;_gdd float64 ;};type page struct{_ccff []*pageRow ;_aggfc bool ;_bgba []*_g .Image ;_fbff *pagespan ;_efea *rowspan ;};func (_fdac *convertContext )makePagespans (){_fdac ._abae =[]*pagespan {};
_cfg :=0.0;_dce :=0;for _aeaa ,_fgea :=range _fdac ._eea {_bdfd :=_fgea ._bca ;if _cfg +_bdfd <=_fdac ._beda {_fgea ._gfbbf =_cfg ;_cfg +=_bdfd ;}else {_fgea ._gfbbf =0;_fdac ._abae =append (_fdac ._abae ,&pagespan {_fcf :_cfg ,_baf :_dce ,_dgbe :_aeaa });
_cfg =_bdfd ;_dce =_aeaa ;};};_fdac ._abae =append (_fdac ._abae ,&pagespan {_fcf :_cfg ,_baf :_dce ,_dgbe :len (_fdac ._eea )});};func _bbbd (_abfc *bool )bool {return _abfc !=nil &&*_abfc };type border struct{_cegd float64 ;_agab _g .Color ;};const _gdf =15.0;


// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_b .FontStyle ;const _ff =0.64;func _cedae (_ccc ,_eee *style ){if _eee ==nil {return ;};if _ccc ==nil {_ccc =_eee ;return ;};if _ccc ._gfeee ==nil {_ccc ._gfeee =_eee ._gfeee ;};if _ccc ._bgf ==nil {_ccc ._bgf =_eee ._bgf ;};if _ccc ._dcd ==nil {_ccc ._dcd =_eee ._dcd ;
};if _ccc ._gbga ==nil {_ccc ._gbga =_eee ._gbga ;};if _ccc ._dbgc ==nil {_ccc ._dbgc =_eee ._dbgc ;};if _ccc ._efdf ==nil {_ccc ._efdf =_eee ._efdf ;};if _ccc ._cegc ==nil {_ccc ._cegc =_eee ._cegc ;};if _ccc ._fcga ==nil {_ccc ._fcga =_eee ._fcga ;};
if _ccc ._gbgd ==nil {_ccc ._gbgd =_eee ._gbgd ;};if _ccc ._eedf ==nil {_ccc ._eedf =_eee ._eedf ;};if _ccc ._bac ==nil {_ccc ._bac =_eee ._bac ;};if _ccc ._bba ==nil {_ccc ._bba =_eee ._bba ;};if _ccc ._afdf ==nil {_ccc ._afdf =_eee ._afdf ;};if _ccc ._bbbb ==_ceg .ST_VerticalAlignmentUnset {_ccc ._bbbb =_eee ._bbbb ;
};if _ccc ._bbge ==_ceg .ST_HorizontalAlignmentUnset {_ccc ._bbge =_eee ._bbge ;};};var _eff =_dbbfd (0.0625);func (_efde *convertContext )fillPages (){for _afb ,_gec :=range _efde ._acdb {_abea :=_efde ._dfga [_gec ._gbe :_gec ._acgf ];for _cga ,_dcg :=range _abea {_ddc :=0;
_dfb :=0.0;_ffb :=[]*cell {};if _dcg ._ddcb {for _ ,_agf :=range _dcg ._cdca {_ebeb :=_efde ._abae [_ddc ];_efde ._gdee =_ebeb ._fffe [_afb ];_efde ._gdee ._aggfc =true ;_daef :=_agf ._gfead ;if _dfb +_daef > _ebeb ._fcf {_efde .addRowToPage (_ffb ,_cga );
_ffb =[]*cell {_agf };_dfb =_daef ;_ddc ++;}else {_agf ._adge =_dfb ;_ffb =append (_ffb ,_agf );_dfb +=_daef ;};};if len (_ffb )> 0{_dee :=_efde ._abae [_ddc ];_efde ._gdee =_dee ._fffe [_afb ];_efde ._gdee ._aggfc =true ;_efde .addRowToPage (_ffb ,_cga );
};};};};};type rowInfo struct{_ecf float64 ;_ddcb bool ;_abbaa float64 ;_fefb *style ;_cdca []*cell ;_agga float64 ;};func _dbbfd (_befaf float64 )float64 {return _befaf *_d .Millimeter };func (_dfe *convertContext )makePages (){for _ ,_faae :=range _dfe ._abae {for _ ,_fega :=range _dfe ._acdb {_faae ._fffe =append (_faae ._fffe ,&page {_ccff :[]*pageRow {},_fbff :_faae ,_efea :_fega });
};};};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_e .PdfFont ){_b .RegisterFont (name ,style ,font )};func (_cgdc *convertContext )getBorder (_cbca *_ceg .CT_BorderPr )*border {_bffa :=&border {};switch _cbca .StyleAttr {case _ceg .ST_BorderStyleHair :_bffa ._cegd =_eff /2;
case _ceg .ST_BorderStyleThin :_bffa ._cegd =_eff ;case _ceg .ST_BorderStyleMedium :_bffa ._cegd =_eff *2;case _ceg .ST_BorderStyleThick :_bffa ._cegd =_eff *4;};if _bffa ._cegd ==0.0{return nil ;};if _dfce :=_cbca .Color ;_dfce !=nil {_abgg :=_cgdc .getColorStringFromSmlColor (_dfce );
if _abgg !=nil {_bffa ._agab =_g .ColorRGBFromHex (*_abgg );}else {_bffa ._agab =_g .ColorBlack ;};};return _bffa ;};type style struct{_gfeee *string ;_dcd *string ;_gbga *float64 ;_bgf *string ;_dbgc *bool ;_efdf *bool ;_cegc *bool ;_fcga *bool ;_gbgd *bool ;
_eedf *border ;_bac *border ;_bba *border ;_afdf *border ;_eadc bool ;_bbbb _ceg .ST_VerticalAlignment ;_bbge _ceg .ST_HorizontalAlignment ;_acbc bool ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;
);var _gf =_dbbfd (1);func (_de *convertContext )makeCells (){_dbd :=_de ._eecgb ;_efbe :=_dbd .Rows ();_dfa :=0;for _eeg ,_eef :=range _de ._dfga {if _eeg < _de ._fee ||(_eeg > _de ._edff &&_de ._edff > 0){continue ;};_eef ._cdca =[]*cell {};_dbcb :=0.0;
_bbg :=_eef ._fefb ;if _eef ._ddcb {_cec :=_efbe [_dfa ];_dfa ++;_baa :=_eef ._abbaa ;for _ ,_ced :=range _cec .Cells (){_afd ,_fda :=_gg .ParseCellReference (_ced .Reference ());if _fda !=nil {_af .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_fda );
continue ;};if int (_afd .ColumnIdx )< _de ._gbb ||(int (_afd .ColumnIdx )> _de ._cffa &&_de ._cffa > 0){continue ;};_eg :=_de ._eea [_afd .ColumnIdx ];_gfaa :=_eg ._bca ;_gcg :=_gfaa ;_eed :=_eg ._fcd ;var _cgd ,_cfd ,_aag ,_bda bool ;for _ ,_cfc :=range _de ._fded {if _afd .RowIdx >=_cfc ._bcf &&_afd .RowIdx <=_cfc ._bccc &&_afd .ColumnIdx >=_cfc ._bdd &&_afd .ColumnIdx <=_cfc ._ada {if _afd .ColumnIdx ==_cfc ._bdd &&_afd .RowIdx ==_cfc ._bcf {_gfaa =_cfc ._geba ;
_baa =_cfc ._aca ;};_cgd =_afd .RowIdx !=_cfc ._bcf ;_cfd =_afd .RowIdx !=_cfc ._bccc ;_aag =_afd .ColumnIdx !=_cfc ._bdd ;_bda =_afd .ColumnIdx !=_cfc ._ada ;};};var _gee *style ;for _ ,_cd :=range _de ._eefg {_bc ,_bce ,_egd :=_gg .ParseRangeReference (_cd .Reference ());
if _egd !=nil ||_bc .RowIdx > _afd .RowIdx ||_bc .ColumnIdx > _afd .ColumnIdx ||_bce .RowIdx < _afd .RowIdx ||_bce .ColumnIdx < _afd .ColumnIdx ||_de ._ebef .StyleSheet .X ().TableStyles ==nil {continue ;};_cfde :=_afd .RowIdx ==_bc .RowIdx ;for _ ,_abe :=range _de ._ebef .StyleSheet .X ().TableStyles .TableStyle {if _cd .X ().TableStyleInfo .NameAttr !=nil &&_abe .NameAttr ==*_cd .X ().TableStyleInfo .NameAttr {for _ ,_dcca :=range _abe .TableStyleElement {if !_cfde &&_dcca .TypeAttr ==_ceg .ST_TableStyleTypeWholeTable {_gee =_de .getDxfStyle (_dcca .DxfIdAttr );
};if _cfde &&_dcca .TypeAttr ==_ceg .ST_TableStyleTypeHeaderRow {_gee =_de .getDxfStyle (_dcca .DxfIdAttr );};};};};};_dad :=_de .getStyleFromCell (_ced ,_bbg ,_eed ,_gee );var _ccg ,_aagf ,_cbgd ,_cca bool ;var _bcc ,_aggf ,_fge ,_dacb *border ;var _gdb _ceg .ST_VerticalAlignment ;
var _fef _ceg .ST_HorizontalAlignment ;if _dad !=nil {if !_cgd {_bcc =_dad ._eedf ;};if !_cfd {_aggf =_dad ._bac ;};if !_aag {_fge =_dad ._bba ;};if !_bda {_dacb =_dad ._afdf ;};if _aggf !=nil &&_aggf ._cegd > _dbcb {_dbcb =_aggf ._cegd ;};_gdb =_dad ._bbbb ;
_fef =_dad ._bbge ;if _dad ._fcga !=nil {_ccg =*_dad ._fcga ;};if _dad ._gbgd !=nil {_aagf =*_dad ._gbgd ;};_cbgd =_dad ._eadc ;_cca =_dad ._acbc ;};var _gbd _g .Color ;if _dad !=nil &&_dad ._gfeee !=nil {_gbd =_g .ColorRGBFromHex (*_dad ._gfeee );};_fce ,_cfb :=_de .getContentFromCell (_dbd ,_ced ,_dad ,_gfaa ,_cbgd ,_cca );
_bgd :=&cell {_ddcbe :_cfb ,_cdcf :_gfaa ,_gfead :_gcg ,_geb :_baa ,_bfg :_fce ,_eagd :_bcc ,_fea :_aggf ,_gbgaf :_fge ,_agca :_dacb ,_dbgd :_ccg ,_cbga :_aagf ,_aeafg :_gbd };_de .alignSymbolsHorizontally (_bgd ,_fef );_de .alignSymbolsVertically (_bgd ,_gdb );
_eef ._cdca =append (_eef ._cdca ,_bgd );};};_eef ._agga =_dbcb ;};};const _ad =2;func (_ead *convertContext )makeRows (){_ga :=[]*rowInfo {};_feg :=_ead ._eecgb .Rows ();_cbg :=0;_acbb :=0.0;for _eaf ,_gcf :=range _feg {if _eaf < _ead ._fee ||(_eaf > _ead ._edff &&_ead ._edff > 0){continue ;
};_cbg ++;_edd :=int (_gcf .RowNumber ());if _edd > _cbg {for _ade :=_cbg ;_ade < _edd ;_ade ++{_ga =append (_ga ,&rowInfo {_abbaa :_gdf /_cg });_acbb +=_gdf /_cg ;};_cbg =_edd ;};var _bfa float64 ;if _gcf .X ().HtAttr ==nil {_bfa =_gdf ;}else {_bfa =*_gcf .X ().HtAttr ;
};_ga =append (_ga ,&rowInfo {_abbaa :_bfa /_cg ,_ddcb :true ,_fefb :_ead .getStyle (_gcf .X ().SAttr )});_acbb +=_bfa /_cg ;};for _dae :=len (_ga );_dae < _ead ._fdaf ;_dae ++{_ga =append (_ga ,&rowInfo {_abbaa :_gdf /_cg });_acbb +=_gdf /_cg ;};if _ead ._fbgb ||_acbb >=_ead ._bebg {_adc :=_ead ._efe ;
if _ead ._bebg /_acbb < _ead ._efe {_adc =_ead ._bebg /_acbb ;};for _ ,_bee :=range _ga {_bee ._abbaa *=_adc ;};};_ead ._dfga =_ga ;};func (_bcgf *convertContext )getColorFromTheme (_ecc uint32 )string {_dgaf :=_bcgf ._ebef .Themes ();if len (_dgaf )!=0{_deee :=_dgaf [0];
if _abgeb :=_deee .ThemeElements ;_abgeb !=nil {if _dbcd :=_abgeb .ClrScheme ;_dbcd !=nil {switch _ecc {case 0:return _b .GetColorStringFromDmlColor (_dbcd .Lt1 );case 1:return _b .GetColorStringFromDmlColor (_dbcd .Dk1 );case 2:return _b .GetColorStringFromDmlColor (_dbcd .Lt2 );
case 3:return _b .GetColorStringFromDmlColor (_dbcd .Dk2 );case 4:return _b .GetColorStringFromDmlColor (_dbcd .Accent1 );case 5:return _b .GetColorStringFromDmlColor (_dbcd .Accent2 );case 6:return _b .GetColorStringFromDmlColor (_dbcd .Accent3 );case 7:return _b .GetColorStringFromDmlColor (_dbcd .Accent4 );
case 8:return _b .GetColorStringFromDmlColor (_dbcd .Accent5 );case 9:return _b .GetColorStringFromDmlColor (_dbcd .Accent6 );};};};};return "";};func (_effc *convertContext )alignSymbolsHorizontally (_dfaa *cell ,_ddbc _ceg .ST_HorizontalAlignment ){if _ddbc ==_ceg .ST_HorizontalAlignmentUnset {switch _dfaa ._ddcbe {case _ceg .ST_CellTypeB :_ddbc =_ceg .ST_HorizontalAlignmentCenter ;
case _ceg .ST_CellTypeN :_ddbc =_ceg .ST_HorizontalAlignmentRight ;default:_ddbc =_ceg .ST_HorizontalAlignmentLeft ;};};var _effcd float64 ;for _ ,_fbda :=range _dfaa ._bfg {switch _ddbc {case _ceg .ST_HorizontalAlignmentLeft :_effcd =_bd ;case _ceg .ST_HorizontalAlignmentRight :_gfee :=_caa (_fbda ._adfd );
_effcd =_dfaa ._cdcf -_bd -_gfee ;case _ceg .ST_HorizontalAlignmentCenter :_acc :=_caa (_fbda ._adfd );_effcd =(_dfaa ._cdcf -_acc )/2;};for _ ,_agec :=range _fbda ._adfd {_agec ._gdfb +=_effcd ;};};};type pageRow struct{_ebde int ;_aacc []*cell ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _b .RegisterFontsFromDirectory (dirName )};func (_eeb *convertContext )makeCols (){_acd :=_eeb ._eecgb ;_gge :=_acd .X ();_addce :=[]*colInfo {};_dba :=[]colWidthRange {};if _ae :=_gge .Cols ;
len (_ae )> 0{for _ ,_bga :=range _ae [0].Col {_acde :=_adf ;if _fbaf :=_bga .WidthAttr ;_fbaf !=nil {if *_fbaf > 0.83{*_fbaf -=0.83;};if *_fbaf <=1{_acde =*_fbaf *11;}else {_acde =5+*_fbaf *6;};};_aad :=int (_bga .MinAttr -1);_fed :=int (_bga .MaxAttr -1);
_dba =append (_dba ,colWidthRange {_ceab :_aad ,_gba :_fed ,_befa :_acde ,_bfgg :_eeb .getStyle (_bga .StyleAttr )});};};_aea :=0;for _cgg :=0;_cgg <=_eeb ._abd ;_cgg ++{if _cgg < _eeb ._gbb ||(_cgg > _eeb ._cffa &&_eeb ._cffa > 0){continue ;};var _cae float64 ;
var _bbf *style ;if len (_dba )==0{_cae =_adf ;}else if _aea < len (_dba ){_agg :=_dba [_aea ];if _cgg >=_agg ._ceab &&_cgg <=_agg ._gba {_cae =_agg ._befa ;_bbf =_agg ._bfgg ;if _cgg ==_agg ._gba {_aea ++;};}else {continue ;};};_addce =append (_addce ,&colInfo {_bca :_cae ,_fcd :_bbf });
};_aead :=0.0;for _ ,_bdg :=range _addce {_aead +=_bdg ._bca ;};_eeb ._efe =1.0;if _aead > _eeb ._beda {_eeb ._efe =_eeb ._beda /_aead ;for _ ,_edf :=range _addce {_edf ._bca *=_eeb ._efe ;};};_eeb ._eea =_addce ;};type mergedCell struct{_bcf uint32 ;_bdd uint32 ;
_bccc uint32 ;_ada uint32 ;_geba float64 ;_aca float64 ;};func (_acfec *convertContext )getStyleFromRPrElt (_abde *_ceg .CT_RPrElt )*style {if _abde ==nil {return nil ;};_edb :=&style {};_edb ._bgf =&_abde .RFont .ValAttr ;if _eedfc :=_abde .B ;_eedfc !=nil {_cgdcg :=_eedfc .ValAttr ==nil ||*_eedfc .ValAttr ;
_edb ._dbgc =&_cgdcg ;};if _cafc :=_abde .I ;_cafc !=nil {_bfe :=_cafc .ValAttr ==nil ||*_cafc .ValAttr ;_edb ._efdf =&_bfe ;};if _aecc :=_abde .U ;_aecc !=nil {_dafa :=_aecc .ValAttr ==_ceg .ST_UnderlineValuesSingle ||_aecc .ValAttr ==_ceg .ST_UnderlineValuesUnset ;
_edb ._cegc =&_dafa ;};if _fdge :=_abde .VertAlign ;_fdge !=nil {_dbe :=_fdge .ValAttr ==_ac .ST_VerticalAlignRunSuperscript ;_edb ._fcga =&_dbe ;_geab :=_fdge .ValAttr ==_ac .ST_VerticalAlignRunSubscript ;_edb ._gbgd =&_geab ;};if _cbda :=_abde .Sz ;_cbda !=nil {_fcea :=_cbda .ValAttr ;
_edb ._gbga =&_fcea ;};if _cefc :=_abde .Color ;_cefc !=nil {_edb ._dcd =_acfec .getColorStringFromSmlColor (_cefc );};return _edb ;};type rowspan struct{_ebfc float64 ;_gbe int ;_acgf int ;};type convertContext struct{_daag *_g .Creator ;_ebef *_ef .Workbook ;
_ceda *_f .Theme ;_eecgb *_ef .Sheet ;_cff *_ef .StyleSheet ;_fdaf int ;_abd int ;_abae []*pagespan ;_gdee *page ;_eea []*colInfo ;_dfga []*rowInfo ;_acdb []*rowspan ;_fcge float64 ;_acfed float64 ;_bebg float64 ;_beda float64 ;_fded []*mergedCell ;_fbba []*anchor ;
_efe float64 ;_gbb int ;_cffa int ;_fee int ;_edff int ;_fbgb bool ;_eefg []_ef .Table ;};var _gbcg =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
type cell struct{_ddcbe _ceg .ST_CellType ;_cfa int ;_adge float64 ;_bfg []*line ;_cdcf float64 ;_gfead float64 ;_geb float64 ;_dbag float64 ;_dff float64 ;_dbbg *_g .TextStyle ;_eagd *border ;_fea *border ;_gbgaf *border ;_agca *border ;_dbgd bool ;_cbga bool ;
_aeafg _g .Color ;};const _adf =64.0;var _cg =3.025/_dbbfd (1);func (_def *convertContext )drawSheet (){for _bbc ,_fdeb :=range _def ._abae {_fffa :=len (_fdeb ._fffe );if _bbc ==len (_def ._abae )-1{for _cgde :=len (_fdeb ._fffe )-1;_cgde >=0;_cgde --{if !_fdeb ._fffe [_cgde ]._aggfc {_fffa =_cgde ;
};};};_fbcf :=_fdeb ._fffe [:_fffa ];for _ ,_aac :=range _fbcf {_def ._daag .NewPage ();_def .drawPage (_aac );};};};func (_gfeg *convertContext )combineCellStyleWithRPrElt (_ebfg *style ,_cbe *_ceg .CT_RPrElt )*style {_dbfc :=*_ebfg ;_eced :=_gfeg .getStyleFromRPrElt (_cbe );
if _eced ==nil {return &_dbfc ;};if _eced ._dcd !=nil {_dbfc ._dcd =_eced ._dcd ;};if _eced ._gbga !=nil {_dbfc ._gbga =_eced ._gbga ;};if _eced ._bgf !=nil {_dbfc ._bgf =_eced ._bgf ;};if _eced ._dbgc !=nil {_dbfc ._dbgc =_eced ._dbgc ;};if _eced ._efdf !=nil {_dbfc ._efdf =_eced ._efdf ;
};if _eced ._cegc !=nil {_dbfc ._cegc =_eced ._cegc ;};if _eced ._fcga !=nil {_dbfc ._fcga =_eced ._fcga ;};if _eced ._gbgd !=nil {_dbfc ._gbgd =_eced ._gbgd ;};return &_dbfc ;};type colInfo struct{_gfbbf float64 ;_bca float64 ;_fcd *style ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_ef .Sheet )*_g .Creator {_efd :=s .X ();if _efd ==nil {return nil ;};var _add _g .PageSize ;_gfa :=true ;_addc :=false ;if _efd .SheetPr !=nil &&_efd .SheetPr .PageSetUpPr !=nil &&_efd .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_efd .SheetPr .PageSetUpPr .FitToPageAttr {_addc =true ;
};if _gb :=_efd .PageSetup ;_gb !=nil {_gfa =_gb .OrientationAttr ==_ceg .ST_OrientationLandscape ;if _bdb :=_gb .PaperSizeAttr ;_bdb !=nil {_add =_cda [*_bdb ];};};if (_add ==_g .PageSize {}){_add =_g .PageSizeA4 ;};if _gfa {_add [0],_add [1]=_add [1],_add [0];
};_dc :=_g .New ();_dc .SetPageSize (_add );var _adff ,_ca ,_efc ,_fab float64 ;if _fd :=_efd .PageMargins ;_fd !=nil {_efc =_fd .LeftAttr ;_fab =_fd .RightAttr ;_adff =_fd .TopAttr ;_ca =_fd .BottomAttr ;};if _efc < _gd {_efc =_gd ;};if _fab < _gd {_fab =_gd ;
};if _adff < _df {_adff =_df ;};if _ca < _df {_ca =_df ;};_adff *=_d .Inch ;_ca *=_d .Inch ;_efc *=_d .Inch ;_fab *=_d .Inch ;_dc .SetPageMargins (_efc ,_fab ,_adff ,_ca );_addf :=s .Workbook ();var _db *_f .Theme ;if len (_addf .Themes ())> 0{_db =_addf .Themes ()[0];
};var _gbf ,_dd ,_fad ,_cbc int ;for _ ,_ee :=range _addf .DefinedNames (){if _ee .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_gfg ,_dg ,_ea ,_adg :=_b .ParseExcelRange (_ee .Content ());if _adg ==nil &&s .Name ()==_gfg {_gbf =int (_dg .ColumnIdx );
_dd =int (_ea .ColumnIdx );_fad =int (_dg .RowIdx );_cbc =int (_ea .RowIdx );};};};_dbg :=[]_ef .Table {};if _efd .TableParts !=nil &&_efd .TableParts .TablePart !=nil {_ggd :=0;_gc :=s .Workbook ().Tables ();_ce .Slice (_gc [:],func (_ed ,_eb int )bool {return _gc [_ed ].X ().IdAttr < _gc [_eb ].X ().IdAttr });
for _ ,_da :=range s .Workbook ().Sheets (){if _da .Name ()==s .Name (){break ;}else {if _da .X ().TableParts !=nil &&_da .X ().TableParts .TablePart !=nil {_ggd +=len (_da .X ().TableParts .TablePart );};};};if len (_gc )>=_ggd +len (_efd .TableParts .TablePart ){_dbg =append (_dbg ,_gc [_ggd :_ggd +len (_efd .TableParts .TablePart )]...);
};};_eec :=&convertContext {_daag :_dc ,_eecgb :s ,_ebef :s .Workbook (),_ceda :_db ,_cff :&s .Workbook ().StyleSheet ,_fcge :_adff ,_acfed :_efc ,_bebg :_add [1]-_ca -_adff ,_beda :_add [0]-_fab -_efc ,_gbb :_gbf ,_cffa :_dd ,_fee :_fad ,_edff :_cbc ,_fbgb :_addc ,_eefg :_dbg };
_eec .makeAnchors ();_eec .determineMaxIndexes ();if _eec ._fdaf ==0&&_eec ._abd ==0{_dc .NewPage ();return _dc ;};_eec .makeCols ();_eec .makeRows ();_eec .makeMergedCells ();_eec .makeCells ();_eec .makePagespans ();_eec .makeRowspans ();_eec .makePages ();
_eec .fillPages ();_eec .distributeAnchors ();_eec .drawSheet ();return _dc ;};type colWidthRange struct{_ceab int ;_gba int ;_befa float64 ;_bfgg *style ;};func (_ecg *convertContext )addRowToPage (_gbfe []*cell ,_eace int ){_dgdd :=0.0;_efa :=_ecg ._beda ;
for _ ,_eecc :=range _gbfe {if len (_eecc ._bfg )!=0{_eecc ._dbag =_dgdd ;_dgdd =_eecc ._adge +_eecc ._cdcf ;};};for _fbee :=len (_gbfe )-1;_fbee >=0;_fbee --{_eagb :=_gbfe [_fbee ];if len (_eagb ._bfg )!=0{_eagb ._dff =_efa ;_efa =_eagb ._adge ;};};_ecg ._gdee ._ccff =append (_ecg ._gdee ._ccff ,&pageRow {_ebde :_eace ,_aacc :_gbfe });
};func (_ag *convertContext )determineMaxIndexes (){var _bb ,_abg int ;_bb =int (_ag ._eecgb .MaxColumnIdx ());_daaf :=_ag ._eecgb .Rows ();if len (_daaf )> 0{_abg =int (_daaf [len (_daaf )-1].RowNumber ());};for _ ,_cag :=range _ag ._fbba {if _cag ._ecfd >=_abg {_abg =_cag ._ecfd +1;
};if _cag ._geaa >=_bb {_bb =_cag ._geaa +1;};};_ag ._fdaf =_abg ;_ag ._abd =_bb ;};func (_accf *convertContext )getColorStringFromSmlColor (_dcge *_ceg .CT_Color )*string {var _geac string ;if _dcge .RgbAttr !=nil {_geac =*_dcge .RgbAttr ;}else if _dcge .IndexedAttr !=nil &&*_dcge .IndexedAttr < 64{_geac =_gbcg [*_dcge .IndexedAttr ];
}else if _dcge .ThemeAttr !=nil {_gca :=*_dcge .ThemeAttr ;_geac =_accf .getColorFromTheme (_gca );};if _geac ==""{return nil ;};if len (_geac )> 6{_geac =_geac [(len (_geac )-6):];};if _dcge .TintAttr !=nil {_degc :=*_dcge .TintAttr ;_geac =_b .AdjustColorByTint (_geac ,_degc );
};_geac ="\u0023"+_geac ;return &_geac ;};func (_ggb *convertContext )getStyleFromCell (_ecdc _ef .Cell ,_gfed ,_gag ,_baae *style )*style {if _baae !=nil {_cedae (_baae ,_gfed );_cedae (_baae ,_gag );return _baae ;};_cgff :=_ecdc .X ();_affd :=_ggb .getStyle (_cgff .SAttr );
_cedae (_affd ,_gfed );_cedae (_affd ,_gag );return _affd ;};const _fa =1.5;var _cda =map[uint32 ]_g .PageSize {1:_g .PageSize {8.5*_d .Inch ,11*_d .Inch },2:_g .PageSize {8.5*_d .Inch ,11*_d .Inch },3:_g .PageSize {11*_d .Inch ,17*_d .Inch },4:_g .PageSize {17*_d .Inch ,11*_d .Inch },5:_g .PageSize {8.5*_d .Inch ,14*_d .Inch },6:_g .PageSize {5.5*_d .Inch ,8.5*_d .Inch },7:_g .PageSize {7.5*_d .Inch ,10*_d .Inch },8:_g .PageSize {_dbbfd (297),_dbbfd (420)},9:_g .PageSize {_dbbfd (210),_dbbfd (297)},10:_g .PageSize {_dbbfd (210),_dbbfd (297)},11:_g .PageSize {_dbbfd (148),_dbbfd (210)},70:_g .PageSize {_dbbfd (105),_dbbfd (148)},12:_g .PageSize {_dbbfd (250),_dbbfd (354)},13:_g .PageSize {_dbbfd (182),_dbbfd (257)},14:_g .PageSize {8.5*_d .Inch ,13*_d .Inch },20:_g .PageSize {4.125*_d .Inch ,9.5*_d .Inch },27:_g .PageSize {_dbbfd (110),_dbbfd (220)},28:_g .PageSize {_dbbfd (162),_dbbfd (229)},34:_g .PageSize {_dbbfd (250),_dbbfd (176)},29:_g .PageSize {_dbbfd (324),_dbbfd (458)},30:_g .PageSize {_dbbfd (229),_dbbfd (324)},31:_g .PageSize {_dbbfd (114),_dbbfd (162)},37:_g .PageSize {3.88*_d .Inch ,7.5*_d .Inch },43:_g .PageSize {_dbbfd (100),_dbbfd (148)},69:_g .PageSize {_dbbfd (200),_dbbfd (148)}};
const _gd =0.25;func (_ebf *convertContext )makeRowspans (){var _cfbe float64 ;_fdf :=0;for _ec ,_fac :=range _ebf ._dfga {_fbe :=_fac ._abbaa +_fac ._agga ;if _cfbe +_fbe <=_ebf ._bebg {_fac ._ecf =_cfbe ;_cfbe +=_fbe ;}else {_ebf ._acdb =append (_ebf ._acdb ,&rowspan {_ebfc :_cfbe ,_gbe :_fdf ,_acgf :_ec });
_fdf =_ec ;_fac ._ecf =0;_cfbe =_fbe ;};};_ebf ._acdb =append (_ebf ._acdb ,&rowspan {_ebfc :_cfbe ,_gbe :_fdf ,_acgf :len (_ebf ._dfga )});};const _bd =3;func (_dbdfe *convertContext )getImage (_fcag _a .Image ,_egfd ,_gea ,_acg ,_ece ,_ecb ,_abge float64 ,_ffbc _b .ImgPart )*_g .Image {_ece +=_dbdfe ._fcge ;
_acg +=_dbdfe ._acfed ;_aed ,_gde :=_b .GetImage (_dbdfe ._daag ,_fcag ,_egfd ,_gea ,_acg ,_ece ,_ecb ,_abge ,_ffbc );if _gde !=nil {_af .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_gde );
return nil ;};return _aed ;};func (_aggg *convertContext )distributeAnchors (){for _ ,_deb :=range _aggg ._fbba {_dbca ,_ccge :=_deb ._fcgd ,_deb ._abdf ;_ggec ,_dgd :=_deb ._ffa ,_deb ._dgeg ;_fbb ,_fgb :=_deb ._ecfd ,_deb ._baff ;_cbd ,_dgc :=_deb ._geaa ,_deb ._ebbf ;
if _dbca < _aggg ._fee ||(_fbb > _aggg ._edff &&_aggg ._edff > 0){continue ;};if _ggec < _aggg ._gbb ||(_cbd > _aggg ._cffa &&_aggg ._cffa > 0){continue ;};var _ccf ,_fca ,_cdf ,_geee *page ;for _ ,_eda :=range _aggg ._abae {for _ ,_gfd :=range _eda ._fffe {if _dbca >=_gfd ._efea ._gbe &&_dbca < _gfd ._efea ._acgf {if _ggec >=_gfd ._fbff ._baf &&_ggec < _gfd ._fbff ._dgbe {_gfd ._aggfc =true ;
_ccf =_gfd ;};if _cbd >=_gfd ._fbff ._baf &&_cbd < _gfd ._fbff ._dgbe {_gfd ._aggfc =true ;_fca =_gfd ;};};if _fbb >=_gfd ._efea ._gbe &&_fbb < _gfd ._efea ._acgf {if _ggec >=_gfd ._fbff ._baf &&_ggec < _gfd ._fbff ._dgbe {_gfd ._aggfc =true ;_geee =_gfd ;
};if _cbd >=_gfd ._fbff ._baf &&_cbd < _gfd ._fbff ._dgbe {_gfd ._aggfc =true ;_cdf =_gfd ;};};};};_cdb :=_ccf !=_fca ;_bdae :=_ccf !=_geee ;if _cdb &&_bdae {_bef :=_aggg ._eea [_ggec ]._gfbbf +_d .FromEMU (_dgd );_acf :=_ccf ._fbff ._fcf ;_dag :=_aggg ._eea [_cbd ]._gfbbf +_d .FromEMU (_dgc );
_fefc :=_aggg ._dfga [_dbca ]._ecf +_d .FromEMU (_ccge );_gfag :=float64 (_ccf ._efea ._ebfc );_efbb :=_aggg ._dfga [_fbb ]._ecf +_d .FromEMU (_fgb );_debf :=_dag +_acf -_bef ;_bed :=_efbb +_gfag -_fefc ;_cdfg :=_aggg .imageFromAnchor (_deb ,_debf ,_bed );
_ccf ._bgba =append (_ccf ._bgba ,_aggg .getImage (_cdfg ,_bed ,_debf ,_bef ,_fefc ,_acf -_bef ,_gfag -_fefc ,_b .ImgPart_lt ));_fca ._bgba =append (_fca ._bgba ,_aggg .getImage (_cdfg ,_bed ,_debf ,0,_fefc ,_acf -_bef ,_gfag -_fefc ,_b .ImgPart_rt ));
_geee ._bgba =append (_geee ._bgba ,_aggg .getImage (_cdfg ,_bed ,_debf ,_bef ,0,_acf -_bef ,_gfag -_fefc ,_b .ImgPart_lb ));_cdf ._bgba =append (_cdf ._bgba ,_aggg .getImage (_cdfg ,_bed ,_debf ,0,0,_acf -_bef ,_gfag -_fefc ,_b .ImgPart_rb ));}else if _cdb {_afbf :=_aggg ._dfga [_dbca ]._ecf +_d .FromEMU (_ccge );
_daeb :=_aggg ._dfga [_fbb ]._ecf +_d .FromEMU (_fgb );_ggcg :=_aggg ._eea [_ggec ]._gfbbf +_d .FromEMU (_dgd );_deg :=_ccf ._fbff ._fcf ;_dbdf :=_aggg ._eea [_cbd ]._gfbbf +_d .FromEMU (_dgc );_fagf :=_dbdf +_deg -_ggcg ;_edg :=_daeb -_afbf ;_fde :=_aggg .imageFromAnchor (_deb ,_fagf ,_edg );
_ccf ._bgba =append (_ccf ._bgba ,_aggg .getImage (_fde ,_edg ,_fagf ,_ggcg ,_afbf ,_deg -_ggcg ,0,_b .ImgPart_l ));_fca ._bgba =append (_fca ._bgba ,_aggg .getImage (_fde ,_edg ,_fagf ,0,_afbf ,_deg -_ggcg ,0,_b .ImgPart_r ));}else if _bdae {_cece :=_aggg ._eea [_ggec ]._gfbbf +_d .FromEMU (_dgd );
_eag :=_aggg ._eea [_cbd ]._gfbbf +_d .FromEMU (_dgc );_bff :=_aggg ._dfga [_dbca ]._ecf +_d .FromEMU (_ccge );_fffc :=float64 (_ccf ._efea ._ebfc );_dgf :=_aggg ._dfga [_fbb ]._ecf +_d .FromEMU (_fgb );_aec :=_eag -_cece ;_beed :=_dgf +_fffc -_bff ;_fbc :=_aggg .imageFromAnchor (_deb ,_aec ,_beed );
_ccf ._bgba =append (_ccf ._bgba ,_aggg .getImage (_fbc ,_beed ,_aec ,_cece ,_bff ,0,_fffc -_bff ,_b .ImgPart_t ));_geee ._bgba =append (_geee ._bgba ,_aggg .getImage (_fbc ,_beed ,_aec ,_cece ,0,0,_fffc -_bff ,_b .ImgPart_b ));}else {_fga :=_aggg ._eea [_ggec ]._gfbbf +_d .FromEMU (_dgd );
_cbf :=_aggg ._eea [_cbd ]._gfbbf +_d .FromEMU (_dgc );_fabc :=_aggg ._dfga [_dbca ]._ecf +_d .FromEMU (_ccge );_fdb :=_aggg ._dfga [_fbb ]._ecf +_d .FromEMU (_fgb );_afc :=_cbf -_fga ;_bdac :=_fdb -_fabc ;_aage :=_aggg .imageFromAnchor (_deb ,_afc ,_bdac );
_ccf ._bgba =append (_ccf ._bgba ,_aggg .getImage (_aage ,_bdac ,_afc ,_fga ,_fabc ,0,0,_b .ImgPart_whole ));};};};