//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_f "github.com/unidoc/unioffice/v2/common/logger";_c "github.com/unidoc/unioffice/v2/common/tempstorage";_fg "github.com/unidoc/unioffice/v2/internal/convertutils";_ac "github.com/unidoc/unioffice/v2/measurement";_df "github.com/unidoc/unioffice/v2/schema/soo/dml";
_fb "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_aa "github.com/unidoc/unioffice/v2/schema/soo/ofc/sharedTypes";_ef "github.com/unidoc/unioffice/v2/schema/soo/sml";_ea "github.com/unidoc/unioffice/v2/spreadsheet";_ae "github.com/unidoc/unioffice/v2/spreadsheet/formula";
_eg "github.com/unidoc/unioffice/v2/spreadsheet/reference";_ag "github.com/unidoc/unipdf/v4/creator";_ab "github.com/unidoc/unipdf/v4/model";_a "image";_g "math";_da "sort";_d "strconv";);func (_bdae *convertContext )getSymbolsFromR (_feff []*_ef .CT_RElt ,_fgbd *style )[]*symbol {_cced :=[]*symbol {};
for _ ,_gda :=range _feff {_afac :=_bdae .combineCellStyleWithRPrElt (_fgbd ,_gda .RPr );for _ ,_aeeg :=range _gda .T {_cced =append (_cced ,&symbol {_bdeg :string (_aeeg ),_cbaa :_bdae .makeTextStyleFromCellStyle (_afac )});};};return _cced ;};func (_ecg *convertContext )makeCells (){_bdd :=_ecg ._dgae ;
_ge :=_bdd .Rows ();_bbed :=0;for _cff ,_acb :=range _ecg ._fdga {if _cff < _ecg ._babc ||(_cff > _ecg ._gdbg &&_ecg ._gdbg > 0){continue ;};_acb ._geae =[]*cell {};_cde :=0.0;_caf :=_acb ._cag ;if _acb ._def {_aebc :=_ge [_bbed ];_bbed ++;_dfg :=_acb ._fdc ;
for _ ,_gg :=range _aebc .Cells (){_ccgb ,_ceb :=_eg .ParseCellReference (_gg .Reference ());if _ceb !=nil {_f .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_ceb );
continue ;};if int (_ccgb .ColumnIdx )< _ecg ._efgb ||(int (_ccgb .ColumnIdx )> _ecg ._aeag &&_ecg ._aeag > 0){continue ;};_fgbc :=_ecg ._ddbef [_ccgb .ColumnIdx ];_fgd :=_fgbc ._egb ;_afe :=_fgd ;_cfcd :=_fgbc ._bafc ;var _bgf ,_fgbcb ,_cae ,_dgc bool ;
for _ ,_faac :=range _ecg ._agad {if _ccgb .RowIdx >=_faac ._efdf &&_ccgb .RowIdx <=_faac ._cebd &&_ccgb .ColumnIdx >=_faac ._ddaa &&_ccgb .ColumnIdx <=_faac ._fcgb {if _ccgb .ColumnIdx ==_faac ._ddaa &&_ccgb .RowIdx ==_faac ._efdf {_fgd =_faac ._cdc ;
_dfg =_faac ._agdba ;};_bgf =_ccgb .RowIdx !=_faac ._efdf ;_fgbcb =_ccgb .RowIdx !=_faac ._cebd ;_cae =_ccgb .ColumnIdx !=_faac ._ddaa ;_dgc =_ccgb .ColumnIdx !=_faac ._fcgb ;};};var _ecc *style ;for _ ,_efd :=range _ecg ._agb {_cgg ,_eba ,_ead :=_eg .ParseRangeReference (_efd .Reference ());
if _ead !=nil ||_cgg .RowIdx > _ccgb .RowIdx ||_cgg .ColumnIdx > _ccgb .ColumnIdx ||_eba .RowIdx < _ccgb .RowIdx ||_eba .ColumnIdx < _ccgb .ColumnIdx ||_ecg ._ddc .StyleSheet .X ().TableStyles ==nil {continue ;};_ffd :=_ccgb .RowIdx ==_cgg .RowIdx ;for _ ,_fbe :=range _ecg ._ddc .StyleSheet .X ().TableStyles .TableStyle {if _efd .X ().TableStyleInfo .NameAttr !=nil &&_fbe .NameAttr ==*_efd .X ().TableStyleInfo .NameAttr {for _ ,_bbc :=range _fbe .TableStyleElement {if !_ffd &&_bbc .TypeAttr ==_ef .ST_TableStyleTypeWholeTable {_ecc =_ecg .getDxfStyle (_bbc .DxfIdAttr );
};if _ffd &&_bbc .TypeAttr ==_ef .ST_TableStyleTypeHeaderRow {_ecc =_ecg .getDxfStyle (_bbc .DxfIdAttr );};};};};};_fdf :=_ecg .getStyleFromCell (_gg ,_caf ,_cfcd ,_ecc );var _adg ,_fge ,_gbcb ,_aedb bool ;var _gff ,_cce ,_bdfd ,_dfe *border ;var _aeac _ef .ST_VerticalAlignment ;
var _cea _ef .ST_HorizontalAlignment ;if _fdf !=nil {if !_bgf {_gff =_fdf ._adgc ;};if !_fgbcb {_cce =_fdf ._dfd ;};if !_cae {_bdfd =_fdf ._ggae ;};if !_dgc {_dfe =_fdf ._cef ;};if _cce !=nil &&_cce ._aff > _cde {_cde =_cce ._aff ;};_aeac =_fdf ._bgad ;
_cea =_fdf ._fbab ;if _fdf ._agcg !=nil {_adg =*_fdf ._agcg ;};if _fdf ._dgce !=nil {_fge =*_fdf ._dgce ;};_gbcb =_fdf ._fgc ;_aedb =_fdf ._bafa ;};var _bea _ag .Color ;if _fdf !=nil &&_fdf ._dfga !=nil {_bea =_ag .ColorRGBFromHex (*_fdf ._dfga );};_dae ,_fga :=_ecg .getContentFromCell (_bdd ,_gg ,_fdf ,_fgd ,_gbcb ,_aedb );
_caef :=&cell {_cba :_fga ,_dedb :_fgd ,_geb :_afe ,_ccde :_dfg ,_ebge :_dae ,_gbcg :_gff ,_eef :_cce ,_daag :_bdfd ,_cefd :_dfe ,_aedbb :_adg ,_aac :_fge ,_fcad :_bea };_ecg .alignSymbolsHorizontally (_caef ,_cea );_ecg .alignSymbolsVertically (_caef ,_aeac );
_acb ._geae =append (_acb ._geae ,_caef );};};_acb ._fggdb =_cde ;};};const _ad =15.0;type pagespan struct{_dfb float64 ;_bcb []*page ;_fdgc int ;_dddab int ;};func _eaa (_cead *symbol ){_fdfff :=_ag .New ();_aeacc :=_fdfff .NewStyledParagraph ();_aeacc .SetMargins (0,0,0,0);
_bfc :=_aeacc .Append (_cead ._bdeg );if _cead ._cbaa !=nil {_bfc .Style =*_cead ._cbaa ;};_cead ._cebg =_aeacc .Height ();if _cead ._dfbe ==0{_cead ._dfbe =_aeacc .Width ();};};func _abef (_dea float64 )float64 {return _dea *_ac .Millimeter };var _bg =_abef (0.0625);
type mergedCell struct{_efdf uint32 ;_ddaa uint32 ;_cebd uint32 ;_fcgb uint32 ;_cdc float64 ;_agdba float64 ;};func (_fbf *convertContext )alignSymbolsVertically (_cfcg *cell ,_aad _ef .ST_VerticalAlignment ){var _egff float64 ;switch _aad {case _ef .ST_VerticalAlignmentTop :_egff =_cd ;
if _cfcg ._aedbb {_egff -=_eac ;}else if _cfcg ._aac {_egff +=4*_eac ;};for _ ,_ccge :=range _cfcg ._ebge {_egff +=_ccge ._ddbg ;_ccge ._ceaf =_egff ;_egff +=_ed ;};case _ef .ST_VerticalAlignmentCenter :_caa :=0.0;for _ ,_bga :=range _cfcg ._ebge {_caa +=_bga ._ddbg +_abef (1);
};_egff =0.5*(_cfcg ._ccde -_caa );if _cfcg ._aedbb {_egff -=2*_eac ;}else if _cfcg ._aac {_egff +=2*_eac ;};for _ ,_bdfe :=range _cfcg ._ebge {_egff +=_bdfe ._ddbg +0.5*_ed ;_bdfe ._ceaf =_egff ;_egff +=0.5*_ed ;};default:_egff =_cfcg ._ccde -_cd ;if _cfcg ._aedbb {_egff -=4*_eac ;
}else if _cfcg ._aac {_egff +=_eac ;};for _gefa :=len (_cfcg ._ebge )-1;_gefa >=0;_gefa --{_cfcg ._ebge [_gefa ]._ceaf =_egff ;_egff -=_cfcg ._ebge [_gefa ]._ddbg ;_egff -=_ed ;};};};func (_fcf *convertContext )getContentFromCell (_dda *_ea .Sheet ,_bdgg _ea .Cell ,_ffb *style ,_fba float64 ,_dbe ,_dccg bool )([]*line ,_ef .ST_CellType ){if _dccg {return []*line {},_ef .ST_CellTypeS ;
};_gbac :=_bdgg .X ();var _gbaf []*symbol ;switch _gbac .TAttr {case _ef .ST_CellTypeS :_bbf :=_gbac .V ;if _bbf !=nil {_fec ,_ffg :=_d .Atoi (*_bbf );if _ffg ==nil {_gbad :=_fcf ._ddc .SharedStrings .X ().Si [_fec ];if _gbad .T !=nil {_gbaf =_fcf .getSymbolsFromString (*_gbad .T ,_ffb );
}else if _gbad .R !=nil {_gbaf =_fcf .getSymbolsFromR (_gbad .R ,_ffb );};};};case _ef .ST_CellTypeB :_gcfd :=_gbac .V ;if _gcfd !=nil {if *_gcfd =="\u0030"{_gbaf =_fcf .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_ffb );}else {_gbaf =_fcf .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_ffb );
};};case _ef .ST_CellTypeStr :if _gbac .F !=nil {_fcd :=_ae .NewEvaluator ();_ecd :=_dda .FormulaContext ().Cell (_bdgg .Reference (),_fcd );_gbaf =_fcf .getSymbolsFromString (_ecd .Value (),_ffb );};default:_gbaf =_fcf .getSymbolsFromString (_bdgg .GetFormattedValue (),_ffb );
};_dadg :=0.0;_cdfg :=0.0;var _gcb []*line ;var _cfda bool ;if _ffb !=nil {if _ffb ._agcg !=nil {if *_ffb ._agcg {_cfda =true ;};};if _ffb ._dgce !=nil {if *_ffb ._dgce {_cfda =true ;};};};if _dbe {_gcb =[]*line {};_ccc :=_fba -2*_b ;_fce :=[]*symbol {};
for _ ,_geee :=range _gbaf {_eaa (_geee );if _dadg +_geee ._dfbe >=_ccc {_fcg :=_cged (_fce );if _cfda {_fcg /=_ec ;};_gcb =append (_gcb ,&line {_ceaf :_cdfg ,_dbeb :_fce ,_ddbg :_fcg });_fce =[]*symbol {_geee };_dadg =_geee ._dfbe ;_cdfg +=_fcg ;}else {_geee ._dfdb =_dadg ;
_dadg +=_geee ._dfbe ;_fce =append (_fce ,_geee );};};_ccbf :=_cged (_fce );if _cfda {_ccbf /=_ec ;};if len (_fce )> 0{_gcb =append (_gcb ,&line {_ceaf :_cdfg ,_dbeb :_fce ,_ddbg :_ccbf });};}else {for _ ,_dgfee :=range _gbaf {_eaa (_dgfee );_dgfee ._dfdb =_dadg ;
_dadg +=_dgfee ._dfbe ;};if len (_gbaf )> 0{_gcb =[]*line {&line {_dbeb :_gbaf ,_ddbg :_cged (_gbaf )}};};};_ded :=_gbac .TAttr ;if _ded ==_ef .ST_CellTypeUnset {_ded =_ef .ST_CellTypeN ;};return _gcb ,_ded ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_ab .PdfFont ){_fg .RegisterFont (name ,style ,font );};func (_bgba *convertContext )distributeAnchors (){for _ ,_dgfe :=range _bgba ._cbga {_ggd ,_bcd :=_dgfe ._afbc ,_dgfe ._adbf ;_fef ,_aaae :=_dgfe ._fddg ,_dgfe ._egfg ;
_bcf ,_dbd :=_dgfe ._bdef ,_dgfe ._abfg ;_adde ,_eeb :=_dgfe ._affd ,_dgfe ._eeec ;if _ggd < _bgba ._babc ||(_bcf > _bgba ._gdbg &&_bgba ._gdbg > 0){continue ;};if _fef < _bgba ._efgb ||(_adde > _bgba ._aeag &&_bgba ._aeag > 0){continue ;};var _gee ,_bdab ,_gbcc ,_afa *page ;
for _ ,_dcb :=range _bgba ._adfb {for _ ,_aaag :=range _dcb ._bcb {if _ggd >=_aaag ._fbad ._ddbd &&_ggd < _aaag ._fbad ._bde {if _fef >=_aaag ._aeef ._fdgc &&_fef < _aaag ._aeef ._dddab {_aaag ._cbce =true ;_gee =_aaag ;};if _adde >=_aaag ._aeef ._fdgc &&_adde < _aaag ._aeef ._dddab {_aaag ._cbce =true ;
_bdab =_aaag ;};};if _bcf >=_aaag ._fbad ._ddbd &&_bcf < _aaag ._fbad ._bde {if _fef >=_aaag ._aeef ._fdgc &&_fef < _aaag ._aeef ._dddab {_aaag ._cbce =true ;_afa =_aaag ;};if _adde >=_aaag ._aeef ._fdgc &&_adde < _aaag ._aeef ._dddab {_aaag ._cbce =true ;
_gbcc =_aaag ;};};};};_bdc :=_gee !=_bdab ;_cbd :=_gee !=_afa ;if _bdc &&_cbd {_fdd :=_bgba ._ddbef [_fef ]._eage +_ac .FromEMU (_aaae );_cbg :=_gee ._aeef ._dfb ;_acg :=_bgba ._ddbef [_adde ]._eage +_ac .FromEMU (_eeb );_cfd :=_bgba ._fdga [_ggd ]._cbf +_ac .FromEMU (_bcd );
_bdg :=float64 (_gee ._fbad ._fgfa );_ebc :=_bgba ._fdga [_bcf ]._cbf +_ac .FromEMU (_dbd );_gad :=_acg +_cbg -_fdd ;_fff :=_ebc +_bdg -_cfd ;_bdbd :=_bgba .imageFromAnchor (_dgfe ,_gad ,_fff );_gee ._cbde =append (_gee ._cbde ,_bgba .getImage (_bdbd ,_fff ,_gad ,_fdd ,_cfd ,_cbg -_fdd ,_bdg -_cfd ,_fg .ImgPart_lt ));
_bdab ._cbde =append (_bdab ._cbde ,_bgba .getImage (_bdbd ,_fff ,_gad ,0,_cfd ,_cbg -_fdd ,_bdg -_cfd ,_fg .ImgPart_rt ));_afa ._cbde =append (_afa ._cbde ,_bgba .getImage (_bdbd ,_fff ,_gad ,_fdd ,0,_cbg -_fdd ,_bdg -_cfd ,_fg .ImgPart_lb ));_gbcc ._cbde =append (_gbcc ._cbde ,_bgba .getImage (_bdbd ,_fff ,_gad ,0,0,_cbg -_fdd ,_bdg -_cfd ,_fg .ImgPart_rb ));
}else if _bdc {_acba :=_bgba ._fdga [_ggd ]._cbf +_ac .FromEMU (_bcd );_daf :=_bgba ._fdga [_bcf ]._cbf +_ac .FromEMU (_dbd );_aaab :=_bgba ._ddbef [_fef ]._eage +_ac .FromEMU (_aaae );_acdf :=_gee ._aeef ._dfb ;_bgff :=_bgba ._ddbef [_adde ]._eage +_ac .FromEMU (_eeb );
_fbbe :=_bgff +_acdf -_aaab ;_ada :=_daf -_acba ;_afb :=_bgba .imageFromAnchor (_dgfe ,_fbbe ,_ada );_gee ._cbde =append (_gee ._cbde ,_bgba .getImage (_afb ,_ada ,_fbbe ,_aaab ,_acba ,_acdf -_aaab ,0,_fg .ImgPart_l ));_bdab ._cbde =append (_bdab ._cbde ,_bgba .getImage (_afb ,_ada ,_fbbe ,0,_acba ,_acdf -_aaab ,0,_fg .ImgPart_r ));
}else if _cbd {_fedb :=_bgba ._ddbef [_fef ]._eage +_ac .FromEMU (_aaae );_dfgf :=_bgba ._ddbef [_adde ]._eage +_ac .FromEMU (_eeb );_eea :=_bgba ._fdga [_ggd ]._cbf +_ac .FromEMU (_bcd );_bdbc :=float64 (_gee ._fbad ._fgfa );_ddf :=_bgba ._fdga [_bcf ]._cbf +_ac .FromEMU (_dbd );
_adfc :=_dfgf -_fedb ;_fgef :=_ddf +_bdbc -_eea ;_cgda :=_bgba .imageFromAnchor (_dgfe ,_adfc ,_fgef );_gee ._cbde =append (_gee ._cbde ,_bgba .getImage (_cgda ,_fgef ,_adfc ,_fedb ,_eea ,0,_bdbc -_eea ,_fg .ImgPart_t ));_afa ._cbde =append (_afa ._cbde ,_bgba .getImage (_cgda ,_fgef ,_adfc ,_fedb ,0,0,_bdbc -_eea ,_fg .ImgPart_b ));
}else {_fffg :=_bgba ._ddbef [_fef ]._eage +_ac .FromEMU (_aaae );_eacd :=_bgba ._ddbef [_adde ]._eage +_ac .FromEMU (_eeb );_ddd :=_bgba ._fdga [_ggd ]._cbf +_ac .FromEMU (_bcd );_fda :=_bgba ._fdga [_bcf ]._cbf +_ac .FromEMU (_dbd );_eeag :=_eacd -_fffg ;
_aee :=_fda -_ddd ;_gfa :=_bgba .imageFromAnchor (_dgfe ,_eeag ,_aee );_gee ._cbde =append (_gee ._cbde ,_bgba .getImage (_gfa ,_aee ,_eeag ,_fffg ,_ddd ,0,0,_fg .ImgPart_whole ));};};};const _fe =0.25;func (_dd *convertContext )determineMaxIndexes (){var _abg ,_ccd int ;
_abg =int (_dd ._dgae .MaxColumnIdx ());_gde :=_dd ._dgae .Rows ();if len (_gde )> 0{_ccd =int (_gde [len (_gde )-1].RowNumber ());};for _ ,_ddb :=range _dd ._cbga {if _ddb ._bdef >=_ccd {_ccd =_ddb ._bdef +1;};if _ddb ._affd >=_abg {_abg =_ddb ._affd +1;
};};_dd ._ege =_ccd ;_dd ._cab =_abg ;};func (_aebe *convertContext )getSymbolsFromString (_dag string ,_fffa *style )[]*symbol {_ffa :=[]*symbol {};_efdg :=_aebe .makeTextStyleFromCellStyle (_fffa );for _ ,_aafb :=range _dag {_ffa =append (_ffa ,&symbol {_bdeg :string (_aafb ),_cbaa :_efdg });
};return _ffa ;};type colInfo struct{_eage float64 ;_egb float64 ;_bafc *style ;};type rowInfo struct{_cbf float64 ;_def bool ;_fdc float64 ;_cag *style ;_geae []*cell ;_fggdb float64 ;};type style struct{_dfga *string ;_afed *string ;_cceg *float64 ;_fca *string ;
_agadd *bool ;_cgbc *bool ;_dgb *bool ;_agcg *bool ;_dgce *bool ;_adgc *border ;_dfd *border ;_ggae *border ;_cef *border ;_fgc bool ;_bgad _ef .ST_VerticalAlignment ;_fbab _ef .ST_HorizontalAlignment ;_bafa bool ;};func (_agag *convertContext )makeMergedCells (){_fac :=[]*mergedCell {};
for _ ,_eafa :=range _agag ._dgae .MergedCells (){_add ,_dbc ,_agc :=_eg .ParseRangeReference (_eafa .Reference ());if _agc !=nil {_f .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_agc );
continue ;};_gac :=mergedCell {_efdf :_add .RowIdx ,_ddaa :_add .ColumnIdx ,_cebd :_dbc .RowIdx ,_fcgb :_dbc .ColumnIdx };for _gba :=_gac ._ddaa -1;_gba < _gac ._fcgb ;_gba ++{_gac ._cdc +=_agag ._ddbef [_gba ]._egb ;};for _aea :=_gac ._efdf -1;_aea < _gac ._cebd ;
_aea ++{_gac ._agdba +=_agag ._fdga [_aea ]._fdc ;};_fac =append (_fac ,&_gac );};_agag ._agad =_fac ;};const _ec =0.64;type line struct{_ceaf float64 ;_dbeb []*symbol ;_ddbg float64 ;};func (_aca *convertContext )makeCols (){_acf :=_aca ._dgae ;_agf :=_acf .X ();
_aaa :=[]*colInfo {};_fd :=[]colWidthRange {};if _bgc :=_agf .Cols ;len (_bgc )> 0{for _ ,_gf :=range _bgc [0].Col {_eff :=_ce ;if _fgf :=_gf .WidthAttr ;_fgf !=nil {if *_fgf > 0.83{*_fgf -=0.83;};if *_fgf <=1{_eff =*_fgf *11;}else {_eff =5+*_fgf *6;};
};_daa :=int (_gf .MinAttr -1);_edb :=int (_gf .MaxAttr -1);_fd =append (_fd ,colWidthRange {_edc :_daa ,_adee :_edb ,_dbec :_eff ,_adec :_aca .getStyle (_gf .StyleAttr )});};};_cge :=0;for _ece :=0;_ece <=_aca ._cab ;_ece ++{if _ece < _aca ._efgb ||(_ece > _aca ._aeag &&_aca ._aeag > 0){continue ;
};var _fgbf float64 ;var _aecg *style ;if len (_fd )==0{_fgbf =_ce ;}else if _cge < len (_fd ){_ebg :=_fd [_cge ];if _ece >=_ebg ._edc &&_ece <=_ebg ._adee {_fgbf =_ebg ._dbec ;_aecg =_ebg ._adec ;if _ece ==_ebg ._adee {_cge ++;};}else {continue ;};};_aaa =append (_aaa ,&colInfo {_egb :_fgbf ,_bafc :_aecg });
};_bc :=0.0;for _ ,_bbb :=range _aaa {_bc +=_bbb ._egb ;};_aca ._gdg =1.0;if _bc > _aca ._cbc {_aca ._gdg =_aca ._cbc /_bc ;for _ ,_bdf :=range _aaa {_bdf ._egb *=_aca ._gdg ;};};_aca ._ddbef =_aaa ;};func _beef (_aeaa ,_fae *style ){if _fae ==nil {return ;
};if _aeaa ==nil {_aeaa =_fae ;return ;};if _aeaa ._dfga ==nil {_aeaa ._dfga =_fae ._dfga ;};if _aeaa ._fca ==nil {_aeaa ._fca =_fae ._fca ;};if _aeaa ._afed ==nil {_aeaa ._afed =_fae ._afed ;};if _aeaa ._cceg ==nil {_aeaa ._cceg =_fae ._cceg ;};if _aeaa ._agadd ==nil {_aeaa ._agadd =_fae ._agadd ;
};if _aeaa ._cgbc ==nil {_aeaa ._cgbc =_fae ._cgbc ;};if _aeaa ._dgb ==nil {_aeaa ._dgb =_fae ._dgb ;};if _aeaa ._agcg ==nil {_aeaa ._agcg =_fae ._agcg ;};if _aeaa ._dgce ==nil {_aeaa ._dgce =_fae ._dgce ;};if _aeaa ._adgc ==nil {_aeaa ._adgc =_fae ._adgc ;
};if _aeaa ._dfd ==nil {_aeaa ._dfd =_fae ._dfd ;};if _aeaa ._ggae ==nil {_aeaa ._ggae =_fae ._ggae ;};if _aeaa ._cef ==nil {_aeaa ._cef =_fae ._cef ;};if _aeaa ._bgad ==_ef .ST_VerticalAlignmentUnset {_aeaa ._bgad =_fae ._bgad ;};if _aeaa ._fbab ==_ef .ST_HorizontalAlignmentUnset {_aeaa ._fbab =_fae ._fbab ;
};};func (_eae *convertContext )alignSymbolsHorizontally (_agdb *cell ,_afea _ef .ST_HorizontalAlignment ){if _afea ==_ef .ST_HorizontalAlignmentUnset {switch _agdb ._cba {case _ef .ST_CellTypeB :_afea =_ef .ST_HorizontalAlignmentCenter ;case _ef .ST_CellTypeN :_afea =_ef .ST_HorizontalAlignmentRight ;
default:_afea =_ef .ST_HorizontalAlignmentLeft ;};};var _abag float64 ;for _ ,_ccgd :=range _agdb ._ebge {switch _afea {case _ef .ST_HorizontalAlignmentLeft :_abag =_b ;case _ef .ST_HorizontalAlignmentRight :_dafc :=_bdce (_ccgd ._dbeb );_abag =_agdb ._dedb -_b -_dafc ;
case _ef .ST_HorizontalAlignmentCenter :_abgd :=_bdce (_ccgd ._dbeb );_abag =(_agdb ._dedb -_abgd )/2;};for _ ,_feae :=range _ccgd ._dbeb {_feae ._dfdb +=_abag ;};};};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;
FontStyle_BoldItalic FontStyle =3;);const _b =3;func (_bdgd *convertContext )addRowToPage (_afg []*cell ,_cbe int ){_ggb :=0.0;_bfb :=_bdgd ._cbc ;for _ ,_bdcf :=range _afg {if len (_bdcf ._ebge )!=0{_bdcf ._acce =_ggb ;_ggb =_bdcf ._ggg +_bdcf ._dedb ;
};};for _dggc :=len (_afg )-1;_dggc >=0;_dggc --{_acea :=_afg [_dggc ];if len (_acea ._ebge )!=0{_acea ._cee =_bfb ;_bfb =_acea ._ggg ;};};_bdgd ._bebd ._babf =append (_bdgd ._bebd ._babf ,&pageRow {_ecce :_cbe ,_bggd :_afg });};func (_aced *convertContext )makeTextStyleFromCellStyle (_dgcec *style )*_ag .TextStyle {_gdee :=_aced ._cffd .NewTextStyle ();
if _dgcec ==nil {_gdee .FontSize =_fg .DefaultFontSize ;_gdee .Font =_fg .AssignStdFontByName (_gdee ,_fg .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_gdee ;};if _eacf (_dgcec ._dgb ){_gdee .Underline =true ;_gdee .UnderlineStyle =_ag .TextDecorationLineStyle {Offset :0.5,Thickness :_abef (1/32)};
};var _ebfc FontStyle ;if _eacf (_dgcec ._agadd )&&_eacf (_dgcec ._cgbc ){_ebfc =FontStyle_BoldItalic ;}else if _eacf (_dgcec ._agadd ){_ebfc =FontStyle_Bold ;}else if _eacf (_dgcec ._cgbc ){_ebfc =FontStyle_Italic ;}else {_ebfc =FontStyle_Regular ;};_cefc :="\u0064e\u0066\u0061\u0075\u006c\u0074";
if _dgcec ._fca !=nil {_cefc =*_dgcec ._fca ;};if _cda ,_cagc :=_fg .StdFontsMap [_cefc ];_cagc {_gdee .Font =_fg .AssignStdFontByName (_gdee ,_cda [_ebfc ]);}else if _febc :=_fg .GetRegisteredFont (_cefc ,_ebfc );_febc !=nil {_gdee .Font =_febc ;}else {_f .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_cefc ,_ebfc );
_gdee .Font =_fg .AssignStdFontByName (_gdee ,_fg .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_ebfc ]);};if _dgcec ._cceg !=nil {_gdee .FontSize =_g .Round (*_dgcec ._cceg *_aced ._gdg );};if _dgcec ._afed !=nil {_gdee .Color =_ag .ColorRGBFromHex (*_dgcec ._afed );
};if _dgcec ._agcg !=nil &&*_dgcec ._agcg {_gdee .FontSize *=_ec ;}else if _dgcec ._dgce !=nil &&*_dgcec ._dgce {_gdee .FontSize *=_ec ;};return &_gdee ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _fg .RegisterFontsFromDirectory (dirName )};var _fabb =map[uint32 ]_ag .PageSize {1:_ag .PageSize {8.5*_ac .Inch ,11*_ac .Inch },2:_ag .PageSize {8.5*_ac .Inch ,11*_ac .Inch },3:_ag .PageSize {11*_ac .Inch ,17*_ac .Inch },4:_ag .PageSize {17*_ac .Inch ,11*_ac .Inch },5:_ag .PageSize {8.5*_ac .Inch ,14*_ac .Inch },6:_ag .PageSize {5.5*_ac .Inch ,8.5*_ac .Inch },7:_ag .PageSize {7.5*_ac .Inch ,10*_ac .Inch },8:_ag .PageSize {_abef (297),_abef (420)},9:_ag .PageSize {_abef (210),_abef (297)},10:_ag .PageSize {_abef (210),_abef (297)},11:_ag .PageSize {_abef (148),_abef (210)},70:_ag .PageSize {_abef (105),_abef (148)},12:_ag .PageSize {_abef (250),_abef (354)},13:_ag .PageSize {_abef (182),_abef (257)},14:_ag .PageSize {8.5*_ac .Inch ,13*_ac .Inch },20:_ag .PageSize {4.125*_ac .Inch ,9.5*_ac .Inch },27:_ag .PageSize {_abef (110),_abef (220)},28:_ag .PageSize {_abef (162),_abef (229)},34:_ag .PageSize {_abef (250),_abef (176)},29:_ag .PageSize {_abef (324),_abef (458)},30:_ag .PageSize {_abef (229),_abef (324)},31:_ag .PageSize {_abef (114),_abef (162)},37:_ag .PageSize {3.88*_ac .Inch ,7.5*_ac .Inch },43:_ag .PageSize {_abef (100),_abef (148)},69:_ag .PageSize {_abef (200),_abef (148)}};
func _cged (_ccgc []*symbol )float64 {_cfec :=0.0;for _ ,_daea :=range _ccgc {if _daea ._cebg > _cfec {_cfec =_daea ._cebg ;};};return _cfec ;};func (_gcd *convertContext )makeRows (){_bfe :=[]*rowInfo {};_dcf :=_gcd ._dgae .Rows ();_dgfg :=0;_fbd :=0.0;
for _gbe ,_dcd :=range _dcf {if _gbe < _gcd ._babc ||(_gbe > _gcd ._gdbg &&_gcd ._gdbg > 0){continue ;};_dgfg ++;_bfg :=int (_dcd .RowNumber ());if _bfg > _dgfg {for _bbe :=_dgfg ;_bbe < _bfg ;_bbe ++{_bfe =append (_bfe ,&rowInfo {_fdc :_ad /_eaf });_fbd +=_ad /_eaf ;
};_dgfg =_bfg ;};var _cdfe float64 ;if _dcd .X ().HtAttr ==nil {_cdfe =_ad ;}else {_cdfe =*_dcd .X ().HtAttr ;};_bfe =append (_bfe ,&rowInfo {_fdc :_cdfe /_eaf ,_def :true ,_cag :_gcd .getStyle (_dcd .X ().SAttr )});_fbd +=_cdfe /_eaf ;};for _fea :=len (_bfe );
_fea < _gcd ._ege ;_fea ++{_bfe =append (_bfe ,&rowInfo {_fdc :_ad /_eaf });_fbd +=_ad /_eaf ;};if _gcd ._eab ||_fbd >=_gcd ._fggd {_eeeg :=_gcd ._gdg ;if _gcd ._fggd /_fbd < _gcd ._gdg {_eeeg =_gcd ._fggd /_fbd ;};for _ ,_beg :=range _bfe {_beg ._fdc *=_eeeg ;
};};_gcd ._fdga =_bfe ;};func (_deb *convertContext )makeRowspans (){var _aag float64 ;_fde :=0;for _acag ,_faacg :=range _deb ._fdga {_cggf :=_faacg ._fdc +_faacg ._fggdb ;if _aag +_cggf <=_deb ._fggd {_faacg ._cbf =_aag ;_aag +=_cggf ;}else {_deb ._aeec =append (_deb ._aeec ,&rowspan {_fgfa :_aag ,_ddbd :_fde ,_bde :_acag });
_fde =_acag ;_faacg ._cbf =0;_aag =_cggf ;};};_deb ._aeec =append (_deb ._aeec ,&rowspan {_fgfa :_aag ,_ddbd :_fde ,_bde :len (_deb ._fdga )});};func _bdce (_bag []*symbol )float64 {_gcbc :=0.0;for _ ,_dcdb :=range _bag {_gcbc +=_dcdb ._dfbe ;};return _gcbc ;
};type convertContext struct{_cffd *_ag .Creator ;_ddc *_ea .Workbook ;_fbfe *_df .Theme ;_dgae *_ea .Sheet ;_fdb *_ea .StyleSheet ;_ege int ;_cab int ;_adfb []*pagespan ;_bebd *page ;_ddbef []*colInfo ;_fdga []*rowInfo ;_aeec []*rowspan ;_fgab float64 ;
_cgec float64 ;_fggd float64 ;_cbc float64 ;_agad []*mergedCell ;_cbga []*anchor ;_gdg float64 ;_efgb int ;_aeag int ;_babc int ;_gdbg int ;_eab bool ;_agb []_ea .Table ;};

// ConvertToPdfWithOptions convert a sheet to PDF with given options.
func ConvertToPdfWithOptions (s *_ea .Sheet ,opts *Options )*_ag .Creator {_aga :=s .X ();if _aga ==nil {return nil ;};var _ff _ag .PageSize ;_ecf :=true ;_efa :=false ;if _aga .SheetPr !=nil &&_aga .SheetPr .PageSetUpPr !=nil &&_aga .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_aga .SheetPr .PageSetUpPr .FitToPageAttr {_efa =true ;
};if _cdf :=_aga .PageSetup ;_cdf !=nil {_ecf =_cdf .OrientationAttr ==_ef .ST_OrientationLandscape ;if _gc :=_cdf .PaperSizeAttr ;_gc !=nil {_ff =_fabb [*_gc ];};};if (_ff ==_ag .PageSize {}){_ff =_fg .GetDefaultPageSize ();if opts !=nil &&opts .DefaultPageSize !=_fg .DefaultPageSize {_ff =_fg .GetPageDimensions (opts .DefaultPageSize );
};};if _ecf {_ff [0],_ff [1]=_ff [1],_ff [0];};_ba :=_ag .New ();_ba .SetPageSize (_ff );var _fgb ,_bb ,_ee ,_edd float64 ;if _bd :=_aga .PageMargins ;_bd !=nil {_ee =_bd .LeftAttr ;_edd =_bd .RightAttr ;_fgb =_bd .TopAttr ;_bb =_bd .BottomAttr ;};if _ee < _fe {_ee =_fe ;
};if _edd < _fe {_edd =_fe ;};if _fgb < _gd {_fgb =_gd ;};if _bb < _gd {_bb =_gd ;};_fgb *=_ac .Inch ;_bb *=_ac .Inch ;_ee *=_ac .Inch ;_edd *=_ac .Inch ;_ba .SetPageMargins (_ee ,_edd ,_fgb ,_bb );_gb :=s .Workbook ();var _be *_df .Theme ;if len (_gb .Themes ())> 0{_be =_gb .Themes ()[0];
};var _baf ,_eee ,_cf ,_abe int ;for _ ,_db :=range _gb .DefinedNames (){if _db .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_fa ,_gdb ,_cc ,_aeg :=_fg .ParseExcelRange (_db .Content ());if _aeg ==nil &&s .Name ()==_fa {_baf =int (_gdb .ColumnIdx );
_eee =int (_cc .ColumnIdx );_cf =int (_gdb .RowIdx );_abe =int (_cc .RowIdx );};};};_dg :=[]_ea .Table {};if _aga .TableParts !=nil &&_aga .TableParts .TablePart !=nil {_de :=0;_af :=s .Workbook ().Tables ();_da .Slice (_af [:],func (_cg ,_bec int )bool {return _af [_cg ].X ().IdAttr < _af [_bec ].X ().IdAttr });
for _ ,_aba :=range s .Workbook ().Sheets (){if _aba .Name ()==s .Name (){break ;}else {if _aba .X ().TableParts !=nil &&_aba .X ().TableParts .TablePart !=nil {_de +=len (_aba .X ().TableParts .TablePart );};};};if len (_af )>=_de +len (_aga .TableParts .TablePart ){_dg =append (_dg ,_af [_de :_de +len (_aga .TableParts .TablePart )]...);
};};_gcg :=&convertContext {_cffd :_ba ,_dgae :s ,_ddc :s .Workbook (),_fbfe :_be ,_fdb :&s .Workbook ().StyleSheet ,_fgab :_fgb ,_cgec :_ee ,_fggd :_ff [1]-_bb -_fgb ,_cbc :_ff [0]-_edd -_ee ,_efgb :_baf ,_aeag :_eee ,_babc :_cf ,_gdbg :_abe ,_eab :_efa ,_agb :_dg };
_gcg .makeAnchors ();_gcg .determineMaxIndexes ();if _gcg ._ege ==0&&_gcg ._cab ==0{_ba .NewPage ();return _ba ;};_gcg .makeCols ();_gcg .makeRows ();_gcg .makeMergedCells ();_gcg .makeCells ();_gcg .makePagespans ();_gcg .makeRowspans ();_gcg .makePages ();
_gcg .fillPages ();_gcg .distributeAnchors ();_gcg .drawSheet ();return _ba ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_ea .Sheet )*_ag .Creator {return ConvertToPdfWithOptions (s ,nil )};func (_ade *convertContext )drawPage (_gea *page ){_cgef :=_ade ._fgab ;_efg :=_ade ._cgec ;for _ ,_aeff :=range _gea ._babf {_ebf :=_ade ._fdga [_aeff ._ecce ];
for _ ,_efc :=range _aeff ._bggd {var _cdd float64 ;if _aeff ._ecce > 1{_cdd =_ade ._fdga [_aeff ._ecce -1]._fggdb ;};var _bcdc ,_dabd float64 ;if _badc :=_efc ._gbcg ;_badc !=nil {_bcdc =_badc ._aff ;};if _ebe :=_efc ._eef ;_ebe !=nil {_dabd =_ebe ._aff ;
};_dcc :=_cgef +_ebf ._cbf -0.5*(_cdd -_bcdc );_cad :=_cgef +_ebf ._cbf +_ebf ._fdc +0.5*(_ebf ._fggdb +_dabd );_dde :=_efg +_efc ._ggg ;_acbf :=_dde +_efc ._geb ;if _efc ._fcad !=nil &&_efc ._fcad !=_ag .ColorBlack {_fg .FillRectangle (_ade ._cffd ,_dde ,_dcc ,_acbf -_dde ,_cad -_dcc ,_efc ._fcad );
};};};for _ ,_fddc :=range _gea ._babf {_cddc :=_ade ._fdga [_fddc ._ecce ];for _ ,_bfeg :=range _fddc ._bggd {_gbb :=_bfeg ._acce < _bfeg ._ggg ;_gdf :=_bfeg ._cee > _bfeg ._ggg +_bfeg ._dedb ;var _ebaa ,_bcdb bool ;for _ ,_adb :=range _bfeg ._ebge {for _ ,_efb :=range _adb ._dbeb {if _gbb &&!_ebaa {_ebaa =_efb ._dfdb < 0;
};if _gdf &&!_bcdb {_bcdb =_bfeg ._dedb < _efb ._dfdb +_efb ._dfbe ;};if _bfeg ._ggg +_efb ._dfdb >=_bfeg ._acce &&_bfeg ._ggg +_efb ._dfdb +_efb ._dfbe <=_bfeg ._cee {_eecf :=_ade ._cffd .NewStyledParagraph ();_ebab :=_efg +_bfeg ._ggg +_efb ._dfdb ;_afaf :=_cgef +_cddc ._cbf +_adb ._ceaf -_efb ._cebg -_abef (0.5);
_eecf .SetPos (_ebab ,_afaf );var _dcg *_ag .TextChunk ;if _efb ._fgcc !=""{_dcg =_eecf .AddExternalLink (_efb ._bdeg ,_efb ._fgcc );}else {_dcg =_eecf .Append (_efb ._bdeg );};if _efb ._cbaa !=nil {_dcg .Style =*_efb ._cbaa ;};_ade ._cffd .Draw (_eecf );
};};};var _fdg ,_egf ,_gge ,_feg ,_geef ,_gef float64 ;var _gab ,_ebeg ,_gaca ,_ega _ag .Color ;if _geeg :=_bfeg ._gbcg ;_geeg !=nil {_fdg =_geeg ._aff ;_gab =_geeg ._bgce ;};if _dggd :=_bfeg ._eef ;_dggd !=nil {_egf =_dggd ._aff ;_ebeg =_dggd ._bgce ;
};if _bff :=_bfeg ._daag ;_bff !=nil {_gge =_bff ._aff ;_geef =_gge /2;_gaca =_bff ._bgce ;};if _befg :=_bfeg ._cefd ;_befg !=nil {_feg =_befg ._aff ;_gef =_feg /2;_ega =_befg ._bgce ;};var _geab float64 ;if _fddc ._ecce > 1{_geab =_ade ._fdga [_fddc ._ecce -1]._fggdb ;
};_dca :=_cgef +_cddc ._cbf -0.5*(_geab -_fdg );_debg :=_cgef +_cddc ._cbf +_cddc ._fdc +0.5*(_cddc ._fggdb +_egf );_cfea :=_efg +_bfeg ._ggg ;_efca :=_cfea +_bfeg ._geb ;_fg .DrawLine (_ade ._cffd ,_cfea ,_dca ,_efca ,_dca ,_fdg ,_gab );_fg .DrawLine (_ade ._cffd ,_cfea ,_debg ,_efca ,_debg ,_egf ,_ebeg );
if !_ebaa {_fg .DrawLine (_ade ._cffd ,_cfea -_geef ,_dca ,_cfea -_geef ,_debg ,_gge ,_gaca );};if !_bcdb {_fg .DrawLine (_ade ._cffd ,_efca -_gef ,_dca ,_efca -_gef ,_debg ,_feg ,_ega );};};};for _ ,_dgcd :=range _gea ._cbde {if _dgcd !=nil {_ade ._cffd .Draw (_dgcd );
};};};func (_cfe *convertContext )makeAnchors (){_dfa ,_aab :=_cfe ._dgae .GetDrawing ();if _dfa !=nil {for _ ,_dgf :=range _dfa .EG_Anchor {_cfc :=&anchor {};if _dc :=_dgf .AnchorChoice .TwoCellAnchor ;_dc !=nil {_dgd ,_ga :=_dc .From ,_dc .To ;if _dgd ==nil ||_ga ==nil {return ;
};_cfc ._afbc =int (_dgd .Row );_cfc ._adbf =_fg .FromSTCoordinate (_dgd .RowOff );_cfc ._fddg =int (_dgd .Col );_cfc ._egfg =_fg .FromSTCoordinate (_dgd .ColOff );_cfc ._bdef =int (_ga .Row );_cfc ._abfg =_fg .FromSTCoordinate (_ga .RowOff );_cfc ._affd =int (_ga .Col );
_cfc ._eeec =_fg .FromSTCoordinate (_ga .ColOff );if _bef :=_dc .ObjectChoicesChoice ;_bef !=nil {if _gbc :=_bef .Pic ;_gbc !=nil {if _bee :=_gbc .BlipFill ;_bee !=nil {if _bf :=_bee .Blip ;_bf !=nil {if _dad :=_bf .EmbedAttr ;_dad !=nil {for _ ,_faa :=range _aab .X ().Relationship {if _faa .IdAttr ==*_dad {for _ ,_aed :=range _cfe ._ddc .Images {if _aed .Target ()==_faa .TargetAttr {_bge ,_aef :=_c .Open (_aed .Path ());
if _aef !=nil {_f .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_aef );continue ;};_eb ,_ ,_aef :=_a .Decode (_bge );if _aef !=nil {_f .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_aef );
continue ;};_cfc ._fgfac =_eb ;};};};};};};};}else if _fbb :=_bef .GraphicFrame ;_fbb !=nil {if _bda :=_fbb .Graphic ;_bda !=nil {if _bed :=_bda .GraphicData ;_bed !=nil {for _ ,_gdd :=range _bed .Any {if _dgg ,_bdb :=_gdd .(*_fb .Chart );_bdb {for _ ,_eeg :=range _aab .X ().Relationship {if _eeg .IdAttr ==_dgg .IdAttr {_beb :=_cfe ._ddc .GetChartByTargetId (_eeg .TargetAttr );
if _beb !=nil {_cfc ._gebc =_beb ;};};};};};};};};};};if _cfc ._fgfac !=nil ||_cfc ._gebc !=nil {_cfe ._cbga =append (_cfe ._cbga ,_cfc );};};};};func (_acaf *convertContext )getDxfStyle (_aeca *uint32 )*style {_fcgg :=&style {};_cdb :=false ;if _aeca !=nil {var _cfa *_ef .CT_Dxf ;
for _fdee ,_bdac :=range _acaf ._fdb .X ().Dxfs .Dxf {if uint32 (_fdee )==*_aeca {_cfa =_bdac ;};};if _cfa ==nil {return nil ;};if _cfa .Fill !=nil &&_cfa .Fill .FillChoice !=nil &&_cfa .Fill .FillChoice .PatternFill !=nil {if _cfa .Fill .FillChoice .PatternFill .FgColor !=nil {_fcgg ._dfga =_acaf .getColorStringFromSmlColor (_cfa .Fill .FillChoice .PatternFill .FgColor );
}else if _cfa .Fill .FillChoice .PatternFill .BgColor !=nil {_fcgg ._dfga =_acaf .getColorStringFromSmlColor (_cfa .Fill .FillChoice .PatternFill .BgColor );};};_eegd :=_cfa .Font ;for _ ,_acbg :=range _eegd .FontChoice {if _acbg .Name !=nil {_fcgg ._fca =&_acbg .Name .ValAttr ;
_cdb =true ;}else if _acbg .B !=nil {_ddgc :=_acbg .B .ValAttr ==nil ||*_acbg .B .ValAttr ;_fcgg ._agadd =&_ddgc ;_cdb =true ;}else if _acbg .I !=nil {_afgg :=_acbg .I .ValAttr ==nil ||*_acbg .I .ValAttr ;_fcgg ._cgbc =&_afgg ;_cdb =true ;}else if _acbg .U !=nil {_gbaa :=_acbg .U .ValAttr ==_ef .ST_UnderlineValuesSingle ||_acbg .U .ValAttr ==_ef .ST_UnderlineValuesUnset ;
_fcgg ._dgb =&_gbaa ;_cdb =true ;}else if _acbg .Sz !=nil {_bgbb :=_acbg .Sz .ValAttr ;_fcgg ._cceg =&_bgbb ;_cdb =true ;}else if _acbg .VertAlign !=nil {_geaec :=_acbg .VertAlign .ValAttr ==_aa .ST_VerticalAlignRunSuperscript ;_fcgg ._agcg =&_geaec ;_dcgb :=_acbg .VertAlign .ValAttr ==_aa .ST_VerticalAlignRunSubscript ;
_fcgg ._dgce =&_dcgb ;_cdb =true ;}else if _acbg .Color !=nil {_fcgg ._afed =_acaf .getColorStringFromSmlColor (_acbg .Color );_cdb =true ;};};_fdeee :=_cfa .Border ;if _fdeee !=nil {if _fdeee .Top !=nil {_fcgg ._adgc =_acaf .getBorder (_fdeee .Top );_cdb =true ;
};if _fdeee .Bottom !=nil {_fcgg ._dfd =_acaf .getBorder (_fdeee .Bottom );_cdb =true ;};if _fdeee .Left !=nil {_fcgg ._ggae =_acaf .getBorder (_fdeee .Left );_cdb =true ;};if _fdeee .Right !=nil {_fcgg ._cef =_acaf .getBorder (_fdeee .Right );_cdb =true ;
};};if _cfa .Alignment !=nil {if _eaab :=_cfa .Alignment .VerticalAttr ;_eaab !=_ef .ST_VerticalAlignmentUnset {_fcgg ._bgad =_eaab ;_cdb =true ;};if _ggee :=_cfa .Alignment .HorizontalAttr ;_ggee !=_ef .ST_HorizontalAlignmentUnset {_fcgg ._fbab =_ggee ;
_cdb =true ;};};};if _cdb {return _fcgg ;};return nil ;};func (_cgdg *convertContext )getStyleFromCell (_cgedd _ea .Cell ,_gacaa ,_eeef ,_efcaf *style )*style {if _efcaf !=nil {_beef (_efcaf ,_gacaa );_beef (_efcaf ,_eeef );return _efcaf ;};_fgae :=_cgedd .X ();
_ffdb :=_cgdg .getStyle (_fgae .SAttr );_beef (_ffdb ,_gacaa );_beef (_ffdb ,_eeef );return _ffdb ;};type anchor struct{_fgfac _a .Image ;_gebc *_fb .ChartSpace ;_afbc int ;_adbf int64 ;_fddg int ;_egfg int64 ;_bdef int ;_abfg int64 ;_affd int ;_eeec int64 ;
};func (_edbe *convertContext )makePagespans (){_edbe ._adfb =[]*pagespan {};_daac :=0.0;_gcf :=0;for _feb ,_cgge :=range _edbe ._ddbef {_efad :=_cgge ._egb ;if _daac +_efad <=_edbe ._cbc {_cgge ._eage =_daac ;_daac +=_efad ;}else {_cgge ._eage =0;_edbe ._adfb =append (_edbe ._adfb ,&pagespan {_dfb :_daac ,_fdgc :_gcf ,_dddab :_feb });
_daac =_efad ;_gcf =_feb ;};};_edbe ._adfb =append (_edbe ._adfb ,&pagespan {_dfb :_daac ,_fdgc :_gcf ,_dddab :len (_edbe ._ddbef )});};func (_bba *convertContext )getStyle (_gfcc *uint32 )*style {_bbbd :=&style {};_eebec :=false ;if _gfcc !=nil {_ebed :=_bba ._fdb .GetCellStyle (*_gfcc );
if _bba ._fdb .GetNumberFormat (_ebed .NumberFormat ()).GetFormat ()=="\u003b\u003b\u003b"{_bbbd ._bafa =true ;};_febf :=_ebed .GetFill ();if _febf !=nil &&_febf .FillChoice !=nil &&_febf .FillChoice .PatternFill !=nil {if _febf .FillChoice .PatternFill .FgColor !=nil {_bbbd ._dfga =_bba .getColorStringFromSmlColor (_febf .FillChoice .PatternFill .FgColor );
}else if _febf .FillChoice .PatternFill .BgColor !=nil {_bbbd ._dfga =_bba .getColorStringFromSmlColor (_febf .FillChoice .PatternFill .BgColor );};};_cbb :=_ebed .GetFont ();for _ ,_befd :=range _cbb .FontChoice {if _befd .Name !=nil {_bbbd ._fca =&_befd .Name .ValAttr ;
_eebec =true ;}else if _befd .B !=nil {_dcde :=_befd .B .ValAttr ==nil ||*_befd .B .ValAttr ;_bbbd ._agadd =&_dcde ;_eebec =true ;}else if _befd .I !=nil {_fgcf :=_befd .I .ValAttr ==nil ||*_befd .I .ValAttr ;_bbbd ._cgbc =&_fgcf ;_eebec =true ;}else if _befd .U !=nil {_fdfb :=_befd .U .ValAttr ==_ef .ST_UnderlineValuesSingle ||_befd .U .ValAttr ==_ef .ST_UnderlineValuesUnset ;
_bbbd ._dgb =&_fdfb ;_eebec =true ;}else if _befd .Sz !=nil {_dbgd :=_befd .Sz .ValAttr ;_bbbd ._cceg =&_dbgd ;_eebec =true ;}else if _befd .VertAlign !=nil {_bbfg :=_befd .VertAlign .ValAttr ==_aa .ST_VerticalAlignRunSuperscript ;_bbbd ._agcg =&_bbfg ;
_faf :=_befd .VertAlign .ValAttr ==_aa .ST_VerticalAlignRunSubscript ;_bbbd ._dgce =&_faf ;_eebec =true ;}else if _befd .Color !=nil {_bbbd ._afed =_bba .getColorStringFromSmlColor (_befd .Color );_eebec =true ;};};_daga :=_ebed .GetBorder ();if _daga .Top !=nil {_bbbd ._adgc =_bba .getBorder (_daga .Top );
_eebec =true ;};if _daga .Bottom !=nil {_bbbd ._dfd =_bba .getBorder (_daga .Bottom );_eebec =true ;};if _daga .Left !=nil {_bbbd ._ggae =_bba .getBorder (_daga .Left );_eebec =true ;};if _daga .Right !=nil {_bbbd ._cef =_bba .getBorder (_daga .Right );
_eebec =true ;};if _ebed .Wrapped (){_bbbd ._fgc =true ;_eebec =true ;};if _ebcg :=_ebed .GetVerticalAlignment ();_ebcg !=_ef .ST_VerticalAlignmentUnset {_bbbd ._bgad =_ebcg ;_eebec =true ;};if _dded :=_ebed .GetHorizontalAlignment ();_dded !=_ef .ST_HorizontalAlignmentUnset {_bbbd ._fbab =_dded ;
_eebec =true ;};};if _eebec {return _bbbd ;};return nil ;};func (_eebe *convertContext )drawSheet (){for _cggb ,_ddda :=range _eebe ._adfb {_eec :=len (_ddda ._bcb );if _cggb ==len (_eebe ._adfb )-1{for _bgg :=len (_ddda ._bcb )-1;_bgg >=0;_bgg --{if !_ddda ._bcb [_bgg ]._cbce {_eec =_bgg ;
};};};_bfa :=_ddda ._bcb [:_eec ];for _ ,_gfb :=range _bfa {_eebe ._cffd .NewPage ();_eebe .drawPage (_gfb );};};};type symbol struct{_bdeg string ;_dfdb float64 ;_cebg float64 ;_dfbe float64 ;_cbaa *_ag .TextStyle ;_fgcc string ;};const _eac =1.5;var _ed =_abef (1);
type pageRow struct{_ecce int ;_bggd []*cell ;};var _bcac =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
const _gd =0.0;type cell struct{_cba _ef .ST_CellType ;_eaea int ;_ggg float64 ;_ebge []*line ;_dedb float64 ;_geb float64 ;_ccde float64 ;_acce float64 ;_cee float64 ;_dff *_ag .TextStyle ;_gbcg *border ;_eef *border ;_daag *border ;_cefd *border ;_aedbb bool ;
_aac bool ;_fcad _ag .Color ;};func (_bgb *convertContext )makePages (){for _ ,_dbg :=range _bgb ._adfb {for _ ,_begf :=range _bgb ._aeec {_dbg ._bcb =append (_dbg ._bcb ,&page {_babf :[]*pageRow {},_aeef :_dbg ,_fbad :_begf });};};};type colWidthRange struct{_edc int ;
_adee int ;_dbec float64 ;_adec *style ;};type rowspan struct{_fgfa float64 ;_ddbd int ;_bde int ;};func (_dba *convertContext )getBorder (_egg *_ef .CT_BorderPr )*border {_bbba :=&border {};switch _egg .StyleAttr {case _ef .ST_BorderStyleHair :_bbba ._aff =_bg /2;
case _ef .ST_BorderStyleThin :_bbba ._aff =_bg ;case _ef .ST_BorderStyleMedium :_bbba ._aff =_bg *2;case _ef .ST_BorderStyleThick :_bbba ._aff =_bg *4;};if _bbba ._aff ==0.0{return nil ;};if _cfcb :=_egg .Color ;_cfcb !=nil {_edbc :=_dba .getColorStringFromSmlColor (_cfcb );
if _edbc !=nil {_bbba ._bgce =_ag .ColorRGBFromHex (*_edbc );}else {_bbba ._bgce =_ag .ColorBlack ;};};return _bbba ;};var _eaf =3.025/_abef (1);func (_cga *convertContext )getColorStringFromSmlColor (_bged *_ef .CT_Color )*string {var _bfbb string ;if _bged .RgbAttr !=nil {_bfbb =*_bged .RgbAttr ;
}else if _bged .IndexedAttr !=nil &&*_bged .IndexedAttr < 64{_bfbb =_bcac [*_bged .IndexedAttr ];}else if _bged .ThemeAttr !=nil {_bcde :=*_bged .ThemeAttr ;_bfbb =_cga .getColorFromTheme (_bcde );};if _bfbb ==""{return nil ;};if len (_bfbb )> 6{_bfbb =_bfbb [(len (_bfbb )-6):];
};if _bged .TintAttr !=nil {_aegb :=*_bged .TintAttr ;_bfbb =_fg .AdjustColorByTint (_bfbb ,_aegb );};_bfbb ="\u0023"+_bfbb ;return &_bfbb ;};

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _fg .PageSize ;};func (_age *convertContext )imageFromAnchor (_fgg *anchor ,_egdf ,_abfc float64 )_a .Image {if _fgg ._fgfac !=nil {return _fgg ._fgfac ;};if _fgg ._gebc !=nil {_ecb ,_ffge :=_fg .MakeImageFromChartSpace (_fgg ._gebc ,_egdf ,_abfc ,_age ._fbfe ,_age ._ddc );
if _ffge !=nil {_f .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_ffge );
return nil ;};return _ecb ;};return nil ;};const _cd =2;

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_fg .FontStyle ;func (_eafc *convertContext )fillPages (){for _fed ,_acd :=range _eafc ._aeec {_agd :=_eafc ._fdga [_acd ._ddbd :_acd ._bde ];for _egd ,_cec :=range _agd {_fdff :=0;_aaf :=0.0;_dgec :=[]*cell {};if _cec ._def {for _ ,_gffg :=range _cec ._geae {_bgec :=_eafc ._adfb [_fdff ];
_eafc ._bebd =_bgec ._bcb [_fed ];_eafc ._bebd ._cbce =true ;_gcc :=_gffg ._geb ;if _aaf +_gcc > _bgec ._dfb {_eafc .addRowToPage (_dgec ,_egd );_dgec =[]*cell {_gffg };_aaf =_gcc ;_fdff ++;}else {_gffg ._ggg =_aaf ;_dgec =append (_dgec ,_gffg );_aaf +=_gcc ;
};};if len (_dgec )> 0{_ebd :=_eafc ._adfb [_fdff ];_eafc ._bebd =_ebd ._bcb [_fed ];_eafc ._bebd ._cbce =true ;_eafc .addRowToPage (_dgec ,_egd );};};};};};func _eacf (_eefb *bool )bool {return _eefb !=nil &&*_eefb };const _ce =64.0;type border struct{_aff float64 ;
_bgce _ag .Color ;};func (_fbg *convertContext )getImage (_acc _a .Image ,_fab ,_bdaa ,_dgfd ,_efcca ,_cafc ,_gga float64 ,_eag _fg .ImgPart )*_ag .Image {_efcca +=_fbg ._fgab ;_dgfd +=_fbg ._cgec ;_fedc ,_cfdb :=_fg .GetImage (_fbg ._cffd ,_acc ,_fab ,_bdaa ,_dgfd ,_efcca ,_cafc ,_gga ,_eag );
if _cfdb !=nil {_f .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_cfdb );return nil ;};return _fedc ;};func (_egdb *convertContext )getColorFromTheme (_fedg uint32 )string {_geeee :=_egdb ._ddc .Themes ();
if len (_geeee )!=0{_eabc :=_geeee [0];if _eadf :=_eabc .ThemeElements ;_eadf !=nil {if _dbcb :=_eadf .ClrScheme ;_dbcb !=nil {switch _fedg {case 0:return _fg .GetColorStringFromDmlColor (_dbcb .Lt1 );case 1:return _fg .GetColorStringFromDmlColor (_dbcb .Dk1 );
case 2:return _fg .GetColorStringFromDmlColor (_dbcb .Lt2 );case 3:return _fg .GetColorStringFromDmlColor (_dbcb .Dk2 );case 4:return _fg .GetColorStringFromDmlColor (_dbcb .Accent1 );case 5:return _fg .GetColorStringFromDmlColor (_dbcb .Accent2 );case 6:return _fg .GetColorStringFromDmlColor (_dbcb .Accent3 );
case 7:return _fg .GetColorStringFromDmlColor (_dbcb .Accent4 );case 8:return _fg .GetColorStringFromDmlColor (_dbcb .Accent5 );case 9:return _fg .GetColorStringFromDmlColor (_dbcb .Accent6 );};};};};return "";};func (_feaf *convertContext )combineCellStyleWithRPrElt (_ebgc *style ,_bgd *_ef .CT_RPrElt )*style {_edcd :=*_ebgc ;
_egfgf :=_feaf .getStyleFromRPrElt (_bgd );if _egfgf ==nil {return &_edcd ;};if _egfgf ._afed !=nil {_edcd ._afed =_egfgf ._afed ;};if _egfgf ._cceg !=nil {_edcd ._cceg =_egfgf ._cceg ;};if _egfgf ._fca !=nil {_edcd ._fca =_egfgf ._fca ;};if _egfgf ._agadd !=nil {_edcd ._agadd =_egfgf ._agadd ;
};if _egfgf ._cgbc !=nil {_edcd ._cgbc =_egfgf ._cgbc ;};if _egfgf ._dgb !=nil {_edcd ._dgb =_egfgf ._dgb ;};if _egfgf ._agcg !=nil {_edcd ._agcg =_egfgf ._agcg ;};if _egfgf ._dgce !=nil {_edcd ._dgce =_egfgf ._dgce ;};return &_edcd ;};func (_acdg *convertContext )getStyleFromRPrElt (_ebdg *_ef .CT_RPrElt )*style {if _ebdg ==nil ||_ebdg .RPrEltChoice ==nil ||len (_ebdg .RPrEltChoice )==0{return nil ;
};_ecag :=&style {};for _ ,_bfgc :=range _ebdg .RPrEltChoice {if _bfgc .RFont !=nil {_ecag ._fca =&_bfgc .RFont .ValAttr ;};if _bbfge :=_bfgc .B ;_bbfge !=nil {_dabc :=_bbfge .ValAttr ==nil ||*_bbfge .ValAttr ;_ecag ._agadd =&_dabc ;};if _fedf :=_bfgc .I ;
_fedf !=nil {_bae :=_fedf .ValAttr ==nil ||*_fedf .ValAttr ;_ecag ._cgbc =&_bae ;};if _ddee :=_bfgc .U ;_ddee !=nil {_defb :=_ddee .ValAttr ==_ef .ST_UnderlineValuesSingle ||_ddee .ValAttr ==_ef .ST_UnderlineValuesUnset ;_ecag ._dgb =&_defb ;};if _aace :=_bfgc .VertAlign ;
_aace !=nil {_dadf :=_aace .ValAttr ==_aa .ST_VerticalAlignRunSuperscript ;_ecag ._agcg =&_dadf ;_abgdf :=_aace .ValAttr ==_aa .ST_VerticalAlignRunSubscript ;_ecag ._dgce =&_abgdf ;};if _ebff :=_bfgc .Sz ;_ebff !=nil {_bbd :=_ebff .ValAttr ;_ecag ._cceg =&_bbd ;
};if _becf :=_bfgc .Color ;_becf !=nil {_ecag ._afed =_acdg .getColorStringFromSmlColor (_becf );};};return _ecag ;};type page struct{_babf []*pageRow ;_cbce bool ;_cbde []*_ag .Image ;_aeef *pagespan ;_fbad *rowspan ;};