//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_gb "github.com/unidoc/unioffice/v2/common/logger";_add "github.com/unidoc/unioffice/v2/common/tempstorage";_cd "github.com/unidoc/unioffice/v2/internal/convertutils";_dcf "github.com/unidoc/unioffice/v2/measurement";_cb "github.com/unidoc/unioffice/v2/schema/soo/dml";
_bg "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_f "github.com/unidoc/unioffice/v2/schema/soo/ofc/sharedTypes";_df "github.com/unidoc/unioffice/v2/schema/soo/sml";_ad "github.com/unidoc/unioffice/v2/spreadsheet";_ed "github.com/unidoc/unioffice/v2/spreadsheet/formula";
_dc "github.com/unidoc/unioffice/v2/spreadsheet/reference";_a "github.com/unidoc/unipdf/v3/creator";_c "github.com/unidoc/unipdf/v3/model";_d "image";_g "math";_gc "sort";_b "strconv";);func (_bbab *convertContext )getStyleFromRPrElt (_ebee *_df .CT_RPrElt )*style {if _ebee ==nil ||_ebee .RPrEltChoice ==nil ||len (_ebee .RPrEltChoice )==0{return nil ;
};_ggd :=&style {};for _ ,_fgee :=range _ebee .RPrEltChoice {if _fgee .RFont !=nil {_ggd ._dcafb =&_fgee .RFont .ValAttr ;};if _dbca :=_fgee .B ;_dbca !=nil {_edbg :=_dbca .ValAttr ==nil ||*_dbca .ValAttr ;_ggd ._ggeg =&_edbg ;};if _begg :=_fgee .I ;_begg !=nil {_ggbb :=_begg .ValAttr ==nil ||*_begg .ValAttr ;
_ggd ._dcdg =&_ggbb ;};if _cbdg :=_fgee .U ;_cbdg !=nil {_gecge :=_cbdg .ValAttr ==_df .ST_UnderlineValuesSingle ||_cbdg .ValAttr ==_df .ST_UnderlineValuesUnset ;_ggd ._acd =&_gecge ;};if _ffd :=_fgee .VertAlign ;_ffd !=nil {_efab :=_ffd .ValAttr ==_f .ST_VerticalAlignRunSuperscript ;
_ggd ._fbd =&_efab ;_becf :=_ffd .ValAttr ==_f .ST_VerticalAlignRunSubscript ;_ggd ._bcce =&_becf ;};if _bbgb :=_fgee .Sz ;_bbgb !=nil {_baffg :=_bbgb .ValAttr ;_ggd ._ecc =&_baffg ;};if _dfcde :=_fgee .Color ;_dfcde !=nil {_ggd ._accdf =_bbab .getColorStringFromSmlColor (_dfcde );
};};return _ggd ;};func (_beba *convertContext )fillPages (){for _fee ,_fcd :=range _beba ._dggg {_ddeb :=_beba ._fba [_fcd ._ggfc :_fcd ._dabf ];for _dbfaf ,_eec :=range _ddeb {_cge :=0;_afe :=0.0;_cedd :=[]*cell {};if _eec ._gdce {for _ ,_fgc :=range _eec ._fedc {_bdb :=_beba ._gbb [_cge ];
_beba ._cfa =_bdb ._ddcd [_fee ];_beba ._cfa ._acf =true ;_cca :=_fgc ._aed ;if _afe +_cca > _bdb ._bbd {_beba .addRowToPage (_cedd ,_dbfaf );_cedd =[]*cell {_fgc };_afe =_cca ;_cge ++;}else {_fgc ._geff =_afe ;_cedd =append (_cedd ,_fgc );_afe +=_cca ;
};};if len (_cedd )> 0{_bgc :=_beba ._gbb [_cge ];_beba ._cfa =_bgc ._ddcd [_fee ];_beba ._cfa ._acf =true ;_beba .addRowToPage (_cedd ,_dbfaf );};};};};};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;
);var _edfa =map[uint32 ]_a .PageSize {1:_a .PageSize {8.5*_dcf .Inch ,11*_dcf .Inch },2:_a .PageSize {8.5*_dcf .Inch ,11*_dcf .Inch },3:_a .PageSize {11*_dcf .Inch ,17*_dcf .Inch },4:_a .PageSize {17*_dcf .Inch ,11*_dcf .Inch },5:_a .PageSize {8.5*_dcf .Inch ,14*_dcf .Inch },6:_a .PageSize {5.5*_dcf .Inch ,8.5*_dcf .Inch },7:_a .PageSize {7.5*_dcf .Inch ,10*_dcf .Inch },8:_a .PageSize {_fegf (297),_fegf (420)},9:_a .PageSize {_fegf (210),_fegf (297)},10:_a .PageSize {_fegf (210),_fegf (297)},11:_a .PageSize {_fegf (148),_fegf (210)},70:_a .PageSize {_fegf (105),_fegf (148)},12:_a .PageSize {_fegf (250),_fegf (354)},13:_a .PageSize {_fegf (182),_fegf (257)},14:_a .PageSize {8.5*_dcf .Inch ,13*_dcf .Inch },20:_a .PageSize {4.125*_dcf .Inch ,9.5*_dcf .Inch },27:_a .PageSize {_fegf (110),_fegf (220)},28:_a .PageSize {_fegf (162),_fegf (229)},34:_a .PageSize {_fegf (250),_fegf (176)},29:_a .PageSize {_fegf (324),_fegf (458)},30:_a .PageSize {_fegf (229),_fegf (324)},31:_a .PageSize {_fegf (114),_fegf (162)},37:_a .PageSize {3.88*_dcf .Inch ,7.5*_dcf .Inch },43:_a .PageSize {_fegf (100),_fegf (148)},69:_a .PageSize {_fegf (200),_fegf (148)}};
type cell struct{_fefb _df .ST_CellType ;_afb int ;_geff float64 ;_ggbc []*line ;_feab float64 ;_aed float64 ;_cfec float64 ;_caddb float64 ;_dgcc float64 ;_gba *_a .TextStyle ;_dgeg *border ;_aadf *border ;_bgcd *border ;_fcc *border ;_egff bool ;_cdfb bool ;
_ece _a .Color ;};func (_edc *convertContext )getSymbolsFromString (_fae string ,_abc *style )[]*symbol {_fedf :=[]*symbol {};_aba :=_edc .makeTextStyleFromCellStyle (_abc );for _ ,_fdbb :=range _fae {_fedf =append (_fedf ,&symbol {_fbeg :string (_fdbb ),_ceaf :_aba });
};return _fedf ;};func (_fbec *convertContext )alignSymbolsVertically (_ffee *cell ,_cbg _df .ST_VerticalAlignment ){var _dbe float64 ;switch _cbg {case _df .ST_VerticalAlignmentTop :_dbe =_ff ;if _ffee ._egff {_dbe -=_da ;}else if _ffee ._cdfb {_dbe +=4*_da ;
};for _ ,_bbba :=range _ffee ._ggbc {_dbe +=_bbba ._adba ;_bbba ._gfff =_dbe ;_dbe +=_bbc ;};case _df .ST_VerticalAlignmentCenter :_bae :=0.0;for _ ,_dedb :=range _ffee ._ggbc {_bae +=_dedb ._adba +_fegf (1);};_dbe =0.5*(_ffee ._cfec -_bae );if _ffee ._egff {_dbe -=2*_da ;
}else if _ffee ._cdfb {_dbe +=2*_da ;};for _ ,_cfb :=range _ffee ._ggbc {_dbe +=_cfb ._adba +0.5*_bbc ;_cfb ._gfff =_dbe ;_dbe +=0.5*_bbc ;};default:_dbe =_ffee ._cfec -_ff ;if _ffee ._egff {_dbe -=4*_da ;}else if _ffee ._cdfb {_dbe +=_da ;};for _fda :=len (_ffee ._ggbc )-1;
_fda >=0;_fda --{_ffee ._ggbc [_fda ]._gfff =_dbe ;_dbe -=_ffee ._ggbc [_fda ]._adba ;_dbe -=_bbc ;};};};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_ad .Sheet )*_a .Creator {return ConvertToPdfWithOptions (s ,nil )};func _fedfd (_ggfe ,_dbbd *style ){if _dbbd ==nil {return ;};if _ggfe ==nil {_ggfe =_dbbd ;return ;};if _ggfe ._fgd ==nil {_ggfe ._fgd =_dbbd ._fgd ;};if _ggfe ._dcafb ==nil {_ggfe ._dcafb =_dbbd ._dcafb ;
};if _ggfe ._accdf ==nil {_ggfe ._accdf =_dbbd ._accdf ;};if _ggfe ._ecc ==nil {_ggfe ._ecc =_dbbd ._ecc ;};if _ggfe ._ggeg ==nil {_ggfe ._ggeg =_dbbd ._ggeg ;};if _ggfe ._dcdg ==nil {_ggfe ._dcdg =_dbbd ._dcdg ;};if _ggfe ._acd ==nil {_ggfe ._acd =_dbbd ._acd ;
};if _ggfe ._fbd ==nil {_ggfe ._fbd =_dbbd ._fbd ;};if _ggfe ._bcce ==nil {_ggfe ._bcce =_dbbd ._bcce ;};if _ggfe ._fffbb ==nil {_ggfe ._fffbb =_dbbd ._fffbb ;};if _ggfe ._ggfa ==nil {_ggfe ._ggfa =_dbbd ._ggfa ;};if _ggfe ._baff ==nil {_ggfe ._baff =_dbbd ._baff ;
};if _ggfe ._fbad ==nil {_ggfe ._fbad =_dbbd ._fbad ;};if _ggfe ._daefa ==_df .ST_VerticalAlignmentUnset {_ggfe ._daefa =_dbbd ._daefa ;};if _ggfe ._fgec ==_df .ST_HorizontalAlignmentUnset {_ggfe ._fgec =_dbbd ._fgec ;};};func (_ffff *convertContext )getColorFromTheme (_faad uint32 )string {_begge :=_ffff ._gcaee .Themes ();
if len (_begge )!=0{_dbfd :=_begge [0];if _egfg :=_dbfd .ThemeElements ;_egfg !=nil {if _ddecc :=_egfg .ClrScheme ;_ddecc !=nil {switch _faad {case 0:return _cd .GetColorStringFromDmlColor (_ddecc .Lt1 );case 1:return _cd .GetColorStringFromDmlColor (_ddecc .Dk1 );
case 2:return _cd .GetColorStringFromDmlColor (_ddecc .Lt2 );case 3:return _cd .GetColorStringFromDmlColor (_ddecc .Dk2 );case 4:return _cd .GetColorStringFromDmlColor (_ddecc .Accent1 );case 5:return _cd .GetColorStringFromDmlColor (_ddecc .Accent2 );
case 6:return _cd .GetColorStringFromDmlColor (_ddecc .Accent3 );case 7:return _cd .GetColorStringFromDmlColor (_ddecc .Accent4 );case 8:return _cd .GetColorStringFromDmlColor (_ddecc .Accent5 );case 9:return _cd .GetColorStringFromDmlColor (_ddecc .Accent6 );
};};};};return "";};func (_eba *convertContext )makeRows (){_eagd :=[]*rowInfo {};_ab :=_eba ._eebc .Rows ();_gaf :=0;_ebe :=0.0;for _geae ,_fa :=range _ab {if _geae < _eba ._edef ||(_geae > _eba ._acbg &&_eba ._acbg > 0){continue ;};_gaf ++;_dbc :=int (_fa .RowNumber ());
if _dbc > _gaf {for _daf :=_gaf ;_daf < _dbc ;_daf ++{_eagd =append (_eagd ,&rowInfo {_gdbg :_gca /_ag });_ebe +=_gca /_ag ;};_gaf =_dbc ;};var _dbd float64 ;if _fa .X ().HtAttr ==nil {_dbd =_gca ;}else {_dbd =*_fa .X ().HtAttr ;};_eagd =append (_eagd ,&rowInfo {_gdbg :_dbd /_ag ,_gdce :true ,_bfge :_eba .getStyle (_fa .X ().SAttr )});
_ebe +=_dbd /_ag ;};for _gcd :=len (_eagd );_gcd < _eba ._fddg ;_gcd ++{_eagd =append (_eagd ,&rowInfo {_gdbg :_gca /_ag });_ebe +=_gca /_ag ;};if _eba ._ecgaa ||_ebe >=_eba ._daef {_cgb :=_eba ._dbeb ;if _eba ._daef /_ebe < _eba ._dbeb {_cgb =_eba ._daef /_ebe ;
};for _ ,_bgeg :=range _eagd {_bgeg ._gdbg *=_cgb ;};};_eba ._fba =_eagd ;};

// ConvertToPdfWithOptions convert a sheet to PDF with given options.
func ConvertToPdfWithOptions (s *_ad .Sheet ,opts *Options )*_a .Creator {_eg :=s .X ();if _eg ==nil {return nil ;};var _adg _a .PageSize ;_cg :=true ;_ge :=false ;if _eg .SheetPr !=nil &&_eg .SheetPr .PageSetUpPr !=nil &&_eg .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_eg .SheetPr .PageSetUpPr .FitToPageAttr {_ge =true ;
};if _egd :=_eg .PageSetup ;_egd !=nil {_cg =_egd .OrientationAttr ==_df .ST_OrientationLandscape ;if _be :=_egd .PaperSizeAttr ;_be !=nil {_adg =_edfa [*_be ];};};if (_adg ==_a .PageSize {}){_adg =_cd .GetDefaultPageSize ();if opts !=nil &&opts .DefaultPageSize !=_cd .DefaultPageSize {_adg =_cd .GetPageDimensions (opts .DefaultPageSize );
};};if _cg {_adg [0],_adg [1]=_adg [1],_adg [0];};_edf :=_a .New ();_edf .SetPageSize (_adg );var _db ,_fg ,_fgb ,_dae float64 ;if _bee :=_eg .PageMargins ;_bee !=nil {_fgb =_bee .LeftAttr ;_dae =_bee .RightAttr ;_db =_bee .TopAttr ;_fg =_bee .BottomAttr ;
};if _fgb < _adc {_fgb =_adc ;};if _dae < _adc {_dae =_adc ;};if _db < _ac {_db =_ac ;};if _fg < _ac {_fg =_ac ;};_db *=_dcf .Inch ;_fg *=_dcf .Inch ;_fgb *=_dcf .Inch ;_dae *=_dcf .Inch ;_edf .SetPageMargins (_fgb ,_dae ,_db ,_fg );_dfd :=s .Workbook ();
var _gcc *_cb .Theme ;if len (_dfd .Themes ())> 0{_gcc =_dfd .Themes ()[0];};var _ee ,_fff ,_ea ,_fc int ;for _ ,_cc :=range _dfd .DefinedNames (){if _cc .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_dgf ,_ga ,_eab ,_gea :=_cd .ParseExcelRange (_cc .Content ());
if _gea ==nil &&s .Name ()==_dgf {_ee =int (_ga .ColumnIdx );_fff =int (_eab .ColumnIdx );_ea =int (_ga .RowIdx );_fc =int (_eab .RowIdx );};};};_edd :=[]_ad .Table {};if _eg .TableParts !=nil &&_eg .TableParts .TablePart !=nil {_bef :=0;_ec :=s .Workbook ().Tables ();
_gc .Slice (_ec [:],func (_eag ,_gf int )bool {return _ec [_eag ].X ().IdAttr < _ec [_gf ].X ().IdAttr });for _ ,_bge :=range s .Workbook ().Sheets (){if _bge .Name ()==s .Name (){break ;}else {if _bge .X ().TableParts !=nil &&_bge .X ().TableParts .TablePart !=nil {_bef +=len (_bge .X ().TableParts .TablePart );
};};};if len (_ec )>=_bef +len (_eg .TableParts .TablePart ){_edd =append (_edd ,_ec [_bef :_bef +len (_eg .TableParts .TablePart )]...);};};_ecg :=&convertContext {_gae :_edf ,_eebc :s ,_gcaee :s .Workbook (),_ccdg :_gcc ,_dbaa :&s .Workbook ().StyleSheet ,_fec :_db ,_bfc :_fgb ,_daef :_adg [1]-_fg -_db ,_fdbg :_adg [0]-_dae -_fgb ,_bfdb :_ee ,_fddc :_fff ,_edef :_ea ,_acbg :_fc ,_ecgaa :_ge ,_ebfa :_edd };
_ecg .makeAnchors ();_ecg .determineMaxIndexes ();if _ecg ._fddg ==0&&_ecg ._aebb ==0{_edf .NewPage ();return _edf ;};_ecg .makeCols ();_ecg .makeRows ();_ecg .makeMergedCells ();_ecg .makeCells ();_ecg .makePagespans ();_ecg .makeRowspans ();_ecg .makePages ();
_ecg .fillPages ();_ecg .distributeAnchors ();_ecg .drawSheet ();return _edf ;};type pageRow struct{_ggb int ;_deb []*cell ;};func (_ecd *convertContext )makeAnchors (){_bbg ,_adf :=_ecd ._eebc .GetDrawing ();if _bbg !=nil {for _ ,_bf :=range _bbg .EG_Anchor {_ce :=&anchor {};
if _de :=_bf .AnchorChoice .TwoCellAnchor ;_de !=nil {_def ,_af :=_de .From ,_de .To ;if _def ==nil ||_af ==nil {return ;};_ce ._cfbd =int (_def .Row );_ce ._fbdf =_cd .FromSTCoordinate (_def .RowOff );_ce ._efb =int (_def .Col );_ce ._gab =_cd .FromSTCoordinate (_def .ColOff );
_ce ._fcde =int (_af .Row );_ce ._fcce =_cd .FromSTCoordinate (_af .RowOff );_ce ._cdbf =int (_af .Col );_ce ._dcb =_cd .FromSTCoordinate (_af .ColOff );if _ffa :=_de .ObjectChoicesChoice ;_ffa !=nil {if _beff :=_ffa .Pic ;_beff !=nil {if _bfd :=_beff .BlipFill ;
_bfd !=nil {if _afc :=_bfd .Blip ;_afc !=nil {if _dfc :=_afc .EmbedAttr ;_dfc !=nil {for _ ,_dbf :=range _adf .X ().Relationship {if _dbf .IdAttr ==*_dfc {for _ ,_gg :=range _ecd ._gcaee .Images {if _gg .Target ()==_dbf .TargetAttr {_dea ,_ceb :=_add .Open (_gg .Path ());
if _ceb !=nil {_gb .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_ceb );continue ;};_dfdb ,_ ,_ceb :=_d .Decode (_dea );if _ceb !=nil {_gb .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_ceb );
continue ;};_ce ._egdb =_dfdb ;};};};};};};};}else if _ace :=_ffa .GraphicFrame ;_ace !=nil {if _aac :=_ace .Graphic ;_aac !=nil {if _ggc :=_aac .GraphicData ;_ggc !=nil {for _ ,_gff :=range _ggc .Any {if _caf ,_gd :=_gff .(*_bg .Chart );_gd {for _ ,_eb :=range _adf .X ().Relationship {if _eb .IdAttr ==_caf .IdAttr {_ae :=_ecd ._gcaee .GetChartByTargetId (_eb .TargetAttr );
if _ae !=nil {_ce ._abda =_ae ;};};};};};};};};};};if _ce ._egdb !=nil ||_ce ._abda !=nil {_ecd ._dgce =append (_ecd ._dgce ,_ce );};};};};func (_aaee *convertContext )getImage (_fbecb _d .Image ,_bfda ,_dddd ,_gdca ,_adb ,_ebc ,_dgb float64 ,_aff _cd .ImgPart )*_a .Image {_adb +=_aaee ._fec ;
_gdca +=_aaee ._bfc ;_efaf ,_degb :=_cd .GetImage (_aaee ._gae ,_fbecb ,_bfda ,_dddd ,_gdca ,_adb ,_ebc ,_dgb ,_aff );if _degb !=nil {_gb .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_degb );
return nil ;};return _efaf ;};func _dfag (_fdde []*symbol )float64 {_cebf :=0.0;for _ ,_ceae :=range _fdde {_cebf +=_ceae ._cegc ;};return _cebf ;};func (_cafb *convertContext )drawSheet (){for _bgab ,_cbd :=range _cafb ._gbb {_eeg :=len (_cbd ._ddcd );
if _bgab ==len (_cafb ._gbb )-1{for _ebd :=len (_cbd ._ddcd )-1;_ebd >=0;_ebd --{if !_cbd ._ddcd [_ebd ]._acf {_eeg =_ebd ;};};};_bcb :=_cbd ._ddcd [:_eeg ];for _ ,_gfde :=range _bcb {_cafb ._gae .NewPage ();_cafb .drawPage (_gfde );};};};func (_bade *convertContext )alignSymbolsHorizontally (_fgbf *cell ,_gdg _df .ST_HorizontalAlignment ){if _gdg ==_df .ST_HorizontalAlignmentUnset {switch _fgbf ._fefb {case _df .ST_CellTypeB :_gdg =_df .ST_HorizontalAlignmentCenter ;
case _df .ST_CellTypeN :_gdg =_df .ST_HorizontalAlignmentRight ;default:_gdg =_df .ST_HorizontalAlignmentLeft ;};};var _ebge float64 ;for _ ,_ceacc :=range _fgbf ._ggbc {switch _gdg {case _df .ST_HorizontalAlignmentLeft :_ebge =_bb ;case _df .ST_HorizontalAlignmentRight :_bag :=_dfag (_ceacc ._debg );
_ebge =_fgbf ._feab -_bb -_bag ;case _df .ST_HorizontalAlignmentCenter :_acec :=_dfag (_ceacc ._debg );_ebge =(_fgbf ._feab -_acec )/2;};for _ ,_ddd :=range _ceacc ._debg {_ddd ._ddbf +=_ebge ;};};};const _da =1.5;type convertContext struct{_gae *_a .Creator ;
_gcaee *_ad .Workbook ;_ccdg *_cb .Theme ;_eebc *_ad .Sheet ;_dbaa *_ad .StyleSheet ;_fddg int ;_aebb int ;_gbb []*pagespan ;_cfa *page ;_bgg []*colInfo ;_fba []*rowInfo ;_dggg []*rowspan ;_fec float64 ;_bfc float64 ;_daef float64 ;_fdbg float64 ;_dggf []*mergedCell ;
_dgce []*anchor ;_dbeb float64 ;_bfdb int ;_fddc int ;_edef int ;_acbg int ;_ecgaa bool ;_ebfa []_ad .Table ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_c .PdfFont ){_cd .RegisterFont (name ,style ,font );};type border struct{_cegb float64 ;_bfe _a .Color ;};func _agdb (_bbe *bool )bool {return _bbe !=nil &&*_bbe };type rowspan struct{_egf float64 ;
_ggfc int ;_dabf int ;};type page struct{_gcag []*pageRow ;_acf bool ;_aab []*_a .Image ;_ecgb *pagespan ;_fbee *rowspan ;};func (_eaa *convertContext )makeCells (){_cga :=_eaa ._eebc ;_bfb :=_cga .Rows ();_ged :=0;for _abd ,_dca :=range _eaa ._fba {if _abd < _eaa ._edef ||(_abd > _eaa ._acbg &&_eaa ._acbg > 0){continue ;
};_dca ._fedc =[]*cell {};_aacd :=0.0;_gdd :=_dca ._bfge ;if _dca ._gdce {_dgc :=_bfb [_ged ];_ged ++;_dbfa :=_dca ._gdbg ;for _ ,_cda :=range _dgc .Cells (){_bcd ,_bcc :=_dc .ParseCellReference (_cda .Reference ());if _bcc !=nil {_gb .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_bcc );
continue ;};if int (_bcd .ColumnIdx )< _eaa ._bfdb ||(int (_bcd .ColumnIdx )> _eaa ._fddc &&_eaa ._fddc > 0){continue ;};_adcg :=_eaa ._bgg [_bcd .ColumnIdx ];_ege :=_adcg ._dedf ;_agd :=_ege ;_gcb :=_adcg ._eae ;var _dag ,_aaf ,_accg ,_dcg bool ;for _ ,_fffb :=range _eaa ._dggf {if _bcd .RowIdx >=_fffb ._egce &&_bcd .RowIdx <=_fffb ._dfe &&_bcd .ColumnIdx >=_fffb ._bgfe &&_bcd .ColumnIdx <=_fffb ._bggb {if _bcd .ColumnIdx ==_fffb ._bgfe &&_bcd .RowIdx ==_fffb ._egce {_ege =_fffb ._bbdd ;
_dbfa =_fffb ._fbda ;};_dag =_bcd .RowIdx !=_fffb ._egce ;_aaf =_bcd .RowIdx !=_fffb ._dfe ;_accg =_bcd .ColumnIdx !=_fffb ._bgfe ;_dcg =_bcd .ColumnIdx !=_fffb ._bggb ;};};var _adff *style ;for _ ,_cbb :=range _eaa ._ebfa {_efg ,_fab ,_egb :=_dc .ParseRangeReference (_cbb .Reference ());
if _egb !=nil ||_efg .RowIdx > _bcd .RowIdx ||_efg .ColumnIdx > _bcd .ColumnIdx ||_fab .RowIdx < _bcd .RowIdx ||_fab .ColumnIdx < _bcd .ColumnIdx ||_eaa ._gcaee .StyleSheet .X ().TableStyles ==nil {continue ;};_cdf :=_bcd .RowIdx ==_efg .RowIdx ;for _ ,_deaa :=range _eaa ._gcaee .StyleSheet .X ().TableStyles .TableStyle {if _cbb .X ().TableStyleInfo .NameAttr !=nil &&_deaa .NameAttr ==*_cbb .X ().TableStyleInfo .NameAttr {for _ ,_cgbf :=range _deaa .TableStyleElement {if !_cdf &&_cgbf .TypeAttr ==_df .ST_TableStyleTypeWholeTable {_adff =_eaa .getDxfStyle (_cgbf .DxfIdAttr );
};if _cdf &&_cgbf .TypeAttr ==_df .ST_TableStyleTypeHeaderRow {_adff =_eaa .getDxfStyle (_cgbf .DxfIdAttr );};};};};};_dab :=_eaa .getStyleFromCell (_cda ,_gdd ,_gcb ,_adff );var _ddgd ,_eac ,_fde ,_daed bool ;var _cf ,_cea ,_ecf ,_cdad *border ;var _dgd _df .ST_VerticalAlignment ;
var _ccb _df .ST_HorizontalAlignment ;if _dab !=nil {if !_dag {_cf =_dab ._fffbb ;};if !_aaf {_cea =_dab ._ggfa ;};if !_accg {_ecf =_dab ._baff ;};if !_dcg {_cdad =_dab ._fbad ;};if _cea !=nil &&_cea ._cegb > _aacd {_aacd =_cea ._cegb ;};_dgd =_dab ._daefa ;
_ccb =_dab ._fgec ;if _dab ._fbd !=nil {_ddgd =*_dab ._fbd ;};if _dab ._bcce !=nil {_eac =*_dab ._bcce ;};_fde =_dab ._gcad ;_daed =_dab ._ffec ;};var _gac _a .Color ;if _dab !=nil &&_dab ._fgd !=nil {_gac =_a .ColorRGBFromHex (*_dab ._fgd );};_gde ,_cebd :=_eaa .getContentFromCell (_cga ,_cda ,_dab ,_ege ,_fde ,_daed );
_fdf :=&cell {_fefb :_cebd ,_feab :_ege ,_aed :_agd ,_cfec :_dbfa ,_ggbc :_gde ,_dgeg :_cf ,_aadf :_cea ,_bgcd :_ecf ,_fcc :_cdad ,_egff :_ddgd ,_cdfb :_eac ,_ece :_gac };_eaa .alignSymbolsHorizontally (_fdf ,_ccb );_eaa .alignSymbolsVertically (_fdf ,_dgd );
_dca ._fedc =append (_dca ._fedc ,_fdf );};};_dca ._gbfe =_aacd ;};};func (_bec *convertContext )makeMergedCells (){_ebf :=[]*mergedCell {};for _ ,_aca :=range _bec ._eebc .MergedCells (){_cbf ,_cag ,_dde :=_dc .ParseRangeReference (_aca .Reference ());
if _dde !=nil {_gb .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_dde );continue ;};_aec :=mergedCell {_egce :_cbf .RowIdx ,_bgfe :_cbf .ColumnIdx ,_dfe :_cag .RowIdx ,_bggb :_cag .ColumnIdx };
for _ddb :=_aec ._bgfe -1;_ddb < _aec ._bggb ;_ddb ++{_aec ._bbdd +=_bec ._bgg [_ddb ]._dedf ;};for _ddef :=_aec ._egce -1;_ddef < _aec ._dfe ;_ddef ++{_aec ._fbda +=_bec ._fba [_ddef ]._gdbg ;};_ebf =append (_ebf ,&_aec );};_bec ._dggf =_ebf ;};func (_fbf *convertContext )distributeAnchors (){for _ ,_geb :=range _fbf ._dgce {_addf ,_bce :=_geb ._cfbd ,_geb ._fbdf ;
_gfgd ,_cce :=_geb ._efb ,_geb ._gab ;_bgf ,_fef :=_geb ._fcde ,_geb ._fcce ;_feb ,_dec :=_geb ._cdbf ,_geb ._dcb ;if _addf < _fbf ._edef ||(_bgf > _fbf ._acbg &&_fbf ._acbg > 0){continue ;};if _gfgd < _fbf ._bfdb ||(_feb > _fbf ._fddc &&_fbf ._fddc > 0){continue ;
};var _cac ,_abdc ,_eff ,_ebff *page ;for _ ,_baf :=range _fbf ._gbb {for _ ,_fag :=range _baf ._ddcd {if _addf >=_fag ._fbee ._ggfc &&_addf < _fag ._fbee ._dabf {if _gfgd >=_fag ._ecgb ._cbfe &&_gfgd < _fag ._ecgb ._aeba {_fag ._acf =true ;_cac =_fag ;
};if _feb >=_fag ._ecgb ._cbfe &&_feb < _fag ._ecgb ._aeba {_fag ._acf =true ;_abdc =_fag ;};};if _bgf >=_fag ._fbee ._ggfc &&_bgf < _fag ._fbee ._dabf {if _gfgd >=_fag ._ecgb ._cbfe &&_gfgd < _fag ._ecgb ._aeba {_fag ._acf =true ;_ebff =_fag ;};if _feb >=_fag ._ecgb ._cbfe &&_feb < _fag ._ecgb ._aeba {_fag ._acf =true ;
_eff =_fag ;};};};};_gfd :=_cac !=_abdc ;_dbdc :=_cac !=_ebff ;if _gfd &&_dbdc {_bba :=_fbf ._bgg [_gfgd ]._daec +_dcf .FromEMU (_cce );_aad :=_cac ._ecgb ._bbd ;_dce :=_fbf ._bgg [_feb ]._daec +_dcf .FromEMU (_dec );_dfa :=_fbf ._fba [_addf ]._cece +_dcf .FromEMU (_bce );
_fed :=float64 (_cac ._fbee ._egf );_beef :=_fbf ._fba [_bgf ]._cece +_dcf .FromEMU (_fef );_dfae :=_dce +_aad -_bba ;_bad :=_beef +_fed -_dfa ;_gdcg :=_fbf .imageFromAnchor (_geb ,_dfae ,_bad );_cac ._aab =append (_cac ._aab ,_fbf .getImage (_gdcg ,_bad ,_dfae ,_bba ,_dfa ,_aad -_bba ,_fed -_dfa ,_cd .ImgPart_lt ));
_abdc ._aab =append (_abdc ._aab ,_fbf .getImage (_gdcg ,_bad ,_dfae ,0,_dfa ,_aad -_bba ,_fed -_dfa ,_cd .ImgPart_rt ));_ebff ._aab =append (_ebff ._aab ,_fbf .getImage (_gdcg ,_bad ,_dfae ,_bba ,0,_aad -_bba ,_fed -_dfa ,_cd .ImgPart_lb ));_eff ._aab =append (_eff ._aab ,_fbf .getImage (_gdcg ,_bad ,_dfae ,0,0,_aad -_bba ,_fed -_dfa ,_cd .ImgPart_rb ));
}else if _gfd {_dgg :=_fbf ._fba [_addf ]._cece +_dcf .FromEMU (_bce );_bga :=_fbf ._fba [_bgf ]._cece +_dcf .FromEMU (_fef );_cfe :=_fbf ._bgg [_gfgd ]._daec +_dcf .FromEMU (_cce );_cadd :=_cac ._ecgb ._bbd ;_fbfb :=_fbf ._bgg [_feb ]._daec +_dcf .FromEMU (_dec );
_gdfa :=_fbfb +_cadd -_cfe ;_cdff :=_bga -_dgg ;_accd :=_fbf .imageFromAnchor (_geb ,_gdfa ,_cdff );_cac ._aab =append (_cac ._aab ,_fbf .getImage (_accd ,_cdff ,_gdfa ,_cfe ,_dgg ,_cadd -_cfe ,0,_cd .ImgPart_l ));_abdc ._aab =append (_abdc ._aab ,_fbf .getImage (_accd ,_cdff ,_gdfa ,0,_dgg ,_cadd -_cfe ,0,_cd .ImgPart_r ));
}else if _dbdc {_cagf :=_fbf ._bgg [_gfgd ]._daec +_dcf .FromEMU (_cce );_gfdb :=_fbf ._bgg [_feb ]._daec +_dcf .FromEMU (_dec );_feda :=_fbf ._fba [_addf ]._cece +_dcf .FromEMU (_bce );_bfbg :=float64 (_cac ._fbee ._egf );_agdd :=_fbf ._fba [_bgf ]._cece +_dcf .FromEMU (_fef );
_cba :=_gfdb -_cagf ;_eee :=_agdd +_bfbg -_feda ;_bfg :=_fbf .imageFromAnchor (_geb ,_cba ,_eee );_cac ._aab =append (_cac ._aab ,_fbf .getImage (_bfg ,_eee ,_cba ,_cagf ,_feda ,0,_bfbg -_feda ,_cd .ImgPart_t ));_ebff ._aab =append (_ebff ._aab ,_fbf .getImage (_bfg ,_eee ,_cba ,_cagf ,0,0,_bfbg -_feda ,_cd .ImgPart_b ));
}else {_dafa :=_fbf ._bgg [_gfgd ]._daec +_dcf .FromEMU (_cce );_gfc :=_fbf ._bgg [_feb ]._daec +_dcf .FromEMU (_dec );_eeca :=_fbf ._fba [_addf ]._cece +_dcf .FromEMU (_bce );_aeg :=_fbf ._fba [_bgf ]._cece +_dcf .FromEMU (_fef );_cbc :=_gfc -_dafa ;_gee :=_aeg -_eeca ;
_fedb :=_fbf .imageFromAnchor (_geb ,_cbc ,_gee );_cac ._aab =append (_cac ._aab ,_fbf .getImage (_fedb ,_gee ,_cbc ,_dafa ,_eeca ,0,0,_cd .ImgPart_whole ));};};};const _adc =0.25;type colWidthRange struct{_dgcea int ;_ecca int ;_cdb float64 ;_gad *style ;
};func (_edad *convertContext )getStyleFromCell (_defd _ad .Cell ,_cafe ,_cbdc ,_edba *style )*style {if _edba !=nil {_fedfd (_edba ,_cafe );_fedfd (_edba ,_cbdc );return _edba ;};_dbdcf :=_defd .X ();_bgac :=_edad .getStyle (_dbdcf .SAttr );_fedfd (_bgac ,_cafe );
_fedfd (_bgac ,_cbdc );return _bgac ;};const _acc =64.0;func (_edg *convertContext )makePagespans (){_edg ._gbb =[]*pagespan {};_gbe :=0.0;_dgfd :=0;for _ded ,_gga :=range _edg ._bgg {_ba :=_gga ._dedf ;if _gbe +_ba <=_edg ._fdbg {_gga ._daec =_gbe ;_gbe +=_ba ;
}else {_gga ._daec =0;_edg ._gbb =append (_edg ._gbb ,&pagespan {_bbd :_gbe ,_cbfe :_dgfd ,_aeba :_ded });_gbe =_ba ;_dgfd =_ded ;};};_edg ._gbb =append (_edg ._gbb ,&pagespan {_bbd :_gbe ,_cbfe :_dgfd ,_aeba :len (_edg ._bgg )});};func (_bdbd *convertContext )getSymbolsFromR (_dcd []*_df .CT_RElt ,_gecg *style )[]*symbol {_aef :=[]*symbol {};
for _ ,_ffe :=range _dcd {_ccd :=_bdbd .combineCellStyleWithRPrElt (_gecg ,_ffe .RPr );for _ ,_bab :=range _ffe .T {_aef =append (_aef ,&symbol {_fbeg :string (_bab ),_ceaf :_bdbd .makeTextStyleFromCellStyle (_ccd )});};};return _aef ;};var _ag =3.025/_fegf (1);
func (_gdf *convertContext )makeCols (){_ggf :=_gdf ._eebc ;_dfcd :=_ggf .X ();_fe :=[]*colInfo {};_bgd :=[]colWidthRange {};if _fdb :=_dfcd .Cols ;len (_fdb )> 0{for _ ,_dad :=range _fdb [0].Col {_bca :=_acc ;if _bgde :=_dad .WidthAttr ;_bgde !=nil {if *_bgde > 0.83{*_bgde -=0.83;
};if *_bgde <=1{_bca =*_bgde *11;}else {_bca =5+*_bgde *6;};};_gbff :=int (_dad .MinAttr -1);_agfg :=int (_dad .MaxAttr -1);_bgd =append (_bgd ,colWidthRange {_dgcea :_gbff ,_ecca :_agfg ,_cdb :_bca ,_gad :_gdf .getStyle (_dad .StyleAttr )});};};_gfb :=0;
for _gge :=0;_gge <=_gdf ._aebb ;_gge ++{if _gge < _gdf ._bfdb ||(_gge > _gdf ._fddc &&_gdf ._fddc > 0){continue ;};var _beb float64 ;var _cdd *style ;if len (_bgd )==0{_beb =_acc ;}else if _gfb < len (_bgd ){_eeb :=_bgd [_gfb ];if _gge >=_eeb ._dgcea &&_gge <=_eeb ._ecca {_beb =_eeb ._cdb ;
_cdd =_eeb ._gad ;if _gge ==_eeb ._ecca {_gfb ++;};}else {continue ;};};_fe =append (_fe ,&colInfo {_dedf :_beb ,_eae :_cdd });};_dfdg :=0.0;for _ ,_aace :=range _fe {_dfdg +=_aace ._dedf ;};_gdf ._dbeb =1.0;if _dfdg > _gdf ._fdbg {_gdf ._dbeb =_gdf ._fdbg /_dfdg ;
for _ ,_ef :=range _fe {_ef ._dedf *=_gdf ._dbeb ;};};_gdf ._bgg =_fe ;};func (_daa *convertContext )getBorder (_gfgdc *_df .CT_BorderPr )*border {_gdcea :=&border {};switch _gfgdc .StyleAttr {case _df .ST_BorderStyleHair :_gdcea ._cegb =_gbf /2;case _df .ST_BorderStyleThin :_gdcea ._cegb =_gbf ;
case _df .ST_BorderStyleMedium :_gdcea ._cegb =_gbf *2;case _df .ST_BorderStyleThick :_gdcea ._cegb =_gbf *4;};if _gdcea ._cegb ==0.0{return nil ;};if _adfg :=_gfgdc .Color ;_adfg !=nil {_gfga :=_daa .getColorStringFromSmlColor (_adfg );if _gfga !=nil {_gdcea ._bfe =_a .ColorRGBFromHex (*_gfga );
}else {_gdcea ._bfe =_a .ColorBlack ;};};return _gdcea ;};type style struct{_fgd *string ;_accdf *string ;_ecc *float64 ;_dcafb *string ;_ggeg *bool ;_dcdg *bool ;_acd *bool ;_fbd *bool ;_bcce *bool ;_fffbb *border ;_ggfa *border ;_baff *border ;_fbad *border ;
_gcad bool ;_daefa _df .ST_VerticalAlignment ;_fgec _df .ST_HorizontalAlignment ;_ffec bool ;};const _bb =3;type colInfo struct{_daec float64 ;_dedf float64 ;_eae *style ;};func (_agb *convertContext )combineCellStyleWithRPrElt (_ffabe *style ,_gfgde *_df .CT_RPrElt )*style {_fgdc :=*_ffabe ;
_bdbg :=_agb .getStyleFromRPrElt (_gfgde );if _bdbg ==nil {return &_fgdc ;};if _bdbg ._accdf !=nil {_fgdc ._accdf =_bdbg ._accdf ;};if _bdbg ._ecc !=nil {_fgdc ._ecc =_bdbg ._ecc ;};if _bdbg ._dcafb !=nil {_fgdc ._dcafb =_bdbg ._dcafb ;};if _bdbg ._ggeg !=nil {_fgdc ._ggeg =_bdbg ._ggeg ;
};if _bdbg ._dcdg !=nil {_fgdc ._dcdg =_bdbg ._dcdg ;};if _bdbg ._acd !=nil {_fgdc ._acd =_bdbg ._acd ;};if _bdbg ._fbd !=nil {_fgdc ._fbd =_bdbg ._fbd ;};if _bdbg ._bcce !=nil {_fgdc ._bcce =_bdbg ._bcce ;};return &_fgdc ;};const _dg =0.64;type line struct{_gfff float64 ;
_debg []*symbol ;_adba float64 ;};type anchor struct{_egdb _d .Image ;_abda *_bg .ChartSpace ;_cfbd int ;_fbdf int64 ;_efb int ;_gab int64 ;_fcde int ;_fcce int64 ;_cdbf int ;_dcb int64 ;};func (_dfg *convertContext )getContentFromCell (_bdbf *_ad .Sheet ,_bafg _ad .Cell ,_beeg *style ,_dcgc float64 ,_fbe ,_ccf bool )([]*line ,_df .ST_CellType ){if _ccf {return []*line {},_df .ST_CellTypeS ;
};_eef :=_bafg .X ();var _dbg []*symbol ;switch _eef .TAttr {case _df .ST_CellTypeS :_cgac :=_eef .V ;if _cgac !=nil {_dfff ,_dda :=_b .Atoi (*_cgac );if _dda ==nil {_cfc :=_dfg ._gcaee .SharedStrings .X ().Si [_dfff ];if _cfc .T !=nil {_dbg =_dfg .getSymbolsFromString (*_cfc .T ,_beeg );
}else if _cfc .R !=nil {_dbg =_dfg .getSymbolsFromR (_cfc .R ,_beeg );};};};case _df .ST_CellTypeB :_gfe :=_eef .V ;if _gfe !=nil {if *_gfe =="\u0030"{_dbg =_dfg .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_beeg );}else {_dbg =_dfg .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_beeg );
};};case _df .ST_CellTypeStr :if _eef .F !=nil {_cdac :=_ed .NewEvaluator ();_aadd :=_bdbf .FormulaContext ().Cell (_bafg .Reference (),_cdac );_dbg =_dfg .getSymbolsFromString (_aadd .Value (),_beeg );};default:_dbg =_dfg .getSymbolsFromString (_bafg .GetFormattedValue (),_beeg );
};_fdd :=0.0;_cgd :=0.0;var _cbcg []*line ;var _fdbf bool ;if _beeg !=nil {if _beeg ._fbd !=nil {if *_beeg ._fbd {_fdbf =true ;};};if _beeg ._bcce !=nil {if *_beeg ._bcce {_fdbf =true ;};};};if _fbe {_cbcg =[]*line {};_dffa :=_dcgc -2*_bb ;_ggff :=[]*symbol {};
for _ ,_cdag :=range _dbg {_cagc (_cdag );if _fdd +_cdag ._cegc >=_dffa {_ecb :=_bbf (_ggff );if _fdbf {_ecb /=_dg ;};_cbcg =append (_cbcg ,&line {_gfff :_cgd ,_debg :_ggff ,_adba :_ecb });_ggff =[]*symbol {_cdag };_fdd =_cdag ._cegc ;_cgd +=_ecb ;}else {_cdag ._ddbf =_fdd ;
_fdd +=_cdag ._cegc ;_ggff =append (_ggff ,_cdag );};};_dba :=_bbf (_ggff );if _fdbf {_dba /=_dg ;};if len (_ggff )> 0{_cbcg =append (_cbcg ,&line {_gfff :_cgd ,_debg :_ggff ,_adba :_dba });};}else {for _ ,_cbfa :=range _dbg {_cagc (_cbfa );_cbfa ._ddbf =_fdd ;
_fdd +=_cbfa ._cegc ;};if len (_dbg )> 0{_cbcg =[]*line {&line {_debg :_dbg ,_adba :_bbf (_dbg )}};};};_cbe :=_eef .TAttr ;if _cbe ==_df .ST_CellTypeUnset {_cbe =_df .ST_CellTypeN ;};return _cbcg ,_cbe ;};func (_aae *convertContext )makePages (){for _ ,_gdc :=range _aae ._gbb {for _ ,_ceg :=range _aae ._dggg {_gdc ._ddcd =append (_gdc ._ddcd ,&page {_gcag :[]*pageRow {},_ecgb :_gdc ,_fbee :_ceg });
};};};type rowInfo struct{_cece float64 ;_gdce bool ;_gdbg float64 ;_bfge *style ;_fedc []*cell ;_gbfe float64 ;};func _bbf (_gcdc []*symbol )float64 {_bff :=0.0;for _ ,_bbb :=range _gcdc {if _bbb ._dfcg > _bff {_bff =_bbb ._dfcg ;};};return _bff ;};const _gca =15.0;
const _ff =2;func (_acg *convertContext )getColorStringFromSmlColor (_affg *_df .CT_Color )*string {var _abdf string ;if _affg .RgbAttr !=nil {_abdf =*_affg .RgbAttr ;}else if _affg .IndexedAttr !=nil &&*_affg .IndexedAttr < 64{_abdf =_gce [*_affg .IndexedAttr ];
}else if _affg .ThemeAttr !=nil {_gbed :=*_affg .ThemeAttr ;_abdf =_acg .getColorFromTheme (_gbed );};if _abdf ==""{return nil ;};if len (_abdf )> 6{_abdf =_abdf [(len (_abdf )-6):];};if _affg .TintAttr !=nil {_edbb :=*_affg .TintAttr ;_abdf =_cd .AdjustColorByTint (_abdf ,_edbb );
};_abdf ="\u0023"+_abdf ;return &_abdf ;};func _fegf (_bfce float64 )float64 {return _bfce *_dcf .Millimeter };

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _cd .RegisterFontsFromDirectory (dirName )};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_cd .FontStyle ;func (_aaeea *convertContext )getStyle (_baba *uint32 )*style {_bgee :=&style {};_cde :=false ;if _baba !=nil {_bcbf :=_aaeea ._dbaa .GetCellStyle (*_baba );if _aaeea ._dbaa .GetNumberFormat (_bcbf .NumberFormat ()).GetFormat ()=="\u003b\u003b\u003b"{_bgee ._ffec =true ;
};_dfda :=_bcbf .GetFill ();if _dfda !=nil &&_dfda .FillChoice !=nil &&_dfda .FillChoice .PatternFill !=nil {if _dfda .FillChoice .PatternFill .FgColor !=nil {_bgee ._fgd =_aaeea .getColorStringFromSmlColor (_dfda .FillChoice .PatternFill .FgColor );}else if _dfda .FillChoice .PatternFill .BgColor !=nil {_bgee ._fgd =_aaeea .getColorStringFromSmlColor (_dfda .FillChoice .PatternFill .BgColor );
};};_fbbb :=_bcbf .GetFont ();for _ ,_aag :=range _fbbb .FontChoice {if _aag .Name !=nil {_bgee ._dcafb =&_aag .Name .ValAttr ;_cde =true ;}else if _aag .B !=nil {_ccdgb :=_aag .B .ValAttr ==nil ||*_aag .B .ValAttr ;_bgee ._ggeg =&_ccdgb ;_cde =true ;}else if _aag .I !=nil {_beec :=_aag .I .ValAttr ==nil ||*_aag .I .ValAttr ;
_bgee ._dcdg =&_beec ;_cde =true ;}else if _aag .U !=nil {_gaea :=_aag .U .ValAttr ==_df .ST_UnderlineValuesSingle ||_aag .U .ValAttr ==_df .ST_UnderlineValuesUnset ;_bgee ._acd =&_gaea ;_cde =true ;}else if _aag .Sz !=nil {_dabc :=_aag .Sz .ValAttr ;_bgee ._ecc =&_dabc ;
_cde =true ;}else if _aag .VertAlign !=nil {_dfdaf :=_aag .VertAlign .ValAttr ==_f .ST_VerticalAlignRunSuperscript ;_bgee ._fbd =&_dfdaf ;_bfca :=_aag .VertAlign .ValAttr ==_f .ST_VerticalAlignRunSubscript ;_bgee ._bcce =&_bfca ;_cde =true ;}else if _aag .Color !=nil {_bgee ._accdf =_aaeea .getColorStringFromSmlColor (_aag .Color );
_cde =true ;};};_bfcg :=_bcbf .GetBorder ();if _bfcg .Top !=nil {_bgee ._fffbb =_aaeea .getBorder (_bfcg .Top );_cde =true ;};if _bfcg .Bottom !=nil {_bgee ._ggfa =_aaeea .getBorder (_bfcg .Bottom );_cde =true ;};if _bfcg .Left !=nil {_bgee ._baff =_aaeea .getBorder (_bfcg .Left );
_cde =true ;};if _bfcg .Right !=nil {_bgee ._fbad =_aaeea .getBorder (_bfcg .Right );_cde =true ;};if _bcbf .Wrapped (){_bgee ._gcad =true ;_cde =true ;};if _baea :=_bcbf .GetVerticalAlignment ();_baea !=_df .ST_VerticalAlignmentUnset {_bgee ._daefa =_baea ;
_cde =true ;};if _egddg :=_bcbf .GetHorizontalAlignment ();_egddg !=_df .ST_HorizontalAlignmentUnset {_bgee ._fgec =_egddg ;_cde =true ;};};if _cde {return _bgee ;};return nil ;};func (_ggae *convertContext )getDxfStyle (_edfd *uint32 )*style {_dffc :=&style {};
_fbff :=false ;if _edfd !=nil {var _cfbb *_df .CT_Dxf ;for _ggab ,_fdfg :=range _ggae ._dbaa .X ().Dxfs .Dxf {if uint32 (_ggab )==*_edfd {_cfbb =_fdfg ;};};if _cfbb ==nil {return nil ;};if _cfbb .Fill !=nil &&_cfbb .Fill .FillChoice !=nil &&_cfbb .Fill .FillChoice .PatternFill !=nil {if _cfbb .Fill .FillChoice .PatternFill .FgColor !=nil {_dffc ._fgd =_ggae .getColorStringFromSmlColor (_cfbb .Fill .FillChoice .PatternFill .FgColor );
}else if _cfbb .Fill .FillChoice .PatternFill .BgColor !=nil {_dffc ._fgd =_ggae .getColorStringFromSmlColor (_cfbb .Fill .FillChoice .PatternFill .BgColor );};};_bagb :=_cfbb .Font ;for _ ,_caea :=range _bagb .FontChoice {if _caea .Name !=nil {_dffc ._dcafb =&_caea .Name .ValAttr ;
_fbff =true ;}else if _caea .B !=nil {_geg :=_caea .B .ValAttr ==nil ||*_caea .B .ValAttr ;_dffc ._ggeg =&_geg ;_fbff =true ;}else if _caea .I !=nil {_cdg :=_caea .I .ValAttr ==nil ||*_caea .I .ValAttr ;_dffc ._dcdg =&_cdg ;_fbff =true ;}else if _caea .U !=nil {_faa :=_caea .U .ValAttr ==_df .ST_UnderlineValuesSingle ||_caea .U .ValAttr ==_df .ST_UnderlineValuesUnset ;
_dffc ._acd =&_faa ;_fbff =true ;}else if _caea .Sz !=nil {_cfd :=_caea .Sz .ValAttr ;_dffc ._ecc =&_cfd ;_fbff =true ;}else if _caea .VertAlign !=nil {_ddfb :=_caea .VertAlign .ValAttr ==_f .ST_VerticalAlignRunSuperscript ;_dffc ._fbd =&_ddfb ;_dbga :=_caea .VertAlign .ValAttr ==_f .ST_VerticalAlignRunSubscript ;
_dffc ._bcce =&_dbga ;_fbff =true ;}else if _caea .Color !=nil {_dffc ._accdf =_ggae .getColorStringFromSmlColor (_caea .Color );_fbff =true ;};};_gfffd :=_cfbb .Border ;if _gfffd !=nil {if _gfffd .Top !=nil {_dffc ._fffbb =_ggae .getBorder (_gfffd .Top );
_fbff =true ;};if _gfffd .Bottom !=nil {_dffc ._ggfa =_ggae .getBorder (_gfffd .Bottom );_fbff =true ;};if _gfffd .Left !=nil {_dffc ._baff =_ggae .getBorder (_gfffd .Left );_fbff =true ;};if _gfffd .Right !=nil {_dffc ._fbad =_ggae .getBorder (_gfffd .Right );
_fbff =true ;};};if _cfbb .Alignment !=nil {if _fcceg :=_cfbb .Alignment .VerticalAttr ;_fcceg !=_df .ST_VerticalAlignmentUnset {_dffc ._daefa =_fcceg ;_fbff =true ;};if _gbd :=_cfbb .Alignment .HorizontalAttr ;_gbd !=_df .ST_HorizontalAlignmentUnset {_dffc ._fgec =_gbd ;
_fbff =true ;};};};if _fbff {return _dffc ;};return nil ;};type pagespan struct{_bbd float64 ;_ddcd []*page ;_cbfe int ;_aeba int ;};func _cagc (_fabf *symbol ){_adec :=_a .New ();_ggfd :=_adec .NewStyledParagraph ();_ggfd .SetMargins (0,0,0,0);_bfdf :=_ggfd .Append (_fabf ._fbeg );
if _fabf ._ceaf !=nil {_bfdf .Style =*_fabf ._ceaf ;};_fabf ._dfcg =_ggfd .Height ();if _fabf ._cegc ==0{_fabf ._cegc =_ggfd .Width ();};};func (_fcb *convertContext )drawPage (_cae *page ){_efa :=_fcb ._fec ;_gec :=_fcb ._bfc ;for _ ,_ddec :=range _cae ._gcag {_aegg :=_fcb ._fba [_ddec ._ggb ];
for _ ,_beea :=range _ddec ._deb {var _dbb float64 ;if _ddec ._ggb > 1{_dbb =_fcb ._fba [_ddec ._ggb -1]._gbfe ;};var _acea ,_eabg float64 ;if _dbbf :=_beea ._dgeg ;_dbbf !=nil {_acea =_dbbf ._cegb ;};if _eagc :=_beea ._aadf ;_eagc !=nil {_eabg =_eagc ._cegb ;
};_geee :=_efa +_aegg ._cece -0.5*(_dbb -_acea );_agfgg :=_efa +_aegg ._cece +_aegg ._gdbg +0.5*(_aegg ._gbfe +_eabg );_begc :=_gec +_beea ._geff ;_fga :=_begc +_beea ._aed ;if _beea ._ece !=nil &&_beea ._ece !=_a .ColorBlack {_cd .FillRectangle (_fcb ._gae ,_begc ,_geee ,_fga -_begc ,_agfgg -_geee ,_beea ._ece );
};};};for _ ,_befb :=range _cae ._gcag {_bcg :=_fcb ._fba [_befb ._ggb ];for _ ,_cace :=range _befb ._deb {_dgde :=_cace ._caddb < _cace ._geff ;_fgcc :=_cace ._dgcc > _cace ._geff +_cace ._feab ;var _gcf ,_efe bool ;for _ ,_dcad :=range _cace ._ggbc {for _ ,_beefc :=range _dcad ._debg {if _dgde &&!_gcf {_gcf =_beefc ._ddbf < 0;
};if _fgcc &&!_efe {_efe =_cace ._feab < _beefc ._ddbf +_beefc ._cegc ;};if _cace ._geff +_beefc ._ddbf >=_cace ._caddb &&_cace ._geff +_beefc ._ddbf +_beefc ._cegc <=_cace ._dgcc {_fge :=_fcb ._gae .NewStyledParagraph ();_ebg :=_gec +_cace ._geff +_beefc ._ddbf ;
_bfbe :=_efa +_bcg ._cece +_dcad ._gfff -_beefc ._dfcg -_fegf (0.5);_fge .SetPos (_ebg ,_bfbe );var _geab *_a .TextChunk ;if _beefc ._edb !=""{_geab =_fge .AddExternalLink (_beefc ._fbeg ,_beefc ._edb );}else {_geab =_fge .Append (_beefc ._fbeg );};if _beefc ._ceaf !=nil {_geab .Style =*_beefc ._ceaf ;
};_fcb ._gae .Draw (_fge );};};};var _dcfd ,_egdd ,_cdfa ,_eda ,_ceac ,_ebdf float64 ;var _fefc ,_begf ,_eca ,_dcee _a .Color ;if _bcf :=_cace ._dgeg ;_bcf !=nil {_dcfd =_bcf ._cegb ;_fefc =_bcf ._bfe ;};if _dbfaa :=_cace ._aadf ;_dbfaa !=nil {_egdd =_dbfaa ._cegb ;
_begf =_dbfaa ._bfe ;};if _dge :=_cace ._bgcd ;_dge !=nil {_cdfa =_dge ._cegb ;_ceac =_cdfa /2;_eca =_dge ._bfe ;};if _aeb :=_cace ._fcc ;_aeb !=nil {_eda =_aeb ._cegb ;_ebdf =_eda /2;_dcee =_aeb ._bfe ;};var _abde float64 ;if _befb ._ggb > 1{_abde =_fcb ._fba [_befb ._ggb -1]._gbfe ;
};_becd :=_efa +_bcg ._cece -0.5*(_abde -_dcfd );_efd :=_efa +_bcg ._cece +_bcg ._gdbg +0.5*(_bcg ._gbfe +_egdd );_gaa :=_gec +_cace ._geff ;_cgc :=_gaa +_cace ._aed ;_cd .DrawLine (_fcb ._gae ,_gaa ,_becd ,_cgc ,_becd ,_dcfd ,_fefc );_cd .DrawLine (_fcb ._gae ,_gaa ,_efd ,_cgc ,_efd ,_egdd ,_begf );
if !_gcf {_cd .DrawLine (_fcb ._gae ,_gaa -_ceac ,_becd ,_gaa -_ceac ,_efd ,_cdfa ,_eca );};if !_efe {_cd .DrawLine (_fcb ._gae ,_cgc -_ebdf ,_becd ,_cgc -_ebdf ,_efd ,_eda ,_dcee );};};};for _ ,_fea :=range _cae ._aab {if _fea !=nil {_fcb ._gae .Draw (_fea );
};};};type symbol struct{_fbeg string ;_ddbf float64 ;_dfcg float64 ;_cegc float64 ;_ceaf *_a .TextStyle ;_edb string ;};func (_gace *convertContext )addRowToPage (_bfgc []*cell ,_bgaf int ){_gcfc :=0.0;_dcaf :=_gace ._fdbg ;for _ ,_ade :=range _bfgc {if len (_ade ._ggbc )!=0{_ade ._caddb =_gcfc ;
_gcfc =_ade ._geff +_ade ._feab ;};};for _edfg :=len (_bfgc )-1;_edfg >=0;_edfg --{_cegf :=_bfgc [_edfg ];if len (_cegf ._ggbc )!=0{_cegf ._dgcc =_dcaf ;_dcaf =_cegf ._geff ;};};_gace ._cfa ._gcag =append (_gace ._cfa ._gcag ,&pageRow {_ggb :_bgaf ,_deb :_bfgc });
};type mergedCell struct{_egce uint32 ;_bgfe uint32 ;_dfe uint32 ;_bggb uint32 ;_bbdd float64 ;_fbda float64 ;};const _ac =0.0;func (_cfaa *convertContext )makeTextStyleFromCellStyle (_efad *style )*_a .TextStyle {_edbc :=_cfaa ._gae .NewTextStyle ();if _efad ==nil {_edbc .FontSize =_cd .DefaultFontSize ;
_edbc .Font =_cd .AssignStdFontByName (_edbc ,_cd .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_edbc ;};if _agdb (_efad ._acd ){_edbc .Underline =true ;_edbc .UnderlineStyle =_a .TextDecorationLineStyle {Offset :0.5,Thickness :_fegf (1/32)};
};var _aebbd FontStyle ;if _agdb (_efad ._ggeg )&&_agdb (_efad ._dcdg ){_aebbd =FontStyle_BoldItalic ;}else if _agdb (_efad ._ggeg ){_aebbd =FontStyle_Bold ;}else if _agdb (_efad ._dcdg ){_aebbd =FontStyle_Italic ;}else {_aebbd =FontStyle_Regular ;};_cgbb :="\u0064e\u0066\u0061\u0075\u006c\u0074";
if _efad ._dcafb !=nil {_cgbb =*_efad ._dcafb ;};if _ecde ,_gbeb :=_cd .StdFontsMap [_cgbb ];_gbeb {_edbc .Font =_cd .AssignStdFontByName (_edbc ,_ecde [_aebbd ]);}else if _caa :=_cd .GetRegisteredFont (_cgbb ,_aebbd );_caa !=nil {_edbc .Font =_caa ;}else {_gb .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_cgbb ,_aebbd );
_edbc .Font =_cd .AssignStdFontByName (_edbc ,_cd .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_aebbd ]);};if _efad ._ecc !=nil {_edbc .FontSize =_g .Round (*_efad ._ecc *_cfaa ._dbeb );};if _efad ._accdf !=nil {_edbc .Color =_a .ColorRGBFromHex (*_efad ._accdf );
};if _efad ._fbd !=nil &&*_efad ._fbd {_edbc .FontSize *=_dg ;}else if _efad ._bcce !=nil &&*_efad ._bcce {_edbc .FontSize *=_dg ;};return &_edbc ;};

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _cd .PageSize ;};var _bbc =_fegf (1);func (_afg *convertContext )makeRowspans (){var _deg float64 ;_gcae :=0;for _fbb ,_cgg :=range _afg ._fba {_feg :=_cgg ._gdbg +_cgg ._gbfe ;if _deg +_feg <=_afg ._daef {_cgg ._cece =_deg ;_deg +=_feg ;
}else {_afg ._dggg =append (_afg ._dggg ,&rowspan {_egf :_deg ,_ggfc :_gcae ,_dabf :_fbb });_gcae =_fbb ;_cgg ._cece =0;_deg =_feg ;};};_afg ._dggg =append (_afg ._dggg ,&rowspan {_egf :_deg ,_ggfc :_gcae ,_dabf :len (_afg ._fba )});};var _gce =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
func (_fb *convertContext )determineMaxIndexes (){var _ddg ,_ega int ;_ddg =int (_fb ._eebc .MaxColumnIdx ());_bc :=_fb ._eebc .Rows ();if len (_bc )> 0{_ega =int (_bc [len (_bc )-1].RowNumber ());};for _ ,_ccc :=range _fb ._dgce {if _ccc ._fcde >=_ega {_ega =_ccc ._fcde +1;
};if _ccc ._cdbf >=_ddg {_ddg =_ccc ._cdbf +1;};};_fb ._fddg =_ega ;_fb ._aebb =_ddg ;};func (_egc *convertContext )imageFromAnchor (_abb *anchor ,_ffab ,_fcg float64 )_d .Image {if _abb ._egdb !=nil {return _abb ._egdb ;};if _abb ._abda !=nil {_egee ,_ecga :=_cd .MakeImageFromChartSpace (_abb ._abda ,_ffab ,_fcg ,_egc ._ccdg ,_egc ._gcaee );
if _ecga !=nil {_gb .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_ecga );
return nil ;};return _egee ;};return nil ;};var _gbf =_fegf (0.0625);