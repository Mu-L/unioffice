//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_cg "github.com/unidoc/unioffice/common/logger";_gb "github.com/unidoc/unioffice/common/tempstorage";_d "github.com/unidoc/unioffice/internal/convertutils";_bfb "github.com/unidoc/unioffice/measurement";_cc "github.com/unidoc/unioffice/schema/soo/dml";
_ad "github.com/unidoc/unioffice/schema/soo/dml/chart";_e "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_ab "github.com/unidoc/unioffice/schema/soo/sml";_a "github.com/unidoc/unioffice/spreadsheet";_bf "github.com/unidoc/unioffice/spreadsheet/formula";
_gc "github.com/unidoc/unioffice/spreadsheet/reference";_b "github.com/unidoc/unipdf/v3/creator";_bb "github.com/unidoc/unipdf/v3/model";_f "image";_g "strconv";);type cell struct{_cbce _ab .ST_CellType ;_gbgf int ;_dfec float64 ;_cebf []*line ;_dfda float64 ;
_fee float64 ;_gac float64 ;_fbcb float64 ;_dbd float64 ;_afab *_b .TextStyle ;_afgf *border ;_cffa *border ;_cecg *border ;_abda *border ;_deb bool ;_aabg bool ;_ggbd _b .Color ;};func (_fed *convertContext )makeMergedCells (){_efa :=[]*mergedCell {};
for _ ,_eaf :=range _fed ._adb .MergedCells (){_fd ,_fbgb ,_ebc :=_gc .ParseRangeReference (_eaf .Reference ());if _ebc !=nil {_cg .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_ebc );
continue ;};_cgbg :=mergedCell {_gggg :_fd .RowIdx ,_dfef :_fd .ColumnIdx ,_dfea :_fbgb .RowIdx ,_cafe :_fbgb .ColumnIdx };for _geb :=_cgbg ._dfef -1;_geb < _cgbg ._cafe ;_geb ++{_cgbg ._fbga +=_fed ._dgbbb [_geb ]._cdfca ;};for _ceed :=_cgbg ._gggg -1;
_ceed < _cgbg ._dfea ;_ceed ++{_cgbg ._cbde +=_fed ._cae [_ceed ]._cgc ;};_efa =append (_efa ,&_cgbg );};_fed ._fafa =_efa ;};func (_gaa *convertContext )getContentFromCell (_eecd *_a .Sheet ,_cfbg _a .Cell ,_beae *style ,_fab float64 ,_bec bool )([]*line ,_ab .ST_CellType ){_edg :=_cfbg .X ();
var _afc []*symbol ;switch _edg .TAttr {case _ab .ST_CellTypeS :_ffgc :=_edg .V ;if _ffgc !=nil {_bbef ,_fagcc :=_g .Atoi (*_ffgc );if _fagcc ==nil {_ccde :=_gaa ._cbd .SharedStrings .X ().Si [_bbef ];if _ccde .T !=nil {_afc =_gaa .getSymbolsFromString (*_ccde .T ,_beae );
}else if _ccde .R !=nil {_afc =_gaa .getSymbolsFromR (_ccde .R ,_beae );};};};case _ab .ST_CellTypeB :_bacd :=_edg .V ;if _bacd !=nil {if *_bacd =="\u0030"{_afc =_gaa .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_beae );}else {_afc =_gaa .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_beae );
};};case _ab .ST_CellTypeStr :if _edg .F !=nil {_dafa :=_bf .NewEvaluator ();_gde :=_eecd .FormulaContext ().Cell (_cfbg .Reference (),_dafa );_afc =_gaa .getSymbolsFromString (_gde .Value (),_beae );};default:_afc =_gaa .getSymbolsFromString (_cfbg .GetFormattedValue (),_beae );
};_cabg :=0.0;_cbfd :=0.0;var _cfbcd []*line ;var _caff bool ;if _beae !=nil {if _beae ._fbf !=nil {if *_beae ._fbf {_caff =true ;};};if _beae ._ecf !=nil {if *_beae ._ecf {_caff =true ;};};};if _bec {_cfbcd =[]*line {};_bcg :=_fab -2*_dc ;_cabc :=[]*symbol {};
for _ ,_cad :=range _afc {_dafc (_cad );if _cabg +_cad ._cefa >=_bcg {_eece :=_ebff (_cabc );if _caff {_eece /=_bd ;};_cfbcd =append (_cfbcd ,&line {_cadc :_cbfd ,_eaba :_cabc ,_decc :_eece });_cabc =[]*symbol {_cad };_cabg =_cad ._cefa ;_cbfd +=_eece ;
}else {_cad ._cgd =_cabg ;_cabg +=_cad ._cefa ;_cabc =append (_cabc ,_cad );};};_daca :=_ebff (_cabc );if _caff {_daca /=_bd ;};if len (_cabc )> 0{_cfbcd =append (_cfbcd ,&line {_cadc :_cbfd ,_eaba :_cabc ,_decc :_daca });};}else {for _ ,_faeg :=range _afc {_dafc (_faeg );
_faeg ._cgd =_cabg ;_cabg +=_faeg ._cefa ;};if len (_afc )> 0{_cfbcd =[]*line {&line {_eaba :_afc ,_decc :_ebff (_afc )}};};};_dafd :=_edg .TAttr ;if _dafd ==_ab .ST_CellTypeUnset {_dafd =_ab .ST_CellTypeN ;};return _cfbcd ,_dafd ;};func (_beg *convertContext )alignSymbolsVertically (_dcge *cell ,_agf _ab .ST_VerticalAlignment ){var _agbd float64 ;
switch _agf {case _ab .ST_VerticalAlignmentTop :_agbd =_ag ;if _dcge ._deb {_agbd -=_dd ;}else if _dcge ._aabg {_agbd +=4*_dd ;};for _ ,_aae :=range _dcge ._cebf {_agbd +=_aae ._decc ;_aae ._cadc =_agbd ;_agbd +=_eg ;};case _ab .ST_VerticalAlignmentCenter :_eef :=0.0;
for _ ,_bfg :=range _dcge ._cebf {_eef +=_bfg ._decc +_ccbg (1);};_agbd =0.5*(_dcge ._gac -_eef );if _dcge ._deb {_agbd -=2*_dd ;}else if _dcge ._aabg {_agbd +=2*_dd ;};for _ ,_efcb :=range _dcge ._cebf {_agbd +=_efcb ._decc +0.5*_eg ;_efcb ._cadc =_agbd ;
_agbd +=0.5*_eg ;};default:_agbd =_dcge ._gac -_ag ;if _dcge ._deb {_agbd -=4*_dd ;}else if _dcge ._aabg {_agbd +=_dd ;};for _bfbd :=len (_dcge ._cebf )-1;_bfbd >=0;_bfbd --{_dcge ._cebf [_bfbd ]._cadc =_agbd ;_agbd -=_dcge ._cebf [_bfbd ]._decc ;_agbd -=_eg ;
};};};type line struct{_cadc float64 ;_eaba []*symbol ;_decc float64 ;};var _eg =_ccbg (1);type page struct{_eafc []*pageRow ;_edf bool ;_bfc []*_b .Image ;_ggdc *pagespan ;_gca *rowspan ;};func (_cabgf *convertContext )combineCellStyleWithRPrElt (_fbba *style ,_edca *_ab .CT_RPrElt )*style {_caee :=*_fbba ;
_fbge :=_cabgf .getStyleFromRPrElt (_edca );if _fbge ==nil {return &_caee ;};if _fbge ._fcff !=nil {_caee ._fcff =_fbge ._fcff ;};if _fbge ._eda !=nil {_caee ._eda =_fbge ._eda ;};if _fbge ._gdfd !=nil {_caee ._gdfd =_fbge ._gdfd ;};if _fbge ._cfba !=nil {_caee ._cfba =_fbge ._cfba ;
};if _fbge ._dcgf !=nil {_caee ._dcgf =_fbge ._dcgf ;};if _fbge ._fgfe !=nil {_caee ._fgfe =_fbge ._fgfe ;};if _fbge ._fbf !=nil {_caee ._fbf =_fbge ._fbf ;};if _fbge ._ecf !=nil {_caee ._ecf =_fbge ._ecf ;};return &_caee ;};const _bfd =64.0;func _ccbg (_bgfa float64 )float64 {return _bgfa *_bfb .Millimeter };
func (_ffaf *convertContext )getStyleFromCell (_dbg _a .Cell ,_baeb ,_gcaa *style )*style {_fgde :=_dbg .X ();_ffbc :=_ffaf .getStyle (_fgde .SAttr );_ade (_ffbc ,_baeb );_ade (_ffbc ,_gcaa );return _ffbc ;};var _bcb =map[uint32 ]_b .PageSize {1:_b .PageSize {8.5*_bfb .Inch ,11*_bfb .Inch },2:_b .PageSize {8.5*_bfb .Inch ,11*_bfb .Inch },3:_b .PageSize {11*_bfb .Inch ,17*_bfb .Inch },4:_b .PageSize {17*_bfb .Inch ,11*_bfb .Inch },5:_b .PageSize {8.5*_bfb .Inch ,14*_bfb .Inch },6:_b .PageSize {5.5*_bfb .Inch ,8.5*_bfb .Inch },7:_b .PageSize {7.5*_bfb .Inch ,10*_bfb .Inch },8:_b .PageSize {_ccbg (297),_ccbg (420)},9:_b .PageSize {_ccbg (210),_ccbg (297)},10:_b .PageSize {_ccbg (210),_ccbg (297)},11:_b .PageSize {_ccbg (148),_ccbg (210)},70:_b .PageSize {_ccbg (105),_ccbg (148)},12:_b .PageSize {_ccbg (250),_ccbg (354)},13:_b .PageSize {_ccbg (182),_ccbg (257)},14:_b .PageSize {8.5*_bfb .Inch ,13*_bfb .Inch },20:_b .PageSize {4.125*_bfb .Inch ,9.5*_bfb .Inch },27:_b .PageSize {_ccbg (110),_ccbg (220)},28:_b .PageSize {_ccbg (162),_ccbg (229)},34:_b .PageSize {_ccbg (250),_ccbg (176)},29:_b .PageSize {_ccbg (324),_ccbg (458)},30:_b .PageSize {_ccbg (229),_ccbg (324)},31:_b .PageSize {_ccbg (114),_ccbg (162)},37:_b .PageSize {3.88*_bfb .Inch ,7.5*_bfb .Inch },43:_b .PageSize {_ccbg (100),_ccbg (148)},69:_b .PageSize {_ccbg (200),_ccbg (148)}};
const _ag =2;const _bd =0.64;func (_fgfg *convertContext )imageFromAnchor (_fbgd *anchor ,_daa ,_fca float64 )_f .Image {if _fbgd ._cdfcc !=nil {return _fbgd ._cdfcc ;};if _fbgd ._gggb !=nil {_cdfb ,_fagff :=_d .MakeImageFromChartSpace (_fbgd ._gggb ,_daa ,_fca ,_fgfg ._bbbf ,_fgfg ._cbd );
if _fagff !=nil {_cg .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_fagff );
return nil ;};return _cdfb ;};return nil ;};type rowInfo struct{_bfda float64 ;_adace bool ;_cgc float64 ;_bdad *style ;_fbc []*cell ;_bdf float64 ;};func (_dagb *convertContext )getSymbolsFromString (_deag string ,_aef *style )[]*symbol {_eab :=[]*symbol {};
_facf :=_dagb .makeTextStyleFromCellStyle (_aef );for _ ,_fcdf :=range _deag {_eab =append (_eab ,&symbol {_fdfe :string (_fcdf ),_edgc :_facf });};return _eab ;};type pagespan struct{_aaa float64 ;_adac []*page ;_dafad int ;_cdg int ;};func (_gbce *convertContext )makeRows (){_bab :=[]*rowInfo {};
_aea :=_gbce ._adb .Rows ();_efd :=0;_bfdf :=0.0;for _bae ,_fac :=range _aea {if _bae < _gbce ._defb ||(_bae > _gbce ._gef &&_gbce ._gef > 0){continue ;};_efd ++;_ffd :=int (_fac .RowNumber ());if _ffd > _efd {for _gcg :=_efd ;_gcg < _ffd ;_gcg ++{_bab =append (_bab ,&rowInfo {_cgc :_cd /_cf });
_bfdf +=_cd /_cf ;};_efd =_ffd ;};var _gfc float64 ;if _fac .X ().HtAttr ==nil {_gfc =_cd ;}else {_gfc =*_fac .X ().HtAttr ;};_bab =append (_bab ,&rowInfo {_cgc :_gfc /_cf ,_adace :true ,_bdad :_gbce .getStyle (_fac .X ().SAttr )});_bfdf +=_gfc /_cf ;};
for _gcd :=len (_bab );_gcd < _gbce ._fcb ;_gcd ++{_bab =append (_bab ,&rowInfo {_cgc :_cd /_cf });_bfdf +=_cd /_cf ;};if _gbce ._eccc ||_bfdf > _gbce ._cef {for _ ,_cgf :=range _bab {_cgf ._cgc *=_gbce ._ffc ;};};_gbce ._cae =_bab ;};func (_aff *convertContext )makePages (){for _ ,_aagc :=range _aff ._ccge {for _ ,_ddc :=range _aff ._cdfc {_aagc ._adac =append (_aagc ._adac ,&page {_eafc :[]*pageRow {},_ggdc :_aagc ,_gca :_ddc });
};};};const _ef =0.0;

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_d .FontStyle ;func (_agc *convertContext )drawPage (_cgfb *page ){_gga :=_agc ._gcb ;_ccda :=_agc ._dfd ;for _ ,_gba :=range _cgfb ._eafc {_bef :=_agc ._cae [_gba ._cbc ];for _ ,_fagc :=range _gba ._bebc {var _fdaa float64 ;if _gba ._cbc > 1{_fdaa =_agc ._cae [_gba ._cbc -1]._bdf ;
};var _abg ,_fcf float64 ;if _faeb :=_fagc ._afgf ;_faeb !=nil {_abg =_faeb ._efcd ;};if _bcc :=_fagc ._cffa ;_bcc !=nil {_fcf =_bcc ._efcd ;};_fbgc :=_gga +_bef ._bfda -0.5*(_fdaa -_abg );_cggc :=_gga +_bef ._bfda +_bef ._cgc +0.5*(_bef ._bdf +_fcf );
_eae :=_ccda +_fagc ._dfec ;_fagf :=_eae +_fagc ._fee ;if _fagc ._ggbd !=nil &&_fagc ._ggbd !=_b .ColorBlack {_d .FillRectangle (_agc ._dga ,_eae ,_fbgc ,_fagf -_eae ,_cggc -_fbgc ,_fagc ._ggbd );};};};for _ ,_dfg :=range _cgfb ._eafc {_fffb :=_agc ._cae [_dfg ._cbc ];
for _ ,_dag :=range _dfg ._bebc {_efde :=_dag ._fbcb < _dag ._dfec ;_cbf :=_dag ._dbd > _dag ._dfec +_dag ._dfda ;var _cdfd ,_dacc bool ;for _ ,_ecb :=range _dag ._cebf {for _ ,_cbeg :=range _ecb ._eaba {if _efde &&!_cdfd {_cdfd =_cbeg ._cgd < 0;};if _cbf &&!_dacc {_dacc =_dag ._dfda < _cbeg ._cgd +_cbeg ._cefa ;
};if _dag ._dfec +_cbeg ._cgd >=_dag ._fbcb &&_dag ._dfec +_cbeg ._cgd +_cbeg ._cefa <=_dag ._dbd {_fdg :=_agc ._dga .NewStyledParagraph ();_bga :=_ccda +_dag ._dfec +_cbeg ._cgd ;_ggg :=_gga +_fffb ._bfda +_ecb ._cadc -_cbeg ._cddf -_ccbg (0.5);_fdg .SetPos (_bga ,_ggg );
var _ecbc *_b .TextChunk ;if _cbeg ._dfac !=""{_ecbc =_fdg .AddExternalLink (_cbeg ._fdfe ,_cbeg ._dfac );}else {_ecbc =_fdg .Append (_cbeg ._fdfe );};if _cbeg ._edgc !=nil {_ecbc .Style =*_cbeg ._edgc ;};_agc ._dga .Draw (_fdg );};};};var _dafe ,_ace ,_dcde ,_dagg ,_fgc ,_efb float64 ;
var _egb ,_cdd ,_dgbb ,_bde _b .Color ;if _gcde :=_dag ._afgf ;_gcde !=nil {_dafe =_gcde ._efcd ;_egb =_gcde ._fcbd ;};if _ffe :=_dag ._cffa ;_ffe !=nil {_ace =_ffe ._efcd ;_cdd =_ffe ._fcbd ;};if _abdc :=_dag ._cecg ;_abdc !=nil {_dcde =_abdc ._efcd ;
_fgc =_dcde /2;_dgbb =_abdc ._fcbd ;};if _eeb :=_dag ._abda ;_eeb !=nil {_dagg =_eeb ._efcd ;_efb =_dagg /2;_bde =_eeb ._fcbd ;};var _gaeb float64 ;if _dfg ._cbc > 1{_gaeb =_agc ._cae [_dfg ._cbc -1]._bdf ;};_adfa :=_gga +_fffb ._bfda -0.5*(_gaeb -_dafe );
_fef :=_gga +_fffb ._bfda +_fffb ._cgc +0.5*(_fffb ._bdf +_ace );_eegb :=_ccda +_dag ._dfec ;_fgeg :=_eegb +_dag ._fee ;_d .DrawLine (_agc ._dga ,_eegb ,_adfa ,_fgeg ,_adfa ,_dafe ,_egb );_d .DrawLine (_agc ._dga ,_eegb ,_fef ,_fgeg ,_fef ,_ace ,_cdd );
if !_cdfd {_d .DrawLine (_agc ._dga ,_eegb -_fgc ,_adfa ,_eegb -_fgc ,_fef ,_dcde ,_dgbb );};if !_dacc {_d .DrawLine (_agc ._dga ,_fgeg -_efb ,_adfa ,_fgeg -_efb ,_fef ,_dagg ,_bde );};};};for _ ,_gff :=range _cgfb ._bfc {if _gff !=nil {_agc ._dga .Draw (_gff );
};};};func (_ede *convertContext )makeTextStyleFromCellStyle (_aeb *style )*_b .TextStyle {_egag :=_ede ._dga .NewTextStyle ();if _aeb ==nil {_egag .FontSize =_d .DefaultFontSize ;_egag .Font =_d .AssignStdFontByName (_egag ,_d .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);
return &_egag ;};if _gadf (_aeb ._fgfe ){_egag .Underline =true ;_egag .UnderlineStyle =_b .TextDecorationLineStyle {Offset :0.5,Thickness :_ccbg (1/32)};};var _acgeb FontStyle ;if _gadf (_aeb ._cfba )&&_gadf (_aeb ._dcgf ){_acgeb =FontStyle_BoldItalic ;
}else if _gadf (_aeb ._cfba ){_acgeb =FontStyle_Bold ;}else if _gadf (_aeb ._dcgf ){_acgeb =FontStyle_Italic ;}else {_acgeb =FontStyle_Regular ;};_gegg :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _aeb ._gdfd !=nil {_gegg =*_aeb ._gdfd ;};if _cgdc ,_gabac :=_d .StdFontsMap [_gegg ];
_gabac {_egag .Font =_d .AssignStdFontByName (_egag ,_cgdc [_acgeb ]);}else if _egd :=_d .GetRegisteredFont (_gegg ,_acgeb );_egd !=nil {_egag .Font =_egd ;}else {_cg .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_gegg ,_acgeb );
_egag .Font =_d .AssignStdFontByName (_egag ,_d .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_acgeb ]);};if _aeb ._eda !=nil {_egag .FontSize =*_aeb ._eda ;};if _aeb ._fcff !=nil {_egag .Color =_b .ColorRGBFromHex (*_aeb ._fcff );};if _aeb ._fbf !=nil &&*_aeb ._fbf {_egag .FontSize *=_bd ;
}else if _aeb ._ecf !=nil &&*_aeb ._ecf {_egag .FontSize *=_bd ;};return &_egag ;};type convertContext struct{_dga *_b .Creator ;_cbd *_a .Workbook ;_bbbf *_cc .Theme ;_adb *_a .Sheet ;_eeda *_a .StyleSheet ;_fcb int ;_aga int ;_ccge []*pagespan ;_cgba *page ;
_dgbbb []*colInfo ;_cae []*rowInfo ;_cdfc []*rowspan ;_gcb float64 ;_dfd float64 ;_cef float64 ;_acb float64 ;_fafa []*mergedCell ;_fffd []*anchor ;_ffc float64 ;_ffgf int ;_afcf int ;_defb int ;_gef int ;_eccc bool ;};const _dc =3;func _aca (_befd []*symbol )float64 {_gaba :=0.0;
for _ ,_bed :=range _befd {_gaba +=_bed ._cefa ;};return _gaba ;};func (_cdea *convertContext )getStyle (_cfe *uint32 )*style {_fafg :=&style {};_adab :=false ;if _cfe !=nil {_cgga :=_cdea ._eeda .GetCellStyle (*_cfe );if _cgga .GetFill ()!=nil &&_cgga .GetFill ().PatternFill !=nil &&_cgga .GetFill ().PatternFill .FgColor !=nil {_fafg ._bege =_cdea .getColorStringFromSmlColor (_cgga .GetFill ().PatternFill .FgColor );
};_fba :=_cgga .GetFont ();for _ ,_gedg :=range _fba .Name {if _gedg !=nil {_fafg ._gdfd =&_gedg .ValAttr ;_adab =true ;break ;};};for _ ,_bgg :=range _fba .B {if _bgg !=nil {_dafaf :=_bgg .ValAttr ==nil ||*_bgg .ValAttr ;_fafg ._cfba =&_dafaf ;_adab =true ;
break ;};};for _ ,_cge :=range _fba .I {if _cge !=nil {_acf :=_cge .ValAttr ==nil ||*_cge .ValAttr ;_fafg ._dcgf =&_acf ;_adab =true ;break ;};};for _ ,_ecae :=range _fba .U {if _ecae !=nil {_egbf :=_ecae .ValAttr ==_ab .ST_UnderlineValuesSingle ||_ecae .ValAttr ==_ab .ST_UnderlineValuesUnset ;
_fafg ._fgfe =&_egbf ;_adab =true ;break ;};};for _ ,_cgad :=range _fba .Sz {if _cgad !=nil {_aee :=_cgad .ValAttr ;_fafg ._eda =&_aee ;_adab =true ;break ;};};for _ ,_gage :=range _fba .VertAlign {if _gage !=nil {_fffbg :=_gage .ValAttr ==_e .ST_VerticalAlignRunSuperscript ;
_fafg ._fbf =&_fffbg ;_fagd :=_gage .ValAttr ==_e .ST_VerticalAlignRunSubscript ;_fafg ._ecf =&_fagd ;_adab =true ;break ;};};for _ ,_gcbg :=range _fba .Color {if _gcbg !=nil {_fafg ._fcff =_cdea .getColorStringFromSmlColor (_gcbg );_adab =true ;break ;
};};_aebc :=_cgga .GetBorder ();if _aebc .Top !=nil {_fafg ._ggb =_cdea .getBorder (_aebc .Top );_adab =true ;};if _aebc .Bottom !=nil {_fafg ._ebce =_cdea .getBorder (_aebc .Bottom );_adab =true ;};if _aebc .Left !=nil {_fafg ._fcaf =_cdea .getBorder (_aebc .Left );
_adab =true ;};if _aebc .Right !=nil {_fafg ._edde =_cdea .getBorder (_aebc .Right );_adab =true ;};if _cgga .Wrapped (){_fafg ._cdee =true ;_adab =true ;};if _bcf :=_cgga .GetVerticalAlignment ();_bcf !=_ab .ST_VerticalAlignmentUnset {_fafg ._cfa =_bcf ;
_adab =true ;};if _bfgb :=_cgga .GetHorizontalAlignment ();_bfgb !=_ab .ST_HorizontalAlignmentUnset {_fafg ._fagb =_bfgb ;_adab =true ;};};if _adab {return _fafg ;};return nil ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _d .RegisterFontsFromDirectory (dirName )};func (_gdc *convertContext )makeAnchors (){_ebd ,_ca :=_gdc ._adb .GetDrawing ();if _ebd !=nil {for _ ,_ccg :=range _ebd .EG_Anchor {_ddf :=&anchor {};
if _dfc :=_ccg .TwoCellAnchor ;_dfc !=nil {_ae ,_gbd :=_dfc .From ,_dfc .To ;if _ae ==nil ||_gbd ==nil {return ;};_ddf ._bfbb =int (_ae .Row );_ddf ._ecg =_d .FromSTCoordinate (_ae .RowOff );_ddf ._dcbb =int (_ae .Col );_ddf ._eeec =_d .FromSTCoordinate (_ae .ColOff );
_ddf ._eca =int (_gbd .Row );_ddf ._bdb =_d .FromSTCoordinate (_gbd .RowOff );_ddf ._ggdcb =int (_gbd .Col );_ddf ._bdab =_d .FromSTCoordinate (_gbd .ColOff );if _dfe :=_dfc .Choice ;_dfe !=nil {if _ce :=_dfe .Pic ;_ce !=nil {if _adf :=_ce .BlipFill ;_adf !=nil {if _dcb :=_adf .Blip ;
_dcb !=nil {if _ccgd :=_dcb .EmbedAttr ;_ccgd !=nil {for _ ,_fe :=range _ca .X ().Relationship {if _fe .IdAttr ==*_ccgd {for _ ,_fbg :=range _gdc ._cbd .Images {if _fbg .Target ()==_fe .TargetAttr {_gf ,_fge :=_gb .Open (_fbg .Path ());if _fge !=nil {_cg .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_fge );
continue ;};_gfd ,_ ,_fge :=_f .Decode (_gf );if _fge !=nil {_cg .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_fge );continue ;};_ddf ._cdfcc =_gfd ;};};};};};};};}else if _fbb :=_dfe .GraphicFrame ;
_fbb !=nil {if _fbd :=_fbb .Graphic ;_fbd !=nil {if _ee :=_fbd .GraphicData ;_ee !=nil {for _ ,_acd :=range _ee .Any {if _ge ,_ba :=_acd .(*_ad .Chart );_ba {for _ ,_de :=range _ca .X ().Relationship {if _de .IdAttr ==_ge .IdAttr {_gbf :=_gdc ._cbd .GetChartByTargetId (_de .TargetAttr );
if _gbf !=nil {_ddf ._gggb =_gbf ;};};};};};};};};};};if _ddf ._cdfcc !=nil ||_ddf ._gggb !=nil {_gdc ._fffd =append (_gdc ._fffd ,_ddf );};};};};func (_egfg *convertContext )getImage (_gce _f .Image ,_bbee ,_deefe ,_gafg ,_dec ,_ecca ,_dgg float64 ,_ggac _d .ImgPart )*_b .Image {_dec +=_egfg ._gcb ;
_gafg +=_egfg ._dfd ;_baf ,_edcf :=_d .GetImage (_egfg ._dga ,_gce ,_bbee ,_deefe ,_gafg ,_dec ,_ecca ,_dgg ,_ggac );if _edcf !=nil {_cg .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_edcf );
return nil ;};return _baf ;};func (_fgb *convertContext )getStyleFromRPrElt (_ceg *_ab .CT_RPrElt )*style {if _ceg ==nil {return nil ;};_dbb :=&style {};_dbb ._gdfd =&_ceg .RFont .ValAttr ;if _acgeg :=_ceg .B ;_acgeg !=nil {_ebde :=_acgeg .ValAttr ==nil ||*_acgeg .ValAttr ;
_dbb ._cfba =&_ebde ;};if _ebcbb :=_ceg .I ;_ebcbb !=nil {_fcae :=_ebcbb .ValAttr ==nil ||*_ebcbb .ValAttr ;_dbb ._dcgf =&_fcae ;};if _acbb :=_ceg .U ;_acbb !=nil {_fea :=_acbb .ValAttr ==_ab .ST_UnderlineValuesSingle ||_acbb .ValAttr ==_ab .ST_UnderlineValuesUnset ;
_dbb ._fgfe =&_fea ;};if _eeed :=_ceg .VertAlign ;_eeed !=nil {_cgea :=_eeed .ValAttr ==_e .ST_VerticalAlignRunSuperscript ;_dbb ._fbf =&_cgea ;_cdfbe :=_eeed .ValAttr ==_e .ST_VerticalAlignRunSubscript ;_dbb ._ecf =&_cdfbe ;};if _fad :=_ceg .Sz ;_fad !=nil {_gfce :=_fad .ValAttr ;
_dbb ._eda =&_gfce ;};if _bgfe :=_ceg .Color ;_bgfe !=nil {_dbb ._fcff =_fgb .getColorStringFromSmlColor (_bgfe );};return _dbb ;};type border struct{_efcd float64 ;_fcbd _b .Color ;};func _ade (_ccbd ,_fcgd *style ){if _fcgd ==nil {return ;};if _ccbd ==nil {_ccbd =_fcgd ;
return ;};if _ccbd ._bege ==nil {_ccbd ._bege =_fcgd ._bege ;};if _ccbd ._gdfd ==nil {_ccbd ._gdfd =_fcgd ._gdfd ;};if _ccbd ._fcff ==nil {_ccbd ._fcff =_fcgd ._fcff ;};if _ccbd ._eda ==nil {_ccbd ._eda =_fcgd ._eda ;};if _ccbd ._cfba ==nil {_ccbd ._cfba =_fcgd ._cfba ;
};if _ccbd ._dcgf ==nil {_ccbd ._dcgf =_fcgd ._dcgf ;};if _ccbd ._fgfe ==nil {_ccbd ._fgfe =_fcgd ._fgfe ;};if _ccbd ._fbf ==nil {_ccbd ._fbf =_fcgd ._fbf ;};if _ccbd ._ecf ==nil {_ccbd ._ecf =_fcgd ._ecf ;};if _ccbd ._ggb ==nil {_ccbd ._ggb =_fcgd ._ggb ;
};if _ccbd ._ebce ==nil {_ccbd ._ebce =_fcgd ._ebce ;};if _ccbd ._fcaf ==nil {_ccbd ._fcaf =_fcgd ._fcaf ;};if _ccbd ._edde ==nil {_ccbd ._edde =_fcgd ._edde ;};if _ccbd ._cfa ==_ab .ST_VerticalAlignmentUnset {_ccbd ._cfa =_fcgd ._cfa ;};if _ccbd ._fagb ==_ab .ST_HorizontalAlignmentUnset {_ccbd ._fagb =_fcgd ._fagb ;
};};func (_bfa *convertContext )alignSymbolsHorizontally (_cedg *cell ,_eecc _ab .ST_HorizontalAlignment ){if _eecc ==_ab .ST_HorizontalAlignmentUnset {switch _cedg ._cbce {case _ab .ST_CellTypeB :_eecc =_ab .ST_HorizontalAlignmentCenter ;case _ab .ST_CellTypeN :_eecc =_ab .ST_HorizontalAlignmentRight ;
default:_eecc =_ab .ST_HorizontalAlignmentLeft ;};};var _abf float64 ;for _ ,_bgaa :=range _cedg ._cebf {switch _eecc {case _ab .ST_HorizontalAlignmentLeft :_abf =_dc ;case _ab .ST_HorizontalAlignmentRight :_dcag :=_aca (_bgaa ._eaba );_abf =_cedg ._dfda -_dc -_dcag ;
case _ab .ST_HorizontalAlignmentCenter :_ffff :=_aca (_bgaa ._eaba );_abf =(_cedg ._dfda -_ffff )/2;};for _ ,_def :=range _bgaa ._eaba {_def ._cgd +=_abf ;};};};type symbol struct{_fdfe string ;_cgd float64 ;_cddf float64 ;_cefa float64 ;_edgc *_b .TextStyle ;
_dfac string ;};func (_cag *convertContext )makePagespans (){_cag ._ccge =[]*pagespan {};_fcd :=0.0;_gbdd :=0;for _dfbe ,_deg :=range _cag ._dgbbb {_fag :=_deg ._cdfca ;if _fcd +_fag <=_cag ._acb {_deg ._ffb =_fcd ;_fcd +=_fag ;}else {_deg ._ffb =0;_cag ._ccge =append (_cag ._ccge ,&pagespan {_aaa :_fcd ,_dafad :_gbdd ,_cdg :_dfbe });
_fcd =_fag ;_gbdd =_dfbe ;};};_cag ._ccge =append (_cag ._ccge ,&pagespan {_aaa :_fcd ,_dafad :_gbdd ,_cdg :len (_cag ._dgbbb )});};var _egcg =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
const _dd =1.5;func (_bc *convertContext )drawSheet (_bad bool ){for _bgf ,_cde :=range _bc ._ccge {_ebcb :=len (_cde ._adac );if _bgf ==len (_bc ._ccge )-1{for _gbff :=len (_cde ._adac )-1;_gbff >=0;_gbff --{if !_cde ._adac [_gbff ]._edf {_ebcb =_gbff ;
};};};_dcda :=_cde ._adac [:_ebcb ];for _ ,_gdfbd :=range _dcda {_bc ._dga .NewPage ();if _bad {_bc ._dga .RotateDeg (270);};_bc .drawPage (_gdfbd );};};};func _dafc (_bbf *symbol ){_cfd :=_b .New ();_dgbf :=_cfd .NewStyledParagraph ();_dgbf .SetMargins (0,0,0,0);
_baa :=_dgbf .Append (_bbf ._fdfe );if _bbf ._edgc !=nil {_baa .Style =*_bbf ._edgc ;};_bbf ._cddf =_dgbf .Height ();if _bbf ._cefa ==0{_bbf ._cefa =_dgbf .Width ();};};func (_bg *convertContext )determineMaxIndexes (){var _dee ,_fc int ;_dee =int (_bg ._adb .MaxColumnIdx ());
_bbg :=_bg ._adb .Rows ();if len (_bbg )> 0{_fc =int (_bbg [len (_bbg )-1].RowNumber ());};for _ ,_gbc :=range _bg ._fffd {if _gbc ._eca >=_fc {_fc =_gbc ._eca +1;};if _gbc ._ggdcb >=_dee {_dee =_gbc ._ggdcb +1;};};_bg ._fcb =_fc ;_bg ._aga =_dee ;};func (_fec *convertContext )makeCols (){_fcg :=_fec ._adb ;
_cbg :=_fcg .X ();_gad :=[]*colInfo {};_ffg :=[]colWidthRange {};if _ege :=_cbg .Cols ;len (_ege )> 0{for _ ,_aag :=range _ege [0].Col {_ffa :=_bfd ;if _gbe :=_aag .WidthAttr ;_gbe !=nil {if *_gbe > 0.83{*_gbe -=0.83;};if *_gbe <=1{_ffa =*_gbe *11;}else {_ffa =5+*_gbe *6;
};};_ddd :=int (_aag .MinAttr -1);_dg :=int (_aag .MaxAttr -1);_ffg =append (_ffg ,colWidthRange {_baac :_ddd ,_fggf :_dg ,_dce :_ffa ,_gee :_fec .getStyle (_aag .StyleAttr )});};};_cgb :=0;for _ec :=0;_ec <=_fec ._aga ;_ec ++{if _ec < _fec ._ffgf ||(_ec > _fec ._afcf &&_fec ._afcf > 0){continue ;
};var _cfbb float64 ;var _cab *style ;if _cgb >=len (_ffg ){_cfbb =_bfd ;}else {_bba :=_ffg [_cgb ];if _ec >=_bba ._baac &&_ec <=_bba ._fggf {_cfbb =_bba ._dce ;_cab =_bba ._gee ;if _ec ==_bba ._fggf {_cgb ++;};}else {_cfbb =_bfd ;};};_gad =append (_gad ,&colInfo {_cdfca :_cfbb ,_efdd :_cab });
};_cee :=0.0;for _ ,_acge :=range _gad {_cee +=_acge ._cdfca ;};_fec ._ffc =1.0;if _cee > _fec ._acb {_fec ._ffc =_fec ._acb /_cee ;for _ ,_dcbg :=range _gad {_dcbg ._cdfca *=_fec ._ffc ;};};_fec ._dgbbb =_gad ;};func (_aab *convertContext )makeCells (){_dea :=_aab ._adb ;
_fga :=_dea .Rows ();_cgg :=0;for _gfa ,_eec :=range _aab ._cae {if _gfa < _aab ._defb ||(_gfa > _aab ._gef &&_aab ._gef > 0){continue ;};_eec ._fbc =[]*cell {};_cda :=0.0;_fff :=_eec ._bdad ;if _eec ._adace {_cfbf :=_fga [_cgg ];_cgg ++;_gcda :=_eec ._cgc ;
for _ ,_aad :=range _cfbf .Cells (){_ccc ,_cbe :=_gc .ParseCellReference (_aad .Reference ());if _cbe !=nil {_cg .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_cbe );
continue ;};if int (_ccc .ColumnIdx )< _aab ._ffgf ||(int (_ccc .ColumnIdx )> _aab ._afcf &&_aab ._afcf > 0){continue ;};_bfff :=_aab ._dgbbb [_ccc .ColumnIdx ];_gda :=_bfff ._cdfca ;_bac :=_gda ;_eeg :=_bfff ._efdd ;var _acgf ,_ffad ,_bdc ,_caf bool ;
for _ ,_cec :=range _aab ._fafa {if _ccc .RowIdx >=_cec ._gggg &&_ccc .RowIdx <=_cec ._dfea &&_ccc .ColumnIdx >=_cec ._dfef &&_ccc .ColumnIdx <=_cec ._cafe {if _ccc .ColumnIdx ==_cec ._dfef &&_ccc .RowIdx ==_cec ._gggg {_gda =_cec ._fbga ;_gcda =_cec ._cbde ;
};_acgf =_ccc .RowIdx !=_cec ._gggg ;_ffad =_ccc .RowIdx !=_cec ._dfea ;_bdc =_ccc .ColumnIdx !=_cec ._dfef ;_caf =_ccc .ColumnIdx !=_cec ._cafe ;};};_fgf :=_aab .getStyleFromCell (_aad ,_fff ,_eeg );var _gbgb ,_dda ,_dbed bool ;var _fgd ,_cea ,_dff ,_bgd *border ;
var _cdac _ab .ST_VerticalAlignment ;var _dgb _ab .ST_HorizontalAlignment ;if _fgf !=nil {if !_acgf {_fgd =_fgf ._ggb ;};if !_ffad {_cea =_fgf ._ebce ;};if !_bdc {_dff =_fgf ._fcaf ;};if !_caf {_bgd =_fgf ._edde ;};if _cea !=nil &&_cea ._efcd > _cda {_cda =_cea ._efcd ;
};_cdac =_fgf ._cfa ;_dgb =_fgf ._fagb ;if _fgf ._fbf !=nil {_gbgb =*_fgf ._fbf ;};if _fgf ._ecf !=nil {_dda =*_fgf ._ecf ;};_dbed =_fgf ._cdee ;};var _gcge _b .Color ;if _fgf !=nil &&_fgf ._bege !=nil {_gcge =_b .ColorRGBFromHex (*_fgf ._bege );};_ccd ,_aeae :=_aab .getContentFromCell (_dea ,_aad ,_fgf ,_gda ,_dbed );
_aeaa :=&cell {_cbce :_aeae ,_dfda :_gda ,_fee :_bac ,_gac :_gcda ,_cebf :_ccd ,_afgf :_fgd ,_cffa :_cea ,_cecg :_dff ,_abda :_bgd ,_deb :_gbgb ,_aabg :_dda ,_ggbd :_gcge };_aab .alignSymbolsHorizontally (_aeaa ,_dgb );_aab .alignSymbolsVertically (_aeaa ,_cdac );
_eec ._fbc =append (_eec ._fbc ,_aeaa );};};_eec ._bdf =_cda ;};};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_bb .PdfFont ){_d .RegisterFont (name ,style ,font );};var _ed =_ccbg (0.0625);type anchor struct{_cdfcc _f .Image ;_gggb *_ad .ChartSpace ;_bfbb int ;_ecg int64 ;_dcbb int ;_eeec int64 ;_eca int ;
_bdb int64 ;_ggdcb int ;_bdab int64 ;};type colInfo struct{_ffb float64 ;_cdfca float64 ;_efdd *style ;};func (_deef *convertContext )distributeAnchors (){for _ ,_ddcg :=range _deef ._fffd {_edda ,_gae :=_ddcg ._bfbb ,_ddcg ._ecg ;_geg ,_dba :=_ddcg ._dcbb ,_ddcg ._eeec ;
_ebf ,_gdb :=_ddcg ._eca ,_ddcg ._bdb ;_bbad ,_dcfg :=_ddcg ._ggdcb ,_ddcg ._bdab ;if _edda < _deef ._defb ||(_ebf > _deef ._gef &&_deef ._gef > 0){continue ;};if _geg < _deef ._ffgf ||(_bbad > _deef ._afcf &&_deef ._afcf > 0){continue ;};var _cabb ,_gab ,_egc ,_dgc *page ;
for _ ,_bbe :=range _deef ._ccge {for _ ,_eggf :=range _bbe ._adac {if _edda >=_eggf ._gca ._egcf &&_edda < _eggf ._gca ._fde {if _geg >=_eggf ._ggdc ._dafad &&_geg < _eggf ._ggdc ._cdg {_eggf ._edf =true ;_cabb =_eggf ;};if _bbad >=_eggf ._ggdc ._dafad &&_bbad < _eggf ._ggdc ._cdg {_eggf ._edf =true ;
_gab =_eggf ;};};if _ebf >=_eggf ._gca ._egcf &&_ebf < _eggf ._gca ._fde {if _geg >=_eggf ._ggdc ._dafad &&_geg < _eggf ._ggdc ._cdg {_eggf ._edf =true ;_dgc =_eggf ;};if _bbad >=_eggf ._ggdc ._dafad &&_bbad < _eggf ._ggdc ._cdg {_eggf ._edf =true ;_egc =_eggf ;
};};};};_cbed :=_cabb !=_gab ;_gabg :=_cabb !=_dgc ;if _cbed &&_gabg {_ega :=_deef ._dgbbb [_geg ]._ffb +_bfb .FromEMU (_dba );_bagd :=_cabb ._ggdc ._aaa ;_acgc :=_deef ._dgbbb [_bbad ]._ffb +_bfb .FromEMU (_dcfg );_babd :=_deef ._cae [_edda ]._bfda +_bfb .FromEMU (_gae );
_gcgc :=float64 (_cabb ._gca ._cga );_gg :=_deef ._cae [_ebf ]._bfda +_bfb .FromEMU (_gdb );_ceb :=_acgc +_bagd -_ega ;_ddag :=_gg +_gcgc -_babd ;_faf :=_deef .imageFromAnchor (_ddcg ,_ceb ,_ddag );_cabb ._bfc =append (_cabb ._bfc ,_deef .getImage (_faf ,_ddag ,_ceb ,_ega ,_babd ,_bagd -_ega ,_gcgc -_babd ,_d .ImgPart_lt ));
_gab ._bfc =append (_gab ._bfc ,_deef .getImage (_faf ,_ddag ,_ceb ,0,_babd ,_bagd -_ega ,_gcgc -_babd ,_d .ImgPart_rt ));_dgc ._bfc =append (_dgc ._bfc ,_deef .getImage (_faf ,_ddag ,_ceb ,_ega ,0,_bagd -_ega ,_gcgc -_babd ,_d .ImgPart_lb ));_egc ._bfc =append (_egc ._bfc ,_deef .getImage (_faf ,_ddag ,_ceb ,0,0,_bagd -_ega ,_gcgc -_babd ,_d .ImgPart_rb ));
}else if _cbed {_cca :=_deef ._cae [_edda ]._bfda +_bfb .FromEMU (_gae );_cfbc :=_deef ._cae [_ebf ]._bfda +_bfb .FromEMU (_gdb );_eee :=_deef ._dgbbb [_geg ]._ffb +_bfb .FromEMU (_dba );_ccaf :=_cabb ._ggdc ._aaa ;_da :=_deef ._dgbbb [_bbad ]._ffb +_bfb .FromEMU (_dcfg );
_gabb :=_da +_ccaf -_eee ;_cedd :=_cfbc -_cca ;_daf :=_deef .imageFromAnchor (_ddcg ,_gabb ,_cedd );_cabb ._bfc =append (_cabb ._bfc ,_deef .getImage (_daf ,_cedd ,_gabb ,_eee ,_cca ,_ccaf -_eee ,0,_d .ImgPart_l ));_gab ._bfc =append (_gab ._bfc ,_deef .getImage (_daf ,_cedd ,_gabb ,0,_cca ,_ccaf -_eee ,0,_d .ImgPart_r ));
}else if _gabg {_bdda :=_deef ._dgbbb [_geg ]._ffb +_bfb .FromEMU (_dba );_abd :=_deef ._dgbbb [_bbad ]._ffb +_bfb .FromEMU (_dcfg );_dcg :=_deef ._cae [_edda ]._bfda +_bfb .FromEMU (_gae );_feb :=float64 (_cabb ._gca ._cga );_cfgd :=_deef ._cae [_ebf ]._bfda +_bfb .FromEMU (_gdb );
_dcd :=_abd -_bdda ;_dfa :=_cfgd +_feb -_dcg ;_dac :=_deef .imageFromAnchor (_ddcg ,_dcd ,_dfa );_cabb ._bfc =append (_cabb ._bfc ,_deef .getImage (_dac ,_dfa ,_dcd ,_bdda ,_dcg ,0,_feb -_dcg ,_d .ImgPart_t ));_dgc ._bfc =append (_dgc ._bfc ,_deef .getImage (_dac ,_dfa ,_dcd ,_bdda ,0,0,_feb -_dcg ,_d .ImgPart_b ));
}else {_dcdf :=_deef ._dgbbb [_geg ]._ffb +_bfb .FromEMU (_dba );_agb :=_deef ._dgbbb [_bbad ]._ffb +_bfb .FromEMU (_dcfg );_eea :=_deef ._cae [_edda ]._bfda +_bfb .FromEMU (_gae );_eedc :=_deef ._cae [_ebf ]._bfda +_bfb .FromEMU (_gdb );_ddda :=_agb -_dcdf ;
_gaf :=_eedc -_eea ;_cbgg :=_deef .imageFromAnchor (_ddcg ,_ddda ,_gaf );_cabb ._bfc =append (_cabb ._bfc ,_deef .getImage (_cbgg ,_gaf ,_ddda ,_dcdf ,_eea ,0,0,_d .ImgPart_whole ));};};};type rowspan struct{_cga float64 ;_egcf int ;_fde int ;};const (FontStyle_Regular FontStyle =0;
FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);type mergedCell struct{_gggg uint32 ;_dfef uint32 ;_dfea uint32 ;_cafe uint32 ;_fbga float64 ;_cbde float64 ;};type colWidthRange struct{_baac int ;_fggf int ;
_dce float64 ;_gee *style ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_a .Sheet )*_b .Creator {_be :=s .X ();if _be ==nil {return nil ;};var _df _b .PageSize ;_fa :=true ;_eb :=false ;if _be .SheetPr !=nil &&_be .SheetPr .PageSetUpPr !=nil &&_be .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_be .SheetPr .PageSetUpPr .FitToPageAttr {_eb =true ;
};if _bda :=_be .PageSetup ;_bda !=nil {_fa =_bda .OrientationAttr ==_ab .ST_OrientationLandscape ;if _bdg :=_bda .PaperSizeAttr ;_bdg !=nil {_df =_bcb [*_bdg ];};};if (_df ==_b .PageSize {}){_df =_b .PageSizeA4 ;};if _fa {_df [0],_df [1]=_df [1],_df [0];
};_egg :=_b .New ();_egg .SetPageSize (_df );var _bff ,_dcf ,_af ,_ff float64 ;if _beb :=_be .PageMargins ;_beb !=nil {_af =_beb .LeftAttr ;_ff =_beb .RightAttr ;_bff =_beb .TopAttr ;_dcf =_beb .BottomAttr ;};if _af < _db {_af =_db ;};if _ff < _db {_ff =_db ;
};if _bff < _ef {_bff =_ef ;};if _dcf < _ef {_dcf =_ef ;};_bff *=_bfb .Inch ;_dcf *=_bfb .Inch ;_af *=_bfb .Inch ;_ff *=_bfb .Inch ;_egg .SetPageMargins (_af ,_ff ,_bff ,_dcf );_ac :=s .Workbook ();var _add *_cc .Theme ;if len (_ac .Themes ())> 0{_add =_ac .Themes ()[0];
};var _edc ,_fae ,_eff ,_gbb int ;for _ ,_gd :=range _ac .DefinedNames (){if _gd .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_fg ,_fgg ,_agg ,_ea :=_d .ParseExcelRange (_gd .Content ());if _ea ==nil &&s .Name ()==_fg {_edc =int (_fgg .ColumnIdx );
_fae =int (_agg .ColumnIdx );_eff =int (_fgg .RowIdx );_gbb =int (_agg .RowIdx );};};};_gbg :=&convertContext {_dga :_egg ,_adb :s ,_cbd :s .Workbook (),_bbbf :_add ,_eeda :&s .Workbook ().StyleSheet ,_gcb :_bff ,_dfd :_af ,_cef :_df [1]-_dcf -_bff ,_acb :_df [0]-_ff -_af ,_ffgf :_edc ,_afcf :_fae ,_defb :_eff ,_gef :_gbb ,_eccc :_eb };
_gbg .makeAnchors ();_gbg .determineMaxIndexes ();if _gbg ._fcb ==0&&_gbg ._aga ==0{_egg .NewPage ();return _egg ;};_gbg .makeCols ();_gbg .makeRows ();_gbg .makeMergedCells ();_gbg .makeCells ();_gbg .makePagespans ();_gbg .makeRowspans ();_gbg .makePages ();
_gbg .fillPages ();_gbg .distributeAnchors ();_gbg .drawSheet (_fa );return _egg ;};func (_fce *convertContext )getSymbolsFromR (_dgf []*_ab .CT_RElt ,_fedc *style )[]*symbol {_gbdf :=[]*symbol {};for _ ,_edb :=range _dgf {_afb :=_fce .combineCellStyleWithRPrElt (_fedc ,_edb .RPr );
for _ ,_dca :=range _edb .T {_gbdf =append (_gbdf ,&symbol {_fdfe :string (_dca ),_edgc :_fce .makeTextStyleFromCellStyle (_afb )});};};return _gbdf ;};func _ebff (_ddb []*symbol )float64 {_ggd :=0.0;for _ ,_cdfdd :=range _ddb {if _cdfdd ._cddf > _ggd {_ggd =_cdfdd ._cddf ;
};};return _ggd ;};func (_efc *convertContext )fillPages (){for _edd ,_age :=range _efc ._cdfc {_gdf :=_efc ._cae [_age ._egcf :_age ._fde ];for _fggd ,_efag :=range _gdf {_afg :=0;_bbd :=0.0;_cbb :=[]*cell {};if _efag ._adace {for _ ,_gdfb :=range _efag ._fbc {_afe :=_efc ._ccge [_afg ];
_efc ._cgba =_afe ._adac [_edd ];_efc ._cgba ._edf =true ;_cff :=_gdfb ._fee ;if _bbd +_cff > _afe ._aaa {_efc .addRowToPage (_cbb ,_fggd );_cbb =[]*cell {_gdfb };_bbd =_cff ;_afg ++;}else {_gdfb ._dfec =_bbd ;_cbb =append (_cbb ,_gdfb );_bbd +=_cff ;};
};if len (_cbb )> 0{_cfc :=_efc ._ccge [_afg ];_efc ._cgba =_cfc ._adac [_edd ];_efc ._cgba ._edf =true ;_efc .addRowToPage (_cbb ,_fggd );};};};};};const _db =0.25;func (_cdc *convertContext )getColorStringFromSmlColor (_bebf *_ab .CT_Color )*string {var _cggg string ;
if _bebf .RgbAttr !=nil {_cggg =*_bebf .RgbAttr ;}else if _bebf .IndexedAttr !=nil &&*_bebf .IndexedAttr < 64{_cggg =_egcg [*_bebf .IndexedAttr ];}else if _bebf .ThemeAttr !=nil {_cfbfd :=*_bebf .ThemeAttr ;_cggg =_cdc .getColorFromTheme (_cfbfd );};if _cggg ==""{return nil ;
};if len (_cggg )> 6{_cggg =_cggg [(len (_cggg )-6):];};if _bebf .TintAttr !=nil {_cebe :=*_bebf .TintAttr ;_cggg =_d .AdjustColorByTint (_cggg ,_cebe );};_cggg ="\u0023"+_cggg ;return &_cggg ;};type pageRow struct{_cbc int ;_bebc []*cell ;};func (_gfe *convertContext )makeRowspans (){var _fda float64 ;
_cdf :=0;for _bdd ,_bbb :=range _gfe ._cae {_ecc :=_bbb ._cgc +_bbb ._bdf ;if _fda +_ecc <=_gfe ._cef {_bbb ._bfda =_fda ;_fda +=_ecc ;}else {_gfe ._cdfc =append (_gfe ._cdfc ,&rowspan {_cga :_fda ,_egcf :_cdf ,_fde :_bdd });_cdf =_bdd ;_bbb ._bfda =0;
_fda =_ecc ;};};_gfe ._cdfc =append (_gfe ._cdfc ,&rowspan {_cga :_fda ,_egcf :_cdf ,_fde :len (_gfe ._cae )});};type style struct{_bege *string ;_fcff *string ;_eda *float64 ;_gdfd *string ;_cfba *bool ;_dcgf *bool ;_fgfe *bool ;_fbf *bool ;_ecf *bool ;
_ggb *border ;_ebce *border ;_fcaf *border ;_edde *border ;_cdee bool ;_cfa _ab .ST_VerticalAlignment ;_fagb _ab .ST_HorizontalAlignment ;};const _cd =15.0;func (_gfcb *convertContext )getColorFromTheme (_afd uint32 )string {_ddcd :=_gfcb ._cbd .Themes ();
if len (_ddcd )!=0{_adda :=_ddcd [0];if _cabe :=_adda .ThemeElements ;_cabe !=nil {if _gefe :=_cabe .ClrScheme ;_gefe !=nil {switch _afd {case 0:return _d .GetColorStringFromDmlColor (_gefe .Lt1 );case 1:return _d .GetColorStringFromDmlColor (_gefe .Dk1 );
case 2:return _d .GetColorStringFromDmlColor (_gefe .Lt2 );case 3:return _d .GetColorStringFromDmlColor (_gefe .Dk2 );case 4:return _d .GetColorStringFromDmlColor (_gefe .Accent1 );case 5:return _d .GetColorStringFromDmlColor (_gefe .Accent2 );case 6:return _d .GetColorStringFromDmlColor (_gefe .Accent3 );
case 7:return _d .GetColorStringFromDmlColor (_gefe .Accent4 );case 8:return _d .GetColorStringFromDmlColor (_gefe .Accent5 );case 9:return _d .GetColorStringFromDmlColor (_gefe .Accent6 );};};};};return "";};func (_ffcg *convertContext )getBorder (_gaed *_ab .CT_BorderPr )*border {_gfef :=&border {};
switch _gaed .StyleAttr {case _ab .ST_BorderStyleHair :_gfef ._efcd =_ed /2;case _ab .ST_BorderStyleThin :_gfef ._efcd =_ed ;case _ab .ST_BorderStyleMedium :_gfef ._efcd =_ed *2;case _ab .ST_BorderStyleThick :_gfef ._efcd =_ed *4;};if _gfef ._efcd ==0.0{return nil ;
};if _afcd :=_gaed .Color ;_afcd !=nil {_faea :=_ffcg .getColorStringFromSmlColor (_afcd );if _faea !=nil {_gfef ._fcbd =_b .ColorRGBFromHex (*_faea );}else {_gfef ._fcbd =_b .ColorBlack ;};};return _gfef ;};func _gadf (_ceef *bool )bool {return _ceef !=nil &&*_ceef };
var _cf =3.025/_ccbg (1);func (_gadg *convertContext )addRowToPage (_fedb []*cell ,_dbf int ){_ded :=0.0;_fedba :=_gadg ._acb ;for _ ,_dcga :=range _fedb {if len (_dcga ._cebf )!=0{_dcga ._fbcb =_ded ;_ded =_dcga ._dfec +_dcga ._dfda ;};};for _bgc :=len (_fedb )-1;
_bgc >=0;_bgc --{_bffd :=_fedb [_bgc ];if len (_bffd ._cebf )!=0{_bffd ._dbd =_fedba ;_fedba =_bffd ._dfec ;};};_gadg ._cgba ._eafc =append (_gadg ._cgba ._eafc ,&pageRow {_cbc :_dbf ,_bebc :_fedb });};