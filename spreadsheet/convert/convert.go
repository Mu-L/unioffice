//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_fb "github.com/unidoc/unioffice/common/logger";_ab "github.com/unidoc/unioffice/common/tempstorage";_fbb "github.com/unidoc/unioffice/internal/convertutils";_dg "github.com/unidoc/unioffice/measurement";_ace "github.com/unidoc/unioffice/schema/soo/dml";
_ca "github.com/unidoc/unioffice/schema/soo/dml/chart";_df "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_gb "github.com/unidoc/unioffice/schema/soo/sml";_ad "github.com/unidoc/unioffice/spreadsheet";_de "github.com/unidoc/unioffice/spreadsheet/formula";
_ac "github.com/unidoc/unioffice/spreadsheet/reference";_g "github.com/unidoc/unipdf/v3/creator";_a "github.com/unidoc/unipdf/v3/model";_f "image";_d "strconv";);func (_cfc *convertContext )makeRowspans (){var _gfb float64 ;_bgc :=0;for _gbd ,_gcf :=range _cfc ._acc {_ged :=_gcf ._ebbf +_gcf ._acae ;
if _gfb +_ged <=_cfc ._cdf {_gcf ._cddaa =_gfb ;_gfb +=_ged ;}else {_cfc ._ccb =append (_cfc ._ccb ,&rowspan {_gddfe :_gfb ,_geed :_bgc ,_efeb :_gbd });_bgc =_gbd ;_gcf ._cddaa =0;_gfb =_ged ;};};_cfc ._ccb =append (_cfc ._ccb ,&rowspan {_gddfe :_gfb ,_geed :_bgc ,_efeb :len (_cfc ._acc )});
};const _fg =2;

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _fbb .RegisterFontsFromDirectory (dirName );};const _ge =0.25;func (_bacf *convertContext )addRowToPage (_fbd []*cell ,_ccaf int ){_dccf :=0.0;_afd :=_bacf ._fegd ;for _ ,_aefb :=range _fbd {if len (_aefb ._acge )!=0{_aefb ._bbag =_dccf ;
_dccf =_aefb ._fcag +_aefb ._bbcf ;};};for _cgf :=len (_fbd )-1;_cgf >=0;_cgf --{_fgeg :=_fbd [_cgf ];if len (_fgeg ._acge )!=0{_fgeg ._gcfca =_afd ;_afd =_fgeg ._fcag ;};};_bacf ._bee ._dbgd =append (_bacf ._bee ._dbgd ,&pageRow {_fade :_ccaf ,_aegb :_fbd });
};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_ad .Sheet )*_g .Creator {_caa :=s .X ();if _caa ==nil {return nil ;};var _gea _g .PageSize ;_b :=true ;_fc :=false ;if _caa .SheetPr !=nil &&_caa .SheetPr .PageSetUpPr !=nil &&_caa .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_caa .SheetPr .PageSetUpPr .FitToPageAttr {_fc =true ;
};if _gc :=_caa .PageSetup ;_gc !=nil {_b =_gc .OrientationAttr ==_gb .ST_OrientationLandscape ;if _ggb :=_gc .PaperSizeAttr ;_ggb !=nil {_gea =_edfb [*_ggb ];};};if (_gea ==_g .PageSize {}){_gea =_g .PageSizeA4 ;};if _b {_gea [0],_gea [1]=_gea [1],_gea [0];
};_dc :=_g .New ();_dc .SetPageSize (_gea );var _ce ,_deb ,_fag ,_fge float64 ;if _bc :=_caa .PageMargins ;_bc !=nil {_fag =_bc .LeftAttr ;_fge =_bc .RightAttr ;_ce =_bc .TopAttr ;_deb =_bc .BottomAttr ;};if _fag < _ge {_fag =_ge ;};if _fge < _ge {_fge =_ge ;
};if _ce < _gf {_ce =_gf ;};if _deb < _gf {_deb =_gf ;};_ce *=_dg .Inch ;_deb *=_dg .Inch ;_fag *=_dg .Inch ;_fge *=_dg .Inch ;_dc .SetPageMargins (_fag ,_fge ,_ce ,_deb );_cd :=s .Workbook ();var _bcb *_ace .Theme ;if len (_cd .Themes ())> 0{_bcb =_cd .Themes ()[0];
};var _eb ,_gec ,_eg ,_dec int ;for _ ,_ed :=range _cd .DefinedNames (){if _ed .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_dfe ,_ef ,_be ,_dd :=_fbb .ParseExcelRange (_ed .Content ());if _dd ==nil &&s .Name ()==_dfe {_eb =int (_ef .ColumnIdx );
_gec =int (_be .ColumnIdx );_eg =int (_ef .RowIdx );_dec =int (_be .RowIdx );};};};_ba :=&convertContext {_gcdf :_dc ,_gefc :s ,_cfcgb :s .Workbook (),_ddfc :_bcb ,_cefe :&s .Workbook ().StyleSheet ,_aeb :_ce ,_dddc :_fag ,_cdf :_gea [1]-_deb -_ce ,_fegd :_gea [0]-_fge -_fag ,_edeg :_eb ,_gdee :_gec ,_gbff :_eg ,_fdde :_dec ,_gddd :_fc };
_ba .makeAnchors ();_ba .determineMaxIndexes ();if _ba ._bdbg ==0&&_ba ._dee ==0{_dc .NewPage ();return _dc ;};_ba .makeCols ();_ba .makeRows ();_ba .makeMergedCells ();_ba .makeCells ();_ba .makePagespans ();_ba .makeRowspans ();_ba .makePages ();_ba .fillPages ();
_ba .distributeAnchors ();_ba .drawSheet (_b );return _dc ;};var _edfb =map[uint32 ]_g .PageSize {1:_g .PageSize {8.5*_dg .Inch ,11*_dg .Inch },2:_g .PageSize {8.5*_dg .Inch ,11*_dg .Inch },3:_g .PageSize {11*_dg .Inch ,17*_dg .Inch },4:_g .PageSize {17*_dg .Inch ,11*_dg .Inch },5:_g .PageSize {8.5*_dg .Inch ,14*_dg .Inch },6:_g .PageSize {5.5*_dg .Inch ,8.5*_dg .Inch },7:_g .PageSize {7.5*_dg .Inch ,10*_dg .Inch },8:_g .PageSize {_gcfcc (297),_gcfcc (420)},9:_g .PageSize {_gcfcc (210),_gcfcc (297)},10:_g .PageSize {_gcfcc (210),_gcfcc (297)},11:_g .PageSize {_gcfcc (148),_gcfcc (210)},70:_g .PageSize {_gcfcc (105),_gcfcc (148)},12:_g .PageSize {_gcfcc (250),_gcfcc (354)},13:_g .PageSize {_gcfcc (182),_gcfcc (257)},14:_g .PageSize {8.5*_dg .Inch ,13*_dg .Inch },20:_g .PageSize {4.125*_dg .Inch ,9.5*_dg .Inch },27:_g .PageSize {_gcfcc (110),_gcfcc (220)},28:_g .PageSize {_gcfcc (162),_gcfcc (229)},34:_g .PageSize {_gcfcc (250),_gcfcc (176)},29:_g .PageSize {_gcfcc (324),_gcfcc (458)},30:_g .PageSize {_gcfcc (229),_gcfcc (324)},31:_g .PageSize {_gcfcc (114),_gcfcc (162)},37:_g .PageSize {3.88*_dg .Inch ,7.5*_dg .Inch },43:_g .PageSize {_gcfcc (100),_gcfcc (148)},69:_g .PageSize {_gcfcc (200),_gcfcc (148)}};
const _gg =0.64;type rowspan struct{_gddfe float64 ;_geed int ;_efeb int ;};func _gcfcc (_bgdg float64 )float64 {return _bgdg *_dg .Millimeter };func _geg (_egdf []*symbol )float64 {_bcdc :=0.0;for _ ,_ggec :=range _egdf {_bcdc +=_ggec ._gegg ;};return _bcdc ;
};func (_ebb *convertContext )makePagespans (){_ebb ._bag =[]*pagespan {};_beaf :=0.0;_cbb :=0;for _egc ,_gcba :=range _ebb ._agd {_gcab :=_gcba ._ggbb ;if _beaf +_gcab <=_ebb ._fegd {_gcba ._cfca =_beaf ;_beaf +=_gcab ;}else {_gcba ._cfca =0;_ebb ._bag =append (_ebb ._bag ,&pagespan {_afa :_beaf ,_ggfbc :_cbb ,_fdba :_egc });
_beaf =_gcab ;_cbb =_egc ;};};_ebb ._bag =append (_ebb ._bag ,&pagespan {_afa :_beaf ,_ggfbc :_cbb ,_fdba :len (_ebb ._agd )});};func (_gcdg *convertContext )combineCellStyleWithRPrElt (_geea *style ,_cgaec *_gb .CT_RPrElt )*style {_eec :=*_geea ;_fced :=_gcdg .getStyleFromRPrElt (_cgaec );
if _fced ==nil {return &_eec ;};if _fced ._fafg !=nil {_eec ._fafg =_fced ._fafg ;};if _fced ._cede !=nil {_eec ._cede =_fced ._cede ;};if _fced ._gaf !=nil {_eec ._gaf =_fced ._gaf ;};if _fced ._beg !=nil {_eec ._beg =_fced ._beg ;};if _fced ._bgbc !=nil {_eec ._bgbc =_fced ._bgbc ;
};if _fced ._abfa !=nil {_eec ._abfa =_fced ._abfa ;};if _fced ._ggcb !=nil {_eec ._ggcb =_fced ._ggcb ;};if _fced ._eaaf !=nil {_eec ._eaaf =_fced ._eaaf ;};return &_eec ;};func (_dfa *convertContext )makeCols (){_ggc :=_dfa ._gefc ;_afc :=_ggc .X ();
_efb :=[]*colInfo {};_gd :=[]colWidthRange {};if _dedc :=_afc .Cols ;len (_dedc )> 0{for _ ,_dge :=range _dedc [0].Col {_gee :=_e ;if _ggca :=_dge .WidthAttr ;_ggca !=nil {if *_ggca > 0.83{*_ggca -=0.83;};if *_ggca <=1{_gee =*_ggca *11;}else {_gee =5+*_ggca *6;
};};_gfa :=int (_dge .MinAttr -1);_fd :=int (_dge .MaxAttr -1);_gd =append (_gd ,colWidthRange {_cfbf :_gfa ,_geda :_fd ,_abbb :_gee ,_eda :_dfa .getStyle (_dge .StyleAttr )});};};_affg :=0;for _eca :=0;_eca <=_dfa ._dee ;_eca ++{if _eca < _dfa ._edeg ||(_eca > _dfa ._gdee &&_dfa ._gdee > 0){continue ;
};var _dad float64 ;var _eff *style ;if _affg >=len (_gd ){_dad =_e ;}else {_ecc :=_gd [_affg ];if _eca >=_ecc ._cfbf &&_eca <=_ecc ._geda {_dad =_ecc ._abbb ;_eff =_ecc ._eda ;if _eca ==_ecc ._geda {_affg ++;};}else {_dad =_e ;};};_efb =append (_efb ,&colInfo {_ggbb :_dad ,_fed :_eff });
};_ee :=0.0;for _ ,_egf :=range _efb {_ee +=_egf ._ggbb ;};_dfa ._efd =1.0;if _ee > _dfa ._fegd {_dfa ._efd =_dfa ._fegd /_ee ;for _ ,_cga :=range _efb {_cga ._ggbb *=_dfa ._efd ;};};_dfa ._agd =_efb ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_fbb .FontStyle ;func (_fbfc *convertContext )getSymbolsFromR (_bcd []*_gb .CT_RElt ,_gcaf *style )[]*symbol {_eafg :=[]*symbol {};for _ ,_gbf :=range _bcd {_dag :=_fbfc .combineCellStyleWithRPrElt (_gcaf ,_gbf .RPr );for _ ,_abaa :=range _gbf .T {_eafg =append (_eafg ,&symbol {_efc :string (_abaa ),_eebc :_fbfc .makeTextStyleFromCellStyle (_dag )});
};};return _eafg ;};func (_daeb *convertContext )makePages (){for _ ,_dde :=range _daeb ._bag {for _ ,_cabd :=range _daeb ._ccb {_dde ._cegd =append (_dde ._cegd ,&page {_dbgd :[]*pageRow {},_ceca :_dde ,_bbead :_cabd });};};};func (_eef *convertContext )getColorFromTheme (_egfbd uint32 )string {_dbbg :=_eef ._cfcgb .Themes ();
if len (_dbbg )!=0{_bggf :=_dbbg [0];if _dafag :=_bggf .ThemeElements ;_dafag !=nil {if _fede :=_dafag .ClrScheme ;_fede !=nil {switch _egfbd {case 0:return _fbb .GetColorStringFromDmlColor (_fede .Lt1 );case 1:return _fbb .GetColorStringFromDmlColor (_fede .Dk1 );
case 2:return _fbb .GetColorStringFromDmlColor (_fede .Lt2 );case 3:return _fbb .GetColorStringFromDmlColor (_fede .Dk2 );case 4:return _fbb .GetColorStringFromDmlColor (_fede .Accent1 );case 5:return _fbb .GetColorStringFromDmlColor (_fede .Accent2 );
case 6:return _fbb .GetColorStringFromDmlColor (_fede .Accent3 );case 7:return _fbb .GetColorStringFromDmlColor (_fede .Accent4 );case 8:return _fbb .GetColorStringFromDmlColor (_fede .Accent5 );case 9:return _fbb .GetColorStringFromDmlColor (_fede .Accent6 );
};};};};return "";};func (_ade *convertContext )makeCells (){_adf :=_ade ._gefc ;_feg :=_adf .Rows ();_dfee :=0;for _bff ,_fcf :=range _ade ._acc {if _bff < _ade ._gbff ||(_bff > _ade ._fdde &&_ade ._fdde > 0){continue ;};_fcf ._eae =[]*cell {};_bffe :=0.0;
_affd :=_fcf ._egff ;if _fcf ._gbdf {_dfg :=_feg [_dfee ];_dfee ++;_bbf :=_fcf ._ebbf ;for _ ,_ff :=range _dfg .Cells (){_gcbb ,_fdd :=_ac .ParseCellReference (_ff .Reference ());if _fdd !=nil {_fb .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_fdd );
continue ;};if int (_gcbb .ColumnIdx )< _ade ._edeg ||(int (_gcbb .ColumnIdx )> _ade ._gdee &&_ade ._gdee > 0){continue ;};_aef :=_ade ._agd [_gcbb .ColumnIdx ];_dda :=_aef ._ggbb ;_aead :=_dda ;_bbb :=_aef ._fed ;var _fgf ,_cc ,_acd ,_eccc bool ;for _ ,_bea :=range _ade ._ddc {if _gcbb .RowIdx >=_bea ._accc &&_gcbb .RowIdx <=_bea ._fabd &&_gcbb .ColumnIdx >=_bea ._egca &&_gcbb .ColumnIdx <=_bea ._gafa {if _gcbb .ColumnIdx ==_bea ._egca &&_gcbb .RowIdx ==_bea ._accc {_dda =_bea ._gda ;
_bbf =_bea ._ebbfc ;};_fgf =_gcbb .RowIdx !=_bea ._accc ;_cc =_gcbb .RowIdx !=_bea ._fabd ;_acd =_gcbb .ColumnIdx !=_bea ._egca ;_eccc =_gcbb .ColumnIdx !=_bea ._gafa ;};};_abg :=_ade .getStyleFromCell (_ff ,_affd ,_bbb );var _adc ,_geae ,_egbg bool ;var _afb ,_bae ,_aed ,_fee *border ;
var _cbfd _gb .ST_VerticalAlignment ;var _caaf _gb .ST_HorizontalAlignment ;if _abg !=nil {if !_fgf {_afb =_abg ._ffda ;};if !_cc {_bae =_abg ._fega ;};if !_acd {_aed =_abg ._cge ;};if !_eccc {_fee =_abg ._eeg ;};if _bae !=nil &&_bae ._cbgd > _bffe {_bffe =_bae ._cbgd ;
};_cbfd =_abg ._aca ;_caaf =_abg ._ddg ;if _abg ._ggcb !=nil {_adc =*_abg ._ggcb ;};if _abg ._eaaf !=nil {_geae =*_abg ._eaaf ;};_egbg =_abg ._befg ;};var _ffd _g .Color ;if _abg !=nil &&_abg ._bcf !=nil {_ffd =_g .ColorRGBFromHex (*_abg ._bcf );};_bdb ,_geb :=_ade .getContentFromCell (_adf ,_ff ,_abg ,_dda ,_egbg );
_beae :=&cell {_abfg :_geb ,_bbcf :_dda ,_cfbd :_aead ,_afcc :_bbf ,_acge :_bdb ,_ecff :_afb ,_cbaa :_bae ,_cad :_aed ,_bfgf :_fee ,_bbec :_adc ,_aaec :_geae ,_efeg :_ffd };_ade .alignSymbolsHorizontally (_beae ,_caaf );_ade .alignSymbolsVertically (_beae ,_cbfd );
_fcf ._eae =append (_fcf ._eae ,_beae );};};_fcf ._acae =_bffe ;};};const _fa =3;var _dgc =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
func (_dgda *convertContext )getColorStringFromSmlColor (_ageg *_gb .CT_Color )*string {var _ega string ;if _ageg .RgbAttr !=nil {_ega =*_ageg .RgbAttr ;}else if _ageg .IndexedAttr !=nil &&*_ageg .IndexedAttr < 64{_ega =_dgc [*_ageg .IndexedAttr ];}else if _ageg .ThemeAttr !=nil {_gedf :=*_ageg .ThemeAttr ;
_ega =_dgda .getColorFromTheme (_gedf );};if _ega ==""{return nil ;};if len (_ega )> 6{_ega =_ega [(len (_ega )-6):];};if _ageg .TintAttr !=nil {_ffb :=*_ageg .TintAttr ;_ega =_fbb .AdjustColorByTint (_ega ,_ffb );};_ega ="\u0023"+_ega ;return &_ega ;};
func (_faa *convertContext )makeAnchors (){_cf ,_bcc :=_faa ._gefc .GetDrawing ();if _cf !=nil {for _ ,_ded :=range _cf .EG_Anchor {_bg :=&anchor {};if _af :=_ded .TwoCellAnchor ;_af !=nil {_cae ,_deg :=_af .From ,_af .To ;if _cae ==nil ||_deg ==nil {return ;
};_bg ._fac =int (_cae .Row );_bg ._bfa =_fbb .FromSTCoordinate (_cae .RowOff );_bg ._cadb =int (_cae .Col );_bg ._aee =_fbb .FromSTCoordinate (_cae .ColOff );_bg ._cbfcg =int (_deg .Row );_bg ._egfb =_fbb .FromSTCoordinate (_deg .RowOff );_bg ._cccb =int (_deg .Col );
_bg ._bed =_fbb .FromSTCoordinate (_deg .ColOff );if _db :=_af .Choice ;_db !=nil {if _adg :=_db .Pic ;_adg !=nil {if _bgf :=_adg .BlipFill ;_bgf !=nil {if _cb :=_bgf .Blip ;_cb !=nil {if _dce :=_cb .EmbedAttr ;_dce !=nil {for _ ,_fca :=range _bcc .X ().Relationship {if _fca .IdAttr ==*_dce {for _ ,_aff :=range _faa ._cfcgb .Images {if _aff .Target ()==_fca .TargetAttr {_cbf ,_bbd :=_ab .Open (_aff .Path ());
if _bbd !=nil {_fb .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_bbd );continue ;};_fce ,_ ,_bbd :=_f .Decode (_cbf );if _bbd !=nil {_fb .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_bbd );
continue ;};_bg ._gggd =_fce ;};};};};};};};}else if _ec :=_db .GraphicFrame ;_ec !=nil {if _egb :=_ec .Graphic ;_egb !=nil {if _gcb :=_egb .GraphicData ;_gcb !=nil {for _ ,_adb :=range _gcb .Any {if _cec ,_aba :=_adb .(*_ca .Chart );_aba {for _ ,_fcec :=range _bcc .X ().Relationship {if _fcec .IdAttr ==_cec .IdAttr {_ggg :=_faa ._cfcgb .GetChartByTargetId (_fcec .TargetAttr );
if _ggg !=nil {_bg ._bgg =_ggg ;};};};};};};};};};};if _bg ._gggd !=nil ||_bg ._bgg !=nil {_faa ._acfg =append (_faa ._acfg ,_bg );};};};};var _ea =_gcfcc (1);func (_cce *convertContext )fillPages (){for _dfgb ,_bccd :=range _cce ._ccb {_gbgg :=_cce ._acc [_bccd ._geed :_bccd ._efeb ];
for _bfg ,_fdb :=range _gbgg {_ggf :=0;_eeb :=0.0;_gggc :=[]*cell {};if _fdb ._gbdf {for _ ,_cbfc :=range _fdb ._eae {_dcb :=_cce ._bag [_ggf ];_cce ._bee =_dcb ._cegd [_dfgb ];_cce ._bee ._bada =true ;_ece :=_cbfc ._cfbd ;if _eeb +_ece > _dcb ._afa {_cce .addRowToPage (_gggc ,_bfg );
_gggc =[]*cell {_cbfc };_eeb =_ece ;_ggf ++;}else {_cbfc ._fcag =_eeb ;_gggc =append (_gggc ,_cbfc );_eeb +=_ece ;};};if len (_gggc )> 0{_bgca :=_cce ._bag [_ggf ];_cce ._bee =_bgca ._cegd [_dfgb ];_cce ._bee ._bada =true ;_cce .addRowToPage (_gggc ,_bfg );
};};};};};type convertContext struct{_gcdf *_g .Creator ;_cfcgb *_ad .Workbook ;_ddfc *_ace .Theme ;_gefc *_ad .Sheet ;_cefe *_ad .StyleSheet ;_bdbg int ;_dee int ;_bag []*pagespan ;_bee *page ;_agd []*colInfo ;_acc []*rowInfo ;_ccb []*rowspan ;_aeb float64 ;
_dddc float64 ;_cdf float64 ;_fegd float64 ;_ddc []*mergedCell ;_acfg []*anchor ;_efd float64 ;_edeg int ;_gdee int ;_gbff int ;_fdde int ;_gddd bool ;};var _cag =_gcfcc (0.0625);func (_fgee *convertContext )makeRows (){_faf :=[]*rowInfo {};_dege :=_fgee ._gefc .Rows ();
_dga :=0;_eccd :=0.0;for _aag ,_baf :=range _dege {if _aag < _fgee ._gbff ||(_aag > _fgee ._fdde &&_fgee ._fdde > 0){continue ;};_dga ++;_bge :=int (_baf .RowNumber ());if _bge > _dga {for _fga :=_dga ;_fga < _bge ;_fga ++{_faf =append (_faf ,&rowInfo {_ebbf :_da /_ae });
_eccd +=_da /_ae ;};_dga =_bge ;};var _bbc float64 ;if _baf .X ().HtAttr ==nil {_bbc =_da ;}else {_bbc =*_baf .X ().HtAttr ;};_faf =append (_faf ,&rowInfo {_ebbf :_bbc /_ae ,_gbdf :true ,_egff :_fgee .getStyle (_baf .X ().SAttr )});_eccd +=_bbc /_ae ;};
for _gdb :=len (_faf );_gdb < _fgee ._bdbg ;_gdb ++{_faf =append (_faf ,&rowInfo {_ebbf :_da /_ae });_eccd +=_da /_ae ;};if _fgee ._gddd ||_eccd > _fgee ._cdf {for _ ,_dae :=range _faf {_dae ._ebbf *=_fgee ._efd ;};};_fgee ._acc =_faf ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_a .PdfFont ){_fbb .RegisterFont (name ,style ,font );};func (_fedc *convertContext )getBorder (_gbeeb *_gb .CT_BorderPr )*border {_cgaf :=&border {};switch _gbeeb .StyleAttr {case _gb .ST_BorderStyleHair :_cgaf ._cbgd =_cag /2;
case _gb .ST_BorderStyleThin :_cgaf ._cbgd =_cag ;case _gb .ST_BorderStyleMedium :_cgaf ._cbgd =_cag *2;case _gb .ST_BorderStyleThick :_cgaf ._cbgd =_cag *4;};if _cgaf ._cbgd ==0.0{return nil ;};if _fdbf :=_gbeeb .Color ;_fdbf !=nil {_eag :=_fedc .getColorStringFromSmlColor (_fdbf );
if _eag !=nil {_cgaf ._efbc =_g .ColorRGBFromHex (*_eag );}else {_cgaf ._efbc =_g .ColorBlack ;};};return _cgaf ;};type border struct{_cbgd float64 ;_efbc _g .Color ;};type colWidthRange struct{_cfbf int ;_geda int ;_abbb float64 ;_eda *style ;};func (_cbd *convertContext )distributeAnchors (){for _ ,_geaa :=range _cbd ._acfg {_dcg ,_effb :=_geaa ._fac ,_geaa ._bfa ;
_abc ,_cgc :=_geaa ._cadb ,_geaa ._aee ;_cfa ,_beab :=_geaa ._cbfcg ,_geaa ._egfb ;_befd ,_daf :=_geaa ._cccb ,_geaa ._bed ;if _dcg < _cbd ._gbff ||(_cfa > _cbd ._fdde &&_cbd ._fdde > 0){continue ;};if _abc < _cbd ._edeg ||(_befd > _cbd ._gdee &&_cbd ._gdee > 0){continue ;
};var _bdg ,_ggfb ,_cecf ,_gcfc *page ;for _ ,_adgc :=range _cbd ._bag {for _ ,_bad :=range _adgc ._cegd {if _dcg >=_bad ._bbead ._geed &&_dcg < _bad ._bbead ._efeb {if _abc >=_bad ._ceca ._ggfbc &&_abc < _bad ._ceca ._fdba {_bad ._bada =true ;_bdg =_bad ;
};if _befd >=_bad ._ceca ._ggfbc &&_befd < _bad ._ceca ._fdba {_bad ._bada =true ;_ggfb =_bad ;};};if _cfa >=_bad ._bbead ._geed &&_cfa < _bad ._bbead ._efeb {if _abc >=_bad ._ceca ._ggfbc &&_abc < _bad ._ceca ._fdba {_bad ._bada =true ;_gcfc =_bad ;};
if _befd >=_bad ._ceca ._ggfbc &&_befd < _bad ._ceca ._fdba {_bad ._bada =true ;_cecf =_bad ;};};};};_caf :=_bdg !=_ggfb ;_aec :=_bdg !=_gcfc ;if _caf &&_aec {_dfab :=_cbd ._agd [_abc ]._cfca +_dg .FromEMU (_cgc );_dgb :=_bdg ._ceca ._afa ;_dcd :=_cbd ._agd [_befd ]._cfca +_dg .FromEMU (_daf );
_fgb :=_cbd ._acc [_dcg ]._cddaa +_dg .FromEMU (_effb );_cfff :=float64 (_bdg ._bbead ._gddfe );_fegg :=_cbd ._acc [_cfa ]._cddaa +_dg .FromEMU (_beab );_cbff :=_dcd +_dgb -_dfab ;_edd :=_fegg +_cfff -_fgb ;_edda :=_cbd .imageFromAnchor (_geaa ,_cbff ,_edd );
_bdg ._dff =append (_bdg ._dff ,_cbd .getImage (_edda ,_edd ,_cbff ,_dfab ,_fgb ,_dgb -_dfab ,_cfff -_fgb ,_fbb .ImgPart_lt ));_ggfb ._dff =append (_ggfb ._dff ,_cbd .getImage (_edda ,_edd ,_cbff ,0,_fgb ,_dgb -_dfab ,_cfff -_fgb ,_fbb .ImgPart_rt ));_gcfc ._dff =append (_gcfc ._dff ,_cbd .getImage (_edda ,_edd ,_cbff ,_dfab ,0,_dgb -_dfab ,_cfff -_fgb ,_fbb .ImgPart_lb ));
_cecf ._dff =append (_cecf ._dff ,_cbd .getImage (_edda ,_edd ,_cbff ,0,0,_dgb -_dfab ,_cfff -_fgb ,_fbb .ImgPart_rb ));}else if _caf {_ag :=_cbd ._acc [_dcg ]._cddaa +_dg .FromEMU (_effb );_geee :=_cbd ._acc [_cfa ]._cddaa +_dg .FromEMU (_beab );_dbb :=_cbd ._agd [_abc ]._cfca +_dg .FromEMU (_cgc );
_efg :=_bdg ._ceca ._afa ;_affa :=_cbd ._agd [_befd ]._cfca +_dg .FromEMU (_daf );_cdg :=_affa +_efg -_dbb ;_egd :=_geee -_ag ;_gdf :=_cbd .imageFromAnchor (_geaa ,_cdg ,_egd );_bdg ._dff =append (_bdg ._dff ,_cbd .getImage (_gdf ,_egd ,_cdg ,_dbb ,_ag ,_efg -_dbb ,0,_fbb .ImgPart_l ));
_ggfb ._dff =append (_ggfb ._dff ,_cbd .getImage (_gdf ,_egd ,_cdg ,0,_ag ,_efg -_dbb ,0,_fbb .ImgPart_r ));}else if _aec {_gebe :=_cbd ._agd [_abc ]._cfca +_dg .FromEMU (_cgc );_bbfa :=_cbd ._agd [_befd ]._cfca +_dg .FromEMU (_daf );_bdf :=_cbd ._acc [_dcg ]._cddaa +_dg .FromEMU (_effb );
_fbgg :=float64 (_bdg ._bbead ._gddfe );_cfe :=_cbd ._acc [_cfa ]._cddaa +_dg .FromEMU (_beab );_beaea :=_bbfa -_gebe ;_ced :=_cfe +_fbgg -_bdf ;_gedd :=_cbd .imageFromAnchor (_geaa ,_beaea ,_ced );_bdg ._dff =append (_bdg ._dff ,_cbd .getImage (_gedd ,_ced ,_beaea ,_gebe ,_bdf ,0,_fbgg -_bdf ,_fbb .ImgPart_t ));
_gcfc ._dff =append (_gcfc ._dff ,_cbd .getImage (_gedd ,_ced ,_beaea ,_gebe ,0,0,_fbgg -_bdf ,_fbb .ImgPart_b ));}else {_cbdc :=_cbd ._agd [_abc ]._cfca +_dg .FromEMU (_cgc );_cafa :=_cbd ._agd [_befd ]._cfca +_dg .FromEMU (_daf );_gdbc :=_cbd ._acc [_dcg ]._cddaa +_dg .FromEMU (_effb );
_fgfg :=_cbd ._acc [_cfa ]._cddaa +_dg .FromEMU (_beab );_acfd :=_cafa -_cbdc ;_gdd :=_fgfg -_gdbc ;_eccce :=_cbd .imageFromAnchor (_geaa ,_acfd ,_gdd );_bdg ._dff =append (_bdg ._dff ,_cbd .getImage (_eccce ,_gdd ,_acfd ,_cbdc ,_gdbc ,0,0,_fbb .ImgPart_whole ));
};};};func (_bdcc *convertContext )getStyleFromRPrElt (_fagf *_gb .CT_RPrElt )*style {if _fagf ==nil {return nil ;};_aecg :=&style {};_aecg ._gaf =&_fagf .RFont .ValAttr ;if _fcgd :=_fagf .B ;_fcgd !=nil {_ceb :=_fcgd .ValAttr ==nil ||*_fcgd .ValAttr ;
_aecg ._beg =&_ceb ;};if _beac :=_fagf .I ;_beac !=nil {_aedd :=_beac .ValAttr ==nil ||*_beac .ValAttr ;_aecg ._bgbc =&_aedd ;};if _gcfd :=_fagf .U ;_gcfd !=nil {_bbgf :=_gcfd .ValAttr ==_gb .ST_UnderlineValuesSingle ||_gcfd .ValAttr ==_gb .ST_UnderlineValuesUnset ;
_aecg ._abfa =&_bbgf ;};if _efca :=_fagf .VertAlign ;_efca !=nil {_edfg :=_efca .ValAttr ==_df .ST_VerticalAlignRunSuperscript ;_aecg ._ggcb =&_edfg ;_bdd :=_efca .ValAttr ==_df .ST_VerticalAlignRunSubscript ;_aecg ._eaaf =&_bdd ;};if _cbfb :=_fagf .Sz ;
_cbfb !=nil {_bgbd :=_cbfb .ValAttr ;_aecg ._cede =&_bgbd ;};if _ddee :=_fagf .Color ;_ddee !=nil {_aecg ._fafg =_bdcc .getColorStringFromSmlColor (_ddee );};return _aecg ;};const _gf =0.0;func (_gac *convertContext )alignSymbolsHorizontally (_cabb *cell ,_abb _gb .ST_HorizontalAlignment ){if _abb ==_gb .ST_HorizontalAlignmentUnset {switch _cabb ._abfg {case _gb .ST_CellTypeB :_abb =_gb .ST_HorizontalAlignmentCenter ;
case _gb .ST_CellTypeN :_abb =_gb .ST_HorizontalAlignmentRight ;default:_abb =_gb .ST_HorizontalAlignmentLeft ;};};var _gbed float64 ;for _ ,_dbg :=range _cabb ._acge {switch _abb {case _gb .ST_HorizontalAlignmentLeft :_gbed =_fa ;case _gb .ST_HorizontalAlignmentRight :_egcf :=_geg (_dbg ._caafge );
_gbed =_cabb ._bbcf -_fa -_egcf ;case _gb .ST_HorizontalAlignmentCenter :_geffg :=_geg (_dbg ._caafge );_gbed =(_cabb ._bbcf -_geffg )/2;};for _ ,_dadg :=range _dbg ._caafge {_dadg ._caeb +=_gbed ;};};};type cell struct{_abfg _gb .ST_CellType ;_ccc int ;
_fcag float64 ;_acge []*line ;_bbcf float64 ;_cfbd float64 ;_afcc float64 ;_bbag float64 ;_gcfca float64 ;_aae *_g .TextStyle ;_ecff *border ;_cbaa *border ;_cad *border ;_bfgf *border ;_bbec bool ;_aaec bool ;_efeg _g .Color ;};type colInfo struct{_cfca float64 ;
_ggbb float64 ;_fed *style ;};type pagespan struct{_afa float64 ;_cegd []*page ;_ggfbc int ;_fdba int ;};func _caafg (_ebbe *symbol ){_dccb :=_g .New ();_edf :=_dccb .NewStyledParagraph ();_edf .SetMargins (0,0,0,0);_fff :=_edf .Append (_ebbe ._efc );if _ebbe ._eebc !=nil {_fff .Style =*_ebbe ._eebc ;
};_ebbe ._cda =_edf .Height ();if _ebbe ._gegg ==0{_ebbe ._gegg =_edf .Width ();};};type style struct{_bcf *string ;_fafg *string ;_cede *float64 ;_gaf *string ;_beg *bool ;_bgbc *bool ;_abfa *bool ;_ggcb *bool ;_eaaf *bool ;_ffda *border ;_fega *border ;
_cge *border ;_eeg *border ;_befg bool ;_aca _gb .ST_VerticalAlignment ;_ddg _gb .ST_HorizontalAlignment ;};func (_fcd *convertContext )makeTextStyleFromCellStyle (_adga *style )*_g .TextStyle {_gbfg :=_fcd ._gcdf .NewTextStyle ();if _adga ==nil {_gbfg .FontSize =_fbb .DefaultFontSize ;
_gbfg .Font =_fbb .AssignStdFontByName (_gbfg ,_fbb .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_gbfg ;};if _gfd (_adga ._abfa ){_gbfg .Underline =true ;_gbfg .UnderlineStyle =_g .TextDecorationLineStyle {Offset :0.5,Thickness :_gcfcc (1/32)};
};var _efdf FontStyle ;if _gfd (_adga ._beg )&&_gfd (_adga ._bgbc ){_efdf =FontStyle_BoldItalic ;}else if _gfd (_adga ._beg ){_efdf =FontStyle_Bold ;}else if _gfd (_adga ._bgbc ){_efdf =FontStyle_Italic ;}else {_efdf =FontStyle_Regular ;};_ddae :="\u0064e\u0066\u0061\u0075\u006c\u0074";
if _adga ._gaf !=nil {_ddae =*_adga ._gaf ;};if _dbgda ,_gfe :=_fbb .StdFontsMap [_ddae ];_gfe {_gbfg .Font =_fbb .AssignStdFontByName (_gbfg ,_dbgda [_efdf ]);}else if _cbbef :=_fbb .GetRegisteredFont (_ddae ,_efdf );_cbbef !=nil {_gbfg .Font =_cbbef ;
}else {_fb .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_ddae ,_efdf );
_gbfg .Font =_fbb .AssignStdFontByName (_gbfg ,_fbb .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_efdf ]);};if _adga ._cede !=nil {_gbfg .FontSize =*_adga ._cede ;};if _adga ._fafg !=nil {_gbfg .Color =_g .ColorRGBFromHex (*_adga ._fafg );};if _adga ._ggcb !=nil &&*_adga ._ggcb {_gbfg .FontSize *=_gg ;
}else if _adga ._eaaf !=nil &&*_adga ._eaaf {_gbfg .FontSize *=_gg ;};return &_gbfg ;};func (_ggfc *convertContext )alignSymbolsVertically (_cgfc *cell ,_babg _gb .ST_VerticalAlignment ){var _feaf float64 ;switch _babg {case _gb .ST_VerticalAlignmentTop :_feaf =_fg ;
if _cgfc ._bbec {_feaf -=_cg ;}else if _cgfc ._aaec {_feaf +=4*_cg ;};for _ ,_eed :=range _cgfc ._acge {_feaf +=_eed ._bcac ;_eed ._dbdc =_feaf ;_feaf +=_ea ;};case _gb .ST_VerticalAlignmentCenter :_ddb :=0.0;for _ ,_dgeg :=range _cgfc ._acge {_ddb +=_dgeg ._bcac +_gcfcc (1);
};_feaf =0.5*(_cgfc ._afcc -_ddb );if _cgfc ._bbec {_feaf -=2*_cg ;}else if _cgfc ._aaec {_feaf +=2*_cg ;};for _ ,_bba :=range _cgfc ._acge {_feaf +=_bba ._bcac +0.5*_ea ;_bba ._dbdc =_feaf ;_feaf +=0.5*_ea ;};default:_feaf =_cgfc ._afcc -_fg ;if _cgfc ._bbec {_feaf -=4*_cg ;
}else if _cgfc ._aaec {_feaf +=_cg ;};for _dgbe :=len (_cgfc ._acge )-1;_dgbe >=0;_dgbe --{_cgfc ._acge [_dgbe ]._dbdc =_feaf ;_feaf -=_cgfc ._acge [_dgbe ]._bcac ;_feaf -=_ea ;};};};type rowInfo struct{_cddaa float64 ;_gbdf bool ;_ebbf float64 ;_egff *style ;
_eae []*cell ;_acae float64 ;};type page struct{_dbgd []*pageRow ;_bada bool ;_dff []*_g .Image ;_ceca *pagespan ;_bbead *rowspan ;};func (_abad *convertContext )drawPage (_cfb *page ){_adcg :=_abad ._aeb ;_cca :=_abad ._dddc ;for _ ,_cbe :=range _cfb ._dbgd {_beaa :=_abad ._acc [_cbe ._fade ];
for _ ,_aeg :=range _cbe ._aegb {var _ddd float64 ;if _cbe ._fade > 1{_ddd =_abad ._acc [_cbe ._fade -1]._acae ;};var _fdbd ,_dbd float64 ;if _dbbf :=_aeg ._ecff ;_dbbf !=nil {_fdbd =_dbbf ._cbgd ;};if _cfaa :=_aeg ._cbaa ;_cfaa !=nil {_dbd =_cfaa ._cbgd ;
};_dcc :=_adcg +_beaa ._cddaa -0.5*(_ddd -_fdbd );_fadg :=_adcg +_beaa ._cddaa +_beaa ._ebbf +0.5*(_beaa ._acae +_dbd );_bbe :=_cca +_aeg ._fcag ;_badf :=_bbe +_aeg ._cfbd ;if _aeg ._efeg !=nil &&_aeg ._efeg !=_g .ColorBlack {_fbb .FillRectangle (_abad ._gcdf ,_bbe ,_dcc ,_badf -_bbe ,_fadg -_dcc ,_aeg ._efeg );
};};};for _ ,_cfd :=range _cfb ._dbgd {_ada :=_abad ._acc [_cfd ._fade ];for _ ,_geaeg :=range _cfd ._aegb {_cef :=_geaeg ._bbag < _geaeg ._fcag ;_aagb :=_geaeg ._gcfca > _geaeg ._fcag +_geaeg ._bbcf ;var _cfg ,_fde bool ;for _ ,_feb :=range _geaeg ._acge {for _ ,_fddd :=range _feb ._caafge {if _cef &&!_cfg {_cfg =_fddd ._caeb < 0;
};if _aagb &&!_fde {_fde =_geaeg ._bbcf < _fddd ._caeb +_fddd ._gegg ;};if _geaeg ._fcag +_fddd ._caeb >=_geaeg ._bbag &&_geaeg ._fcag +_fddd ._caeb +_fddd ._gegg <=_geaeg ._gcfca {_cba :=_abad ._gcdf .NewStyledParagraph ();_fda :=_cca +_geaeg ._fcag +_fddd ._caeb ;
_feag :=_adcg +_ada ._cddaa +_feb ._dbdc -_fddd ._cda -_gcfcc (0.5);_cba .SetPos (_fda ,_feag );var _egda *_g .TextChunk ;if _fddd ._gbab !=""{_egda =_cba .AddExternalLink (_fddd ._efc ,_fddd ._gbab );}else {_egda =_cba .Append (_fddd ._efc );};if _fddd ._eebc !=nil {_egda .Style =*_fddd ._eebc ;
};_abad ._gcdf .Draw (_cba );};};};var _adfb ,_ead ,_ebc ,_add ,_fgg ,_gba float64 ;var _aceb ,_acb ,_fdae ,_def _g .Color ;if _abeb :=_geaeg ._ecff ;_abeb !=nil {_adfb =_abeb ._cbgd ;_aceb =_abeb ._efbc ;};if _cffc :=_geaeg ._cbaa ;_cffc !=nil {_ead =_cffc ._cbgd ;
_acb =_cffc ._efbc ;};if _afbf :=_geaeg ._cad ;_afbf !=nil {_ebc =_afbf ._cbgd ;_fgg =_ebc /2;_fdae =_afbf ._efbc ;};if _ga :=_geaeg ._bfgf ;_ga !=nil {_add =_ga ._cbgd ;_gba =_add /2;_def =_ga ._efbc ;};var _fcc float64 ;if _cfd ._fade > 1{_fcc =_abad ._acc [_cfd ._fade -1]._acae ;
};_cdda :=_adcg +_ada ._cddaa -0.5*(_fcc -_adfb );_bab :=_adcg +_ada ._cddaa +_ada ._ebbf +0.5*(_ada ._acae +_ead );_cfed :=_cca +_geaeg ._fcag ;_cbdf :=_cfed +_geaeg ._cfbd ;_fbb .DrawLine (_abad ._gcdf ,_cfed ,_cdda ,_cbdf ,_cdda ,_adfb ,_aceb );_fbb .DrawLine (_abad ._gcdf ,_cfed ,_bab ,_cbdf ,_bab ,_ead ,_acb );
if !_cfg {_fbb .DrawLine (_abad ._gcdf ,_cfed -_fgg ,_cdda ,_cfed -_fgg ,_bab ,_ebc ,_fdae );};if !_fde {_fbb .DrawLine (_abad ._gcdf ,_cbdf -_gba ,_cdda ,_cbdf -_gba ,_bab ,_add ,_def );};};};for _ ,_dgf :=range _cfb ._dff {if _dgf !=nil {_abad ._gcdf .Draw (_dgf );
};};};func (_cgae *convertContext )makeMergedCells (){_ecf :=[]*mergedCell {};for _ ,_fgae :=range _cgae ._gefc .MergedCells (){_edg ,_aea ,_cff :=_ac .ParseRangeReference (_fgae .Reference ());if _cff !=nil {_fb .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_cff );
continue ;};_bef :=mergedCell {_accc :_edg .RowIdx ,_egca :_edg .ColumnIdx ,_fabd :_aea .RowIdx ,_gafa :_aea .ColumnIdx };for _aaf :=_bef ._egca -1;_aaf < _bef ._gafa ;_aaf ++{_bef ._gda +=_cgae ._agd [_aaf ]._ggbb ;};for _gef :=_bef ._accc -1;_gef < _bef ._fabd ;
_gef ++{_bef ._ebbfc +=_cgae ._acc [_gef ]._ebbf ;};_ecf =append (_ecf ,&_bef );};_cgae ._ddc =_ecf ;};type anchor struct{_gggd _f .Image ;_bgg *_ca .ChartSpace ;_fac int ;_bfa int64 ;_cadb int ;_aee int64 ;_cbfcg int ;_egfb int64 ;_cccb int ;_bed int64 ;
};func _bbfd (_aecb []*symbol )float64 {_dfd :=0.0;for _ ,_ddf :=range _aecb {if _ddf ._cda > _dfd {_dfd =_ddf ._cda ;};};return _dfd ;};type mergedCell struct{_accc uint32 ;_egca uint32 ;_fabd uint32 ;_gafa uint32 ;_gda float64 ;_ebbfc float64 ;};const _e =64.0;
func (_aceg *convertContext )imageFromAnchor (_cbg *anchor ,_acec ,_bbg float64 )_f .Image {if _cbg ._gggd !=nil {return _cbg ._gggd ;};if _cbg ._bgg !=nil {_cde ,_gbee :=_fbb .MakeImageFromChartSpace (_cbg ._bgg ,_acec ,_bbg ,_aceg ._ddfc ,_aceg ._cfcgb );
if _gbee !=nil {_fb .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_gbee );
return nil ;};return _cde ;};return nil ;};type line struct{_dbdc float64 ;_caafge []*symbol ;_bcac float64 ;};func (_fad *convertContext )drawSheet (_bec bool ){for _bfd ,_fcb :=range _fad ._bag {_fcg :=len (_fcb ._cegd );if _bfd ==len (_fad ._bag )-1{for _caba :=len (_fcb ._cegd )-1;
_caba >=0;_caba --{if !_fcb ._cegd [_caba ]._bada {_fcg =_caba ;};};};_fea :=_fcb ._cegd [:_fcg ];for _ ,_gge :=range _fea {_fad ._gcdf .NewPage ();if _bec {_fad ._gcdf .RotateDeg (270);};_fad .drawPage (_gge );};};};func (_abag *convertContext )getStyleFromCell (_dfabd _ad .Cell ,_dadgd ,_fedf *style )*style {_fcea :=_dfabd .X ();
_facb :=_abag .getStyle (_fcea .SAttr );_efec (_facb ,_dadgd );_efec (_facb ,_fedf );return _facb ;};const _cg =1.5;func (_dcgg *convertContext )getSymbolsFromString (_gcd string ,_bbea *style )[]*symbol {_cbbe :=[]*symbol {};_ggfd :=_dcgg .makeTextStyleFromCellStyle (_bbea );
for _ ,_ecae :=range _gcd {_cbbe =append (_cbbe ,&symbol {_efc :string (_ecae ),_eebc :_ggfd });};return _cbbe ;};const _da =15.0;const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;
);func (_efea *convertContext )getImage (_cgac _f .Image ,_gfbc ,_cdgd ,_edff ,_abga ,_acde ,_gde float64 ,_cbaf _fbb .ImgPart )*_g .Image {_abga +=_efea ._aeb ;_edff +=_efea ._dddc ;_dbbd ,_bgbg :=_fbb .GetImage (_efea ._gcdf ,_cgac ,_gfbc ,_cdgd ,_edff ,_abga ,_acde ,_gde ,_cbaf );
if _bgbg !=nil {_fb .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_bgbg );return nil ;};return _dbbd ;};func (_dbgg *convertContext )getStyle (_dged *uint32 )*style {_age :=&style {};
_dba :=false ;if _dged !=nil {_ddbe :=_dbgg ._cefe .GetCellStyle (*_dged );if _ddbe .GetFill ()!=nil &&_ddbe .GetFill ().PatternFill !=nil &&_ddbe .GetFill ().PatternFill .FgColor !=nil {_age ._bcf =_dbgg .getColorStringFromSmlColor (_ddbe .GetFill ().PatternFill .FgColor );
};_bbcbc :=_ddbe .GetFont ();for _ ,_dcccc :=range _bbcbc .Name {if _dcccc !=nil {_age ._gaf =&_dcccc .ValAttr ;_dba =true ;break ;};};for _ ,_acaeg :=range _bbcbc .B {if _acaeg !=nil {_bda :=_acaeg .ValAttr ==nil ||*_acaeg .ValAttr ;_age ._beg =&_bda ;
_dba =true ;break ;};};for _ ,_fbc :=range _bbcbc .I {if _fbc !=nil {_bga :=_fbc .ValAttr ==nil ||*_fbc .ValAttr ;_age ._bgbc =&_bga ;_dba =true ;break ;};};for _ ,_dbga :=range _bbcbc .U {if _dbga !=nil {_bade :=_dbga .ValAttr ==_gb .ST_UnderlineValuesSingle ||_dbga .ValAttr ==_gb .ST_UnderlineValuesUnset ;
_age ._abfa =&_bade ;_dba =true ;break ;};};for _ ,_eac :=range _bbcbc .Sz {if _eac !=nil {_baee :=_eac .ValAttr ;_age ._cede =&_baee ;_dba =true ;break ;};};for _ ,_cea :=range _bbcbc .VertAlign {if _cea !=nil {_ecaac :=_cea .ValAttr ==_df .ST_VerticalAlignRunSuperscript ;
_age ._ggcb =&_ecaac ;_bgga :=_cea .ValAttr ==_df .ST_VerticalAlignRunSubscript ;_age ._eaaf =&_bgga ;_dba =true ;break ;};};for _ ,_gfeb :=range _bbcbc .Color {if _gfeb !=nil {_age ._fafg =_dbgg .getColorStringFromSmlColor (_gfeb );_dba =true ;break ;
};};_fedg :=_ddbe .GetBorder ();if _fedg .Top !=nil {_age ._ffda =_dbgg .getBorder (_fedg .Top );_dba =true ;};if _fedg .Bottom !=nil {_age ._fega =_dbgg .getBorder (_fedg .Bottom );_dba =true ;};if _fedg .Left !=nil {_age ._cge =_dbgg .getBorder (_fedg .Left );
_dba =true ;};if _fedg .Right !=nil {_age ._eeg =_dbgg .getBorder (_fedg .Right );_dba =true ;};if _ddbe .Wrapped (){_age ._befg =true ;_dba =true ;};if _cbae :=_ddbe .GetVerticalAlignment ();_cbae !=_gb .ST_VerticalAlignmentUnset {_age ._aca =_cbae ;_dba =true ;
};if _becc :=_ddbe .GetHorizontalAlignment ();_becc !=_gb .ST_HorizontalAlignmentUnset {_age ._ddg =_becc ;_dba =true ;};};if _dba {return _age ;};return nil ;};func _gfd (_dgfc *bool )bool {return _dgfc !=nil &&*_dgfc };type symbol struct{_efc string ;
_caeb float64 ;_cda float64 ;_gegg float64 ;_eebc *_g .TextStyle ;_gbab string ;};func (_abe *convertContext )determineMaxIndexes (){var _dgd ,_fe int ;_dgd =int (_abe ._gefc .MaxColumnIdx ());_bac :=_abe ._gefc .Rows ();if len (_bac )> 0{_fe =int (_bac [len (_bac )-1].RowNumber ());
};for _ ,_aa :=range _abe ._acfg {if _aa ._cbfcg >=_fe {_fe =_aa ._cbfcg +1;};if _aa ._cccb >=_dgd {_dgd =_aa ._cccb +1;};};_abe ._bdbg =_fe ;_abe ._dee =_dgd ;};func (_dgea *convertContext )getContentFromCell (_gbgd *_ad .Sheet ,_bgb _ad .Cell ,_bce *style ,_gdg float64 ,_fgbc bool )([]*line ,_gb .ST_CellType ){_bffa :=_bgb .X ();
var _dfaa []*symbol ;switch _bffa .TAttr {case _gb .ST_CellTypeS :_gbc :=_bffa .V ;if _gbc !=nil {_bfdg ,_cbbf :=_d .Atoi (*_gbc );if _cbbf ==nil {_fbde :=_dgea ._cfcgb .SharedStrings .X ().Si [_bfdg ];if _fbde .T !=nil {_dfaa =_dgea .getSymbolsFromString (*_fbde .T ,_bce );
}else if _fbde .R !=nil {_dfaa =_dgea .getSymbolsFromR (_fbde .R ,_bce );};};};case _gb .ST_CellTypeB :_abf :=_bffa .V ;if _abf !=nil {if *_abf =="\u0030"{_dfaa =_dgea .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_bce );}else {_dfaa =_dgea .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_bce );
};};case _gb .ST_CellTypeStr :if _bffa .F !=nil {_geff :=_de .NewEvaluator ();_ffdf :=_gbgd .FormulaContext ().Cell (_bgb .Reference (),_geff );_dfaa =_dgea .getSymbolsFromString (_ffdf .Value (),_bce );};default:_dfaa =_dgea .getSymbolsFromString (_bgb .GetFormattedValue (),_bce );
};_bdc :=0.0;_fec :=0.0;var _dafa []*line ;var _acg bool ;if _bce !=nil {if _bce ._ggcb !=nil {if *_bce ._ggcb {_acg =true ;};};if _bce ._eaaf !=nil {if *_bce ._eaaf {_acg =true ;};};};if _fgbc {_dafa =[]*line {};_cfcg :=_gdg -2*_fa ;_cecd :=[]*symbol {};
for _ ,_bgd :=range _dfaa {_caafg (_bgd );if _bdc +_bgd ._gegg >=_cfcg {_bca :=_bbfd (_cecd );if _acg {_bca /=_gg ;};_dafa =append (_dafa ,&line {_dbdc :_fec ,_caafge :_cecd ,_bcac :_bca });_cecd =[]*symbol {_bgd };_bdc =_bgd ._gegg ;_fec +=_bca ;}else {_bgd ._caeb =_bdc ;
_bdc +=_bgd ._gegg ;_cecd =append (_cecd ,_bgd );};};_fab :=_bbfd (_cecd );if _acg {_fab /=_gg ;};if len (_cecd )> 0{_dafa =append (_dafa ,&line {_dbdc :_fec ,_caafge :_cecd ,_bcac :_fab });};}else {for _ ,_cfdg :=range _dfaa {_caafg (_cfdg );_cfdg ._caeb =_bdc ;
_bdc +=_cfdg ._gegg ;};if len (_dfaa )> 0{_dafa =[]*line {&line {_caafge :_dfaa ,_bcac :_bbfd (_dfaa )}};};};_dca :=_bffa .TAttr ;if _dca ==_gb .ST_CellTypeUnset {_dca =_gb .ST_CellTypeN ;};return _dafa ,_dca ;};func _efec (_gcc ,_fdee *style ){if _fdee ==nil {return ;
};if _gcc ==nil {_gcc =_fdee ;return ;};if _gcc ._bcf ==nil {_gcc ._bcf =_fdee ._bcf ;};if _gcc ._gaf ==nil {_gcc ._gaf =_fdee ._gaf ;};if _gcc ._fafg ==nil {_gcc ._fafg =_fdee ._fafg ;};if _gcc ._cede ==nil {_gcc ._cede =_fdee ._cede ;};if _gcc ._beg ==nil {_gcc ._beg =_fdee ._beg ;
};if _gcc ._bgbc ==nil {_gcc ._bgbc =_fdee ._bgbc ;};if _gcc ._abfa ==nil {_gcc ._abfa =_fdee ._abfa ;};if _gcc ._ggcb ==nil {_gcc ._ggcb =_fdee ._ggcb ;};if _gcc ._eaaf ==nil {_gcc ._eaaf =_fdee ._eaaf ;};if _gcc ._ffda ==nil {_gcc ._ffda =_fdee ._ffda ;
};if _gcc ._fega ==nil {_gcc ._fega =_fdee ._fega ;};if _gcc ._cge ==nil {_gcc ._cge =_fdee ._cge ;};if _gcc ._eeg ==nil {_gcc ._eeg =_fdee ._eeg ;};if _gcc ._aca ==_gb .ST_VerticalAlignmentUnset {_gcc ._aca =_fdee ._aca ;};if _gcc ._ddg ==_gb .ST_HorizontalAlignmentUnset {_gcc ._ddg =_fdee ._ddg ;
};};type pageRow struct{_fade int ;_aegb []*cell ;};var _ae =3.025/_gcfcc (1);