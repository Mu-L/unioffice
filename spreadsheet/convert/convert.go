//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_af "github.com/unidoc/unioffice/common/logger";_fc "github.com/unidoc/unioffice/common/tempstorage";_ab "github.com/unidoc/unioffice/internal/convertutils";_ag "github.com/unidoc/unioffice/measurement";_bc "github.com/unidoc/unioffice/schema/soo/dml";
_ac "github.com/unidoc/unioffice/schema/soo/dml/chart";_bcf "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_bcb "github.com/unidoc/unioffice/schema/soo/sml";_d "github.com/unidoc/unioffice/spreadsheet";_g "github.com/unidoc/unioffice/spreadsheet/formula";
_b "github.com/unidoc/unioffice/spreadsheet/reference";_fgf "github.com/unidoc/unipdf/v3/creator";_fe "github.com/unidoc/unipdf/v3/model";_ee "image";_f "math";_a "sort";_fg "strconv";);func (_acfg *convertContext )getColorFromTheme (_fbdg uint32 )string {_dgfa :=_acfg ._adgb .Themes ();
if len (_dgfa )!=0{_dgd :=_dgfa [0];if _cfda :=_dgd .ThemeElements ;_cfda !=nil {if _aaag :=_cfda .ClrScheme ;_aaag !=nil {switch _fbdg {case 0:return _ab .GetColorStringFromDmlColor (_aaag .Lt1 );case 1:return _ab .GetColorStringFromDmlColor (_aaag .Dk1 );
case 2:return _ab .GetColorStringFromDmlColor (_aaag .Lt2 );case 3:return _ab .GetColorStringFromDmlColor (_aaag .Dk2 );case 4:return _ab .GetColorStringFromDmlColor (_aaag .Accent1 );case 5:return _ab .GetColorStringFromDmlColor (_aaag .Accent2 );case 6:return _ab .GetColorStringFromDmlColor (_aaag .Accent3 );
case 7:return _ab .GetColorStringFromDmlColor (_aaag .Accent4 );case 8:return _ab .GetColorStringFromDmlColor (_aaag .Accent5 );case 9:return _ab .GetColorStringFromDmlColor (_aaag .Accent6 );};};};};return "";};type convertContext struct{_cee *_fgf .Creator ;
_adgb *_d .Workbook ;_fcbf *_bc .Theme ;_gfg *_d .Sheet ;_aea *_d .StyleSheet ;_gagg int ;_ceae int ;_ffcbf []*pagespan ;_ede *page ;_gaaa []*colInfo ;_ege []*rowInfo ;_dcae []*rowspan ;_dcbb float64 ;_acad float64 ;_eaba float64 ;_gcgc float64 ;_ceed []*mergedCell ;
_gbec []*anchor ;_agb float64 ;_gafg int ;_acae int ;_edc int ;_gbdd int ;_fddf bool ;_fabff []_d .Table ;};type rowInfo struct{_begd float64 ;_egeg bool ;_bfde float64 ;_ffa *style ;_beaa []*cell ;_fgdd float64 ;};func (_feca *convertContext )makePages (){for _ ,_cgce :=range _feca ._ffcbf {for _ ,_cfcc :=range _feca ._dcae {_cgce ._fdb =append (_cgce ._fdb ,&page {_cfd :[]*pageRow {},_bfe :_cgce ,_aacb :_cfcc });
};};};func (_geba *convertContext )getStyleFromCell (_eddg _d .Cell ,_bga ,_cbc ,_fgfc *style )*style {if _fgfc !=nil {_aafa (_fgfc ,_bga );_aafa (_fgfc ,_cbc );return _fgfc ;};_dbb :=_eddg .X ();_eaea :=_geba .getStyle (_dbb .SAttr );_aafa (_eaea ,_bga );
_aafa (_eaea ,_cbc );return _eaea ;};func (_egbd *convertContext )getDxfStyle (_gadb *uint32 )*style {_egbf :=&style {};_afgab :=false ;if _gadb !=nil {var _fcef *_bcb .CT_Dxf ;for _egee ,_dacg :=range _egbd ._aea .X ().Dxfs .Dxf {if uint32 (_egee )==*_gadb {_fcef =_dacg ;
};};if _fcef ==nil {return nil ;};if _fcef .Fill !=nil &&_fcef .Fill .PatternFill !=nil {if _fcef .Fill .PatternFill .FgColor !=nil {_egbf ._bgfe =_egbd .getColorStringFromSmlColor (_fcef .Fill .PatternFill .FgColor );}else if _fcef .Fill .PatternFill .BgColor !=nil {_egbf ._bgfe =_egbd .getColorStringFromSmlColor (_fcef .Fill .PatternFill .BgColor );
};};_bfda :=_fcef .Font ;for _ ,_caca :=range _bfda .Name {if _caca !=nil {_egbf ._bafe =&_caca .ValAttr ;_afgab =true ;break ;};};for _ ,_gbda :=range _bfda .B {if _gbda !=nil {_bagg :=_gbda .ValAttr ==nil ||*_gbda .ValAttr ;_egbf ._ceg =&_bagg ;_afgab =true ;
break ;};};for _ ,_agca :=range _bfda .I {if _agca !=nil {_ffg :=_agca .ValAttr ==nil ||*_agca .ValAttr ;_egbf ._cdab =&_ffg ;_afgab =true ;break ;};};for _ ,_fbb :=range _bfda .U {if _fbb !=nil {_bbdd :=_fbb .ValAttr ==_bcb .ST_UnderlineValuesSingle ||_fbb .ValAttr ==_bcb .ST_UnderlineValuesUnset ;
_egbf ._bcag =&_bbdd ;_afgab =true ;break ;};};for _ ,_bfc :=range _bfda .Sz {if _bfc !=nil {_cgdc :=_bfc .ValAttr ;_egbf ._gbdc =&_cgdc ;_afgab =true ;break ;};};for _ ,_cdf :=range _bfda .VertAlign {if _cdf !=nil {_eedf :=_cdf .ValAttr ==_bcf .ST_VerticalAlignRunSuperscript ;
_egbf ._ggab =&_eedf ;_afec :=_cdf .ValAttr ==_bcf .ST_VerticalAlignRunSubscript ;_egbf ._cefg =&_afec ;_afgab =true ;break ;};};for _ ,_ecdc :=range _bfda .Color {if _ecdc !=nil {_egbf ._decf =_egbd .getColorStringFromSmlColor (_ecdc );_afgab =true ;break ;
};};_afc :=_fcef .Border ;if _afc !=nil {if _afc .Top !=nil {_egbf ._gfdg =_egbd .getBorder (_afc .Top );_afgab =true ;};if _afc .Bottom !=nil {_egbf ._abcf =_egbd .getBorder (_afc .Bottom );_afgab =true ;};if _afc .Left !=nil {_egbf ._dgea =_egbd .getBorder (_afc .Left );
_afgab =true ;};if _afc .Right !=nil {_egbf ._eea =_egbd .getBorder (_afc .Right );_afgab =true ;};};if _fcef .Alignment !=nil {if _aff :=_fcef .Alignment .VerticalAttr ;_aff !=_bcb .ST_VerticalAlignmentUnset {_egbf ._eddc =_aff ;_afgab =true ;};if _gdca :=_fcef .Alignment .HorizontalAttr ;
_gdca !=_bcb .ST_HorizontalAlignmentUnset {_egbf ._fbcb =_gdca ;_afgab =true ;};};};if _afgab {return _egbf ;};return nil ;};func (_cc *convertContext )makeAnchors (){_cgc ,_deb :=_cc ._gfg .GetDrawing ();if _cgc !=nil {for _ ,_eae :=range _cgc .EG_Anchor {_eef :=&anchor {};
if _fca :=_eae .TwoCellAnchor ;_fca !=nil {_aeg ,_cbg :=_fca .From ,_fca .To ;if _aeg ==nil ||_cbg ==nil {return ;};_eef ._eaf =int (_aeg .Row );_eef ._cegb =_ab .FromSTCoordinate (_aeg .RowOff );_eef ._ebga =int (_aeg .Col );_eef ._def =_ab .FromSTCoordinate (_aeg .ColOff );
_eef ._bde =int (_cbg .Row );_eef ._eddcb =_ab .FromSTCoordinate (_cbg .RowOff );_eef ._ddb =int (_cbg .Col );_eef ._dabg =_ab .FromSTCoordinate (_cbg .ColOff );if _bd :=_fca .Choice ;_bd !=nil {if _dccf :=_bd .Pic ;_dccf !=nil {if _gga :=_dccf .BlipFill ;
_gga !=nil {if _geb :=_gga .Blip ;_geb !=nil {if _gbd :=_geb .EmbedAttr ;_gbd !=nil {for _ ,_cf :=range _deb .X ().Relationship {if _cf .IdAttr ==*_gbd {for _ ,_bdc :=range _cc ._adgb .Images {if _bdc .Target ()==_cf .TargetAttr {_ba ,_ded :=_fc .Open (_bdc .Path ());
if _ded !=nil {_af .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_ded );continue ;};_gc ,_ ,_ded :=_ee .Decode (_ba );if _ded !=nil {_af .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_ded );
continue ;};_eef ._cgbc =_gc ;};};};};};};};}else if _cgg :=_bd .GraphicFrame ;_cgg !=nil {if _eg :=_cgg .Graphic ;_eg !=nil {if _baf :=_eg .GraphicData ;_baf !=nil {for _ ,_dadb :=range _baf .Any {if _ed ,_cbb :=_dadb .(*_ac .Chart );_cbb {for _ ,_dee :=range _deb .X ().Relationship {if _dee .IdAttr ==_ed .IdAttr {_dgg :=_cc ._adgb .GetChartByTargetId (_dee .TargetAttr );
if _dgg !=nil {_eef ._acd =_dgg ;};};};};};};};};};};if _eef ._cgbc !=nil ||_eef ._acd !=nil {_cc ._gbec =append (_cc ._gbec ,_eef );};};};};func (_gef *convertContext )makeRows (){_aga :=[]*rowInfo {};_aae :=_gef ._gfg .Rows ();_ff :=0;_bda :=0.0;for _bec ,_fgd :=range _aae {if _bec < _gef ._edc ||(_bec > _gef ._gbdd &&_gef ._gbdd > 0){continue ;
};_ff ++;_fbc :=int (_fgd .RowNumber ());if _fbc > _ff {for _ca :=_ff ;_ca < _fbc ;_ca ++{_aga =append (_aga ,&rowInfo {_bfde :_ea /_ge });_bda +=_ea /_ge ;};_ff =_fbc ;};var _bafb float64 ;if _fgd .X ().HtAttr ==nil {_bafb =_ea ;}else {_bafb =*_fgd .X ().HtAttr ;
};_aga =append (_aga ,&rowInfo {_bfde :_bafb /_ge ,_egeg :true ,_ffa :_gef .getStyle (_fgd .X ().SAttr )});_bda +=_bafb /_ge ;};for _df :=len (_aga );_df < _gef ._gagg ;_df ++{_aga =append (_aga ,&rowInfo {_bfde :_ea /_ge });_bda +=_ea /_ge ;};if _gef ._fddf ||_bda > _gef ._eaba {for _ ,_dccc :=range _aga {_dccc ._bfde *=_gef ._agb ;
};};_gef ._ege =_aga ;};func (_dgf *convertContext )fillPages (){for _fag ,_gafc :=range _dgf ._dcae {_gbdbg :=_dgf ._ege [_gafc ._gagga :_gafc ._bgbg ];for _gac ,_debd :=range _gbdbg {_fbgd :=0;_abg :=0.0;_dfd :=[]*cell {};if _debd ._egeg {for _ ,_ceag :=range _debd ._beaa {_dbed :=_dgf ._ffcbf [_fbgd ];
_dgf ._ede =_dbed ._fdb [_fag ];_dgf ._ede ._fedg =true ;_fcf :=_ceag ._feabd ;if _abg +_fcf > _dbed ._gcgg {_dgf .addRowToPage (_dfd ,_gac );_dfd =[]*cell {_ceag };_abg =_fcf ;_fbgd ++;}else {_ceag ._ddg =_abg ;_dfd =append (_dfd ,_ceag );_abg +=_fcf ;
};};if len (_dfd )> 0{_eed :=_dgf ._ffcbf [_fbgd ];_dgf ._ede =_eed ._fdb [_fag ];_dgf ._ede ._fedg =true ;_dgf .addRowToPage (_dfd ,_gac );};};};};};type mergedCell struct{_aaf uint32 ;_abad uint32 ;_fgacg uint32 ;_accf uint32 ;_bag float64 ;_aefg float64 ;
};func (_efec *convertContext )getBorder (_eeb *_bcb .CT_BorderPr )*border {_gfdb :=&border {};switch _eeb .StyleAttr {case _bcb .ST_BorderStyleHair :_gfdb ._gae =_c /2;case _bcb .ST_BorderStyleThin :_gfdb ._gae =_c ;case _bcb .ST_BorderStyleMedium :_gfdb ._gae =_c *2;
case _bcb .ST_BorderStyleThick :_gfdb ._gae =_c *4;};if _gfdb ._gae ==0.0{return nil ;};if _ggec :=_eeb .Color ;_ggec !=nil {_fagd :=_efec .getColorStringFromSmlColor (_ggec );if _fagd !=nil {_gfdb ._fgfb =_fgf .ColorRGBFromHex (*_fagd );}else {_gfdb ._fgfb =_fgf .ColorBlack ;
};};return _gfdb ;};const _ea =15.0;func (_fed *convertContext )alignSymbolsVertically (_ecdf *cell ,_acgb _bcb .ST_VerticalAlignment ){var _eca float64 ;switch _acgb {case _bcb .ST_VerticalAlignmentTop :_eca =_gg ;if _ecdf ._gcbe {_eca -=_dca ;}else if _ecdf ._eceb {_eca +=4*_dca ;
};for _ ,_bca :=range _ecdf ._cfa {_eca +=_bca ._gbddc ;_bca ._daec =_eca ;_eca +=_fec ;};case _bcb .ST_VerticalAlignmentCenter :_bed :=0.0;for _ ,_bab :=range _ecdf ._cfa {_bed +=_bab ._gbddc +_bfeb (1);};_eca =0.5*(_ecdf ._cab -_bed );if _ecdf ._gcbe {_eca -=2*_dca ;
}else if _ecdf ._eceb {_eca +=2*_dca ;};for _ ,_cba :=range _ecdf ._cfa {_eca +=_cba ._gbddc +0.5*_fec ;_cba ._daec =_eca ;_eca +=0.5*_fec ;};default:_eca =_ecdf ._cab -_gg ;if _ecdf ._gcbe {_eca -=4*_dca ;}else if _ecdf ._eceb {_eca +=_dca ;};for _cdd :=len (_ecdf ._cfa )-1;
_cdd >=0;_cdd --{_ecdf ._cfa [_cdd ]._daec =_eca ;_eca -=_ecdf ._cfa [_cdd ]._gbddc ;_eca -=_fec ;};};};func (_cbgd *convertContext )makePagespans (){_cbgd ._ffcbf =[]*pagespan {};_gdbe :=0.0;_bcg :=0;for _aegd ,_eabe :=range _cbgd ._gaaa {_dec :=_eabe ._ebbg ;
if _gdbe +_dec <=_cbgd ._gcgc {_eabe ._fcd =_gdbe ;_gdbe +=_dec ;}else {_eabe ._fcd =0;_cbgd ._ffcbf =append (_cbgd ._ffcbf ,&pagespan {_gcgg :_gdbe ,_bba :_bcg ,_eccc :_aegd });_gdbe =_dec ;_bcg =_aegd ;};};_cbgd ._ffcbf =append (_cbgd ._ffcbf ,&pagespan {_gcgg :_gdbe ,_bba :_bcg ,_eccc :len (_cbgd ._gaaa )});
};type symbol struct{_bdfe string ;_adad float64 ;_fedge float64 ;_gcec float64 ;_dcca *_fgf .TextStyle ;_gcbeb string ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_ab .FontStyle ;type colInfo struct{_fcd float64 ;_ebbg float64 ;_aaee *style ;};var _c =_bfeb (0.0625);const _fa =0.25;func _cbe (_bcgg []*symbol )float64 {_cedd :=0.0;for _ ,_gcb :=range _bcgg {_cedd +=_gcb ._gcec ;};return _cedd ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _ab .RegisterFontsFromDirectory (dirName )};const _gg =2;func (_eefc *convertContext )makeTextStyleFromCellStyle (_ffaa *style )*_fgf .TextStyle {_cgdb :=_eefc ._cee .NewTextStyle ();if _ffaa ==nil {_cgdb .FontSize =_ab .DefaultFontSize ;
_cgdb .Font =_ab .AssignStdFontByName (_cgdb ,_ab .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_cgdb ;};if _bdfg (_ffaa ._bcag ){_cgdb .Underline =true ;_cgdb .UnderlineStyle =_fgf .TextDecorationLineStyle {Offset :0.5,Thickness :_bfeb (1/32)};
};var _adff FontStyle ;if _bdfg (_ffaa ._ceg )&&_bdfg (_ffaa ._cdab ){_adff =FontStyle_BoldItalic ;}else if _bdfg (_ffaa ._ceg ){_adff =FontStyle_Bold ;}else if _bdfg (_ffaa ._cdab ){_adff =FontStyle_Italic ;}else {_adff =FontStyle_Regular ;};_gaee :="\u0064e\u0066\u0061\u0075\u006c\u0074";
if _ffaa ._bafe !=nil {_gaee =*_ffaa ._bafe ;};if _agc ,_fgaa :=_ab .StdFontsMap [_gaee ];_fgaa {_cgdb .Font =_ab .AssignStdFontByName (_cgdb ,_agc [_adff ]);}else if _abgeg :=_ab .GetRegisteredFont (_gaee ,_adff );_abgeg !=nil {_cgdb .Font =_abgeg ;}else {_af .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_gaee ,_adff );
_cgdb .Font =_ab .AssignStdFontByName (_cgdb ,_ab .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_adff ]);};if _ffaa ._gbdc !=nil {_cgdb .FontSize =_f .Round (*_ffaa ._gbdc *_eefc ._agb );};if _ffaa ._decf !=nil {_cgdb .Color =_fgf .ColorRGBFromHex (*_ffaa ._decf );
};if _ffaa ._ggab !=nil &&*_ffaa ._ggab {_cgdb .FontSize *=_fgb ;}else if _ffaa ._cefg !=nil &&*_ffaa ._cefg {_cgdb .FontSize *=_fgb ;};return &_cgdb ;};var _gfae =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
type rowspan struct{_gcbb float64 ;_gagga int ;_bgbg int ;};type border struct{_gae float64 ;_fgfb _fgf .Color ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_d .Sheet )*_fgf .Creator {_fgbg :=s .X ();if _fgbg ==nil {return nil ;};var _fb _fgf .PageSize ;_cg :=true ;_eab :=false ;if _fgbg .SheetPr !=nil &&_fgbg .SheetPr .PageSetUpPr !=nil &&_fgbg .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_fgbg .SheetPr .PageSetUpPr .FitToPageAttr {_eab =true ;
};if _eec :=_fgbg .PageSetup ;_eec !=nil {_cg =_eec .OrientationAttr ==_bcb .ST_OrientationLandscape ;if _ef :=_eec .PaperSizeAttr ;_ef !=nil {_fb =_bfb [*_ef ];};};if (_fb ==_fgf .PageSize {}){_fb =_fgf .PageSizeA4 ;};if _cg {_fb [0],_fb [1]=_fb [1],_fb [0];
};_de :=_fgf .New ();_de .SetPageSize (_fb );var _eac ,_dcc ,_da ,_fce float64 ;if _fd :=_fgbg .PageMargins ;_fd !=nil {_da =_fd .LeftAttr ;_fce =_fd .RightAttr ;_eac =_fd .TopAttr ;_dcc =_fd .BottomAttr ;};if _da < _fa {_da =_fa ;};if _fce < _fa {_fce =_fa ;
};if _eac < _eb {_eac =_eb ;};if _dcc < _eb {_dcc =_eb ;};_eac *=_ag .Inch ;_dcc *=_ag .Inch ;_da *=_ag .Inch ;_fce *=_ag .Inch ;_de .SetPageMargins (_da ,_fce ,_eac ,_dcc );_dab :=s .Workbook ();var _fac *_bc .Theme ;if len (_dab .Themes ())> 0{_fac =_dab .Themes ()[0];
};var _gbg ,_gbe ,_dea ,_cb int ;for _ ,_fbd :=range _dab .DefinedNames (){if _fbd .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_gea ,_ad ,_gd ,_gf :=_ab .ParseExcelRange (_fbd .Content ());if _gf ==nil &&s .Name ()==_gea {_gbg =int (_ad .ColumnIdx );
_gbe =int (_gd .ColumnIdx );_dea =int (_ad .RowIdx );_cb =int (_gd .RowIdx );};};};_cbf :=[]_d .Table {};if _fgbg .TableParts !=nil &&_fgbg .TableParts .TablePart !=nil {_cga :=0;_ebe :=s .Workbook ().Tables ();_a .Slice (_ebe [:],func (_acb ,_dad int )bool {return _ebe [_acb ].X ().IdAttr < _ebe [_dad ].X ().IdAttr });
for _ ,_dcb :=range s .Workbook ().Sheets (){if _dcb .Name ()==s .Name (){break ;}else {if _dcb .X ().TableParts !=nil &&_dcb .X ().TableParts .TablePart !=nil {_cga +=len (_dcb .X ().TableParts .TablePart );};};};if len (_ebe )>=_cga +len (_fgbg .TableParts .TablePart ){_cbf =append (_cbf ,_ebe [_cga :_cga +len (_fgbg .TableParts .TablePart )]...);
};};_afg :=&convertContext {_cee :_de ,_gfg :s ,_adgb :s .Workbook (),_fcbf :_fac ,_aea :&s .Workbook ().StyleSheet ,_dcbb :_eac ,_acad :_da ,_eaba :_fb [1]-_dcc -_eac ,_gcgc :_fb [0]-_fce -_da ,_gafg :_gbg ,_acae :_gbe ,_edc :_dea ,_gbdd :_cb ,_fddf :_eab ,_fabff :_cbf };
_afg .makeAnchors ();_afg .determineMaxIndexes ();if _afg ._gagg ==0&&_afg ._ceae ==0{_de .NewPage ();return _de ;};_afg .makeCols ();_afg .makeRows ();_afg .makeMergedCells ();_afg .makeCells ();_afg .makePagespans ();_afg .makeRowspans ();_afg .makePages ();
_afg .fillPages ();_afg .distributeAnchors ();_afg .drawSheet ();return _de ;};const _gb =64.0;func (_agf *convertContext )distributeAnchors (){for _ ,_ggga :=range _agf ._gbec {_fegb ,_cecb :=_ggga ._eaf ,_ggga ._cegb ;_geg ,_gbeda :=_ggga ._ebga ,_ggga ._def ;
_add ,_gfeb :=_ggga ._bde ,_ggga ._eddcb ;_cda ,_edf :=_ggga ._ddb ,_ggga ._dabg ;if _fegb < _agf ._edc ||(_add > _agf ._gbdd &&_agf ._gbdd > 0){continue ;};if _geg < _agf ._gafg ||(_cda > _agf ._acae &&_agf ._acae > 0){continue ;};var _egbgc ,_fcff ,_gab ,_fabd *page ;
for _ ,_dcf :=range _agf ._ffcbf {for _ ,_cge :=range _dcf ._fdb {if _fegb >=_cge ._aacb ._gagga &&_fegb < _cge ._aacb ._bgbg {if _geg >=_cge ._bfe ._bba &&_geg < _cge ._bfe ._eccc {_cge ._fedg =true ;_egbgc =_cge ;};if _cda >=_cge ._bfe ._bba &&_cda < _cge ._bfe ._eccc {_cge ._fedg =true ;
_fcff =_cge ;};};if _add >=_cge ._aacb ._gagga &&_add < _cge ._aacb ._bgbg {if _geg >=_cge ._bfe ._bba &&_geg < _cge ._bfe ._eccc {_cge ._fedg =true ;_fabd =_cge ;};if _cda >=_cge ._bfe ._bba &&_cda < _cge ._bfe ._eccc {_cge ._fedg =true ;_gab =_cge ;};
};};};_ggf :=_egbgc !=_fcff ;_fcec :=_egbgc !=_fabd ;if _ggf &&_fcec {_cfbe :=_agf ._gaaa [_geg ]._fcd +_ag .FromEMU (_gbeda );_abgf :=_egbgc ._bfe ._gcgg ;_eaac :=_agf ._gaaa [_cda ]._fcd +_ag .FromEMU (_edf );_aca :=_agf ._ege [_fegb ]._begd +_ag .FromEMU (_cecb );
_abb :=float64 (_egbgc ._aacb ._gcbb );_dcce :=_agf ._ege [_add ]._begd +_ag .FromEMU (_gfeb );_abcb :=_eaac +_abgf -_cfbe ;_fbe :=_dcce +_abb -_aca ;_deea :=_agf .imageFromAnchor (_ggga ,_abcb ,_fbe );_egbgc ._fdga =append (_egbgc ._fdga ,_agf .getImage (_deea ,_fbe ,_abcb ,_cfbe ,_aca ,_abgf -_cfbe ,_abb -_aca ,_ab .ImgPart_lt ));
_fcff ._fdga =append (_fcff ._fdga ,_agf .getImage (_deea ,_fbe ,_abcb ,0,_aca ,_abgf -_cfbe ,_abb -_aca ,_ab .ImgPart_rt ));_fabd ._fdga =append (_fabd ._fdga ,_agf .getImage (_deea ,_fbe ,_abcb ,_cfbe ,0,_abgf -_cfbe ,_abb -_aca ,_ab .ImgPart_lb ));_gab ._fdga =append (_gab ._fdga ,_agf .getImage (_deea ,_fbe ,_abcb ,0,0,_abgf -_cfbe ,_abb -_aca ,_ab .ImgPart_rb ));
}else if _ggf {_ced :=_agf ._ege [_fegb ]._begd +_ag .FromEMU (_cecb );_acc :=_agf ._ege [_add ]._begd +_ag .FromEMU (_gfeb );_bcgc :=_agf ._gaaa [_geg ]._fcd +_ag .FromEMU (_gbeda );_abf :=_egbgc ._bfe ._gcgg ;_dbfb :=_agf ._gaaa [_cda ]._fcd +_ag .FromEMU (_edf );
_dcbe :=_dbfb +_abf -_bcgc ;_ffd :=_acc -_ced ;_cac :=_agf .imageFromAnchor (_ggga ,_dcbe ,_ffd );_egbgc ._fdga =append (_egbgc ._fdga ,_agf .getImage (_cac ,_ffd ,_dcbe ,_bcgc ,_ced ,_abf -_bcgc ,0,_ab .ImgPart_l ));_fcff ._fdga =append (_fcff ._fdga ,_agf .getImage (_cac ,_ffd ,_dcbe ,0,_ced ,_abf -_bcgc ,0,_ab .ImgPart_r ));
}else if _fcec {_eaab :=_agf ._gaaa [_geg ]._fcd +_ag .FromEMU (_gbeda );_feag :=_agf ._gaaa [_cda ]._fcd +_ag .FromEMU (_edf );_bce :=_agf ._ege [_fegb ]._begd +_ag .FromEMU (_cecb );_ebf :=float64 (_egbgc ._aacb ._gcbb );_age :=_agf ._ege [_add ]._begd +_ag .FromEMU (_gfeb );
_agd :=_feag -_eaab ;_fge :=_age +_ebf -_bce ;_dde :=_agf .imageFromAnchor (_ggga ,_agd ,_fge );_egbgc ._fdga =append (_egbgc ._fdga ,_agf .getImage (_dde ,_fge ,_agd ,_eaab ,_bce ,0,_ebf -_bce ,_ab .ImgPart_t ));_fabd ._fdga =append (_fabd ._fdga ,_agf .getImage (_dde ,_fge ,_agd ,_eaab ,0,0,_ebf -_bce ,_ab .ImgPart_b ));
}else {_ebd :=_agf ._gaaa [_geg ]._fcd +_ag .FromEMU (_gbeda );_baa :=_agf ._gaaa [_cda ]._fcd +_ag .FromEMU (_edf );_adg :=_agf ._ege [_fegb ]._begd +_ag .FromEMU (_cecb );_dcbg :=_agf ._ege [_add ]._begd +_ag .FromEMU (_gfeb );_gbc :=_baa -_ebd ;_bceg :=_dcbg -_adg ;
_aeb :=_agf .imageFromAnchor (_ggga ,_gbc ,_bceg );_egbgc ._fdga =append (_egbgc ._fdga ,_agf .getImage (_aeb ,_bceg ,_gbc ,_ebd ,_adg ,0,0,_ab .ImgPart_whole ));};};};func (_dgece *convertContext )getColorStringFromSmlColor (_dgbb *_bcb .CT_Color )*string {var _gcda string ;
if _dgbb .RgbAttr !=nil {_gcda =*_dgbb .RgbAttr ;}else if _dgbb .IndexedAttr !=nil &&*_dgbb .IndexedAttr < 64{_gcda =_gfae [*_dgbb .IndexedAttr ];}else if _dgbb .ThemeAttr !=nil {_fagb :=*_dgbb .ThemeAttr ;_gcda =_dgece .getColorFromTheme (_fagb );};if _gcda ==""{return nil ;
};if len (_gcda )> 6{_gcda =_gcda [(len (_gcda )-6):];};if _dgbb .TintAttr !=nil {_gagf :=*_dgbb .TintAttr ;_gcda =_ab .AdjustColorByTint (_gcda ,_gagf );};_gcda ="\u0023"+_gcda ;return &_gcda ;};func (_ceef *convertContext )getStyle (_bfed *uint32 )*style {_bcfe :=&style {};
_acadf :=false ;if _bfed !=nil {_cce :=_ceef ._aea .GetCellStyle (*_bfed );if _cce .GetFill ()!=nil &&_cce .GetFill ().PatternFill !=nil {if _cce .GetFill ().PatternFill .FgColor !=nil {_bcfe ._bgfe =_ceef .getColorStringFromSmlColor (_cce .GetFill ().PatternFill .FgColor );
}else if _cce .GetFill ().PatternFill .BgColor !=nil {_bcfe ._bgfe =_ceef .getColorStringFromSmlColor (_cce .GetFill ().PatternFill .BgColor );};};_fcaa :=_cce .GetFont ();for _ ,_bdgc :=range _fcaa .Name {if _bdgc !=nil {_bcfe ._bafe =&_bdgc .ValAttr ;
_acadf =true ;break ;};};for _ ,_acf :=range _fcaa .B {if _acf !=nil {_gfb :=_acf .ValAttr ==nil ||*_acf .ValAttr ;_bcfe ._ceg =&_gfb ;_acadf =true ;break ;};};for _ ,_eff :=range _fcaa .I {if _eff !=nil {_fda :=_eff .ValAttr ==nil ||*_eff .ValAttr ;_bcfe ._cdab =&_fda ;
_acadf =true ;break ;};};for _ ,_egd :=range _fcaa .U {if _egd !=nil {_ggb :=_egd .ValAttr ==_bcb .ST_UnderlineValuesSingle ||_egd .ValAttr ==_bcb .ST_UnderlineValuesUnset ;_bcfe ._bcag =&_ggb ;_acadf =true ;break ;};};for _ ,_aeag :=range _fcaa .Sz {if _aeag !=nil {_aab :=_aeag .ValAttr ;
_bcfe ._gbdc =&_aab ;_acadf =true ;break ;};};for _ ,_debc :=range _fcaa .VertAlign {if _debc !=nil {_gabe :=_debc .ValAttr ==_bcf .ST_VerticalAlignRunSuperscript ;_bcfe ._ggab =&_gabe ;_becf :=_debc .ValAttr ==_bcf .ST_VerticalAlignRunSubscript ;_bcfe ._cefg =&_becf ;
_acadf =true ;break ;};};for _ ,_gacc :=range _fcaa .Color {if _gacc !=nil {_bcfe ._decf =_ceef .getColorStringFromSmlColor (_gacc );_acadf =true ;break ;};};_fgfge :=_cce .GetBorder ();if _fgfge .Top !=nil {_bcfe ._gfdg =_ceef .getBorder (_fgfge .Top );
_acadf =true ;};if _fgfge .Bottom !=nil {_bcfe ._abcf =_ceef .getBorder (_fgfge .Bottom );_acadf =true ;};if _fgfge .Left !=nil {_bcfe ._dgea =_ceef .getBorder (_fgfge .Left );_acadf =true ;};if _fgfge .Right !=nil {_bcfe ._eea =_ceef .getBorder (_fgfge .Right );
_acadf =true ;};if _cce .Wrapped (){_bcfe ._febg =true ;_acadf =true ;};if _dffb :=_cce .GetVerticalAlignment ();_dffb !=_bcb .ST_VerticalAlignmentUnset {_bcfe ._eddc =_dffb ;_acadf =true ;};if _baff :=_cce .GetHorizontalAlignment ();_baff !=_bcb .ST_HorizontalAlignmentUnset {_bcfe ._fbcb =_baff ;
_acadf =true ;};};if _acadf {return _bcfe ;};return nil ;};const _fgb =0.64;type cell struct{_gbeg _bcb .ST_CellType ;_fbfc int ;_ddg float64 ;_cfa []*line ;_efab float64 ;_feabd float64 ;_cab float64 ;_bdb float64 ;_eaef float64 ;_gge *_fgf .TextStyle ;
_agef *border ;_bebb *border ;_ccdc *border ;_fceb *border ;_gcbe bool ;_eceb bool ;_gfgf _fgf .Color ;};func (_fbf *convertContext )makeCols (){_bf :=_fbf ._gfg ;_be :=_bf .X ();_dd :=[]*colInfo {};_abc :=[]colWidthRange {};if _ce :=_be .Cols ;len (_ce )> 0{for _ ,_dadd :=range _ce [0].Col {_fbff :=_gb ;
if _bgb :=_dadd .WidthAttr ;_bgb !=nil {if *_bgb > 0.83{*_bgb -=0.83;};if *_bgb <=1{_fbff =*_bgb *11;}else {_fbff =5+*_bgb *6;};};_cgcc :=int (_dadd .MinAttr -1);_cgac :=int (_dadd .MaxAttr -1);_abc =append (_abc ,colWidthRange {_edb :_cgcc ,_edbb :_cgac ,_fgbf :_fbff ,_fad :_fbf .getStyle (_dadd .StyleAttr )});
};};_ddf :=0;for _ebb :=0;_ebb <=_fbf ._ceae ;_ebb ++{if _ebb < _fbf ._gafg ||(_ebb > _fbf ._acae &&_fbf ._acae > 0){continue ;};var _dae float64 ;var _gdd *style ;if _ddf >=len (_abc ){_dae =_gb ;}else {_afa :=_abc [_ddf ];if _ebb >=_afa ._edb &&_ebb <=_afa ._edbb {_dae =_afa ._fgbf ;
_gdd =_afa ._fad ;if _ebb ==_afa ._edbb {_ddf ++;};}else {_dae =_gb ;};};_dd =append (_dd ,&colInfo {_ebbg :_dae ,_aaee :_gdd });};_gda :=0.0;for _ ,_fcb :=range _dd {_gda +=_fcb ._ebbg ;};_fbf ._agb =1.0;if _gda > _fbf ._gcgc {_fbf ._agb =_fbf ._gcgc /_gda ;
for _ ,_aag :=range _dd {_aag ._ebbg *=_fbf ._agb ;};};_fbf ._gaaa =_dd ;};func (_eba *convertContext )drawPage (_bdf *page ){_cgb :=_eba ._dcbb ;_dgga :=_eba ._acad ;for _ ,_dcab :=range _bdf ._cfd {_gfd :=_eba ._ege [_dcab ._afga ];for _ ,_bbd :=range _dcab ._afeb {var _fff float64 ;
if _dcab ._afga > 1{_fff =_eba ._ege [_dcab ._afga -1]._fgdd ;};var _ccfg ,_cbbc float64 ;if _ccb :=_bbd ._agef ;_ccb !=nil {_ccfg =_ccb ._gae ;};if _aegb :=_bbd ._bebb ;_aegb !=nil {_cbbc =_aegb ._gae ;};_dcfe :=_cgb +_gfd ._begd -0.5*(_fff -_ccfg );_gcd :=_cgb +_gfd ._begd +_gfd ._bfde +0.5*(_gfd ._fgdd +_cbbc );
_cgd :=_dgga +_bbd ._ddg ;_bfd :=_cgd +_bbd ._feabd ;if _bbd ._gfgf !=nil &&_bbd ._gfgf !=_fgf .ColorBlack {_ab .FillRectangle (_eba ._cee ,_cgd ,_dcfe ,_bfd -_cgd ,_gcd -_dcfe ,_bbd ._gfgf );};};};for _ ,_dcaa :=range _bdf ._cfd {_gddb :=_eba ._ege [_dcaa ._afga ];
for _ ,_afb :=range _dcaa ._afeb {_ace :=_afb ._bdb < _afb ._ddg ;_geac :=_afb ._eaef > _afb ._ddg +_afb ._efab ;var _daf ,_dggaa bool ;for _ ,_dcfd :=range _afb ._cfa {for _ ,_bcc :=range _dcfd ._adf {if _ace &&!_daf {_daf =_bcc ._adad < 0;};if _geac &&!_dggaa {_dggaa =_afb ._efab < _bcc ._adad +_bcc ._gcec ;
};if _afb ._ddg +_bcc ._adad >=_afb ._bdb &&_afb ._ddg +_bcc ._adad +_bcc ._gcec <=_afb ._eaef {_eabd :=_eba ._cee .NewStyledParagraph ();_deda :=_dgga +_afb ._ddg +_bcc ._adad ;_gad :=_cgb +_gddb ._begd +_dcfd ._daec -_bcc ._fedge -_bfeb (0.5);_eabd .SetPos (_deda ,_gad );
var _gebf *_fgf .TextChunk ;if _bcc ._gcbeb !=""{_gebf =_eabd .AddExternalLink (_bcc ._bdfe ,_bcc ._gcbeb );}else {_gebf =_eabd .Append (_bcc ._bdfe );};if _bcc ._dcca !=nil {_gebf .Style =*_bcc ._dcca ;};_eba ._cee .Draw (_eabd );};};};var _agdc ,_bgd ,_efda ,_fgfg ,_egf ,_facg float64 ;
var _gcaa ,_bgf ,_agdf ,_ecc _fgf .Color ;if _afe :=_afb ._agef ;_afe !=nil {_agdc =_afe ._gae ;_gcaa =_afe ._fgfb ;};if _dagd :=_afb ._bebb ;_dagd !=nil {_bgd =_dagd ._gae ;_bgf =_dagd ._fgfb ;};if _aagag :=_afb ._ccdc ;_aagag !=nil {_efda =_aagag ._gae ;
_egf =_efda /2;_agdf =_aagag ._fgfb ;};if _dffa :=_afb ._fceb ;_dffa !=nil {_fgfg =_dffa ._gae ;_facg =_fgfg /2;_ecc =_dffa ._fgfb ;};var _ggad float64 ;if _dcaa ._afga > 1{_ggad =_eba ._ege [_dcaa ._afga -1]._fgdd ;};_bac :=_cgb +_gddb ._begd -0.5*(_ggad -_agdc );
_edd :=_cgb +_gddb ._begd +_gddb ._bfde +0.5*(_gddb ._fgdd +_bgd );_dcfec :=_dgga +_afb ._ddg ;_ddc :=_dcfec +_afb ._feabd ;_ab .DrawLine (_eba ._cee ,_dcfec ,_bac ,_ddc ,_bac ,_agdc ,_gcaa );_ab .DrawLine (_eba ._cee ,_dcfec ,_edd ,_ddc ,_edd ,_bgd ,_bgf );
if !_daf {_ab .DrawLine (_eba ._cee ,_dcfec -_egf ,_bac ,_dcfec -_egf ,_edd ,_efda ,_agdf );};if !_dggaa {_ab .DrawLine (_eba ._cee ,_ddc -_facg ,_bac ,_ddc -_facg ,_edd ,_fgfg ,_ecc );};};};for _ ,_faga :=range _bdf ._fdga {if _faga !=nil {_eba ._cee .Draw (_faga );
};};};func (_dcag *convertContext )getContentFromCell (_fdd *_d .Sheet ,_ebg _d .Cell ,_gded *style ,_adb float64 ,_eede bool )([]*line ,_bcb .ST_CellType ){_bcbe :=_ebg .X ();var _dafe []*symbol ;switch _bcbe .TAttr {case _bcb .ST_CellTypeS :_deac :=_bcbe .V ;
if _deac !=nil {_bea ,_acg :=_fg .Atoi (*_deac );if _acg ==nil {_bafbf :=_dcag ._adgb .SharedStrings .X ().Si [_bea ];if _bafbf .T !=nil {_dafe =_dcag .getSymbolsFromString (*_bafbf .T ,_gded );}else if _bafbf .R !=nil {_dafe =_dcag .getSymbolsFromR (_bafbf .R ,_gded );
};};};case _bcb .ST_CellTypeB :_gff :=_bcbe .V ;if _gff !=nil {if *_gff =="\u0030"{_dafe =_dcag .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_gded );}else {_dafe =_dcag .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_gded );};};case _bcb .ST_CellTypeStr :if _bcbe .F !=nil {_gcc :=_g .NewEvaluator ();
_afd :=_fdd .FormulaContext ().Cell (_ebg .Reference (),_gcc );_dafe =_dcag .getSymbolsFromString (_afd .Value (),_gded );};default:_dafe =_dcag .getSymbolsFromString (_ebg .GetFormattedValue (),_gded );};_agee :=0.0;_aace :=0.0;var _cef []*line ;var _dac bool ;
if _gded !=nil {if _gded ._ggab !=nil {if *_gded ._ggab {_dac =true ;};};if _gded ._cefg !=nil {if *_gded ._cefg {_dac =true ;};};};if _eede {_cef =[]*line {};_ccd :=_adb -2*_dc ;_cdef :=[]*symbol {};for _ ,_dgbg :=range _dafe {_aagb (_dgbg );if _agee +_dgbg ._gcec >=_ccd {_abge :=_dffaa (_cdef );
if _dac {_abge /=_fgb ;};_cef =append (_cef ,&line {_daec :_aace ,_adf :_cdef ,_gbddc :_abge });_cdef =[]*symbol {_dgbg };_agee =_dgbg ._gcec ;_aace +=_abge ;}else {_dgbg ._adad =_agee ;_agee +=_dgbg ._gcec ;_cdef =append (_cdef ,_dgbg );};};_bfa :=_dffaa (_cdef );
if _dac {_bfa /=_fgb ;};if len (_cdef )> 0{_cef =append (_cef ,&line {_daec :_aace ,_adf :_cdef ,_gbddc :_bfa });};}else {for _ ,_acba :=range _dafe {_aagb (_acba );_acba ._adad =_agee ;_agee +=_acba ._gcec ;};if len (_dafe )> 0{_cef =[]*line {&line {_adf :_dafe ,_gbddc :_dffaa (_dafe )}};
};};_deg :=_bcbe .TAttr ;if _deg ==_bcb .ST_CellTypeUnset {_deg =_bcb .ST_CellTypeN ;};return _cef ,_deg ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_dff *convertContext )drawSheet (){for _aba ,_ccff :=range _dff ._ffcbf {_gcef :=len (_ccff ._fdb );
if _aba ==len (_dff ._ffcbf )-1{for _dead :=len (_ccff ._fdb )-1;_dead >=0;_dead --{if !_ccff ._fdb [_dead ]._fedg {_gcef =_dead ;};};};_aaga :=_ccff ._fdb [:_gcef ];for _ ,_gca :=range _aaga {_dff ._cee .NewPage ();_dff .drawPage (_gca );};};};func (_eeg *convertContext )getStyleFromRPrElt (_fabfe *_bcb .CT_RPrElt )*style {if _fabfe ==nil {return nil ;
};_ecg :=&style {};_ecg ._bafe =&_fabfe .RFont .ValAttr ;if _aee :=_fabfe .B ;_aee !=nil {_bdfaa :=_aee .ValAttr ==nil ||*_aee .ValAttr ;_ecg ._ceg =&_bdfaa ;};if _ccfgb :=_fabfe .I ;_ccfgb !=nil {_gcfg :=_ccfgb .ValAttr ==nil ||*_ccfgb .ValAttr ;_ecg ._cdab =&_gcfg ;
};if _ffac :=_fabfe .U ;_ffac !=nil {_ccfa :=_ffac .ValAttr ==_bcb .ST_UnderlineValuesSingle ||_ffac .ValAttr ==_bcb .ST_UnderlineValuesUnset ;_ecg ._bcag =&_ccfa ;};if _dfdd :=_fabfe .VertAlign ;_dfdd !=nil {_deff :=_dfdd .ValAttr ==_bcf .ST_VerticalAlignRunSuperscript ;
_ecg ._ggab =&_deff ;_bgdb :=_dfdd .ValAttr ==_bcf .ST_VerticalAlignRunSubscript ;_ecg ._cefg =&_bgdb ;};if _fcdf :=_fabfe .Sz ;_fcdf !=nil {_gdad :=_fcdf .ValAttr ;_ecg ._gbdc =&_gdad ;};if _bafee :=_fabfe .Color ;_bafee !=nil {_ecg ._decf =_eeg .getColorStringFromSmlColor (_bafee );
};return _ecg ;};func (_gag *convertContext )getSymbolsFromR (_bebe []*_bcb .CT_RElt ,_dbg *style )[]*symbol {_aaaa :=[]*symbol {};for _ ,_gdc :=range _bebe {_baab :=_gag .combineCellStyleWithRPrElt (_dbg ,_gdc .RPr );for _ ,_ffb :=range _gdc .T {_aaaa =append (_aaaa ,&symbol {_bdfe :string (_ffb ),_dcca :_gag .makeTextStyleFromCellStyle (_baab )});
};};return _aaaa ;};func (_dbgc *convertContext )alignSymbolsHorizontally (_aacc *cell ,_ceb _bcb .ST_HorizontalAlignment ){if _ceb ==_bcb .ST_HorizontalAlignmentUnset {switch _aacc ._gbeg {case _bcb .ST_CellTypeB :_ceb =_bcb .ST_HorizontalAlignmentCenter ;
case _bcb .ST_CellTypeN :_ceb =_bcb .ST_HorizontalAlignmentRight ;default:_ceb =_bcb .ST_HorizontalAlignmentLeft ;};};var _egg float64 ;for _ ,_bbbd :=range _aacc ._cfa {switch _ceb {case _bcb .ST_HorizontalAlignmentLeft :_egg =_dc ;case _bcb .ST_HorizontalAlignmentRight :_dgfe :=_cbe (_bbbd ._adf );
_egg =_aacc ._efab -_dc -_dgfe ;case _bcb .ST_HorizontalAlignmentCenter :_cecf :=_cbe (_bbbd ._adf );_egg =(_aacc ._efab -_cecf )/2;};for _ ,_eggb :=range _bbbd ._adf {_eggb ._adad +=_egg ;};};};func (_geaae *convertContext )combineCellStyleWithRPrElt (_ccbd *style ,_ecaf *_bcb .CT_RPrElt )*style {_gdaa :=*_ccbd ;
_fcg :=_geaae .getStyleFromRPrElt (_ecaf );if _fcg ==nil {return &_gdaa ;};if _fcg ._decf !=nil {_gdaa ._decf =_fcg ._decf ;};if _fcg ._gbdc !=nil {_gdaa ._gbdc =_fcg ._gbdc ;};if _fcg ._bafe !=nil {_gdaa ._bafe =_fcg ._bafe ;};if _fcg ._ceg !=nil {_gdaa ._ceg =_fcg ._ceg ;
};if _fcg ._cdab !=nil {_gdaa ._cdab =_fcg ._cdab ;};if _fcg ._bcag !=nil {_gdaa ._bcag =_fcg ._bcag ;};if _fcg ._ggab !=nil {_gdaa ._ggab =_fcg ._ggab ;};if _fcg ._cefg !=nil {_gdaa ._cefg =_fcg ._cefg ;};return &_gdaa ;};func (_fbdf *convertContext )makeMergedCells (){_dgb :=[]*mergedCell {};
for _ ,_dbf :=range _fbdf ._gfg .MergedCells (){_cad ,_egb ,_aef :=_b .ParseRangeReference (_dbf .Reference ());if _aef !=nil {_af .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_aef );
continue ;};_cae :=mergedCell {_aaf :_cad .RowIdx ,_abad :_cad .ColumnIdx ,_fgacg :_egb .RowIdx ,_accf :_egb .ColumnIdx };for _dfc :=_cae ._abad -1;_dfc < _cae ._accf ;_dfc ++{_cae ._bag +=_fbdf ._gaaa [_dfc ]._ebbg ;};for _cec :=_cae ._aaf -1;_cec < _cae ._fgacg ;
_cec ++{_cae ._aefg +=_fbdf ._ege [_cec ]._bfde ;};_dgb =append (_dgb ,&_cae );};_fbdf ._ceed =_dgb ;};func _aagb (_cfe *symbol ){_ecd :=_fgf .New ();_bdfc :=_ecd .NewStyledParagraph ();_bdfc .SetMargins (0,0,0,0);_cag :=_bdfc .Append (_cfe ._bdfe );if _cfe ._dcca !=nil {_cag .Style =*_cfe ._dcca ;
};_cfe ._fedge =_bdfc .Height ();if _cfe ._gcec ==0{_cfe ._gcec =_bdfc .Width ();};};var _ge =3.025/_bfeb (1);const _eb =0.0;type colWidthRange struct{_edb int ;_edbb int ;_fgbf float64 ;_fad *style ;};func (_bg *convertContext )determineMaxIndexes (){var _ga ,_gde int ;
_ga =int (_bg ._gfg .MaxColumnIdx ());_dag :=_bg ._gfg .Rows ();if len (_dag )> 0{_gde =int (_dag [len (_dag )-1].RowNumber ());};for _ ,_ccc :=range _bg ._gbec {if _ccc ._bde >=_gde {_gde =_ccc ._bde +1;};if _ccc ._ddb >=_ga {_ga =_ccc ._ddb +1;};};_bg ._gagg =_gde ;
_bg ._ceae =_ga ;};func _bdfg (_ddac *bool )bool {return _ddac !=nil &&*_ddac };var _fec =_bfeb (1);func (_aaaf *convertContext )getSymbolsFromString (_dgec string ,_caed *style )[]*symbol {_cbfa :=[]*symbol {};_dgfd :=_aaaf .makeTextStyleFromCellStyle (_caed );
for _ ,_abcd :=range _dgec {_cbfa =append (_cbfa ,&symbol {_bdfe :string (_abcd ),_dcca :_dgfd });};return _cbfa ;};func (_fdgd *convertContext )imageFromAnchor (_ddfa *anchor ,_deeb ,_cbec float64 )_ee .Image {if _ddfa ._cgbc !=nil {return _ddfa ._cgbc ;
};if _ddfa ._acd !=nil {_aed ,_efc :=_ab .MakeImageFromChartSpace (_ddfa ._acd ,_deeb ,_cbec ,_fdgd ._fcbf ,_fdgd ._adgb );if _efc !=nil {_af .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_efc );
return nil ;};return _aed ;};return nil ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_fe .PdfFont ){_ab .RegisterFont (name ,style ,font );};type pagespan struct{_gcgg float64 ;_fdb []*page ;_bba int ;_eccc int ;};const _dca =1.5;type anchor struct{_cgbc _ee .Image ;_acd *_ac .ChartSpace ;
_eaf int ;_cegb int64 ;_ebga int ;_def int64 ;_bde int ;_eddcb int64 ;_ddb int ;_dabg int64 ;};func (_dbgg *convertContext )getImage (_afdc _ee .Image ,_bdg ,_bee ,_bfgf ,_cca ,_dcbd ,_gdcf float64 ,_caf _ab .ImgPart )*_fgf .Image {_cca +=_dbgg ._dcbb ;
_bfgf +=_dbgg ._acad ;_cgbd ,_gffa :=_ab .GetImage (_dbgg ._cee ,_afdc ,_bdg ,_bee ,_bfgf ,_cca ,_dcbd ,_gdcf ,_caf );if _gffa !=nil {_af .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_gffa );
return nil ;};return _cgbd ;};func (_bef *convertContext )addRowToPage (_ffcb []*cell ,_beg int ){_cacf :=0.0;_fabf :=_bef ._gcgc ;for _ ,_cccb :=range _ffcb {if len (_cccb ._cfa )!=0{_cccb ._bdb =_cacf ;_cacf =_cccb ._ddg +_cccb ._efab ;};};for _dge :=len (_ffcb )-1;
_dge >=0;_dge --{_dada :=_ffcb [_dge ];if len (_dada ._cfa )!=0{_dada ._eaef =_fabf ;_fabf =_dada ._ddg ;};};_bef ._ede ._cfd =append (_bef ._ede ._cfd ,&pageRow {_afga :_beg ,_afeb :_ffcb });};type pageRow struct{_afga int ;_afeb []*cell ;};type line struct{_daec float64 ;
_adf []*symbol ;_gbddc float64 ;};var _bfb =map[uint32 ]_fgf .PageSize {1:_fgf .PageSize {8.5*_ag .Inch ,11*_ag .Inch },2:_fgf .PageSize {8.5*_ag .Inch ,11*_ag .Inch },3:_fgf .PageSize {11*_ag .Inch ,17*_ag .Inch },4:_fgf .PageSize {17*_ag .Inch ,11*_ag .Inch },5:_fgf .PageSize {8.5*_ag .Inch ,14*_ag .Inch },6:_fgf .PageSize {5.5*_ag .Inch ,8.5*_ag .Inch },7:_fgf .PageSize {7.5*_ag .Inch ,10*_ag .Inch },8:_fgf .PageSize {_bfeb (297),_bfeb (420)},9:_fgf .PageSize {_bfeb (210),_bfeb (297)},10:_fgf .PageSize {_bfeb (210),_bfeb (297)},11:_fgf .PageSize {_bfeb (148),_bfeb (210)},70:_fgf .PageSize {_bfeb (105),_bfeb (148)},12:_fgf .PageSize {_bfeb (250),_bfeb (354)},13:_fgf .PageSize {_bfeb (182),_bfeb (257)},14:_fgf .PageSize {8.5*_ag .Inch ,13*_ag .Inch },20:_fgf .PageSize {4.125*_ag .Inch ,9.5*_ag .Inch },27:_fgf .PageSize {_bfeb (110),_bfeb (220)},28:_fgf .PageSize {_bfeb (162),_bfeb (229)},34:_fgf .PageSize {_bfeb (250),_bfeb (176)},29:_fgf .PageSize {_bfeb (324),_bfeb (458)},30:_fgf .PageSize {_bfeb (229),_bfeb (324)},31:_fgf .PageSize {_bfeb (114),_bfeb (162)},37:_fgf .PageSize {3.88*_ag .Inch ,7.5*_ag .Inch },43:_fgf .PageSize {_bfeb (100),_bfeb (148)},69:_fgf .PageSize {_bfeb (200),_bfeb (148)}};
type page struct{_cfd []*pageRow ;_fedg bool ;_fdga []*_fgf .Image ;_bfe *pagespan ;_aacb *rowspan ;};func _bfeb (_cbad float64 )float64 {return _cbad *_ag .Millimeter };func _dffaa (_fee []*symbol )float64 {_gdf :=0.0;for _ ,_gfa :=range _fee {if _gfa ._fedge > _gdf {_gdf =_gfa ._fedge ;
};};return _gdf ;};func _aafa (_deee ,_gec *style ){if _gec ==nil {return ;};if _deee ==nil {_deee =_gec ;return ;};if _deee ._bgfe ==nil {_deee ._bgfe =_gec ._bgfe ;};if _deee ._bafe ==nil {_deee ._bafe =_gec ._bafe ;};if _deee ._decf ==nil {_deee ._decf =_gec ._decf ;
};if _deee ._gbdc ==nil {_deee ._gbdc =_gec ._gbdc ;};if _deee ._ceg ==nil {_deee ._ceg =_gec ._ceg ;};if _deee ._cdab ==nil {_deee ._cdab =_gec ._cdab ;};if _deee ._bcag ==nil {_deee ._bcag =_gec ._bcag ;};if _deee ._ggab ==nil {_deee ._ggab =_gec ._ggab ;
};if _deee ._cefg ==nil {_deee ._cefg =_gec ._cefg ;};if _deee ._gfdg ==nil {_deee ._gfdg =_gec ._gfdg ;};if _deee ._abcf ==nil {_deee ._abcf =_gec ._abcf ;};if _deee ._dgea ==nil {_deee ._dgea =_gec ._dgea ;};if _deee ._eea ==nil {_deee ._eea =_gec ._eea ;
};if _deee ._eddc ==_bcb .ST_VerticalAlignmentUnset {_deee ._eddc =_gec ._eddc ;};if _deee ._fbcb ==_bcb .ST_HorizontalAlignmentUnset {_deee ._fbcb =_gec ._fbcb ;};};const _dc =3;func (_dgba *convertContext )makeRowspans (){var _efe float64 ;_bebg :=0;
for _ece ,_cfb :=range _dgba ._ege {_fab :=_cfb ._bfde +_cfb ._fgdd ;if _efe +_fab <=_dgba ._eaba {_cfb ._begd =_efe ;_efe +=_fab ;}else {_dgba ._dcae =append (_dgba ._dcae ,&rowspan {_gcbb :_efe ,_gagga :_bebg ,_bgbg :_ece });_bebg =_ece ;_cfb ._begd =0;
_efe =_fab ;};};_dgba ._dcae =append (_dgba ._dcae ,&rowspan {_gcbb :_efe ,_gagga :_bebg ,_bgbg :len (_dgba ._ege )});};func (_gcg *convertContext )makeCells (){_gbdb :=_gcg ._gfg ;_eaa :=_gbdb .Rows ();_aad :=0;for _dda ,_ddfg :=range _gcg ._ege {if _dda < _gcg ._edc ||(_dda > _gcg ._gbdd &&_gcg ._gbdd > 0){continue ;
};_ddfg ._beaa =[]*cell {};_cfc :=0.0;_fbfb :=_ddfg ._ffa ;if _ddfg ._egeg {_gfe :=_eaa [_aad ];_aad ++;_aac :=_ddfg ._bfde ;for _ ,_bb :=range _gfe .Cells (){_feab ,_dbc :=_b .ParseCellReference (_bb .Reference ());if _dbc !=nil {_af .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_dbc );
continue ;};if int (_feab .ColumnIdx )< _gcg ._gafg ||(int (_feab .ColumnIdx )> _gcg ._acae &&_gcg ._acae > 0){continue ;};_dga :=_gcg ._gaaa [_feab .ColumnIdx ];_bbe :=_dga ._ebbg ;_cea :=_bbe ;_eabc :=_dga ._aaee ;var _bdd ,_daba ,_cff ,_egbc bool ;for _ ,_gdea :=range _gcg ._ceed {if _feab .RowIdx >=_gdea ._aaf &&_feab .RowIdx <=_gdea ._fgacg &&_feab .ColumnIdx >=_gdea ._abad &&_feab .ColumnIdx <=_gdea ._accf {if _feab .ColumnIdx ==_gdea ._abad &&_feab .RowIdx ==_gdea ._aaf {_bbe =_gdea ._bag ;
_aac =_gdea ._aefg ;};_bdd =_feab .RowIdx !=_gdea ._aaf ;_daba =_feab .RowIdx !=_gdea ._fgacg ;_cff =_feab .ColumnIdx !=_gdea ._abad ;_egbc =_feab .ColumnIdx !=_gdea ._accf ;};};var _ged *style ;for _ ,_efa :=range _gcg ._fabff {_aacd ,_gbed ,_fafg :=_b .ParseRangeReference (_efa .Reference ());
if _fafg !=nil ||_aacd .RowIdx > _feab .RowIdx ||_aacd .ColumnIdx > _feab .ColumnIdx ||_gbed .RowIdx < _feab .RowIdx ||_gbed .ColumnIdx < _feab .ColumnIdx ||_gcg ._adgb .StyleSheet .X ().TableStyles ==nil {continue ;};_gce :=_feab .RowIdx ==_aacd .RowIdx ;
for _ ,_ec :=range _gcg ._adgb .StyleSheet .X ().TableStyles .TableStyle {if _efa .X ().TableStyleInfo .NameAttr !=nil &&_ec .NameAttr ==*_efa .X ().TableStyleInfo .NameAttr {for _ ,_agac :=range _ec .TableStyleElement {if !_gce &&_agac .TypeAttr ==_bcb .ST_TableStyleTypeWholeTable {_ged =_gcg .getDxfStyle (_agac .DxfIdAttr );
};if _gce &&_agac .TypeAttr ==_bcb .ST_TableStyleTypeHeaderRow {_ged =_gcg .getDxfStyle (_agac .DxfIdAttr );};};};};};_fdf :=_gcg .getStyleFromCell (_bb ,_fbfb ,_eabc ,_ged );var _ggd ,_gaf ,_bfg bool ;var _dbe ,_gaa ,_dba ,_abd *border ;var _ffc _bcb .ST_VerticalAlignment ;
var _feg _bcb .ST_HorizontalAlignment ;if _fdf !=nil {if !_bdd {_dbe =_fdf ._gfdg ;};if !_daba {_gaa =_fdf ._abcf ;};if !_cff {_dba =_fdf ._dgea ;};if !_egbc {_abd =_fdf ._eea ;};if _gaa !=nil &&_gaa ._gae > _cfc {_cfc =_gaa ._gae ;};_ffc =_fdf ._eddc ;
_feg =_fdf ._fbcb ;if _fdf ._ggab !=nil {_ggd =*_fdf ._ggab ;};if _fdf ._cefg !=nil {_gaf =*_fdf ._cefg ;};_bfg =_fdf ._febg ;};var _beb _fgf .Color ;if _fdf !=nil &&_fdf ._bgfe !=nil {_beb =_fgf .ColorRGBFromHex (*_fdf ._bgfe );};_egbg ,_fbgf :=_gcg .getContentFromCell (_gbdb ,_bb ,_fdf ,_bbe ,_bfg );
_fef :=&cell {_gbeg :_fbgf ,_efab :_bbe ,_feabd :_cea ,_cab :_aac ,_cfa :_egbg ,_agef :_dbe ,_bebb :_gaa ,_ccdc :_dba ,_fceb :_abd ,_gcbe :_ggd ,_eceb :_gaf ,_gfgf :_beb };_gcg .alignSymbolsHorizontally (_fef ,_feg );_gcg .alignSymbolsVertically (_fef ,_ffc );
_ddfg ._beaa =append (_ddfg ._beaa ,_fef );};};_ddfg ._fgdd =_cfc ;};};type style struct{_bgfe *string ;_decf *string ;_gbdc *float64 ;_bafe *string ;_ceg *bool ;_cdab *bool ;_bcag *bool ;_ggab *bool ;_cefg *bool ;_gfdg *border ;_abcf *border ;_dgea *border ;
_eea *border ;_febg bool ;_eddc _bcb .ST_VerticalAlignment ;_fbcb _bcb .ST_HorizontalAlignment ;};