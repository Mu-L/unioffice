//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_dg "github.com/unidoc/unioffice/v2/common/logger";_gc "github.com/unidoc/unioffice/v2/common/tempstorage";_b "github.com/unidoc/unioffice/v2/internal/convertutils";_cc "github.com/unidoc/unioffice/v2/measurement";_ab "github.com/unidoc/unioffice/v2/schema/soo/dml";
_g "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_ef "github.com/unidoc/unioffice/v2/schema/soo/ofc/sharedTypes";_ca "github.com/unidoc/unioffice/v2/schema/soo/sml";_cb "github.com/unidoc/unioffice/v2/spreadsheet";_fd "github.com/unidoc/unioffice/v2/spreadsheet/formula";
_da "github.com/unidoc/unioffice/v2/spreadsheet/reference";_c "github.com/unidoc/unipdf/v4/creator";_ee "github.com/unidoc/unipdf/v4/model";_f "image";_a "math";_d "sort";_ec "strconv";);type pagespan struct{_fbd float64 ;_ggd []*page ;_aead int ;_bdfa int ;
};const _fc =0.64;func (_cbg *convertContext )makeCols (){_gdcc :=_cbg ._dgbg ;_dgb :=_gdcc .X ();_aac :=[]*colInfo {};_cbda :=[]colWidthRange {};if _aab :=_dgb .Cols ;len (_aab )> 0{for _ ,_decg :=range _aab [0].Col {_fa :=_ed ;if _baa :=_decg .WidthAttr ;
_baa !=nil {if *_baa > 0.83{*_baa -=0.83;};if *_baa <=1{_fa =*_baa *11;}else {_fa =5+*_baa *6;};};_dac :=int (_decg .MinAttr -1);_ced :=int (_decg .MaxAttr -1);_cbda =append (_cbda ,colWidthRange {_cfeg :_dac ,_ddeaf :_ced ,_cebc :_fa ,_ffff :_cbg .getStyle (_decg .StyleAttr )});
};};_dbd :=0;for _dbca :=0;_dbca <=_cbg ._cdfa ;_dbca ++{if _dbca < _cbg ._bbc ||(_dbca > _cbg ._ecgg &&_cbg ._ecgg > 0){continue ;};var _bcf float64 ;var _abd *style ;if len (_cbda )==0{_bcf =_ed ;}else if _dbd < len (_cbda ){_ded :=_cbda [_dbd ];if _dbca >=_ded ._cfeg &&_dbca <=_ded ._ddeaf {_bcf =_ded ._cebc ;
_abd =_ded ._ffff ;if _dbca ==_ded ._ddeaf {_dbd ++;};}else {continue ;};};_aac =append (_aac ,&colInfo {_ecfa :_bcf ,_ccbf :_abd });};_baf :=0.0;for _ ,_ecg :=range _aac {_baf +=_ecg ._ecfa ;};_cbg ._dee =1.0;if _baf > _cbg ._eaag {_cbg ._dee =_cbg ._eaag /_baf ;
for _ ,_afe :=range _aac {_afe ._ecfa *=_cbg ._dee ;};};_cbg ._gcbe =_aac ;};func (_cab *convertContext )makeRowspans (){var _gabf float64 ;_gegc :=0;for _adc ,_cda :=range _cab ._fbae {_feed :=_cda ._bgdc +_cda ._bbca ;if _gabf +_feed <=_cab ._egd {_cda ._eafa =_gabf ;
_gabf +=_feed ;}else {_cab ._cbc =append (_cab ._cbc ,&rowspan {_cdac :_gabf ,_bec :_gegc ,_bgb :_adc });_gegc =_adc ;_cda ._eafa =0;_gabf =_feed ;};};_cab ._cbc =append (_cab ._cbc ,&rowspan {_cdac :_gabf ,_bec :_gegc ,_bgb :len (_cab ._fbae )});};const _eed =0.25;
var _de =_geaf (0.0625);const _eea =3;func (_face *convertContext )imageFromAnchor (_bea *anchor ,_ceac ,_bagg float64 )_f .Image {if _bea ._bbga !=nil {return _bea ._bbga ;};if _bea ._dge !=nil {_gdcb ,_fagb :=_b .MakeImageFromChartSpace (_bea ._dge ,_ceac ,_bagg ,_face ._cece ,_face ._gebe );
if _fagb !=nil {_dg .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_fagb );
return nil ;};return _gdcb ;};return nil ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_cb .Sheet )*_c .Creator {return ConvertToPdfWithOptions (s ,nil )};func (_aed *convertContext )makePages (){for _ ,_dca :=range _aed ._ade {for _ ,_afb :=range _aed ._cbc {_dca ._ggd =append (_dca ._ggd ,&page {_bdef :[]*pageRow {},_dbcg :_dca ,_ebe :_afb });
};};};type anchor struct{_bbga _f .Image ;_dge *_g .ChartSpace ;_dcef int ;_efa int64 ;_gaee int ;_fabc int64 ;_egcd int ;_eafb int64 ;_ceaca int ;_caf int64 ;};func (_fad *convertContext )alignSymbolsHorizontally (_bdf *cell ,_bcae _ca .ST_HorizontalAlignment ){if _bcae ==_ca .ST_HorizontalAlignmentUnset {switch _bdf ._ggg {case _ca .ST_CellTypeB :_bcae =_ca .ST_HorizontalAlignmentCenter ;
case _ca .ST_CellTypeN :_bcae =_ca .ST_HorizontalAlignmentRight ;default:_bcae =_ca .ST_HorizontalAlignmentLeft ;};};var _aef float64 ;for _ ,_fdc :=range _bdf ._ggfg {switch _bcae {case _ca .ST_HorizontalAlignmentLeft :_aef =_eea ;case _ca .ST_HorizontalAlignmentRight :_abdc :=_bcg (_fdc ._fedfd );
_aef =_bdf ._caca -_eea -_abdc ;case _ca .ST_HorizontalAlignmentCenter :_cagg :=_bcg (_fdc ._fedfd );_aef =(_bdf ._caca -_cagg )/2;};for _ ,_agde :=range _fdc ._fedfd {_agde ._beg +=_aef ;};};};func _bcg (_gdb []*symbol )float64 {_gae :=0.0;for _ ,_bdaa :=range _gdb {_gae +=_bdaa ._geed ;
};return _gae ;};func _ceaf (_ddbd *symbol ){_dag :=_c .New ();_edaf :=_dag .NewStyledParagraph ();_edaf .SetMargins (0,0,0,0);_cfed :=_edaf .Append (_ddbd ._aefb );if _ddbd ._bfdf !=nil {_cfed .Style =*_ddbd ._bfdf ;};_ddbd ._eafc =_edaf .Height ();if _ddbd ._geed ==0{_ddbd ._geed =_edaf .Width ();
};};type symbol struct{_aefb string ;_beg float64 ;_eafc float64 ;_geed float64 ;_bfdf *_c .TextStyle ;_affc string ;};func (_gdg *convertContext )getContentFromCell (_gacd *_cb .Sheet ,_aeab _cb .Cell ,_aeaa *style ,_bgd float64 ,_ffb ,_agd bool )([]*line ,_ca .ST_CellType ){if _agd {return []*line {},_ca .ST_CellTypeS ;
};_ggfc :=_aeab .X ();var _bddf []*symbol ;switch _ggfc .TAttr {case _ca .ST_CellTypeS :_fac :=_ggfc .V ;if _fac !=nil {_abbf ,_gdf :=_ec .Atoi (*_fac );if _gdf ==nil {_gfff :=_gdg ._gebe .SharedStrings .X ().Si [_abbf ];if _gfff .T !=nil {_bddf =_gdg .getSymbolsFromString (*_gfff .T ,_aeaa );
}else if _gfff .R !=nil {_bddf =_gdg .getSymbolsFromR (_gfff .R ,_aeaa );};};};case _ca .ST_CellTypeB :_agc :=_ggfc .V ;if _agc !=nil {if *_agc =="\u0030"{_bddf =_gdg .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_aeaa );}else {_bddf =_gdg .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_aeaa );
};};case _ca .ST_CellTypeStr :if _ggfc .F !=nil {_cfc :=_fd .NewEvaluator ();_eef :=_gacd .FormulaContext ().Cell (_aeab .Reference (),_cfc );_bddf =_gdg .getSymbolsFromString (_eef .Value (),_aeaa );};default:_bddf =_gdg .getSymbolsFromString (_aeab .GetFormattedValue (),_aeaa );
};_dced :=0.0;_eda :=0.0;var _gfc []*line ;var _gcaf bool ;if _aeaa !=nil {if _aeaa ._aacc !=nil {if *_aeaa ._aacc {_gcaf =true ;};};if _aeaa ._fbf !=nil {if *_aeaa ._fbf {_gcaf =true ;};};};if _ffb {_gfc =[]*line {};_bba :=_bgd -2*_eea ;_cfbc :=[]*symbol {};
for _ ,_acec :=range _bddf {_ceaf (_acec );if _dced +_acec ._geed >=_bba {_agfg :=_baba (_cfbc );if _gcaf {_agfg /=_fc ;};_gfc =append (_gfc ,&line {_cdbb :_eda ,_fedfd :_cfbc ,_aeebd :_agfg });_cfbc =[]*symbol {_acec };_dced =_acec ._geed ;_eda +=_agfg ;
}else {_acec ._beg =_dced ;_dced +=_acec ._geed ;_cfbc =append (_cfbc ,_acec );};};_feb :=_baba (_cfbc );if _gcaf {_feb /=_fc ;};if len (_cfbc )> 0{_gfc =append (_gfc ,&line {_cdbb :_eda ,_fedfd :_cfbc ,_aeebd :_feb });};}else {for _ ,_gebg :=range _bddf {_ceaf (_gebg );
_gebg ._beg =_dced ;_dced +=_gebg ._geed ;};if len (_bddf )> 0{_gfc =[]*line {&line {_fedfd :_bddf ,_aeebd :_baba (_bddf )}};};};_agce :=_ggfc .TAttr ;if _agce ==_ca .ST_CellTypeUnset {_agce =_ca .ST_CellTypeN ;};return _gfc ,_agce ;};const _db =1.5;var _fdf =3.025/_geaf (1);
type rowInfo struct{_eafa float64 ;_dcff bool ;_bgdc float64 ;_gec *style ;_dcffd []*cell ;_bbca float64 ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_b .FontStyle ;func (_edbe *convertContext )getStyle (_bfa *uint32 )*style {_gffb :=&style {};_bbde :=false ;if _bfa !=nil {_dccg :=_edbe ._gea .GetCellStyle (*_bfa );if _edbe ._gea .GetNumberFormat (_dccg .NumberFormat ()).GetFormat ()=="\u003b\u003b\u003b"{_gffb ._gdba =true ;
};_eada :=_dccg .GetFill ();if _eada !=nil &&_eada .FillChoice !=nil &&_eada .FillChoice .PatternFill !=nil {if _eada .FillChoice .PatternFill .FgColor !=nil {_gffb ._edfa =_edbe .getColorStringFromSmlColor (_eada .FillChoice .PatternFill .FgColor );}else if _eada .FillChoice .PatternFill .BgColor !=nil {_gffb ._edfa =_edbe .getColorStringFromSmlColor (_eada .FillChoice .PatternFill .BgColor );
};};_fffc :=_dccg .GetFont ();for _ ,_ecgf :=range _fffc .FontChoice {if _ecgf .Name !=nil {_gffb ._aeec =&_ecgf .Name .ValAttr ;_bbde =true ;}else if _ecgf .B !=nil {_fbfb :=_ecgf .B .ValAttr ==nil ||*_ecgf .B .ValAttr ;_gffb ._egfd =&_fbfb ;_bbde =true ;
}else if _ecgf .I !=nil {_ceea :=_ecgf .I .ValAttr ==nil ||*_ecgf .I .ValAttr ;_gffb ._eacb =&_ceea ;_bbde =true ;}else if _ecgf .U !=nil {_bacg :=_ecgf .U .ValAttr ==_ca .ST_UnderlineValuesSingle ||_ecgf .U .ValAttr ==_ca .ST_UnderlineValuesUnset ;_gffb ._ebca =&_bacg ;
_bbde =true ;}else if _ecgf .Sz !=nil {_bcgd :=_ecgf .Sz .ValAttr ;_gffb ._ecb =&_bcgd ;_bbde =true ;}else if _ecgf .VertAlign !=nil {_fgeg :=_ecgf .VertAlign .ValAttr ==_ef .ST_VerticalAlignRunSuperscript ;_gffb ._aacc =&_fgeg ;_cggga :=_ecgf .VertAlign .ValAttr ==_ef .ST_VerticalAlignRunSubscript ;
_gffb ._fbf =&_cggga ;_bbde =true ;}else if _ecgf .Color !=nil {_gffb ._bgbe =_edbe .getColorStringFromSmlColor (_ecgf .Color );_bbde =true ;};};_bbae :=_dccg .GetBorder ();if _bbae .Top !=nil {_gffb ._fedfe =_edbe .getBorder (_bbae .Top );_bbde =true ;
};if _bbae .Bottom !=nil {_gffb ._cfce =_edbe .getBorder (_bbae .Bottom );_bbde =true ;};if _bbae .Left !=nil {_gffb ._ddec =_edbe .getBorder (_bbae .Left );_bbde =true ;};if _bbae .Right !=nil {_gffb ._ceec =_edbe .getBorder (_bbae .Right );_bbde =true ;
};if _dccg .Wrapped (){_gffb ._dfa =true ;_bbde =true ;};if _cebe :=_dccg .GetVerticalAlignment ();_cebe !=_ca .ST_VerticalAlignmentUnset {_gffb ._gad =_cebe ;_bbde =true ;};if _fea :=_dccg .GetHorizontalAlignment ();_fea !=_ca .ST_HorizontalAlignmentUnset {_gffb ._bccb =_fea ;
_bbde =true ;};};if _bbde {return _gffb ;};return nil ;};func (_abeg *convertContext )addRowToPage (_cggg []*cell ,_eddg int ){_acb :=0.0;_bed :=_abeg ._eaag ;for _ ,_cgc :=range _cggg {if len (_cgc ._ggfg )!=0{_cgc ._abdb =_acb ;_acb =_cgc ._ccaa +_cgc ._caca ;
};};for _ada :=len (_cggg )-1;_ada >=0;_ada --{_ceb :=_cggg [_ada ];if len (_ceb ._ggfg )!=0{_ceb ._gfce =_bed ;_bed =_ceb ._ccaa ;};};_abeg ._cgb ._bdef =append (_abeg ._cgb ._bdef ,&pageRow {_abde :_eddg ,_abca :_cggg });};func (_ddea *convertContext )drawPage (_adcf *page ){_ccb :=_ddea ._afec ;
_bab :=_ddea ._egcc ;for _ ,_afbd :=range _adcf ._bdef {_cdc :=_ddea ._fbae [_afbd ._abde ];for _ ,_abb :=range _afbd ._abca {var _gfeg float64 ;if _afbd ._abde > 1{_gfeg =_ddea ._fbae [_afbd ._abde -1]._bbca ;};var _aff ,_aacgd float64 ;if _fcgg :=_abb ._fec ;
_fcgg !=nil {_aff =_fcgg ._ccgb ;};if _gcd :=_abb ._aagg ;_gcd !=nil {_aacgd =_gcd ._ccgb ;};_gafg :=_ccb +_cdc ._eafa -0.5*(_gfeg -_aff );_abcg :=_ccb +_cdc ._eafa +_cdc ._bgdc +0.5*(_cdc ._bbca +_aacgd );_decf :=_bab +_abb ._ccaa ;_egge :=_decf +_abb ._adgb ;
if _abb ._cebg !=nil &&_abb ._cebg !=_c .ColorBlack {_b .FillRectangle (_ddea ._ead ,_decf ,_gafg ,_egge -_decf ,_abcg -_gafg ,_abb ._cebg );};};};for _ ,_abga :=range _adcf ._bdef {_dcg :=_ddea ._fbae [_abga ._abde ];for _ ,_egf :=range _abga ._abca {_bbg :=_egf ._abdb < _egf ._ccaa ;
_daeb :=_egf ._gfce > _egf ._ccaa +_egf ._caca ;var _cdcc ,_dcb bool ;for _ ,_gcbg :=range _egf ._ggfg {for _ ,_abbe :=range _gcbg ._fedfd {if _bbg &&!_cdcc {_cdcc =_abbe ._beg < 0;};if _daeb &&!_dcb {_dcb =_egf ._caca < _abbe ._beg +_abbe ._geed ;};if _egf ._ccaa +_abbe ._beg >=_egf ._abdb &&_egf ._ccaa +_abbe ._beg +_abbe ._geed <=_egf ._gfce {_fdfa :=_ddea ._ead .NewStyledParagraph ();
_dcaa :=_bab +_egf ._ccaa +_abbe ._beg ;_ebg :=_ccb +_dcg ._eafa +_gcbg ._cdbb -_abbe ._eafc -_geaf (0.5);_fdfa .SetPos (_dcaa ,_ebg );var _bda *_c .TextChunk ;if _abbe ._affc !=""{_bda =_fdfa .AddExternalLink (_abbe ._aefb ,_abbe ._affc );}else {_bda =_fdfa .Append (_abbe ._aefb );
};if _abbe ._bfdf !=nil {_bda .Style =*_abbe ._bfdf ;};_ddea ._ead .Draw (_fdfa );};};};var _fdad ,_bdgfg ,_gbbb ,_fcbe ,_feea ,_acad float64 ;var _ace ,_adg ,_dedd ,_bcdd _c .Color ;if _ffe :=_egf ._fec ;_ffe !=nil {_fdad =_ffe ._ccgb ;_ace =_ffe ._agbe ;
};if _ffa :=_egf ._aagg ;_ffa !=nil {_bdgfg =_ffa ._ccgb ;_adg =_ffa ._agbe ;};if _efd :=_egf ._fbgd ;_efd !=nil {_gbbb =_efd ._ccgb ;_feea =_gbbb /2;_dedd =_efd ._agbe ;};if _cfb :=_egf ._bef ;_cfb !=nil {_fcbe =_cfb ._ccgb ;_acad =_fcbe /2;_bcdd =_cfb ._agbe ;
};var _cdba float64 ;if _abga ._abde > 1{_cdba =_ddea ._fbae [_abga ._abde -1]._bbca ;};_aeg :=_ccb +_dcg ._eafa -0.5*(_cdba -_fdad );_bcc :=_ccb +_dcg ._eafa +_dcg ._bgdc +0.5*(_dcg ._bbca +_bdgfg );_eeed :=_bab +_egf ._ccaa ;_aacf :=_eeed +_egf ._adgb ;
_b .DrawLine (_ddea ._ead ,_eeed ,_aeg ,_aacf ,_aeg ,_fdad ,_ace );_b .DrawLine (_ddea ._ead ,_eeed ,_bcc ,_aacf ,_bcc ,_bdgfg ,_adg );if !_cdcc {_b .DrawLine (_ddea ._ead ,_eeed -_feea ,_aeg ,_eeed -_feea ,_bcc ,_gbbb ,_dedd );};if !_dcb {_b .DrawLine (_ddea ._ead ,_aacf -_acad ,_aeg ,_aacf -_acad ,_bcc ,_fcbe ,_bcdd );
};};};for _ ,_daab :=range _adcf ._dbgb {if _daab !=nil {_ddea ._ead .Draw (_daab );};};};type cell struct{_ggg _ca .ST_CellType ;_fgce int ;_ccaa float64 ;_ggfg []*line ;_caca float64 ;_adgb float64 ;_ccbg float64 ;_abdb float64 ;_gfce float64 ;_dcaab *_c .TextStyle ;
_fec *border ;_aagg *border ;_fbgd *border ;_bef *border ;_aged bool ;_cge bool ;_cebg _c .Color ;};type page struct{_bdef []*pageRow ;_gcad bool ;_dbgb []*_c .Image ;_dbcg *pagespan ;_ebe *rowspan ;};const _af =2;func (_ccf *convertContext )makeAnchors (){_fcge ,_cec :=_ccf ._dgbg .GetDrawing ();
if _fcge !=nil {for _ ,_egc :=range _fcge .EG_Anchor {_ddd :=&anchor {};if _bg :=_egc .AnchorChoice .TwoCellAnchor ;_bg !=nil {_gdd ,_fb :=_bg .From ,_bg .To ;if _gdd ==nil ||_fb ==nil {return ;};_ddd ._dcef =int (_gdd .Row );_ddd ._efa =_b .FromSTCoordinate (_gdd .RowOff );
_ddd ._gaee =int (_gdd .Col );_ddd ._fabc =_b .FromSTCoordinate (_gdd .ColOff );_ddd ._egcd =int (_fb .Row );_ddd ._eafb =_b .FromSTCoordinate (_fb .RowOff );_ddd ._ceaca =int (_fb .Col );_ddd ._caf =_b .FromSTCoordinate (_fb .ColOff );if _eba :=_bg .ObjectChoicesChoice ;
_eba !=nil {if _age :=_eba .Pic ;_age !=nil {if _gac :=_age .BlipFill ;_gac !=nil {if _dab :=_gac .Blip ;_dab !=nil {if _abc :=_dab .EmbedAttr ;_abc !=nil {for _ ,_bbd :=range _cec .X ().Relationship {if _bbd .IdAttr ==*_abc {for _ ,_bd :=range _ccf ._gebe .Images {if _bd .Target ()==_bbd .TargetAttr {_dae ,_bdg :=_gc .Open (_bd .Path ());
if _bdg !=nil {_dg .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_bdg );continue ;};_ac ,_ ,_bdg :=_f .Decode (_dae );if _bdg !=nil {_dg .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_bdg );
continue ;};_ddd ._bbga =_ac ;};};};};};};};}else if _cgd :=_eba .GraphicFrame ;_cgd !=nil {if _eee :=_cgd .Graphic ;_eee !=nil {if _dec :=_eee .GraphicData ;_dec !=nil {for _ ,_dgd :=range _dec .Any {if _gge ,_egb :=_dgd .(*_g .Chart );_egb {for _ ,_gff :=range _cec .X ().Relationship {if _gff .IdAttr ==_gge .IdAttr {_gab :=_ccf ._gebe .GetChartByTargetId (_gff .TargetAttr );
if _gab !=nil {_ddd ._dge =_gab ;};};};};};};};};};};if _ddd ._bbga !=nil ||_ddd ._dge !=nil {_ccf ._facb =append (_ccf ._facb ,_ddd );};};};};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_ee .PdfFont ){_b .RegisterFont (name ,style ,font );};func (_fgdg *convertContext )getStyleFromCell (_fged _cb .Cell ,_gcc ,_bgff ,_beef *style )*style {if _beef !=nil {_cedbd (_beef ,_gcc );_cedbd (_beef ,_bgff );
return _beef ;};_bad :=_fged .X ();_bege :=_fgdg .getStyle (_bad .SAttr );_cedbd (_bege ,_gcc );_cedbd (_bege ,_bgff );return _bege ;};func (_gfbg *convertContext )getColorStringFromSmlColor (_dccgb *_ca .CT_Color )*string {var _bcec string ;if _dccgb .RgbAttr !=nil {_bcec =*_dccgb .RgbAttr ;
}else if _dccgb .IndexedAttr !=nil &&*_dccgb .IndexedAttr < 64{_bcec =_beee [*_dccgb .IndexedAttr ];}else if _dccgb .ThemeAttr !=nil {_dfac :=*_dccgb .ThemeAttr ;_bcec =_gfbg .getColorFromTheme (_dfac );};if _bcec ==""{return nil ;};if len (_bcec )> 6{_bcec =_bcec [(len (_bcec )-6):];
};if _dccgb .TintAttr !=nil {_faca :=*_dccgb .TintAttr ;_bcec =_b .AdjustColorByTint (_bcec ,_faca );};_bcec ="\u0023"+_bcec ;return &_bcec ;};

// ConvertToPdfWithOptions convert a sheet to PDF with given options.
func ConvertToPdfWithOptions (s *_cb .Sheet ,opts *Options )*_c .Creator {_fcd :=s .X ();if _fcd ==nil {return nil ;};var _gd _c .PageSize ;_cg :=true ;_bc :=false ;if _fcd .SheetPr !=nil &&_fcd .SheetPr .PageSetUpPr !=nil &&_fcd .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_fcd .SheetPr .PageSetUpPr .FitToPageAttr {_bc =true ;
};if _ea :=_fcd .PageSetup ;_ea !=nil {_cg =_ea .OrientationAttr ==_ca .ST_OrientationLandscape ;if _aeb :=_ea .PaperSizeAttr ;_aeb !=nil {_gd =_aagf [*_aeb ];};};if (_gd ==_c .PageSize {}){_gd =_b .GetDefaultPageSize ();if opts !=nil &&opts .DefaultPageSize !=_b .DefaultPageSize {_gd =_b .GetPageDimensions (opts .DefaultPageSize );
};};if _cg {_gd [0],_gd [1]=_gd [1],_gd [0];};_fcg :=_c .New ();_fcg .SetPageSize (_gd );var _ad ,_gb ,_dbg ,_ga float64 ;if _ag :=_fcd .PageMargins ;_ag !=nil {_dbg =_ag .LeftAttr ;_ga =_ag .RightAttr ;_ad =_ag .TopAttr ;_gb =_ag .BottomAttr ;};if _dbg < _eed {_dbg =_eed ;
};if _ga < _eed {_ga =_eed ;};if _ad < _ae {_ad =_ae ;};if _gb < _ae {_gb =_ae ;};_ad *=_cc .Inch ;_gb *=_cc .Inch ;_dbg *=_cc .Inch ;_ga *=_cc .Inch ;_fcg .SetPageMargins (_dbg ,_ga ,_ad ,_gb );_ba :=s .Workbook ();var _aa *_ab .Theme ;if len (_ba .Themes ())> 0{_aa =_ba .Themes ()[0];
};var _dd ,_gca ,_gg ,_gce int ;for _ ,_gaf :=range _ba .DefinedNames (){if _gaf .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_bae ,_fdb ,_gdc ,_eaa :=_b .ParseExcelRange (_gaf .Content ());if _eaa ==nil &&s .Name ()==_bae {_dd =int (_fdb .ColumnIdx );
_gca =int (_gdc .ColumnIdx );_gg =int (_fdb .RowIdx );_gce =int (_gdc .RowIdx );};};};_bb :=[]_cb .Table {};if _fcd .TableParts !=nil &&_fcd .TableParts .TablePart !=nil {_eff :=0;_gf :=s .Workbook ().Tables ();_d .Slice (_gf [:],func (_ce ,_df int )bool {return _gf [_ce ].X ().IdAttr < _gf [_df ].X ().IdAttr });
for _ ,_ceg :=range s .Workbook ().Sheets (){if _ceg .Name ()==s .Name (){break ;}else {if _ceg .X ().TableParts !=nil &&_ceg .X ().TableParts .TablePart !=nil {_eff +=len (_ceg .X ().TableParts .TablePart );};};};if len (_gf )>=_eff +len (_fcd .TableParts .TablePart ){_bb =append (_bb ,_gf [_eff :_eff +len (_fcd .TableParts .TablePart )]...);
};};_eb :=&convertContext {_ead :_fcg ,_dgbg :s ,_gebe :s .Workbook (),_cece :_aa ,_gea :&s .Workbook ().StyleSheet ,_afec :_ad ,_egcc :_dbg ,_egd :_gd [1]-_gb -_ad ,_eaag :_gd [0]-_ga -_dbg ,_bbc :_dd ,_ecgg :_gca ,_cac :_gg ,_edfb :_gce ,_aeeb :_bc ,_dcea :_bb };
_eb .makeAnchors ();_eb .determineMaxIndexes ();if _eb ._dcc ==0&&_eb ._cdfa ==0{_fcg .NewPage ();return _fcg ;};_eb .makeCols ();_eb .makeRows ();_eb .makeMergedCells ();_eb .makeCells ();_eb .makePagespans ();_eb .makeRowspans ();_eb .makePages ();_eb .fillPages ();
_eb .distributeAnchors ();_eb .drawSheet ();return _fcg ;};const _ae =0.0;func (_bee *convertContext )getSymbolsFromString (_gfdf string ,_cbde *style )[]*symbol {_efc :=[]*symbol {};_bcb :=_bee .makeTextStyleFromCellStyle (_cbde );for _ ,_dbeg :=range _gfdf {_efc =append (_efc ,&symbol {_aefb :string (_dbeg ),_bfdf :_bcb });
};return _efc ;};type colWidthRange struct{_cfeg int ;_ddeaf int ;_cebc float64 ;_ffff *style ;};func (_ddg *convertContext )getColorFromTheme (_agdg uint32 )string {_bbgd :=_ddg ._gebe .Themes ();if len (_bbgd )!=0{_baec :=_bbgd [0];if _bfg :=_baec .ThemeElements ;
_bfg !=nil {if _cedc :=_bfg .ClrScheme ;_cedc !=nil {switch _agdg {case 0:return _b .GetColorStringFromDmlColor (_cedc .Lt1 );case 1:return _b .GetColorStringFromDmlColor (_cedc .Dk1 );case 2:return _b .GetColorStringFromDmlColor (_cedc .Lt2 );case 3:return _b .GetColorStringFromDmlColor (_cedc .Dk2 );
case 4:return _b .GetColorStringFromDmlColor (_cedc .Accent1 );case 5:return _b .GetColorStringFromDmlColor (_cedc .Accent2 );case 6:return _b .GetColorStringFromDmlColor (_cedc .Accent3 );case 7:return _b .GetColorStringFromDmlColor (_cedc .Accent4 );
case 8:return _b .GetColorStringFromDmlColor (_cedc .Accent5 );case 9:return _b .GetColorStringFromDmlColor (_cedc .Accent6 );};};};};return "";};func (_ggb *convertContext )getSymbolsFromR (_fgd []*_ca .CT_RElt ,_fdef *style )[]*symbol {_dbfaa :=[]*symbol {};
for _ ,_fff :=range _fgd {_fcef :=_ggb .combineCellStyleWithRPrElt (_fdef ,_fff .RPr );for _ ,_agda :=range _fff .T {_dbfaa =append (_dbfaa ,&symbol {_aefb :string (_agda ),_bfdf :_ggb .makeTextStyleFromCellStyle (_fcef )});};};return _dbfaa ;};type pageRow struct{_abde int ;
_abca []*cell ;};func (_dgce *convertContext )drawSheet (){for _cbgd ,_dbfa :=range _dgce ._ade {_gcgf :=len (_dbfa ._ggd );if _cbgd ==len (_dgce ._ade )-1{for _fgg :=len (_dbfa ._ggd )-1;_fgg >=0;_fgg --{if !_dbfa ._ggd [_fgg ]._gcad {_gcgf =_fgg ;};};
};_ged :=_dbfa ._ggd [:_gcgf ];for _ ,_ecf :=range _ged {_dgce ._ead .NewPage ();_dgce .drawPage (_ecf );};};};func (_dgdd *convertContext )makeTextStyleFromCellStyle (_abfe *style )*_c .TextStyle {_dgae :=_dgdd ._ead .NewTextStyle ();if _abfe ==nil {_dgae .FontSize =_b .DefaultFontSize ;
_dgae .Font =_b .AssignStdFontByName (_dgae ,_b .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_dgae ;};if _cga (_abfe ._ebca ){_dgae .Underline =true ;_dgae .UnderlineStyle =_c .TextDecorationLineStyle {Offset :0.5,Thickness :_geaf (1/32)};
};var _aeae FontStyle ;if _cga (_abfe ._egfd )&&_cga (_abfe ._eacb ){_aeae =FontStyle_BoldItalic ;}else if _cga (_abfe ._egfd ){_aeae =FontStyle_Bold ;}else if _cga (_abfe ._eacb ){_aeae =FontStyle_Italic ;}else {_aeae =FontStyle_Regular ;};_gcdb :="\u0064e\u0066\u0061\u0075\u006c\u0074";
if _abfe ._aeec !=nil {_gcdb =*_abfe ._aeec ;};if _edbc ,_cdce :=_b .StdFontsMap [_gcdb ];_cdce {_dgae .Font =_b .AssignStdFontByName (_dgae ,_edbc [_aeae ]);}else if _aagbc :=_b .GetRegisteredFont (_gcdb ,_aeae );_aagbc !=nil {_dgae .Font =_aagbc ;}else {_dg .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_gcdb ,_aeae );
_dgae .Font =_b .AssignStdFontByName (_dgae ,_b .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_aeae ]);};if _abfe ._ecb !=nil {_dgae .FontSize =_a .Round (*_abfe ._ecb *_dgdd ._dee );};if _abfe ._bgbe !=nil {_dgae .Color =_c .ColorRGBFromHex (*_abfe ._bgbe );
};if _abfe ._aacc !=nil &&*_abfe ._aacc {_dgae .FontSize *=_fc ;}else if _abfe ._fbf !=nil &&*_abfe ._fbf {_dgae .FontSize *=_fc ;};return &_dgae ;};type colInfo struct{_cffg float64 ;_ecfa float64 ;_ccbf *style ;};func (_edbb *convertContext )alignSymbolsVertically (_eae *cell ,_bbb _ca .ST_VerticalAlignment ){var _dea float64 ;
switch _bbb {case _ca .ST_VerticalAlignmentTop :_dea =_af ;if _eae ._aged {_dea -=_db ;}else if _eae ._cge {_dea +=4*_db ;};for _ ,_cef :=range _eae ._ggfg {_dea +=_cef ._aeebd ;_cef ._cdbb =_dea ;_dea +=_eg ;};case _ca .ST_VerticalAlignmentCenter :_dcgc :=0.0;
for _ ,_abcd :=range _eae ._ggfg {_dcgc +=_abcd ._aeebd +_geaf (1);};_dea =0.5*(_eae ._ccbg -_dcgc );if _eae ._aged {_dea -=2*_db ;}else if _eae ._cge {_dea +=2*_db ;};for _ ,_efbde :=range _eae ._ggfg {_dea +=_efbde ._aeebd +0.5*_eg ;_efbde ._cdbb =_dea ;
_dea +=0.5*_eg ;};default:_dea =_eae ._ccbg -_af ;if _eae ._aged {_dea -=4*_db ;}else if _eae ._cge {_dea +=_db ;};for _eecg :=len (_eae ._ggfg )-1;_eecg >=0;_eecg --{_eae ._ggfg [_eecg ]._cdbb =_dea ;_dea -=_eae ._ggfg [_eecg ]._aeebd ;_dea -=_eg ;};};
};func _geaf (_cecc float64 )float64 {return _cecc *_cc .Millimeter };type style struct{_edfa *string ;_bgbe *string ;_ecb *float64 ;_aeec *string ;_egfd *bool ;_eacb *bool ;_ebca *bool ;_aacc *bool ;_fbf *bool ;_fedfe *border ;_cfce *border ;_ddec *border ;
_ceec *border ;_dfa bool ;_gad _ca .ST_VerticalAlignment ;_bccb _ca .ST_HorizontalAlignment ;_gdba bool ;};var _aagf =map[uint32 ]_c .PageSize {1:_c .PageSize {8.5*_cc .Inch ,11*_cc .Inch },2:_c .PageSize {8.5*_cc .Inch ,11*_cc .Inch },3:_c .PageSize {11*_cc .Inch ,17*_cc .Inch },4:_c .PageSize {17*_cc .Inch ,11*_cc .Inch },5:_c .PageSize {8.5*_cc .Inch ,14*_cc .Inch },6:_c .PageSize {5.5*_cc .Inch ,8.5*_cc .Inch },7:_c .PageSize {7.5*_cc .Inch ,10*_cc .Inch },8:_c .PageSize {_geaf (297),_geaf (420)},9:_c .PageSize {_geaf (210),_geaf (297)},10:_c .PageSize {_geaf (210),_geaf (297)},11:_c .PageSize {_geaf (148),_geaf (210)},70:_c .PageSize {_geaf (105),_geaf (148)},12:_c .PageSize {_geaf (250),_geaf (354)},13:_c .PageSize {_geaf (182),_geaf (257)},14:_c .PageSize {8.5*_cc .Inch ,13*_cc .Inch },20:_c .PageSize {4.125*_cc .Inch ,9.5*_cc .Inch },27:_c .PageSize {_geaf (110),_geaf (220)},28:_c .PageSize {_geaf (162),_geaf (229)},34:_c .PageSize {_geaf (250),_geaf (176)},29:_c .PageSize {_geaf (324),_geaf (458)},30:_c .PageSize {_geaf (229),_geaf (324)},31:_c .PageSize {_geaf (114),_geaf (162)},37:_c .PageSize {3.88*_cc .Inch ,7.5*_cc .Inch },43:_c .PageSize {_geaf (100),_geaf (148)},69:_c .PageSize {_geaf (200),_geaf (148)}};
const _edf =15.0;func (_edd *convertContext )makeRows (){_fag :=[]*rowInfo {};_fca :=_edd ._dgbg .Rows ();_ecgb :=0;_gda :=0.0;for _dfe ,_ebb :=range _fca {if _dfe < _edd ._cac ||(_dfe > _edd ._edfb &&_edd ._edfb > 0){continue ;};_ecgb ++;_fg :=int (_ebb .RowNumber ());
if _fg > _ecgb {for _ccfa :=_ecgb ;_ccfa < _fg ;_ccfa ++{_fag =append (_fag ,&rowInfo {_bgdc :_edf /_fdf });_gda +=_edf /_fdf ;};_ecgb =_fg ;};var _afc float64 ;if _ebb .X ().HtAttr ==nil {_afc =_edf ;}else {_afc =*_ebb .X ().HtAttr ;};_fag =append (_fag ,&rowInfo {_bgdc :_afc /_fdf ,_dcff :true ,_gec :_edd .getStyle (_ebb .X ().SAttr )});
_gda +=_afc /_fdf ;};for _fab :=len (_fag );_fab < _edd ._dcc ;_fab ++{_fag =append (_fag ,&rowInfo {_bgdc :_edf /_fdf });_gda +=_edf /_fdf ;};if _edd ._aeeb ||_gda >=_edd ._egd {_fce :=_edd ._dee ;if _edd ._egd /_gda < _edd ._dee {_fce =_edd ._egd /_gda ;
};for _ ,_cf :=range _fag {_cf ._bgdc *=_fce ;};};_edd ._fbae =_fag ;};var _beee =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
func (_adcd *convertContext )getDxfStyle (_eag *uint32 )*style {_dbbe :=&style {};_ebec :=false ;if _eag !=nil {var _ebbf *_ca .CT_Dxf ;for _febf ,_gegf :=range _adcd ._gea .X ().Dxfs .Dxf {if uint32 (_febf )==*_eag {_ebbf =_gegf ;};};if _ebbf ==nil {return nil ;
};if _ebbf .Fill !=nil &&_ebbf .Fill .FillChoice !=nil &&_ebbf .Fill .FillChoice .PatternFill !=nil {if _ebbf .Fill .FillChoice .PatternFill .FgColor !=nil {_dbbe ._edfa =_adcd .getColorStringFromSmlColor (_ebbf .Fill .FillChoice .PatternFill .FgColor );
}else if _ebbf .Fill .FillChoice .PatternFill .BgColor !=nil {_dbbe ._edfa =_adcd .getColorStringFromSmlColor (_ebbf .Fill .FillChoice .PatternFill .BgColor );};};_fded :=_ebbf .Font ;for _ ,_gcf :=range _fded .FontChoice {if _gcf .Name !=nil {_dbbe ._aeec =&_gcf .Name .ValAttr ;
_ebec =true ;}else if _gcf .B !=nil {_cfef :=_gcf .B .ValAttr ==nil ||*_gcf .B .ValAttr ;_dbbe ._egfd =&_cfef ;_ebec =true ;}else if _gcf .I !=nil {_abge :=_gcf .I .ValAttr ==nil ||*_gcf .I .ValAttr ;_dbbe ._eacb =&_abge ;_ebec =true ;}else if _gcf .U !=nil {_gcfc :=_gcf .U .ValAttr ==_ca .ST_UnderlineValuesSingle ||_gcf .U .ValAttr ==_ca .ST_UnderlineValuesUnset ;
_dbbe ._ebca =&_gcfc ;_ebec =true ;}else if _gcf .Sz !=nil {_beae :=_gcf .Sz .ValAttr ;_dbbe ._ecb =&_beae ;_ebec =true ;}else if _gcf .VertAlign !=nil {_ddc :=_gcf .VertAlign .ValAttr ==_ef .ST_VerticalAlignRunSuperscript ;_dbbe ._aacc =&_ddc ;_efeb :=_gcf .VertAlign .ValAttr ==_ef .ST_VerticalAlignRunSubscript ;
_dbbe ._fbf =&_efeb ;_ebec =true ;}else if _gcf .Color !=nil {_dbbe ._bgbe =_adcd .getColorStringFromSmlColor (_gcf .Color );_ebec =true ;};};_ceee :=_ebbf .Border ;if _ceee !=nil {if _ceee .Top !=nil {_dbbe ._fedfe =_adcd .getBorder (_ceee .Top );_ebec =true ;
};if _ceee .Bottom !=nil {_dbbe ._cfce =_adcd .getBorder (_ceee .Bottom );_ebec =true ;};if _ceee .Left !=nil {_dbbe ._ddec =_adcd .getBorder (_ceee .Left );_ebec =true ;};if _ceee .Right !=nil {_dbbe ._ceec =_adcd .getBorder (_ceee .Right );_ebec =true ;
};};if _ebbf .Alignment !=nil {if _bdaaa :=_ebbf .Alignment .VerticalAttr ;_bdaaa !=_ca .ST_VerticalAlignmentUnset {_dbbe ._gad =_bdaaa ;_ebec =true ;};if _gfdc :=_ebbf .Alignment .HorizontalAttr ;_gfdc !=_ca .ST_HorizontalAlignmentUnset {_dbbe ._bccb =_gfdc ;
_ebec =true ;};};};if _ebec {return _dbbe ;};return nil ;};type convertContext struct{_ead *_c .Creator ;_gebe *_cb .Workbook ;_cece *_ab .Theme ;_dgbg *_cb .Sheet ;_gea *_cb .StyleSheet ;_dcc int ;_cdfa int ;_ade []*pagespan ;_cgb *page ;_gcbe []*colInfo ;
_fbae []*rowInfo ;_cbc []*rowspan ;_afec float64 ;_egcc float64 ;_egd float64 ;_eaag float64 ;_ddf []*mergedCell ;_facb []*anchor ;_dee float64 ;_bbc int ;_ecgg int ;_cac int ;_edfb int ;_aeeb bool ;_dcea []_cb .Table ;};

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _b .PageSize ;};func (_acbe *convertContext )getStyleFromRPrElt (_ccga *_ca .CT_RPrElt )*style {if _ccga ==nil ||_ccga .RPrEltChoice ==nil ||len (_ccga .RPrEltChoice )==0{return nil ;};_bce :=&style {};for _ ,_cbdg :=range _ccga .RPrEltChoice {if _cbdg .RFont !=nil {_bce ._aeec =&_cbdg .RFont .ValAttr ;
};if _bcaa :=_cbdg .B ;_bcaa !=nil {_fdgg :=_bcaa .ValAttr ==nil ||*_bcaa .ValAttr ;_bce ._egfd =&_fdgg ;};if _faeb :=_cbdg .I ;_faeb !=nil {_acfa :=_faeb .ValAttr ==nil ||*_faeb .ValAttr ;_bce ._eacb =&_acfa ;};if _gfcd :=_cbdg .U ;_gfcd !=nil {_eace :=_gfcd .ValAttr ==_ca .ST_UnderlineValuesSingle ||_gfcd .ValAttr ==_ca .ST_UnderlineValuesUnset ;
_bce ._ebca =&_eace ;};if _bbcaa :=_cbdg .VertAlign ;_bbcaa !=nil {_fadd :=_bbcaa .ValAttr ==_ef .ST_VerticalAlignRunSuperscript ;_bce ._aacc =&_fadd ;_gabgf :=_bbcaa .ValAttr ==_ef .ST_VerticalAlignRunSubscript ;_bce ._fbf =&_gabgf ;};if _fddd :=_cbdg .Sz ;
_fddd !=nil {_daeg :=_fddd .ValAttr ;_bce ._ecb =&_daeg ;};if _abdf :=_cbdg .Color ;_abdf !=nil {_bce ._bgbe =_acbe .getColorStringFromSmlColor (_abdf );};};return _bce ;};func (_adgf *convertContext )getBorder (_cbe *_ca .CT_BorderPr )*border {_dfgb :=&border {};
switch _cbe .StyleAttr {case _ca .ST_BorderStyleHair :_dfgb ._ccgb =_de /2;case _ca .ST_BorderStyleThin :_dfgb ._ccgb =_de ;case _ca .ST_BorderStyleMedium :_dfgb ._ccgb =_de *2;case _ca .ST_BorderStyleThick :_dfgb ._ccgb =_de *4;};if _dfgb ._ccgb ==0.0{return nil ;
};if _cafg :=_cbe .Color ;_cafg !=nil {_cacb :=_adgf .getColorStringFromSmlColor (_cafg );if _cacb !=nil {_dfgb ._agbe =_c .ColorRGBFromHex (*_cacb );}else {_dfgb ._agbe =_c .ColorBlack ;};};return _dfgb ;};type line struct{_cdbb float64 ;_fedfd []*symbol ;
_aeebd float64 ;};var _eg =_geaf (1);type border struct{_ccgb float64 ;_agbe _c .Color ;};func (_edg *convertContext )makeMergedCells (){_daee :=[]*mergedCell {};for _ ,_cff :=range _edg ._dgbg .MergedCells (){_aee ,_eeg ,_efbc :=_da .ParseRangeReference (_cff .Reference ());
if _efbc !=nil {_dg .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_efbc );continue ;};_egg :=mergedCell {_deec :_aee .RowIdx ,_bga :_aee .ColumnIdx ,_ffd :_eeg .RowIdx ,_dbb :_eeg .ColumnIdx };
for _abg :=_egg ._bga -1;_abg < _egg ._dbb ;_abg ++{_egg ._gef +=_edg ._gcbe [_abg ]._ecfa ;};for _gddc :=_egg ._deec -1;_gddc < _egg ._ffd ;_gddc ++{_egg ._cbga +=_edg ._fbae [_gddc ]._bgdc ;};_daee =append (_daee ,&_egg );};_edg ._ddf =_daee ;};const (FontStyle_Regular FontStyle =0;
FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_edgg *convertContext )distributeAnchors (){for _ ,_aedg :=range _edgg ._facb {_cdee ,_egcf :=_aedg ._dcef ,_aedg ._efa ;_geeb ,_agg :=_aedg ._gaee ,_aedg ._fabc ;
_fdbf ,_gga :=_aedg ._egcd ,_aedg ._eafb ;_fcb ,_fdbb :=_aedg ._ceaca ,_aedg ._caf ;if _cdee < _edgg ._cac ||(_fdbf > _edgg ._edfb &&_edgg ._edfb > 0){continue ;};if _geeb < _edgg ._bbc ||(_fcb > _edgg ._ecgg &&_edgg ._ecgg > 0){continue ;};var _fdd ,_fedf ,_gde ,_gbg *page ;
for _ ,_abf :=range _edgg ._ade {for _ ,_eega :=range _abf ._ggd {if _cdee >=_eega ._ebe ._bec &&_cdee < _eega ._ebe ._bgb {if _geeb >=_eega ._dbcg ._aead &&_geeb < _eega ._dbcg ._bdfa {_eega ._gcad =true ;_fdd =_eega ;};if _fcb >=_eega ._dbcg ._aead &&_fcb < _eega ._dbcg ._bdfa {_eega ._gcad =true ;
_fedf =_eega ;};};if _fdbf >=_eega ._ebe ._bec &&_fdbf < _eega ._ebe ._bgb {if _geeb >=_eega ._dbcg ._aead &&_geeb < _eega ._dbcg ._bdfa {_eega ._gcad =true ;_gbg =_eega ;};if _fcb >=_eega ._dbcg ._aead &&_fcb < _eega ._dbcg ._bdfa {_eega ._gcad =true ;
_gde =_eega ;};};};};_fdaa :=_fdd !=_fedf ;_dfeg :=_fdd !=_gbg ;if _fdaa &&_dfeg {_cag :=_edgg ._gcbe [_geeb ]._cffg +_cc .FromEMU (_agg );_bgeg :=_fdd ._dbcg ._fbd ;_fbg :=_edgg ._gcbe [_fcb ]._cffg +_cc .FromEMU (_fdbb );_fbc :=_edgg ._fbae [_cdee ]._eafa +_cc .FromEMU (_egcf );
_ceda :=float64 (_fdd ._ebe ._cdac );_edb :=_edgg ._fbae [_fdbf ]._eafa +_cc .FromEMU (_gga );_geb :=_fbg +_bgeg -_cag ;_ggf :=_edb +_ceda -_fbc ;_aea :=_edgg .imageFromAnchor (_aedg ,_geb ,_ggf );_fdd ._dbgb =append (_fdd ._dbgb ,_edgg .getImage (_aea ,_ggf ,_geb ,_cag ,_fbc ,_bgeg -_cag ,_ceda -_fbc ,_b .ImgPart_lt ));
_fedf ._dbgb =append (_fedf ._dbgb ,_edgg .getImage (_aea ,_ggf ,_geb ,0,_fbc ,_bgeg -_cag ,_ceda -_fbc ,_b .ImgPart_rt ));_gbg ._dbgb =append (_gbg ._dbgb ,_edgg .getImage (_aea ,_ggf ,_geb ,_cag ,0,_bgeg -_cag ,_ceda -_fbc ,_b .ImgPart_lb ));_gde ._dbgb =append (_gde ._dbgb ,_edgg .getImage (_aea ,_ggf ,_geb ,0,0,_bgeg -_cag ,_ceda -_fbc ,_b .ImgPart_rb ));
}else if _fdaa {_cdf :=_edgg ._fbae [_cdee ]._eafa +_cc .FromEMU (_egcf );_dbfd :=_edgg ._fbae [_fdbf ]._eafa +_cc .FromEMU (_gga );_gba :=_edgg ._gcbe [_geeb ]._cffg +_cc .FromEMU (_agg );_gebf :=_fdd ._dbcg ._fbd ;_eedf :=_edgg ._gcbe [_fcb ]._cffg +_cc .FromEMU (_fdbb );
_afcb :=_eedf +_gebf -_gba ;_cbdf :=_dbfd -_cdf ;_eggd :=_edgg .imageFromAnchor (_aedg ,_afcb ,_cbdf );_fdd ._dbgb =append (_fdd ._dbgb ,_edgg .getImage (_eggd ,_cbdf ,_afcb ,_gba ,_cdf ,_gebf -_gba ,0,_b .ImgPart_l ));_fedf ._dbgb =append (_fedf ._dbgb ,_edgg .getImage (_eggd ,_cbdf ,_afcb ,0,_cdf ,_gebf -_gba ,0,_b .ImgPart_r ));
}else if _dfeg {_effd :=_edgg ._gcbe [_geeb ]._cffg +_cc .FromEMU (_agg );_fcf :=_edgg ._gcbe [_fcb ]._cffg +_cc .FromEMU (_fdbb );_ggea :=_edgg ._fbae [_cdee ]._eafa +_cc .FromEMU (_egcf );_fde :=float64 (_fdd ._ebe ._cdac );_dgc :=_edgg ._fbae [_fdbf ]._eafa +_cc .FromEMU (_gga );
_bfd :=_fcf -_effd ;_abeb :=_dgc +_fde -_ggea ;_bag :=_edgg .imageFromAnchor (_aedg ,_bfd ,_abeb );_fdd ._dbgb =append (_fdd ._dbgb ,_edgg .getImage (_bag ,_abeb ,_bfd ,_effd ,_ggea ,0,_fde -_ggea ,_b .ImgPart_t ));_gbg ._dbgb =append (_gbg ._dbgb ,_edgg .getImage (_bag ,_abeb ,_bfd ,_effd ,0,0,_fde -_ggea ,_b .ImgPart_b ));
}else {_caa :=_edgg ._gcbe [_geeb ]._cffg +_cc .FromEMU (_agg );_gfg :=_edgg ._gcbe [_fcb ]._cffg +_cc .FromEMU (_fdbb );_fdbc :=_edgg ._fbae [_cdee ]._eafa +_cc .FromEMU (_egcf );_gabg :=_edgg ._fbae [_fdbf ]._eafa +_cc .FromEMU (_gga );_bde :=_gfg -_caa ;
_ff :=_gabg -_fdbc ;_daff :=_edgg .imageFromAnchor (_aedg ,_bde ,_ff );_fdd ._dbgb =append (_fdd ._dbgb ,_edgg .getImage (_daff ,_ff ,_bde ,_caa ,_fdbc ,0,0,_b .ImgPart_whole ));};};};func _cga (_cfcb *bool )bool {return _cfcb !=nil &&*_cfcb };const _ed =64.0;
func _cedbd (_cagd ,_ffag *style ){if _ffag ==nil {return ;};if _cagd ==nil {_cagd =_ffag ;return ;};if _cagd ._edfa ==nil {_cagd ._edfa =_ffag ._edfa ;};if _cagd ._aeec ==nil {_cagd ._aeec =_ffag ._aeec ;};if _cagd ._bgbe ==nil {_cagd ._bgbe =_ffag ._bgbe ;
};if _cagd ._ecb ==nil {_cagd ._ecb =_ffag ._ecb ;};if _cagd ._egfd ==nil {_cagd ._egfd =_ffag ._egfd ;};if _cagd ._eacb ==nil {_cagd ._eacb =_ffag ._eacb ;};if _cagd ._ebca ==nil {_cagd ._ebca =_ffag ._ebca ;};if _cagd ._aacc ==nil {_cagd ._aacc =_ffag ._aacc ;
};if _cagd ._fbf ==nil {_cagd ._fbf =_ffag ._fbf ;};if _cagd ._fedfe ==nil {_cagd ._fedfe =_ffag ._fedfe ;};if _cagd ._cfce ==nil {_cagd ._cfce =_ffag ._cfce ;};if _cagd ._ddec ==nil {_cagd ._ddec =_ffag ._ddec ;};if _cagd ._ceec ==nil {_cagd ._ceec =_ffag ._ceec ;
};if _cagd ._gad ==_ca .ST_VerticalAlignmentUnset {_cagd ._gad =_ffag ._gad ;};if _cagd ._bccb ==_ca .ST_HorizontalAlignmentUnset {_cagd ._bccb =_ffag ._bccb ;};};type mergedCell struct{_deec uint32 ;_bga uint32 ;_ffd uint32 ;_dbb uint32 ;_gef float64 ;
_cbga float64 ;};func _baba (_acbd []*symbol )float64 {_cfbd :=0.0;for _ ,_cebb :=range _acbd {if _cebb ._eafc > _cfbd {_cfbd =_cebb ._eafc ;};};return _cfbd ;};type rowspan struct{_cdac float64 ;_bec int ;_bgb int ;};func (_dfc *convertContext )combineCellStyleWithRPrElt (_def *style ,_beda *_ca .CT_RPrElt )*style {_cafb :=*_def ;
_egde :=_dfc .getStyleFromRPrElt (_beda );if _egde ==nil {return &_cafb ;};if _egde ._bgbe !=nil {_cafb ._bgbe =_egde ._bgbe ;};if _egde ._ecb !=nil {_cafb ._ecb =_egde ._ecb ;};if _egde ._aeec !=nil {_cafb ._aeec =_egde ._aeec ;};if _egde ._egfd !=nil {_cafb ._egfd =_egde ._egfd ;
};if _egde ._eacb !=nil {_cafb ._eacb =_egde ._eacb ;};if _egde ._ebca !=nil {_cafb ._ebca =_egde ._ebca ;};if _egde ._aacc !=nil {_cafb ._aacc =_egde ._aacc ;};if _egde ._fbf !=nil {_cafb ._fbf =_egde ._fbf ;};return &_cafb ;};func (_aeba *convertContext )makePagespans (){_aeba ._ade =[]*pagespan {};
_eeb :=0.0;_ebbg :=0;for _cecf ,_aagb :=range _aeba ._gcbe {_ebc :=_aagb ._ecfa ;if _eeb +_ebc <=_aeba ._eaag {_aagb ._cffg =_eeb ;_eeb +=_ebc ;}else {_aagb ._cffg =0;_aeba ._ade =append (_aeba ._ade ,&pagespan {_fbd :_eeb ,_aead :_ebbg ,_bdfa :_cecf });
_eeb =_ebc ;_ebbg =_cecf ;};};_aeba ._ade =append (_aeba ._ade ,&pagespan {_fbd :_eeb ,_aead :_ebbg ,_bdfa :len (_aeba ._gcbe )});};func (_fe *convertContext )determineMaxIndexes (){var _fda ,_dga int ;_fda =int (_fe ._dgbg .MaxColumnIdx ());_cca :=_fe ._dgbg .Rows ();
if len (_cca )> 0{_dga =int (_cca [len (_cca )-1].RowNumber ());};for _ ,_acf :=range _fe ._facb {if _acf ._egcd >=_dga {_dga =_acf ._egcd +1;};if _acf ._ceaca >=_fda {_fda =_acf ._ceaca +1;};};_fe ._dcc =_dga ;_fe ._cdfa =_fda ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _b .RegisterFontsFromDirectory (dirName )};func (_baac *convertContext )makeCells (){_eac :=_baac ._dgbg ;_abe :=_eac .Rows ();_dfdf :=0;for _bbe ,_gcg :=range _baac ._fbae {if _bbe < _baac ._cac ||(_bbe > _baac ._edfb &&_baac ._edfb > 0){continue ;
};_gcg ._dcffd =[]*cell {};_aacg :=0.0;_gcb :=_gcg ._gec ;if _gcg ._dcff {_fdg :=_abe [_dfdf ];_dfdf ++;_bac :=_gcg ._bgdc ;for _ ,_ceag :=range _fdg .Cells (){_fdff ,_daf :=_da .ParseCellReference (_ceag .Reference ());if _daf !=nil {_dg .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_daf );
continue ;};if int (_fdff .ColumnIdx )< _baac ._bbc ||(int (_fdff .ColumnIdx )> _baac ._ecgg &&_baac ._ecgg > 0){continue ;};_bdgb :=_baac ._gcbe [_fdff .ColumnIdx ];_dc :=_bdgb ._ecfa ;_bdb :=_dc ;_edfg :=_bdgb ._ccbf ;var _ccg ,_aag ,_daa ,_bdd bool ;
for _ ,_fef :=range _baac ._ddf {if _fdff .RowIdx >=_fef ._deec &&_fdff .RowIdx <=_fef ._ffd &&_fdff .ColumnIdx >=_fef ._bga &&_fdff .ColumnIdx <=_fef ._dbb {if _fdff .ColumnIdx ==_fef ._bga &&_fdff .RowIdx ==_fef ._deec {_dc =_fef ._gef ;_bac =_fef ._cbga ;
};_ccg =_fdff .RowIdx !=_fef ._deec ;_aag =_fdff .RowIdx !=_fef ._ffd ;_daa =_fdff .ColumnIdx !=_fef ._bga ;_bdd =_fdff .ColumnIdx !=_fef ._dbb ;};};var _afd *style ;for _ ,_gaab :=range _baac ._dcea {_edc ,_fge ,_ccd :=_da .ParseRangeReference (_gaab .Reference ());
if _ccd !=nil ||_edc .RowIdx > _fdff .RowIdx ||_edc .ColumnIdx > _fdff .ColumnIdx ||_fge .RowIdx < _fdff .RowIdx ||_fge .ColumnIdx < _fdff .ColumnIdx ||_baac ._gebe .StyleSheet .X ().TableStyles ==nil {continue ;};_bgg :=_fdff .RowIdx ==_edc .RowIdx ;for _ ,_acfe :=range _baac ._gebe .StyleSheet .X ().TableStyles .TableStyle {if _gaab .X ().TableStyleInfo .NameAttr !=nil &&_acfe .NameAttr ==*_gaab .X ().TableStyleInfo .NameAttr {for _ ,_dde :=range _acfe .TableStyleElement {if !_bgg &&_dde .TypeAttr ==_ca .ST_TableStyleTypeWholeTable {_afd =_baac .getDxfStyle (_dde .DxfIdAttr );
};if _bgg &&_dde .TypeAttr ==_ca .ST_TableStyleTypeHeaderRow {_afd =_baac .getDxfStyle (_dde .DxfIdAttr );};};};};};_gfe :=_baac .getStyleFromCell (_ceag ,_gcb ,_edfg ,_afd );var _ge ,_dbe ,_bca ,_geg bool ;var _cd ,_cedb ,_cde ,_deb *border ;var _bcac _ca .ST_VerticalAlignment ;
var _be _ca .ST_HorizontalAlignment ;if _gfe !=nil {if !_ccg {_cd =_gfe ._fedfe ;};if !_aag {_cedb =_gfe ._cfce ;};if !_daa {_cde =_gfe ._ddec ;};if !_bdd {_deb =_gfe ._ceec ;};if _cedb !=nil &&_cedb ._ccgb > _aacg {_aacg =_cedb ._ccgb ;};_bcac =_gfe ._gad ;
_be =_gfe ._bccb ;if _gfe ._aacc !=nil {_ge =*_gfe ._aacc ;};if _gfe ._fbf !=nil {_dbe =*_gfe ._fbf ;};_bca =_gfe ._dfa ;_geg =_gfe ._gdba ;};var _cfe _c .Color ;if _gfe !=nil &&_gfe ._edfa !=nil {_cfe =_c .ColorRGBFromHex (*_gfe ._edfa );};_gbb ,_gcec :=_baac .getContentFromCell (_eac ,_ceag ,_gfe ,_dc ,_bca ,_geg );
_cegd :=&cell {_ggg :_gcec ,_caca :_dc ,_adgb :_bdb ,_ccbg :_bac ,_ggfg :_gbb ,_fec :_cd ,_aagg :_cedb ,_fbgd :_cde ,_bef :_deb ,_aged :_ge ,_cge :_dbe ,_cebg :_cfe };_baac .alignSymbolsHorizontally (_cegd ,_be );_baac .alignSymbolsVertically (_cegd ,_bcac );
_gcg ._dcffd =append (_gcg ._dcffd ,_cegd );};};_gcg ._bbca =_aacg ;};};func (_agb *convertContext )getImage (_gbgg _f .Image ,_efbb ,_bfc ,_gfgc ,_ecfe ,_dbff ,_abfg float64 ,_ddba _b .ImgPart )*_c .Image {_ecfe +=_agb ._afec ;_gfgc +=_agb ._egcc ;_aeef ,_dbcae :=_b .GetImage (_agb ._ead ,_gbgg ,_efbb ,_bfc ,_gfgc ,_ecfe ,_dbff ,_abfg ,_ddba );
if _dbcae !=nil {_dg .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_dbcae );return nil ;};return _aeef ;};func (_bgc *convertContext )fillPages (){for _gfd ,_gbf :=range _bgc ._cbc {_gfb :=_bgc ._fbae [_gbf ._bec :_gbf ._bgb ];
for _efbd ,_gee :=range _gfb {_cad :=0;_feg :=0.0;_dbgd :=[]*cell {};if _gee ._dcff {for _ ,_ecc :=range _gee ._dcffd {_fgc :=_bgc ._ade [_cad ];_bgc ._cgb =_fgc ._ggd [_gfd ];_bgc ._cgb ._gcad =true ;_gdab :=_ecc ._adgb ;if _feg +_gdab > _fgc ._fbd {_bgc .addRowToPage (_dbgd ,_efbd );
_dbgd =[]*cell {_ecc };_feg =_gdab ;_cad ++;}else {_ecc ._ccaa =_feg ;_dbgd =append (_dbgd ,_ecc );_feg +=_gdab ;};};if len (_dbgd )> 0{_cbgg :=_bgc ._ade [_cad ];_bgc ._cgb =_cbgg ._ggd [_gfd ];_bgc ._cgb ._gcad =true ;_bgc .addRowToPage (_dbgd ,_efbd );
};};};};};