//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_c "github.com/unidoc/unioffice/common/logger";_de "github.com/unidoc/unioffice/common/tempstorage";_ec "github.com/unidoc/unioffice/internal/convertutils";_gg "github.com/unidoc/unioffice/measurement";_ac "github.com/unidoc/unioffice/schema/soo/dml";
_gc "github.com/unidoc/unioffice/schema/soo/dml/chart";_df "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_ed "github.com/unidoc/unioffice/schema/soo/sml";_cg "github.com/unidoc/unioffice/spreadsheet";_cb "github.com/unidoc/unioffice/spreadsheet/formula";
_g "github.com/unidoc/unioffice/spreadsheet/reference";_bbe "github.com/unidoc/unipdf/v3/creator";_a "github.com/unidoc/unipdf/v3/model";_e "image";_d "math";_be "sort";_bb "strconv";);const _agd =0.25;type rowInfo struct{_ded float64 ;_ebfd bool ;_gedc float64 ;
_bdg *style ;_fcda []*cell ;_egag float64 ;};var _fd =3.025/_edab (1);func _eegg (_cgeb ,_baf *style ){if _baf ==nil {return ;};if _cgeb ==nil {_cgeb =_baf ;return ;};if _cgeb ._cddd ==nil {_cgeb ._cddd =_baf ._cddd ;};if _cgeb ._bbce ==nil {_cgeb ._bbce =_baf ._bbce ;
};if _cgeb ._fccb ==nil {_cgeb ._fccb =_baf ._fccb ;};if _cgeb ._bbd ==nil {_cgeb ._bbd =_baf ._bbd ;};if _cgeb ._cbba ==nil {_cgeb ._cbba =_baf ._cbba ;};if _cgeb ._ddde ==nil {_cgeb ._ddde =_baf ._ddde ;};if _cgeb ._acaf ==nil {_cgeb ._acaf =_baf ._acaf ;
};if _cgeb ._aef ==nil {_cgeb ._aef =_baf ._aef ;};if _cgeb ._fac ==nil {_cgeb ._fac =_baf ._fac ;};if _cgeb ._edd ==nil {_cgeb ._edd =_baf ._edd ;};if _cgeb ._gfd ==nil {_cgeb ._gfd =_baf ._gfd ;};if _cgeb ._adg ==nil {_cgeb ._adg =_baf ._adg ;};if _cgeb ._bbbf ==nil {_cgeb ._bbbf =_baf ._bbbf ;
};if _cgeb ._dfg ==_ed .ST_VerticalAlignmentUnset {_cgeb ._dfg =_baf ._dfg ;};if _cgeb ._accdb ==_ed .ST_HorizontalAlignmentUnset {_cgeb ._accdb =_baf ._accdb ;};};func (_acba *convertContext )drawSheet (_cceg bool ){for _aagc ,_agb :=range _acba ._bggdb {_eda :=len (_agb ._dcdf );
if _aagc ==len (_acba ._bggdb )-1{for _fggf :=len (_agb ._dcdf )-1;_fggf >=0;_fggf --{if !_agb ._dcdf [_fggf ]._dfdc {_eda =_fggf ;};};};_afe :=_agb ._dcdf [:_eda ];for _ ,_cdb :=range _afe {_acba ._gcgf .NewPage ();if _cceg {_acba ._gcgf .RotateDeg (270);
};_acba .drawPage (_cdb );};};};var _cabf =map[uint32 ]_bbe .PageSize {1:_bbe .PageSize {8.5*_gg .Inch ,11*_gg .Inch },2:_bbe .PageSize {8.5*_gg .Inch ,11*_gg .Inch },3:_bbe .PageSize {11*_gg .Inch ,17*_gg .Inch },4:_bbe .PageSize {17*_gg .Inch ,11*_gg .Inch },5:_bbe .PageSize {8.5*_gg .Inch ,14*_gg .Inch },6:_bbe .PageSize {5.5*_gg .Inch ,8.5*_gg .Inch },7:_bbe .PageSize {7.5*_gg .Inch ,10*_gg .Inch },8:_bbe .PageSize {_edab (297),_edab (420)},9:_bbe .PageSize {_edab (210),_edab (297)},10:_bbe .PageSize {_edab (210),_edab (297)},11:_bbe .PageSize {_edab (148),_edab (210)},70:_bbe .PageSize {_edab (105),_edab (148)},12:_bbe .PageSize {_edab (250),_edab (354)},13:_bbe .PageSize {_edab (182),_edab (257)},14:_bbe .PageSize {8.5*_gg .Inch ,13*_gg .Inch },20:_bbe .PageSize {4.125*_gg .Inch ,9.5*_gg .Inch },27:_bbe .PageSize {_edab (110),_edab (220)},28:_bbe .PageSize {_edab (162),_edab (229)},34:_bbe .PageSize {_edab (250),_edab (176)},29:_bbe .PageSize {_edab (324),_edab (458)},30:_bbe .PageSize {_edab (229),_edab (324)},31:_bbe .PageSize {_edab (114),_edab (162)},37:_bbe .PageSize {3.88*_gg .Inch ,7.5*_gg .Inch },43:_bbe .PageSize {_edab (100),_edab (148)},69:_bbe .PageSize {_edab (200),_edab (148)}};
type convertContext struct{_gcgf *_bbe .Creator ;_bfcc *_cg .Workbook ;_edbg *_ac .Theme ;_fgbe *_cg .Sheet ;_fcae *_cg .StyleSheet ;_ecfad int ;_efd int ;_bggdb []*pagespan ;_fabfc *page ;_fbge []*colInfo ;_cdgg []*rowInfo ;_bdef []*rowspan ;_bcge float64 ;
_ffca float64 ;_addd float64 ;_acabg float64 ;_dca []*mergedCell ;_afadg []*anchor ;_gca float64 ;_gecg int ;_efad int ;_dcc int ;_bbfe int ;_dgee bool ;_feef []_cg .Table ;};func (_ebfe *convertContext )combineCellStyleWithRPrElt (_baea *style ,_ebaf *_ed .CT_RPrElt )*style {_eega :=*_baea ;
_aeb :=_ebfe .getStyleFromRPrElt (_ebaf );if _aeb ==nil {return &_eega ;};if _aeb ._fccb !=nil {_eega ._fccb =_aeb ._fccb ;};if _aeb ._bbd !=nil {_eega ._bbd =_aeb ._bbd ;};if _aeb ._bbce !=nil {_eega ._bbce =_aeb ._bbce ;};if _aeb ._cbba !=nil {_eega ._cbba =_aeb ._cbba ;
};if _aeb ._ddde !=nil {_eega ._ddde =_aeb ._ddde ;};if _aeb ._acaf !=nil {_eega ._acaf =_aeb ._acaf ;};if _aeb ._aef !=nil {_eega ._aef =_aeb ._aef ;};if _aeb ._fac !=nil {_eega ._fac =_aeb ._fac ;};return &_eega ;};type page struct{_gcfg []*pageRow ;
_dfdc bool ;_ecge []*_bbe .Image ;_bebd *pagespan ;_ecc *rowspan ;};var _bd =_edab (0.0625);type mergedCell struct{_dec uint32 ;_bfbd uint32 ;_geg uint32 ;_cbebd uint32 ;_aafd float64 ;_cfda float64 ;};func (_dbbf *convertContext )makePages (){for _ ,_afaf :=range _dbbf ._bggdb {for _ ,_bag :=range _dbbf ._bdef {_afaf ._dcdf =append (_afaf ._dcdf ,&page {_gcfg :[]*pageRow {},_bebd :_afaf ,_ecc :_bag });
};};};func (_deb *convertContext )makeAnchors (){_agg ,_cce :=_deb ._fgbe .GetDrawing ();if _agg !=nil {for _ ,_ca :=range _agg .EG_Anchor {_gce :=&anchor {};if _eaa :=_ca .TwoCellAnchor ;_eaa !=nil {_ggd ,_bg :=_eaa .From ,_eaa .To ;if _ggd ==nil ||_bg ==nil {return ;
};_gce ._dddeb =int (_ggd .Row );_gce ._faad =_ec .FromSTCoordinate (_ggd .RowOff );_gce ._abgg =int (_ggd .Col );_gce ._gfbb =_ec .FromSTCoordinate (_ggd .ColOff );_gce ._bgc =int (_bg .Row );_gce ._gag =_ec .FromSTCoordinate (_bg .RowOff );_gce ._fag =int (_bg .Col );
_gce ._effb =_ec .FromSTCoordinate (_bg .ColOff );if _ge :=_eaa .Choice ;_ge !=nil {if _ef :=_ge .Pic ;_ef !=nil {if _eg :=_ef .BlipFill ;_eg !=nil {if _ad :=_eg .Blip ;_ad !=nil {if _afd :=_ad .EmbedAttr ;_afd !=nil {for _ ,_bbb :=range _cce .X ().Relationship {if _bbb .IdAttr ==*_afd {for _ ,_fg :=range _deb ._bfcc .Images {if _fg .Target ()==_bbb .TargetAttr {_eb ,_geb :=_de .Open (_fg .Path ());
if _geb !=nil {_c .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_geb );continue ;};_acbb ,_ ,_geb :=_e .Decode (_eb );if _geb !=nil {_c .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_geb );
continue ;};_gce ._dfdg =_acbb ;};};};};};};};}else if _gef :=_ge .GraphicFrame ;_gef !=nil {if _aca :=_gef .Graphic ;_aca !=nil {if _ee :=_aca .GraphicData ;_ee !=nil {for _ ,_bge :=range _ee .Any {if _eff ,_age :=_bge .(*_gc .Chart );_age {for _ ,_fdf :=range _cce .X ().Relationship {if _fdf .IdAttr ==_eff .IdAttr {_gcf :=_deb ._bfcc .GetChartByTargetId (_fdf .TargetAttr );
if _gcf !=nil {_gce ._dgbf =_gcf ;};};};};};};};};};};if _gce ._dfdg !=nil ||_gce ._dgbf !=nil {_deb ._afadg =append (_deb ._afadg ,_gce );};};};};func _fcf (_bggd *symbol ){_cgfa :=_bbe .New ();_afbe :=_cgfa .NewStyledParagraph ();_afbe .SetMargins (0,0,0,0);
_fabf :=_afbe .Append (_bggd ._ddebc );if _bggd ._cedf !=nil {_fabf .Style =*_bggd ._cedf ;};_bggd ._acad =_afbe .Height ();if _bggd ._dag ==0{_bggd ._dag =_afbe .Width ();};};func _egd (_gfaf []*symbol )float64 {_dee :=0.0;for _ ,_cdd :=range _gfaf {if _cdd ._acad > _dee {_dee =_cdd ._acad ;
};};return _dee ;};func (_gadf *convertContext )getStyleFromRPrElt (_fef *_ed .CT_RPrElt )*style {if _fef ==nil {return nil ;};_edae :=&style {};_edae ._bbce =&_fef .RFont .ValAttr ;if _gfe :=_fef .B ;_gfe !=nil {_ffdf :=_gfe .ValAttr ==nil ||*_gfe .ValAttr ;
_edae ._cbba =&_ffdf ;};if _cede :=_fef .I ;_cede !=nil {_caca :=_cede .ValAttr ==nil ||*_cede .ValAttr ;_edae ._ddde =&_caca ;};if _dbdf :=_fef .U ;_dbdf !=nil {_efegg :=_dbdf .ValAttr ==_ed .ST_UnderlineValuesSingle ||_dbdf .ValAttr ==_ed .ST_UnderlineValuesUnset ;
_edae ._acaf =&_efegg ;};if _eefa :=_fef .VertAlign ;_eefa !=nil {_fgee :=_eefa .ValAttr ==_df .ST_VerticalAlignRunSuperscript ;_edae ._aef =&_fgee ;_bdcb :=_eefa .ValAttr ==_df .ST_VerticalAlignRunSubscript ;_edae ._fac =&_bdcb ;};if _eebb :=_fef .Sz ;
_eebb !=nil {_bcbbe :=_eebb .ValAttr ;_edae ._bbd =&_bcbbe ;};if _gfab :=_fef .Color ;_gfab !=nil {_edae ._fccb =_gadf .getColorStringFromSmlColor (_gfab );};return _edae ;};func (_ede *convertContext )alignSymbolsVertically (_bgf *cell ,_aacf _ed .ST_VerticalAlignment ){var _ada float64 ;
switch _aacf {case _ed .ST_VerticalAlignmentTop :_ada =_f ;if _bgf ._gfaa {_ada -=_ff ;}else if _bgf ._bebe {_ada +=4*_ff ;};for _ ,_abca :=range _bgf ._gfag {_ada +=_abca ._bdf ;_abca ._gfc =_ada ;_ada +=_abg ;};case _ed .ST_VerticalAlignmentCenter :_ffad :=0.0;
for _ ,_beda :=range _bgf ._gfag {_ffad +=_beda ._bdf +_edab (1);};_ada =0.5*(_bgf ._dcda -_ffad );if _bgf ._gfaa {_ada -=2*_ff ;}else if _bgf ._bebe {_ada +=2*_ff ;};for _ ,_cgagd :=range _bgf ._gfag {_ada +=_cgagd ._bdf +0.5*_abg ;_cgagd ._gfc =_ada ;
_ada +=0.5*_abg ;};default:_ada =_bgf ._dcda -_f ;if _bgf ._gfaa {_ada -=4*_ff ;}else if _bgf ._bebe {_ada +=_ff ;};for _bgae :=len (_bgf ._gfag )-1;_bgae >=0;_bgae --{_bgf ._gfag [_bgae ]._gfc =_ada ;_ada -=_bgf ._gfag [_bgae ]._bdf ;_ada -=_abg ;};};
};func (_efe *convertContext )fillPages (){for _cbe ,_gcb :=range _efe ._bdef {_bga :=_efe ._cdgg [_gcb ._fge :_gcb ._acbae ];for _fdd ,_gcbf :=range _bga {_cac :=0;_gda :=0.0;_ggb :=[]*cell {};if _gcbf ._ebfd {for _ ,_bbg :=range _gcbf ._fcda {_dbef :=_efe ._bggdb [_cac ];
_efe ._fabfc =_dbef ._dcdf [_cbe ];_efe ._fabfc ._dfdc =true ;_agf :=_bbg ._eae ;if _gda +_agf > _dbef ._faa {_efe .addRowToPage (_ggb ,_fdd );_ggb =[]*cell {_bbg };_gda =_agf ;_cac ++;}else {_bbg ._fggc =_gda ;_ggb =append (_ggb ,_bbg );_gda +=_agf ;};
};if len (_ggb )> 0{_bffb :=_efe ._bggdb [_cac ];_efe ._fabfc =_bffb ._dcdf [_cbe ];_efe ._fabfc ._dfdc =true ;_efe .addRowToPage (_ggb ,_fdd );};};};};};type line struct{_gfc float64 ;_cdcd []*symbol ;_bdf float64 ;};const _af =64.0;type anchor struct{_dfdg _e .Image ;
_dgbf *_gc .ChartSpace ;_dddeb int ;_faad int64 ;_abgg int ;_gfbb int64 ;_bgc int ;_gag int64 ;_fag int ;_effb int64 ;};func (_febe *convertContext )getSymbolsFromR (_eefe []*_ed .CT_RElt ,_dge *style )[]*symbol {_cfed :=[]*symbol {};for _ ,_ffa :=range _eefe {_agad :=_febe .combineCellStyleWithRPrElt (_dge ,_ffa .RPr );
for _ ,_ffbe :=range _ffa .T {_cfed =append (_cfed ,&symbol {_ddebc :string (_ffbe ),_cedf :_febe .makeTextStyleFromCellStyle (_agad )});};};return _cfed ;};type style struct{_cddd *string ;_fccb *string ;_bbd *float64 ;_bbce *string ;_cbba *bool ;_ddde *bool ;
_acaf *bool ;_aef *bool ;_fac *bool ;_edd *border ;_gfd *border ;_adg *border ;_bbbf *border ;_baga bool ;_dfg _ed .ST_VerticalAlignment ;_accdb _ed .ST_HorizontalAlignment ;};func (_afbb *convertContext )makeCells (){_dea :=_afbb ._fgbe ;_fff :=_dea .Rows ();
_gac :=0;for _bfc ,_edb :=range _afbb ._cdgg {if _bfc < _afbb ._dcc ||(_bfc > _afbb ._bbfe &&_afbb ._bbfe > 0){continue ;};_edb ._fcda =[]*cell {};_ageb :=0.0;_afae :=_edb ._bdg ;if _edb ._ebfd {_gee :=_fff [_gac ];_gac ++;_caf :=_edb ._gedc ;for _ ,_acgd :=range _gee .Cells (){_gcd ,_bda :=_g .ParseCellReference (_acgd .Reference ());
if _bda !=nil {_c .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_bda );continue ;};if int (_gcd .ColumnIdx )< _afbb ._gecg ||(int (_gcd .ColumnIdx )> _afbb ._efad &&_afbb ._efad > 0){continue ;
};_fbff :=_afbb ._fbge [_gcd .ColumnIdx ];_aea :=_fbff ._edcg ;_eca :=_aea ;_afga :=_fbff ._fec ;var _dbb ,_gbg ,_aeac ,_bbc bool ;for _ ,_bbcd :=range _afbb ._dca {if _gcd .RowIdx >=_bbcd ._dec &&_gcd .RowIdx <=_bbcd ._geg &&_gcd .ColumnIdx >=_bbcd ._bfbd &&_gcd .ColumnIdx <=_bbcd ._cbebd {if _gcd .ColumnIdx ==_bbcd ._bfbd &&_gcd .RowIdx ==_bbcd ._dec {_aea =_bbcd ._aafd ;
_caf =_bbcd ._cfda ;};_dbb =_gcd .RowIdx !=_bbcd ._dec ;_gbg =_gcd .RowIdx !=_bbcd ._geg ;_aeac =_gcd .ColumnIdx !=_bbcd ._bfbd ;_bbc =_gcd .ColumnIdx !=_bbcd ._cbebd ;};};var _fa *style ;for _ ,_eab :=range _afbb ._feef {_fea ,_dfd ,_ecaf :=_g .ParseRangeReference (_eab .Reference ());
if _ecaf !=nil ||_fea .RowIdx > _gcd .RowIdx ||_fea .ColumnIdx > _gcd .ColumnIdx ||_dfd .RowIdx < _gcd .RowIdx ||_dfd .ColumnIdx < _gcd .ColumnIdx ||_afbb ._bfcc .StyleSheet .X ().TableStyles ==nil {continue ;};_ceb :=_gcd .RowIdx ==_fea .RowIdx ;for _ ,_dgg :=range _afbb ._bfcc .StyleSheet .X ().TableStyles .TableStyle {if _eab .X ().TableStyleInfo .NameAttr !=nil &&_dgg .NameAttr ==*_eab .X ().TableStyleInfo .NameAttr {for _ ,_gfgc :=range _dgg .TableStyleElement {if !_ceb &&_gfgc .TypeAttr ==_ed .ST_TableStyleTypeWholeTable {_fa =_afbb .getDxfStyle (_gfgc .DxfIdAttr );
};if _ceb &&_gfgc .TypeAttr ==_ed .ST_TableStyleTypeHeaderRow {_fa =_afbb .getDxfStyle (_gfgc .DxfIdAttr );};};};};};_dab :=_afbb .getStyleFromCell (_acgd ,_afae ,_afga ,_fa );var _fded ,_adf ,_deg bool ;var _dgb ,_afad ,_ecd ,_efa *border ;var _bcb _ed .ST_VerticalAlignment ;
var _aad _ed .ST_HorizontalAlignment ;if _dab !=nil {if !_dbb {_dgb =_dab ._edd ;};if !_gbg {_afad =_dab ._gfd ;};if !_aeac {_ecd =_dab ._adg ;};if !_bbc {_efa =_dab ._bbbf ;};if _afad !=nil &&_afad ._fga > _ageb {_ageb =_afad ._fga ;};_bcb =_dab ._dfg ;
_aad =_dab ._accdb ;if _dab ._aef !=nil {_fded =*_dab ._aef ;};if _dab ._fac !=nil {_adf =*_dab ._fac ;};_deg =_dab ._baga ;};var _geeg _bbe .Color ;if _dab !=nil &&_dab ._cddd !=nil {_geeg =_bbe .ColorRGBFromHex (*_dab ._cddd );};_gdg ,_dda :=_afbb .getContentFromCell (_dea ,_acgd ,_dab ,_aea ,_deg );
_bab :=&cell {_fbfd :_dda ,_daac :_aea ,_eae :_eca ,_dcda :_caf ,_gfag :_gdg ,_cgagdg :_dgb ,_dfbd :_afad ,_cafgd :_ecd ,_becc :_efa ,_gfaa :_fded ,_bebe :_adf ,_cged :_geeg };_afbb .alignSymbolsHorizontally (_bab ,_aad );_afbb .alignSymbolsVertically (_bab ,_bcb );
_edb ._fcda =append (_edb ._fcda ,_bab );};};_edb ._egag =_ageb ;};};func _gga (_bfbc []*symbol )float64 {_gcc :=0.0;for _ ,_ffe :=range _bfbc {_gcc +=_ffe ._dag ;};return _gcc ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_a .PdfFont ){_ec .RegisterFont (name ,style ,font );};func (_fdg *convertContext )distributeAnchors (){for _ ,_bfcg :=range _fdg ._afadg {_gae ,_cae :=_bfcg ._dddeb ,_bfcg ._faad ;_dbeg ,_edcd :=_bfcg ._abgg ,_bfcg ._gfbb ;
_bbae ,_fbfa :=_bfcg ._bgc ,_bfcg ._gag ;_fbea ,_cgbc :=_bfcg ._fag ,_bfcg ._effb ;if _gae < _fdg ._dcc ||(_bbae > _fdg ._bbfe &&_fdg ._bbfe > 0){continue ;};if _dbeg < _fdg ._gecg ||(_fbea > _fdg ._efad &&_fdg ._efad > 0){continue ;};var _bed ,_dce ,_fca ,_dba *page ;
for _ ,_ffc :=range _fdg ._bggdb {for _ ,_cge :=range _ffc ._dcdf {if _gae >=_cge ._ecc ._fge &&_gae < _cge ._ecc ._acbae {if _dbeg >=_cge ._bebd ._cfd &&_dbeg < _cge ._bebd ._gaaa {_cge ._dfdc =true ;_bed =_cge ;};if _fbea >=_cge ._bebd ._cfd &&_fbea < _cge ._bebd ._gaaa {_cge ._dfdc =true ;
_dce =_cge ;};};if _bbae >=_cge ._ecc ._fge &&_bbae < _cge ._ecc ._acbae {if _dbeg >=_cge ._bebd ._cfd &&_dbeg < _cge ._bebd ._gaaa {_cge ._dfdc =true ;_dba =_cge ;};if _fbea >=_cge ._bebd ._cfd &&_fbea < _cge ._bebd ._gaaa {_cge ._dfdc =true ;_fca =_cge ;
};};};};_fgf :=_bed !=_dce ;_baed :=_bed !=_dba ;if _fgf &&_baed {_bad :=_fdg ._fbge [_dbeg ]._aefa +_gg .FromEMU (_edcd );_gdag :=_bed ._bebd ._faa ;_dcd :=_fdg ._fbge [_fbea ]._aefa +_gg .FromEMU (_cgbc );_eed :=_fdg ._cdgg [_gae ]._ded +_gg .FromEMU (_cae );
_fcc :=float64 (_bed ._ecc ._agda );_gdc :=_fdg ._cdgg [_bbae ]._ded +_gg .FromEMU (_fbfa );_bfd :=_dcd +_gdag -_bad ;_abbc :=_gdc +_fcc -_eed ;_dcg :=_fdg .imageFromAnchor (_bfcg ,_bfd ,_abbc );_bed ._ecge =append (_bed ._ecge ,_fdg .getImage (_dcg ,_abbc ,_bfd ,_bad ,_eed ,_gdag -_bad ,_fcc -_eed ,_ec .ImgPart_lt ));
_dce ._ecge =append (_dce ._ecge ,_fdg .getImage (_dcg ,_abbc ,_bfd ,0,_eed ,_gdag -_bad ,_fcc -_eed ,_ec .ImgPart_rt ));_dba ._ecge =append (_dba ._ecge ,_fdg .getImage (_dcg ,_abbc ,_bfd ,_bad ,0,_gdag -_bad ,_fcc -_eed ,_ec .ImgPart_lb ));_fca ._ecge =append (_fca ._ecge ,_fdg .getImage (_dcg ,_abbc ,_bfd ,0,0,_gdag -_bad ,_fcc -_eed ,_ec .ImgPart_rb ));
}else if _fgf {_befc :=_fdg ._cdgg [_gae ]._ded +_gg .FromEMU (_cae );_ece :=_fdg ._cdgg [_bbae ]._ded +_gg .FromEMU (_fbfa );_acab :=_fdg ._fbge [_dbeg ]._aefa +_gg .FromEMU (_edcd );_ebga :=_bed ._bebd ._faa ;_dfbf :=_fdg ._fbge [_fbea ]._aefa +_gg .FromEMU (_cgbc );
_abfd :=_dfbf +_ebga -_acab ;_cbc :=_ece -_befc ;_edcf :=_fdg .imageFromAnchor (_bfcg ,_abfd ,_cbc );_bed ._ecge =append (_bed ._ecge ,_fdg .getImage (_edcf ,_cbc ,_abfd ,_acab ,_befc ,_ebga -_acab ,0,_ec .ImgPart_l ));_dce ._ecge =append (_dce ._ecge ,_fdg .getImage (_edcf ,_cbc ,_abfd ,0,_befc ,_ebga -_acab ,0,_ec .ImgPart_r ));
}else if _baed {_efc :=_fdg ._fbge [_dbeg ]._aefa +_gg .FromEMU (_edcd );_gedf :=_fdg ._fbge [_fbea ]._aefa +_gg .FromEMU (_cgbc );_dbbd :=_fdg ._cdgg [_gae ]._ded +_gg .FromEMU (_cae );_edbc :=float64 (_bed ._ecc ._agda );_dcb :=_fdg ._cdgg [_bbae ]._ded +_gg .FromEMU (_fbfa );
_ebe :=_gedf -_efc ;_ecf :=_dcb +_edbc -_dbbd ;_ecfa :=_fdg .imageFromAnchor (_bfcg ,_ebe ,_ecf );_bed ._ecge =append (_bed ._ecge ,_fdg .getImage (_ecfa ,_ecf ,_ebe ,_efc ,_dbbd ,0,_edbc -_dbbd ,_ec .ImgPart_t ));_dba ._ecge =append (_dba ._ecge ,_fdg .getImage (_ecfa ,_ecf ,_ebe ,_efc ,0,0,_edbc -_dbbd ,_ec .ImgPart_b ));
}else {_afc :=_fdg ._fbge [_dbeg ]._aefa +_gg .FromEMU (_edcd );_cda :=_fdg ._fbge [_fbea ]._aefa +_gg .FromEMU (_cgbc );_egee :=_fdg ._cdgg [_gae ]._ded +_gg .FromEMU (_cae );_accd :=_fdg ._cdgg [_bbae ]._ded +_gg .FromEMU (_fbfa );_cdg :=_cda -_afc ;
_gdf :=_accd -_egee ;_fgg :=_fdg .imageFromAnchor (_bfcg ,_cdg ,_gdf );_bed ._ecge =append (_bed ._ecge ,_fdg .getImage (_fgg ,_gdf ,_cdg ,_afc ,_egee ,0,0,_ec .ImgPart_whole ));};};};func (_efb *convertContext )getImage (_aeca _e .Image ,_dfba ,_cfcb ,_dac ,_ddg ,_cbeb ,_fggge float64 ,_dcdg _ec .ImgPart )*_bbe .Image {_ddg +=_efb ._bcge ;
_dac +=_efb ._ffca ;_edgf ,_dacf :=_ec .GetImage (_efb ._gcgf ,_aeca ,_dfba ,_cfcb ,_dac ,_ddg ,_cbeb ,_fggge ,_dcdg );if _dacf !=nil {_c .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_dacf );
return nil ;};return _edgf ;};func (_cbbd *convertContext )getDxfStyle (_bca *uint32 )*style {_bcc :=&style {};_aba :=false ;if _bca !=nil {var _adeb *_ed .CT_Dxf ;for _gedcg ,_fdga :=range _cbbd ._fcae .X ().Dxfs .Dxf {if uint32 (_gedcg )==*_bca {_adeb =_fdga ;
};};if _adeb ==nil {return nil ;};if _adeb .Fill !=nil &&_adeb .Fill .PatternFill !=nil {if _adeb .Fill .PatternFill .FgColor !=nil {_bcc ._cddd =_cbbd .getColorStringFromSmlColor (_adeb .Fill .PatternFill .FgColor );}else if _adeb .Fill .PatternFill .BgColor !=nil {_bcc ._cddd =_cbbd .getColorStringFromSmlColor (_adeb .Fill .PatternFill .BgColor );
};};_acfd :=_adeb .Font ;for _ ,_bdbe :=range _acfd .Name {if _bdbe !=nil {_bcc ._bbce =&_bdbe .ValAttr ;_aba =true ;break ;};};for _ ,_gaae :=range _acfd .B {if _gaae !=nil {_ace :=_gaae .ValAttr ==nil ||*_gaae .ValAttr ;_bcc ._cbba =&_ace ;_aba =true ;
break ;};};for _ ,_bgeef :=range _acfd .I {if _bgeef !=nil {_cde :=_bgeef .ValAttr ==nil ||*_bgeef .ValAttr ;_bcc ._ddde =&_cde ;_aba =true ;break ;};};for _ ,_fbb :=range _acfd .U {if _fbb !=nil {_gcee :=_fbb .ValAttr ==_ed .ST_UnderlineValuesSingle ||_fbb .ValAttr ==_ed .ST_UnderlineValuesUnset ;
_bcc ._acaf =&_gcee ;_aba =true ;break ;};};for _ ,_baa :=range _acfd .Sz {if _baa !=nil {_ebgae :=_baa .ValAttr ;_bcc ._bbd =&_ebgae ;_aba =true ;break ;};};for _ ,_bac :=range _acfd .VertAlign {if _bac !=nil {_addf :=_bac .ValAttr ==_df .ST_VerticalAlignRunSuperscript ;
_bcc ._aef =&_addf ;_gbdf :=_bac .ValAttr ==_df .ST_VerticalAlignRunSubscript ;_bcc ._fac =&_gbdf ;_aba =true ;break ;};};for _ ,_ggfb :=range _acfd .Color {if _ggfb !=nil {_bcc ._fccb =_cbbd .getColorStringFromSmlColor (_ggfb );_aba =true ;break ;};};
_cgbb :=_adeb .Border ;if _cgbb .Top !=nil {_bcc ._edd =_cbbd .getBorder (_cgbb .Top );_aba =true ;};if _cgbb .Bottom !=nil {_bcc ._gfd =_cbbd .getBorder (_cgbb .Bottom );_aba =true ;};if _cgbb .Left !=nil {_bcc ._adg =_cbbd .getBorder (_cgbb .Left );_aba =true ;
};if _cgbb .Right !=nil {_bcc ._bbbf =_cbbd .getBorder (_cgbb .Right );_aba =true ;};if _adeb .Alignment !=nil {if _ddba :=_adeb .Alignment .VerticalAttr ;_ddba !=_ed .ST_VerticalAlignmentUnset {_bcc ._dfg =_ddba ;_aba =true ;};if _ceda :=_adeb .Alignment .HorizontalAttr ;
_ceda !=_ed .ST_HorizontalAlignmentUnset {_bcc ._accdb =_ceda ;_aba =true ;};};};if _aba {return _bcc ;};return nil ;};type rowspan struct{_agda float64 ;_fge int ;_acbae int ;};func (_eaac *convertContext )getColorFromTheme (_ffcd uint32 )string {_afcd :=_eaac ._bfcc .Themes ();
if len (_afcd )!=0{_cgge :=_afcd [0];if _gbcf :=_cgge .ThemeElements ;_gbcf !=nil {if _cfeda :=_gbcf .ClrScheme ;_cfeda !=nil {switch _ffcd {case 0:return _ec .GetColorStringFromDmlColor (_cfeda .Lt1 );case 1:return _ec .GetColorStringFromDmlColor (_cfeda .Dk1 );
case 2:return _ec .GetColorStringFromDmlColor (_cfeda .Lt2 );case 3:return _ec .GetColorStringFromDmlColor (_cfeda .Dk2 );case 4:return _ec .GetColorStringFromDmlColor (_cfeda .Accent1 );case 5:return _ec .GetColorStringFromDmlColor (_cfeda .Accent2 );
case 6:return _ec .GetColorStringFromDmlColor (_cfeda .Accent3 );case 7:return _ec .GetColorStringFromDmlColor (_cfeda .Accent4 );case 8:return _ec .GetColorStringFromDmlColor (_cfeda .Accent5 );case 9:return _ec .GetColorStringFromDmlColor (_cfeda .Accent6 );
};};};};return "";};func (_dfa *convertContext )makePagespans (){_dfa ._bggdb =[]*pagespan {};_gfb :=0.0;_gbb :=0;for _ade ,_bff :=range _dfa ._fbge {_bef :=_bff ._edcg ;if _gfb +_bef <=_dfa ._acabg {_bff ._aefa =_gfb ;_gfb +=_bef ;}else {_bff ._aefa =0;
_dfa ._bggdb =append (_dfa ._bggdb ,&pagespan {_faa :_gfb ,_cfd :_gbb ,_gaaa :_ade });_gfb =_bef ;_gbb =_ade ;};};_dfa ._bggdb =append (_dfa ._bggdb ,&pagespan {_faa :_gfb ,_cfd :_gbb ,_gaaa :len (_dfa ._fbge )});};const (FontStyle_Regular FontStyle =0;
FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _ec .RegisterFontsFromDirectory (dirName )};var _ffag =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
func (_eef *convertContext )makeMergedCells (){_bgd :=[]*mergedCell {};for _ ,_acfc :=range _eef ._fgbe .MergedCells (){_dbec ,_ce ,_bcfa :=_g .ParseRangeReference (_acfc .Reference ());if _bcfa !=nil {_c .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_bcfa );
continue ;};_ege :=mergedCell {_dec :_dbec .RowIdx ,_bfbd :_dbec .ColumnIdx ,_geg :_ce .RowIdx ,_cbebd :_ce .ColumnIdx };for _dga :=_ege ._bfbd -1;_dga < _ege ._cbebd ;_dga ++{_ege ._aafd +=_eef ._fbge [_dga ]._edcg ;};for _fbe :=_ege ._dec -1;_fbe < _ege ._geg ;
_fbe ++{_ege ._cfda +=_eef ._cdgg [_fbe ]._gedc ;};_bgd =append (_bgd ,&_ege );};_eef ._dca =_bgd ;};type colInfo struct{_aefa float64 ;_edcg float64 ;_fec *style ;};type pageRow struct{_ebfa int ;_dbdg []*cell ;};func (_cbg *convertContext )getColorStringFromSmlColor (_cdag *_ed .CT_Color )*string {var _baaa string ;
if _cdag .RgbAttr !=nil {_baaa =*_cdag .RgbAttr ;}else if _cdag .IndexedAttr !=nil &&*_cdag .IndexedAttr < 64{_baaa =_ffag [*_cdag .IndexedAttr ];}else if _cdag .ThemeAttr !=nil {_ebfb :=*_cdag .ThemeAttr ;_baaa =_cbg .getColorFromTheme (_ebfb );};if _baaa ==""{return nil ;
};if len (_baaa )> 6{_baaa =_baaa [(len (_baaa )-6):];};if _cdag .TintAttr !=nil {_debe :=*_cdag .TintAttr ;_baaa =_ec .AdjustColorByTint (_baaa ,_debe );};_baaa ="\u0023"+_baaa ;return &_baaa ;};const _dd =0.0;var _abg =_edab (1);func (_befe *convertContext )getStyle (_caea *uint32 )*style {_dfdb :=&style {};
_efcg :=false ;if _caea !=nil {_gab :=_befe ._fcae .GetCellStyle (*_caea );if _gab .GetFill ()!=nil &&_gab .GetFill ().PatternFill !=nil {if _gab .GetFill ().PatternFill .FgColor !=nil {_dfdb ._cddd =_befe .getColorStringFromSmlColor (_gab .GetFill ().PatternFill .FgColor );
}else if _gab .GetFill ().PatternFill .BgColor !=nil {_dfdb ._cddd =_befe .getColorStringFromSmlColor (_gab .GetFill ().PatternFill .BgColor );};};_bgea :=_gab .GetFont ();for _ ,_baag :=range _bgea .Name {if _baag !=nil {_dfdb ._bbce =&_baag .ValAttr ;
_efcg =true ;break ;};};for _ ,_gbfb :=range _bgea .B {if _gbfb !=nil {_ebfgf :=_gbfb .ValAttr ==nil ||*_gbfb .ValAttr ;_dfdb ._cbba =&_ebfgf ;_efcg =true ;break ;};};for _ ,_abag :=range _bgea .I {if _abag !=nil {_becd :=_abag .ValAttr ==nil ||*_abag .ValAttr ;
_dfdb ._ddde =&_becd ;_efcg =true ;break ;};};for _ ,_abab :=range _bgea .U {if _abab !=nil {_gagd :=_abab .ValAttr ==_ed .ST_UnderlineValuesSingle ||_abab .ValAttr ==_ed .ST_UnderlineValuesUnset ;_dfdb ._acaf =&_gagd ;_efcg =true ;break ;};};for _ ,_adc :=range _bgea .Sz {if _adc !=nil {_ebfdc :=_adc .ValAttr ;
_dfdb ._bbd =&_ebfdc ;_efcg =true ;break ;};};for _ ,_afdd :=range _bgea .VertAlign {if _afdd !=nil {_afac :=_afdd .ValAttr ==_df .ST_VerticalAlignRunSuperscript ;_dfdb ._aef =&_afac ;_aae :=_afdd .ValAttr ==_df .ST_VerticalAlignRunSubscript ;_dfdb ._fac =&_aae ;
_efcg =true ;break ;};};for _ ,_edcde :=range _bgea .Color {if _edcde !=nil {_dfdb ._fccb =_befe .getColorStringFromSmlColor (_edcde );_efcg =true ;break ;};};_dae :=_gab .GetBorder ();if _dae .Top !=nil {_dfdb ._edd =_befe .getBorder (_dae .Top );_efcg =true ;
};if _dae .Bottom !=nil {_dfdb ._gfd =_befe .getBorder (_dae .Bottom );_efcg =true ;};if _dae .Left !=nil {_dfdb ._adg =_befe .getBorder (_dae .Left );_efcg =true ;};if _dae .Right !=nil {_dfdb ._bbbf =_befe .getBorder (_dae .Right );_efcg =true ;};if _gab .Wrapped (){_dfdb ._baga =true ;
_efcg =true ;};if _dbee :=_gab .GetVerticalAlignment ();_dbee !=_ed .ST_VerticalAlignmentUnset {_dfdb ._dfg =_dbee ;_efcg =true ;};if _fbgf :=_gab .GetHorizontalAlignment ();_fbgf !=_ed .ST_HorizontalAlignmentUnset {_dfdb ._accdb =_fbgf ;_efcg =true ;};
};if _efcg {return _dfdb ;};return nil ;};func (_acge *convertContext )getSymbolsFromString (_dbeb string ,_fed *style )[]*symbol {_ffffa :=[]*symbol {};_aaae :=_acge .makeTextStyleFromCellStyle (_fed );for _ ,_ebfg :=range _dbeb {_ffffa =append (_ffffa ,&symbol {_ddebc :string (_ebfg ),_cedf :_aaae });
};return _ffffa ;};func (_ecg *convertContext )makeCols (){_acg :=_ecg ._fgbe ;_ega :=_acg .X ();_adbe :=[]*colInfo {};_ebg :=[]colWidthRange {};if _fb :=_ega .Cols ;len (_fb )> 0{for _ ,_aag :=range _fb [0].Col {_abf :=_af ;if _gfg :=_aag .WidthAttr ;
_gfg !=nil {if *_gfg > 0.83{*_gfg -=0.83;};if *_gfg <=1{_abf =*_gfg *11;}else {_abf =5+*_gfg *6;};};_fdc :=int (_aag .MinAttr -1);_fc :=int (_aag .MaxAttr -1);_ebg =append (_ebg ,colWidthRange {_fcce :_fdc ,_cafb :_fc ,_cebf :_abf ,_adbd :_ecg .getStyle (_aag .StyleAttr )});
};};_daa :=0;for _fgc :=0;_fgc <=_ecg ._efd ;_fgc ++{if _fgc < _ecg ._gecg ||(_fgc > _ecg ._efad &&_ecg ._efad > 0){continue ;};var _cf float64 ;var _gea *style ;if _daa >=len (_ebg ){_cf =_af ;}else {_afa :=_ebg [_daa ];if _fgc >=_afa ._fcce &&_fgc <=_afa ._cafb {_cf =_afa ._cebf ;
_gea =_afa ._adbd ;if _fgc ==_afa ._cafb {_daa ++;};}else {_cf =_af ;};};_adbe =append (_adbe ,&colInfo {_edcg :_cf ,_fec :_gea });};_afb :=0.0;for _ ,_caa :=range _adbe {_afb +=_caa ._edcg ;};_ecg ._gca =1.0;if _afb > _ecg ._acabg {_ecg ._gca =_ecg ._acabg /_afb ;
for _ ,_ggcf :=range _adbe {_ggcf ._edcg *=_ecg ._gca ;};};_ecg ._fbge =_adbe ;};func (_cdbg *convertContext )addRowToPage (_cccf []*cell ,_dbdc int ){_adbb :=0.0;_bfb :=_cdbg ._acabg ;for _ ,_cag :=range _cccf {if len (_cag ._gfag )!=0{_cag ._bcbe =_adbb ;
_adbb =_cag ._fggc +_cag ._daac ;};};for _acac :=len (_cccf )-1;_acac >=0;_acac --{_gff :=_cccf [_acac ];if len (_gff ._gfag )!=0{_gff ._gaf =_bfb ;_bfb =_gff ._fggc ;};};_cdbg ._fabfc ._gcfg =append (_cdbg ._fabfc ._gcfg ,&pageRow {_ebfa :_dbdc ,_dbdg :_cccf });
};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_cg .Sheet )*_bbe .Creator {_abb :=s .X ();if _abb ==nil {return nil ;};var _aga _bbe .PageSize ;_bdc :=true ;_cc :=false ;if _abb .SheetPr !=nil &&_abb .SheetPr .PageSetUpPr !=nil &&_abb .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_abb .SheetPr .PageSetUpPr .FitToPageAttr {_cc =true ;
};if _ea :=_abb .PageSetup ;_ea !=nil {_bdc =_ea .OrientationAttr ==_ed .ST_OrientationLandscape ;if _bdcg :=_ea .PaperSizeAttr ;_bdcg !=nil {_aga =_cabf [*_bdcg ];};};if (_aga ==_bbe .PageSize {}){_aga =_bbe .PageSizeA4 ;};if _bdc {_aga [0],_aga [1]=_aga [1],_aga [0];
};_bc :=_bbe .New ();_bc .SetPageSize (_aga );var _gf ,_db ,_bcg ,_def float64 ;if _abc :=_abb .PageMargins ;_abc !=nil {_bcg =_abc .LeftAttr ;_def =_abc .RightAttr ;_gf =_abc .TopAttr ;_db =_abc .BottomAttr ;};if _bcg < _agd {_bcg =_agd ;};if _def < _agd {_def =_agd ;
};if _gf < _dd {_gf =_dd ;};if _db < _dd {_db =_dd ;};_gf *=_gg .Inch ;_db *=_gg .Inch ;_bcg *=_gg .Inch ;_def *=_gg .Inch ;_bc .SetPageMargins (_bcg ,_def ,_gf ,_db );_fe :=s .Workbook ();var _gd *_ac .Theme ;if len (_fe .Themes ())> 0{_gd =_fe .Themes ()[0];
};var _cgb ,_afg ,_bf ,_edg int ;for _ ,_gdd :=range _fe .DefinedNames (){if _gdd .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_gb ,_cgf ,_gbd ,_ae :=_ec .ParseExcelRange (_gdd .Content ());if _ae ==nil &&s .Name ()==_gb {_cgb =int (_cgf .ColumnIdx );
_afg =int (_gbd .ColumnIdx );_bf =int (_cgf .RowIdx );_edg =int (_gbd .RowIdx );};};};_dfb :=[]_cg .Table {};if _abb .TableParts !=nil &&_abb .TableParts .TablePart !=nil {_bcf :=0;_dbe :=s .Workbook ().Tables ();_be .Slice (_dbe [:],func (_ba ,_gcg int )bool {return _dbe [_ba ].X ().IdAttr < _dbe [_gcg ].X ().IdAttr });
for _ ,_da :=range s .Workbook ().Sheets (){if _da .Name ()==s .Name (){break ;}else {if _da .X ().TableParts !=nil &&_da .X ().TableParts .TablePart !=nil {_bcf +=len (_da .X ().TableParts .TablePart );};};};if len (_dbe )>=_bcf +len (_abb .TableParts .TablePart ){_dfb =append (_dfb ,_dbe [_bcf :_bcf +len (_abb .TableParts .TablePart )]...);
};};_ddc :=&convertContext {_gcgf :_bc ,_fgbe :s ,_bfcc :s .Workbook (),_edbg :_gd ,_fcae :&s .Workbook ().StyleSheet ,_bcge :_gf ,_ffca :_bcg ,_addd :_aga [1]-_db -_gf ,_acabg :_aga [0]-_def -_bcg ,_gecg :_cgb ,_efad :_afg ,_dcc :_bf ,_bbfe :_edg ,_dgee :_cc ,_feef :_dfb };
_ddc .makeAnchors ();_ddc .determineMaxIndexes ();if _ddc ._ecfad ==0&&_ddc ._efd ==0{_bc .NewPage ();return _bc ;};_ddc .makeCols ();_ddc .makeRows ();_ddc .makeMergedCells ();_ddc .makeCells ();_ddc .makePagespans ();_ddc .makeRowspans ();_ddc .makePages ();
_ddc .fillPages ();_ddc .distributeAnchors ();_ddc .drawSheet (_bdc );return _bc ;};func (_bfdc *convertContext )getStyleFromCell (_abfa _cg .Cell ,_ddcg ,_gbf ,_edbf *style )*style {if _edbf !=nil {_eegg (_edbf ,_ddcg );_eegg (_edbf ,_gbf );return _edbf ;
};_eea :=_abfa .X ();_cef :=_bfdc .getStyle (_eea .SAttr );_eegg (_cef ,_ddcg );_eegg (_cef ,_gbf );return _cef ;};func (_dbbg *convertContext )makeRowspans (){var _fdad float64 ;_ffb :=0;for _beff ,_bae :=range _dbbg ._cdgg {_fbeg :=_bae ._gedc +_bae ._egag ;
if _fdad +_fbeg <=_dbbg ._addd {_bae ._ded =_fdad ;_fdad +=_fbeg ;}else {_dbbg ._bdef =append (_dbbg ._bdef ,&rowspan {_agda :_fdad ,_fge :_ffb ,_acbae :_beff });_ffb =_beff ;_bae ._ded =0;_fdad =_fbeg ;};};_dbbg ._bdef =append (_dbbg ._bdef ,&rowspan {_agda :_fdad ,_fge :_ffb ,_acbae :len (_dbbg ._cdgg )});
};func (_baba *convertContext )makeTextStyleFromCellStyle (_gege *style )*_bbe .TextStyle {_ddgg :=_baba ._gcgf .NewTextStyle ();if _gege ==nil {_ddgg .FontSize =_ec .DefaultFontSize ;_ddgg .Font =_ec .AssignStdFontByName (_ddgg ,_ec .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);
return &_ddgg ;};if _cabg (_gege ._acaf ){_ddgg .Underline =true ;_ddgg .UnderlineStyle =_bbe .TextDecorationLineStyle {Offset :0.5,Thickness :_edab (1/32)};};var _bcbb FontStyle ;if _cabg (_gege ._cbba )&&_cabg (_gege ._ddde ){_bcbb =FontStyle_BoldItalic ;
}else if _cabg (_gege ._cbba ){_bcbb =FontStyle_Bold ;}else if _cabg (_gege ._ddde ){_bcbb =FontStyle_Italic ;}else {_bcbb =FontStyle_Regular ;};_face :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _gege ._bbce !=nil {_face =*_gege ._bbce ;};if _bfdd ,_ebc :=_ec .StdFontsMap [_face ];
_ebc {_ddgg .Font =_ec .AssignStdFontByName (_ddgg ,_bfdd [_bcbb ]);}else if _eee :=_ec .GetRegisteredFont (_face ,_bcbb );_eee !=nil {_ddgg .Font =_eee ;}else {_c .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_face ,_bcbb );
_ddgg .Font =_ec .AssignStdFontByName (_ddgg ,_ec .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_bcbb ]);};if _gege ._bbd !=nil {_ddgg .FontSize =_d .Round (*_gege ._bbd *_baba ._gca );};if _gege ._fccb !=nil {_ddgg .Color =_bbe .ColorRGBFromHex (*_gege ._fccb );
};if _gege ._aef !=nil &&*_gege ._aef {_ddgg .FontSize *=_ag ;}else if _gege ._fac !=nil &&*_gege ._fac {_ddgg .FontSize *=_ag ;};return &_ddgg ;};func _cabg (_ccce *bool )bool {return _ccce !=nil &&*_ccce };func (_fde *convertContext )makeRows (){_acc :=[]*rowInfo {};
_ga :=_fde ._fgbe .Rows ();_gbc :=0;_bgee :=0.0;for _abfe ,_fda :=range _ga {if _abfe < _fde ._dcc ||(_abfe > _fde ._bbfe &&_fde ._bbfe > 0){continue ;};_gbc ++;_addg :=int (_fda .RowNumber ());if _addg > _gbc {for _gbe :=_gbc ;_gbe < _addg ;_gbe ++{_acc =append (_acc ,&rowInfo {_gedc :_ab /_fd });
_bgee +=_ab /_fd ;};_gbc =_addg ;};var _ddf float64 ;if _fda .X ().HtAttr ==nil {_ddf =_ab ;}else {_ddf =*_fda .X ().HtAttr ;};_acc =append (_acc ,&rowInfo {_gedc :_ddf /_fd ,_ebfd :true ,_bdg :_fde .getStyle (_fda .X ().SAttr )});_bgee +=_ddf /_fd ;};
for _aac :=len (_acc );_aac < _fde ._ecfad ;_aac ++{_acc =append (_acc ,&rowInfo {_gedc :_ab /_fd });_bgee +=_ab /_fd ;};if _fde ._dgee ||_bgee > _fde ._addd {for _ ,_bfa :=range _acc {_bfa ._gedc *=_fde ._gca ;};};_fde ._cdgg =_acc ;};type colWidthRange struct{_fcce int ;
_cafb int ;_cebf float64 ;_adbd *style ;};const _f =2;func (_bfac *convertContext )drawPage (_cec *page ){_agdb :=_bfac ._bcge ;_feb :=_bfac ._ffca ;for _ ,_bdb :=range _cec ._gcfg {_beb :=_bfac ._cdgg [_bdb ._ebfa ];for _ ,_bfe :=range _bdb ._dbdg {var _ebf float64 ;
if _bdb ._ebfa > 1{_ebf =_bfac ._cdgg [_bdb ._ebfa -1]._egag ;};var _cfb ,_aeg float64 ;if _aaf :=_bfe ._cgagdg ;_aaf !=nil {_cfb =_aaf ._fga ;};if _bgg :=_bfe ._dfbd ;_bgg !=nil {_aeg =_bgg ._fga ;};_cgee :=_agdb +_beb ._ded -0.5*(_ebf -_cfb );_gbga :=_agdb +_beb ._ded +_beb ._gedc +0.5*(_beb ._egag +_aeg );
_dcec :=_feb +_bfe ._fggc ;_ced :=_dcec +_bfe ._eae ;if _bfe ._cged !=nil &&_bfe ._cged !=_bbe .ColorBlack {_ec .FillRectangle (_bfac ._gcgf ,_dcec ,_cgee ,_ced -_dcec ,_gbga -_cgee ,_bfe ._cged );};};};for _ ,_dbbfb :=range _cec ._gcfg {_cbec :=_bfac ._cdgg [_dbbfb ._ebfa ];
for _ ,_bbeb :=range _dbbfb ._dbdg {_fggg :=_bbeb ._bcbe < _bbeb ._fggc ;_cbcf :=_bbeb ._gaf > _bbeb ._fggc +_bbeb ._daac ;var _dggb ,_cedg bool ;for _ ,_gbea :=range _bbeb ._gfag {for _ ,_dde :=range _gbea ._cdcd {if _fggg &&!_dggb {_dggb =_dde ._abe < 0;
};if _cbcf &&!_cedg {_cedg =_bbeb ._daac < _dde ._abe +_dde ._dag ;};if _bbeb ._fggc +_dde ._abe >=_bbeb ._bcbe &&_bbeb ._fggc +_dde ._abe +_dde ._dag <=_bbeb ._gaf {_bffd :=_bfac ._gcgf .NewStyledParagraph ();_abfc :=_feb +_bbeb ._fggc +_dde ._abe ;_afcb :=_agdb +_cbec ._ded +_gbea ._gfc -_dde ._acad -_edab (0.5);
_bffd .SetPos (_abfc ,_afcb );var _dddf *_bbe .TextChunk ;if _dde ._fecd !=""{_dddf =_bffd .AddExternalLink (_dde ._ddebc ,_dde ._fecd );}else {_dddf =_bffd .Append (_dde ._ddebc );};if _dde ._cedf !=nil {_dddf .Style =*_dde ._cedf ;};_bfac ._gcgf .Draw (_bffd );
};};};var _befb ,_gec ,_fad ,_fbg ,_bde ,_egg float64 ;var _cba ,_cafg ,_caeb ,_gbeg _bbe .Color ;if _eeg :=_bbeb ._cgagdg ;_eeg !=nil {_befb =_eeg ._fga ;_cba =_eeg ._bdga ;};if _ffff :=_bbeb ._dfbd ;_ffff !=nil {_gec =_ffff ._fga ;_cafg =_ffff ._bdga ;
};if _cab :=_bbeb ._cafgd ;_cab !=nil {_fad =_cab ._fga ;_bde =_fad /2;_caeb =_cab ._bdga ;};if _fba :=_bbeb ._becc ;_fba !=nil {_fbg =_fba ._fga ;_egg =_fbg /2;_gbeg =_fba ._bdga ;};var _cdc float64 ;if _dbbfb ._ebfa > 1{_cdc =_bfac ._cdgg [_dbbfb ._ebfa -1]._egag ;
};_bec :=_agdb +_cbec ._ded -0.5*(_cdc -_befb );_aee :=_agdb +_cbec ._ded +_cbec ._gedc +0.5*(_cbec ._egag +_gec );_egaa :=_feb +_bbeb ._fggc ;_cabe :=_egaa +_bbeb ._eae ;_ec .DrawLine (_bfac ._gcgf ,_egaa ,_bec ,_cabe ,_bec ,_befb ,_cba );_ec .DrawLine (_bfac ._gcgf ,_egaa ,_aee ,_cabe ,_aee ,_gec ,_cafg );
if !_dggb {_ec .DrawLine (_bfac ._gcgf ,_egaa -_bde ,_bec ,_egaa -_bde ,_aee ,_fad ,_caeb );};if !_cedg {_ec .DrawLine (_bfac ._gcgf ,_cabe -_egg ,_bec ,_cabe -_egg ,_aee ,_fbg ,_gbeg );};};};for _ ,_cgd :=range _cec ._ecge {if _cgd !=nil {_bfac ._gcgf .Draw (_cgd );
};};};type pagespan struct{_faa float64 ;_dcdf []*page ;_cfd int ;_gaaa int ;};type symbol struct{_ddebc string ;_abe float64 ;_acad float64 ;_dag float64 ;_cedf *_bbe .TextStyle ;_fecd string ;};const _ab =15.0;func _edab (_bbbg float64 )float64 {return _bbbg *_gg .Millimeter };
func (_cgg *convertContext )getContentFromCell (_badd *_cg .Sheet ,_gaa _cg .Cell ,_ggf *style ,_cgag float64 ,_fbfac bool )([]*line ,_ed .ST_CellType ){_efeg :=_gaa .X ();var _adfa []*symbol ;switch _efeg .TAttr {case _ed .ST_CellTypeS :_eba :=_efeg .V ;
if _eba !=nil {_cbb ,_bbf :=_bb .Atoi (*_eba );if _bbf ==nil {_ccd :=_cgg ._bfcc .SharedStrings .X ().Si [_cbb ];if _ccd .T !=nil {_adfa =_cgg .getSymbolsFromString (*_ccd .T ,_ggf );}else if _ccd .R !=nil {_adfa =_cgg .getSymbolsFromR (_ccd .R ,_ggf );
};};};case _ed .ST_CellTypeB :_gfa :=_efeg .V ;if _gfa !=nil {if *_gfa =="\u0030"{_adfa =_cgg .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_ggf );}else {_adfa =_cgg .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_ggf );};};case _ed .ST_CellTypeStr :if _efeg .F !=nil {_feg :=_cb .NewEvaluator ();
_cdbd :=_badd .FormulaContext ().Cell (_gaa .Reference (),_feg );_adfa =_cgg .getSymbolsFromString (_cdbd .Value (),_ggf );};default:_adfa =_cgg .getSymbolsFromString (_gaa .GetFormattedValue (),_ggf );};_ebef :=0.0;_fgce :=0.0;var _agbe []*line ;var _feac bool ;
if _ggf !=nil {if _ggf ._aef !=nil {if *_ggf ._aef {_feac =true ;};};if _ggf ._fac !=nil {if *_ggf ._fac {_feac =true ;};};};if _fbfac {_agbe =[]*line {};_aaa :=_cgag -2*_ggc ;_geee :=[]*symbol {};for _ ,_aed :=range _adfa {_fcf (_aed );if _ebef +_aed ._dag >=_aaa {_gcbd :=_egd (_geee );
if _feac {_gcbd /=_ag ;};_agbe =append (_agbe ,&line {_gfc :_fgce ,_cdcd :_geee ,_bdf :_gcbd });_geee =[]*symbol {_aed };_ebef =_aed ._dag ;_fgce +=_gcbd ;}else {_aed ._abe =_ebef ;_ebef +=_aed ._dag ;_geee =append (_geee ,_aed );};};_bggc :=_egd (_geee );
if _feac {_bggc /=_ag ;};if len (_geee )> 0{_agbe =append (_agbe ,&line {_gfc :_fgce ,_cdcd :_geee ,_bdf :_bggc });};}else {for _ ,_bgaf :=range _adfa {_fcf (_bgaf );_bgaf ._abe =_ebef ;_ebef +=_bgaf ._dag ;};if len (_adfa )> 0{_agbe =[]*line {&line {_cdcd :_adfa ,_bdf :_egd (_adfa )}};
};};_ggfd :=_efeg .TAttr ;if _ggfd ==_ed .ST_CellTypeUnset {_ggfd =_ed .ST_CellTypeN ;};return _agbe ,_ggfd ;};func (_add *convertContext )determineMaxIndexes (){var _afda ,_bcfe int ;_afda =int (_add ._fgbe .MaxColumnIdx ());_adb :=_add ._fgbe .Rows ();
if len (_adb )> 0{_bcfe =int (_adb [len (_adb )-1].RowNumber ());};for _ ,_acf :=range _add ._afadg {if _acf ._bgc >=_bcfe {_bcfe =_acf ._bgc +1;};if _acf ._fag >=_afda {_afda =_acf ._fag +1;};};_add ._ecfad =_bcfe ;_add ._efd =_afda ;};type cell struct{_fbfd _ed .ST_CellType ;
_cfcf int ;_fggc float64 ;_gfag []*line ;_daac float64 ;_eae float64 ;_dcda float64 ;_bcbe float64 ;_gaf float64 ;_ccg *_bbe .TextStyle ;_cgagdg *border ;_dfbd *border ;_cafgd *border ;_becc *border ;_gfaa bool ;_bebe bool ;_cged _bbe .Color ;};const _ag =0.64;
func (_acfb *convertContext )getBorder (_dfdge *_ed .CT_BorderPr )*border {_cfa :=&border {};switch _dfdge .StyleAttr {case _ed .ST_BorderStyleHair :_cfa ._fga =_bd /2;case _ed .ST_BorderStyleThin :_cfa ._fga =_bd ;case _ed .ST_BorderStyleMedium :_cfa ._fga =_bd *2;
case _ed .ST_BorderStyleThick :_cfa ._fga =_bd *4;};if _cfa ._fga ==0.0{return nil ;};if _cddda :=_dfdge .Color ;_cddda !=nil {_gddc :=_acfb .getColorStringFromSmlColor (_cddda );if _gddc !=nil {_cfa ._bdga =_bbe .ColorRGBFromHex (*_gddc );}else {_cfa ._bdga =_bbe .ColorBlack ;
};};return _cfa ;};const _ggc =3;func (_aaag *convertContext )alignSymbolsHorizontally (_ddb *cell ,_cdbc _ed .ST_HorizontalAlignment ){if _cdbc ==_ed .ST_HorizontalAlignmentUnset {switch _ddb ._fbfd {case _ed .ST_CellTypeB :_cdbc =_ed .ST_HorizontalAlignmentCenter ;
case _ed .ST_CellTypeN :_cdbc =_ed .ST_HorizontalAlignmentRight ;default:_cdbc =_ed .ST_HorizontalAlignmentLeft ;};};var _afce float64 ;for _ ,_eec :=range _ddb ._gfag {switch _cdbc {case _ed .ST_HorizontalAlignmentLeft :_afce =_ggc ;case _ed .ST_HorizontalAlignmentRight :_ddeb :=_gga (_eec ._cdcd );
_afce =_ddb ._daac -_ggc -_ddeb ;case _ed .ST_HorizontalAlignmentCenter :_fffg :=_gga (_eec ._cdcd );_afce =(_ddb ._daac -_fffg )/2;};for _ ,_ageg :=range _eec ._cdcd {_ageg ._abe +=_afce ;};};};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_ec .FontStyle ;type border struct{_fga float64 ;_bdga _bbe .Color ;};const _ff =1.5;func (_cad *convertContext )imageFromAnchor (_dfe *anchor ,_abgb ,_bcd float64 )_e .Image {if _dfe ._dfdg !=nil {return _dfe ._dfdg ;};if _dfe ._dgbf !=nil {_cbce ,_fbc :=_ec .MakeImageFromChartSpace (_dfe ._dgbf ,_abgb ,_bcd ,_cad ._edbg ,_cad ._bfcc );
if _fbc !=nil {_c .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_fbc );return nil ;
};return _cbce ;};return nil ;};