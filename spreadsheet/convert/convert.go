//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_ba "github.com/unidoc/unioffice/common/logger";_abd "github.com/unidoc/unioffice/common/tempstorage";_abf "github.com/unidoc/unioffice/internal/convertutils";_ec "github.com/unidoc/unioffice/measurement";_g "github.com/unidoc/unioffice/schema/soo/dml";
_d "github.com/unidoc/unioffice/schema/soo/dml/chart";_cf "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_bg "github.com/unidoc/unioffice/schema/soo/sml";_ab "github.com/unidoc/unioffice/spreadsheet";_e "github.com/unidoc/unioffice/spreadsheet/formula";
_be "github.com/unidoc/unioffice/spreadsheet/reference";_aa "github.com/unidoc/unipdf/v3/creator";_fe "github.com/unidoc/unipdf/v3/model";_f "image";_c "math";_a "sort";_fc "strconv";);const _cc =3;type symbol struct{_cafe string ;_efff float64 ;_caed float64 ;
_gfdb float64 ;_efdd *_aa .TextStyle ;_aagc string ;};func (_cdb *convertContext )makeAnchors (){_fg ,_ddd :=_cdb ._fdce .GetDrawing ();if _fg !=nil {for _ ,_cb :=range _fg .EG_Anchor {_cfd :=&anchor {};if _db :=_cb .TwoCellAnchor ;_db !=nil {_geb ,_gcbf :=_db .From ,_db .To ;
if _geb ==nil ||_gcbf ==nil {return ;};_cfd ._cbcf =int (_geb .Row );_cfd ._gegc =_abf .FromSTCoordinate (_geb .RowOff );_cfd ._cdda =int (_geb .Col );_cfd ._fccg =_abf .FromSTCoordinate (_geb .ColOff );_cfd ._ddfe =int (_gcbf .Row );_cfd ._acec =_abf .FromSTCoordinate (_gcbf .RowOff );
_cfd ._ecf =int (_gcbf .Col );_cfd ._cga =_abf .FromSTCoordinate (_gcbf .ColOff );if _gce :=_db .Choice ;_gce !=nil {if _gg :=_gce .Pic ;_gg !=nil {if _gcd :=_gg .BlipFill ;_gcd !=nil {if _ced :=_gcd .Blip ;_ced !=nil {if _ddf :=_ced .EmbedAttr ;_ddf !=nil {for _ ,_bbf :=range _ddd .X ().Relationship {if _bbf .IdAttr ==*_ddf {for _ ,_fa :=range _cdb ._fbdb .Images {if _fa .Target ()==_bbf .TargetAttr {_ea ,_fef :=_abd .Open (_fa .Path ());
if _fef !=nil {_ba .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_fef );continue ;};_ee ,_ ,_fef :=_f .Decode (_ea );if _fef !=nil {_ba .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_fef );
continue ;};_cfd ._efbb =_ee ;};};};};};};};}else if _ff :=_gce .GraphicFrame ;_ff !=nil {if _acb :=_ff .Graphic ;_acb !=nil {if _dc :=_acb .GraphicData ;_dc !=nil {for _ ,_gfa :=range _dc .Any {if _fgb ,_ccdb :=_gfa .(*_d .Chart );_ccdb {for _ ,_eef :=range _ddd .X ().Relationship {if _eef .IdAttr ==_fgb .IdAttr {_gge :=_cdb ._fbdb .GetChartByTargetId (_eef .TargetAttr );
if _gge !=nil {_cfd ._eebb =_gge ;};};};};};};};};};};if _cfd ._efbb !=nil ||_cfd ._eebb !=nil {_cdb ._begf =append (_cdb ._begf ,_cfd );};};};};func (_gbfa *convertContext )makeTextStyleFromCellStyle (_abag *style )*_aa .TextStyle {_egdg :=_gbfa ._gcee .NewTextStyle ();
if _abag ==nil {_egdg .FontSize =_abf .DefaultFontSize ;_egdg .Font =_abf .AssignStdFontByName (_egdg ,_abf .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_egdg ;};if _beaa (_abag ._egb ){_egdg .Underline =true ;_egdg .UnderlineStyle =_aa .TextDecorationLineStyle {Offset :0.5,Thickness :_caab (1/32)};
};var _fgd FontStyle ;if _beaa (_abag ._gged )&&_beaa (_abag ._cddc ){_fgd =FontStyle_BoldItalic ;}else if _beaa (_abag ._gged ){_fgd =FontStyle_Bold ;}else if _beaa (_abag ._cddc ){_fgd =FontStyle_Italic ;}else {_fgd =FontStyle_Regular ;};_egc :="\u0064e\u0066\u0061\u0075\u006c\u0074";
if _abag ._ceed !=nil {_egc =*_abag ._ceed ;};if _feb ,_aedg :=_abf .StdFontsMap [_egc ];_aedg {_egdg .Font =_abf .AssignStdFontByName (_egdg ,_feb [_fgd ]);}else if _ffgg :=_abf .GetRegisteredFont (_egc ,_fgd );_ffgg !=nil {_egdg .Font =_ffgg ;}else {_ba .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_egc ,_fgd );
_egdg .Font =_abf .AssignStdFontByName (_egdg ,_abf .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_fgd ]);};if _abag ._gdde !=nil {_egdg .FontSize =_c .Round (*_abag ._gdde *_gbfa ._gega );};if _abag ._ebec !=nil {_egdg .Color =_aa .ColorRGBFromHex (*_abag ._ebec );
};if _abag ._dabc !=nil &&*_abag ._dabc {_egdg .FontSize *=_ga ;}else if _abag ._gabc !=nil &&*_abag ._gabc {_egdg .FontSize *=_ga ;};return &_egdg ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_fe .PdfFont ){_abf .RegisterFont (name ,style ,font );};const _baf =2;func (_fbb *convertContext )makeRows (){_aeb :=[]*rowInfo {};_da :=_fbb ._fdce .Rows ();_fcc :=0;_gad :=0.0;for _ddc ,_cgd :=range _da {if _ddc < _fbb ._gefd ||(_ddc > _fbb ._edcg &&_fbb ._edcg > 0){continue ;
};_fcc ++;_gaf :=int (_cgd .RowNumber ());if _gaf > _fcc {for _fbba :=_fcc ;_fbba < _gaf ;_fbba ++{_aeb =append (_aeb ,&rowInfo {_bbc :_bd /_eb });_gad +=_bd /_eb ;};_fcc =_gaf ;};var _bbgf float64 ;if _cgd .X ().HtAttr ==nil {_bbgf =_bd ;}else {_bbgf =*_cgd .X ().HtAttr ;
};_aeb =append (_aeb ,&rowInfo {_bbc :_bbgf /_eb ,_dbe :true ,_cea :_fbb .getStyle (_cgd .X ().SAttr )});_gad +=_bbgf /_eb ;};for _ddfc :=len (_aeb );_ddfc < _fbb ._gfdc ;_ddfc ++{_aeb =append (_aeb ,&rowInfo {_bbc :_bd /_eb });_gad +=_bd /_eb ;};if _fbb ._bgf ||_gad > _fbb ._ebeg {for _ ,_bab :=range _aeb {_bab ._bbc *=_fbb ._gega ;
};};_fbb ._ddbc =_aeb ;};type pagespan struct{_gcbb float64 ;_ffea []*page ;_bcgf int ;_dcff int ;};type rowspan struct{_cdca float64 ;_gcbaa int ;_acf int ;};func (_ggb *convertContext )determineMaxIndexes (){var _dcc ,_age int ;_dcc =int (_ggb ._fdce .MaxColumnIdx ());
_fefd :=_ggb ._fdce .Rows ();if len (_fefd )> 0{_age =int (_fefd [len (_fefd )-1].RowNumber ());};for _ ,_ebg :=range _ggb ._begf {if _ebg ._ddfe >=_age {_age =_ebg ._ddfe +1;};if _ebg ._ecf >=_dcc {_dcc =_ebg ._ecf +1;};};_ggb ._gfdc =_age ;_ggb ._gbb =_dcc ;
};func (_dcg *convertContext )makeRowspans (){var _bdf float64 ;_bgb :=0;for _gced ,_bbgc :=range _dcg ._ddbc {_cbf :=_bbgc ._bbc +_bbgc ._eaa ;if _bdf +_cbf <=_dcg ._ebeg {_bbgc ._dfgc =_bdf ;_bdf +=_cbf ;}else {_dcg ._gabeg =append (_dcg ._gabeg ,&rowspan {_cdca :_bdf ,_gcbaa :_bgb ,_acf :_gced });
_bgb =_gced ;_bbgc ._dfgc =0;_bdf =_cbf ;};};_dcg ._gabeg =append (_dcg ._gabeg ,&rowspan {_cdca :_bdf ,_gcbaa :_bgb ,_acf :len (_dcg ._ddbc )});};func (_dccg *convertContext )fillPages (){for _ead ,_bdg :=range _dccg ._gabeg {_dg :=_dccg ._ddbc [_bdg ._gcbaa :_bdg ._acf ];
for _cdbaa ,_aaeb :=range _dg {_aaa :=0;_abe :=0.0;_dfd :=[]*cell {};if _aaeb ._dbe {for _ ,_eda :=range _aaeb ._gfac {_gcgd :=_dccg ._eed [_aaa ];_dccg ._fade =_gcgd ._ffea [_ead ];_dccg ._fade ._beac =true ;_aff :=_eda ._fdgg ;if _abe +_aff > _gcgd ._gcbb {_dccg .addRowToPage (_dfd ,_cdbaa );
_dfd =[]*cell {_eda };_abe =_aff ;_aaa ++;}else {_eda ._cbad =_abe ;_dfd =append (_dfd ,_eda );_abe +=_aff ;};};if len (_dfd )> 0{_edac :=_dccg ._eed [_aaa ];_dccg ._fade =_edac ._ffea [_ead ];_dccg ._fade ._beac =true ;_dccg .addRowToPage (_dfd ,_cdbaa );
};};};};};const _fcf =1.5;func (_ceb *convertContext )getStyleFromCell (_edeb _ab .Cell ,_ggc ,_efc ,_dgcgb *style )*style {if _dgcgb !=nil {_fgc (_dgcgb ,_ggc );_fgc (_dgcgb ,_efc );return _dgcgb ;};_gdce :=_edeb .X ();_cdge :=_ceb .getStyle (_gdce .SAttr );
_fgc (_cdge ,_ggc );_fgc (_cdge ,_efc );return _cdge ;};func _bfab (_aefa []*symbol )float64 {_acbff :=0.0;for _ ,_cdeee :=range _aefa {if _cdeee ._caed > _acbff {_acbff =_cdeee ._caed ;};};return _acbff ;};const _ce =0.25;func (_cggb *convertContext )combineCellStyleWithRPrElt (_afa *style ,_dece *_bg .CT_RPrElt )*style {_efbf :=*_afa ;
_fgdg :=_cggb .getStyleFromRPrElt (_dece );if _fgdg ==nil {return &_efbf ;};if _fgdg ._ebec !=nil {_efbf ._ebec =_fgdg ._ebec ;};if _fgdg ._gdde !=nil {_efbf ._gdde =_fgdg ._gdde ;};if _fgdg ._ceed !=nil {_efbf ._ceed =_fgdg ._ceed ;};if _fgdg ._gged !=nil {_efbf ._gged =_fgdg ._gged ;
};if _fgdg ._cddc !=nil {_efbf ._cddc =_fgdg ._cddc ;};if _fgdg ._egb !=nil {_efbf ._egb =_fgdg ._egb ;};if _fgdg ._dabc !=nil {_efbf ._dabc =_fgdg ._dabc ;};if _fgdg ._gabc !=nil {_efbf ._gabc =_fgdg ._gabc ;};return &_efbf ;};func (_aab *convertContext )alignSymbolsHorizontally (_bbee *cell ,_ded _bg .ST_HorizontalAlignment ){if _ded ==_bg .ST_HorizontalAlignmentUnset {switch _bbee ._afgd {case _bg .ST_CellTypeB :_ded =_bg .ST_HorizontalAlignmentCenter ;
case _bg .ST_CellTypeN :_ded =_bg .ST_HorizontalAlignmentRight ;default:_ded =_bg .ST_HorizontalAlignmentLeft ;};};var _debd float64 ;for _ ,_cdgd :=range _bbee ._eefc {switch _ded {case _bg .ST_HorizontalAlignmentLeft :_debd =_cc ;case _bg .ST_HorizontalAlignmentRight :_bgc :=_ecag (_cdgd ._bgbg );
_debd =_bbee ._fcfa -_cc -_bgc ;case _bg .ST_HorizontalAlignmentCenter :_dbf :=_ecag (_cdgd ._bgbg );_debd =(_bbee ._fcfa -_dbf )/2;};for _ ,_bcfa :=range _cdgd ._bgbg {_bcfa ._efff +=_debd ;};};};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_abf .FontStyle ;var _eeff =map[uint32 ]_aa .PageSize {1:_aa .PageSize {8.5*_ec .Inch ,11*_ec .Inch },2:_aa .PageSize {8.5*_ec .Inch ,11*_ec .Inch },3:_aa .PageSize {11*_ec .Inch ,17*_ec .Inch },4:_aa .PageSize {17*_ec .Inch ,11*_ec .Inch },5:_aa .PageSize {8.5*_ec .Inch ,14*_ec .Inch },6:_aa .PageSize {5.5*_ec .Inch ,8.5*_ec .Inch },7:_aa .PageSize {7.5*_ec .Inch ,10*_ec .Inch },8:_aa .PageSize {_caab (297),_caab (420)},9:_aa .PageSize {_caab (210),_caab (297)},10:_aa .PageSize {_caab (210),_caab (297)},11:_aa .PageSize {_caab (148),_caab (210)},70:_aa .PageSize {_caab (105),_caab (148)},12:_aa .PageSize {_caab (250),_caab (354)},13:_aa .PageSize {_caab (182),_caab (257)},14:_aa .PageSize {8.5*_ec .Inch ,13*_ec .Inch },20:_aa .PageSize {4.125*_ec .Inch ,9.5*_ec .Inch },27:_aa .PageSize {_caab (110),_caab (220)},28:_aa .PageSize {_caab (162),_caab (229)},34:_aa .PageSize {_caab (250),_caab (176)},29:_aa .PageSize {_caab (324),_caab (458)},30:_aa .PageSize {_caab (229),_caab (324)},31:_aa .PageSize {_caab (114),_caab (162)},37:_aa .PageSize {3.88*_ec .Inch ,7.5*_ec .Inch },43:_aa .PageSize {_caab (100),_caab (148)},69:_aa .PageSize {_caab (200),_caab (148)}};
func _ecag (_cafb []*symbol )float64 {_gbeg :=0.0;for _ ,_gedg :=range _cafb {_gbeg +=_gedg ._gfdb ;};return _gbeg ;};func (_gbc *convertContext )getContentFromCell (_dcgc *_ab .Sheet ,_abc _ab .Cell ,_edg *style ,_aebc float64 ,_adcc bool )([]*line ,_bg .ST_CellType ){_efg :=_abc .X ();
var _gcca []*symbol ;switch _efg .TAttr {case _bg .ST_CellTypeS :_bgga :=_efg .V ;if _bgga !=nil {_gfae ,_aaf :=_fc .Atoi (*_bgga );if _aaf ==nil {_caaa :=_gbc ._fbdb .SharedStrings .X ().Si [_gfae ];if _caaa .T !=nil {_gcca =_gbc .getSymbolsFromString (*_caaa .T ,_edg );
}else if _caaa .R !=nil {_gcca =_gbc .getSymbolsFromR (_caaa .R ,_edg );};};};case _bg .ST_CellTypeB :_cee :=_efg .V ;if _cee !=nil {if *_cee =="\u0030"{_gcca =_gbc .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_edg );}else {_gcca =_gbc .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_edg );
};};case _bg .ST_CellTypeStr :if _efg .F !=nil {_geef :=_e .NewEvaluator ();_gdeg :=_dcgc .FormulaContext ().Cell (_abc .Reference (),_geef );_gcca =_gbc .getSymbolsFromString (_gdeg .Value (),_edg );};default:_gcca =_gbc .getSymbolsFromString (_abc .GetFormattedValue (),_edg );
};_cbg :=0.0;_abaf :=0.0;var _fac []*line ;var _addd bool ;if _edg !=nil {if _edg ._dabc !=nil {if *_edg ._dabc {_addd =true ;};};if _edg ._gabc !=nil {if *_edg ._gabc {_addd =true ;};};};if _adcc {_fac =[]*line {};_gfe :=_aebc -2*_cc ;_geba :=[]*symbol {};
for _ ,_cgc :=range _gcca {_ecb (_cgc );if _cbg +_cgc ._gfdb >=_gfe {_aaaaa :=_bfab (_geba );if _addd {_aaaaa /=_ga ;};_fac =append (_fac ,&line {_aadb :_abaf ,_bgbg :_geba ,_egd :_aaaaa });_geba =[]*symbol {_cgc };_cbg =_cgc ._gfdb ;_abaf +=_aaaaa ;}else {_cgc ._efff =_cbg ;
_cbg +=_cgc ._gfdb ;_geba =append (_geba ,_cgc );};};_gfd :=_bfab (_geba );if _addd {_gfd /=_ga ;};if len (_geba )> 0{_fac =append (_fac ,&line {_aadb :_abaf ,_bgbg :_geba ,_egd :_gfd });};}else {for _ ,_eeeb :=range _gcca {_ecb (_eeeb );_eeeb ._efff =_cbg ;
_cbg +=_eeeb ._gfdb ;};if len (_gcca )> 0{_fac =[]*line {&line {_bgbg :_gcca ,_egd :_bfab (_gcca )}};};};_cag :=_efg .TAttr ;if _cag ==_bg .ST_CellTypeUnset {_cag =_bg .ST_CellTypeN ;};return _fac ,_cag ;};func _beaa (_fcdf *bool )bool {return _fcdf !=nil &&*_fcdf };


// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _abf .RegisterFontsFromDirectory (dirName );};func (_ggg *convertContext )makePages (){for _ ,_gb :=range _ggg ._eed {for _ ,_fcg :=range _ggg ._gabeg {_gb ._ffea =append (_gb ._ffea ,&page {_fed :[]*pageRow {},_egg :_gb ,_gcgg :_fcg });
};};};type line struct{_aadb float64 ;_bgbg []*symbol ;_egd float64 ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_ggaa *convertContext )getImage (_cfaf _f .Image ,_daca ,_gffb ,_efb ,_eadg ,_dea ,_fae float64 ,_adg _abf .ImgPart )*_aa .Image {_eadg +=_ggaa ._dfge ;
_efb +=_ggaa ._eeef ;_deba ,_gaaf :=_abf .GetImage (_ggaa ._gcee ,_cfaf ,_daca ,_gffb ,_efb ,_eadg ,_dea ,_fae ,_adg );if _gaaf !=nil {_ba .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_gaaf );
return nil ;};return _deba ;};func (_eeb *convertContext )drawPage (_dcbd *page ){_bfbc :=_eeb ._dfge ;_gbad :=_eeb ._eeef ;for _ ,_bcfg :=range _dcbd ._fed {_caf :=_eeb ._ddbc [_bcfg ._debb ];for _ ,_dcfd :=range _bcfg ._dff {var _cefg float64 ;if _bcfg ._debb > 1{_cefg =_eeb ._ddbc [_bcfg ._debb -1]._eaa ;
};var _dgg ,_bagg float64 ;if _bdc :=_dcfd ._cfe ;_bdc !=nil {_dgg =_bdc ._dfe ;};if _abgd :=_dcfd ._ebb ;_abgd !=nil {_bagg =_abgd ._dfe ;};_eeg :=_bfbc +_caf ._dfgc -0.5*(_cefg -_dgg );_ebgb :=_bfbc +_caf ._dfgc +_caf ._bbc +0.5*(_caf ._eaa +_bagg );
_adbe :=_gbad +_dcfd ._cbad ;_afg :=_adbe +_dcfd ._fdgg ;if _dcfd ._ggga !=nil &&_dcfd ._ggga !=_aa .ColorBlack {_abf .FillRectangle (_eeb ._gcee ,_adbe ,_eeg ,_afg -_adbe ,_ebgb -_eeg ,_dcfd ._ggga );};};};for _ ,_fddf :=range _dcbd ._fed {_cdc :=_eeb ._ddbc [_fddf ._debb ];
for _ ,_cfdb :=range _fddf ._dff {_gacd :=_cfdb ._gbeed < _cfdb ._cbad ;_eea :=_cfdb ._acag > _cfdb ._cbad +_cfdb ._fcfa ;var _dgf ,_dgge bool ;for _ ,_ede :=range _cfdb ._eefc {for _ ,_edcf :=range _ede ._bgbg {if _gacd &&!_dgf {_dgf =_edcf ._efff < 0;
};if _eea &&!_dgge {_dgge =_cfdb ._fcfa < _edcf ._efff +_edcf ._gfdb ;};if _cfdb ._cbad +_edcf ._efff >=_cfdb ._gbeed &&_cfdb ._cbad +_edcf ._efff +_edcf ._gfdb <=_cfdb ._acag {_aga :=_eeb ._gcee .NewStyledParagraph ();_cae :=_gbad +_cfdb ._cbad +_edcf ._efff ;
_fcgd :=_bfbc +_cdc ._dfgc +_ede ._aadb -_edcf ._caed -_caab (0.5);_aga .SetPos (_cae ,_fcgd );var _dbd *_aa .TextChunk ;if _edcf ._aagc !=""{_dbd =_aga .AddExternalLink (_edcf ._cafe ,_edcf ._aagc );}else {_dbd =_aga .Append (_edcf ._cafe );};if _edcf ._efdd !=nil {_dbd .Style =*_edcf ._efdd ;
};_eeb ._gcee .Draw (_aga );};};};var _gde ,_fff ,_baa ,_fec ,_dggc ,_cdee float64 ;var _cdbc ,_agac ,_add ,_dfg _aa .Color ;if _ggf :=_cfdb ._cfe ;_ggf !=nil {_gde =_ggf ._dfe ;_cdbc =_ggf ._cegd ;};if _bfaf :=_cfdb ._ebb ;_bfaf !=nil {_fff =_bfaf ._dfe ;
_agac =_bfaf ._cegd ;};if _cba :=_cfdb ._aabe ;_cba !=nil {_baa =_cba ._dfe ;_dggc =_baa /2;_add =_cba ._cegd ;};if _aaaa :=_cfdb ._edef ;_aaaa !=nil {_fec =_aaaa ._dfe ;_cdee =_fec /2;_dfg =_aaaa ._cegd ;};var _gdf float64 ;if _fddf ._debb > 1{_gdf =_eeb ._ddbc [_fddf ._debb -1]._eaa ;
};_bfc :=_bfbc +_cdc ._dfgc -0.5*(_gdf -_gde );_adc :=_bfbc +_cdc ._dfgc +_cdc ._bbc +0.5*(_cdc ._eaa +_fff );_dcfa :=_gbad +_cfdb ._cbad ;_cfad :=_dcfa +_cfdb ._fdgg ;_abf .DrawLine (_eeb ._gcee ,_dcfa ,_bfc ,_cfad ,_bfc ,_gde ,_cdbc );_abf .DrawLine (_eeb ._gcee ,_dcfa ,_adc ,_cfad ,_adc ,_fff ,_agac );
if !_dgf {_abf .DrawLine (_eeb ._gcee ,_dcfa -_dggc ,_bfc ,_dcfa -_dggc ,_adc ,_baa ,_add );};if !_dgge {_abf .DrawLine (_eeb ._gcee ,_cfad -_cdee ,_bfc ,_cfad -_cdee ,_adc ,_fec ,_dfg );};};};for _ ,_bagf :=range _dcbd ._fbgg {if _bagf !=nil {_eeb ._gcee .Draw (_bagf );
};};};func (_fffe *convertContext )getStyleFromRPrElt (_cbgc *_bg .CT_RPrElt )*style {if _cbgc ==nil {return nil ;};_feg :=&style {};_feg ._ceed =&_cbgc .RFont .ValAttr ;if _fbf :=_cbgc .B ;_fbf !=nil {_fbgf :=_fbf .ValAttr ==nil ||*_fbf .ValAttr ;_feg ._gged =&_fbgf ;
};if _cdeg :=_cbgc .I ;_cdeg !=nil {_gcce :=_cdeg .ValAttr ==nil ||*_cdeg .ValAttr ;_feg ._cddc =&_gcce ;};if _ffgfg :=_cbgc .U ;_ffgfg !=nil {_bddb :=_ffgfg .ValAttr ==_bg .ST_UnderlineValuesSingle ||_ffgfg .ValAttr ==_bg .ST_UnderlineValuesUnset ;_feg ._egb =&_bddb ;
};if _aaae :=_cbgc .VertAlign ;_aaae !=nil {_ddcg :=_aaae .ValAttr ==_cf .ST_VerticalAlignRunSuperscript ;_feg ._dabc =&_ddcg ;_dgdd :=_aaae .ValAttr ==_cf .ST_VerticalAlignRunSubscript ;_feg ._gabc =&_dgdd ;};if _agce :=_cbgc .Sz ;_agce !=nil {_dfca :=_agce .ValAttr ;
_feg ._gdde =&_dfca ;};if _cedac :=_cbgc .Color ;_cedac !=nil {_feg ._ebec =_fffe .getColorStringFromSmlColor (_cedac );};return _feg ;};type mergedCell struct{_cgfg uint32 ;_cdcg uint32 ;_fgga uint32 ;_deg uint32 ;_gbf float64 ;_agb float64 ;};const _ga =0.64;
func _caab (_edca float64 )float64 {return _edca *_ec .Millimeter };func _ecb (_cbcd *symbol ){_abcc :=_aa .New ();_abgdg :=_abcc .NewStyledParagraph ();_abgdg .SetMargins (0,0,0,0);_ebcg :=_abgdg .Append (_cbcd ._cafe );if _cbcd ._efdd !=nil {_ebcg .Style =*_cbcd ._efdd ;
};_cbcd ._caed =_abgdg .Height ();if _cbcd ._gfdb ==0{_cbcd ._gfdb =_abgdg .Width ();};};func _fgc (_gaea ,_ggcc *style ){if _ggcc ==nil {return ;};if _gaea ==nil {_gaea =_ggcc ;return ;};if _gaea ._fee ==nil {_gaea ._fee =_ggcc ._fee ;};if _gaea ._ceed ==nil {_gaea ._ceed =_ggcc ._ceed ;
};if _gaea ._ebec ==nil {_gaea ._ebec =_ggcc ._ebec ;};if _gaea ._gdde ==nil {_gaea ._gdde =_ggcc ._gdde ;};if _gaea ._gged ==nil {_gaea ._gged =_ggcc ._gged ;};if _gaea ._cddc ==nil {_gaea ._cddc =_ggcc ._cddc ;};if _gaea ._egb ==nil {_gaea ._egb =_ggcc ._egb ;
};if _gaea ._dabc ==nil {_gaea ._dabc =_ggcc ._dabc ;};if _gaea ._gabc ==nil {_gaea ._gabc =_ggcc ._gabc ;};if _gaea ._ccbe ==nil {_gaea ._ccbe =_ggcc ._ccbe ;};if _gaea ._ecbg ==nil {_gaea ._ecbg =_ggcc ._ecbg ;};if _gaea ._daed ==nil {_gaea ._daed =_ggcc ._daed ;
};if _gaea ._eab ==nil {_gaea ._eab =_ggcc ._eab ;};if _gaea ._cgg ==_bg .ST_VerticalAlignmentUnset {_gaea ._cgg =_ggcc ._cgg ;};if _gaea ._ddbd ==_bg .ST_HorizontalAlignmentUnset {_gaea ._ddbd =_ggcc ._ddbd ;};};func (_fgg *convertContext )makeCols (){_gcg :=_fgg ._fdce ;
_bdbe :=_gcg .X ();_ef :=[]*colInfo {};_dbc :=[]colWidthRange {};if _aec :=_bdbe .Cols ;len (_aec )> 0{for _ ,_eee :=range _aec [0].Col {_bgg :=_bc ;if _gga :=_eee .WidthAttr ;_gga !=nil {if *_gga > 0.83{*_gga -=0.83;};if *_gga <=1{_bgg =*_gga *11;}else {_bgg =5+*_gga *6;
};};_baef :=int (_eee .MinAttr -1);_cfa :=int (_eee .MaxAttr -1);_dbc =append (_dbc ,colWidthRange {_ddfab :_baef ,_ebgf :_cfa ,_fcbf :_bgg ,_bgda :_fgg .getStyle (_eee .StyleAttr )});};};_fdb :=0;for _bbg :=0;_bbg <=_fgg ._gbb ;_bbg ++{if _bbg < _fgg ._fcba ||(_bbg > _fgg ._cce &&_fgg ._cce > 0){continue ;
};var _dcf float64 ;var _bga *style ;if _fdb >=len (_dbc ){_dcf =_bc ;}else {_acc :=_dbc [_fdb ];if _bbg >=_acc ._ddfab &&_bbg <=_acc ._ebgf {_dcf =_acc ._fcbf ;_bga =_acc ._bgda ;if _bbg ==_acc ._ebgf {_fdb ++;};}else {_dcf =_bc ;};};_ef =append (_ef ,&colInfo {_dggee :_dcf ,_dbbb :_bga });
};_gfg :=0.0;for _ ,_dca :=range _ef {_gfg +=_dca ._dggee ;};_fgg ._gega =1.0;if _gfg > _fgg ._ceda {_fgg ._gega =_fgg ._ceda /_gfg ;for _ ,_afd :=range _ef {_afd ._dggee *=_fgg ._gega ;};};_fgg ._fdg =_ef ;};func (_bcgd *convertContext )getDxfStyle (_fga *uint32 )*style {_fdcf :=&style {};
_cfba :=false ;if _fga !=nil {var _cfdbd *_bg .CT_Dxf ;for _bec ,_eddd :=range _bcgd ._cgcg .X ().Dxfs .Dxf {if uint32 (_bec )==*_fga {_cfdbd =_eddd ;};};if _cfdbd ==nil {return nil ;};if _cfdbd .Fill !=nil &&_cfdbd .Fill .PatternFill !=nil {if _cfdbd .Fill .PatternFill .FgColor !=nil {_fdcf ._fee =_bcgd .getColorStringFromSmlColor (_cfdbd .Fill .PatternFill .FgColor );
}else if _cfdbd .Fill .PatternFill .BgColor !=nil {_fdcf ._fee =_bcgd .getColorStringFromSmlColor (_cfdbd .Fill .PatternFill .BgColor );};};_ecec :=_cfdbd .Font ;for _ ,_efbd :=range _ecec .Name {if _efbd !=nil {_fdcf ._ceed =&_efbd .ValAttr ;_cfba =true ;
break ;};};for _ ,_fbgb :=range _ecec .B {if _fbgb !=nil {_geda :=_fbgb .ValAttr ==nil ||*_fbgb .ValAttr ;_fdcf ._gged =&_geda ;_cfba =true ;break ;};};for _ ,_gbac :=range _ecec .I {if _gbac !=nil {_gddc :=_gbac .ValAttr ==nil ||*_gbac .ValAttr ;_fdcf ._cddc =&_gddc ;
_cfba =true ;break ;};};for _ ,_efdb :=range _ecec .U {if _efdb !=nil {_gdb :=_efdb .ValAttr ==_bg .ST_UnderlineValuesSingle ||_efdb .ValAttr ==_bg .ST_UnderlineValuesUnset ;_fdcf ._egb =&_gdb ;_cfba =true ;break ;};};for _ ,_fbdc :=range _ecec .Sz {if _fbdc !=nil {_efa :=_fbdc .ValAttr ;
_fdcf ._gdde =&_efa ;_cfba =true ;break ;};};for _ ,_gebaf :=range _ecec .VertAlign {if _gebaf !=nil {_egdd :=_gebaf .ValAttr ==_cf .ST_VerticalAlignRunSuperscript ;_fdcf ._dabc =&_egdd ;_gagf :=_gebaf .ValAttr ==_cf .ST_VerticalAlignRunSubscript ;_fdcf ._gabc =&_gagf ;
_cfba =true ;break ;};};for _ ,_fba :=range _ecec .Color {if _fba !=nil {_fdcf ._ebec =_bcgd .getColorStringFromSmlColor (_fba );_cfba =true ;break ;};};_gbef :=_cfdbd .Border ;if _gbef .Top !=nil {_fdcf ._ccbe =_bcgd .getBorder (_gbef .Top );_cfba =true ;
};if _gbef .Bottom !=nil {_fdcf ._ecbg =_bcgd .getBorder (_gbef .Bottom );_cfba =true ;};if _gbef .Left !=nil {_fdcf ._daed =_bcgd .getBorder (_gbef .Left );_cfba =true ;};if _gbef .Right !=nil {_fdcf ._eab =_bcgd .getBorder (_gbef .Right );_cfba =true ;
};if _cfdbd .Alignment !=nil {if _cfdbf :=_cfdbd .Alignment .VerticalAttr ;_cfdbf !=_bg .ST_VerticalAlignmentUnset {_fdcf ._cgg =_cfdbf ;_cfba =true ;};if _fab :=_cfdbd .Alignment .HorizontalAttr ;_fab !=_bg .ST_HorizontalAlignmentUnset {_fdcf ._ddbd =_fab ;
_cfba =true ;};};};if _cfba {return _fdcf ;};return nil ;};type rowInfo struct{_dfgc float64 ;_dbe bool ;_bbc float64 ;_cea *style ;_gfac []*cell ;_eaa float64 ;};type pageRow struct{_debb int ;_dff []*cell ;};func (_ccdd *convertContext )imageFromAnchor (_fge *anchor ,_ddfa ,_edgb float64 )_f .Image {if _fge ._efbb !=nil {return _fge ._efbb ;
};if _fge ._eebb !=nil {_dgdg ,_aedd :=_abf .MakeImageFromChartSpace (_fge ._eebb ,_ddfa ,_edgb ,_ccdd ._ddeeg ,_ccdd ._fbdb );if _aedd !=nil {_ba .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_aedd );
return nil ;};return _dgdg ;};return nil ;};type border struct{_dfe float64 ;_cegd _aa .Color ;};type page struct{_fed []*pageRow ;_beac bool ;_fbgg []*_aa .Image ;_egg *pagespan ;_gcgg *rowspan ;};type cell struct{_afgd _bg .ST_CellType ;_bfag int ;_cbad float64 ;
_eefc []*line ;_fcfa float64 ;_fdgg float64 ;_gcf float64 ;_gbeed float64 ;_acag float64 ;_aaed *_aa .TextStyle ;_cfe *border ;_ebb *border ;_aabe *border ;_edef *border ;_dggb bool ;_gccb bool ;_ggga _aa .Color ;};var _cef =_caab (1);type convertContext struct{_gcee *_aa .Creator ;
_fbdb *_ab .Workbook ;_ddeeg *_g .Theme ;_fdce *_ab .Sheet ;_cgcg *_ab .StyleSheet ;_gfdc int ;_gbb int ;_eed []*pagespan ;_fade *page ;_fdg []*colInfo ;_ddbc []*rowInfo ;_gabeg []*rowspan ;_dfge float64 ;_eeef float64 ;_ebeg float64 ;_ceda float64 ;_aedc []*mergedCell ;
_begf []*anchor ;_gega float64 ;_fcba int ;_cce int ;_gefd int ;_edcg int ;_bgf bool ;_gdd []_ab .Table ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_ab .Sheet )*_aa .Creator {_gc :=s .X ();if _gc ==nil {return nil ;};var _bee _aa .PageSize ;_ac :=true ;_ad :=false ;if _gc .SheetPr !=nil &&_gc .SheetPr .PageSetUpPr !=nil &&_gc .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_gc .SheetPr .PageSetUpPr .FitToPageAttr {_ad =true ;
};if _af :=_gc .PageSetup ;_af !=nil {_ac =_af .OrientationAttr ==_bg .ST_OrientationLandscape ;if _ccf :=_af .PaperSizeAttr ;_ccf !=nil {_bee =_eeff [*_ccf ];};};if (_bee ==_aa .PageSize {}){_bee =_aa .PageSizeA4 ;};if _ac {_bee [0],_bee [1]=_bee [1],_bee [0];
};_ge :=_aa .New ();_ge .SetPageSize (_bee );var _eg ,_bcg ,_bcb ,_ae float64 ;if _fd :=_gc .PageMargins ;_fd !=nil {_bcb =_fd .LeftAttr ;_ae =_fd .RightAttr ;_eg =_fd .TopAttr ;_bcg =_fd .BottomAttr ;};if _bcb < _ce {_bcb =_ce ;};if _ae < _ce {_ae =_ce ;
};if _eg < _bf {_eg =_bf ;};if _bcg < _bf {_bcg =_bf ;};_eg *=_ec .Inch ;_bcg *=_ec .Inch ;_bcb *=_ec .Inch ;_ae *=_ec .Inch ;_ge .SetPageMargins (_bcb ,_ae ,_eg ,_bcg );_gf :=s .Workbook ();var _fca *_g .Theme ;if len (_gf .Themes ())> 0{_fca =_gf .Themes ()[0];
};var _gfb ,_aag ,_abfd ,_fb int ;for _ ,_gfc :=range _gf .DefinedNames (){if _gfc .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_dd ,_ag ,_cfb ,_ed :=_abf .ParseExcelRange (_gfc .Content ());if _ed ==nil &&s .Name ()==_dd {_gfb =int (_ag .ColumnIdx );
_aag =int (_cfb .ColumnIdx );_abfd =int (_ag .RowIdx );_fb =int (_cfb .RowIdx );};};};_ccd :=[]_ab .Table {};if _gc .TableParts !=nil &&_gc .TableParts .TablePart !=nil {_aea :=0;_fbg :=s .Workbook ().Tables ();_a .Slice (_fbg [:],func (_bb ,_cd int )bool {return _fbg [_bb ].X ().IdAttr < _fbg [_cd ].X ().IdAttr });
for _ ,_cg :=range s .Workbook ().Sheets (){if _cg .Name ()==s .Name (){break ;}else {if _cg .X ().TableParts !=nil &&_cg .X ().TableParts .TablePart !=nil {_aea +=len (_cg .X ().TableParts .TablePart );};};};if len (_fbg )>=_aea +len (_gc .TableParts .TablePart ){_ccd =append (_ccd ,_fbg [_aea :_aea +len (_gc .TableParts .TablePart )]...);
};};_aeaf :=&convertContext {_gcee :_ge ,_fdce :s ,_fbdb :s .Workbook (),_ddeeg :_fca ,_cgcg :&s .Workbook ().StyleSheet ,_dfge :_eg ,_eeef :_bcb ,_ebeg :_bee [1]-_bcg -_eg ,_ceda :_bee [0]-_ae -_bcb ,_fcba :_gfb ,_cce :_aag ,_gefd :_abfd ,_edcg :_fb ,_bgf :_ad ,_gdd :_ccd };
_aeaf .makeAnchors ();_aeaf .determineMaxIndexes ();if _aeaf ._gfdc ==0&&_aeaf ._gbb ==0{_ge .NewPage ();return _ge ;};_aeaf .makeCols ();_aeaf .makeRows ();_aeaf .makeMergedCells ();_aeaf .makeCells ();_aeaf .makePagespans ();_aeaf .makeRowspans ();_aeaf .makePages ();
_aeaf .fillPages ();_aeaf .distributeAnchors ();_aeaf .drawSheet (_ac );return _ge ;};func (_bdbf *convertContext )getColorStringFromSmlColor (_fabb *_bg .CT_Color )*string {var _aee string ;if _fabb .RgbAttr !=nil {_aee =*_fabb .RgbAttr ;}else if _fabb .IndexedAttr !=nil &&*_fabb .IndexedAttr < 64{_aee =_bad [*_fabb .IndexedAttr ];
}else if _fabb .ThemeAttr !=nil {_fedf :=*_fabb .ThemeAttr ;_aee =_bdbf .getColorFromTheme (_fedf );};if _aee ==""{return nil ;};if len (_aee )> 6{_aee =_aee [(len (_aee )-6):];};if _fabb .TintAttr !=nil {_efbbe :=*_fabb .TintAttr ;_aee =_abf .AdjustColorByTint (_aee ,_efbbe );
};_aee ="\u0023"+_aee ;return &_aee ;};type colInfo struct{_gfde float64 ;_dggee float64 ;_dbbb *style ;};func (_ebc *convertContext )drawSheet (_bca bool ){for _dgb ,_cbc :=range _ebc ._eed {_ega :=len (_cbc ._ffea );if _dgb ==len (_ebc ._eed )-1{for _dacf :=len (_cbc ._ffea )-1;
_dacf >=0;_dacf --{if !_cbc ._ffea [_dacf ]._beac {_ega =_dacf ;};};};_gff :=_cbc ._ffea [:_ega ];for _ ,_ged :=range _gff {_ebc ._gcee .NewPage ();if _bca {_ebc ._gcee .RotateDeg (270);};_ebc .drawPage (_ged );};};};func (_bacfg *convertContext )getSymbolsFromR (_ddb []*_bg .CT_RElt ,_ace *style )[]*symbol {_cdbb :=[]*symbol {};
for _ ,_dbdb :=range _ddb {_fgf :=_bacfg .combineCellStyleWithRPrElt (_ace ,_dbdb .RPr );for _ ,_ebdc :=range _dbdb .T {_cdbb =append (_cdbb ,&symbol {_cafe :string (_ebdc ),_efdd :_bacfg .makeTextStyleFromCellStyle (_fgf )});};};return _cdbb ;};const _bf =0.0;
type anchor struct{_efbb _f .Image ;_eebb *_d .ChartSpace ;_cbcf int ;_gegc int64 ;_cdda int ;_fccg int64 ;_ddfe int ;_acec int64 ;_ecf int ;_cga int64 ;};type colWidthRange struct{_ddfab int ;_ebgf int ;_fcbf float64 ;_bgda *style ;};func (_gcba *convertContext )distributeAnchors (){for _ ,_gcc :=range _gcba ._begf {_bgae ,_defd :=_gcc ._cbcf ,_gcc ._gegc ;
_bbe ,_cad :=_gcc ._cdda ,_gcc ._fccg ;_efde ,_fada :=_gcc ._ddfe ,_gcc ._acec ;_bfg ,_ebac :=_gcc ._ecf ,_gcc ._cga ;if _bgae < _gcba ._gefd ||(_efde > _gcba ._edcg &&_gcba ._edcg > 0){continue ;};if _bbe < _gcba ._fcba ||(_bfg > _gcba ._cce &&_gcba ._cce > 0){continue ;
};var _bgd ,_aaaf ,_gbe ,_cfbd *page ;for _ ,_dgc :=range _gcba ._eed {for _ ,_ccbc :=range _dgc ._ffea {if _bgae >=_ccbc ._gcgg ._gcbaa &&_bgae < _ccbc ._gcgg ._acf {if _bbe >=_ccbc ._egg ._bcgf &&_bbe < _ccbc ._egg ._dcff {_ccbc ._beac =true ;_bgd =_ccbc ;
};if _bfg >=_ccbc ._egg ._bcgf &&_bfg < _ccbc ._egg ._dcff {_ccbc ._beac =true ;_aaaf =_ccbc ;};};if _efde >=_ccbc ._gcgg ._gcbaa &&_efde < _ccbc ._gcgg ._acf {if _bbe >=_ccbc ._egg ._bcgf &&_bbe < _ccbc ._egg ._dcff {_ccbc ._beac =true ;_cfbd =_ccbc ;
};if _bfg >=_ccbc ._egg ._bcgf &&_bfg < _ccbc ._egg ._dcff {_ccbc ._beac =true ;_gbe =_ccbc ;};};};};_gba :=_bgd !=_aaaf ;_gac :=_bgd !=_cfbd ;if _gba &&_gac {_bda :=_gcba ._fdg [_bbe ]._gfde +_ec .FromEMU (_cad );_aef :=_bgd ._egg ._gcbb ;_dcb :=_gcba ._fdg [_bfg ]._gfde +_ec .FromEMU (_ebac );
_ebf :=_gcba ._ddbc [_bgae ]._dfgc +_ec .FromEMU (_defd );_dcgd :=float64 (_bgd ._gcgg ._cdca );_afe :=_gcba ._ddbc [_efde ]._dfgc +_ec .FromEMU (_fada );_gbee :=_dcb +_aef -_bda ;_bgaf :=_afe +_dcgd -_ebf ;_fdc :=_gcba .imageFromAnchor (_gcc ,_gbee ,_bgaf );
_bgd ._fbgg =append (_bgd ._fbgg ,_gcba .getImage (_fdc ,_bgaf ,_gbee ,_bda ,_ebf ,_aef -_bda ,_dcgd -_ebf ,_abf .ImgPart_lt ));_aaaf ._fbgg =append (_aaaf ._fbgg ,_gcba .getImage (_fdc ,_bgaf ,_gbee ,0,_ebf ,_aef -_bda ,_dcgd -_ebf ,_abf .ImgPart_rt ));
_cfbd ._fbgg =append (_cfbd ._fbgg ,_gcba .getImage (_fdc ,_bgaf ,_gbee ,_bda ,0,_aef -_bda ,_dcgd -_ebf ,_abf .ImgPart_lb ));_gbe ._fbgg =append (_gbe ._fbgg ,_gcba .getImage (_fdc ,_bgaf ,_gbee ,0,0,_aef -_bda ,_dcgd -_ebf ,_abf .ImgPart_rb ));}else if _gba {_affe :=_gcba ._ddbc [_bgae ]._dfgc +_ec .FromEMU (_defd );
_aedf :=_gcba ._ddbc [_efde ]._dfgc +_ec .FromEMU (_fada );_gfcb :=_gcba ._fdg [_bbe ]._gfde +_ec .FromEMU (_cad );_dae :=_bgd ._egg ._gcbb ;_fda :=_gcba ._fdg [_bfg ]._gfde +_ec .FromEMU (_ebac );_abdc :=_fda +_dae -_gfcb ;_bge :=_aedf -_affe ;_eec :=_gcba .imageFromAnchor (_gcc ,_abdc ,_bge );
_bgd ._fbgg =append (_bgd ._fbgg ,_gcba .getImage (_eec ,_bge ,_abdc ,_gfcb ,_affe ,_dae -_gfcb ,0,_abf .ImgPart_l ));_aaaf ._fbgg =append (_aaaf ._fbgg ,_gcba .getImage (_eec ,_bge ,_abdc ,0,_affe ,_dae -_gfcb ,0,_abf .ImgPart_r ));}else if _gac {_fdd :=_gcba ._fdg [_bbe ]._gfde +_ec .FromEMU (_cad );
_ebd :=_gcba ._fdg [_bfg ]._gfde +_ec .FromEMU (_ebac );_geag :=_gcba ._ddbc [_bgae ]._dfgc +_ec .FromEMU (_defd );_fag :=float64 (_bgd ._gcgg ._cdca );_gaa :=_gcba ._ddbc [_efde ]._dfgc +_ec .FromEMU (_fada );_gacf :=_ebd -_fdd ;_fdcg :=_gaa +_fag -_geag ;
_agg :=_gcba .imageFromAnchor (_gcc ,_gacf ,_fdcg );_bgd ._fbgg =append (_bgd ._fbgg ,_gcba .getImage (_agg ,_fdcg ,_gacf ,_fdd ,_geag ,0,_fag -_geag ,_abf .ImgPart_t ));_cfbd ._fbgg =append (_cfbd ._fbgg ,_gcba .getImage (_agg ,_fdcg ,_gacf ,_fdd ,0,0,_fag -_geag ,_abf .ImgPart_b ));
}else {_ecc :=_gcba ._fdg [_bbe ]._gfde +_ec .FromEMU (_cad );_afdf :=_gcba ._fdg [_bfg ]._gfde +_ec .FromEMU (_ebac );_egfc :=_gcba ._ddbc [_bgae ]._dfgc +_ec .FromEMU (_defd );_beag :=_gcba ._ddbc [_efde ]._dfgc +_ec .FromEMU (_fada );_cbb :=_afdf -_ecc ;
_beg :=_beag -_egfc ;_beef :=_gcba .imageFromAnchor (_gcc ,_cbb ,_beg );_bgd ._fbgg =append (_bgd ._fbgg ,_gcba .getImage (_beef ,_beg ,_cbb ,_ecc ,_egfc ,0,0,_abf .ImgPart_whole ));};};};const _bd =15.0;var _bad =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
func (_bacf *convertContext )makePagespans (){_bacf ._eed =[]*pagespan {};_ebe :=0.0;_def :=0;for _fafd ,_fcd :=range _bacf ._fdg {_bag :=_fcd ._dggee ;if _ebe +_bag <=_bacf ._ceda {_fcd ._gfde =_ebe ;_ebe +=_bag ;}else {_fcd ._gfde =0;_bacf ._eed =append (_bacf ._eed ,&pagespan {_gcbb :_ebe ,_bcgf :_def ,_dcff :_fafd });
_ebe =_bag ;_def =_fafd ;};};_bacf ._eed =append (_bacf ._eed ,&pagespan {_gcbb :_ebe ,_bcgf :_def ,_dcff :len (_bacf ._fdg )});};func (_fefc *convertContext )makeCells (){_bea :=_fefc ._fdce ;_cdba :=_bea .Rows ();_adb :=0;for _eae ,_edc :=range _fefc ._ddbc {if _eae < _fefc ._gefd ||(_eae > _fefc ._edcg &&_fefc ._edcg > 0){continue ;
};_edc ._gfac =[]*cell {};_aae :=0.0;_ecg :=_edc ._cea ;if _edc ._dbe {_ccc :=_cdba [_adb ];_adb ++;_cdg :=_edc ._bbc ;for _ ,_eca :=range _ccc .Cells (){_gfcf ,_gab :=_be .ParseCellReference (_eca .Reference ());if _gab !=nil {_ba .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_gab );
continue ;};if int (_gfcf .ColumnIdx )< _fefc ._fcba ||(int (_gfcf .ColumnIdx )> _fefc ._cce &&_fefc ._cce > 0){continue ;};_egf :=_fefc ._fdg [_gfcf .ColumnIdx ];_fbe :=_egf ._dggee ;_fcb :=_fbe ;_de :=_egf ._dbbb ;var _gd ,_bfa ,_fad ,_abb bool ;for _ ,_ceg :=range _fefc ._aedc {if _gfcf .RowIdx >=_ceg ._cgfg &&_gfcf .RowIdx <=_ceg ._fgga &&_gfcf .ColumnIdx >=_ceg ._cdcg &&_gfcf .ColumnIdx <=_ceg ._deg {if _gfcf .ColumnIdx ==_ceg ._cdcg &&_gfcf .RowIdx ==_ceg ._cgfg {_fbe =_ceg ._gbf ;
_cdg =_ceg ._agb ;};_gd =_gfcf .RowIdx !=_ceg ._cgfg ;_bfa =_gfcf .RowIdx !=_ceg ._fgga ;_fad =_gfcf .ColumnIdx !=_ceg ._cdcg ;_abb =_gfcf .ColumnIdx !=_ceg ._deg ;};};var _efd *style ;for _ ,_edd :=range _fefc ._gdd {_aca ,_acbf ,_ca :=_be .ParseRangeReference (_edd .Reference ());
if _ca !=nil ||_aca .RowIdx > _gfcf .RowIdx ||_aca .ColumnIdx > _gfcf .ColumnIdx ||_acbf .RowIdx < _gfcf .RowIdx ||_acbf .ColumnIdx < _gfcf .ColumnIdx ||_fefc ._fbdb .StyleSheet .X ().TableStyles ==nil {continue ;};_aeag :=_gfcf .RowIdx ==_aca .RowIdx ;
for _ ,_cfae :=range _fefc ._fbdb .StyleSheet .X ().TableStyles .TableStyle {if _edd .X ().TableStyleInfo .NameAttr !=nil &&_cfae .NameAttr ==*_edd .X ().TableStyleInfo .NameAttr {for _ ,_ffe :=range _cfae .TableStyleElement {if !_aeag &&_ffe .TypeAttr ==_bg .ST_TableStyleTypeWholeTable {_efd =_fefc .getDxfStyle (_ffe .DxfIdAttr );
};if _aeag &&_ffe .TypeAttr ==_bg .ST_TableStyleTypeHeaderRow {_efd =_fefc .getDxfStyle (_ffe .DxfIdAttr );};};};};};_dac :=_fefc .getStyleFromCell (_eca ,_ecg ,_de ,_efd );var _bdbg ,_ffc ,_cdd bool ;var _accd ,_gabe ,_aba ,_dde *border ;var _fce _bg .ST_VerticalAlignment ;
var _dccc _bg .ST_HorizontalAlignment ;if _dac !=nil {if !_gd {_accd =_dac ._ccbe ;};if !_bfa {_gabe =_dac ._ecbg ;};if !_fad {_aba =_dac ._daed ;};if !_abb {_dde =_dac ._eab ;};if _gabe !=nil &&_gabe ._dfe > _aae {_aae =_gabe ._dfe ;};_fce =_dac ._cgg ;
_dccc =_dac ._ddbd ;if _dac ._dabc !=nil {_bdbg =*_dac ._dabc ;};if _dac ._gabc !=nil {_ffc =*_dac ._gabc ;};_cdd =_dac ._cecb ;};var _eff _aa .Color ;if _dac !=nil &&_dac ._fee !=nil {_eff =_aa .ColorRGBFromHex (*_dac ._fee );};_gea ,_ffef :=_fefc .getContentFromCell (_bea ,_eca ,_dac ,_fbe ,_cdd );
_ddee :=&cell {_afgd :_ffef ,_fcfa :_fbe ,_fdgg :_fcb ,_gcf :_cdg ,_eefc :_gea ,_cfe :_accd ,_ebb :_gabe ,_aabe :_aba ,_edef :_dde ,_dggb :_bdbg ,_gccb :_ffc ,_ggga :_eff };_fefc .alignSymbolsHorizontally (_ddee ,_dccc );_fefc .alignSymbolsVertically (_ddee ,_fce );
_edc ._gfac =append (_edc ._gfac ,_ddee );};};_edc ._eaa =_aae ;};};func (_dfgf *convertContext )getStyle (_agc *uint32 )*style {_begfa :=&style {};_cccc :=false ;if _agc !=nil {_afec :=_dfgf ._cgcg .GetCellStyle (*_agc );if _afec .GetFill ()!=nil &&_afec .GetFill ().PatternFill !=nil {if _afec .GetFill ().PatternFill .FgColor !=nil {_begfa ._fee =_dfgf .getColorStringFromSmlColor (_afec .GetFill ().PatternFill .FgColor );
}else if _afec .GetFill ().PatternFill .BgColor !=nil {_begfa ._fee =_dfgf .getColorStringFromSmlColor (_afec .GetFill ().PatternFill .BgColor );};};_fbgba :=_afec .GetFont ();for _ ,_ggaae :=range _fbgba .Name {if _ggaae !=nil {_begfa ._ceed =&_ggaae .ValAttr ;
_cccc =true ;break ;};};for _ ,_feda :=range _fbgba .B {if _feda !=nil {_abeb :=_feda .ValAttr ==nil ||*_feda .ValAttr ;_begfa ._gged =&_abeb ;_cccc =true ;break ;};};for _ ,_ggef :=range _fbgba .I {if _ggef !=nil {_egfa :=_ggef .ValAttr ==nil ||*_ggef .ValAttr ;
_begfa ._cddc =&_egfa ;_cccc =true ;break ;};};for _ ,_gfea :=range _fbgba .U {if _gfea !=nil {_cab :=_gfea .ValAttr ==_bg .ST_UnderlineValuesSingle ||_gfea .ValAttr ==_bg .ST_UnderlineValuesUnset ;_begfa ._egb =&_cab ;_cccc =true ;break ;};};for _ ,_ggbb :=range _fbgba .Sz {if _ggbb !=nil {_ffgf :=_ggbb .ValAttr ;
_begfa ._gdde =&_ffgf ;_cccc =true ;break ;};};for _ ,_bgfg :=range _fbgba .VertAlign {if _bgfg !=nil {_debf :=_bgfg .ValAttr ==_cf .ST_VerticalAlignRunSuperscript ;_begfa ._dabc =&_debf ;_bbgfb :=_bgfg .ValAttr ==_cf .ST_VerticalAlignRunSubscript ;_begfa ._gabc =&_bbgfb ;
_cccc =true ;break ;};};for _ ,_acg :=range _fbgba .Color {if _acg !=nil {_begfa ._ebec =_dfgf .getColorStringFromSmlColor (_acg );_cccc =true ;break ;};};_bbea :=_afec .GetBorder ();if _bbea .Top !=nil {_begfa ._ccbe =_dfgf .getBorder (_bbea .Top );_cccc =true ;
};if _bbea .Bottom !=nil {_begfa ._ecbg =_dfgf .getBorder (_bbea .Bottom );_cccc =true ;};if _bbea .Left !=nil {_begfa ._daed =_dfgf .getBorder (_bbea .Left );_cccc =true ;};if _bbea .Right !=nil {_begfa ._eab =_dfgf .getBorder (_bbea .Right );_cccc =true ;
};if _afec .Wrapped (){_begfa ._cecb =true ;_cccc =true ;};if _febb :=_afec .GetVerticalAlignment ();_febb !=_bg .ST_VerticalAlignmentUnset {_begfa ._cgg =_febb ;_cccc =true ;};if _gdfg :=_afec .GetHorizontalAlignment ();_gdfg !=_bg .ST_HorizontalAlignmentUnset {_begfa ._ddbd =_gdfg ;
_cccc =true ;};};if _cccc {return _begfa ;};return nil ;};func (_deb *convertContext )alignSymbolsVertically (_edaa *cell ,_gag _bg .ST_VerticalAlignment ){var _fefg float64 ;switch _gag {case _bg .ST_VerticalAlignmentTop :_fefg =_baf ;if _edaa ._dggb {_fefg -=_fcf ;
}else if _edaa ._gccb {_fefg +=4*_fcf ;};for _ ,_gcdg :=range _edaa ._eefc {_fefg +=_gcdg ._egd ;_gcdg ._aadb =_fefg ;_fefg +=_cef ;};case _bg .ST_VerticalAlignmentCenter :_gfcd :=0.0;for _ ,_bdd :=range _edaa ._eefc {_gfcd +=_bdd ._egd +_caab (1);};_fefg =0.5*(_edaa ._gcf -_gfcd );
if _edaa ._dggb {_fefg -=2*_fcf ;}else if _edaa ._gccb {_fefg +=2*_fcf ;};for _ ,_bgab :=range _edaa ._eefc {_fefg +=_bgab ._egd +0.5*_cef ;_bgab ._aadb =_fefg ;_fefg +=0.5*_cef ;};default:_fefg =_edaa ._gcf -_baf ;if _edaa ._dggb {_fefg -=4*_fcf ;}else if _edaa ._gccb {_fefg +=_fcf ;
};for _dbca :=len (_edaa ._eefc )-1;_dbca >=0;_dbca --{_edaa ._eefc [_dbca ]._aadb =_fefg ;_fefg -=_edaa ._eefc [_dbca ]._egd ;_fefg -=_cef ;};};};func (_gccf *convertContext )addRowToPage (_dge []*cell ,_agaa int ){_cbfg :=0.0;_cbfgf :=_gccf ._ceda ;for _ ,_dfa :=range _dge {if len (_dfa ._eefc )!=0{_dfa ._gbeed =_cbfg ;
_cbfg =_dfa ._cbad +_dfa ._fcfa ;};};for _agf :=len (_dge )-1;_agf >=0;_agf --{_eefd :=_dge [_agf ];if len (_eefd ._eefc )!=0{_eefd ._acag =_cbfgf ;_cbfgf =_eefd ._cbad ;};};_gccf ._fade ._fed =append (_gccf ._fade ._fed ,&pageRow {_debb :_agaa ,_dff :_dge });
};const _bc =64.0;func (_bcae *convertContext )getBorder (_gaed *_bg .CT_BorderPr )*border {_acba :=&border {};switch _gaed .StyleAttr {case _bg .ST_BorderStyleHair :_acba ._dfe =_df /2;case _bg .ST_BorderStyleThin :_acba ._dfe =_df ;case _bg .ST_BorderStyleMedium :_acba ._dfe =_df *2;
case _bg .ST_BorderStyleThick :_acba ._dfe =_df *4;};if _acba ._dfe ==0.0{return nil ;};if _ddcd :=_gaed .Color ;_ddcd !=nil {_caee :=_bcae .getColorStringFromSmlColor (_ddcd );if _caee !=nil {_acba ._cegd =_aa .ColorRGBFromHex (*_caee );}else {_acba ._cegd =_aa .ColorBlack ;
};};return _acba ;};var _df =_caab (0.0625);func (_faf *convertContext )makeMergedCells (){_ddg :=[]*mergedCell {};for _ ,_bce :=range _faf ._fdce .MergedCells (){_fgbc ,_bfb ,_cde :=_be .ParseRangeReference (_bce .Reference ());if _cde !=nil {_ba .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_cde );
continue ;};_eba :=mergedCell {_cgfg :_fgbc .RowIdx ,_cdcg :_fgbc .ColumnIdx ,_fgga :_bfb .RowIdx ,_deg :_bfb .ColumnIdx };for _bcec :=_eba ._cdcg -1;_bcec < _eba ._deg ;_bcec ++{_eba ._gbf +=_faf ._fdg [_bcec ]._dggee ;};for _abg :=_eba ._cgfg -1;_abg < _eba ._fgga ;
_abg ++{_eba ._agb +=_faf ._ddbc [_abg ]._bbc ;};_ddg =append (_ddg ,&_eba );};_faf ._aedc =_ddg ;};func (_abef *convertContext )getSymbolsFromString (_aad string ,_bgge *style )[]*symbol {_ecaf :=[]*symbol {};_dgd :=_abef .makeTextStyleFromCellStyle (_bgge );
for _ ,_ece :=range _aad {_ecaf =append (_ecaf ,&symbol {_cafe :string (_ece ),_efdd :_dgd });};return _ecaf ;};type style struct{_fee *string ;_ebec *string ;_gdde *float64 ;_ceed *string ;_gged *bool ;_cddc *bool ;_egb *bool ;_dabc *bool ;_gabc *bool ;
_ccbe *border ;_ecbg *border ;_daed *border ;_eab *border ;_cecb bool ;_cgg _bg .ST_VerticalAlignment ;_ddbd _bg .ST_HorizontalAlignment ;};var _eb =3.025/_caab (1);func (_gcea *convertContext )getColorFromTheme (_ecgf uint32 )string {_cfeb :=_gcea ._fbdb .Themes ();
if len (_cfeb )!=0{_gabed :=_cfeb [0];if _bfee :=_gabed .ThemeElements ;_bfee !=nil {if _eedb :=_bfee .ClrScheme ;_eedb !=nil {switch _ecgf {case 0:return _abf .GetColorStringFromDmlColor (_eedb .Lt1 );case 1:return _abf .GetColorStringFromDmlColor (_eedb .Dk1 );
case 2:return _abf .GetColorStringFromDmlColor (_eedb .Lt2 );case 3:return _abf .GetColorStringFromDmlColor (_eedb .Dk2 );case 4:return _abf .GetColorStringFromDmlColor (_eedb .Accent1 );case 5:return _abf .GetColorStringFromDmlColor (_eedb .Accent2 );
case 6:return _abf .GetColorStringFromDmlColor (_eedb .Accent3 );case 7:return _abf .GetColorStringFromDmlColor (_eedb .Accent4 );case 8:return _abf .GetColorStringFromDmlColor (_eedb .Accent5 );case 9:return _abf .GetColorStringFromDmlColor (_eedb .Accent6 );
};};};};return "";};