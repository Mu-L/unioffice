//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_ec "github.com/unidoc/unioffice/common/logger";_ce "github.com/unidoc/unioffice/common/tempstorage";_cg "github.com/unidoc/unioffice/internal/convertutils";_aa "github.com/unidoc/unioffice/measurement";_b "github.com/unidoc/unioffice/schema/soo/dml";
_bb "github.com/unidoc/unioffice/schema/soo/dml/chart";_d "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_cf "github.com/unidoc/unioffice/schema/soo/sml";_ab "github.com/unidoc/unioffice/spreadsheet";_gg "github.com/unidoc/unioffice/spreadsheet/formula";
_gf "github.com/unidoc/unioffice/spreadsheet/reference";_ga "github.com/unidoc/unipdf/v3/creator";_gd "github.com/unidoc/unipdf/v3/model";_e "image";_a "math";_ac "sort";_g "strconv";);func (_efga *convertContext )makeCols (){_ad :=_efga ._baae ;_fb :=_ad .X ();
_bbg :=[]*colInfo {};_de :=[]colWidthRange {};if _dafg :=_fb .Cols ;len (_dafg )> 0{for _ ,_bab :=range _dafg [0].Col {_aed :=_ace ;if _dab :=_bab .WidthAttr ;_dab !=nil {if *_dab > 0.83{*_dab -=0.83;};if *_dab <=1{_aed =*_dab *11;}else {_aed =5+*_dab *6;
};};_bag :=int (_bab .MinAttr -1);_bfa :=int (_bab .MaxAttr -1);_de =append (_de ,colWidthRange {_ced :_bag ,_ffag :_bfa ,_bffgg :_aed ,_eaggb :_efga .getStyle (_bab .StyleAttr )});};};_ceb :=0;for _fc :=0;_fc <=_efga ._gegd ;_fc ++{if _fc < _efga ._ebag ||(_fc > _efga ._cegd &&_efga ._cegd > 0){continue ;
};var _dba float64 ;var _cce *style ;if len (_de )==0{_dba =_ace ;}else if _ceb < len (_de ){_cef :=_de [_ceb ];if _fc >=_cef ._ced &&_fc <=_cef ._ffag {_dba =_cef ._bffgg ;_cce =_cef ._eaggb ;if _fc ==_cef ._ffag {_ceb ++;};}else {continue ;};};_bbg =append (_bbg ,&colInfo {_aabe :_dba ,_cgdd :_cce });
};_gb :=0.0;for _ ,_dbc :=range _bbg {_gb +=_dbc ._aabe ;};_efga ._eea =1.0;if _gb > _efga ._cfe {_efga ._eea =_efga ._cfe /_gb ;for _ ,_bbb :=range _bbg {_bbb ._aabe *=_efga ._eea ;};};_efga ._gbg =_bbg ;};const _ca =2;func _gbfe (_fccd *symbol ){_ebee :=_ga .New ();
_gaf :=_ebee .NewStyledParagraph ();_gaf .SetMargins (0,0,0,0);_gbdf :=_gaf .Append (_fccd ._faa );if _fccd ._cagb !=nil {_gbdf .Style =*_fccd ._cagb ;};_fccd ._gcea =_gaf .Height ();if _fccd ._cfg ==0{_fccd ._cfg =_gaf .Width ();};};type page struct{_aaag []*pageRow ;
_dbca bool ;_afg []*_ga .Image ;_adgb *pagespan ;_ccd *rowspan ;};const _ace =64.0;var _f =_bcbggf (1);func (_bac *convertContext )drawPage (_gfb *page ){_edc :=_bac ._aff ;_fgga :=_bac ._cdfc ;for _ ,_gdcd :=range _gfb ._aaag {_aedf :=_bac ._dbg [_gdcd ._caga ];
for _ ,_afabg :=range _gdcd ._dfda {var _cbe float64 ;if _gdcd ._caga > 1{_cbe =_bac ._dbg [_gdcd ._caga -1]._fbba ;};var _gdd ,_cde float64 ;if _cgc :=_afabg ._cded ;_cgc !=nil {_gdd =_cgc ._abef ;};if _cee :=_afabg ._egac ;_cee !=nil {_cde =_cee ._abef ;
};_beee :=_edc +_aedf ._bcf -0.5*(_cbe -_gdd );_add :=_edc +_aedf ._bcf +_aedf ._ggcf +0.5*(_aedf ._fbba +_cde );_aece :=_fgga +_afabg ._aecg ;_caee :=_aece +_afabg ._gffc ;if _afabg ._cdce !=nil &&_afabg ._cdce !=_ga .ColorBlack {_cg .FillRectangle (_bac ._bcbg ,_aece ,_beee ,_caee -_aece ,_add -_beee ,_afabg ._cdce );
};};};for _ ,_cbee :=range _gfb ._aaag {_baad :=_bac ._dbg [_cbee ._caga ];for _ ,_afb :=range _cbee ._dfda {_dbccf :=_afb ._agbf < _afb ._aecg ;_aeb :=_afb ._fdd > _afb ._aecg +_afb ._eacf ;var _bad ,_ebbd bool ;for _ ,_ggg :=range _afb ._gbff {for _ ,_fcb :=range _ggg ._fffa {if _dbccf &&!_bad {_bad =_fcb ._dagb < 0;
};if _aeb &&!_ebbd {_ebbd =_afb ._eacf < _fcb ._dagb +_fcb ._cfg ;};if _afb ._aecg +_fcb ._dagb >=_afb ._agbf &&_afb ._aecg +_fcb ._dagb +_fcb ._cfg <=_afb ._fdd {_bgcf :=_bac ._bcbg .NewStyledParagraph ();_ceg :=_fgga +_afb ._aecg +_fcb ._dagb ;_ccbf :=_edc +_baad ._bcf +_ggg ._gfd -_fcb ._gcea -_bcbggf (0.5);
_bgcf .SetPos (_ceg ,_ccbf );var _cgd *_ga .TextChunk ;if _fcb ._gcc !=""{_cgd =_bgcf .AddExternalLink (_fcb ._faa ,_fcb ._gcc );}else {_cgd =_bgcf .Append (_fcb ._faa );};if _fcb ._cagb !=nil {_cgd .Style =*_fcb ._cagb ;};_bac ._bcbg .Draw (_bgcf );};
};};var _fca ,_gdg ,_ggf ,_fcab ,_cegg ,_ggccg float64 ;var _geb ,_bdd ,_afbc ,_aadf _ga .Color ;if _aaf :=_afb ._cded ;_aaf !=nil {_fca =_aaf ._abef ;_geb =_aaf ._aag ;};if _gefb :=_afb ._egac ;_gefb !=nil {_gdg =_gefb ._abef ;_bdd =_gefb ._aag ;};if _bfdd :=_afb ._bfag ;
_bfdd !=nil {_ggf =_bfdd ._abef ;_cegg =_ggf /2;_afbc =_bfdd ._aag ;};if _fgb :=_afb ._bbbd ;_fgb !=nil {_fcab =_fgb ._abef ;_ggccg =_fcab /2;_aadf =_fgb ._aag ;};var _gcgc float64 ;if _cbee ._caga > 1{_gcgc =_bac ._dbg [_cbee ._caga -1]._fbba ;};_adgg :=_edc +_baad ._bcf -0.5*(_gcgc -_fca );
_edf :=_edc +_baad ._bcf +_baad ._ggcf +0.5*(_baad ._fbba +_gdg );_eagg :=_fgga +_afb ._aecg ;_gggg :=_eagg +_afb ._gffc ;_cg .DrawLine (_bac ._bcbg ,_eagg ,_adgg ,_gggg ,_adgg ,_fca ,_geb );_cg .DrawLine (_bac ._bcbg ,_eagg ,_edf ,_gggg ,_edf ,_gdg ,_bdd );
if !_bad {_cg .DrawLine (_bac ._bcbg ,_eagg -_cegg ,_adgg ,_eagg -_cegg ,_edf ,_ggf ,_afbc );};if !_ebbd {_cg .DrawLine (_bac ._bcbg ,_gggg -_ggccg ,_adgg ,_gggg -_ggccg ,_edf ,_fcab ,_aadf );};};};for _ ,_beda :=range _gfb ._afg {if _beda !=nil {_bac ._bcbg .Draw (_beda );
};};};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_ab .Sheet )*_ga .Creator {_fd :=s .X ();if _fd ==nil {return nil ;};var _eff _ga .PageSize ;_ece :=true ;_ge :=false ;if _fd .SheetPr !=nil &&_fd .SheetPr .PageSetUpPr !=nil &&_fd .SheetPr .PageSetUpPr .FitToPageAttr !=nil &&*_fd .SheetPr .PageSetUpPr .FitToPageAttr {_ge =true ;
};if _bc :=_fd .PageSetup ;_bc !=nil {_ece =_bc .OrientationAttr ==_cf .ST_OrientationLandscape ;if _ebd :=_bc .PaperSizeAttr ;_ebd !=nil {_eff =_gebd [*_ebd ];};};if (_eff ==_ga .PageSize {}){_eff =_ga .PageSizeA4 ;};if _ece {_eff [0],_eff [1]=_eff [1],_eff [0];
};_be :=_ga .New ();_be .SetPageSize (_eff );var _efg ,_bgf ,_fg ,_gc float64 ;if _cgg :=_fd .PageMargins ;_cgg !=nil {_fg =_cgg .LeftAttr ;_gc =_cgg .RightAttr ;_efg =_cgg .TopAttr ;_bgf =_cgg .BottomAttr ;};if _fg < _db {_fg =_db ;};if _gc < _db {_gc =_db ;
};if _efg < _eb {_efg =_eb ;};if _bgf < _eb {_bgf =_eb ;};_efg *=_aa .Inch ;_bgf *=_aa .Inch ;_fg *=_aa .Inch ;_gc *=_aa .Inch ;_be .SetPageMargins (_fg ,_gc ,_efg ,_bgf );_ag :=s .Workbook ();var _gdc *_b .Theme ;if len (_ag .Themes ())> 0{_gdc =_ag .Themes ()[0];
};var _fda ,_bga ,_ecb ,_bec int ;for _ ,_ee :=range _ag .DefinedNames (){if _ee .Name ()=="\u005f\u0078l\u006e\u006d\u002eP\u0072\u0069\u006e\u0074\u005f\u0041\u0072\u0065\u0061"{_efb ,_ea ,_eag ,_df :=_cg .ParseExcelRange (_ee .Content ());if _df ==nil &&s .Name ()==_efb {_fda =int (_ea .ColumnIdx );
_bga =int (_eag .ColumnIdx );_ecb =int (_ea .RowIdx );_bec =int (_eag .RowIdx );};};};_cff :=[]_ab .Table {};if _fd .TableParts !=nil &&_fd .TableParts .TablePart !=nil {_cd :=0;_cffe :=s .Workbook ().Tables ();_ac .Slice (_cffe [:],func (_ae ,_cggf int )bool {return _cffe [_ae ].X ().IdAttr < _cffe [_cggf ].X ().IdAttr });
for _ ,_af :=range s .Workbook ().Sheets (){if _af .Name ()==s .Name (){break ;}else {if _af .X ().TableParts !=nil &&_af .X ().TableParts .TablePart !=nil {_cd +=len (_af .X ().TableParts .TablePart );};};};if len (_cffe )>=_cd +len (_fd .TableParts .TablePart ){_cff =append (_cff ,_cffe [_cd :_cd +len (_fd .TableParts .TablePart )]...);
};};_cffa :=&convertContext {_bcbg :_be ,_baae :s ,_eabg :s .Workbook (),_ebgc :_gdc ,_bffg :&s .Workbook ().StyleSheet ,_aff :_efg ,_cdfc :_fg ,_ccbc :_eff [1]-_bgf -_efg ,_cfe :_eff [0]-_gc -_fg ,_ebag :_fda ,_cegd :_bga ,_edff :_ecb ,_ecf :_bec ,_gcebe :_ge ,_agga :_cff };
_cffa .makeAnchors ();_cffa .determineMaxIndexes ();if _cffa ._ffdb ==0&&_cffa ._gegd ==0{_be .NewPage ();return _be ;};_cffa .makeCols ();_cffa .makeRows ();_cffa .makeMergedCells ();_cffa .makeCells ();_cffa .makePagespans ();_cffa .makeRowspans ();_cffa .makePages ();
_cffa .fillPages ();_cffa .distributeAnchors ();_cffa .drawSheet ();return _be ;};type colWidthRange struct{_ced int ;_ffag int ;_bffgg float64 ;_eaggb *style ;};func (_ggfg *convertContext )getColorStringFromSmlColor (_aafeg *_cf .CT_Color )*string {var _gcgd string ;
if _aafeg .RgbAttr !=nil {_gcgd =*_aafeg .RgbAttr ;}else if _aafeg .IndexedAttr !=nil &&*_aafeg .IndexedAttr < 64{_gcgd =_ggac [*_aafeg .IndexedAttr ];}else if _aafeg .ThemeAttr !=nil {_edge :=*_aafeg .ThemeAttr ;_gcgd =_ggfg .getColorFromTheme (_edge );
};if _gcgd ==""{return nil ;};if len (_gcgd )> 6{_gcgd =_gcgd [(len (_gcgd )-6):];};if _aafeg .TintAttr !=nil {_aeef :=*_aafeg .TintAttr ;_gcgd =_cg .AdjustColorByTint (_gcgd ,_aeef );};_gcgd ="\u0023"+_gcgd ;return &_gcgd ;};func (_ebg *convertContext )makeAnchors (){_gef ,_eec :=_ebg ._baae .GetDrawing ();
if _gef !=nil {for _ ,_dd :=range _gef .EG_Anchor {_aga :=&anchor {};if _ff :=_dd .TwoCellAnchor ;_ff !=nil {_aee ,_fe :=_ff .From ,_ff .To ;if _aee ==nil ||_fe ==nil {return ;};_aga ._gggf =int (_aee .Row );_aga ._egdc =_cg .FromSTCoordinate (_aee .RowOff );
_aga ._cbaea =int (_aee .Col );_aga ._cca =_cg .FromSTCoordinate (_aee .ColOff );_aga ._eeca =int (_fe .Row );_aga ._agdc =_cg .FromSTCoordinate (_fe .RowOff );_aga ._baga =int (_fe .Col );_aga ._fgbc =_cg .FromSTCoordinate (_fe .ColOff );if _gdcc :=_ff .Choice ;
_gdcc !=nil {if _eeg :=_gdcc .Pic ;_eeg !=nil {if _fdg :=_eeg .BlipFill ;_fdg !=nil {if _dc :=_fdg .Blip ;_dc !=nil {if _gcg :=_dc .EmbedAttr ;_gcg !=nil {for _ ,_gdca :=range _eec .X ().Relationship {if _gdca .IdAttr ==*_gcg {for _ ,_geg :=range _ebg ._eabg .Images {if _geg .Target ()==_gdca .TargetAttr {_eeb ,_ddc :=_ce .Open (_geg .Path ());
if _ddc !=nil {_ec .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_ddc );continue ;};_bfd ,_ ,_ddc :=_e .Decode (_eeb );if _ddc !=nil {_ec .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_ddc );
continue ;};_aga ._dbea =_bfd ;};};};};};};};}else if _da :=_gdcc .GraphicFrame ;_da !=nil {if _gaab :=_da .Graphic ;_gaab !=nil {if _gda :=_gaab .GraphicData ;_gda !=nil {for _ ,_cc :=range _gda .Any {if _cec ,_cab :=_cc .(*_bb .Chart );_cab {for _ ,_eagb :=range _eec .X ().Relationship {if _eagb .IdAttr ==_cec .IdAttr {_daf :=_ebg ._eabg .GetChartByTargetId (_eagb .TargetAttr );
if _daf !=nil {_aga ._eed =_daf ;};};};};};};};};};};if _aga ._dbea !=nil ||_aga ._eed !=nil {_ebg ._acfb =append (_ebg ._acfb ,_aga );};};};};func (_cgfe *convertContext )makeTextStyleFromCellStyle (_fggab *style )*_ga .TextStyle {_dcc :=_cgfe ._bcbg .NewTextStyle ();
if _fggab ==nil {_dcc .FontSize =_cg .DefaultFontSize ;_dcc .Font =_cg .AssignStdFontByName (_dcc ,_cg .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_dcc ;};if _effg (_fggab ._eeab ){_dcc .Underline =true ;_dcc .UnderlineStyle =_ga .TextDecorationLineStyle {Offset :0.5,Thickness :_bcbggf (1/32)};
};var _ggca FontStyle ;if _effg (_fggab ._bded )&&_effg (_fggab ._beed ){_ggca =FontStyle_BoldItalic ;}else if _effg (_fggab ._bded ){_ggca =FontStyle_Bold ;}else if _effg (_fggab ._beed ){_ggca =FontStyle_Italic ;}else {_ggca =FontStyle_Regular ;};_eedg :="\u0064e\u0066\u0061\u0075\u006c\u0074";
if _fggab ._aefe !=nil {_eedg =*_fggab ._aefe ;};if _dfbb ,_cega :=_cg .StdFontsMap [_eedg ];_cega {_dcc .Font =_cg .AssignStdFontByName (_dcc ,_dfbb [_ggca ]);}else if _eca :=_cg .GetRegisteredFont (_eedg ,_ggca );_eca !=nil {_dcc .Font =_eca ;}else {_ec .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_eedg ,_ggca );
_dcc .Font =_cg .AssignStdFontByName (_dcc ,_cg .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_ggca ]);};if _fggab ._aef !=nil {_dcc .FontSize =_a .Round (*_fggab ._aef *_cgfe ._eea );};if _fggab ._acad !=nil {_dcc .Color =_ga .ColorRGBFromHex (*_fggab ._acad );
};if _fggab ._dfga !=nil &&*_fggab ._dfga {_dcc .FontSize *=_ef ;}else if _fggab ._edg !=nil &&*_fggab ._edg {_dcc .FontSize *=_ef ;};return &_dcc ;};func (_adb *convertContext )fillPages (){for _cdf ,_cag :=range _adb ._aaeg {_fba :=_adb ._dbg [_cag ._gdgd :_cag ._dgbc ];
for _ddb ,_bgb :=range _fba {_cbae :=0;_bgbg :=0.0;_bea :=[]*cell {};if _bgb ._cac {for _ ,_acd :=range _bgb ._bgfb {_cda :=_adb ._deefa [_cbae ];_adb ._ebac =_cda ._faea [_cdf ];_adb ._ebac ._dbca =true ;_bed :=_acd ._gffc ;if _bgbg +_bed > _cda ._fcde {_adb .addRowToPage (_bea ,_ddb );
_bea =[]*cell {_acd };_bgbg =_bed ;_cbae ++;}else {_acd ._aecg =_bgbg ;_bea =append (_bea ,_acd );_bgbg +=_bed ;};};if len (_bea )> 0{_egc :=_adb ._deefa [_cbae ];_adb ._ebac =_egc ._faea [_cdf ];_adb ._ebac ._dbca =true ;_adb .addRowToPage (_bea ,_ddb );
};};};};};type pageRow struct{_caga int ;_dfda []*cell ;};var _ggac =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};
func (_dfb *convertContext )makeRowspans (){var _gcb float64 ;_edb :=0;for _bfg ,_afab :=range _dfb ._dbg {_fcd :=_afab ._ggcf +_afab ._fbba ;if _gcb +_fcd <=_dfb ._ccbc {_afab ._bcf =_gcb ;_gcb +=_fcd ;}else {_dfb ._aaeg =append (_dfb ._aaeg ,&rowspan {_dgb :_gcb ,_gdgd :_edb ,_dgbc :_bfg });
_edb =_bfg ;_afab ._bcf =0;_gcb =_fcd ;};};_dfb ._aaeg =append (_dfb ._aaeg ,&rowspan {_dgb :_gcb ,_gdgd :_edb ,_dgbc :len (_dfb ._dbg )});};type symbol struct{_faa string ;_dagb float64 ;_gcea float64 ;_cfg float64 ;_cagb *_ga .TextStyle ;_gcc string ;
};func (_fdda *convertContext )getColorFromTheme (_ddab uint32 )string {_fddd :=_fdda ._eabg .Themes ();if len (_fddd )!=0{_baca :=_fddd [0];if _eaf :=_baca .ThemeElements ;_eaf !=nil {if _dce :=_eaf .ClrScheme ;_dce !=nil {switch _ddab {case 0:return _cg .GetColorStringFromDmlColor (_dce .Lt1 );
case 1:return _cg .GetColorStringFromDmlColor (_dce .Dk1 );case 2:return _cg .GetColorStringFromDmlColor (_dce .Lt2 );case 3:return _cg .GetColorStringFromDmlColor (_dce .Dk2 );case 4:return _cg .GetColorStringFromDmlColor (_dce .Accent1 );case 5:return _cg .GetColorStringFromDmlColor (_dce .Accent2 );
case 6:return _cg .GetColorStringFromDmlColor (_dce .Accent3 );case 7:return _cg .GetColorStringFromDmlColor (_dce .Accent4 );case 8:return _cg .GetColorStringFromDmlColor (_dce .Accent5 );case 9:return _cg .GetColorStringFromDmlColor (_dce .Accent6 );
};};};};return "";};func (_eagf *convertContext )makeMergedCells (){_gbc :=[]*mergedCell {};for _ ,_cea :=range _eagf ._baae .MergedCells (){_ecc ,_abe ,_ccb :=_gf .ParseRangeReference (_cea .Reference ());if _ccb !=nil {_ec .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_ccb );
continue ;};_cebc :=mergedCell {_dae :_ecc .RowIdx ,_dabc :_ecc .ColumnIdx ,_fffc :_abe .RowIdx ,_fbef :_abe .ColumnIdx };for _acg :=_cebc ._dabc -1;_acg < _cebc ._fbef ;_acg ++{_cebc ._cfb +=_eagf ._gbg [_acg ]._aabe ;};for _adg :=_cebc ._dae -1;_adg < _cebc ._fffc ;
_adg ++{_cebc ._aeff +=_eagf ._dbg [_adg ]._ggcf ;};_gbc =append (_gbc ,&_cebc );};_eagf ._dcba =_gbc ;};func _fbf (_egcg []*symbol )float64 {_cfafb :=0.0;for _ ,_ffe :=range _egcg {_cfafb +=_ffe ._cfg ;};return _cfafb ;};const _ef =0.64;const _bg =3;type pagespan struct{_fcde float64 ;
_faea []*page ;_gdef int ;_cbcb int ;};const _aaa =15.0;type border struct{_abef float64 ;_aag _ga .Color ;};type rowspan struct{_dgb float64 ;_gdgd int ;_dgbc int ;};type mergedCell struct{_dae uint32 ;_dabc uint32 ;_fffc uint32 ;_fbef uint32 ;_cfb float64 ;
_aeff float64 ;};func (_dfaa *convertContext )getSymbolsFromString (_afbe string ,_febb *style )[]*symbol {_dcf :=[]*symbol {};_ffa :=_dfaa .makeTextStyleFromCellStyle (_febb );for _ ,_ddd :=range _afbe {_dcf =append (_dcf ,&symbol {_faa :string (_ddd ),_cagb :_ffa });
};return _dcf ;};func (_ega *convertContext )drawSheet (){for _dcb ,_gcaa :=range _ega ._deefa {_ggcc :=len (_gcaa ._faea );if _dcb ==len (_ega ._deefa )-1{for _dad :=len (_gcaa ._faea )-1;_dad >=0;_dad --{if !_gcaa ._faea [_dad ]._dbca {_ggcc =_dad ;};
};};_fbcg :=_gcaa ._faea [:_ggcc ];for _ ,_gced :=range _fbcg {_ega ._bcbg .NewPage ();_ega .drawPage (_gced );};};};const _db =0.25;func (_ffdf *convertContext )getBorder (_fac *_cf .CT_BorderPr )*border {_afff :=&border {};switch _fac .StyleAttr {case _cf .ST_BorderStyleHair :_afff ._abef =_bf /2;
case _cf .ST_BorderStyleThin :_afff ._abef =_bf ;case _cf .ST_BorderStyleMedium :_afff ._abef =_bf *2;case _cf .ST_BorderStyleThick :_afff ._abef =_bf *4;};if _afff ._abef ==0.0{return nil ;};if _cecg :=_fac .Color ;_cecg !=nil {_gcabf :=_ffdf .getColorStringFromSmlColor (_cecg );
if _gcabf !=nil {_afff ._aag =_ga .ColorRGBFromHex (*_gcabf );}else {_afff ._aag =_ga .ColorBlack ;};};return _afff ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _cg .RegisterFontsFromDirectory (dirName )};func _faf (_ffbg []*symbol )float64 {_cefac :=0.0;for _ ,_dafgc :=range _ffbg {if _dafgc ._gcea > _cefac {_cefac =_dafgc ._gcea ;};};return _cefac ;
};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_cg .FontStyle ;var _gebd =map[uint32 ]_ga .PageSize {1:_ga .PageSize {8.5*_aa .Inch ,11*_aa .Inch },2:_ga .PageSize {8.5*_aa .Inch ,11*_aa .Inch },3:_ga .PageSize {11*_aa .Inch ,17*_aa .Inch },4:_ga .PageSize {17*_aa .Inch ,11*_aa .Inch },5:_ga .PageSize {8.5*_aa .Inch ,14*_aa .Inch },6:_ga .PageSize {5.5*_aa .Inch ,8.5*_aa .Inch },7:_ga .PageSize {7.5*_aa .Inch ,10*_aa .Inch },8:_ga .PageSize {_bcbggf (297),_bcbggf (420)},9:_ga .PageSize {_bcbggf (210),_bcbggf (297)},10:_ga .PageSize {_bcbggf (210),_bcbggf (297)},11:_ga .PageSize {_bcbggf (148),_bcbggf (210)},70:_ga .PageSize {_bcbggf (105),_bcbggf (148)},12:_ga .PageSize {_bcbggf (250),_bcbggf (354)},13:_ga .PageSize {_bcbggf (182),_bcbggf (257)},14:_ga .PageSize {8.5*_aa .Inch ,13*_aa .Inch },20:_ga .PageSize {4.125*_aa .Inch ,9.5*_aa .Inch },27:_ga .PageSize {_bcbggf (110),_bcbggf (220)},28:_ga .PageSize {_bcbggf (162),_bcbggf (229)},34:_ga .PageSize {_bcbggf (250),_bcbggf (176)},29:_ga .PageSize {_bcbggf (324),_bcbggf (458)},30:_ga .PageSize {_bcbggf (229),_bcbggf (324)},31:_ga .PageSize {_bcbggf (114),_bcbggf (162)},37:_ga .PageSize {3.88*_aa .Inch ,7.5*_aa .Inch },43:_ga .PageSize {_bcbggf (100),_bcbggf (148)},69:_ga .PageSize {_bcbggf (200),_bcbggf (148)}};
const _ba =1.5;type colInfo struct{_fdf float64 ;_aabe float64 ;_cgdd *style ;};func _bcbggf (_dgf float64 )float64 {return _dgf *_aa .Millimeter };func (_ggb *convertContext )determineMaxIndexes (){var _bgd ,_eg int ;_bgd =int (_ggb ._baae .MaxColumnIdx ());
_dbf :=_ggb ._baae .Rows ();if len (_dbf )> 0{_eg =int (_dbf [len (_dbf )-1].RowNumber ());};for _ ,_eee :=range _ggb ._acfb {if _eee ._eeca >=_eg {_eg =_eee ._eeca +1;};if _eee ._baga >=_bgd {_bgd =_eee ._baga +1;};};_ggb ._ffdb =_eg ;_ggb ._gegd =_bgd ;
};func (_fdc *convertContext )makePages (){for _ ,_gbcd :=range _fdc ._deefa {for _ ,_fgf :=range _fdc ._aaeg {_gbcd ._faea =append (_gbcd ._faea ,&page {_aaag :[]*pageRow {},_adgb :_gbcd ,_ccd :_fgf });};};};func (_baaed *convertContext )getDxfStyle (_aacb *uint32 )*style {_cddbe :=&style {};
_ebcg :=false ;if _aacb !=nil {var _bcc *_cf .CT_Dxf ;for _caed ,_agc :=range _baaed ._bffg .X ().Dxfs .Dxf {if uint32 (_caed )==*_aacb {_bcc =_agc ;};};if _bcc ==nil {return nil ;};if _bcc .Fill !=nil &&_bcc .Fill .PatternFill !=nil {if _bcc .Fill .PatternFill .FgColor !=nil {_cddbe ._agae =_baaed .getColorStringFromSmlColor (_bcc .Fill .PatternFill .FgColor );
}else if _bcc .Fill .PatternFill .BgColor !=nil {_cddbe ._agae =_baaed .getColorStringFromSmlColor (_bcc .Fill .PatternFill .BgColor );};};_aefd :=_bcc .Font ;for _ ,_ddbg :=range _aefd .Name {if _ddbg !=nil {_cddbe ._aefe =&_ddbg .ValAttr ;_ebcg =true ;
break ;};};for _ ,_fbaf :=range _aefd .B {if _fbaf !=nil {_bbea :=_fbaf .ValAttr ==nil ||*_fbaf .ValAttr ;_cddbe ._bded =&_bbea ;_ebcg =true ;break ;};};for _ ,_fag :=range _aefd .I {if _fag !=nil {_faab :=_fag .ValAttr ==nil ||*_fag .ValAttr ;_cddbe ._beed =&_faab ;
_ebcg =true ;break ;};};for _ ,_dda :=range _aefd .U {if _dda !=nil {_aeg :=_dda .ValAttr ==_cf .ST_UnderlineValuesSingle ||_dda .ValAttr ==_cf .ST_UnderlineValuesUnset ;_cddbe ._eeab =&_aeg ;_ebcg =true ;break ;};};for _ ,_cfgf :=range _aefd .Sz {if _cfgf !=nil {_gaff :=_cfgf .ValAttr ;
_cddbe ._aef =&_gaff ;_ebcg =true ;break ;};};for _ ,_cad :=range _aefd .VertAlign {if _cad !=nil {_dbgc :=_cad .ValAttr ==_d .ST_VerticalAlignRunSuperscript ;_cddbe ._dfga =&_dbgc ;_cebd :=_cad .ValAttr ==_d .ST_VerticalAlignRunSubscript ;_cddbe ._edg =&_cebd ;
_ebcg =true ;break ;};};for _ ,_adbdc :=range _aefd .Color {if _adbdc !=nil {_cddbe ._acad =_baaed .getColorStringFromSmlColor (_adbdc );_ebcg =true ;break ;};};_cbeg :=_bcc .Border ;if _cbeg !=nil {if _cbeg .Top !=nil {_cddbe ._fbcaf =_baaed .getBorder (_cbeg .Top );
_ebcg =true ;};if _cbeg .Bottom !=nil {_cddbe ._cbf =_baaed .getBorder (_cbeg .Bottom );_ebcg =true ;};if _cbeg .Left !=nil {_cddbe ._gbe =_baaed .getBorder (_cbeg .Left );_ebcg =true ;};if _cbeg .Right !=nil {_cddbe ._bagc =_baaed .getBorder (_cbeg .Right );
_ebcg =true ;};};if _bcc .Alignment !=nil {if _bdddg :=_bcc .Alignment .VerticalAttr ;_bdddg !=_cf .ST_VerticalAlignmentUnset {_cddbe ._aggb =_bdddg ;_ebcg =true ;};if _gcd :=_bcc .Alignment .HorizontalAttr ;_gcd !=_cf .ST_HorizontalAlignmentUnset {_cddbe ._fdeb =_gcd ;
_ebcg =true ;};};};if _ebcg {return _cddbe ;};return nil ;};func (_fbc *convertContext )distributeAnchors (){for _ ,_gcab :=range _fbc ._acfb {_ecda ,_eccb :=_gcab ._gggf ,_gcab ._egdc ;_ffc ,_dge :=_gcab ._cbaea ,_gcab ._cca ;_fgg ,_def :=_gcab ._eeca ,_gcab ._agdc ;
_abg ,_baa :=_gcab ._baga ,_gcab ._fgbc ;if _ecda < _fbc ._edff ||(_fgg > _fbc ._ecf &&_fbc ._ecf > 0){continue ;};if _ffc < _fbc ._ebag ||(_abg > _fbc ._cegd &&_fbc ._cegd > 0){continue ;};var _egg ,_edda ,_bd ,_bbgg *page ;for _ ,_cfd :=range _fbc ._deefa {for _ ,_ecdf :=range _cfd ._faea {if _ecda >=_ecdf ._ccd ._gdgd &&_ecda < _ecdf ._ccd ._dgbc {if _ffc >=_ecdf ._adgb ._gdef &&_ffc < _ecdf ._adgb ._cbcb {_ecdf ._dbca =true ;
_egg =_ecdf ;};if _abg >=_ecdf ._adgb ._gdef &&_abg < _ecdf ._adgb ._cbcb {_ecdf ._dbca =true ;_edda =_ecdf ;};};if _fgg >=_ecdf ._ccd ._gdgd &&_fgg < _ecdf ._ccd ._dgbc {if _ffc >=_ecdf ._adgb ._gdef &&_ffc < _ecdf ._adgb ._cbcb {_ecdf ._dbca =true ;_bbgg =_ecdf ;
};if _abg >=_ecdf ._adgb ._gdef &&_abg < _ecdf ._adgb ._cbcb {_ecdf ._dbca =true ;_bd =_ecdf ;};};};};_fa :=_egg !=_edda ;_fec :=_egg !=_bbgg ;if _fa &&_fec {_gdb :=_fbc ._gbg [_ffc ]._fdf +_aa .FromEMU (_dge );_cdca :=_egg ._adgb ._fcde ;_gce :=_fbc ._gbg [_abg ]._fdf +_aa .FromEMU (_baa );
_gfgg :=_fbc ._dbg [_ecda ]._bcf +_aa .FromEMU (_eccb );_dac :=float64 (_egg ._ccd ._dgb );_ffb :=_fbc ._dbg [_fgg ]._bcf +_aa .FromEMU (_def );_gfe :=_gce +_cdca -_gdb ;_fff :=_ffb +_dac -_gfgg ;_aad :=_fbc .imageFromAnchor (_gcab ,_gfe ,_fff );_egg ._afg =append (_egg ._afg ,_fbc .getImage (_aad ,_fff ,_gfe ,_gdb ,_gfgg ,_cdca -_gdb ,_dac -_gfgg ,_cg .ImgPart_lt ));
_edda ._afg =append (_edda ._afg ,_fbc .getImage (_aad ,_fff ,_gfe ,0,_gfgg ,_cdca -_gdb ,_dac -_gfgg ,_cg .ImgPart_rt ));_bbgg ._afg =append (_bbgg ._afg ,_fbc .getImage (_aad ,_fff ,_gfe ,_gdb ,0,_cdca -_gdb ,_dac -_gfgg ,_cg .ImgPart_lb ));_bd ._afg =append (_bd ._afg ,_fbc .getImage (_aad ,_fff ,_gfe ,0,0,_cdca -_gdb ,_dac -_gfgg ,_cg .ImgPart_rb ));
}else if _fa {_cdfe :=_fbc ._dbg [_ecda ]._bcf +_aa .FromEMU (_eccb );_gbf :=_fbc ._dbg [_fgg ]._bcf +_aa .FromEMU (_def );_fdb :=_fbc ._gbg [_ffc ]._fdf +_aa .FromEMU (_dge );_cefa :=_egg ._adgb ._fcde ;_cae :=_fbc ._gbg [_abg ]._fdf +_aa .FromEMU (_baa );
_gabg :=_cae +_cefa -_fdb ;_agg :=_gbf -_cdfe ;_gdaa :=_fbc .imageFromAnchor (_gcab ,_gabg ,_agg );_egg ._afg =append (_egg ._afg ,_fbc .getImage (_gdaa ,_agg ,_gabg ,_fdb ,_cdfe ,_cefa -_fdb ,0,_cg .ImgPart_l ));_edda ._afg =append (_edda ._afg ,_fbc .getImage (_gdaa ,_agg ,_gabg ,0,_cdfe ,_cefa -_fdb ,0,_cg .ImgPart_r ));
}else if _fec {_egcf :=_fbc ._gbg [_ffc ]._fdf +_aa .FromEMU (_dge );_dfc :=_fbc ._gbg [_abg ]._fdf +_aa .FromEMU (_baa );_bbdc :=_fbc ._dbg [_ecda ]._bcf +_aa .FromEMU (_eccb );_ddfe :=float64 (_egg ._ccd ._dgb );_abgd :=_fbc ._dbg [_fgg ]._bcf +_aa .FromEMU (_def );
_gbd :=_dfc -_egcf ;_gee :=_abgd +_ddfe -_bbdc ;_gbce :=_fbc .imageFromAnchor (_gcab ,_gbd ,_gee );_egg ._afg =append (_egg ._afg ,_fbc .getImage (_gbce ,_gee ,_gbd ,_egcf ,_bbdc ,0,_ddfe -_bbdc ,_cg .ImgPart_t ));_bbgg ._afg =append (_bbgg ._afg ,_fbc .getImage (_gbce ,_gee ,_gbd ,_egcf ,0,0,_ddfe -_bbdc ,_cg .ImgPart_b ));
}else {_fce :=_fbc ._gbg [_ffc ]._fdf +_aa .FromEMU (_dge );_fbcc :=_fbc ._gbg [_abg ]._fdf +_aa .FromEMU (_baa );_ege :=_fbc ._dbg [_ecda ]._bcf +_aa .FromEMU (_eccb );_cbbe :=_fbc ._dbg [_fgg ]._bcf +_aa .FromEMU (_def );_beg :=_fbcc -_fce ;_egb :=_cbbe -_ege ;
_gdee :=_fbc .imageFromAnchor (_gcab ,_beg ,_egb );_egg ._afg =append (_egg ._afg ,_fbc .getImage (_gdee ,_egb ,_beg ,_fce ,_ege ,0,0,_cg .ImgPart_whole ));};};};type style struct{_agae *string ;_acad *string ;_aef *float64 ;_aefe *string ;_bded *bool ;
_beed *bool ;_eeab *bool ;_dfga *bool ;_edg *bool ;_fbcaf *border ;_cbf *border ;_gbe *border ;_bagc *border ;_cdff bool ;_aggb _cf .ST_VerticalAlignment ;_fdeb _cf .ST_HorizontalAlignment ;_ccf bool ;};func (_dbe *convertContext )makePagespans (){_dbe ._deefa =[]*pagespan {};
_ded :=0.0;_bbd :=0;for _eac ,_bcb :=range _dbe ._gbg {_cdd :=_bcb ._aabe ;if _ded +_cdd <=_dbe ._cfe {_bcb ._fdf =_ded ;_ded +=_cdd ;}else {_bcb ._fdf =0;_dbe ._deefa =append (_dbe ._deefa ,&pagespan {_fcde :_ded ,_gdef :_bbd ,_cbcb :_eac });_ded =_cdd ;
_bbd =_eac ;};};_dbe ._deefa =append (_dbe ._deefa ,&pagespan {_fcde :_ded ,_gdef :_bbd ,_cbcb :len (_dbe ._gbg )});};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_gd .PdfFont ){_cg .RegisterFont (name ,style ,font );};type line struct{_gfd float64 ;_fffa []*symbol ;_fbd float64 ;};func (_gdab *convertContext )getContentFromCell (_dee *_ab .Sheet ,_dde _ab .Cell ,_fbad *style ,_bbggb float64 ,_dga ,_dgd bool )([]*line ,_cf .ST_CellType ){if _dgd {return []*line {},_cf .ST_CellTypeS ;
};_cdae :=_dde .X ();var _bba []*symbol ;switch _cdae .TAttr {case _cf .ST_CellTypeS :_ecdg :=_cdae .V ;if _ecdg !=nil {_gagc ,_fcf :=_g .Atoi (*_ecdg );if _fcf ==nil {_gbcb :=_gdab ._eabg .SharedStrings .X ().Si [_gagc ];if _gbcb .T !=nil {_bba =_gdab .getSymbolsFromString (*_gbcb .T ,_fbad );
}else if _gbcb .R !=nil {_bba =_gdab .getSymbolsFromR (_gbcb .R ,_fbad );};};};case _cf .ST_CellTypeB :_cegf :=_cdae .V ;if _cegf !=nil {if *_cegf =="\u0030"{_bba =_gdab .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_fbad );}else {_bba =_gdab .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_fbad );
};};case _cf .ST_CellTypeStr :if _cdae .F !=nil {_ede :=_gg .NewEvaluator ();_eegd :=_dee .FormulaContext ().Cell (_dde .Reference (),_ede );_bba =_gdab .getSymbolsFromString (_eegd .Value (),_fbad );};default:_bba =_gdab .getSymbolsFromString (_dde .GetFormattedValue (),_fbad );
};_feed :=0.0;_bce :=0.0;var _edbe []*line ;var _cga bool ;if _fbad !=nil {if _fbad ._dfga !=nil {if *_fbad ._dfga {_cga =true ;};};if _fbad ._edg !=nil {if *_fbad ._edg {_cga =true ;};};};if _dga {_edbe =[]*line {};_edee :=_bbggb -2*_bg ;_effa :=[]*symbol {};
for _ ,_efd :=range _bba {_gbfe (_efd );if _feed +_efd ._cfg >=_edee {_gbaa :=_faf (_effa );if _cga {_gbaa /=_ef ;};_edbe =append (_edbe ,&line {_gfd :_bce ,_fffa :_effa ,_fbd :_gbaa });_effa =[]*symbol {_efd };_feed =_efd ._cfg ;_bce +=_gbaa ;}else {_efd ._dagb =_feed ;
_feed +=_efd ._cfg ;_effa =append (_effa ,_efd );};};_eceb :=_faf (_effa );if _cga {_eceb /=_ef ;};if len (_effa )> 0{_edbe =append (_edbe ,&line {_gfd :_bce ,_fffa :_effa ,_fbd :_eceb });};}else {for _ ,_fdaf :=range _bba {_gbfe (_fdaf );_fdaf ._dagb =_feed ;
_feed +=_fdaf ._cfg ;};if len (_bba )> 0{_edbe =[]*line {&line {_fffa :_bba ,_fbd :_faf (_bba )}};};};_dgg :=_cdae .TAttr ;if _dgg ==_cf .ST_CellTypeUnset {_dgg =_cf .ST_CellTypeN ;};return _edbe ,_dgg ;};var _bgc =3.025/_bcbggf (1);type cell struct{_babd _cf .ST_CellType ;
_gfc int ;_aecg float64 ;_gbff []*line ;_eacf float64 ;_gffc float64 ;_adbd float64 ;_agbf float64 ;_fdd float64 ;_dbcce *_ga .TextStyle ;_cded *border ;_egac *border ;_bfag *border ;_bbbd *border ;_fggag bool ;_cdg bool ;_cdce _ga .Color ;};func (_ebf *convertContext )combineCellStyleWithRPrElt (_dagbe *style ,_bcg *_cf .CT_RPrElt )*style {_bega :=*_dagbe ;
_dafc :=_ebf .getStyleFromRPrElt (_bcg );if _dafc ==nil {return &_bega ;};if _dafc ._acad !=nil {_bega ._acad =_dafc ._acad ;};if _dafc ._aef !=nil {_bega ._aef =_dafc ._aef ;};if _dafc ._aefe !=nil {_bega ._aefe =_dafc ._aefe ;};if _dafc ._bded !=nil {_bega ._bded =_dafc ._bded ;
};if _dafc ._beed !=nil {_bega ._beed =_dafc ._beed ;};if _dafc ._eeab !=nil {_bega ._eeab =_dafc ._eeab ;};if _dafc ._dfga !=nil {_bega ._dfga =_dafc ._dfga ;};if _dafc ._edg !=nil {_bega ._edg =_dafc ._edg ;};return &_bega ;};type anchor struct{_dbea _e .Image ;
_eed *_bb .ChartSpace ;_gggf int ;_egdc int64 ;_cbaea int ;_cca int64 ;_eeca int ;_agdc int64 ;_baga int ;_fgbc int64 ;};type rowInfo struct{_bcf float64 ;_cac bool ;_ggcf float64 ;_ecbe *style ;_bgfb []*cell ;_fbba float64 ;};func (_aafg *convertContext )getStyle (_bade *uint32 )*style {_egfb :=&style {};
_gdcce :=false ;if _bade !=nil {_fddc :=_aafg ._bffg .GetCellStyle (*_bade );if _aafg ._bffg .GetNumberFormat (_fddc .NumberFormat ()).GetFormat ()=="\u003b\u003b\u003b"{_egfb ._ccf =true ;};if _fddc .GetFill ()!=nil &&_fddc .GetFill ().PatternFill !=nil {if _fddc .GetFill ().PatternFill .FgColor !=nil {_egfb ._agae =_aafg .getColorStringFromSmlColor (_fddc .GetFill ().PatternFill .FgColor );
}else if _fddc .GetFill ().PatternFill .BgColor !=nil {_egfb ._agae =_aafg .getColorStringFromSmlColor (_fddc .GetFill ().PatternFill .BgColor );};};_ddbd :=_fddc .GetFont ();for _ ,_ccag :=range _ddbd .Name {if _ccag !=nil {_egfb ._aefe =&_ccag .ValAttr ;
_gdcce =true ;break ;};};for _ ,_dcfa :=range _ddbd .B {if _dcfa !=nil {_bfe :=_dcfa .ValAttr ==nil ||*_dcfa .ValAttr ;_egfb ._bded =&_bfe ;_gdcce =true ;break ;};};for _ ,_ecac :=range _ddbd .I {if _ecac !=nil {_dbgd :=_ecac .ValAttr ==nil ||*_ecac .ValAttr ;
_egfb ._beed =&_dbgd ;_gdcce =true ;break ;};};for _ ,_aeba :=range _ddbd .U {if _aeba !=nil {_bggc :=_aeba .ValAttr ==_cf .ST_UnderlineValuesSingle ||_aeba .ValAttr ==_cf .ST_UnderlineValuesUnset ;_egfb ._eeab =&_bggc ;_gdcce =true ;break ;};};for _ ,_cggfb :=range _ddbd .Sz {if _cggfb !=nil {_gddc :=_cggfb .ValAttr ;
_egfb ._aef =&_gddc ;_gdcce =true ;break ;};};for _ ,_bcbgg :=range _ddbd .VertAlign {if _bcbgg !=nil {_aace :=_bcbgg .ValAttr ==_d .ST_VerticalAlignRunSuperscript ;_egfb ._dfga =&_aace ;_eeeb :=_bcbgg .ValAttr ==_d .ST_VerticalAlignRunSubscript ;_egfb ._edg =&_eeeb ;
_gdcce =true ;break ;};};for _ ,_eebe :=range _ddbd .Color {if _eebe !=nil {_egfb ._acad =_aafg .getColorStringFromSmlColor (_eebe );_gdcce =true ;break ;};};_bage :=_fddc .GetBorder ();if _bage .Top !=nil {_egfb ._fbcaf =_aafg .getBorder (_bage .Top );
_gdcce =true ;};if _bage .Bottom !=nil {_egfb ._cbf =_aafg .getBorder (_bage .Bottom );_gdcce =true ;};if _bage .Left !=nil {_egfb ._gbe =_aafg .getBorder (_bage .Left );_gdcce =true ;};if _bage .Right !=nil {_egfb ._bagc =_aafg .getBorder (_bage .Right );
_gdcce =true ;};if _fddc .Wrapped (){_egfb ._cdff =true ;_gdcce =true ;};if _eebb :=_fddc .GetVerticalAlignment ();_eebb !=_cf .ST_VerticalAlignmentUnset {_egfb ._aggb =_eebb ;_gdcce =true ;};if _aea :=_fddc .GetHorizontalAlignment ();_aea !=_cf .ST_HorizontalAlignmentUnset {_egfb ._fdeb =_aea ;
_gdcce =true ;};};if _gdcce {return _egfb ;};return nil ;};func (_ggbe *convertContext )getStyleFromCell (_deeg _ab .Cell ,_abeb ,_acef ,_ggbg *style )*style {if _ggbg !=nil {_ggfb (_ggbg ,_abeb );_ggfb (_ggbg ,_acef );return _ggbg ;};_bbdf :=_deeg .X ();
_fga :=_ggbe .getStyle (_bbdf .SAttr );_ggfb (_fga ,_abeb );_ggfb (_fga ,_acef );return _fga ;};func (_fef *convertContext )makeCells (){_dbfa :=_fef ._baae ;_eab :=_dbfa .Rows ();_dbcc :=0;for _acc ,_cabf :=range _fef ._dbg {if _acc < _fef ._edff ||(_acc > _fef ._ecf &&_fef ._ecf > 0){continue ;
};_cabf ._bgfb =[]*cell {};_abd :=0.0;_afa :=_cabf ._ecbe ;if _cabf ._cac {_cgf :=_eab [_dbcc ];_dbcc ++;_agb :=_cabf ._ggcf ;for _ ,_ebb :=range _cgf .Cells (){_fcc ,_gdff :=_gf .ParseCellReference (_ebb .Reference ());if _gdff !=nil {_ec .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_gdff );
continue ;};if int (_fcc .ColumnIdx )< _fef ._ebag ||(int (_fcc .ColumnIdx )> _fef ._cegd &&_fef ._cegd > 0){continue ;};_deb :=_fef ._gbg [_fcc .ColumnIdx ];_caa :=_deb ._aabe ;_efbc :=_caa ;_cdc :=_deb ._cgdd ;var _dfa ,_gegg ,_dg ,_feec bool ;for _ ,_gfg :=range _fef ._dcba {if _fcc .RowIdx >=_gfg ._dae &&_fcc .RowIdx <=_gfg ._fffc &&_fcc .ColumnIdx >=_gfg ._dabc &&_fcc .ColumnIdx <=_gfg ._fbef {if _fcc .ColumnIdx ==_gfg ._dabc &&_fcc .RowIdx ==_gfg ._dae {_caa =_gfg ._cfb ;
_agb =_gfg ._aeff ;};_dfa =_fcc .RowIdx !=_gfg ._dae ;_gegg =_fcc .RowIdx !=_gfg ._fffc ;_dg =_fcc .ColumnIdx !=_gfg ._dabc ;_feec =_fcc .ColumnIdx !=_gfg ._fbef ;};};var _dgc *style ;for _ ,_fdgf :=range _fef ._agga {_fbg ,_cbac ,_eef :=_gf .ParseRangeReference (_fdgf .Reference ());
if _eef !=nil ||_fbg .RowIdx > _fcc .RowIdx ||_fbg .ColumnIdx > _fcc .ColumnIdx ||_cbac .RowIdx < _fcc .RowIdx ||_cbac .ColumnIdx < _fcc .ColumnIdx ||_fef ._eabg .StyleSheet .X ().TableStyles ==nil {continue ;};_bgfa :=_fcc .RowIdx ==_fbg .RowIdx ;for _ ,_ddf :=range _fef ._eabg .StyleSheet .X ().TableStyles .TableStyle {if _fdgf .X ().TableStyleInfo .NameAttr !=nil &&_ddf .NameAttr ==*_fdgf .X ().TableStyleInfo .NameAttr {for _ ,_gff :=range _ddf .TableStyleElement {if !_bgfa &&_gff .TypeAttr ==_cf .ST_TableStyleTypeWholeTable {_dgc =_fef .getDxfStyle (_gff .DxfIdAttr );
};if _bgfa &&_gff .TypeAttr ==_cf .ST_TableStyleTypeHeaderRow {_dgc =_fef .getDxfStyle (_gff .DxfIdAttr );};};};};};_cbb :=_fef .getStyleFromCell (_ebb ,_afa ,_cdc ,_dgc );var _cdcc ,_gab ,_cfaf ,_gdfe bool ;var _agd ,_gde ,_dbfc ,_gge *border ;var _cffc _cf .ST_VerticalAlignment ;
var _eabe _cf .ST_HorizontalAlignment ;if _cbb !=nil {if !_dfa {_agd =_cbb ._fbcaf ;};if !_gegg {_gde =_cbb ._cbf ;};if !_dg {_dbfc =_cbb ._gbe ;};if !_feec {_gge =_cbb ._bagc ;};if _gde !=nil &&_gde ._abef > _abd {_abd =_gde ._abef ;};_cffc =_cbb ._aggb ;
_eabe =_cbb ._fdeb ;if _cbb ._dfga !=nil {_cdcc =*_cbb ._dfga ;};if _cbb ._edg !=nil {_gab =*_cbb ._edg ;};_cfaf =_cbb ._cdff ;_gdfe =_cbb ._ccf ;};var _feb _ga .Color ;if _cbb !=nil &&_cbb ._agae !=nil {_feb =_ga .ColorRGBFromHex (*_cbb ._agae );};_bee ,_fbbd :=_fef .getContentFromCell (_dbfa ,_ebb ,_cbb ,_caa ,_cfaf ,_gdfe );
_ggc :=&cell {_babd :_fbbd ,_eacf :_caa ,_gffc :_efbc ,_adbd :_agb ,_gbff :_bee ,_cded :_agd ,_egac :_gde ,_bfag :_dbfc ,_bbbd :_gge ,_fggag :_cdcc ,_cdg :_gab ,_cdce :_feb };_fef .alignSymbolsHorizontally (_ggc ,_eabe );_fef .alignSymbolsVertically (_ggc ,_cffc );
_cabf ._bgfb =append (_cabf ._bgfb ,_ggc );};};_cabf ._fbba =_abd ;};};func _effg (_bddb *bool )bool {return _bddb !=nil &&*_bddb };func (_fdbd *convertContext )imageFromAnchor (_fbca *anchor ,_gfgf ,_acae float64 )_e .Image {if _fbca ._dbea !=nil {return _fbca ._dbea ;
};if _fbca ._eed !=nil {_dfd ,_fgd :=_cg .MakeImageFromChartSpace (_fbca ._eed ,_gfgf ,_acae ,_fdbd ._ebgc ,_fdbd ._eabg );if _fgd !=nil {_ec .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_fgd );
return nil ;};return _dfd ;};return nil ;};func (_fae *convertContext )alignSymbolsVertically (_ffac *cell ,_bgg _cf .ST_VerticalAlignment ){var _gdad float64 ;switch _bgg {case _cf .ST_VerticalAlignmentTop :_gdad =_ca ;if _ffac ._fggag {_gdad -=_ba ;}else if _ffac ._cdg {_gdad +=4*_ba ;
};for _ ,_fcfc :=range _ffac ._gbff {_gdad +=_fcfc ._fbd ;_fcfc ._gfd =_gdad ;_gdad +=_f ;};case _cf .ST_VerticalAlignmentCenter :_afc :=0.0;for _ ,_acda :=range _ffac ._gbff {_afc +=_acda ._fbd +_bcbggf (1);};_gdad =0.5*(_ffac ._adbd -_afc );if _ffac ._fggag {_gdad -=2*_ba ;
}else if _ffac ._cdg {_gdad +=2*_ba ;};for _ ,_aca :=range _ffac ._gbff {_gdad +=_aca ._fbd +0.5*_f ;_aca ._gfd =_gdad ;_gdad +=0.5*_f ;};default:_gdad =_ffac ._adbd -_ca ;if _ffac ._fggag {_gdad -=4*_ba ;}else if _ffac ._cdg {_gdad +=_ba ;};for _fde :=len (_ffac ._gbff )-1;
_fde >=0;_fde --{_ffac ._gbff [_fde ]._gfd =_gdad ;_gdad -=_ffac ._gbff [_fde ]._fbd ;_gdad -=_f ;};};};func (_fcag *convertContext )alignSymbolsHorizontally (_bbdb *cell ,_dafe _cf .ST_HorizontalAlignment ){if _dafe ==_cf .ST_HorizontalAlignmentUnset {switch _bbdb ._babd {case _cf .ST_CellTypeB :_dafe =_cf .ST_HorizontalAlignmentCenter ;
case _cf .ST_CellTypeN :_dafe =_cf .ST_HorizontalAlignmentRight ;default:_dafe =_cf .ST_HorizontalAlignmentLeft ;};};var _ade float64 ;for _ ,_fbe :=range _bbdb ._gbff {switch _dafe {case _cf .ST_HorizontalAlignmentLeft :_ade =_bg ;case _cf .ST_HorizontalAlignmentRight :_faff :=_fbf (_fbe ._fffa );
_ade =_bbdb ._eacf -_bg -_faff ;case _cf .ST_HorizontalAlignmentCenter :_bge :=_fbf (_fbe ._fffa );_ade =(_bbdb ._eacf -_bge )/2;};for _ ,_dfbe :=range _fbe ._fffa {_dfbe ._dagb +=_ade ;};};};func (_cbc *convertContext )getSymbolsFromR (_dag []*_cf .CT_RElt ,_aafe *style )[]*symbol {_begb :=[]*symbol {};
for _ ,_deef :=range _dag {_gad :=_cbc .combineCellStyleWithRPrElt (_aafe ,_deef .RPr );for _ ,_gcga :=range _deef .T {_begb =append (_begb ,&symbol {_faa :string (_gcga ),_cagb :_cbc .makeTextStyleFromCellStyle (_gad )});};};return _begb ;};const _eb =0.0;
func (_fdag *convertContext )addRowToPage (_aae []*cell ,_gebf int ){_acf :=0.0;_bgfd :=_fdag ._cfe ;for _ ,_cdde :=range _aae {if len (_cdde ._gbff )!=0{_cdde ._agbf =_acf ;_acf =_cdde ._aecg +_cdde ._eacf ;};};for _ebce :=len (_aae )-1;_ebce >=0;_ebce --{_bddd :=_aae [_ebce ];
if len (_bddd ._gbff )!=0{_bddd ._fdd =_bgfd ;_bgfd =_bddd ._aecg ;};};_fdag ._ebac ._aaag =append (_fdag ._ebac ._aaag ,&pageRow {_caga :_gebf ,_dfda :_aae });};func (_gdf *convertContext )makeRows (){_ffg :=[]*rowInfo {};_gca :=_gdf ._baae .Rows ();_gba :=0;
_dea :=0.0;for _efc ,_effc :=range _gca {if _efc < _gdf ._edff ||(_efc > _gdf ._ecf &&_gdf ._ecf > 0){continue ;};_gba ++;_ggd :=int (_effc .RowNumber ());if _ggd > _gba {for _bff :=_gba ;_bff < _ggd ;_bff ++{_ffg =append (_ffg ,&rowInfo {_ggcf :_aaa /_bgc });
_dea +=_aaa /_bgc ;};_gba =_ggd ;};var _cb float64 ;if _effc .X ().HtAttr ==nil {_cb =_aaa ;}else {_cb =*_effc .X ().HtAttr ;};_ffg =append (_ffg ,&rowInfo {_ggcf :_cb /_bgc ,_cac :true ,_ecbe :_gdf .getStyle (_effc .X ().SAttr )});_dea +=_cb /_bgc ;};
for _gbb :=len (_ffg );_gbb < _gdf ._ffdb ;_gbb ++{_ffg =append (_ffg ,&rowInfo {_ggcf :_aaa /_bgc });_dea +=_aaa /_bgc ;};if _gdf ._gcebe ||_dea >=_gdf ._ccbc {_cggc :=_gdf ._eea ;if _gdf ._ccbc /_dea < _gdf ._eea {_cggc =_gdf ._ccbc /_dea ;};for _ ,_bfb :=range _ffg {_bfb ._ggcf *=_cggc ;
};};_gdf ._dbg =_ffg ;};func (_dacf *convertContext )getImage (_aade _e .Image ,_fed ,_aede ,_ebgba ,_bgac ,_ccge ,_dgae float64 ,_gebe _cg .ImgPart )*_ga .Image {_bgac +=_dacf ._aff ;_ebgba +=_dacf ._cdfc ;_efgae ,_gddd :=_cg .GetImage (_dacf ._bcbg ,_aade ,_fed ,_aede ,_ebgba ,_bgac ,_ccge ,_dgae ,_gebe );
if _gddd !=nil {_ec .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_gddd );return nil ;};return _efgae ;};func _ggfb (_ceac ,_cbag *style ){if _cbag ==nil {return ;
};if _ceac ==nil {_ceac =_cbag ;return ;};if _ceac ._agae ==nil {_ceac ._agae =_cbag ._agae ;};if _ceac ._aefe ==nil {_ceac ._aefe =_cbag ._aefe ;};if _ceac ._acad ==nil {_ceac ._acad =_cbag ._acad ;};if _ceac ._aef ==nil {_ceac ._aef =_cbag ._aef ;};if _ceac ._bded ==nil {_ceac ._bded =_cbag ._bded ;
};if _ceac ._beed ==nil {_ceac ._beed =_cbag ._beed ;};if _ceac ._eeab ==nil {_ceac ._eeab =_cbag ._eeab ;};if _ceac ._dfga ==nil {_ceac ._dfga =_cbag ._dfga ;};if _ceac ._edg ==nil {_ceac ._edg =_cbag ._edg ;};if _ceac ._fbcaf ==nil {_ceac ._fbcaf =_cbag ._fbcaf ;
};if _ceac ._cbf ==nil {_ceac ._cbf =_cbag ._cbf ;};if _ceac ._gbe ==nil {_ceac ._gbe =_cbag ._gbe ;};if _ceac ._bagc ==nil {_ceac ._bagc =_cbag ._bagc ;};if _ceac ._aggb ==_cf .ST_VerticalAlignmentUnset {_ceac ._aggb =_cbag ._aggb ;};if _ceac ._fdeb ==_cf .ST_HorizontalAlignmentUnset {_ceac ._fdeb =_cbag ._fdeb ;
};};func (_gccg *convertContext )getStyleFromRPrElt (_fdge *_cf .CT_RPrElt )*style {if _fdge ==nil {return nil ;};_ggag :=&style {};_ggag ._aefe =&_fdge .RFont .ValAttr ;if _caaa :=_fdge .B ;_caaa !=nil {_dcbg :=_caaa .ValAttr ==nil ||*_caaa .ValAttr ;
_ggag ._bded =&_dcbg ;};if _bdc :=_fdge .I ;_bdc !=nil {_gfbe :=_bdc .ValAttr ==nil ||*_bdc .ValAttr ;_ggag ._beed =&_gfbe ;};if _eede :=_fdge .U ;_eede !=nil {_gfde :=_eede .ValAttr ==_cf .ST_UnderlineValuesSingle ||_eede .ValAttr ==_cf .ST_UnderlineValuesUnset ;
_ggag ._eeab =&_gfde ;};if _bedf :=_fdge .VertAlign ;_bedf !=nil {_geggb :=_bedf .ValAttr ==_d .ST_VerticalAlignRunSuperscript ;_ggag ._dfga =&_geggb ;_deg :=_bedf .ValAttr ==_d .ST_VerticalAlignRunSubscript ;_ggag ._edg =&_deg ;};if _dgde :=_fdge .Sz ;
_dgde !=nil {_dabf :=_dgde .ValAttr ;_ggag ._aef =&_dabf ;};if _gfa :=_fdge .Color ;_gfa !=nil {_ggag ._acad =_gccg .getColorStringFromSmlColor (_gfa );};return _ggag ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;
FontStyle_BoldItalic FontStyle =3;);type convertContext struct{_bcbg *_ga .Creator ;_eabg *_ab .Workbook ;_ebgc *_b .Theme ;_baae *_ab .Sheet ;_bffg *_ab .StyleSheet ;_ffdb int ;_gegd int ;_deefa []*pagespan ;_ebac *page ;_gbg []*colInfo ;_dbg []*rowInfo ;
_aaeg []*rowspan ;_aff float64 ;_cdfc float64 ;_ccbc float64 ;_cfe float64 ;_dcba []*mergedCell ;_acfb []*anchor ;_eea float64 ;_ebag int ;_cegd int ;_edff int ;_ecf int ;_gcebe bool ;_agga []_ab .Table ;};var _bf =_bcbggf (0.0625);