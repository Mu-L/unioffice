//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_ge "bytes";_eg "errors";_a "fmt";_ee "github.com/unidoc/unichart";_ae "github.com/unidoc/unichart/dataset";_dd "github.com/unidoc/unichart/render";_egeb "github.com/unidoc/unioffice/common/logger";_da "github.com/unidoc/unioffice/document";
_eb "github.com/unidoc/unioffice/measurement";_ed "github.com/unidoc/unioffice/schema/soo/dml";_dc "github.com/unidoc/unioffice/schema/soo/dml/chart";_fg "github.com/unidoc/unioffice/spreadsheet";_cbe "github.com/unidoc/unioffice/spreadsheet/format";_b "github.com/unidoc/unioffice/spreadsheet/formula";
_dg "github.com/unidoc/unioffice/spreadsheet/reference";_cd "github.com/unidoc/unipdf/v3/core";_cg "github.com/unidoc/unipdf/v3/creator";_cbf "github.com/unidoc/unipdf/v3/model";_fc "github.com/unidoc/unipdf/v3/render";_fe "github.com/unidoc/unitype";_ef "image";
_cb "math";_e "os";_cc "regexp";_f "sort";_de "strconv";_ege "strings";_d "sync";_c "unicode";);var _cac =_gfedb (2);func CropImageByRect (sourceImg _ef .Image ,rect _ef .Rectangle )_ef .Image {_aaff ,_aafd ,_fce ,_dbba :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;
_bbgf :=_ef .NewNRGBA (_ef .Rect (0,0,_fce -_aaff ,_dbba -_aafd ));for _gffe :=_aaff ;_gffe < _fce ;_gffe ++{for _bef :=_aafd ;_bef < _dbba ;_bef ++{_bbgf .Set (_gffe -_aaff ,_bef -_aafd ,sourceImg .At (_gffe ,_bef ));};};return _bbgf ;};func (_aaf *creatorContext )drawLegend (_aeb *Rectangle ,_cce []*legendItem ,_ega bool ){_adc :=_aaf ._bcec ;
_ebg :=_gfedb (2.5)*_adc ;_gbf :=_efb *_adc ;_fadg :=(_ebg -_gbf )/2;_eae :=float64 (len (_cce ));if _ega {_caf :=&Rectangle {Top :_aeb .Top +_gfedb (1)*_adc ,Bottom :_aeb .Bottom -_gfedb (1)*_adc ,Left :_aeb .Left +_gfedb (2.5)*_adc ,Right :_aeb .Right -_gfedb (2.5)*_adc };
var _fedd float64 ;if _eae > 1{_fedd =(_caf .Right -_caf .Left )/_eae ;};_gbg :=_caf .Left ;_cee :=_caf .Top ;for _ ,_fdd :=range _cce {if _fbg :=_fdd ._gdc ;_fbg !=nil {_aaf .drawRectangleWithProps (_fbg ,_gbg ,_cee +_fadg ,_gbf ,_gbf ,false );_gde :=_gbg +_gbf *2;
_cbca :=_aaf ._ffaa .NewStyledParagraph ();_cbca .SetPos (_gde ,_cee );_fegb :=_cbca .Append (_fdd ._dfc );_eag ,_eagg :=_cbf .NewStandard14Font (_cbf .HelveticaName );if _eagg ==nil {_abbe :=_aaf ._ffaa .NewTextStyle ();_abbe .Font =_eag ;_abbe .FontSize =_ebg ;
_abbe .TextRise =0.4;_fegb .Style =_abbe ;_aaf ._ffaa .Draw (_cbca );};};_gbg +=_fedd ;};}else {_ada :=&Rectangle {Top :_aeb .Top +_gfedb (2.5)*_adc ,Bottom :_aeb .Bottom -_gfedb (2.5)*_adc ,Left :_aeb .Left +_gfedb (2.5)*_adc ,Right :_aeb .Right -_gfedb (2.5)*_adc };
var _aege float64 ;if _eae > 1{_aege =(_ada .Bottom -_ada .Top -_ebg )/(_eae -1);if _aege < _ebg {_aege =_ebg ;};};_dgc :=_ada .Top ;_aga :=_ada .Left ;_gfce :=_aga +_gbf *2;for _ ,_bce :=range _cce {if _dfbg :=_bce ._gdc ;_dfbg !=nil {_aaf .drawRectangleWithProps (_dfbg ,_aga ,_dgc +_fadg ,_gbf ,_gbf ,false );
_eba :=_aaf ._ffaa .NewStyledParagraph ();_eba .SetPos (_gfce ,_dgc );_eba .SetWidth (_ada .Right -_ada .Left );_dged :=_eba .Append (_bce ._dfc );_ffad ,_bae :=_cbf .NewStandard14Font (_cbf .HelveticaName );if _bae ==nil {_bfd :=_aaf ._ffaa .NewTextStyle ();
_bfd .Font =_ffad ;_bfd .FontSize =_ebg ;_bfd .TextRise =0.4;_dged .Style =_bfd ;_aaf ._ffaa .Draw (_eba );};};_dgc +=_aege ;};};};func (_daf barSerByOrder )Less (i ,j int )bool {return _daf [i ].Order .ValAttr < _daf [j ].Order .ValAttr };func GetRegisteredFont (name string ,style FontStyle )*_cbf .PdfFont {_gacf ._fefc .Lock ();
defer _gacf ._fefc .Unlock ();if _egecf ,_deg :=_gacf ._dagb [name ];_deg {if _cec ,_eabc :=_egecf [style ];_eabc {return _cec ;};};return nil ;};type legendItem struct{_dfc string ;_gdc *_ed .CT_ShapeProperties ;};func _baaa (_ggdc string )([]byte ,error ){_fefg :=_cc .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");
_ggdc =_fefg .ReplaceAllString (_ggdc ,"");_efge :=[]rune (_ggdc );_gbff :=[]byte {};for _fab :=len (_efge )-2;_fab >=0;_fab -=2{_gecb ,_fdbb :=_de .ParseUint (string (_efge [_fab ])+string (_efge [_fab +1]),16,8);if _fdbb !=nil {return nil ,_fdbb ;};_gbff =append (_gbff ,byte (_gecb ));
};return _gbff ,nil ;};func (_fd *creatorContext )drawBarChart (_ec *_dc .CT_BarChart ,_gd *Rectangle ,_be *_dc .CT_PlotAreaChoice1 ,_aec *_fg .Workbook )([]*legendItem ,error ){var _ag bool ;if _aa :=_ec .BarDir ;_aa !=nil {_ag =_aa .ValAttr ==_dc .ST_BarDirBar ;
};_bb :=_ec .Ser ;_f .Sort (barSerByOrder (_bb ));_eef :=map[string ]serCategory {};_efd :=[]string {};_df :=[]*legendItem {};_af :=_cb .Inf (1);_ba :=_cb .Inf (-1);for _ ,_ea :=range _bb {var _fgb string ;if _bg :=_ea .Tx ;_bg !=nil {if _egb :=_bg .Choice ;
_egb !=nil {if _egb .V !=nil {_fgb =*_egb .V ;}else if _dda :=_egb .StrRef ;_dda !=nil {if _ce :=_dda .StrCache ;_ce !=nil {for _ ,_ac :=range _ce .Pt {_fgb =_ac .V ;};};};};};if _gf :=_ea .Cat ;_gf !=nil {if _aee :=_gf .Choice ;_aee !=nil {if _eea :=_aee .StrRef ;
_eea !=nil {if _fec :=_eea .F ;_fec !=""&&_aec !=nil {_ga ,_gfc ,_def ,_edd :=ParseExcelRange (_fec );if _edd ==nil {for _ ,_cdc :=range _aec .Sheets (){if _cdc .Name ()==_ege .Trim (_ga ,"\u0027"){_ebc :=_gfc .String ();for _gdd :=_gfc .RowIdx ;_gdd <=_def .RowIdx ;
_gdd +=1{_dfd :=_ege .ReplaceAll (_ebc ,_a .Sprint (_gfc .RowIdx ),_a .Sprint (_gdd ));_fd .addCatName (_cdc .Cell (_dfd ).GetString (),_eef ,&_efd );};break ;};};};};if _baf :=_eea .StrCache ;_baf !=nil {for _ ,_eaa :=range _baf .Pt {_fd .addCatName (_eaa .V ,_eef ,&_efd );
};};}else if _gb :=_aee .NumRef ;_gb !=nil {if _defd :=_gb .NumCache ;_defd !=nil {var _db string ;if _defd .FormatCode !=nil {_db =*_defd .FormatCode ;};for _ ,_bf :=range _defd .Pt {var _ff string ;if _bf .FormatCodeAttr ==nil {_ff =_db ;}else {_ff =*_bf .FormatCodeAttr ;
};var _acc string ;_bc ,_ffa :=_de .ParseFloat (_bf .V ,64);if _ffa !=nil {_acc =_bf .V ;}else {_acc =_cbe .Number (_bc ,_ff );};_fd .addCatName (_acc ,_eef ,&_efd );};};};};};if _beb :=_ea .Val ;_beb !=nil {if _dge :=_beb .Choice ;_dge !=nil {if _cbff :=_dge .NumRef ;
_cbff !=nil {if _fea :=_cbff .F ;_fea !=""&&_aec !=nil {_gg ,_gda ,_ab ,_bgd :=ParseExcelRange (_fea );if _bgd ==nil {for _ ,_ca :=range _aec .Sheets (){if _ca .Name ()==_ege .Trim (_gg ,"\u0027"){_ace :=_gda .String ();for _gfg :=_gda .RowIdx ;_gfg <=_ab .RowIdx ;
_gfg +=1{_gaf :=_ege .ReplaceAll (_ace ,_a .Sprint (_gda .RowIdx ),_a .Sprint (_gfg ));if _ca .FormulaContext ().HasFormula (_gaf ){_dad :=_b .NewEvaluator ();_eda :=_ca .FormulaContext ().Cell (_gaf ,_dad );_cbc :=_eda .Value ();_fd .addCatValue (_cbc ,_eef ,_efd ,(int )(_gfg -_gda .RowIdx ),&_af ,&_ba ,_fgb ,_ea .SpPr );
}else {_acd :=_ca .Cell (_gaf ).GetString ();_fd .addCatValue (_acd ,_eef ,_efd ,(int )(_gfg -_gda .RowIdx ),&_af ,&_ba ,_fgb ,_ea .SpPr );};};break ;};};};};if _agd :=_cbff .NumCache ;_agd !=nil {for _egc ,_cdb :=range _agd .Pt {_fd .addCatValue (_cdb .V ,_eef ,_efd ,_egc ,&_af ,&_ba ,_fgb ,_ea .SpPr );
};};};};};_df =append (_df ,&legendItem {_dfc :_fgb ,_gdc :_ea .SpPr });};var _aag float64 ;var _bee ,_dff float64 ;if _ba ==0&&_af ==0{_aag =0.2;_dff =0;_bee =1;}else {var _bac float64 ;if _eeg :=_cb .Abs (_af );_ba < _eeg {_bac =_eeg ;}else {_bac =_ba ;
};_dffg :=_cb .Pow (10,_cb .Floor (_cb .Log10 (_bac )));_abe :=_bac /_dffg ;if _abe < 4.29{_aag =0.5;}else if _abe >=4.29&&_abe < 8.58{_aag =1;}else {_aag =2;};_aag *=_dffg ;if _ba <=0{_bee =0;}else {_bee =(_cb .Ceil (_ba /_aag )+1)*_aag ;};if _af >=0{_dff =0;
}else {_dff =(_cb .Floor (_af /_aag )-1)*_aag ;};};_fa :=_fd .drawAxes (_be ,_dff ,_bee ,_aag ,_efd ,_gd ,_ag );if _fa !=nil {return nil ,_fa ;};_ffb :=0.0;if _ec .GapWidth !=nil {if _ebe :=_ec .GapWidth .ValAttr ;_ebe !=nil {if _fdc :=_ebe .ST_GapAmountUShort ;
_fdc !=nil {_ffb =float64 (*_fdc )/100.0;};};};_cbfd :=_gd .Right -_gd .Left ;_ece :=_gd .Bottom -_gd .Top ;_ggf :=float64 (len (_efd ));if _ag {_dbg :=_bee /(_bee -_dff )*_cbfd ;_acef :=-_dff /(_bee -_dff )*_cbfd ;_feg :=_gd .Left +_acef ;_bd :=_ece /_ggf ;
for _eee ,_agf :=range _efd {_ecec :=_eef [_agf ];_fgdd :=float64 (len (_ecec ._ffe ))+_ffb ;_bcd :=_bd /_fgdd ;_gbe :=_bcd *_ffb ;_gab :=_gd .Bottom -float64 (_eee )*_bd -_gbe /2-_bcd ;for _ ,_ccg :=range _ecec ._ffe {if _ccg ._fb ==0{continue ;};var _ad ,_fdg float64 ;
if _ccg ._fb > 0{_fdg =_ccg ._fb /_bee *_dbg ;_fd .drawRectangleWithProps (_ccg ._bed ,_feg ,_gab ,_fdg ,_bcd ,false );}else {_fdg =_ccg ._fb /_dff *_acef ;_ad =_feg -_fdg ;_fd .drawRectangleWithProps (_ccg ._bed ,_ad ,_gab ,_fdg ,_bcd ,false );};_gab -=_bcd ;
};};}else {_daa :=_bee /(_bee -_dff )*_ece ;_abf :=-_dff /(_bee -_dff )*_ece ;_gc :=_gd .Top +_daa ;_edfa :=_cbfd /_ggf ;for _beea ,_ggd :=range _efd {_fgbd :=_eef [_ggd ];_bfe :=float64 (len (_fgbd ._ffe ))+_ffb ;_adf :=_edfa /_bfe ;_ggb :=_adf *_ffb ;
_fcg :=_gd .Left +float64 (_beea )*_edfa +_ggb /2;for _ ,_fef :=range _fgbd ._ffe {var _fdb ,_gge float64 ;if _fef ._fb > 0{_gge =_fef ._fb /_bee *_daa ;_fdb =_gc -_gge ;_fd .drawRectangleWithProps (_fef ._bed ,_fcg ,_fdb ,_adf ,_gge ,false );}else {_gge =_fef ._fb /_dff *_abf ;
_fd .drawRectangleWithProps (_fef ._bed ,_fcg ,_gc ,_adf ,_gge ,false );};_fcg +=_adf ;};};};return _df ,nil ;};func (_dgac *creatorContext )drawLineWithProps (_abg *_ed .CT_ShapeProperties ,_fagc ,_eca ,_bgg ,_fgcd float64 ,_caef bool ){if _abg !=nil {if _gagd :=_abg .Ln ;
_gagd !=nil {_aea :=_dgac .getPdfColorFromSolidFill (_gagd .SolidFill );if _aea ==nil &&_caef {_aea =_cg .ColorBlack ;};if _aea !=nil {var _beee float64 ;if _cfea :=_gagd .WAttr ;_cfea !=nil {_beee =_eb .FromEMU (int64 (*_cfea ));}else {_beee =_beg ;};
DrawLine (_dgac ._ffaa ,_fagc ,_eca ,_bgg ,_fgcd ,_beee ,_aea );};};};};func _eccfb (_bbga *_dc .CT_CatAx )(uint32 ,_dc .ST_AxPos ,_dc .ST_TickMark ,_dc .ST_TickLblPos ,*_dc .CT_ChartLines ,uint32 ,*_ed .CT_ShapeProperties ,error ){var _aad ,_cae uint32 ;
var _ffae _dc .ST_AxPos ;var _afc _dc .ST_TickMark ;var _agg *_dc .CT_ChartLines ;var _fbge _dc .ST_TickLblPos ;if _bbga .AxId ==nil {return _aad ,_ffae ,_afc ,_fbge ,_agg ,_cae ,_bbga .SpPr ,_eg .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_aad =_bbga .AxId .ValAttr ;};if _bbga .AxPos ==nil {return _aad ,_ffae ,_afc ,_fbge ,_agg ,_cae ,_bbga .SpPr ,_eg .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ffae =_bbga .AxPos .ValAttr ;
};if _bbga .MajorTickMark !=nil {_afc =_bbga .MajorTickMark .ValAttr ;};if _bbga .TickLblPos !=nil {_fbge =_bbga .TickLblPos .ValAttr ;};if _bbga .CrossAx ==nil {return _aad ,_ffae ,_afc ,_fbge ,_agg ,_cae ,_bbga .SpPr ,_eg .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_cae =_bbga .CrossAx .ValAttr ;};_agg =_bbga .MajorGridlines ;return _aad ,_ffae ,_afc ,_fbge ,_agg ,_cae ,_bbga .SpPr ,nil ;};func FromSTPercentage (st *_ed .ST_Percentage )float64 {if _bbgfd :=st .ST_PercentageDecimal ;_bbgfd !=nil {return float64 (*_bbgfd )/100000;
};return 0;};func RegisterFontsFromFiles (files []string )error {for _ ,_dbe :=range files {if _ege .HasSuffix (_dbe ,"\u002e\u0074\u0074\u0066"){_dec :=_gad (_dbe );if _dec !=nil {_egeb .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_dec );
continue ;};};};return nil ;};func _gfedb (_gfedbe float64 )float64 {return _gfedbe *_eb .Millimeter };var _gec =_gfedb (5);func GetImage (c *_cg .Creator ,goImg _ef .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_cg .Image ,error ){if goImg ==nil {return nil ,nil ;
};_bdf :=goImg .Bounds ().Size ();_fgcf :=_bdf .X ;_fgca :=_bdf .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_fgcf );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_fgca );};var _acbe _ef .Rectangle ;switch part {case ImgPart_t :_acbe =_ef .Rect (0,0,_fgcf ,int (dividerY ));
case ImgPart_b :_acbe =_ef .Rect (0,int (dividerY ),_fgcf ,_fgca );case ImgPart_l :_acbe =_ef .Rect (0,0,int (dividerX ),_fgca );case ImgPart_r :_acbe =_ef .Rect (int (dividerX ),0,_fgcf ,_fgca );case ImgPart_lt :_acbe =_ef .Rect (0,0,int (dividerX ),int (dividerY ));
case ImgPart_rt :_acbe =_ef .Rect (int (dividerX ),0,_fgcf ,int (dividerY ));case ImgPart_lb :_acbe =_ef .Rect (0,int (dividerY ),int (dividerX ),_fgca );case ImgPart_rb :_acbe =_ef .Rect (int (dividerX ),int (dividerY ),_fgcf ,_fgca );default:_acbe =_ef .Rect (0,0,_fgcf ,_fgca );
};_gaef :=CropImageByRect (goImg ,_acbe );_dcef ,_fgfa :=c .NewImageFromGoImage (_gaef );if _fgfa !=nil {return nil ,_fgfa ;};_dcef .Scale (imgWidth /float64 (_fgcf ),imgHeight /float64 (_fgca ));_dcef .SetPos (left ,top );return _dcef ,nil ;};func GetGroupOffsetFromXfrm (xfrm *_ed .CT_GroupTransform2D )(float64 ,float64 ){var _bfa ,_dcec float64 ;
if xfrm .Off !=nil &&xfrm .ChOff !=nil {_bfa =_eb .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_eb .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));_dcec =_eb .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_eb .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));
};return _bfa ,_dcec ;};type creatorContext struct{_ffaa *_cg .Creator ;_cfbg *_ed .Theme ;_bcec float64 ;};func FillRectangle (c *_cg .Creator ,x ,y ,width ,height float64 ,color _cg .Color ){if color ==nil {return ;};_bdba :=c .NewRectangle (x ,y ,width ,height );
_bdba .SetFillColor (color );_bdba .SetBorderWidth (0);c .Draw (_bdba );};func AdjustColor (colorStr string ,EG_ColorTransform []*_ed .EG_ColorTransform )string {for _ ,_dbc :=range EG_ColorTransform {if _ddcb :=_dbc .Tint ;_ddcb !=nil {if _egbc :=_ddcb .ValAttr .ST_PositiveFixedPercentageDecimal ;
_egbc !=nil {colorStr =AdjustColorByTint (colorStr ,float64 (*_egbc )/100000);};};if _cde :=_dbc .Shade ;_cde !=nil {if _egfg :=_cde .ValAttr .ST_PositiveFixedPercentageDecimal ;_egfg !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_egfg )/100000);
};};if _fge :=_dbc .LumMod ;_fge !=nil {if _aecdg :=_fge .ValAttr .ST_PercentageDecimal ;_aecdg !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_aecdg )/100000);};};};return colorStr ;};type serCategory struct{_gfb string ;_ffe []serValue ;};
var _fde =_gfedb (1);var _cffe =_gfedb (1.5);var _adeg =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
func (_cfa *creatorContext )drawBorderWithProps (_ggaf *_ed .CT_ShapeProperties ,_fcb *Rectangle ,_dgdd float64 ){if _fcb !=nil &&_ggaf !=nil &&_ggaf .Ln !=nil &&_ggaf .Ln .SolidFill !=nil {_gbbeb :=_cfa .getPdfColorFromSolidFill (_ggaf .Ln .SolidFill );
DrawRectangle (_cfa ._ffaa ,_fcb ,_dgdd ,_gbbeb );};};func RegisterFontsFromDirectory (dirName string )error {_cga ,_eaga :=_e .Open (dirName );if _eaga !=nil {return _eaga ;};defer _cga .Close ();_gacfe ,_eaga :=_cga .Readdirnames (0);if _eaga !=nil {return _eaga ;
};for _ ,_bdbg :=range _gacfe {if _ege .HasSuffix (_bdbg ,"\u002e\u0074\u0074\u0066"){_gbfeg :=dirName +"\u002f"+_bdbg ;_dfdf :=_gad (_gbfeg );if _dfdf !=nil {_egeb .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_dfdf );
continue ;};};};return nil ;};func _ded (_fadd _ed .ST_SchemeColorVal ,_dafd *_ed .Theme )string {if _agcb :=_dafd .ThemeElements ;_agcb !=nil {if _acce :=_agcb .ClrScheme ;_acce !=nil {switch _fadd {case _ed .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_acce .Lt1 );
case _ed .ST_SchemeColorValDk1 ,_ed .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_acce .Dk1 );case _ed .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_acce .Lt2 );case _ed .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_acce .Dk2 );
case _ed .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_acce .Accent1 );case _ed .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_acce .Accent2 );case _ed .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_acce .Accent3 );
case _ed .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_acce .Accent4 );case _ed .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_acce .Accent5 );case _ed .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_acce .Accent6 );
};};};return "";};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_eb .Twips *10+0.5))/10;};func GetColorStringFromDmlColor (dmlColor *_ed .CT_Color )string {var _adcd string ;if _aab :=dmlColor .SrgbClr ;_aab !=nil {_adcd =_aab .ValAttr ;
}else if _ffec :=dmlColor .SysClr ;_ffec !=nil {if _ffec .LastClrAttr !=nil {return *_ffec .LastClrAttr ;};return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _adcd ;};func DrawLine (c *_cg .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _cg .Color ){if color ==nil {return ;
};_gfbd :=c .NewLine (x0 ,y0 ,x1 ,y1 );_gfbd .SetLineWidth (width );_gfbd .SetColor (color );c .Draw (_gfbd );};func RegisterEmbeddedFonts (d *_da .Document )error {_ced :=d .FontTable ();if _ced ==nil {return nil ;};for _ ,_bacg :=range _ced .Font {if _bacg .EmbedRegular !=nil {return _eefe (d ,_bacg .NameAttr ,_bacg .EmbedRegular .IdAttr ,_bacg .EmbedRegular .FontKeyAttr );
};if _bacg .EmbedBold !=nil {return _eefe (d ,_bacg .NameAttr ,_bacg .EmbedBold .IdAttr ,_bacg .EmbedBold .FontKeyAttr );};if _bacg .EmbedItalic !=nil {return _eefe (d ,_bacg .NameAttr ,_bacg .EmbedItalic .IdAttr ,_bacg .EmbedItalic .FontKeyAttr );};if _bacg .EmbedBoldItalic !=nil {return _eefe (d ,_bacg .NameAttr ,_bacg .EmbedBoldItalic .IdAttr ,_bacg .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};func _dagc (_cad _ed .ST_SchemeColorVal ,_fgc *_ed .Theme )string {if _bffd :=_fgc .ThemeElements ;_bffd !=nil {if _cfed :=_bffd .ClrScheme ;_cfed !=nil {switch _cad {case _ed .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_cfed .Lt1 );
case _ed .ST_SchemeColorValDk1 ,_ed .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_cfed .Dk1 );case _ed .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_cfed .Lt2 );case _ed .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_cfed .Dk2 );
case _ed .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_cfed .Accent1 );case _ed .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_cfed .Accent2 );case _ed .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_cfed .Accent3 );
case _ed .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_cfed .Accent4 );case _ed .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_cfed .Accent5 );case _ed .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_cfed .Accent6 );
};};};return "";};func AssignStdFontByName (style _cg .TextStyle ,fontName string )*_cbf .PdfFont {_bdd :=_cbf .StdFontName (fontName );return _cbf .NewStandard14FontMustCompile (_bdd );};func AdjustColorByShade (colorStr string ,shade float64 )string {var _cadg ,_eac ,_bfef uint8 ;
_ebffe ,_ :=_a .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_cadg ,&_eac ,&_bfef );if _ebffe !=3{return "";};return _ffg (_cadg ,shade )+_ffg (_eac ,shade )+_ffg (_bfef ,shade );};func _gbcg (_edec float64 )float64 {if _edec < 0{_edec +=float64 (-int (_edec )+1);
}else if _edec > 1{_edec -=float64 (int (_edec ));};return _edec ;};type ImgPart byte ;func (_dbbc FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_dbbc )];
};func _ccae (_eabe ,_fdbd ,_ccbg float64 )float64 {if _eabe *6< 1{return _ccbg +(_fdbd -_ccbg )*6*_eabe ;}else if _eabe *2< 1{return _fdbd ;}else if _eabe *3< 2{return _ccbg +(_fdbd -_ccbg )*(2.0/3.0-_eabe )*6;}else {return _ccbg ;};};type serValue struct{_ebf string ;
_fb float64 ;_bed *_ed .CT_ShapeProperties ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func _gad (_cbb string )error {if !_ege .HasSuffix (_cbb ,"\u002e\u0074\u0074\u0066"){_egeb .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _a .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_ddf ,_gcdb :=_fe .ParseFile (_cbb );if _gcdb !=nil {_egeb .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gcdb );return _gcdb ;};_dega ,_gcdb :=_cbf .NewCompositePdfFontFromTTFFile (_cbb );
if _gcdb !=nil {return _gcdb ;};_dea :=_ddf .GetNameRecords ();for _ ,_agdb :=range _dea {_caee :=_agdb [1];if _caee ==""{continue ;};_edc :=make ([]byte ,0);for _gddc :=0;_gddc < len (_caee );_gddc ++{if _caee [_gddc ]==39||_caee [_gddc ]==92{continue ;
};_bcf :=4;if _gddc +_bcf < len (_caee ){if _caee [_gddc :_gddc +_bcf ]=="\u0000"{_gddc =_gddc +_bcf +1;continue ;};};_edc =append (_edc ,_caee [_gddc ]);};_caee =_ege .Replace (string (_edc ),"\u0078\u0030\u0030","",-1);_cfb :=_agdb [2];if _cfb ==""{return _a .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_cbb );
};_edc =make ([]byte ,0);for _gfga :=0;_gfga < len (_cfb );_gfga ++{if _cfb [_gfga ]==39||_cfb [_gfga ]==92{continue ;};_fba :=4;if _gfga +_fba < len (_cfb ){if _cfb [_gfga :_gfga +_fba ]=="\u0000"{_gfga =_gfga +_fba +1;continue ;};};_edc =append (_edc ,_cfb [_gfga ]);
};_cfb =_ege .Replace (string (_edc ),"\u0078\u0030\u0030","",-1);RegisterFont (_caee ,_adeg [_cfb ],_dega );};return nil ;};func (_caeg *creatorContext )drawPieChart (_gdae *_dc .CT_PieChart ,_gbga *Rectangle ,_agcg *_fg .Workbook ,_aeec float64 )([]*legendItem ,error ){_fcd :=[]*legendItem {};
_gade :=map[string ]serCategory {};_cfee :=[]string {};_cdgd :=_cb .Inf (1);_gfca :=_cb .Inf (-1);_efa :=_gdae .Ser ;for _ ,_gdf :=range _efa {var _cbgf string ;if _cgd :=_gdf .Tx ;_cgd !=nil {if _eccc :=_cgd .Choice ;_eccc !=nil {if _eccc .V !=nil {_cbgf =*_eccc .V ;
}else if _eggc :=_eccc .StrRef ;_eggc !=nil {if _gdfd :=_eggc .StrCache ;_gdfd !=nil {for _ ,_dfe :=range _gdfd .Pt {_cbgf =_dfe .V ;};};};};};if _gae :=_gdf .Cat ;_gae !=nil {if _daad :=_gae .Choice ;_daad !=nil {if _dce :=_daad .StrRef ;_dce !=nil {if _abee :=_dce .F ;
_abee !=""&&_agcg !=nil {_fcag ,_fgde ,_cfd ,_dgab :=ParseExcelRange (_abee );if _dgab ==nil {for _ ,_ggec :=range _agcg .Sheets (){if _ggec .Name ()==_ege .Trim (_fcag ,"\u0027"){_gdb :=_fgde .String ();for _edgg :=_fgde .RowIdx ;_edgg <=_cfd .RowIdx ;
_edgg +=1{_agda :=_ege .ReplaceAll (_gdb ,_a .Sprint (_fgde .RowIdx ),_a .Sprint (_edgg ));_caeg .addCatName (_ggec .Cell (_agda ).GetString (),_gade ,&_cfee );};break ;};};};};if _ffbg :=_dce .StrCache ;_ffbg !=nil {for _ ,_daca :=range _ffbg .Pt {_caeg .addCatName (_daca .V ,_gade ,&_cfee );
};};}else if _bdc :=_daad .NumRef ;_bdc !=nil {if _faa :=_bdc .NumCache ;_faa !=nil {var _dab string ;if _faa .FormatCode !=nil {_dab =*_faa .FormatCode ;};for _ ,_feca :=range _faa .Pt {var _dffe string ;if _feca .FormatCodeAttr ==nil {_dffe =_dab ;}else {_dffe =*_feca .FormatCodeAttr ;
};var _faac string ;_gff ,_acede :=_de .ParseFloat (_feca .V ,64);if _acede !=nil {_faac =_feca .V ;}else {_faac =_cbe .Number (_gff ,_dffe );};_caeg .addCatName (_faac ,_gade ,&_cfee );};};};};};if _bbe :=_gdf .Val ;_bbe !=nil {if _cag :=_bbe .Choice ;
_cag !=nil {if _cfbe :=_cag .NumRef ;_cfbe !=nil {if _cdec :=_cfbe .F ;_cdec !=""&&_agcg !=nil {_efaa ,_ggdg ,_ggecg ,_dcb :=ParseExcelRange (_cdec );if _dcb ==nil {for _ ,_bcg :=range _agcg .Sheets (){if _bcg .Name ()==_ege .Trim (_efaa ,"\u0027"){_eed :=_ggdg .String ();
for _cfdc :=_ggdg .RowIdx ;_cfdc <=_ggecg .RowIdx ;_cfdc +=1{_efbe :=_ege .ReplaceAll (_eed ,_a .Sprint (_ggdg .RowIdx ),_a .Sprint (_cfdc ));if _bcg .FormulaContext ().HasFormula (_efbe ){_ffed :=_b .NewEvaluator ();_eeb :=_bcg .FormulaContext ().Cell (_efbe ,_ffed );
_adega :=_eeb .Value ();_caeg .addCatValue (_adega ,_gade ,_cfee ,(int )(_cfdc -_ggdg .RowIdx ),&_cdgd ,&_gfca ,_cbgf ,_gdf .SpPr );}else {_bdga :=_bcg .Cell (_efbe ).GetString ();_caeg .addCatValue (_bdga ,_gade ,_cfee ,(int )(_cfdc -_ggdg .RowIdx ),&_cdgd ,&_gfca ,_cbgf ,_gdf .SpPr );
};};break ;};};};};if _cffg :=_cfbe .NumCache ;_cffg !=nil {for _dafdc ,_ebdg :=range _cffg .Pt {_caeg .addCatValue (_ebdg .V ,_gade ,_cfee ,_dafdc ,&_cdgd ,&_gfca ,_cbgf ,_gdf .SpPr );};};};};};};_ccbbd :=&_ee .PieChart {Values :[]_ae .Value {}};for _ ,_gedg :=range _cfee {_dbbe :=_gade [_gedg ];
if len (_dbbe ._ffe )> 0{_ccbbd .Values =append (_ccbbd .Values ,_ae .Value {Value :_dbbe ._ffe [0]._fb ,Label :_gedg ,Style :_dd .Style {FontSize :12*_aeec }});};};_ccbbd .SetHeight (int (_gbga .Top -_gbga .Bottom ));_ccbbd .SetWidth (int (_gbga .Right -_gbga .Left ));
_fged :=_caeg ._ffaa ;_afaa :=_cg .NewChart (_ccbbd );_afaa .SetPos (_gbga .Left ,_gbga .Top );_aabe :=_fged .Draw (_afaa );if _aabe !=nil {return nil ,_aabe ;};return _fcd ,nil ;};func LoadFontFromFile (filename string )(*_cbf .PdfFont ,error ){if !_ege .HasSuffix (filename ,"\u002e\u0074\u0074\u0066"){_egeb .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return nil ,_a .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_dfbe ,_cfg :=_cbf .NewCompositePdfFontFromTTFFile (filename );if _cfg !=nil {return nil ,_cfg ;};return _dfbe ,nil ;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func IsNoSpaceLanguage (symbol string )bool {for _ ,_egecd :=range symbol {if _c .Is (_c .Han ,_egecd ){return true ;
};};return false ;};func TwipsFromPoints (points float64 )float64 {return points /_eb .Twips };const _cff =6.0;func (_fbc barSerByOrder )Swap (i ,j int ){_fbc [i ],_fbc [j ]=_fbc [j ],_fbc [i ]};func _egd (_ceef ,_fgf ,_cgba uint8 )(float64 ,float64 ,float64 ){_ggcg ,_ebfc ,_ceg :=float64 (_ceef )/255,float64 (_fgf )/255,float64 (_cgba )/255;
_egcc :=_ggcg ;if _ebfc < _egcc {_egcc =_ebfc ;};if _ceg < _egcc {_egcc =_ceg ;};var _fbd ,_egbaf bool ;_bbgb :=_ggcg ;if _ebfc > _bbgb {_bbgb =_ebfc ;_fbd =true ;};if _ceg > _bbgb {_bbgb =_ceg ;_fbd =false ;_egbaf =true ;};_dagf :=(_egcc +_bbgb )/2;var _bffg float64 ;
if _egcc !=_bbgb {if _dagf <=0.5{_bffg =(_bbgb -_egcc )/(_bbgb +_egcc );}else {_bffg =(_bbgb -_egcc )/(2.0-_bbgb -_egcc );};};var _gbgf float64 ;if _egcc !=_bbgb {if _fbd {_gbgf =2.0+(_ceg -_ggcg )/(_bbgb -_egcc );}else if _egbaf {_gbgf =4.0+(_ggcg -_ebfc )/(_bbgb -_egcc );
}else {_gbgf =(_ebfc -_ceg )/(_bbgb -_egcc );};_gbgf *=60;if _gbgf < 0{_gbgf +=360;};};return _gbgf ,_bffg ,_dagf ;};type barSerByOrder []*_dc .CT_BarSer ;type BorderPosition byte ;func _gcc (_bbb ,_aca ,_fdf float64 )(uint8 ,uint8 ,uint8 ){var _agce float64 ;
if _fdf < 0.5{_agce =_fdf *(1+_aca );}else {_agce =_fdf +_aca -_fdf *_aca ;};_dbbb :=_fdf *2-_agce ;_bbb /=360.0;_gdge :=_gbcg (_bbb +1.0/3.0);_bab :=_gbcg (_bbb );_fee :=_gbcg (_bbb -1.0/3.0);_fggb :=_ccae (_gdge ,_agce ,_dbbb );_ecce :=_ccae (_bab ,_agce ,_dbbb );
_fggg :=_ccae (_fee ,_agce ,_dbbb );return uint8 (255*_fggb ),uint8 (255*_ecce ),uint8 (255*_fggg );};func FromSTCoordinate (st _ed .ST_Coordinate )int64 {if _gfa :=st .ST_CoordinateUnqualified ;_gfa !=nil {return *_gfa ;};return 0;};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _ffd ,_ebba ,_eaf uint8 ;
_afa ,_ :=_a .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_ffd ,&_ebba ,&_eaf );if _afa !=3{return "";};_bedd ,_dgag ,_add :=_egd (_ffd ,_ebba ,_eaf );_add =lum *_add ;_ffd ,_ebba ,_eaf =_gcc (_bedd ,_dgag ,_add );
return _a .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_ffd ,_ebba ,_eaf );};type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};func MakeTempCreator (width ,height float64 )*_cg .Creator {_cab :=_cg .New ();
_cab .SetPageSize (_cg .PageSize {width ,height });_cab .SetPageMargins (0,0,0,0);return _cab ;};var _fca =_gfedb (7.5);var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func FromSTCoordinate32 (st _ed .ST_Coordinate32 )int64 {if _bgde :=st .ST_Coordinate32Unqualified ;_bgde !=nil {return int64 (*_bgde );};return 0;};func RegisterFont (name string ,style FontStyle ,font *_cbf .PdfFont ){_gacf ._fefc .Lock ();if _gacf ._dagb [name ]==nil {_gacf ._dagb [name ]=map[FontStyle ]*_cbf .PdfFont {};
};_gacf ._dagb [name ][style ]=font ;_gacf ._fefc .Unlock ();};func GetPageFromCreator (c *_cg .Creator )(*_cbf .PdfPage ,error ){_ceea :=_ge .NewBuffer ([]byte {});_bfcd :=c .Write (_ceea );if _bfcd !=nil {return nil ,_bfcd ;};_feea :=_ge .NewReader (_ceea .Bytes ());
_fcda ,_bfcd :=_cbf .NewPdfReader (_feea );if _bfcd !=nil {return nil ,_bfcd ;};return _fcda .GetPage (1);};func (_geag *Rectangle )Translate (x ,y float64 ){_geag .Left +=x ;_geag .Right +=x ;_geag .Top +=y ;_geag .Bottom +=y ;};func (_cf *creatorContext )addCatValue (_bacb string ,_aeg map[string ]serCategory ,_egf []string ,_gcg int ,_aed ,_aecd *float64 ,_fad string ,_egg *_ed .CT_ShapeProperties ){_bea ,_ggea :=_de .ParseFloat (_bacb ,64);
if _ggea !=nil {_bea =0;_egeb .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_ggea );};if _bea > *_aecd {*_aecd =_bea ;};if _bea < *_aed {*_aed =_bea ;};_fecb :=_aeg [_egf [_gcg ]];_fecb ._ffe =append (_fecb ._ffe ,serValue {_ebf :_fad ,_fb :_bea ,_bed :_egg });
_aeg [_egf [_gcg ]]=_fecb ;};func _cgf (_gfgc *_dc .ChartSpace ,_cge ,_eddaa float64 ,_gabg *_ed .Theme ,_cbef bool ,_gbc *_fg .Workbook )(*_cg .Creator ,error ){_fff :=1.0;if _cbef {_fff =8.0;};_agfa :=&Rectangle {};_ecc :=&Rectangle {Top :_agfa .Top ,Bottom :_eddaa -_agfa .Bottom ,Left :_agfa .Left ,Right :_cge -_agfa .Right };
_beeaf :=MakeTempCreator (_cge *_fff +1,_eddaa *_fff +1);_eega :=&creatorContext {_ffaa :_beeaf ,_cfbg :_gabg ,_bcec :_fff };var _cged bool ;if _fecd :=_gfgc .Chart ;_fecd !=nil {_ead :=_fecd .PlotArea ;if _ead ==nil {return nil ,_eg .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");
};_bbge :=0.0;if _fecd .AutoTitleDeleted !=nil &&_fecd .AutoTitleDeleted .ValAttr !=nil &&!*_fecd .AutoTitleDeleted .ValAttr {_bafd :="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";if _fecd .Title !=nil &&_fecd .Title .Overlay !=nil &&_fecd .Title .Overlay .ValAttr !=nil &&!*_fecd .Title .Overlay .ValAttr {_bbge =_gfedb (10);
};if _fecd .Title !=nil &&_fecd .Title .Tx !=nil &&_fecd .Title .Tx .Choice !=nil &&_fecd .Title .Tx .Choice .Rich !=nil {if len (_fecd .Title .Tx .Choice .Rich .P )> 0{if len (_fecd .Title .Tx .Choice .Rich .P [0].EG_TextRun )> 0{_bafd =_fecd .Title .Tx .Choice .Rich .P [0].EG_TextRun [0].R .T ;
};};};_eega .drawTitle (_bafd ,_ecc .Left +_ecc .Right /2,_gfedb (5));};_aaa :=&Rectangle {Top :_gfedb (10)+_bbge ,Bottom :_ecc .Bottom -_gfedb (15),Left :_gfedb (10),Right :_ecc .Right -_gfedb (10)};var _fda *Rectangle ;_aac :=_fecd .Legend ;if _aac !=nil {_acg :=_aac .Overlay !=nil &&_aac .Overlay .ValAttr !=nil &&*_aac .Overlay .ValAttr ;
if _cbd :=_aac .LegendPos ;_cbd !=nil {switch _cbd .ValAttr {case _dc .ST_LegendPosTr :if !_acg {_aaa =&Rectangle {Top :_gfedb (25)+_bbge ,Bottom :_ecc .Bottom -_gfedb (10),Left :_gfedb (10),Right :_ecc .Right -_gfedb (25)};};_fda =&Rectangle {Top :_gfedb (2.5)+_bbge ,Bottom :_gfedb (22.5),Left :_ecc .Right -_gfedb (22.5),Right :_ecc .Right -_gfedb (2.5)};
case _dc .ST_LegendPosT :_fda =&Rectangle {Top :_gfedb (2.5)+_bbge ,Bottom :_gfedb (7.5),Left :(_ecc .Right -_ecc .Left )*0.25,Right :(_ecc .Right -_ecc .Left )*0.75};if !_acg {_aaa =&Rectangle {Top :_gfedb (12.5)+_bbge ,Bottom :_ecc .Bottom -_gfedb (15),Left :_gfedb (10),Right :_ecc .Right -_gfedb (5)};
};_cged =true ;case _dc .ST_LegendPosB :_fda =&Rectangle {Top :_ecc .Bottom -_gfedb (7.5)+_bbge ,Bottom :_ecc .Bottom -_gfedb (2.5),Left :(_ecc .Right -_ecc .Left )*0.25,Right :(_ecc .Right -_ecc .Left )*0.75};if !_acg {_aaa =&Rectangle {Top :_gfedb (5)+_bbge ,Bottom :_ecc .Bottom -_gfedb (15),Left :_gfedb (10),Right :_ecc .Right -_gfedb (5)};
};_cged =true ;case _dc .ST_LegendPosR :_fda =&Rectangle {Top :(_ecc .Bottom -_ecc .Top )/2-_gfedb (10)+_bbge ,Bottom :(_ecc .Bottom -_ecc .Top )/2+_gfedb (10),Left :_ecc .Right -_gfedb (22.5),Right :_ecc .Right -_gfedb (2.5)};if !_acg {_aaa =&Rectangle {Top :_gfedb (5)+_bbge ,Bottom :_ecc .Bottom -_gfedb (12.5),Left :_gfedb (10),Right :_ecc .Right -_gfedb (25)};
};case _dc .ST_LegendPosL :_fda =&Rectangle {Top :(_ecc .Bottom -_ecc .Top )/2-_gfedb (10)+_bbge ,Bottom :(_ecc .Bottom -_ecc .Top )/2+_gfedb (10),Left :_gfedb (2.5),Right :_gfedb (22.5)};if !_acg {_aaa =&Rectangle {Top :_gfedb (5)+_bbge ,Bottom :_ecc .Bottom -_gfedb (12.5),Left :_gfedb (30),Right :_ecc .Right -_gfedb (5)};
};default:_fda =&Rectangle {Top :(_ecc .Bottom -_ecc .Top )/2-_gfedb (10)+_bbge ,Bottom :(_ecc .Bottom -_ecc .Top )/2+_gfedb (10),Left :_ecc .Right -_gfedb (25),Right :_ecc .Right -_gfedb (5)};if !_acg {_aaa =&Rectangle {Top :_gfedb (5)+_bbge ,Bottom :_ecc .Bottom -_gfedb (12.5),Left :_gfedb (100),Right :_ecc .Right -_gfedb (25)};
};};};};_aaa .scale (_fff );_eega .drawBorderWithProps (_ead .SpPr ,_aaa ,_beg );_abbb :=[]*legendItem {};var _baa error ;_fdca :=_ead .CChoice ;for _ ,_bff :=range _ead .Choice {if _gcf :=_bff .BarChart ;_gcf !=nil {_abbb ,_baa =_eega .drawBarChart (_gcf ,_aaa ,_fdca ,_gbc );
if _baa !=nil {return nil ,_baa ;};};if _efbf :=_bff .PieChart ;_efbf !=nil {_abbb ,_baa =_eega .drawPieChart (_efbf ,_aaa ,_gbc ,_fff );if _baa !=nil {return nil ,_baa ;};};};if _aac !=nil {_fda .scale (_fff );_eega .drawBorderWithProps (_aac .SpPr ,_fda ,_beg );
if len (_abbb )!=0{_eega .drawLegend (_fda ,_abbb ,_cged );};};};_ecc .scale (_fff );_eega .drawBorderWithProps (_gfgc .SpPr ,_ecc ,_beg );return _beeaf ,nil ;};func (_cfc *creatorContext )drawTitle (_bacd string ,_deb ,_cea float64 ){_dfb :=_cfc ._bcec ;
_caa :=_cfc ._ffaa .NewStyledParagraph ();_bega :=_caa .SetText (_bacd );_ccf ,_beba :=_cbf .NewStandard14Font (_cbf .HelveticaName );if _beba ==nil {_afb :=_cfc ._ffaa .NewTextStyle ();_afb .Font =_ccf ;_afb .FontSize =14;_afb .TextRise =0.4;_bega .Style =_afb ;
_caa .SetPos (_deb -_caa .Width ()*_dfb /2,_cea );_cfc ._ffaa .Draw (_caa );};};var _efb =_gfedb (1.5);const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;
ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);func AdjustColorByTint (colorStr string ,tint float64 )string {var _gbfe ,_egba ,_gfegb uint8 ;_cgef ,_ :=_a .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_gbfe ,&_egba ,&_gfegb );
if _cgef !=3{return "";};return _gbfc (_gbfe ,tint )+_gbfc (_egba ,tint )+_gbfc (_gfegb ,tint );};func _bage (_eaed *_dc .CT_SerAx )(uint32 ,_dc .ST_AxPos ,_dc .ST_TickMark ,_dc .ST_TickLblPos ,*_dc .CT_ChartLines ,uint32 ,*_ed .CT_ShapeProperties ,error ){var _egff ,_ccb uint32 ;
var _ecg _dc .ST_AxPos ;var _bcb _dc .ST_TickMark ;var _gebg *_dc .CT_ChartLines ;var _edb _dc .ST_TickLblPos ;if _eaed .AxId ==nil {return _egff ,_ecg ,_bcb ,_edb ,_gebg ,_ccb ,_eaed .SpPr ,_eg .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_egff =_eaed .AxId .ValAttr ;};if _eaed .AxPos ==nil {return _egff ,_ecg ,_bcb ,_edb ,_gebg ,_ccb ,_eaed .SpPr ,_eg .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ecg =_eaed .AxPos .ValAttr ;
};if _eaed .MajorTickMark !=nil {_bcb =_eaed .MajorTickMark .ValAttr ;};if _eaed .TickLblPos !=nil {_edb =_eaed .TickLblPos .ValAttr ;};if _eaed .CrossAx ==nil {return _egff ,_ecg ,_bcb ,_edb ,_gebg ,_ccb ,_eaed .SpPr ,_eg .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_ccb =_eaed .CrossAx .ValAttr ;};_gebg =_eaed .MajorGridlines ;return _egff ,_ecg ,_bcb ,_edb ,_gebg ,_ccb ,_eaed .SpPr ,nil ;};var _feaa =_gfedb (1.5);var _gacf =fontsMap {_fefc :&_d .Mutex {},_dagb :map[string ]map[FontStyle ]*_cbf .PdfFont {}};
func (_dga barSerByOrder )Len ()int {return len (_dga )};type FontStyle byte ;func MakeBlockFromCreator (c *_cg .Creator )(*_cg .Block ,error ){_begd ,_cbbb :=GetPageFromCreator (c );if _cbbb !=nil {return nil ,_cbbb ;};_ccff ,_cbbb :=_cg .NewBlockFromPage (_begd );
if _cbbb !=nil {return nil ,_cbbb ;};return _ccff ,nil ;};type fontsMap struct{_fefc *_d .Mutex ;_dagb map[string ]map[FontStyle ]*_cbf .PdfFont ;};func MakeTempCreatorMaxHeight (width float64 )*_cg .Creator {return MakeTempCreator (width ,_cb .MaxFloat64 );
};func (_eegg *Rectangle )scale (_fded float64 ){_eegg .Top *=_fded ;_eegg .Bottom *=_fded ;_eegg .Left *=_fded ;_eegg .Right *=_fded ;};func (_fgg *creatorContext )addCatName (_efg string ,_abb map[string ]serCategory ,_eec *[]string ){if _ ,_bbg :=_abb [_efg ];
!_bbg {_abb [_efg ]=serCategory {_gfb :_efg ,_ffe :[]serValue {}};*_eec =append (*_eec ,_efg );};};var RtlFontFile *_cbf .PdfFont ;const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;
);var _ebfb =_gfedb (0.5);func _gafa (_bdg *_dc .CT_DateAx )(uint32 ,_dc .ST_AxPos ,_dc .ST_TickMark ,_dc .ST_TickLblPos ,*_dc .CT_ChartLines ,uint32 ,*_ed .CT_ShapeProperties ,error ){var _egec ,_agc uint32 ;var _ade _dc .ST_AxPos ;var _cfe _dc .ST_TickMark ;
var _dfff *_dc .CT_ChartLines ;var _fbb _dc .ST_TickLblPos ;if _bdg .AxId ==nil {return _egec ,_ade ,_cfe ,_fbb ,_dfff ,_agc ,_bdg .SpPr ,_eg .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_egec =_bdg .AxId .ValAttr ;
};if _bdg .AxPos ==nil {return _egec ,_ade ,_cfe ,_fbb ,_dfff ,_agc ,_bdg .SpPr ,_eg .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ade =_bdg .AxPos .ValAttr ;};if _bdg .MajorTickMark !=nil {_cfe =_bdg .MajorTickMark .ValAttr ;
};if _bdg .TickLblPos !=nil {_fbb =_bdg .TickLblPos .ValAttr ;};if _bdg .CrossAx ==nil {return _egec ,_ade ,_cfe ,_fbb ,_dfff ,_agc ,_bdg .SpPr ,_eg .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_agc =_bdg .CrossAx .ValAttr ;
};_dfff =_bdg .MajorGridlines ;return _egec ,_ade ,_cfe ,_fbb ,_dfff ,_agc ,_bdg .SpPr ,nil ;};func MakeImageFromChartSpace (cs *_dc .ChartSpace ,width ,height float64 ,theme *_ed .Theme ,workbook *_fg .Workbook )(_ef .Image ,error ){_bfb ,_adg :=_cgf (cs ,width ,height ,theme ,true ,workbook );
if _adg !=nil {return nil ,_adg ;};_ede ,_adg :=GetPageFromCreator (_bfb );if _adg !=nil {return nil ,_adg ;};return _fc .NewImageDevice ().Render (_ede );};var (DefaultFontSize =12.0;DefaultImageEncoder _cd .StreamEncoder =_cd .NewFlateEncoder (););func _agb (_fae *_dc .CT_ValAx )(uint32 ,_dc .ST_AxPos ,_dc .ST_TickMark ,_dc .ST_TickLblPos ,*_dc .CT_ChartLines ,uint32 ,*_ed .CT_ShapeProperties ,error ){var _dafb ,_cdg uint32 ;
var _bfee _dc .ST_AxPos ;var _gbbb _dc .ST_TickMark ;var _ecgf *_dc .CT_ChartLines ;var _caab _dc .ST_TickLblPos ;if _fae .AxId ==nil {return _dafb ,_bfee ,_gbbb ,_caab ,_ecgf ,_cdg ,_fae .SpPr ,_eg .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_dafb =_fae .AxId .ValAttr ;};if _fae .AxPos ==nil {return _dafb ,_bfee ,_gbbb ,_caab ,_ecgf ,_cdg ,_fae .SpPr ,_eg .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_bfee =_fae .AxPos .ValAttr ;
};if _fae .MajorTickMark !=nil {_gbbb =_fae .MajorTickMark .ValAttr ;};if _fae .TickLblPos !=nil {_caab =_fae .TickLblPos .ValAttr ;};if _fae .CrossAx ==nil {return _dafb ,_bfee ,_gbbb ,_caab ,_ecgf ,_cdg ,_fae .SpPr ,_eg .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_cdg =_fae .CrossAx .ValAttr ;};_ecgf =_fae .MajorGridlines ;return _dafb ,_bfee ,_gbbb ,_caab ,_ecgf ,_cdg ,_fae .SpPr ,nil ;};func _ffg (_gag uint8 ,_ebgd float64 )string {_cbg :=float64 (_gag );return _a .Sprintf ("\u0025\u0030\u0032\u0078",int (_cbg *_ebgd ));
};func (_fdbe *creatorContext )getPdfColorFromSolidFill (_ecgd *_ed .CT_SolidColorFillProperties )_cg .Color {if _ecgd ==nil {return nil ;};_cebg :="";if _bcgg :=_ecgd .SrgbClr ;_bcgg !=nil {_cebg =_bcgg .ValAttr ;}else if _eacg :=_ecgd .SchemeClr ;_eacg !=nil {_cebg =_dagc (_eacg .ValAttr ,_fdbe ._cfbg );
};if _cebg ==""{return nil ;};return _cg .ColorRGBFromHex ("\u0023"+_cebg );};func (_faf *creatorContext )drawAxes (_fcc *_dc .CT_PlotAreaChoice1 ,_edfg ,_cda ,_abec float64 ,_cbeb []string ,_fefb *Rectangle ,_bag bool )error {_ecca :=_faf ._ffaa ;_dbd :=_faf ._bcec ;
if _fcc ==nil {return _eg .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_fcc .ValAx )==0||(len (_fcc .CatAx )==0&&len (_fcc .DateAx )==0&&len (_fcc .SerAx )==0){return _eg .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _gcd ,_efgd ,_gfe ,_ebff uint32 ;var _gfeg ,_ebb _dc .ST_AxPos ;var _bfdd ,_ebbf _dc .ST_TickMark ;var _feb ,_gfed *_dc .CT_ChartLines ;var _accc ,_bge _dc .ST_TickLblPos ;var _ffeb ,_aff *_ed .CT_ShapeProperties ;var _bbd error ;_bgb :=_fefb .Right -_fefb .Left ;
_dbf :=_fefb .Bottom -_fefb .Top ;if len (_fcc .ValAx )> 0{_efgd ,_ebb ,_ebbf ,_bge ,_gfed ,_ebff ,_aff ,_bbd =_agb (_fcc .ValAx [0]);};if _ebb !=_dc .ST_AxPosL &&_ebb !=_dc .ST_AxPosB {return _eg .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_ebd :=_cda -_edfg ;_bgf :=int (_ebd /_abec )+1;var _gfgf ,_dag float64 ;switch _ebbf {case _dc .ST_TickMarkIn :_gfgf ,_dag =_fde ,0;case _dc .ST_TickMarkOut :_gfgf ,_dag =0,_fde ;case _dc .ST_TickMarkCross :_gfgf ,_dag =_fde ,_fde ;};_gfgf =_gfgf *_dbd ;
_dag =_dag *_dbd ;var _bga *_ed .CT_ShapeProperties ;if _gfed !=nil {_bga =_gfed .SpPr ;};_afd ,_ddc :=_accc !=_dc .ST_TickLblPosNone ,_bge !=_dc .ST_TickLblPosNone ;_eded :=_edfg ;if len (_fcc .CatAx )> 0{_gcd ,_gfeg ,_bfdd ,_accc ,_feb ,_gfe ,_ffeb ,_bbd =_eccfb (_fcc .CatAx [0]);
}else if len (_fcc .DateAx )> 0{_gcd ,_gfeg ,_bfdd ,_accc ,_feb ,_gfe ,_ffeb ,_bbd =_gafa (_fcc .DateAx [0]);}else if len (_fcc .SerAx )> 0{_gcd ,_gfeg ,_bfdd ,_accc ,_feb ,_gfe ,_ffeb ,_bbd =_bage (_fcc .SerAx [0]);};if _bbd !=nil {return _bbd ;};if _gfeg !=_dc .ST_AxPosL &&_gfeg !=_dc .ST_AxPosB {return _eg .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _gcd !=_ebff ||_efgd !=_gfe {return _eg .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_dagg :=len (_cbeb )+1;var _ddcf ,_cca float64 ;switch _bfdd {case _dc .ST_TickMarkIn :_ddcf ,_cca =_fde ,0;
case _dc .ST_TickMarkOut :_ddcf ,_cca =0,_fde ;case _dc .ST_TickMarkCross :_ddcf ,_cca =_fde ,_fde ;};_ddcf =_ddcf *_dbd ;_cca =_cca *_dbd ;var _fac *_ed .CT_ShapeProperties ;if _feb !=nil {_fac =_feb .SpPr ;};if _bag {_ggaa :=_dbf /float64 (len (_cbeb ));
_bagd :=_fefb .Left -_edfg *_bgb /_ebd ;_gac :=_bagd -_fca *_dbd ;if _afd {var _gdg float64 ;for _fag :=0;_fag < _dagg ;_fag ++{_bfc :=_fefb .Bottom -float64 (_fag )*_ggaa ;if _fag < _dagg -1{_adcb :=_ecca .NewParagraph (_cbeb [_fag ]);_adcb .SetFontSize (_cff *_dbd );
_adcb .SetPos (_gac ,_bfc -_ggaa /2-_cffe *_dbd );_ecca .Draw (_adcb );_cgfb :=(_adcb .Width ()/1000-_fca )*_dbd ;if _cgfb > 0&&_cgfb > _gdg {_gdg =_cgfb ;};};};if _gdg > 0{_fefb .Left +=_gdg +_cac ;_bagd =_fefb .Left -_edfg *_bgb /_ebd ;_bgb =_fefb .Right -_fefb .Left ;
};};_fdce :=_bagd -_cca ;_acdc :=_bagd +_ddcf ;_geb :=_fefb .Left ;_age :=_fefb .Right ;for _adcf :=0;_adcf < _dagg ;_adcf ++{_begg :=_fefb .Bottom -float64 (_adcf )*_ggaa ;_faf .drawLineWithProps (_ffeb ,_fdce ,_begg ,_acdc ,_begg ,true );_faf .drawLineWithProps (_fac ,_geb ,_begg ,_age ,_begg ,true );
};_gbb :=_bgb /_ebd ;_fdgf :=_fefb .Bottom -_gfgf ;_eccf :=_fefb .Bottom +_dag ;_aedg :=_fefb .Top ;_dafg :=_fefb .Bottom ;for _egad :=0;_egad < _bgf ;_egad ++{_dbge :=_fefb .Left +(_eded -_edfg )*_gbb ;_faf .drawLineWithProps (_aff ,_dbge ,_fdgf ,_dbge ,_eccf ,true );
_faf .drawLineWithProps (_bga ,_dbge ,_aedg ,_dbge ,_dafg ,true );if _ddc {_edee :=_ecca .NewParagraph (_de .FormatFloat (_eded ,'g',-1,64));_edee .SetFontSize (_cff *_dbd );_edee .SetPos (_dbge -_ebfb *_dbd ,_dafg +_feaa *_dbd );_ecca .Draw (_edee );};
_eded +=_abec ;};}else {_dae :=_dbf /_ebd ;_gbge :=_fefb .Left ;if _ddc {var _dcf float64 ;for _ggag :=0;_ggag < _bgf ;_ggag ++{_dcg :=_fefb .Bottom -(_eded -_edfg )*_dae ;_dgaf :=_ecca .NewParagraph (_de .FormatFloat (_eded ,'g',-1,64));_dgaf .SetFontSize (_cff *_dbd );
_dgaf .SetPos (_gbge -_fca *_dbd ,_dcg -_cffe *_dbd );_ecca .Draw (_dgaf );_ebfff :=(_dgaf .Width ()/1000-_fca )*_dbd ;if _ebfff > 0&&_ebfff > _dcf {_dcf =_ebfff ;};_eded +=_abec ;};if _dcf > 0{_fefb .Left +=_dcf +_cac ;_bgb =_fefb .Right -_fefb .Left ;
};};_eded =_edfg ;_ddb :=_fefb .Left -_dag ;_ececd :=_fefb .Left +_gfgf ;_gbge =_fefb .Left ;_bfba :=_fefb .Right ;for _bgbe :=0;_bgbe < _bgf ;_bgbe ++{_gbbc :=_fefb .Bottom -(_eded -_edfg )*_dae ;_faf .drawLineWithProps (_aff ,_ddb ,_gbbc ,_ececd ,_gbbc ,true );
_faf .drawLineWithProps (_bga ,_gbge ,_gbbc ,_bfba ,_gbbc ,true );_eded +=_abec ;};_edef :=_bgb /float64 (len (_cbeb ));_gdac :=_fefb .Bottom +_edfg *_dbf /_ebd ;_acf :=_gdac -_ddcf ;_ccea :=_gdac +_cca ;_gbbe :=_fefb .Top ;_dbb :=_fefb .Bottom ;_ecb :=_gdac +_feaa *_dbd ;
for _gafd :=0;_gafd < _dagg ;_gafd ++{_cgb :=_fefb .Left +float64 (_gafd )*_edef ;_faf .drawLineWithProps (_ffeb ,_cgb ,_acf ,_cgb ,_ccea ,true );_faf .drawLineWithProps (_fac ,_cgb ,_gbbe ,_cgb ,_dbb ,true );if _afd &&_gafd < _dagg -1{_ebdc :=_ecca .NewParagraph (_cbeb [_gafd ]);
_ebdc .SetFontSize (_cff *_dbd );_ebdc .SetPos (_cgb +_gec *_dbd ,_ecb );_ecca .Draw (_ebdc );};};};return nil ;};var _beg =_gfedb (0.125);func MakeBlockFromChartSpace (cs *_dc .ChartSpace ,width ,height float64 ,theme *_ed .Theme )(*_cg .Block ,error ){_bdb ,_gfcf :=_cgf (cs ,width ,height ,theme ,false ,nil );
if _gfcf !=nil {return nil ,_gfcf ;};_acb ,_gfcf :=GetPageFromCreator (_bdb );if _gfcf !=nil {return nil ,_gfcf ;};_dac ,_gfcf :=_cg .NewBlockFromPage (_acb );if _gfcf !=nil {return nil ,_gfcf ;};return _dac ,nil ;};func GetDataFromXfrm (xfrm *_ed .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _gffeb ,_gba ,_baca ,_bcbe float64 ;
if _gca :=xfrm .Off ;_gca !=nil {_gffeb =_eb .FromEMU (FromSTCoordinate (_gca .XAttr ));_gba =_eb .FromEMU (FromSTCoordinate (_gca .YAttr ));};if _dggf :=xfrm .Ext ;_dggf !=nil {_baca =_eb .FromEMU (_dggf .CxAttr );_bcbe =_eb .FromEMU (_dggf .CyAttr );
};return _gffeb ,_gba ,_baca ,_bcbe ;};func _gbfc (_cdea uint8 ,_cdgc float64 )string {_fffg :=float64 (_cdea );var _ggc float64 ;if _cdgc < 0{_ggc =_fffg *(1+_cdgc );}else {_ggc =_fffg +(255-_fffg )*_cdgc ;};return _a .Sprintf ("\u0025\u0030\u0032\u0078",int (_ggc ));
};func GetOpacityFromColorTransform (trs []*_ed .EG_ColorTransform )float64 {for _ ,_eecb :=range trs {if _eecb !=nil {if _ecf :=_eecb .Alpha ;_ecf !=nil {if _efgg :=_ecf .ValAttr .ST_PositiveFixedPercentageDecimal ;_efgg !=nil {return float64 (*_efgg )/100000;
};};};};return 1.0;};func DrawRectangle (c *_cg .Creator ,r *Rectangle ,w float64 ,color _cg .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );
DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};func ClearRegisteredFonts (){_gacf ._fefc .Lock ();_gacf ._dagb =map[string ]map[FontStyle ]*_cbf .PdfFont {};_gacf ._fefc .Unlock ();};func (_cdgg *creatorContext )drawRectangleWithProps (_dgb *_ed .CT_ShapeProperties ,_acdcd ,_ggac ,_abeea ,_daab float64 ,_fga bool ){_gef :=_cdgg ._ffaa .NewRectangle (_acdcd ,_ggac ,_abeea ,_daab );
if _dgb ==nil {if _fga {_gef .SetBorderWidth (_beg );}else {return ;};}else {_gbed :=_cdgg .getPdfColorFromSolidFill (_dgb .SolidFill );if _gbed !=nil {_gef .SetFillColor (_gbed );};if _aggad :=_dgb .Ln ;_aggad !=nil {if _gafad :=_aggad .WAttr ;_gafad !=nil {_fdcac :=_eb .FromEMU (int64 (*_gafad ));
_gef .SetBorderWidth (_fdcac );if _cbfa :=_aggad .SolidFill ;_cbfa !=nil {_acff :=_cdgg .getPdfColorFromSolidFill (_cbfa );if _acff !=nil {_gef .SetBorderColor (_acff );};};}else {_gef .SetBorderWidth (0);};};};_cdgg ._ffaa .Draw (_gef );};func ParseExcelRange (s string )(string ,_dg .CellReference ,_dg .CellReference ,error ){_geg :=_ege .FieldsFunc (s ,func (_dfa rune )bool {return _dfa ==':'||_dfa =='!'});
if len (_geg )==3{_faaa ,_bcbed :=_dg .ParseCellReference (_geg [1]);if _bcbed !=nil {return "",_dg .CellReference {},_dg .CellReference {},_bcbed ;};_feag ,_bcbed :=_dg .ParseCellReference (_geg [2]);if _bcbed !=nil {return "",_dg .CellReference {},_dg .CellReference {},_bcbed ;
};return _geg [0],_faaa ,_feag ,nil ;};return "",_dg .CellReference {},_dg .CellReference {},_eg .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");};func _eefe (_beac *_da .Document ,_aegf ,_adgd ,_egcb string )error {_edg ,_gfcg :=_beac .GetFontBytesByRelId (_adgd );
if _gfcg !=nil {return _gfcg ;};_egag ,_gfcg :=_baaa (_egcb );if _gfcg !=nil {return _gfcg ;};for _ffdf :=0;_ffdf < 32;_ffdf ++{_gdda :=_ffdf %len (_egag );_edg [_ffdf ]=_edg [_ffdf ]^_egag [_gdda ];};_bfg :=_beac .TmpPath +"\u002f"+_aegf +"\u002e\u0074\u0074\u0066";
_gfcg =_e .WriteFile (_bfg ,_edg ,0644);if _gfcg !=nil {return _gfcg ;};_gad (_bfg );return nil ;};