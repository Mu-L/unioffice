//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_a "bytes";_ga "errors";_bf "fmt";_af "github.com/unidoc/unichart";_db "github.com/unidoc/unichart/dataset";_fb "github.com/unidoc/unichart/render";_dfc "github.com/unidoc/unioffice/v2/common/logger";_bg "github.com/unidoc/unioffice/v2/document";
_dc "github.com/unidoc/unioffice/v2/measurement";_gf "github.com/unidoc/unioffice/v2/schema/soo/dml";_f "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_gbb "github.com/unidoc/unioffice/v2/spreadsheet";_fd "github.com/unidoc/unioffice/v2/spreadsheet/format";
_efb "github.com/unidoc/unioffice/v2/spreadsheet/formula";_df "github.com/unidoc/unioffice/v2/spreadsheet/reference";_d "github.com/unidoc/unipdf/v4/core";_gbc "github.com/unidoc/unipdf/v4/creator";_ea "github.com/unidoc/unipdf/v4/model";_bag "github.com/unidoc/unipdf/v4/render";
_ef "github.com/unidoc/unitype";_cg "image";_g "image/color";_gb "math";_gc "os";_ba "regexp";_ed "sort";_ac "strconv";_gca "strings";_c "sync";_b "unicode";);func (_gac *creatorContext )drawBarChart (_ec *_f .CT_BarChart ,_ad *Rectangle ,_cb []*_f .CT_PlotAreaChoice1 ,_beb *_gbb .Workbook )([]*legendItem ,error ){var _gfa bool ;
if _fe :=_ec .BarDir ;_fe !=nil {_gfa =_fe .ValAttr ==_f .ST_BarDirBar ;};_bea :=_ec .Ser ;_ed .Sort (barSerByOrder (_bea ));_ee :=map[string ]serCategory {};_bdf :=[]string {};_cee :=[]*legendItem {};_gdc :=_gb .Inf (1);_bad :=_gb .Inf (-1);for _ ,_fad :=range _bea {var _ag string ;
if _gaf :=_fad .Tx ;_gaf !=nil {if _cgd :=_gaf .SerTxChoice ;_cgd !=nil {if _cgd .V !=nil {_ag =*_cgd .V ;}else if _fbe :=_cgd .StrRef ;_fbe !=nil {if _adb :=_fbe .StrCache ;_adb !=nil {for _ ,_cbc :=range _adb .Pt {_ag =_cbc .V ;};};};};};if _cfa :=_fad .Cat ;
_cfa !=nil {if _ebd :=_cfa .AxDataSourceChoice ;_ebd !=nil {if _gfg :=_ebd .StrRef ;_gfg !=nil {if _cdab :=_gfg .F ;_cdab !=""&&_beb !=nil {_gg ,_dgg ,_bgb ,_beg :=ParseExcelRange (_cdab );if _beg ==nil {for _ ,_gbe :=range _beb .Sheets (){if _gbe .Name ()==_gca .Trim (_gg ,"\u0027"){_dd :=_dgg .String ();
for _de :=_dgg .RowIdx ;_de <=_bgb .RowIdx ;_de +=1{_aga :=_gca .ReplaceAll (_dd ,_bf .Sprint (_dgg .RowIdx ),_bf .Sprint (_de ));_gac .addCatName (_gbe .Cell (_aga ).GetString (),_ee ,&_bdf );};break ;};};};};if _bbf :=_gfg .StrCache ;_bbf !=nil {for _ ,_adfg :=range _bbf .Pt {_gac .addCatName (_adfg .V ,_ee ,&_bdf );
};};}else if _bdd :=_ebd .NumRef ;_bdd !=nil {if _bega :=_bdd .NumCache ;_bega !=nil {var _ffd string ;if _bega .FormatCode !=nil {_ffd =*_bega .FormatCode ;};for _ ,_ebdb :=range _bega .Pt {var _ggf string ;if _ebdb .FormatCodeAttr ==nil {_ggf =_ffd ;
}else {_ggf =*_ebdb .FormatCodeAttr ;};var _gdb string ;_cgbc ,_dge :=_ac .ParseFloat (_ebdb .V ,64);if _dge !=nil {_gdb =_ebdb .V ;}else {_gdb =_fd .Number (_cgbc ,_ggf );};_gac .addCatName (_gdb ,_ee ,&_bdf );};};};};};if _dbfg :=_fad .Val ;_dbfg !=nil {if _ffc :=_dbfg .NumDataSourceChoice ;
_ffc !=nil {if _dbd :=_ffc .NumRef ;_dbd !=nil {if _bfa :=_dbd .F ;_bfa !=""&&_beb !=nil {_bbcgb ,_dbdc ,_gbf ,_ceb :=ParseExcelRange (_bfa );if _ceb ==nil {for _ ,_cdf :=range _beb .Sheets (){if _cdf .Name ()==_gca .Trim (_bbcgb ,"\u0027"){_agc :=_dbdc .String ();
for _bbe :=_dbdc .RowIdx ;_bbe <=_gbf .RowIdx ;_bbe +=1{_gbeb :=_gca .ReplaceAll (_agc ,_bf .Sprint (_dbdc .RowIdx ),_bf .Sprint (_bbe ));if _cdf .FormulaContext ().HasFormula (_gbeb ){_dfg :=_efb .NewEvaluator ();_gbef :=_cdf .FormulaContext ().Cell (_gbeb ,_dfg );
_ae :=_gbef .Value ();_gac .addCatValue (_ae ,_ee ,_bdf ,(int )(_bbe -_dbdc .RowIdx ),&_gdc ,&_bad ,_ag ,_fad .SpPr );}else {_gfgb :=_cdf .Cell (_gbeb ).GetString ();_gac .addCatValue (_gfgb ,_ee ,_bdf ,(int )(_bbe -_dbdc .RowIdx ),&_gdc ,&_bad ,_ag ,_fad .SpPr );
};};break ;};};};};if _fgf :=_dbd .NumCache ;_fgf !=nil {for _efc ,_gcgg :=range _fgf .Pt {_gac .addCatValue (_gcgg .V ,_ee ,_bdf ,_efc ,&_gdc ,&_bad ,_ag ,_fad .SpPr );};};};};};_cee =append (_cee ,&legendItem {_eefb :_ag ,_cecd :_fad .SpPr });};var _bfc float64 ;
var _ca ,_acc float64 ;if _bad ==0&&_gdc ==0{_bfc =0.2;_acc =0;_ca =1;}else {var _bff float64 ;if _bac :=_gb .Abs (_gdc );_bad < _bac {_bff =_bac ;}else {_bff =_bad ;};_ceg :=_gb .Pow (10,_gb .Floor (_gb .Log10 (_bff )));_bc :=_bff /_ceg ;if _bc < 4.29{_bfc =0.5;
}else if _bc >=4.29&&_bc < 8.58{_bfc =1;}else {_bfc =2;};_bfc *=_ceg ;if _bad <=0{_ca =0;}else {_ca =(_gb .Ceil (_bad /_bfc )+1)*_bfc ;};if _gdc >=0{_acc =0;}else {_acc =(_gb .Floor (_gdc /_bfc )-1)*_bfc ;};};_fbec :=_gac .drawAxes (_cb ,_acc ,_ca ,_bfc ,_bdf ,_ad ,_gfa );
if _fbec !=nil {return nil ,_fbec ;};_eec :=0.0;if _ec .GapWidth !=nil {if _gad :=_ec .GapWidth .ValAttr ;_gad !=nil {if _gdd :=_gad .ST_GapAmountUShort ;_gdd !=nil {_eec =float64 (*_gdd )/100.0;};};};_gge :=_ad .Right -_ad .Left ;_fae :=_ad .Bottom -_ad .Top ;
_gcgga :=float64 (len (_bdf ));if _gfa {_begf :=_ca /(_ca -_acc )*_gge ;_cbf :=-_acc /(_ca -_acc )*_gge ;_aaf :=_ad .Left +_cbf ;_adc :=_fae /_gcgga ;for _fgb ,_dcd :=range _bdf {_efcb :=_ee [_dcd ];_ebb :=float64 (len (_efcb ._bcf ))+_eec ;_cege :=_adc /_ebb ;
_fcf :=_cege *_eec ;_eef :=_ad .Bottom -float64 (_fgb )*_adc -_fcf /2-_cege ;for _ ,_ecc :=range _efcb ._bcf {if _ecc ._cef ==0{continue ;};var _agg ,_ggfe float64 ;if _ecc ._cef > 0{_ggfe =_ecc ._cef /_ca *_begf ;_gac .drawRectangleWithProps (_ecc ._cae ,_aaf ,_eef ,_ggfe ,_cege ,false );
}else {_ggfe =_ecc ._cef /_acc *_cbf ;_agg =_aaf -_ggfe ;_gac .drawRectangleWithProps (_ecc ._cae ,_agg ,_eef ,_ggfe ,_cege ,false );};_eef -=_cege ;};};}else {_ece :=_ca /(_ca -_acc )*_fae ;_cc :=-_acc /(_ca -_acc )*_fae ;_abd :=_ad .Top +_ece ;_fde :=_gge /_gcgga ;
for _gcfc ,_aae :=range _bdf {_eeb :=_ee [_aae ];_acf :=float64 (len (_eeb ._bcf ))+_eec ;_gba :=_fde /_acf ;_gfaf :=_gba *_eec ;_ace :=_ad .Left +float64 (_gcfc )*_fde +_gfaf /2;for _ ,_egea :=range _eeb ._bcf {var _aff ,_cge float64 ;if _egea ._cef > 0{_cge =_egea ._cef /_ca *_ece ;
_aff =_abd -_cge ;_gac .drawRectangleWithProps (_egea ._cae ,_ace ,_aff ,_gba ,_cge ,false );}else {_cge =_egea ._cef /_acc *_cc ;_gac .drawRectangleWithProps (_egea ._cae ,_ace ,_abd ,_gba ,_cge ,false );};_ace +=_gba ;};};};return _cee ,nil ;};func _eea (_bfb *_f .CT_CatAx )(uint32 ,_f .ST_AxPos ,_f .ST_TickMark ,_f .ST_TickLblPos ,*_f .CT_ChartLines ,uint32 ,*_gf .CT_ShapeProperties ,error ){var _adec ,_eac uint32 ;
var _ffbe _f .ST_AxPos ;var _acfa _f .ST_TickMark ;var _gcca *_f .CT_ChartLines ;var _fdd _f .ST_TickLblPos ;if _bfb .AxId ==nil {return _adec ,_ffbe ,_acfa ,_fdd ,_gcca ,_eac ,_bfb .SpPr ,_ga .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_adec =_bfb .AxId .ValAttr ;};if _bfb .AxPos ==nil {return _adec ,_ffbe ,_acfa ,_fdd ,_gcca ,_eac ,_bfb .SpPr ,_ga .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ffbe =_bfb .AxPos .ValAttr ;
};if _bfb .MajorTickMark !=nil {_acfa =_bfb .MajorTickMark .ValAttr ;};if _bfb .TickLblPos !=nil {_fdd =_bfb .TickLblPos .ValAttr ;};if _bfb .CrossAx ==nil {return _adec ,_ffbe ,_acfa ,_fdd ,_gcca ,_eac ,_bfb .SpPr ,_ga .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_eac =_bfb .CrossAx .ValAttr ;};_gcca =_bfb .MajorGridlines ;return _adec ,_ffbe ,_acfa ,_fdd ,_gcca ,_eac ,_bfb .SpPr ,nil ;};func (_fbdb *creatorContext )drawPieChart (_aed *_f .CT_PieChart ,_cfcab *Rectangle ,_ggcf *_gbb .Workbook ,_cgg float64 )([]*legendItem ,error ){_adfe :=[]*legendItem {};
_efgb :=map[string ]serCategory {};_bgeg :=[]string {};_geg :=_gb .Inf (1);_gcff :=_gb .Inf (-1);_bbd :=_aed .Ser ;for _ ,_cfd :=range _bbd {var _adcf string ;if _fcad :=_cfd .Tx ;_fcad !=nil {if _dbbae :=_fcad .SerTxChoice ;_dbbae !=nil {if _dbbae .V !=nil {_adcf =*_dbbae .V ;
}else if _fcdf :=_dbbae .StrRef ;_fcdf !=nil {if _ceff :=_fcdf .StrCache ;_ceff !=nil {for _ ,_begae :=range _ceff .Pt {_adcf =_begae .V ;};};};};};if _caae :=_cfd .Cat ;_caae !=nil {if _dgedb :=_caae .AxDataSourceChoice ;_dgedb !=nil {if _cad :=_dgedb .StrRef ;
_cad !=nil {if _edda :=_cad .F ;_edda !=""&&_ggcf !=nil {_aage ,_bcbg ,_aef ,_gdga :=ParseExcelRange (_edda );if _gdga ==nil {for _ ,_fadg :=range _ggcf .Sheets (){if _fadg .Name ()==_gca .Trim (_aage ,"\u0027"){_fdgd :=_bcbg .String ();for _dcfg :=_bcbg .RowIdx ;
_dcfg <=_aef .RowIdx ;_dcfg +=1{_gbcg :=_gca .ReplaceAll (_fdgd ,_bf .Sprint (_bcbg .RowIdx ),_bf .Sprint (_dcfg ));_fbdb .addCatName (_fadg .Cell (_gbcg ).GetString (),_efgb ,&_bgeg );};break ;};};};};if _ggbg :=_cad .StrCache ;_ggbg !=nil {for _ ,_abcd :=range _ggbg .Pt {_fbdb .addCatName (_abcd .V ,_efgb ,&_bgeg );
};};}else if _ddba :=_dgedb .NumRef ;_ddba !=nil {if _dgfg :=_ddba .NumCache ;_dgfg !=nil {var _gage string ;if _dgfg .FormatCode !=nil {_gage =*_dgfg .FormatCode ;};for _ ,_eege :=range _dgfg .Pt {var _agde string ;if _eege .FormatCodeAttr ==nil {_agde =_gage ;
}else {_agde =*_eege .FormatCodeAttr ;};var _cfag string ;_fgag ,_gfaa :=_ac .ParseFloat (_eege .V ,64);if _gfaa !=nil {_cfag =_eege .V ;}else {_cfag =_fd .Number (_fgag ,_agde );};_fbdb .addCatName (_cfag ,_efgb ,&_bgeg );};};};};};if _gbbd :=_cfd .Val ;
_gbbd !=nil {if _gfafe :=_gbbd .NumDataSourceChoice ;_gfafe !=nil {if _daf :=_gfafe .NumRef ;_daf !=nil {if _bggd :=_daf .F ;_bggd !=""&&_ggcf !=nil {_fddg ,_cagc ,_dega ,_efce :=ParseExcelRange (_bggd );if _efce ==nil {for _ ,_bdge :=range _ggcf .Sheets (){if _bdge .Name ()==_gca .Trim (_fddg ,"\u0027"){_aabe :=_cagc .String ();
for _gbag :=_cagc .RowIdx ;_gbag <=_dega .RowIdx ;_gbag +=1{_aabf :=_gca .ReplaceAll (_aabe ,_bf .Sprint (_cagc .RowIdx ),_bf .Sprint (_gbag ));if _bdge .FormulaContext ().HasFormula (_aabf ){_bgbfd :=_efb .NewEvaluator ();_aadb :=_bdge .FormulaContext ().Cell (_aabf ,_bgbfd );
_cfdb :=_aadb .Value ();_fbdb .addCatValue (_cfdb ,_efgb ,_bgeg ,(int )(_gbag -_cagc .RowIdx ),&_geg ,&_gcff ,_adcf ,_cfd .SpPr );}else {_efd :=_bdge .Cell (_aabf ).GetString ();_fbdb .addCatValue (_efd ,_efgb ,_bgeg ,(int )(_gbag -_cagc .RowIdx ),&_geg ,&_gcff ,_adcf ,_cfd .SpPr );
};};break ;};};};};if _ggfd :=_daf .NumCache ;_ggfd !=nil {for _dfd ,_affg :=range _ggfd .Pt {_fbdb .addCatValue (_affg .V ,_efgb ,_bgeg ,_dfd ,&_geg ,&_gcff ,_adcf ,_cfd .SpPr );};};};};};};_fgad :=&_af .PieChart {Values :[]_db .Value {}};for _ ,_bebb :=range _bgeg {_gdea :=_efgb [_bebb ];
if len (_gdea ._bcf )> 0{_fgad .Values =append (_fgad .Values ,_db .Value {Value :_gdea ._bcf [0]._cef ,Label :_bebb ,Style :_fb .Style {FontSize :12*_cgg }});};};_fgad .SetHeight (int (_cfcab .Top -_cfcab .Bottom ));_fgad .SetWidth (int (_cfcab .Right -_cfcab .Left ));
_bga :=_fbdb ._fdad ;_gadb :=_gbc .NewChart (_fgad );_gadb .SetPos (_cfcab .Left ,_cfcab .Top );_gbdb :=_bga .Draw (_gadb );if _gbdb !=nil {return nil ,_gbdb ;};return _adfe ,nil ;};func _gfb (_eefg float64 )float64 {if _eefg < 0{_eefg +=float64 (-int (_eefg )+1);
}else if _eefg > 1{_eefg -=float64 (int (_eefg ));};return _eefg ;};var _cfc =_geb (1.5);func FromSTCoordinate (st _gf .ST_Coordinate )int64 {if _fbee :=st .ST_CoordinateUnqualified ;_fbee !=nil {return *_fbee ;};return 0;};func RegisterEmbeddedFonts (d *_bg .Document )error {_acd :=d .FontTable ();
if _acd ==nil {return nil ;};for _ ,_becg :=range _acd .Font {if _becg .EmbedRegular !=nil {return _cba (d ,_becg .NameAttr ,_becg .EmbedRegular .IdAttr ,_becg .EmbedRegular .FontKeyAttr );};if _becg .EmbedBold !=nil {return _cba (d ,_becg .NameAttr ,_becg .EmbedBold .IdAttr ,_becg .EmbedBold .FontKeyAttr );
};if _becg .EmbedItalic !=nil {return _cba (d ,_becg .NameAttr ,_becg .EmbedItalic .IdAttr ,_becg .EmbedItalic .FontKeyAttr );};if _becg .EmbedBoldItalic !=nil {return _cba (d ,_becg .NameAttr ,_becg .EmbedBoldItalic .IdAttr ,_becg .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};func RegisterFont (name string ,style FontStyle ,font *_ea .PdfFont ){_beac ._bdc .Lock ();if _beac ._cefe [name ]==nil {_beac ._cefe [name ]=map[FontStyle ]*_ea .PdfFont {};};_beac ._cefe [name ][style ]=font ;_beac ._bdc .Unlock ();
};func DrawRectangle (c *_gbc .Creator ,r *Rectangle ,w float64 ,color _gbc .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );
DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};func AdjustColor (colorStr string ,EG_ColorTransform []*_gf .EG_ColorTransform )string {for _ ,_acae :=range EG_ColorTransform {if _baddg :=_acae .ColorTransformChoice .Tint ;_baddg !=nil {if _agfg :=_baddg .ValAttr .ST_PositiveFixedPercentageDecimal ;
_agfg !=nil {colorStr =AdjustColorByTint (colorStr ,1.0-float64 (*_agfg )/Percent100 );};};if _ggaa :=_acae .ColorTransformChoice .Shade ;_ggaa !=nil {if _cdb :=_ggaa .ValAttr .ST_PositiveFixedPercentageDecimal ;_cdb !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_cdb )/Percent100 );
};};if _gcfg :=_acae .ColorTransformChoice .LumMod ;_gcfg !=nil {if _ddd :=_gcfg .ValAttr .ST_PercentageDecimal ;_ddd !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_ddd )/Percent100 );};};if _ebbf :=_acae .ColorTransformChoice .LumOff ;_ebbf !=nil {if _bae :=_ebbf .ValAttr .ST_PercentageDecimal ;
_bae !=nil {colorStr =AdjustColorByLumOff (colorStr ,float64 (*_bae )/Percent100 );};};};return colorStr ;};func LoadFontFromFile (filename string )(*_ea .PdfFont ,error ){if !_gca .HasSuffix (filename ,"\u002e\u0074\u0074\u0066"){_dfc .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return nil ,_bf .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_edcg ,_fce :=_ea .NewCompositePdfFontFromTTFFile (filename );if _fce !=nil {return nil ,_fce ;};return _edcg ,nil ;};func (_edc *creatorContext )drawLegend (_bdfg *Rectangle ,_gag []*legendItem ,_egae bool ){_ead :=_edc ._dgbb ;_gcad :=_geb (2.5)*_ead ;
_bcbb :=_add *_ead ;_gbg :=(_gcad -_bcbb )/2;_fgfa :=float64 (len (_gag ));if _egae {_agb :=&Rectangle {Top :_bdfg .Top +_geb (1)*_ead ,Bottom :_bdfg .Bottom -_geb (1)*_ead ,Left :_bdfg .Left +_geb (2.5)*_ead ,Right :_bdfg .Right -_geb (2.5)*_ead };var _gacf float64 ;
if _fgfa > 1{_gacf =(_agb .Right -_agb .Left )/_fgfa ;};_ge :=_agb .Left ;_fga :=_agb .Top ;for _ ,_bfae :=range _gag {if _fdef :=_bfae ._cecd ;_fdef !=nil {_edc .drawRectangleWithProps (_fdef ,_ge ,_fga +_gbg ,_bcbb ,_bcbb ,false );_cgc :=_ge +_bcbb *2;
_ecbb :=_edc ._fdad .NewStyledParagraph ();_ecbb .SetPos (_cgc ,_fga );_edg :=_ecbb .Append (_bfae ._eefb );_facd ,_bbcd :=_ea .NewStandard14Font (_ea .HelveticaName );if _bbcd ==nil {_eaf :=_edc ._fdad .NewTextStyle ();_eaf .Font =_facd ;_eaf .FontSize =_gcad ;
_eaf .TextRise =0.4;_edg .Style =_eaf ;_edc ._fdad .Draw (_ecbb );};};_ge +=_gacf ;};}else {_bdg :=&Rectangle {Top :_bdfg .Top +_geb (2.5)*_ead ,Bottom :_bdfg .Bottom -_geb (2.5)*_ead ,Left :_bdfg .Left +_geb (2.5)*_ead ,Right :_bdfg .Right -_geb (2.5)*_ead };
var _cfe float64 ;if _fgfa > 1{_cfe =(_bdg .Bottom -_bdg .Top -_gcad )/(_fgfa -1);if _cfe < _gcad {_cfe =_gcad ;};};_fbc :=_bdg .Top ;_cbd :=_bdg .Left ;_cfg :=_cbd +_bcbb *2;for _ ,_gfafd :=range _gag {if _def :=_gfafd ._cecd ;_def !=nil {_edc .drawRectangleWithProps (_def ,_cbd ,_fbc +_gbg ,_bcbb ,_bcbb ,false );
_dcc :=_edc ._fdad .NewStyledParagraph ();_dcc .SetPos (_cfg ,_fbc );_dcc .SetWidth (_bdg .Right -_bdg .Left );_cgf :=_dcc .Append (_gfafd ._eefb );_gbad ,_dcg :=_ea .NewStandard14Font (_ea .HelveticaName );if _dcg ==nil {_gdf :=_edc ._fdad .NewTextStyle ();
_gdf .Font =_gbad ;_gdf .FontSize =_gcad ;_gdf .TextRise =0.4;_cgf .Style =_gdf ;_edc ._fdad .Draw (_dcc );};};_fbc +=_cfe ;};};};var _badd =_geb (0.125);const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;
BorderPositionRight BorderPosition =3;);func _befb (_gbab _gf .ST_SchemeColorVal ,_afcc *_gf .Theme )string {if _bcbd :=_afcc .ThemeElements ;_bcbd !=nil {if _egeb :=_bcbd .ClrScheme ;_egeb !=nil {switch _gbab {case _gf .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_egeb .Lt1 );
case _gf .ST_SchemeColorValDk1 ,_gf .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_egeb .Dk1 );case _gf .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_egeb .Lt2 );case _gf .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_egeb .Dk2 );
case _gf .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_egeb .Accent1 );case _gf .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_egeb .Accent2 );case _gf .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_egeb .Accent3 );
case _gf .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_egeb .Accent4 );case _gf .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_egeb .Accent5 );case _gf .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_egeb .Accent6 );
};};};return "";};func _cba (_gedc *_bg .Document ,_effb ,_agbg ,_gagg string )error {_bdgd ,_dda :=_gedc .GetFontBytesByRelId (_agbg );if _dda !=nil {return _dda ;};_ebgg ,_dda :=_ggbe (_gagg );if _dda !=nil {return _dda ;};for _efcd :=0;_efcd < 32;_efcd ++{_feca :=_efcd %len (_ebgg );
_bdgd [_efcd ]=_bdgd [_efcd ]^_ebgg [_feca ];};_dbab :=_gedc .TmpPath +"\u002f"+_effb +"\u002e\u0074\u0074\u0066";_dda =_gc .WriteFile (_dbab ,_bdgd ,0644);if _dda !=nil {return _dda ;};_eccc (_dbab );return nil ;};func _cbcg (_bcd uint8 ,_ccdc float64 )string {_effa :=float64 (_bcd );
var _eabc float64 ;if _ccdc < 0{_eabc =_effa *(1+_ccdc );}else {_eabc =_effa +(255-_effa )*_ccdc ;};return _bf .Sprintf ("\u0025\u0030\u0032\u0078",int (_eabc ));};func IsNoSpaceLanguage (symbol string )bool {for _ ,_cfca :=range symbol {if _b .Is (_b .Han ,_cfca ){return true ;
};};return false ;};func (_cceg *creatorContext )drawScatterChart (_cded *_f .CT_ScatterChart ,_gaea *Rectangle ,_gcgf []*_f .CT_PlotAreaChoice1 ,_ecec float64 )([]*legendItem ,error ){_bgeb :=[]*legendItem {};_edbg :=_cded .Ser ;_gggg :=make (map[string ]float64 );
_ggcg :=make (map[string ][]float64 );_eecb :=make (map[string ][]float64 );_fccg :=[]string {};for _ ,_daae :=range _edbg {var _ffge string ;if _adad :=_daae .Tx ;_adad !=nil {if _debe :=_adad .SerTxChoice ;_debe !=nil {if _debe .V !=nil {_ffge =*_debe .V ;
}else if _bebca :=_debe .StrRef ;_bebca !=nil {if _cdd :=_bebca .StrCache ;_cdd !=nil {for _ ,_abgg :=range _cdd .Pt {_ffge =_abgg .V ;};};};_fccg =append (_fccg ,_ffge );};};if _daae .Marker !=nil &&_daae .Marker .Size !=nil {_gggg [_ffge ]=float64 (*_daae .Marker .Size .ValAttr );
}else {_gggg [_ffge ]=-1.0;};if _aedd :=_daae .XVal ;_aedd !=nil {if _edga :=_aedd .AxDataSourceChoice ;_edga !=nil {if _aabec :=_edga .NumRef ;_aabec !=nil {if _dccf :=_aabec .NumCache ;_dccf !=nil {for _ ,_aagg :=range _dccf .Pt {_fcbb ,_ :=_ac .ParseFloat (_gca .TrimSpace (_aagg .V ),64);
_ggcg [_ffge ]=append (_ggcg [_ffge ],_fcbb );};};};};};if _ccgf :=_daae .YVal ;_ccgf !=nil {if _ccc :=_ccgf .NumDataSourceChoice ;_ccc !=nil {if _gddg :=_ccc .NumRef ;_gddg !=nil {if _babg :=_gddg .NumCache ;_babg !=nil {for _ ,_adcca :=range _babg .Pt {_fab ,_ :=_ac .ParseFloat (_gca .TrimSpace (_adcca .V ),64);
_eecb [_ffge ]=append (_eecb [_ffge ],_fab );};};};};};};_eag :=true ;_bace :="";_cdcb :="";if len (_gcgf )> 1{if _gcgf [0].ValAx .Delete !=nil &&_gcgf [1].ValAx .Delete !=nil {if !*(*_gcgf [0].ValAx .Delete ).ValAttr &&!*(*_gcgf [1].ValAx .Delete ).ValAttr {_eag =false ;
};};_bace =_cceg .getTitle (_gcgf [0].ValAx .Title );_cdcb =_cceg .getTitle (_gcgf [1].ValAx .Title );};_gafa :=_fb .Style {Hidden :_eag ,FontSize :8*_ecec };_fedc :=&_af .Chart {Series :[]_db .Series {},YAxisSecondary :_af .YAxis {Style :_gafa ,Name :_cdcb ,NameStyle :_gafa },XAxis :_af .XAxis {Style :_gafa ,Name :_bace ,NameStyle :_gafa },YAxis :_af .YAxis {Style :_fb .Style {Hidden :true }}};
for _ ,_bcg :=range _fccg {_cbe :=_db .ContinuousSeries {XValues :_ggcg [_bcg ],YValues :_eecb [_bcg ],Style :_fb .Style {StrokeWidth :-1,DotWidth :_gggg [_bcg ]}};_fedc .Series =append (_fedc .Series ,_cbe );};_fedc .SetHeight (int (_gb .Abs (_gaea .Top -_gaea .Bottom )));
_fedc .SetWidth (int (_gb .Abs (_gaea .Right -_gaea .Left )));_bbab :=_cceg ._fdad ;_dbef :=_gbc .NewChart (_fedc );_dbef .SetPos (_gaea .Left ,_gaea .Top );_ccegd :=_bbab .Draw (_dbef );if _ccegd !=nil {return nil ,_ccegd ;};return _bgeb ,nil ;};func _ggbe (_acef string )([]byte ,error ){_ccdd :=_ba .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");
_acef =_ccdd .ReplaceAllString (_acef ,"");_abdg :=[]rune (_acef );_gaaa :=[]byte {};for _febb :=len (_abdg )-2;_febb >=0;_febb -=2{_gfge ,_agfb :=_ac .ParseUint (string (_abdg [_febb ])+string (_abdg [_febb +1]),16,8);if _agfb !=nil {return nil ,_agfb ;
};_gaaa =append (_gaaa ,byte (_gfge ));};return _gaaa ,nil ;};func (_dggd *creatorContext )getTitle (_bgfd *_f .CT_Title )string {_dag :="";if _bgfd !=nil &&_bgfd .Tx !=nil &&_bgfd .Tx .TxChoice !=nil &&_bgfd .Tx .TxChoice .Rich !=nil {if len (_bgfd .Tx .TxChoice .Rich .P )> 0{for _ ,_cbcc :=range _bgfd .Tx .TxChoice .Rich .P {if len (_cbcc .EG_TextRun )> 0{_dag +="\u000a"+_cbcc .EG_TextRun [0].TextRunChoice .R .T ;
};};};};return _dag ;};func GetDataFromXfrm (xfrm *_gf .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _aecf ,_fcfc ,_deff ,_eafe float64 ;if _eeeg :=xfrm .Off ;_eeeg !=nil {_aecf =_dc .FromEMU (FromSTCoordinate (_eeeg .XAttr ));_fcfc =_dc .FromEMU (FromSTCoordinate (_eeeg .YAttr ));
};if _feff :=xfrm .Ext ;_feff !=nil {_deff =_dc .FromEMU (_feff .CxAttr );_eafe =_dc .FromEMU (_feff .CyAttr );};return _aecf ,_fcfc ,_deff ,_eafe ;};func GetOpacityFromColorTransform (trs []*_gf .EG_ColorTransform )float64 {for _ ,_ebe :=range trs {if _ebe !=nil {if _aeae :=_ebe .ColorTransformChoice .Alpha ;
_aeae !=nil {if _bgc :=_aeae .ValAttr .ST_PositiveFixedPercentageDecimal ;_bgc !=nil {return float64 (*_bgc )/Percent100 ;};};};};return 1.0;};func _cce (_eee ,_bfba ,_aaac uint8 )(float64 ,float64 ,float64 ){_ddb ,_begd ,_fbfe :=float64 (_eee )/255,float64 (_bfba )/255,float64 (_aaac )/255;
_cff :=_ddb ;if _begd < _cff {_cff =_begd ;};if _fbfe < _cff {_cff =_fbfe ;};var _egfc ,_gab bool ;_gadf :=_ddb ;if _begd > _gadf {_gadf =_begd ;_egfc =true ;};if _fbfe > _gadf {_gadf =_fbfe ;_egfc =false ;_gab =true ;};_eabf :=(_cff +_gadf )/2;var _gbfc float64 ;
if _cff !=_gadf {if _eabf <=0.5{_gbfc =(_gadf -_cff )/(_gadf +_cff );}else {_gbfc =(_gadf -_cff )/(2.0-_gadf -_cff );};};var _ffda float64 ;if _cff !=_gadf {if _egfc {_ffda =2.0+(_fbfe -_ddb )/(_gadf -_cff );}else if _gab {_ffda =4.0+(_ddb -_begd )/(_gadf -_cff );
}else {_ffda =(_begd -_fbfe )/(_gadf -_cff );};_ffda *=60;if _ffda < 0{_ffda +=360;};};return _ffda ,_gbfc ,_eabf ;};func GetImage (c *_gbc .Creator ,goImg _cg .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_gbc .Image ,error ){if goImg ==nil {return nil ,nil ;
};_ffeg :=goImg .Bounds ().Size ();_eggc :=_ffeg .X ;_effbf :=_ffeg .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_eggc );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_effbf );};var _bcgb _cg .Rectangle ;switch part {case ImgPart_t :_bcgb =_cg .Rect (0,0,_eggc ,int (dividerY ));
case ImgPart_b :_bcgb =_cg .Rect (0,int (dividerY ),_eggc ,_effbf );case ImgPart_l :_bcgb =_cg .Rect (0,0,int (dividerX ),_effbf );case ImgPart_r :_bcgb =_cg .Rect (int (dividerX ),0,_eggc ,_effbf );case ImgPart_lt :_bcgb =_cg .Rect (0,0,int (dividerX ),int (dividerY ));
case ImgPart_rt :_bcgb =_cg .Rect (int (dividerX ),0,_eggc ,int (dividerY ));case ImgPart_lb :_bcgb =_cg .Rect (0,int (dividerY ),int (dividerX ),_effbf );case ImgPart_rb :_bcgb =_cg .Rect (int (dividerX ),int (dividerY ),_eggc ,_effbf );default:_bcgb =_cg .Rect (0,0,_eggc ,_effbf );
};_beee :=CropImageByRect (goImg ,_bcgb );_gec ,_deec :=c .NewImageFromGoImage (_beee );if _deec !=nil {return nil ,_deec ;};_gec .Scale (imgWidth /float64 (_eggc ),imgHeight /float64 (_effbf ));_gec .SetPos (left ,top );return _gec ,nil ;};func FromSTCoordinate32 (st _gf .ST_Coordinate32 )int64 {if _ggdf :=st .ST_Coordinate32Unqualified ;
_ggdf !=nil {return int64 (*_ggdf );};return 0;};var (DefaultFontSize =12.0;DefaultImageEncoder _d .StreamEncoder ;DefaultPageSize =PageSizeA4 ;_bcc =map[PageSize ]_gbc .PageSize {PageSizeA3 :_gbc .PageSizeA3 ,PageSizeA4 :_gbc .PageSizeA4 ,PageSizeA5 :_gbc .PageSizeA5 ,PageSizeLetter :_gbc .PageSizeLetter ,PageSizeLegal :_gbc .PageSizeLegal };
);func _geb (_cfdc float64 )float64 {return _cfdc *_dc .Millimeter };func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func (_afg *creatorContext )drawLineChart (_dgc *_f .CT_LineChart ,_dbg *Rectangle ,_adce []*_f .CT_PlotAreaChoice1 ,_ggbf float64 )([]*legendItem ,error ){_cedd :=[]*legendItem {};
_ccba :=_dgc .Ser ;_gfe :=make (map[int ][]float64 );_fbgf :=make (map[int ][]float64 );_aceca :=make (map[int ]_gbc .Color );_cfga :=make (map[int ]float64 );for _cbce ,_bba :=range _ccba {var _afgg string ;if _ddaa :=_bba .Tx ;_ddaa !=nil {if _gdddg :=_ddaa .SerTxChoice ;
_gdddg !=nil {if _gdddg .V !=nil {_afgg =*_gdddg .V ;}else if _ebbd :=_gdddg .StrRef ;_ebbd !=nil {if _eae :=_ebbd .StrCache ;_eae !=nil {for _ ,_ebab :=range _eae .Pt {_afgg =_ebab .V ;};};};};};_aceca [_cbce ]=_gbc .ColorWhite ;if _abce :=_bba .SpPr ;
_abce !=nil {if _abfb :=_abce .Ln ;_abfb !=nil {if _fff :=_abfb .WAttr ;_fff !=nil {_cfga [_cbce ]=_dc .FromEMU (int64 (*_fff ));if _aadg :=_abfb .LineFillPropertiesChoice .SolidFill ;_aadg !=nil {_fbda :=_afg .getPdfColorFromSolidFill (_aadg );if _fbda !=nil {_aceca [_cbce ]=_fbda ;
};};};};};if _caeb :=_bba .Val ;_caeb !=nil {if _dee :=_caeb .NumDataSourceChoice ;_dee !=nil {if _dea :=_dee .NumRef ;_dea !=nil {if _bddd :=_dea .NumCache ;_bddd !=nil {for _ ,_fef :=range _bddd .Pt {_gfe [_cbce ]=append (_gfe [_cbce ],float64 (_fef .IdxAttr ));
_ccaba ,_ :=_ac .ParseFloat (_gca .TrimSpace (_fef .V ),64);_fbgf [_cbce ]=append (_fbgf [_cbce ],_ccaba );};};};};};_cedd =append (_cedd ,&legendItem {_eefb :_afgg ,_cecd :_bba .SpPr });};_ecbf :=true ;_dcf :=true ;_bebe :="";_afa :="";if len (_adce )> 0{for _ ,_gfbc :=range _adce {if _gfbc .CatAx !=nil {if _gfbc .CatAx .Delete !=nil {if !*(*_gfbc .CatAx .Delete ).ValAttr {_ecbf =false ;
};};_bebe =_afg .getTitle (_gfbc .CatAx .Title );}else if _gfbc .ValAx !=nil {if _gfbc .ValAx .Delete !=nil {if !*(*_gfbc .ValAx .Delete ).ValAttr {_dcf =false ;};};_afa =_afg .getTitle (_gfbc .ValAx .Title );};};};_caaf :=_fb .Style {Hidden :_ecbf ,FontSize :8*_ggbf };
_bddb :=_fb .Style {Hidden :_dcf ,FontSize :8*_ggbf };_bafg :=&_af .Chart {Series :[]_db .Series {},YAxisSecondary :_af .YAxis {Style :_bddb ,Name :_afa ,NameStyle :_bddb },XAxis :_af .XAxis {Style :_caaf ,Name :_bebe ,NameStyle :_caaf },YAxis :_af .YAxis {Style :_fb .Style {Hidden :true }}};
for _cgcd :=0;_cgcd < len (_aceca );_cgcd ++{_fgae ,_bege ,_bgcc :=_aceca [_cgcd ].ToRGB ();_gcef :=_db .ContinuousSeries {XValues :_gfe [_cgcd ],YValues :_fbgf [_cgcd ],Style :_fb .Style {StrokeColor :_g .RGBA {uint8 (_fgae *255),uint8 (_bege *255),uint8 (_bgcc *255),255},StrokeWidth :_cfga [_cgcd ]}};
_bafg .Series =append (_bafg .Series ,_gcef );};_bafg .SetHeight (int (_gb .Abs (_dbg .Top -_dbg .Bottom )));_bafg .SetWidth (int (_gb .Abs (_dbg .Right -_dbg .Left )));_acdb :=_afg ._fdad ;_dgab :=_gbc .NewChart (_bafg );_dgab .SetPos (_dbg .Left ,_dbg .Top );
_gdcb :=_acdb .Draw (_dgab );if _gdcb !=nil {return nil ,_gdcb ;};return _cedd ,nil ;};type serValue struct{_cgbb string ;_cef float64 ;_cae *_gf .CT_ShapeProperties ;};func (_fdb *creatorContext )addCatName (_fdf string ,_fca map[string ]serCategory ,_fda *[]string ){if _ ,_fbd :=_fca [_fdf ];
!_fbd {_fca [_fdf ]=serCategory {_edd :_fdf ,_bcf :[]serValue {}};*_fda =append (*_fda ,_fdf );};};func (_adg barSerByOrder )Len ()int {return len (_adg )};func FillRectangle (c *_gbc .Creator ,x ,y ,width ,height float64 ,color _gbc .Color ){if color ==nil {return ;
};_ddad :=c .NewRectangle (x ,y ,width ,height );_ddad .SetFillColor (color );_ddad .SetBorderWidth (0);c .Draw (_ddad );};type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};type FontStyle byte ;var _fgbc =_geb (1);var _add =_geb (1.5);
func MakeImageFromChartSpace (cs *_f .ChartSpace ,width ,height float64 ,theme *_gf .Theme ,workbook *_gbb .Workbook )(_cg .Image ,error ){_ecb ,_fdc :=_acb (cs ,width ,height ,theme ,true ,workbook );if _fdc !=nil {return nil ,_fdc ;};_afc ,_fdc :=GetPageFromCreator (_ecb );
if _fdc !=nil {return nil ,_fdc ;};return _bag .NewImageDevice ().Render (_afc );};func _bgea (_gga _gf .ST_SchemeColorVal ,_ebc *_gf .Theme )string {if _facb :=_ebc .ThemeElements ;_facb !=nil {if _aaec :=_facb .ClrScheme ;_aaec !=nil {switch _gga {case _gf .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_aaec .Lt1 );
case _gf .ST_SchemeColorValDk1 ,_gf .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_aaec .Dk1 );case _gf .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_aaec .Lt2 );case _gf .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_aaec .Dk2 );
case _gf .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_aaec .Accent1 );case _gf .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_aaec .Accent2 );case _gf .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_aaec .Accent3 );
case _gf .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_aaec .Accent4 );case _gf .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_aaec .Accent5 );case _gf .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_aaec .Accent6 );
};};};return "";};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func AdjustColorByLumOff (colorStr string ,lumOff float64 )string {var _bbg ,_gadcb ,_ecdb uint8 ;_cgce ,_ :=_bf .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_bbg ,&_gadcb ,&_ecdb );
if _cgce !=3{return "";};_dbfcf ,_cfgd ,_abgd :=_cce (_bbg ,_gadcb ,_ecdb );_abgd =_abgd +lumOff ;_bbg ,_gadcb ,_ecdb =_deb (_dbfcf ,_cfgd ,_abgd );return _bf .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_bbg ,_gadcb ,_ecdb );
};var _bgg =_geb (5);func ClearRegisteredFonts (){_beac ._bdc .Lock ();_beac ._cefe =map[string ]map[FontStyle ]*_ea .PdfFont {};_beac ._bdc .Unlock ();};var _feb =_geb (7.5);var _beac =fontsMap {_bdc :&_c .Mutex {},_cefe :map[string ]map[FontStyle ]*_ea .PdfFont {}};
func _bgce (_bbgg ,_abae ,_efg float64 )float64 {if _bbgg *6< 1{return _efg +(_abae -_efg )*6*_bbgg ;}else if _bbgg *2< 1{return _abae ;}else if _bbgg *3< 2{return _efg +(_abae -_efg )*(2.0/3.0-_bbgg )*6;}else {return _efg ;};};type BorderPosition byte ;
const _dcdg =6.0;func (_ebgb *creatorContext )getPdfColorFromSolidFill (_abadb *_gf .CT_SolidColorFillProperties )_gbc .Color {if _abadb ==nil {return nil ;};_debdg :="";if _dgfe :=_abadb .SrgbClr ;_dgfe !=nil {_debdg =_dgfe .ValAttr ;}else if _bgeag :=_abadb .SchemeClr ;
_bgeag !=nil {_debdg =_bgea (_bgeag .ValAttr ,_ebgb ._befa );_debdg =AdjustColor (_debdg ,_bgeag .EG_ColorTransform );};if _debdg ==""{return nil ;};return _gbc .ColorRGBFromHex ("\u0023"+_debdg );};var RtlFontFile *_ea .PdfFont ;type serCategory struct{_edd string ;
_bcf []serValue ;};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _gbd ,_gde ,_ebgd uint8 ;_abcc ,_ :=_bf .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_gbd ,&_gde ,&_ebgd );if _abcc !=3{return "";
};_abaa ,_aafe ,_ddf :=_cce (_gbd ,_gde ,_ebgd );_ddf =lum *_ddf ;_gbd ,_gde ,_ebgd =_deb (_abaa ,_aafe ,_ddf );return _bf .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_gbd ,_gde ,_ebgd );};func MakeTempCreator (width ,height float64 )*_gbc .Creator {_dbgg :=_gbc .New ();
_dbgg .SetPageSize (_gbc .PageSize {width ,height });_dbgg .SetPageMargins (0,0,0,0);return _dbgg ;};func FromSTPercentage (st *_gf .ST_Percentage )float64 {if _fefe :=st .ST_PercentageDecimal ;_fefe !=nil {return float64 (*_fefe )/Percent100 ;};return 0;
};func DrawLine (c *_gbc .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _gbc .Color ){if color ==nil {return ;};_babc :=c .NewLine (x0 ,y0 ,x1 ,y1 );_babc .SetLineWidth (width );_babc .SetColor (color );c .Draw (_babc );};func _efbg (_facc *_f .CT_SerAx )(uint32 ,_f .ST_AxPos ,_f .ST_TickMark ,_f .ST_TickLblPos ,*_f .CT_ChartLines ,uint32 ,*_gf .CT_ShapeProperties ,error ){var _ggc ,_gdff uint32 ;
var _defd _f .ST_AxPos ;var _gea _f .ST_TickMark ;var _bfdc *_f .CT_ChartLines ;var _faed _f .ST_TickLblPos ;if _facc .AxId ==nil {return _ggc ,_defd ,_gea ,_faed ,_bfdc ,_gdff ,_facc .SpPr ,_ga .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_ggc =_facc .AxId .ValAttr ;};if _facc .AxPos ==nil {return _ggc ,_defd ,_gea ,_faed ,_bfdc ,_gdff ,_facc .SpPr ,_ga .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_defd =_facc .AxPos .ValAttr ;
};if _facc .MajorTickMark !=nil {_gea =_facc .MajorTickMark .ValAttr ;};if _facc .TickLblPos !=nil {_faed =_facc .TickLblPos .ValAttr ;};if _facc .CrossAx ==nil {return _ggc ,_defd ,_gea ,_faed ,_bfdc ,_gdff ,_facc .SpPr ,_ga .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_gdff =_facc .CrossAx .ValAttr ;};_bfdc =_facc .MajorGridlines ;return _ggc ,_defd ,_gea ,_faed ,_bfdc ,_gdff ,_facc .SpPr ,nil ;};func (_dg *creatorContext )drawAreaChart (_dbb *_f .CT_AreaChart ,_bb *Rectangle ,_bgf []*_f .CT_PlotAreaChoice1 ,_gd float64 )([]*legendItem ,error ){_fc :=[]*legendItem {};
_ab :=_dbb .Ser ;_da :=make (map[int ][]float64 );_gcg :=make (map[int ][]float64 );_dfa :=make (map[int ]_gbc .Color );for _cf ,_eff :=range _ab {_dfa [_cf ]=_gbc .ColorWhite ;if _baa :=_eff .SpPr ;_baa !=nil {_fbf :=_dg .getPdfColorFromSolidFill (_baa .FillPropertiesChoice .SolidFill );
if _fbf !=nil {_dfa [_cf ]=_fbf ;};};if _fa :=_eff .Val ;_fa !=nil {if _ce :=_fa .NumDataSourceChoice ;_ce !=nil {if _bbc :=_ce .NumRef ;_bbc !=nil {if _gcf :=_bbc .NumCache ;_gcf !=nil {for _ ,_dbf :=range _gcf .Pt {_da [_cf ]=append (_da [_cf ],float64 (_dbf .IdxAttr ));
_eg ,_ :=_ac .ParseFloat (_gca .TrimSpace (_dbf .V ),64);_gcg [_cf ]=append (_gcg [_cf ],_eg );};};};};};};_eb :=true ;_fg :="";_dbfc :="";if len (_bgf )> 1{if _bgf [0].ValAx !=nil &&_bgf [1].ValAx !=nil {if _bgf [0].ValAx .Delete !=nil &&_bgf [1].ValAx .Delete !=nil {if !*(*_bgf [0].ValAx .Delete ).ValAttr &&!*(*_bgf [1].ValAx .Delete ).ValAttr {_eb =false ;
};};_fg =_dg .getTitle (_bgf [0].ValAx .Title );_dbfc =_dg .getTitle (_bgf [1].ValAx .Title );};};_cdc :=_fb .Style {Hidden :_eb ,FontSize :8*_gd };_cec :=&_af .Chart {Series :[]_db .Series {},YAxisSecondary :_af .YAxis {Style :_cdc ,Name :_dbfc ,NameStyle :_cdc },XAxis :_af .XAxis {Style :_cdc ,Name :_fg ,NameStyle :_cdc },YAxis :_af .YAxis {Style :_fb .Style {Hidden :true }}};
for _bgfb :=0;_bgfb < len (_dfa );_bgfb ++{_dbba ,_ff ,_cgb :=_dfa [_bgfb ].ToRGB ();_bd :=_db .ContinuousSeries {XValues :_da [_bgfb ],YValues :_gcg [_bgfb ],Style :_fb .Style {StrokeWidth :1,FillColor :_g .RGBA {uint8 (_dbba *255),uint8 (_ff *255),uint8 (_cgb *255),255}}};
_cec .Series =append (_cec .Series ,_bd );};_cec .SetHeight (int (_gb .Abs (_bb .Top -_bb .Bottom )));_cec .SetWidth (int (_gb .Abs (_bb .Right -_bb .Left )));_cda :=_dg ._fdad ;_bbcg :=_gbc .NewChart (_cec );_bbcg .SetPos (_bb .Left ,_bb .Top );_be :=_cda .Draw (_bbcg );
if _be !=nil {return nil ,_be ;};return _fc ,nil ;};var _gdg =_geb (1.5);var _edba =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
func MakeBlockFromChartSpace (cs *_f .ChartSpace ,width ,height float64 ,theme *_gf .Theme )(*_gbc .Block ,error ){_gaff ,_dbdg :=_acb (cs ,width ,height ,theme ,false ,nil );if _dbdg !=nil {return nil ,_dbdg ;};_ddg ,_dbdg :=GetPageFromCreator (_gaff );
if _dbdg !=nil {return nil ,_dbdg ;};_gcc ,_dbdg :=_gbc .NewBlockFromPage (_ddg );if _dbdg !=nil {return nil ,_dbdg ;};return _gcc ,nil ;};func (_bddf *creatorContext )addCatValue (_fbff string ,_bebc map[string ]serCategory ,_dcb []string ,_bcb int ,_bca ,_eca *float64 ,_faec string ,_aea *_gf .CT_ShapeProperties ){_beag ,_dgf :=_ac .ParseFloat (_fbff ,64);
if _dgf !=nil {_beag =0;_dfc .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_dgf );};if _beag > *_eca {*_eca =_beag ;};if _beag < *_bca {*_bca =_beag ;};_dcbd :=_bebc [_dcb [_bcb ]];_dcbd ._bcf =append (_dcbd ._bcf ,serValue {_cgbb :_faec ,_cef :_beag ,_cae :_aea });
_bebc [_dcb [_bcb ]]=_dcbd ;};func _ccda (_gfd uint8 ,_dged float64 )string {_afce :=float64 (_gfd );return _bf .Sprintf ("\u0025\u0030\u0032\u0078",int (_afce *_dged ));};func AdjustColorByShade (colorStr string ,shade float64 )string {var _ebg ,_dfgb ,_bdb uint8 ;
_dbee ,_ :=_bf .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_ebg ,&_dfgb ,&_bdb );if _dbee !=3{return "";};return _ccda (_ebg ,shade )+_ccda (_dfgb ,shade )+_ccda (_bdb ,shade );};func (_cde *creatorContext )drawTitle (_gae string ,_bcbf ,_bfab float64 ){_afe :=_cde ._dgbb ;
_afb :=_cde ._fdad .NewStyledParagraph ();_dfgd :=_afb .SetText (_gae );_agd ,_egf :=_ea .NewStandard14Font (_ea .HelveticaName );if _egf ==nil {_begb :=_cde ._fdad .NewTextStyle ();_begb .Font =_agd ;_begb .FontSize =14;_begb .TextRise =0.4;_dfgd .Style =_begb ;
_afb .SetPos (_bcbf -_afb .Width ()*_afe /2,_bfab );_cde ._fdad .Draw (_afb );};};func AdjustColorByTint (colorStr string ,tint float64 )string {var _ccb ,_dcgd ,_adcc uint8 ;_gagb ,_ :=_bf .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_ccb ,&_dcgd ,&_adcc );
if _gagb !=3{return "";};return _cbcg (_ccb ,tint )+_cbcg (_dcgd ,tint )+_cbcg (_adcc ,tint );};func GetPageDimensions (size PageSize )_gbc .PageSize {return _bcc [size ]};func _eafd (_fbef *_f .CT_DateAx )(uint32 ,_f .ST_AxPos ,_f .ST_TickMark ,_f .ST_TickLblPos ,*_f .CT_ChartLines ,uint32 ,*_gf .CT_ShapeProperties ,error ){var _aced ,_bgfba uint32 ;
var _ccab _f .ST_AxPos ;var _abbg _f .ST_TickMark ;var _gcb *_f .CT_ChartLines ;var _egag _f .ST_TickLblPos ;if _fbef .AxId ==nil {return _aced ,_ccab ,_abbg ,_egag ,_gcb ,_bgfba ,_fbef .SpPr ,_ga .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_aced =_fbef .AxId .ValAttr ;};if _fbef .AxPos ==nil {return _aced ,_ccab ,_abbg ,_egag ,_gcb ,_bgfba ,_fbef .SpPr ,_ga .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ccab =_fbef .AxPos .ValAttr ;
};if _fbef .MajorTickMark !=nil {_abbg =_fbef .MajorTickMark .ValAttr ;};if _fbef .TickLblPos !=nil {_egag =_fbef .TickLblPos .ValAttr ;};if _fbef .CrossAx ==nil {return _aced ,_ccab ,_abbg ,_egag ,_gcb ,_bgfba ,_fbef .SpPr ,_ga .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_bgfba =_fbef .CrossAx .ValAttr ;};_gcb =_fbef .MajorGridlines ;return _aced ,_ccab ,_abbg ,_egag ,_gcb ,_bgfba ,_fbef .SpPr ,nil ;};func GetColorStringFromDmlColor (dmlColor *_gf .CT_Color )string {var _agag string ;if _beab :=dmlColor .SrgbClr ;
_beab !=nil {_agag =_beab .ValAttr ;}else if _acgc :=dmlColor .SysClr ;_acgc !=nil {if _acgc .LastClrAttr !=nil {return *_acgc .LastClrAttr ;};return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _agag ;};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_dc .Twips *10+0.5))/10;
};type fontsMap struct{_bdc *_c .Mutex ;_cefe map[string ]map[FontStyle ]*_ea .PdfFont ;};func CropImageByRect (sourceImg _cg .Image ,rect _cg .Rectangle )_cg .Image {_bbge ,_dgef ,_bdfd ,_acce :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;
_ggfb :=_cg .NewNRGBA (_cg .Rect (0,0,_bdfd -_bbge ,_acce -_dgef ));for _dbdb :=_bbge ;_dbdb < _bdfd ;_dbdb ++{for _ddfb :=_dgef ;_ddfb < _acce ;_ddfb ++{_ggfb .Set (_dbdb -_bbge ,_ddfb -_dgef ,sourceImg .At (_dbdb ,_ddfb ));};};return _ggfb ;};const (PageSizeA4 PageSize =iota ;
PageSizeA3 ;PageSizeA5 ;PageSizeLetter ;PageSizeLegal ;Percent100 =100000.0;MaxPageHeight =11906;);func (_acg *creatorContext )drawAxes (_abac []*_f .CT_PlotAreaChoice1 ,_abb ,_gadc ,_cbccf float64 ,_fbece []string ,_abbd *Rectangle ,_eddg bool )error {_ffdd :=_acg ._fdad ;
_faa :=_acg ._dgbb ;if _abac ==nil {return _ga .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};var (_gfgc *_f .CT_ValAx ;_fecc *_f .CT_CatAx ;_fcc *_f .CT_DateAx ;_cefd *_f .CT_SerAx ;
);for _ ,_caa :=range _abac {if _caa .ValAx !=nil {_gfgc =_caa .ValAx ;}else if _caa .CatAx !=nil {_fecc =_caa .CatAx ;}else if _caa .DateAx !=nil {_fcc =_caa .DateAx ;}else if _caa .SerAx !=nil {_cefd =_caa .SerAx ;};};if _gfgc ==nil ||(_fecc ==nil &&_fcc ==nil &&_cefd ==nil ){return _ga .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _eceb ,_befg ,_dbc ,_eed uint32 ;var _aca ,_gbcf _f .ST_AxPos ;var _aaga ,_gccd _f .ST_TickMark ;var _cbfb ,_ffcd *_f .CT_ChartLines ;var _gcgc ,_ggb _f .ST_TickLblPos ;var _dac ,_badc *_gf .CT_ShapeProperties ;var _fcb error ;_abec :=_abbd .Right -_abbd .Left ;
_fag :=_abbd .Bottom -_abbd .Top ;if _gfgc !=nil {_befg ,_gbcf ,_gccd ,_ggb ,_ffcd ,_eed ,_badc ,_fcb =_ccd (_gfgc );};if _gbcf !=_f .ST_AxPosL &&_gbcf !=_f .ST_AxPosB {return _ga .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_gbgg :=_gadc -_abb ;_efbb :=int (_gbgg /_cbccf )+1;var _baf ,_gdcc float64 ;switch _gccd {case _f .ST_TickMarkIn :_baf ,_gdcc =_fgbc ,0;case _f .ST_TickMarkOut :_baf ,_gdcc =0,_fgbc ;case _f .ST_TickMarkCross :_baf ,_gdcc =_fgbc ,_fgbc ;};_baf =_baf *_faa ;
_gdcc =_gdcc *_faa ;var _gbfd *_gf .CT_ShapeProperties ;if _ffcd !=nil {_gbfd =_ffcd .SpPr ;};_bced ,_cab :=_gcgc !=_f .ST_TickLblPosNone ,_ggb !=_f .ST_TickLblPosNone ;_baga :=_abb ;if _fecc !=nil {_eceb ,_aca ,_aaga ,_gcgc ,_cbfb ,_dbc ,_dac ,_fcb =_eea (_fecc );
}else if _fcc !=nil {_eceb ,_aca ,_aaga ,_gcgc ,_cbfb ,_dbc ,_dac ,_fcb =_eafd (_fcc );}else if _cefd !=nil {_eceb ,_aca ,_aaga ,_gcgc ,_cbfb ,_dbc ,_dac ,_fcb =_efbg (_cefd );};if _fcb !=nil {return _fcb ;};if _aca !=_f .ST_AxPosL &&_aca !=_f .ST_AxPosB {return _ga .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _eceb !=_eed ||_befg !=_dbc {return _ga .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_dgb :=len (_fbece )+1;var _afeg ,_deg float64 ;switch _aaga {case _f .ST_TickMarkIn :_afeg ,_deg =_fgbc ,0;
case _f .ST_TickMarkOut :_afeg ,_deg =0,_fgbc ;case _f .ST_TickMarkCross :_afeg ,_deg =_fgbc ,_fgbc ;};_afeg =_afeg *_faa ;_deg =_deg *_faa ;var _dga *_gf .CT_ShapeProperties ;if _cbfb !=nil {_dga =_cbfb .SpPr ;};if _eddg {_cfb :=_fag /float64 (len (_fbece ));
_gfc :=_abbd .Left -_abb *_abec /_gbgg ;_ecdg :=_gfc -_feb *_faa ;if _bced {var _fea float64 ;for _aac :=0;_aac < _dgb ;_aac ++{_febd :=_abbd .Bottom -float64 (_aac )*_cfb ;if _aac < _dgb -1{_ffg :=_ffdd .NewParagraph (_fbece [_aac ]);_ffg .SetFontSize (_dcdg *_faa );
_ffg .SetPos (_ecdg ,_febd -_cfb /2-_gdg *_faa );_ffdd .Draw (_ffg );_bfe :=(_ffg .Width ()/1000-_feb )*_faa ;if _bfe > 0&&_bfe > _fea {_fea =_bfe ;};};};if _fea > 0{_abbd .Left +=_fea +_aba ;_gfc =_abbd .Left -_abb *_abec /_gbgg ;_abec =_abbd .Right -_abbd .Left ;
};};_edgf :=_gfc -_deg ;_aafc :=_gfc +_afeg ;_affd :=_abbd .Left ;_egeag :=_abbd .Right ;for _faea :=0;_faea < _dgb ;_faea ++{_ebdc :=_abbd .Bottom -float64 (_faea )*_cfb ;_acg .drawLineWithProps (_dac ,_edgf ,_ebdc ,_aafc ,_ebdc ,true );_acg .drawLineWithProps (_dga ,_affd ,_ebdc ,_egeag ,_ebdc ,true );
};_ccaf :=_abec /_gbgg ;_cfcc :=_abbd .Bottom -_baf ;_gaa :=_abbd .Bottom +_gdcc ;_ffdf :=_abbd .Top ;_cebd :=_abbd .Bottom ;for _ada :=0;_ada < _efbb ;_ada ++{_bde :=_abbd .Left +(_baga -_abb )*_ccaf ;_acg .drawLineWithProps (_badc ,_bde ,_cfcc ,_bde ,_gaa ,true );
_acg .drawLineWithProps (_gbfd ,_bde ,_ffdf ,_bde ,_cebd ,true );if _cab {_age :=_ffdd .NewParagraph (_ac .FormatFloat (_baga ,'g',-1,64));_age .SetFontSize (_dcdg *_faa );_age .SetPos (_bde -_ced *_faa ,_cebd +_cfc *_faa );_ffdd .Draw (_age );};_baga +=_cbccf ;
};}else {_abg :=_fag /_gbgg ;_abef :=_abbd .Left ;if _cab {var _gddd float64 ;for _gfae :=0;_gfae < _efbb ;_gfae ++{_cgdg :=_abbd .Bottom -(_baga -_abb )*_abg ;_fdga :=_ffdd .NewParagraph (_ac .FormatFloat (_baga ,'g',-1,64));_fdga .SetFontSize (_dcdg *_faa );
_fdga .SetPos (_abef -_feb *_faa ,_cgdg -_gdg *_faa );_ffdd .Draw (_fdga );_gafb :=(_fdga .Width ()/1000-_feb )*_faa ;if _gafb > 0&&_gafb > _gddd {_gddd =_gafb ;};_baga +=_cbccf ;};if _gddd > 0{_abbd .Left +=_gddd +_aba ;_abec =_abbd .Right -_abbd .Left ;
};};_baga =_abb ;_bfcg :=_abbd .Left -_gdcc ;_acec :=_abbd .Left +_baf ;_abef =_abbd .Left ;_cegb :=_abbd .Right ;for _edcf :=0;_edcf < _efbb ;_edcf ++{_gbfda :=_abbd .Bottom -(_baga -_abb )*_abg ;_acg .drawLineWithProps (_badc ,_bfcg ,_gbfda ,_acec ,_gbfda ,true );
_acg .drawLineWithProps (_gbfd ,_abef ,_gbfda ,_cegb ,_gbfda ,true );_baga +=_cbccf ;};_dfe :=_abec /float64 (len (_fbece ));_acfg :=_abbd .Bottom +_abb *_fag /_gbgg ;_cbb :=_acfg -_afeg ;_adeb :=_acfg +_deg ;_agf :=_abbd .Top ;_adfb :=_abbd .Bottom ;_gce :=_acfg +_cfc *_faa ;
for _dcda :=0;_dcda < _dgb ;_dcda ++{_aaa :=_abbd .Left +float64 (_dcda )*_dfe ;_acg .drawLineWithProps (_dac ,_aaa ,_cbb ,_aaa ,_adeb ,true );_acg .drawLineWithProps (_dga ,_aaa ,_agf ,_aaa ,_adfb ,true );if _bced &&_dcda < _dgb -1{_aee :=_ffdd .NewParagraph (_fbece [_dcda ]);
_aee .SetFontSize (_dcdg *_faa );_aee .SetPos (_aaa +_bgg *_faa ,_gce );_ffdd .Draw (_aee );};};};return nil ;};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;
ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);type legendItem struct{_eefb string ;_cecd *_gf .CT_ShapeProperties ;};func (_fac barSerByOrder )Swap (i ,j int ){_fac [i ],_fac [j ]=_fac [j ],_fac [i ]};type creatorContext struct{_fdad *_gbc .Creator ;_befa *_gf .Theme ;
_dgbb float64 ;};type ImgPart byte ;func (_gabf *creatorContext )drawRectangleWithProps (_begdd *_gf .CT_ShapeProperties ,_edbb ,_gbea ,_efgd ,_afae float64 ,_eged bool ){_ded :=_gabf ._fdad .NewRectangle (_edbb ,_gbea ,_efgd ,_afae );if _begdd ==nil {if _eged {_ded .SetBorderWidth (_badd );
}else {return ;};}else {_dgd :=_gabf .getPdfColorFromSolidFill (_begdd .FillPropertiesChoice .SolidFill );if _dgd !=nil {_ded .SetFillColor (_dgd );};if _fedb :=_begdd .Ln ;_fedb !=nil {if _dccb :=_fedb .WAttr ;_dccb !=nil {_agfbb :=_dc .FromEMU (int64 (*_dccb ));
_ded .SetBorderWidth (_agfbb );if _abad :=_fedb .LineFillPropertiesChoice .SolidFill ;_abad !=nil {_bdfc :=_gabf .getPdfColorFromSolidFill (_abad );if _bdfc !=nil {_ded .SetBorderColor (_bdfc );};};}else {_ded .SetBorderWidth (0);};};};_gabf ._fdad .Draw (_ded );
};func MakeBlockFromCreator (c *_gbc .Creator )(*_gbc .Block ,error ){_ffe ,_gfgeg :=GetPageFromCreator (c );if _gfgeg !=nil {return nil ,_gfgeg ;};_agaa ,_gfgeg :=_gbc .NewBlockFromPage (_ffe );if _gfgeg !=nil {return nil ,_gfgeg ;};return _agaa ,nil ;
};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func (_cfdg *creatorContext )drawLineWithProps (_abceb *_gf .CT_ShapeProperties ,_aged ,_bfbaa ,_gbaca ,_debd float64 ,_ebdd bool ){if _abceb !=nil {if _bcedd :=_abceb .Ln ;_bcedd !=nil {_baadc :=_cfdg .getPdfColorFromSolidFill (_bcedd .LineFillPropertiesChoice .SolidFill );
if _baadc ==nil &&_ebdd {_baadc =_gbc .ColorBlack ;};if _baadc !=nil {var _bcfe float64 ;if _dbded :=_bcedd .WAttr ;_dbded !=nil {_bcfe =_dc .FromEMU (int64 (*_dbded ));}else {_bcfe =_badd ;};DrawLine (_cfdg ._fdad ,_aged ,_bfbaa ,_gbaca ,_debd ,_bcfe ,_baadc );
};};};};type PageSize int ;func (_cdba *Rectangle )scale (_dagdd float64 ){_cdba .Top *=_dagdd ;_cdba .Bottom *=_dagdd ;_cdba .Left *=_dagdd ;_cdba .Right *=_dagdd ;};func _ccd (_dggf *_f .CT_ValAx )(uint32 ,_f .ST_AxPos ,_f .ST_TickMark ,_f .ST_TickLblPos ,*_f .CT_ChartLines ,uint32 ,*_gf .CT_ShapeProperties ,error ){var _bge ,_bcab uint32 ;
var _bbb _f .ST_AxPos ;var _cbccg _f .ST_TickMark ;var _baff *_f .CT_ChartLines ;var _eab _f .ST_TickLblPos ;if _dggf .AxId ==nil {return _bge ,_bbb ,_cbccg ,_eab ,_baff ,_bcab ,_dggf .SpPr ,_ga .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_bge =_dggf .AxId .ValAttr ;};if _dggf .AxPos ==nil {return _bge ,_bbb ,_cbccg ,_eab ,_baff ,_bcab ,_dggf .SpPr ,_ga .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_bbb =_dggf .AxPos .ValAttr ;
};if _dggf .MajorTickMark !=nil {_cbccg =_dggf .MajorTickMark .ValAttr ;};if _dggf .TickLblPos !=nil {_eab =_dggf .TickLblPos .ValAttr ;};if _dggf .CrossAx ==nil {return _bge ,_bbb ,_cbccg ,_eab ,_baff ,_bcab ,_dggf .SpPr ,_ga .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_bcab =_dggf .CrossAx .ValAttr ;};_baff =_dggf .MajorGridlines ;return _bge ,_bbb ,_cbccg ,_eab ,_baff ,_bcab ,_dggf .SpPr ,nil ;};func (_fecg *creatorContext )drawBorderWithProps (_fgg *_gf .CT_ShapeProperties ,_aabc *Rectangle ,_cfccf float64 ){if _aabc !=nil &&_fgg !=nil &&_fgg .Ln !=nil &&_fgg .Ln .LineFillPropertiesChoice .SolidFill !=nil {_ebbc :=_fecg .getPdfColorFromSolidFill (_fgg .Ln .LineFillPropertiesChoice .SolidFill );
DrawRectangle (_fecg ._fdad ,_aabc ,_cfccf ,_ebbc );};};func GetPageFromCreator (c *_gbc .Creator )(*_ea .PdfPage ,error ){_fgfb :=_a .NewBuffer ([]byte {});_bagf :=c .Write (_fgfb );if _bagf !=nil {return nil ,_bagf ;};_beaa :=_a .NewReader (_fgfb .Bytes ());
_gaggd ,_bagf :=_ea .NewPdfReader (_beaa );if _bagf !=nil {return nil ,_bagf ;};return _gaggd .GetPage (1);};func TwipsFromPoints (points float64 )float64 {return points /_dc .Twips };func RegisterFontsFromFiles (files []string )error {for _ ,_beef :=range files {if _gca .HasSuffix (_beef ,"\u002e\u0074\u0074\u0066"){_bab :=_eccc (_beef );
if _bab !=nil {_dfc .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_bab );
continue ;};};};return nil ;};func GetDefaultPageSize ()_gbc .PageSize {return _bcc [DefaultPageSize ]};func _acb (_ade *_f .ChartSpace ,_egb ,_bda float64 ,_agae *_gf .Theme ,_gbff bool ,_dba *_gbb .Workbook )(*_gbc .Creator ,error ){_daa :=1.0;if _gbff {_daa =8.0;
};_gacd :=&Rectangle {};_bgbf :=&Rectangle {Top :_gacd .Top ,Bottom :_bda -_gacd .Bottom ,Left :_gacd .Left ,Right :_egb -_gacd .Right };_aab :=MakeTempCreator (_egb *_daa +1,_bda *_daa +1);_cca :=&creatorContext {_fdad :_aab ,_befa :_agae ,_dgbb :_daa };
var _aad bool ;if _fdg :=_ade .Chart ;_fdg !=nil {_bfd :=_fdg .PlotArea ;if _bfd ==nil {return nil ,_ga .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_afca :=0.0;if _fdg .AutoTitleDeleted !=nil &&_fdg .AutoTitleDeleted .ValAttr !=nil &&!*_fdg .AutoTitleDeleted .ValAttr {if _fdg .Title !=nil &&_fdg .Title .Overlay !=nil &&_fdg .Title .Overlay .ValAttr !=nil &&!*_fdg .Title .Overlay .ValAttr {_afca =_geb (10);
};_dfcc :=_cca .getTitle (_fdg .Title );if _dfcc ==""{_dfcc ="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";};_cca .drawTitle (_dfcc ,_bgbf .Left +_bgbf .Right /2,_geb (5));};_fec :=&Rectangle {Top :_geb (10)+_afca ,Bottom :_bgbf .Bottom -_geb (15),Left :_geb (10),Right :_bgbf .Right -_geb (10)};
var _fecd *Rectangle ;_abf :=_fdg .Legend ;if _abf !=nil {_dad :=_abf .Overlay !=nil &&_abf .Overlay .ValAttr !=nil &&*_abf .Overlay .ValAttr ;if _fcd :=_abf .LegendPos ;_fcd !=nil {switch _fcd .ValAttr {case _f .ST_LegendPosTr :if !_dad {_fec =&Rectangle {Top :_geb (25)+_afca ,Bottom :_bgbf .Bottom -_geb (10),Left :_geb (10),Right :_bgbf .Right -_geb (25)};
};_fecd =&Rectangle {Top :_geb (2.5)+_afca ,Bottom :_geb (22.5),Left :_bgbf .Right -_geb (22.5),Right :_bgbf .Right -_geb (2.5)};case _f .ST_LegendPosT :_fecd =&Rectangle {Top :_geb (2.5)+_afca ,Bottom :_geb (7.5),Left :(_bgbf .Right -_bgbf .Left )*0.25,Right :(_bgbf .Right -_bgbf .Left )*0.75};
if !_dad {_fec =&Rectangle {Top :_geb (12.5)+_afca ,Bottom :_bgbf .Bottom -_geb (15),Left :_geb (10),Right :_bgbf .Right -_geb (5)};};_aad =true ;case _f .ST_LegendPosB :_fecd =&Rectangle {Top :_bgbf .Bottom -_geb (7.5)+_afca ,Bottom :_bgbf .Bottom -_geb (2.5),Left :(_bgbf .Right -_bgbf .Left )*0.25,Right :(_bgbf .Right -_bgbf .Left )*0.75};
if !_dad {_fec =&Rectangle {Top :_geb (5)+_afca ,Bottom :_bgbf .Bottom -_geb (15),Left :_geb (10),Right :_bgbf .Right -_geb (5)};};_aad =true ;case _f .ST_LegendPosR :_fecd =&Rectangle {Top :(_bgbf .Bottom -_bgbf .Top )/2-_geb (10)+_afca ,Bottom :(_bgbf .Bottom -_bgbf .Top )/2+_geb (10),Left :_bgbf .Right -_geb (22.5),Right :_bgbf .Right -_geb (2.5)};
if !_dad {_fec =&Rectangle {Top :_geb (5)+_afca ,Bottom :_bgbf .Bottom -_geb (12.5),Left :_geb (10),Right :_bgbf .Right -_geb (25)};};case _f .ST_LegendPosL :_fecd =&Rectangle {Top :(_bgbf .Bottom -_bgbf .Top )/2-_geb (10)+_afca ,Bottom :(_bgbf .Bottom -_bgbf .Top )/2+_geb (10),Left :_geb (2.5),Right :_geb (22.5)};
if !_dad {_fec =&Rectangle {Top :_geb (5)+_afca ,Bottom :_bgbf .Bottom -_geb (12.5),Left :_geb (30),Right :_bgbf .Right -_geb (5)};};default:_fecd =&Rectangle {Top :(_bgbf .Bottom -_bgbf .Top )/2-_geb (10)+_afca ,Bottom :(_bgbf .Bottom -_bgbf .Top )/2+_geb (10),Left :_bgbf .Right -_geb (25),Right :_bgbf .Right -_geb (5)};
if !_dad {_fec =&Rectangle {Top :_geb (5)+_afca ,Bottom :_bgbf .Bottom -_geb (12.5),Left :_geb (100),Right :_bgbf .Right -_geb (25)};};};};};_fec .scale (_daa );_cca .drawBorderWithProps (_bfd .SpPr ,_fec ,_badd );_bef :=[]*legendItem {};var _cag error ;
_ffce :=_bfd .PlotAreaChoice1 ;for _ ,_dggb :=range _bfd .PlotAreaChoice {if _agab :=_dggb .BarChart ;_agab !=nil {_bef ,_cag =_cca .drawBarChart (_agab ,_fec ,_ffce ,_dba );if _cag !=nil {return nil ,_cag ;};break ;};if _eaa :=_dggb .PieChart ;_eaa !=nil {_bef ,_cag =_cca .drawPieChart (_eaa ,_fec ,_dba ,_daa );
if _cag !=nil {return nil ,_cag ;};break ;};if _edde :=_dggb .ScatterChart ;_edde !=nil {_bef ,_cag =_cca .drawScatterChart (_edde ,_fec ,_ffce ,_daa );if _cag !=nil {return nil ,_cag ;};break ;};if _aag :=_dggb .LineChart ;_aag !=nil {_bef ,_cag =_cca .drawLineChart (_aag ,_fec ,_ffce ,_daa );
if _cag !=nil {return nil ,_cag ;};break ;};if _bce :=_dggb .AreaChart ;_bce !=nil {_bef ,_cag =_cca .drawAreaChart (_bce ,_fec ,_ffce ,_daa );if _cag !=nil {return nil ,_cag ;};break ;};};if _abf !=nil {_fecd .scale (_daa );_cca .drawBorderWithProps (_abf .SpPr ,_fecd ,_badd );
if len (_bef )!=0{_cca .drawLegend (_fecd ,_bef ,_aad );};};};_bgbf .scale (_daa );_cca .drawBorderWithProps (_ade .SpPr ,_bgbf ,_badd );return _aab ,nil ;};func AssignStdFontByName (style _gbc .TextStyle ,fontName string )*_ea .PdfFont {_becf :=_ea .StdFontName (fontName );
return _ea .NewStandard14FontMustCompile (_becf );};func GetGroupOffsetFromXfrm (xfrm *_gf .CT_GroupTransform2D )(float64 ,float64 ){var _ffgd ,_dfgg float64 ;if xfrm .Off !=nil &&xfrm .ChOff !=nil {_ffgd =_dc .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_dc .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));
_dfgg =_dc .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_dc .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));};return _ffgd ,_dfgg ;};func ParseExcelRange (s string )(string ,_df .CellReference ,_df .CellReference ,error ){_abadf :=_gca .FieldsFunc (s ,func (_cbee rune )bool {return _cbee ==':'||_cbee =='!'});
if len (_abadf )==3{_bed ,_dbbaa :=_df .ParseCellReference (_abadf [1]);if _dbbaa !=nil {return "",_df .CellReference {},_df .CellReference {},_dbbaa ;};_abfbc ,_dbbaa :=_df .ParseCellReference (_abadf [2]);if _dbbaa !=nil {return "",_df .CellReference {},_df .CellReference {},_dbbaa ;
};return _abadf [0],_bed ,_abfbc ,nil ;};return "",_df .CellReference {},_df .CellReference {},_ga .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");};func _eccc (_cdbf string )error {if !_gca .HasSuffix (_cdbf ,"\u002e\u0074\u0074\u0066"){_dfc .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _bf .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_dadd ,_gcaa :=_ef .ParseFile (_cdbf );if _gcaa !=nil {_dfc .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gcaa );return _gcaa ;};_bddc ,_gcaa :=_ea .NewCompositePdfFontFromTTFFile (_cdbf );
if _gcaa !=nil {return _gcaa ;};_cfff :=_dadd .GetNameRecords ();for _ ,_gada :=range _cfff {_ddc :=_gada [1];if _ddc ==""{continue ;};_bfde :=make ([]byte ,0);for _acgf :=0;_acgf < len (_ddc );_acgf ++{if _ddc [_acgf ]==39||_ddc [_acgf ]==92{continue ;
};_bgfdf :=4;if _acgf +_bgfdf < len (_ddc ){if _ddc [_acgf :_acgf +_bgfdf ]=="\u0000"{_acgf =_acgf +_bgfdf +1;continue ;};};_bfde =append (_bfde ,_ddc [_acgf ]);};_ddc =_gca .Replace (string (_bfde ),"\u0078\u0030\u0030","",-1);_bded :=_gada [2];if _bded ==""{return _bf .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_cdbf );
};_bfde =make ([]byte ,0);for _cdfg :=0;_cdfg < len (_bded );_cdfg ++{if _bded [_cdfg ]==39||_bded [_cdfg ]==92{continue ;};_eccg :=4;if _cdfg +_eccg < len (_bded ){if _bded [_cdfg :_cdfg +_eccg ]=="\u0000"{_cdfg =_cdfg +_eccg +1;continue ;};};_bfde =append (_bfde ,_bded [_cdfg ]);
};_bded =_gca .Replace (string (_bfde ),"\u0078\u0030\u0030","",-1);RegisterFont (_ddc ,_edba [_bded ],_bddc );};return nil ;};func (_dce barSerByOrder )Less (i ,j int )bool {return _dce [i ].Order .ValAttr < _dce [j ].Order .ValAttr };func _deb (_ggg ,_gbac ,_gaba float64 )(uint8 ,uint8 ,uint8 ){var _fbg float64 ;
if _gaba < 0.5{_fbg =_gaba *(1+_gbac );}else {_fbg =_gaba +_gbac -_gaba *_gbac ;};_ggd :=_gaba *2-_fbg ;_ggg /=360.0;_egg :=_gfb (_ggg +1.0/3.0);_bfca :=_gfb (_ggg );_ged :=_gfb (_ggg -1.0/3.0);_ecba :=_bgce (_egg ,_fbg ,_ggd );_fbb :=_bgce (_bfca ,_fbg ,_ggd );
_bcad :=_bgce (_ged ,_fbg ,_ggd );return uint8 (255*_ecba ),uint8 (255*_fbb ),uint8 (255*_bcad );};var _ced =_geb (0.5);func (_gee *Rectangle )Translate (x ,y float64 ){_gee .Left +=x ;_gee .Right +=x ;_gee .Top +=y ;_gee .Bottom +=y ;};func MakeTempCreatorMaxHeight (width float64 )*_gbc .Creator {return MakeTempCreator (width ,MaxPageHeight );
};var _aba =_geb (2);func (_cgdgc FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_cgdgc )];
};type barSerByOrder []*_f .CT_BarSer ;func RegisterFontsFromDirectory (dirName string )error {_fgc ,_aec :=_gc .Open (dirName );if _aec !=nil {return _aec ;};defer _fgc .Close ();_eba ,_aec :=_fgc .Readdirnames (0);if _aec !=nil {return _aec ;};for _ ,_gfdg :=range _eba {if _gca .HasSuffix (_gfdg ,"\u002e\u0074\u0074\u0066"){_bee :=dirName +"\u002f"+_gfdg ;
_fdca :=_eccc (_bee );if _fdca !=nil {_dfc .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_fdca );
continue ;};};};return nil ;};func GetRegisteredFont (name string ,style FontStyle )*_ea .PdfFont {_beac ._bdc .Lock ();defer _beac ._bdc .Unlock ();if _gbfe ,_fcbf :=_beac ._cefe [name ];_fcbf {if _bec ,_adag :=_gbfe [style ];_adag {return _bec ;};};return nil ;
};