//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_b "bytes";_dd "errors";_ff "fmt";_eg "github.com/unidoc/unichart";_gfa "github.com/unidoc/unichart/dataset";_aeb "github.com/unidoc/unichart/render";_bc "github.com/unidoc/unioffice/v2/common/logger";_ed "github.com/unidoc/unioffice/v2/document";
_ffg "github.com/unidoc/unioffice/v2/measurement";_abe "github.com/unidoc/unioffice/v2/schema/soo/dml";_ad "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_dfa "github.com/unidoc/unioffice/v2/spreadsheet";_gc "github.com/unidoc/unioffice/v2/spreadsheet/format";
_gcc "github.com/unidoc/unioffice/v2/spreadsheet/formula";_ffb "github.com/unidoc/unioffice/v2/spreadsheet/reference";_df "github.com/unidoc/unipdf/v4/core";_ga "github.com/unidoc/unipdf/v4/creator";_gb "github.com/unidoc/unipdf/v4/model";_ae "github.com/unidoc/unipdf/v4/render";
_ab "github.com/unidoc/unitype";_a "image";_g "image/color";_c "math";_db "os";_f "regexp";_fd "sort";_e "strconv";_bf "strings";_gg "sync";_gf "unicode";);func _dab (_cdb *_ad .ChartSpace ,_fdfb ,_beb float64 ,_cadb *_abe .Theme ,_cgae bool ,_aag *_dfa .Workbook )(*_ga .Creator ,error ){_gdf :=1.0;
if _cgae {_gdf =8.0;};_cffd :=&Rectangle {};_facd :=&Rectangle {Top :_cffd .Top ,Bottom :_beb -_cffd .Bottom ,Left :_cffd .Left ,Right :_fdfb -_cffd .Right };_ebc :=MakeTempCreator (_fdfb *_gdf +1,_beb *_gdf +1);_fcf :=&creatorContext {_gcfga :_ebc ,_cdee :_cadb ,_bfad :_gdf };
var _ffe bool ;if _cge :=_cdb .Chart ;_cge !=nil {_gebg :=_cge .PlotArea ;if _gebg ==nil {return nil ,_dd .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_ccbe :=0.0;if _cge .AutoTitleDeleted !=nil &&_cge .AutoTitleDeleted .ValAttr !=nil &&!*_cge .AutoTitleDeleted .ValAttr {if _cge .Title !=nil &&_cge .Title .Overlay !=nil &&_cge .Title .Overlay .ValAttr !=nil &&!*_cge .Title .Overlay .ValAttr {_ccbe =_bfe (10);
};_edb :=_fcf .getTitle (_cge .Title );if _edb ==""{_edb ="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";};_fcf .drawTitle (_edb ,_facd .Left +_facd .Right /2,_bfe (5));};_fef :=&Rectangle {Top :_bfe (10)+_ccbe ,Bottom :_facd .Bottom -_bfe (15),Left :_bfe (10),Right :_facd .Right -_bfe (10)};
var _bec *Rectangle ;_gcca :=_cge .Legend ;if _gcca !=nil {_gbb :=_gcca .Overlay !=nil &&_gcca .Overlay .ValAttr !=nil &&*_gcca .Overlay .ValAttr ;if _def :=_gcca .LegendPos ;_def !=nil {switch _def .ValAttr {case _ad .ST_LegendPosTr :if !_gbb {_fef =&Rectangle {Top :_bfe (25)+_ccbe ,Bottom :_facd .Bottom -_bfe (10),Left :_bfe (10),Right :_facd .Right -_bfe (25)};
};_bec =&Rectangle {Top :_bfe (2.5)+_ccbe ,Bottom :_bfe (22.5),Left :_facd .Right -_bfe (22.5),Right :_facd .Right -_bfe (2.5)};case _ad .ST_LegendPosT :_bec =&Rectangle {Top :_bfe (2.5)+_ccbe ,Bottom :_bfe (7.5),Left :(_facd .Right -_facd .Left )*0.25,Right :(_facd .Right -_facd .Left )*0.75};
if !_gbb {_fef =&Rectangle {Top :_bfe (12.5)+_ccbe ,Bottom :_facd .Bottom -_bfe (15),Left :_bfe (10),Right :_facd .Right -_bfe (5)};};_ffe =true ;case _ad .ST_LegendPosB :_bec =&Rectangle {Top :_facd .Bottom -_bfe (7.5)+_ccbe ,Bottom :_facd .Bottom -_bfe (2.5),Left :(_facd .Right -_facd .Left )*0.25,Right :(_facd .Right -_facd .Left )*0.75};
if !_gbb {_fef =&Rectangle {Top :_bfe (5)+_ccbe ,Bottom :_facd .Bottom -_bfe (15),Left :_bfe (10),Right :_facd .Right -_bfe (5)};};_ffe =true ;case _ad .ST_LegendPosR :_bec =&Rectangle {Top :(_facd .Bottom -_facd .Top )/2-_bfe (10)+_ccbe ,Bottom :(_facd .Bottom -_facd .Top )/2+_bfe (10),Left :_facd .Right -_bfe (22.5),Right :_facd .Right -_bfe (2.5)};
if !_gbb {_fef =&Rectangle {Top :_bfe (5)+_ccbe ,Bottom :_facd .Bottom -_bfe (12.5),Left :_bfe (10),Right :_facd .Right -_bfe (25)};};case _ad .ST_LegendPosL :_bec =&Rectangle {Top :(_facd .Bottom -_facd .Top )/2-_bfe (10)+_ccbe ,Bottom :(_facd .Bottom -_facd .Top )/2+_bfe (10),Left :_bfe (2.5),Right :_bfe (22.5)};
if !_gbb {_fef =&Rectangle {Top :_bfe (5)+_ccbe ,Bottom :_facd .Bottom -_bfe (12.5),Left :_bfe (30),Right :_facd .Right -_bfe (5)};};default:_bec =&Rectangle {Top :(_facd .Bottom -_facd .Top )/2-_bfe (10)+_ccbe ,Bottom :(_facd .Bottom -_facd .Top )/2+_bfe (10),Left :_facd .Right -_bfe (25),Right :_facd .Right -_bfe (5)};
if !_gbb {_fef =&Rectangle {Top :_bfe (5)+_ccbe ,Bottom :_facd .Bottom -_bfe (12.5),Left :_bfe (100),Right :_facd .Right -_bfe (25)};};};};};_fef .scale (_gdf );_fcf .drawBorderWithProps (_gebg .SpPr ,_fef ,_fed );_caf :=[]*legendItem {};var _gbef error ;
_aagg :=_gebg .PlotAreaChoice1 ;for _ ,_faf :=range _gebg .PlotAreaChoice {if _gaec :=_faf .BarChart ;_gaec !=nil {_caf ,_gbef =_fcf .drawBarChart (_gaec ,_fef ,_aagg ,_aag );if _gbef !=nil {return nil ,_gbef ;};break ;};if _ded :=_faf .PieChart ;_ded !=nil {_caf ,_gbef =_fcf .drawPieChart (_ded ,_fef ,_aag ,_gdf );
if _gbef !=nil {return nil ,_gbef ;};break ;};if _fge :=_faf .ScatterChart ;_fge !=nil {_caf ,_gbef =_fcf .drawScatterChart (_fge ,_fef ,_aagg ,_gdf );if _gbef !=nil {return nil ,_gbef ;};break ;};if _dbac :=_faf .LineChart ;_dbac !=nil {_caf ,_gbef =_fcf .drawLineChart (_dbac ,_fef ,_aagg ,_gdf );
if _gbef !=nil {return nil ,_gbef ;};break ;};if _gcg :=_faf .AreaChart ;_gcg !=nil {_caf ,_gbef =_fcf .drawAreaChart (_gcg ,_fef ,_aagg ,_gdf );if _gbef !=nil {return nil ,_gbef ;};break ;};};if _gcca !=nil {_bec .scale (_gdf );_fcf .drawBorderWithProps (_gcca .SpPr ,_bec ,_fed );
if len (_caf )!=0{_fcf .drawLegend (_bec ,_caf ,_ffe );};};};_facd .scale (_gdf );_fcf .drawBorderWithProps (_cdb .SpPr ,_facd ,_fed );return _ebc ,nil ;};func _dbb (_bcfbf string )([]byte ,error ){_eeac :=_f .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");
_bcfbf =_eeac .ReplaceAllString (_bcfbf ,"");_eagg :=[]rune (_bcfbf );_dff :=[]byte {};for _fadf :=len (_eagg )-2;_fadf >=0;_fadf -=2{_fccba ,_agbe :=_e .ParseUint (string (_eagg [_fadf ])+string (_eagg [_fadf +1]),16,8);if _agbe !=nil {return nil ,_agbe ;
};_dff =append (_dff ,byte (_fccba ));};return _dff ,nil ;};func AdjustColorByTint (colorStr string ,tint float64 )string {var _geda ,_cbga ,_bagd uint8 ;_adbc ,_ :=_ff .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_geda ,&_cbga ,&_bagd );
if _adbc !=3{return "";};return _efd (_geda ,tint )+_efd (_cbga ,tint )+_efd (_bagd ,tint );};func (_ace barSerByOrder )Len ()int {return len (_ace )};const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;
BorderPositionRight BorderPosition =3;);func (_gbe barSerByOrder )Less (i ,j int )bool {return _gbe [i ].Order .ValAttr < _gbe [j ].Order .ValAttr };type ImgPart byte ;func FromSTPercentage (st *_abe .ST_Percentage )float64 {if _eagc :=st .ST_PercentageDecimal ;
_eagc !=nil {return float64 (*_eagc )/Percent100 ;};return 0;};type PageSize int ;func DrawRectangle (c *_ga .Creator ,r *Rectangle ,w float64 ,color _ga .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );
DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};func (_afd barSerByOrder )Swap (i ,j int ){_afd [i ],_afd [j ]=_afd [j ],_afd [i ]};func (_dcecf *creatorContext )drawTitle (_gff string ,_dfg ,_bfc float64 ){_fbae :=_dcecf ._bfad ;
_bffb :=_dcecf ._gcfga .NewStyledParagraph ();_dfb :=_bffb .SetText (_gff );_gccd ,_aeg :=_gb .NewStandard14Font (_gb .HelveticaName );if _aeg ==nil {_cae :=_dcecf ._gcfga .NewTextStyle ();_cae .Font =_gccd ;_cae .FontSize =14;_cae .TextRise =0.4;_dfb .Style =_cae ;
_bffb .SetPos (_dfg -_bffb .Width ()*_fbae /2,_bfc );_dcecf ._gcfga .Draw (_bffb );};};type serValue struct{_gdabe string ;_cfg float64 ;_fbgc *_abe .CT_ShapeProperties ;};var _gbaee =_bfe (1);func GetColorStringFromDmlColor (dmlColor *_abe .CT_Color )string {var _abba string ;
if _bbgg :=dmlColor .SrgbClr ;_bbgg !=nil {_abba =_bbgg .ValAttr ;}else if _ddba :=dmlColor .SysClr ;_ddba !=nil {if _ddba .LastClrAttr !=nil {return *_ddba .LastClrAttr ;};return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _abba ;};func _efge (_abfb *_ad .CT_ValAx )(uint32 ,_ad .ST_AxPos ,_ad .ST_TickMark ,_ad .ST_TickLblPos ,*_ad .CT_ChartLines ,uint32 ,*_abe .CT_ShapeProperties ,error ){var _gbeg ,_dcef uint32 ;
var _ccbb _ad .ST_AxPos ;var _bgc _ad .ST_TickMark ;var _dgg *_ad .CT_ChartLines ;var _dgdd _ad .ST_TickLblPos ;if _abfb .AxId ==nil {return _gbeg ,_ccbb ,_bgc ,_dgdd ,_dgg ,_dcef ,_abfb .SpPr ,_dd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_gbeg =_abfb .AxId .ValAttr ;};if _abfb .AxPos ==nil {return _gbeg ,_ccbb ,_bgc ,_dgdd ,_dgg ,_dcef ,_abfb .SpPr ,_dd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ccbb =_abfb .AxPos .ValAttr ;
};if _abfb .MajorTickMark !=nil {_bgc =_abfb .MajorTickMark .ValAttr ;};if _abfb .TickLblPos !=nil {_dgdd =_abfb .TickLblPos .ValAttr ;};if _abfb .CrossAx ==nil {return _gbeg ,_ccbb ,_bgc ,_dgdd ,_dgg ,_dcef ,_abfb .SpPr ,_dd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_dcef =_abfb .CrossAx .ValAttr ;};_dgg =_abfb .MajorGridlines ;return _gbeg ,_ccbb ,_bgc ,_dgdd ,_dgg ,_dcef ,_abfb .SpPr ,nil ;};var _fcb =_bfe (0.5);func _fdg (_gcgg ,_ceee ,_ebae float64 )(uint8 ,uint8 ,uint8 ){var _eda float64 ;if _ebae < 0.5{_eda =_ebae *(1+_ceee );
}else {_eda =_ebae +_ceee -_ebae *_ceee ;};_gce :=_ebae *2-_eda ;_gcgg /=360.0;_cbbd :=_gcgb (_gcgg +1.0/3.0);_acb :=_gcgb (_gcgg );_cca :=_gcgb (_gcgg -1.0/3.0);_ggdc :=_dbfc (_cbbd ,_eda ,_gce );_deeb :=_dbfc (_acb ,_eda ,_gce );_bgb :=_dbfc (_cca ,_eda ,_gce );
return uint8 (255*_ggdc ),uint8 (255*_deeb ),uint8 (255*_bgb );};type FontStyle byte ;func ParseExcelRange (s string )(string ,_ffb .CellReference ,_ffb .CellReference ,error ){_efad :=_bf .FieldsFunc (s ,func (_edce rune )bool {return _edce ==':'||_edce =='!'});
if len (_efad )==3{_aagf ,_dcea :=_ffb .ParseCellReference (_efad [1]);if _dcea !=nil {return "",_ffb .CellReference {},_ffb .CellReference {},_dcea ;};_cbbgf ,_dcea :=_ffb .ParseCellReference (_efad [2]);if _dcea !=nil {return "",_ffb .CellReference {},_ffb .CellReference {},_dcea ;
};return _efad [0],_aagf ,_cbbgf ,nil ;};return "",_ffb .CellReference {},_ffb .CellReference {},_dd .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");};func RegisterFont (name string ,style FontStyle ,font *_gb .PdfFont ){_bdb ._cef .Lock ();
if _bdb ._eeb [name ]==nil {_bdb ._eeb [name ]=map[FontStyle ]*_gb .PdfFont {};};_bdb ._eeb [name ][style ]=font ;_bdb ._cef .Unlock ();};const _afb =6.0;type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};func (_cbfg *Rectangle )scale (_eacc float64 ){_cbfg .Top *=_eacc ;
_cbfg .Bottom *=_eacc ;_cbfg .Left *=_eacc ;_cbfg .Right *=_eacc ;};func GetOpacityFromColorTransform (trs []*_abe .EG_ColorTransform )float64 {for _ ,_cgf :=range trs {if _cgf !=nil {if _ebac :=_cgf .ColorTransformChoice .Alpha ;_ebac !=nil {if _cdba :=_ebac .ValAttr .ST_PositiveFixedPercentageDecimal ;
_cdba !=nil {return float64 (*_cdba )/Percent100 ;};};};};return 1.0;};var _beag =_bfe (1.5);func _efd (_gdc uint8 ,_ced float64 )string {_bgd :=float64 (_gdc );var _cag float64 ;if _ced < 0{_cag =_bgd *(1+_ced );}else {_cag =_bgd +(255-_bgd )*_ced ;};
return _ff .Sprintf ("\u0025\u0030\u0032\u0078",int (_cag ));};func AdjustColor (colorStr string ,EG_ColorTransform []*_abe .EG_ColorTransform )string {for _ ,_gcdg :=range EG_ColorTransform {if _fda :=_gcdg .ColorTransformChoice .Tint ;_fda !=nil {if _gbd :=_fda .ValAttr .ST_PositiveFixedPercentageDecimal ;
_gbd !=nil {colorStr =AdjustColorByTint (colorStr ,1.0-float64 (*_gbd )/Percent100 );};};if _afe :=_gcdg .ColorTransformChoice .Shade ;_afe !=nil {if _cdeac :=_afe .ValAttr .ST_PositiveFixedPercentageDecimal ;_cdeac !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_cdeac )/Percent100 );
};};if _facg :=_gcdg .ColorTransformChoice .LumMod ;_facg !=nil {if _edbc :=_facg .ValAttr .ST_PercentageDecimal ;_edbc !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_edbc )/Percent100 );};};if _gga :=_gcdg .ColorTransformChoice .LumOff ;_gga !=nil {if _acf :=_gga .ValAttr .ST_PercentageDecimal ;
_acf !=nil {colorStr =AdjustColorByLumOff (colorStr ,float64 (*_acf )/Percent100 );};};};return colorStr ;};var _bdb =fontsMap {_cef :&_gg .Mutex {},_eeb :map[string ]map[FontStyle ]*_gb .PdfFont {}};func LoadFontFromFile (filename string )(*_gb .PdfFont ,error ){if !_bf .HasSuffix (filename ,"\u002e\u0074\u0074\u0066"){_bc .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return nil ,_ff .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_fcacg ,_aegb :=_gb .NewCompositePdfFontFromTTFFile (filename );if _aegb !=nil {return nil ,_aegb ;};return _fcacg ,nil ;};func CropImageByRect (sourceImg _a .Image ,rect _a .Rectangle )_a .Image {_fcbg ,_aeeae ,_gbed ,_dde :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;
_dcgc :=_a .NewNRGBA (_a .Rect (0,0,_gbed -_fcbg ,_dde -_aeeae ));for _cbcf :=_fcbg ;_cbcf < _gbed ;_cbcf ++{for _aagb :=_aeeae ;_aagb < _dde ;_aagb ++{_dcgc .Set (_cbcf -_fcbg ,_aagb -_aeeae ,sourceImg .At (_cbcf ,_aagb ));};};return _dcgc ;};var _ddce =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
func RegisterEmbeddedFonts (d *_ed .Document )error {_fbc :=d .FontTable ();if _fbc ==nil {return nil ;};for _ ,_ddca :=range _fbc .Font {if _ddca .EmbedRegular !=nil {return _bcfd (d ,_ddca .NameAttr ,_ddca .EmbedRegular .IdAttr ,_ddca .EmbedRegular .FontKeyAttr );
};if _ddca .EmbedBold !=nil {return _bcfd (d ,_ddca .NameAttr ,_ddca .EmbedBold .IdAttr ,_ddca .EmbedBold .FontKeyAttr );};if _ddca .EmbedItalic !=nil {return _bcfd (d ,_ddca .NameAttr ,_ddca .EmbedItalic .IdAttr ,_ddca .EmbedItalic .FontKeyAttr );};if _ddca .EmbedBoldItalic !=nil {return _bcfd (d ,_ddca .NameAttr ,_ddca .EmbedBoldItalic .IdAttr ,_ddca .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _gad ,_efa ,_eeab uint8 ;_gaecf ,_ :=_ff .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_gad ,&_efa ,&_eeab );if _gaecf !=3{return "";
};_abgf ,_fdab ,_egbc :=_bebda (_gad ,_efa ,_eeab );_egbc =lum *_egbc ;_gad ,_efa ,_eeab =_fdg (_abgf ,_fdab ,_egbc );return _ff .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_gad ,_efa ,_eeab );};func (_cfc *creatorContext )drawAxes (_ege []*_ad .CT_PlotAreaChoice1 ,_eaab ,_eecf ,_eac float64 ,_dabd []string ,_ecfa *Rectangle ,_dcf bool )error {_beda :=_cfc ._gcfga ;
_abb :=_cfc ._bfad ;if _ege ==nil {return _dd .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};var (_ddcga *_ad .CT_ValAx ;_afad *_ad .CT_CatAx ;_fea *_ad .CT_DateAx ;_eaabb *_ad .CT_SerAx ;
);for _ ,_ada :=range _ege {if _ada .ValAx !=nil {_ddcga =_ada .ValAx ;}else if _ada .CatAx !=nil {_afad =_ada .CatAx ;}else if _ada .DateAx !=nil {_fea =_ada .DateAx ;}else if _ada .SerAx !=nil {_eaabb =_ada .SerAx ;};};if _ddcga ==nil ||(_afad ==nil &&_fea ==nil &&_eaabb ==nil ){return _dd .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _gdbd ,_ceeg ,_eba ,_aef uint32 ;var _eeed ,_eff _ad .ST_AxPos ;var _bdad ,_aacf _ad .ST_TickMark ;var _edg ,_ccg *_ad .CT_ChartLines ;var _ecba ,_face _ad .ST_TickLblPos ;var _abc ,_gacb *_abe .CT_ShapeProperties ;var _cdbf error ;_fae :=_ecfa .Right -_ecfa .Left ;
_egf :=_ecfa .Bottom -_ecfa .Top ;if _ddcga !=nil {_ceeg ,_eff ,_aacf ,_face ,_ccg ,_aef ,_gacb ,_cdbf =_efge (_ddcga );};if _eff !=_ad .ST_AxPosL &&_eff !=_ad .ST_AxPosB {return _dd .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_bab :=_eecf -_eaab ;_dafg :=int (_bab /_eac )+1;var _bfdga ,_bbeb float64 ;switch _aacf {case _ad .ST_TickMarkIn :_bfdga ,_bbeb =_gbaee ,0;case _ad .ST_TickMarkOut :_bfdga ,_bbeb =0,_gbaee ;case _ad .ST_TickMarkCross :_bfdga ,_bbeb =_gbaee ,_gbaee ;
};_bfdga =_bfdga *_abb ;_bbeb =_bbeb *_abb ;var _adce *_abe .CT_ShapeProperties ;if _ccg !=nil {_adce =_ccg .SpPr ;};_dgda ,_aca :=_ecba !=_ad .ST_TickLblPosNone ,_face !=_ad .ST_TickLblPosNone ;_ffd :=_eaab ;if _afad !=nil {_gdbd ,_eeed ,_bdad ,_ecba ,_edg ,_eba ,_abc ,_cdbf =_egb (_afad );
}else if _fea !=nil {_gdbd ,_eeed ,_bdad ,_ecba ,_edg ,_eba ,_abc ,_cdbf =_bbd (_fea );}else if _eaabb !=nil {_gdbd ,_eeed ,_bdad ,_ecba ,_edg ,_eba ,_abc ,_cdbf =_ecfc (_eaabb );};if _cdbf !=nil {return _cdbf ;};if _eeed !=_ad .ST_AxPosL &&_eeed !=_ad .ST_AxPosB {return _dd .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _gdbd !=_aef ||_ceeg !=_eba {return _dd .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_dedf :=len (_dabd )+1;var _egc ,_bcfb float64 ;switch _bdad {case _ad .ST_TickMarkIn :_egc ,_bcfb =_gbaee ,0;
case _ad .ST_TickMarkOut :_egc ,_bcfb =0,_gbaee ;case _ad .ST_TickMarkCross :_egc ,_bcfb =_gbaee ,_gbaee ;};_egc =_egc *_abb ;_bcfb =_bcfb *_abb ;var _cfca *_abe .CT_ShapeProperties ;if _edg !=nil {_cfca =_edg .SpPr ;};if _dcf {_gde :=_egf /float64 (len (_dabd ));
_bbg :=_ecfa .Left -_eaab *_fae /_bab ;_dfc :=_bbg -_eaaa *_abb ;if _dgda {var _egcc float64 ;for _ebe :=0;_ebe < _dedf ;_ebe ++{_befd :=_ecfa .Bottom -float64 (_ebe )*_gde ;if _ebe < _dedf -1{_gbeb :=_beda .NewParagraph (_dabd [_ebe ]);_gbeb .SetFontSize (_afb *_abb );
_gbeb .SetPos (_dfc ,_befd -_gde /2-_beag *_abb );_beda .Draw (_gbeb );_dgdab :=(_gbeb .Width ()/1000-_eaaa )*_abb ;if _dgdab > 0&&_dgdab > _egcc {_egcc =_dgdab ;};};};if _egcc > 0{_ecfa .Left +=_egcc +_daf ;_bbg =_ecfa .Left -_eaab *_fae /_bab ;_fae =_ecfa .Right -_ecfa .Left ;
};};_fab :=_bbg -_bcfb ;_ebf :=_bbg +_egc ;_dfe :=_ecfa .Left ;_dfd :=_ecfa .Right ;for _ffdc :=0;_ffdc < _dedf ;_ffdc ++{_gdee :=_ecfa .Bottom -float64 (_ffdc )*_gde ;_cfc .drawLineWithProps (_abc ,_fab ,_gdee ,_ebf ,_gdee ,true );_cfc .drawLineWithProps (_cfca ,_dfe ,_gdee ,_dfd ,_gdee ,true );
};_bbgf :=_fae /_bab ;_ddgf :=_ecfa .Bottom -_bfdga ;_feab :=_ecfa .Bottom +_bbeb ;_aec :=_ecfa .Top ;_age :=_ecfa .Bottom ;for _fgcdf :=0;_fgcdf < _dafg ;_fgcdf ++{_fgd :=_ecfa .Left +(_ffd -_eaab )*_bbgf ;_cfc .drawLineWithProps (_gacb ,_fgd ,_ddgf ,_fgd ,_feab ,true );
_cfc .drawLineWithProps (_adce ,_fgd ,_aec ,_fgd ,_age ,true );if _aca {_cda :=_beda .NewParagraph (_e .FormatFloat (_ffd ,'g',-1,64));_cda .SetFontSize (_afb *_abb );_cda .SetPos (_fgd -_fcb *_abb ,_age +_ggf *_abb );_beda .Draw (_cda );};_ffd +=_eac ;
};}else {_gfbd :=_egf /_bab ;_dabb :=_ecfa .Left ;if _aca {var _gcf float64 ;for _ead :=0;_ead < _dafg ;_ead ++{_bdg :=_ecfa .Bottom -(_ffd -_eaab )*_gfbd ;_aaag :=_beda .NewParagraph (_e .FormatFloat (_ffd ,'g',-1,64));_aaag .SetFontSize (_afb *_abb );
_aaag .SetPos (_dabb -_eaaa *_abb ,_bdg -_beag *_abb );_beda .Draw (_aaag );_gcb :=(_aaag .Width ()/1000-_eaaa )*_abb ;if _gcb > 0&&_gcb > _gcf {_gcf =_gcb ;};_ffd +=_eac ;};if _gcf > 0{_ecfa .Left +=_gcf +_daf ;_fae =_ecfa .Right -_ecfa .Left ;};};_ffd =_eaab ;
_bggb :=_ecfa .Left -_bbeb ;_cdbg :=_ecfa .Left +_bfdga ;_dabb =_ecfa .Left ;_adac :=_ecfa .Right ;for _dag :=0;_dag < _dafg ;_dag ++{_bceb :=_ecfa .Bottom -(_ffd -_eaab )*_gfbd ;_cfc .drawLineWithProps (_gacb ,_bggb ,_bceb ,_cdbg ,_bceb ,true );_cfc .drawLineWithProps (_adce ,_dabb ,_bceb ,_adac ,_bceb ,true );
_ffd +=_eac ;};_eaea :=_fae /float64 (len (_dabd ));_cbf :=_ecfa .Bottom +_eaab *_egf /_bab ;_ebea :=_cbf -_egc ;_ffff :=_cbf +_bcfb ;_ged :=_ecfa .Top ;_beca :=_ecfa .Bottom ;_fag :=_cbf +_ggf *_abb ;for _cdeaa :=0;_cdeaa < _dedf ;_cdeaa ++{_fefe :=_ecfa .Left +float64 (_cdeaa )*_eaea ;
_cfc .drawLineWithProps (_abc ,_fefe ,_ebea ,_fefe ,_ffff ,true );_cfc .drawLineWithProps (_cfca ,_fefe ,_ged ,_fefe ,_beca ,true );if _dgda &&_cdeaa < _dedf -1{_gec :=_beda .NewParagraph (_dabd [_cdeaa ]);_gec .SetFontSize (_afb *_abb );_gec .SetPos (_fefe +_bedc *_abb ,_fag );
_beda .Draw (_gec );};};};return nil ;};var _daf =_bfe (2);func GetPageDimensions (size PageSize )_ga .PageSize {return _aedc [size ]};func (_cacf *creatorContext )drawRectangleWithProps (_baa *_abe .CT_ShapeProperties ,_aabg ,_ebef ,_fefd ,_gfddf float64 ,_fggd bool ){_fafg :=_cacf ._gcfga .NewRectangle (_aabg ,_ebef ,_fefd ,_gfddf );
if _baa ==nil {if _fggd {_fafg .SetBorderWidth (_fed );}else {return ;};}else {_daee :=_cacf .getPdfColorFromSolidFill (_baa .FillPropertiesChoice .SolidFill );if _daee !=nil {_fafg .SetFillColor (_daee );};if _faaa :=_baa .Ln ;_faaa !=nil {if _dac :=_faaa .WAttr ;
_dac !=nil {_ebeag :=_ffg .FromEMU (int64 (*_dac ));_fafg .SetBorderWidth (_ebeag );if _befdb :=_faaa .LineFillPropertiesChoice .SolidFill ;_befdb !=nil {_eadd :=_cacf .getPdfColorFromSolidFill (_befdb );if _eadd !=nil {_fafg .SetBorderColor (_eadd );};
};}else {_fafg .SetBorderWidth (0);};};};_cacf ._gcfga .Draw (_fafg );};var _ggf =_bfe (1.5);var _gcad =_bfe (1.5);func MakeImageFromChartSpace (cs *_ad .ChartSpace ,width ,height float64 ,theme *_abe .Theme ,workbook *_dfa .Workbook )(_a .Image ,error ){_dbfg ,_agb :=_dab (cs ,width ,height ,theme ,true ,workbook );
if _agb !=nil {return nil ,_agb ;};_dbgc ,_agb :=GetPageFromCreator (_dbfg );if _agb !=nil {return nil ,_agb ;};return _ae .NewImageDevice ().Render (_dbgc );};var RtlFontFile *_gb .PdfFont ;func GetRegisteredFont (name string ,style FontStyle )*_gb .PdfFont {_bdb ._cef .Lock ();
defer _bdb ._cef .Unlock ();if _bdd ,_fcac :=_bdb ._eeb [name ];_fcac {if _ggb ,_ebec :=_bdd [style ];_ebec {return _ggb ;};};return nil ;};func RegisterFontsFromFiles (files []string )error {for _ ,_ffaf :=range files {if _bf .HasSuffix (_ffaf ,"\u002e\u0074\u0074\u0066"){_bdab :=_eeg (_ffaf );
if _bdab !=nil {_bc .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_bdab );
continue ;};};};return nil ;};func (_cad *creatorContext )addCatName (_ccb string ,_gae map[string ]serCategory ,_bce *[]string ){if _ ,_fde :=_gae [_ccb ];!_fde {_gae [_ccb ]=serCategory {_dbfb :_ccb ,_gdab :[]serValue {}};*_bce =append (*_bce ,_ccb );
};};func (_bcg *creatorContext )drawAreaChart (_adb *_ad .CT_AreaChart ,_aea *Rectangle ,_cg []*_ad .CT_PlotAreaChoice1 ,_fe float64 )([]*legendItem ,error ){_adc :=[]*legendItem {};_ce :=_adb .Ser ;_gfac :=make (map[int ][]float64 );_ddf :=make (map[int ][]float64 );
_dc :=make (map[int ]_ga .Color );for _fg ,_abg :=range _ce {_dc [_fg ]=_ga .ColorWhite ;if _bg :=_abg .SpPr ;_bg !=nil {_da :=_bcg .getPdfColorFromSolidFill (_bg .FillPropertiesChoice .SolidFill );if _da !=nil {_dc [_fg ]=_da ;};};if _cgg :=_abg .Val ;
_cgg !=nil {if _dcb :=_cgg .NumDataSourceChoice ;_dcb !=nil {if _ea :=_dcb .NumRef ;_ea !=nil {if _cc :=_ea .NumCache ;_cc !=nil {for _ ,_be :=range _cc .Pt {_gfac [_fg ]=append (_gfac [_fg ],float64 (_be .IdxAttr ));_fdf ,_ :=_e .ParseFloat (_bf .TrimSpace (_be .V ),64);
_ddf [_fg ]=append (_ddf [_fg ],_fdf );};};};};};};_gaa :=true ;_dcg :="";_aba :="";if len (_cg )> 1{if _cg [0].ValAx !=nil &&_cg [1].ValAx !=nil {if _cg [0].ValAx .Delete !=nil &&_cg [1].ValAx .Delete !=nil {if !*(*_cg [0].ValAx .Delete ).ValAttr &&!*(*_cg [1].ValAx .Delete ).ValAttr {_gaa =false ;
};};_dcg =_bcg .getTitle (_cg [0].ValAx .Title );_aba =_bcg .getTitle (_cg [1].ValAx .Title );};};_cee :=_aeb .Style {Hidden :_gaa ,FontSize :8*_fe };_gfd :=&_eg .Chart {Series :[]_gfa .Series {},YAxisSecondary :_eg .YAxis {Style :_cee ,Name :_aba ,NameStyle :_cee },XAxis :_eg .XAxis {Style :_cee ,Name :_dcg ,NameStyle :_cee },YAxis :_eg .YAxis {Style :_aeb .Style {Hidden :true }}};
for _ee :=0;_ee < len (_dc );_ee ++{_gfb ,_ag ,_cf :=_dc [_ee ].ToRGB ();_egd :=_gfa .ContinuousSeries {XValues :_gfac [_ee ],YValues :_ddf [_ee ],Style :_aeb .Style {StrokeWidth :1,FillColor :_g .RGBA {uint8 (_gfb *255),uint8 (_ag *255),uint8 (_cf *255),255}}};
_gfd .Series =append (_gfd .Series ,_egd );};_gfd .SetHeight (int (_c .Abs (_aea .Top -_aea .Bottom )));_gfd .SetWidth (int (_c .Abs (_aea .Right -_aea .Left )));_ge :=_bcg ._gcfga ;_af :=_ga .NewChart (_gfd );_af .SetPos (_aea .Left ,_aea .Top );_dce :=_ge .Draw (_af );
if _dce !=nil {return nil ,_dce ;};return _adc ,nil ;};func _bfe (_gfef float64 )float64 {return _gfef *_ffg .Millimeter };func (_bggdg *creatorContext )drawLineChart (_bcgb *_ad .CT_LineChart ,_dea *Rectangle ,_ffc []*_ad .CT_PlotAreaChoice1 ,_bagb float64 )([]*legendItem ,error ){_ffbc :=[]*legendItem {};
_dbgg :=_bcgb .Ser ;_adbf :=make (map[int ][]float64 );_adgc :=make (map[int ][]float64 );_cebe :=make (map[int ]_ga .Color );_dbc :=make (map[int ]float64 );for _dead ,_dfbg :=range _dbgg {var _bdbd string ;if _cecd :=_dfbg .Tx ;_cecd !=nil {if _aegd :=_cecd .SerTxChoice ;
_aegd !=nil {if _aegd .V !=nil {_bdbd =*_aegd .V ;}else if _abcc :=_aegd .StrRef ;_abcc !=nil {if _ebaec :=_abcc .StrCache ;_ebaec !=nil {for _ ,_aacfe :=range _ebaec .Pt {_bdbd =_aacfe .V ;};};};};};_cebe [_dead ]=_ga .ColorWhite ;if _adga :=_dfbg .SpPr ;
_adga !=nil {if _fdbf :=_adga .Ln ;_fdbf !=nil {if _fgg :=_fdbf .WAttr ;_fgg !=nil {_dbc [_dead ]=_ffg .FromEMU (int64 (*_fgg ));if _bedb :=_fdbf .LineFillPropertiesChoice .SolidFill ;_bedb !=nil {_adgb :=_bggdg .getPdfColorFromSolidFill (_bedb );if _adgb !=nil {_cebe [_dead ]=_adgb ;
};};};};};if _fbgeb :=_dfbg .Val ;_fbgeb !=nil {if _bggg :=_fbgeb .NumDataSourceChoice ;_bggg !=nil {if _agg :=_bggg .NumRef ;_agg !=nil {if _fgf :=_agg .NumCache ;_fgf !=nil {for _ ,_aaf :=range _fgf .Pt {_adbf [_dead ]=append (_adbf [_dead ],float64 (_aaf .IdxAttr ));
_bagda ,_ :=_e .ParseFloat (_bf .TrimSpace (_aaf .V ),64);_adgc [_dead ]=append (_adgc [_dead ],_bagda );};};};};};_ffbc =append (_ffbc ,&legendItem {_fbge :_bdbd ,_gbfc :_dfbg .SpPr });};_cdc :=true ;_fga :=true ;_fdde :="";_effe :="";if len (_ffc )> 0{for _ ,_affb :=range _ffc {if _affb .CatAx !=nil {if _affb .CatAx .Delete !=nil {if !*(*_affb .CatAx .Delete ).ValAttr {_cdc =false ;
};};_fdde =_bggdg .getTitle (_affb .CatAx .Title );}else if _affb .ValAx !=nil {if _affb .ValAx .Delete !=nil {if !*(*_affb .ValAx .Delete ).ValAttr {_fga =false ;};};_effe =_bggdg .getTitle (_affb .ValAx .Title );};};};_cfa :=_aeb .Style {Hidden :_cdc ,FontSize :8*_bagb };
_dgag :=_aeb .Style {Hidden :_fga ,FontSize :8*_bagb };_aad :=&_eg .Chart {Series :[]_gfa .Series {},YAxisSecondary :_eg .YAxis {Style :_dgag ,Name :_effe ,NameStyle :_dgag },XAxis :_eg .XAxis {Style :_cfa ,Name :_fdde ,NameStyle :_cfa },YAxis :_eg .YAxis {Style :_aeb .Style {Hidden :true }}};
for _gabd :=0;_gabd < len (_cebe );_gabd ++{_ccgd ,_becd ,_cgb :=_cebe [_gabd ].ToRGB ();_edef :=_gfa .ContinuousSeries {XValues :_adbf [_gabd ],YValues :_adgc [_gabd ],Style :_aeb .Style {StrokeColor :_g .RGBA {uint8 (_ccgd *255),uint8 (_becd *255),uint8 (_cgb *255),255},StrokeWidth :_dbc [_gabd ]}};
_aad .Series =append (_aad .Series ,_edef );};_aad .SetHeight (int (_c .Abs (_dea .Top -_dea .Bottom )));_aad .SetWidth (int (_c .Abs (_dea .Right -_dea .Left )));_gbff :=_bggdg ._gcfga ;_gge :=_ga .NewChart (_aad );_gge .SetPos (_dea .Left ,_dea .Top );
_ccba :=_gbff .Draw (_gge );if _ccba !=nil {return nil ,_ccba ;};return _ffbc ,nil ;};func _ecfc (_gcfc *_ad .CT_SerAx )(uint32 ,_ad .ST_AxPos ,_ad .ST_TickMark ,_ad .ST_TickLblPos ,*_ad .CT_ChartLines ,uint32 ,*_abe .CT_ShapeProperties ,error ){var _fgcgf ,_gea uint32 ;
var _gggf _ad .ST_AxPos ;var _fce _ad .ST_TickMark ;var _acg *_ad .CT_ChartLines ;var _cbaee _ad .ST_TickLblPos ;if _gcfc .AxId ==nil {return _fgcgf ,_gggf ,_fce ,_cbaee ,_acg ,_gea ,_gcfc .SpPr ,_dd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_fgcgf =_gcfc .AxId .ValAttr ;};if _gcfc .AxPos ==nil {return _fgcgf ,_gggf ,_fce ,_cbaee ,_acg ,_gea ,_gcfc .SpPr ,_dd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_gggf =_gcfc .AxPos .ValAttr ;
};if _gcfc .MajorTickMark !=nil {_fce =_gcfc .MajorTickMark .ValAttr ;};if _gcfc .TickLblPos !=nil {_cbaee =_gcfc .TickLblPos .ValAttr ;};if _gcfc .CrossAx ==nil {return _fgcgf ,_gggf ,_fce ,_cbaee ,_acg ,_gea ,_gcfc .SpPr ,_dd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_gea =_gcfc .CrossAx .ValAttr ;};_acg =_gcfc .MajorGridlines ;return _fgcgf ,_gggf ,_fce ,_cbaee ,_acg ,_gea ,_gcfc .SpPr ,nil ;};func MakeTempCreatorMaxHeight (width float64 )*_ga .Creator {return MakeTempCreator (width ,MaxPageHeight );};func _egb (_ecd *_ad .CT_CatAx )(uint32 ,_ad .ST_AxPos ,_ad .ST_TickMark ,_ad .ST_TickLblPos ,*_ad .CT_ChartLines ,uint32 ,*_abe .CT_ShapeProperties ,error ){var _fcgd ,_dbga uint32 ;
var _eca _ad .ST_AxPos ;var _dcbg _ad .ST_TickMark ;var _dgea *_ad .CT_ChartLines ;var _bac _ad .ST_TickLblPos ;if _ecd .AxId ==nil {return _fcgd ,_eca ,_dcbg ,_bac ,_dgea ,_dbga ,_ecd .SpPr ,_dd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_fcgd =_ecd .AxId .ValAttr ;};if _ecd .AxPos ==nil {return _fcgd ,_eca ,_dcbg ,_bac ,_dgea ,_dbga ,_ecd .SpPr ,_dd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_eca =_ecd .AxPos .ValAttr ;
};if _ecd .MajorTickMark !=nil {_dcbg =_ecd .MajorTickMark .ValAttr ;};if _ecd .TickLblPos !=nil {_bac =_ecd .TickLblPos .ValAttr ;};if _ecd .CrossAx ==nil {return _fcgd ,_eca ,_dcbg ,_bac ,_dgea ,_dbga ,_ecd .SpPr ,_dd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_dbga =_ecd .CrossAx .ValAttr ;};_dgea =_ecd .MajorGridlines ;return _fcgd ,_eca ,_dcbg ,_bac ,_dgea ,_dbga ,_ecd .SpPr ,nil ;};var _fed =_bfe (0.125);func _cbc (_fca _abe .ST_SchemeColorVal ,_cce *_abe .Theme )string {if _fffb :=_cce .ThemeElements ;
_fffb !=nil {if _adg :=_fffb .ClrScheme ;_adg !=nil {switch _fca {case _abe .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_adg .Lt1 );case _abe .ST_SchemeColorValDk1 ,_abe .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_adg .Dk1 );
case _abe .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_adg .Lt2 );case _abe .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_adg .Dk2 );case _abe .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_adg .Accent1 );case _abe .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_adg .Accent2 );
case _abe .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_adg .Accent3 );case _abe .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_adg .Accent4 );case _abe .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_adg .Accent5 );
case _abe .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_adg .Accent6 );};};};return "";};func FillRectangle (c *_ga .Creator ,x ,y ,width ,height float64 ,color _ga .Color ){if color ==nil {return ;};_dbfeg :=c .NewRectangle (x ,y ,width ,height );
_dbfeg .SetFillColor (color );_dbfeg .SetBorderWidth (0);c .Draw (_dbfeg );};type creatorContext struct{_gcfga *_ga .Creator ;_cdee *_abe .Theme ;_bfad float64 ;};func _bbd (_caba *_ad .CT_DateAx )(uint32 ,_ad .ST_AxPos ,_ad .ST_TickMark ,_ad .ST_TickLblPos ,*_ad .CT_ChartLines ,uint32 ,*_abe .CT_ShapeProperties ,error ){var _adbd ,_fcc uint32 ;
var _ffa _ad .ST_AxPos ;var _cbbg _ad .ST_TickMark ;var _bebd *_ad .CT_ChartLines ;var _ffffb _ad .ST_TickLblPos ;if _caba .AxId ==nil {return _adbd ,_ffa ,_cbbg ,_ffffb ,_bebd ,_fcc ,_caba .SpPr ,_dd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_adbd =_caba .AxId .ValAttr ;};if _caba .AxPos ==nil {return _adbd ,_ffa ,_cbbg ,_ffffb ,_bebd ,_fcc ,_caba .SpPr ,_dd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ffa =_caba .AxPos .ValAttr ;
};if _caba .MajorTickMark !=nil {_cbbg =_caba .MajorTickMark .ValAttr ;};if _caba .TickLblPos !=nil {_ffffb =_caba .TickLblPos .ValAttr ;};if _caba .CrossAx ==nil {return _adbd ,_ffa ,_cbbg ,_ffffb ,_bebd ,_fcc ,_caba .SpPr ,_dd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_fcc =_caba .CrossAx .ValAttr ;};_bebd =_caba .MajorGridlines ;return _adbd ,_ffa ,_cbbg ,_ffffb ,_bebd ,_fcc ,_caba .SpPr ,nil ;};func RegisterFontsFromDirectory (dirName string )error {_cec ,_gdef :=_db .Open (dirName );if _gdef !=nil {return _gdef ;
};defer _cec .Close ();_cgab ,_gdef :=_cec .Readdirnames (0);if _gdef !=nil {return _gdef ;};for _ ,_adbcg :=range _cgab {if _bf .HasSuffix (_adbcg ,"\u002e\u0074\u0074\u0066"){_fgde :=dirName +"\u002f"+_adbcg ;_gcbb :=_eeg (_fgde );if _gcbb !=nil {_bc .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gcbb );
continue ;};};};return nil ;};func FromSTCoordinate32 (st _abe .ST_Coordinate32 )int64 {if _gada :=st .ST_Coordinate32Unqualified ;_gada !=nil {return int64 (*_gada );};return 0;};func MakeBlockFromChartSpace (cs *_ad .ChartSpace ,width ,height float64 ,theme *_abe .Theme )(*_ga .Block ,error ){_eab ,_fac :=_dab (cs ,width ,height ,theme ,false ,nil );
if _fac !=nil {return nil ,_fac ;};_afgg ,_fac :=GetPageFromCreator (_eab );if _fac !=nil {return nil ,_fac ;};_eee ,_fac :=_ga .NewBlockFromPage (_afgg );if _fac !=nil {return nil ,_fac ;};return _eee ,nil ;};func (_fccg *creatorContext )drawScatterChart (_fagg *_ad .CT_ScatterChart ,_acca *Rectangle ,_eaec []*_ad .CT_PlotAreaChoice1 ,_dfeb float64 )([]*legendItem ,error ){_ffbg :=[]*legendItem {};
_deebg :=_fagg .Ser ;_aeea :=make (map[string ]float64 );_effb :=make (map[string ][]float64 );_bdc :=make (map[string ][]float64 );_efc :=[]string {};for _ ,_cgfa :=range _deebg {var _bad string ;if _gdff :=_cgfa .Tx ;_gdff !=nil {if _dfdc :=_gdff .SerTxChoice ;
_dfdc !=nil {if _dfdc .V !=nil {_bad =*_dfdc .V ;}else if _dgb :=_dfdc .StrRef ;_dgb !=nil {if _fec :=_dgb .StrCache ;_fec !=nil {for _ ,_gadd :=range _fec .Pt {_bad =_gadd .V ;};};};_efc =append (_efc ,_bad );};};if _cgfa .Marker !=nil &&_cgfa .Marker .Size !=nil {_aeea [_bad ]=float64 (*_cgfa .Marker .Size .ValAttr );
}else {_aeea [_bad ]=-1.0;};if _fbaef :=_cgfa .XVal ;_fbaef !=nil {if _aaaa :=_fbaef .AxDataSourceChoice ;_aaaa !=nil {if _cada :=_aaaa .NumRef ;_cada !=nil {if _gdfb :=_cada .NumCache ;_gdfb !=nil {for _ ,_gfc :=range _gdfb .Pt {_bba ,_ :=_e .ParseFloat (_bf .TrimSpace (_gfc .V ),64);
_effb [_bad ]=append (_effb [_bad ],_bba );};};};};};if _ccda :=_cgfa .YVal ;_ccda !=nil {if _bafa :=_ccda .NumDataSourceChoice ;_bafa !=nil {if _fdgf :=_bafa .NumRef ;_fdgf !=nil {if _fbgd :=_fdgf .NumCache ;_fbgd !=nil {for _ ,_dfaf :=range _fbgd .Pt {_caea ,_ :=_e .ParseFloat (_bf .TrimSpace (_dfaf .V ),64);
_bdc [_bad ]=append (_bdc [_bad ],_caea );};};};};};};_ece :=true ;_fdaa :="";_edfe :="";if len (_eaec )> 1{if _eaec [0].ValAx .Delete !=nil &&_eaec [1].ValAx .Delete !=nil {if !*(*_eaec [0].ValAx .Delete ).ValAttr &&!*(*_eaec [1].ValAx .Delete ).ValAttr {_ece =false ;
};};_fdaa =_fccg .getTitle (_eaec [0].ValAx .Title );_edfe =_fccg .getTitle (_eaec [1].ValAx .Title );};_ccef :=_aeb .Style {Hidden :_ece ,FontSize :8*_dfeb };_ecgd :=&_eg .Chart {Series :[]_gfa .Series {},YAxisSecondary :_eg .YAxis {Style :_ccef ,Name :_edfe ,NameStyle :_ccef },XAxis :_eg .XAxis {Style :_ccef ,Name :_fdaa ,NameStyle :_ccef },YAxis :_eg .YAxis {Style :_aeb .Style {Hidden :true }}};
for _ ,_bgba :=range _efc {_ddda :=_gfa .ContinuousSeries {XValues :_effb [_bgba ],YValues :_bdc [_bgba ],Style :_aeb .Style {StrokeWidth :-1,DotWidth :_aeea [_bgba ]}};_ecgd .Series =append (_ecgd .Series ,_ddda );};_ecgd .SetHeight (int (_c .Abs (_acca .Top -_acca .Bottom )));
_ecgd .SetWidth (int (_c .Abs (_acca .Right -_acca .Left )));_ebeb :=_fccg ._gcfga ;_bddf :=_ga .NewChart (_ecgd );_bddf .SetPos (_acca .Left ,_acca .Top );_gfdd :=_ebeb .Draw (_bddf );if _gfdd !=nil {return nil ,_gfdd ;};return _ffbg ,nil ;};func TwipsFromPoints (points float64 )float64 {return points /_ffg .Twips };
func GetPageFromCreator (c *_ga .Creator )(*_gb .PdfPage ,error ){_ecdd :=_b .NewBuffer ([]byte {});_cafa :=c .Write (_ecdd );if _cafa !=nil {return nil ,_cafa ;};_fbbd :=_b .NewReader (_ecdd .Bytes ());_deec ,_cafa :=_gb .NewPdfReader (_fbbd );if _cafa !=nil {return nil ,_cafa ;
};return _deec .GetPage (1);};type BorderPosition byte ;func (_bfa *creatorContext )addCatValue (_gfbg string ,_dcc map[string ]serCategory ,_cbae []string ,_fffd int ,_fbg ,_bag *float64 ,_cff string ,_aae *_abe .CT_ShapeProperties ){_dbe ,_fgb :=_e .ParseFloat (_gfbg ,64);
if _fgb !=nil {_dbe =0;_bc .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_fgb );};if _dbe > *_bag {*_bag =_dbe ;};if _dbe < *_fbg {*_fbg =_dbe ;};_eef :=_dcc [_cbae [_fffd ]];_eef ._gdab =append (_eef ._gdab ,serValue {_gdabe :_cff ,_cfg :_dbe ,_fbgc :_aae });
_dcc [_cbae [_fffd ]]=_eef ;};func (_fba *creatorContext )getTitle (_eec *_ad .CT_Title )string {_cab :="";if _eec !=nil &&_eec .Tx !=nil &&_eec .Tx .TxChoice !=nil &&_eec .Tx .TxChoice .Rich !=nil {if len (_eec .Tx .TxChoice .Rich .P )> 0{for _ ,_agad :=range _eec .Tx .TxChoice .Rich .P {if len (_agad .EG_TextRun )> 0{_cab +="\u000a"+_agad .EG_TextRun [0].TextRunChoice .R .T ;
};};};};return _cab ;};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);func _aefb (_gbee uint8 ,_dcad float64 )string {_ccbc :=float64 (_gbee );
return _ff .Sprintf ("\u0025\u0030\u0032\u0078",int (_ccbc *_dcad ));};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func _faa (_efb _abe .ST_SchemeColorVal ,_aed *_abe .Theme )string {if _fccb :=_aed .ThemeElements ;_fccb !=nil {if _ceg :=_fccb .ClrScheme ;
_ceg !=nil {switch _efb {case _abe .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_ceg .Lt1 );case _abe .ST_SchemeColorValDk1 ,_abe .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_ceg .Dk1 );case _abe .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_ceg .Lt2 );
case _abe .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_ceg .Dk2 );case _abe .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_ceg .Accent1 );case _abe .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_ceg .Accent2 );
case _abe .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_ceg .Accent3 );case _abe .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_ceg .Accent4 );case _abe .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_ceg .Accent5 );
case _abe .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_ceg .Accent6 );};};};return "";};var _bedc =_bfe (5);func _gcgb (_adf float64 )float64 {if _adf < 0{_adf +=float64 (-int (_adf )+1);}else if _adf > 1{_adf -=float64 (int (_adf ));
};return _adf ;};type barSerByOrder []*_ad .CT_BarSer ;func (_cecf *Rectangle )Translate (x ,y float64 ){_cecf .Left +=x ;_cecf .Right +=x ;_cecf .Top +=y ;_cecf .Bottom +=y ;};func DrawLine (c *_ga .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _ga .Color ){if color ==nil {return ;
};_gdcb :=c .NewLine (x0 ,y0 ,x1 ,y1 );_gdcb .SetLineWidth (width );_gdcb .SetColor (color );c .Draw (_gdcb );};func GetGroupOffsetFromXfrm (xfrm *_abe .CT_GroupTransform2D )(float64 ,float64 ){var _egee ,_effef float64 ;if xfrm .Off !=nil &&xfrm .ChOff !=nil {_egee =_ffg .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_ffg .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));
_effef =_ffg .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_ffg .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));};return _egee ,_effef ;};func (_eggf *creatorContext )drawLineWithProps (_ggeb *_abe .CT_ShapeProperties ,_begfb ,_eagea ,_faad ,_fbab float64 ,_aacdb bool ){if _ggeb !=nil {if _bege :=_ggeb .Ln ;
_bege !=nil {_ddbce :=_eggf .getPdfColorFromSolidFill (_bege .LineFillPropertiesChoice .SolidFill );if _ddbce ==nil &&_aacdb {_ddbce =_ga .ColorBlack ;};if _ddbce !=nil {var _efgff float64 ;if _eaaf :=_bege .WAttr ;_eaaf !=nil {_efgff =_ffg .FromEMU (int64 (*_eaaf ));
}else {_efgff =_fed ;};DrawLine (_eggf ._gcfga ,_begfb ,_eagea ,_faad ,_fbab ,_efgff ,_ddbce );};};};};func GetDataFromXfrm (xfrm *_abe .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _faaag ,_dgbf ,_ebd ,_ebab float64 ;if _bbcg :=xfrm .Off ;
_bbcg !=nil {_faaag =_ffg .FromEMU (FromSTCoordinate (_bbcg .XAttr ));_dgbf =_ffg .FromEMU (FromSTCoordinate (_bbcg .YAttr ));};if _ffae :=xfrm .Ext ;_ffae !=nil {_ebd =_ffg .FromEMU (_ffae .CxAttr );_ebab =_ffg .FromEMU (_ffae .CyAttr );};return _faaag ,_dgbf ,_ebd ,_ebab ;
};func (_cde *creatorContext )drawLegend (_ecb *Rectangle ,_cfed []*legendItem ,_dee bool ){_gbae :=_cde ._bfad ;_ddgc :=_bfe (2.5)*_gbae ;_eded :=_gcad *_gbae ;_dedc :=(_ddgc -_eded )/2;_bcgc :=float64 (len (_cfed ));if _dee {_egaf :=&Rectangle {Top :_ecb .Top +_bfe (1)*_gbae ,Bottom :_ecb .Bottom -_bfe (1)*_gbae ,Left :_ecb .Left +_bfe (2.5)*_gbae ,Right :_ecb .Right -_bfe (2.5)*_gbae };
var _feb float64 ;if _bcgc > 1{_feb =(_egaf .Right -_egaf .Left )/_bcgc ;};_eaed :=_egaf .Left ;_cdea :=_egaf .Top ;for _ ,_ccc :=range _cfed {if _fbf :=_ccc ._gbfc ;_fbf !=nil {_cde .drawRectangleWithProps (_fbf ,_eaed ,_cdea +_dedc ,_eded ,_eded ,false );
_deg :=_eaed +_eded *2;_aab :=_cde ._gcfga .NewStyledParagraph ();_aab .SetPos (_deg ,_cdea );_gbc :=_aab .Append (_ccc ._fbge );_cbd ,_gaba :=_gb .NewStandard14Font (_gb .HelveticaName );if _gaba ==nil {_afaa :=_cde ._gcfga .NewTextStyle ();_afaa .Font =_cbd ;
_afaa .FontSize =_ddgc ;_afaa .TextRise =0.4;_gbc .Style =_afaa ;_cde ._gcfga .Draw (_aab );};};_eaed +=_feb ;};}else {_dcag :=&Rectangle {Top :_ecb .Top +_bfe (2.5)*_gbae ,Bottom :_ecb .Bottom -_bfe (2.5)*_gbae ,Left :_ecb .Left +_bfe (2.5)*_gbae ,Right :_ecb .Right -_bfe (2.5)*_gbae };
var _bagc float64 ;if _bcgc > 1{_bagc =(_dcag .Bottom -_dcag .Top -_ddgc )/(_bcgc -1);if _bagc < _ddgc {_bagc =_ddgc ;};};_dbfe :=_dcag .Top ;_fee :=_dcag .Left ;_fgcg :=_fee +_eded *2;for _ ,_bda :=range _cfed {if _gef :=_bda ._gbfc ;_gef !=nil {_cde .drawRectangleWithProps (_gef ,_fee ,_dbfe +_dedc ,_eded ,_eded ,false );
_bfda :=_cde ._gcfga .NewStyledParagraph ();_bfda .SetPos (_fgcg ,_dbfe );_bfda .SetWidth (_dcag .Right -_dcag .Left );_dega :=_bfda .Append (_bda ._fbge );_acd ,_cfge :=_gb .NewStandard14Font (_gb .HelveticaName );if _cfge ==nil {_fbaed :=_cde ._gcfga .NewTextStyle ();
_fbaed .Font =_acd ;_fbaed .FontSize =_ddgc ;_fbaed .TextRise =0.4;_dega .Style =_fbaed ;_cde ._gcfga .Draw (_bfda );};};_dbfe +=_bagc ;};};};var _eaaa =_bfe (7.5);type serCategory struct{_dbfb string ;_gdab []serValue ;};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func GetImage (c *_ga .Creator ,goImg _a .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_ga .Image ,error ){if goImg ==nil {return nil ,nil ;};_bge :=goImg .Bounds ().Size ();_aeagf :=_bge .X ;_fbgdf :=_bge .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_aeagf );
};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_fbgdf );};var _cdbe _a .Rectangle ;switch part {case ImgPart_t :_cdbe =_a .Rect (0,0,_aeagf ,int (dividerY ));case ImgPart_b :_cdbe =_a .Rect (0,int (dividerY ),_aeagf ,_fbgdf );case ImgPart_l :_cdbe =_a .Rect (0,0,int (dividerX ),_fbgdf );
case ImgPart_r :_cdbe =_a .Rect (int (dividerX ),0,_aeagf ,_fbgdf );case ImgPart_lt :_cdbe =_a .Rect (0,0,int (dividerX ),int (dividerY ));case ImgPart_rt :_cdbe =_a .Rect (int (dividerX ),0,_aeagf ,int (dividerY ));case ImgPart_lb :_cdbe =_a .Rect (0,int (dividerY ),int (dividerX ),_fbgdf );
case ImgPart_rb :_cdbe =_a .Rect (int (dividerX ),int (dividerY ),_aeagf ,_fbgdf );default:_cdbe =_a .Rect (0,0,_aeagf ,_fbgdf );};_cbca :=CropImageByRect (goImg ,_cdbe );_eccb ,_baba :=c .NewImageFromGoImage (_cbca );if _baba !=nil {return nil ,_baba ;
};_eccb .Scale (imgWidth /float64 (_aeagf ),imgHeight /float64 (_fbgdf ));_eccb .SetPos (left ,top );return _eccb ,nil ;};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_ffg .Twips *10+0.5))/10;};func AdjustColorByLumOff (colorStr string ,lumOff float64 )string {var _ccbd ,_cac ,_eaad uint8 ;
_feeg ,_ :=_ff .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_ccbd ,&_cac ,&_eaad );if _feeg !=3{return "";};_cadf ,_becac ,_eeabc :=_bebda (_ccbd ,_cac ,_eaad );_eeabc =_eeabc +lumOff ;_ccbd ,_cac ,_eaad =_fdg (_cadf ,_becac ,_eeabc );
return _ff .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_ccbd ,_cac ,_eaad );};func IsNoSpaceLanguage (symbol string )bool {for _ ,_cgad :=range symbol {if _gf .Is (_gf .Han ,_cgad ){return true ;};};return false ;};const (FontStyle_Regular FontStyle =0;
FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_dae FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_dae )];
};func GetDefaultPageSize ()_ga .PageSize {return _aedc [DefaultPageSize ]};func FromSTCoordinate (st _abe .ST_Coordinate )int64 {if _dfeba :=st .ST_CoordinateUnqualified ;_dfeba !=nil {return *_dfeba ;};return 0;};func (_eed *creatorContext )drawBorderWithProps (_dabf *_abe .CT_ShapeProperties ,_cebdf *Rectangle ,_fgccg float64 ){if _cebdf !=nil &&_dabf !=nil &&_dabf .Ln !=nil &&_dabf .Ln .LineFillPropertiesChoice .SolidFill !=nil {_gaf :=_eed .getPdfColorFromSolidFill (_dabf .Ln .LineFillPropertiesChoice .SolidFill );
DrawRectangle (_eed ._gcfga ,_cebdf ,_fgccg ,_gaf );};};func _bcfd (_cebd *_ed .Document ,_dccg ,_befa ,_cfea string )error {_ddbc ,_ddgb :=_cebd .GetFontBytesByRelId (_befa );if _ddgb !=nil {return _ddgb ;};_dedb ,_ddgb :=_dbb (_cfea );if _ddgb !=nil {return _ddgb ;
};for _begg :=0;_begg < 32;_begg ++{_gcfg :=_begg %len (_dedb );_ddbc [_begg ]=_ddbc [_begg ]^_dedb [_gcfg ];};_edf :=_cebd .TmpPath +"\u002f"+_dccg +"\u002e\u0074\u0074\u0066";_ddgb =_db .WriteFile (_edf ,_ddbc ,0644);if _ddgb !=nil {return _ddgb ;};_eeg (_edf );
return nil ;};func (_gacbg *creatorContext )getPdfColorFromSolidFill (_dfafg *_abe .CT_SolidColorFillProperties )_ga .Color {if _dfafg ==nil {return nil ;};_bbba :="";if _abaa :=_dfafg .SrgbClr ;_abaa !=nil {_bbba =_abaa .ValAttr ;}else if _caed :=_dfafg .SchemeClr ;
_caed !=nil {_bbba =_faa (_caed .ValAttr ,_gacbg ._cdee );_bbba =AdjustColor (_bbba ,_caed .EG_ColorTransform );};if _bbba ==""{return nil ;};return _ga .ColorRGBFromHex ("\u0023"+_bbba );};func (_fc *creatorContext )drawBarChart (_aa *_ad .CT_BarChart ,_eae *Rectangle ,_aga []*_ad .CT_PlotAreaChoice1 ,_ddc *_dfa .Workbook )([]*legendItem ,error ){var _agc bool ;
if _dad :=_aa .BarDir ;_dad !=nil {_agc =_dad .ValAttr ==_ad .ST_BarDirBar ;};_afc :=_aa .Ser ;_fd .Sort (barSerByOrder (_afc ));_abf :=map[string ]serCategory {};_aaa :=[]string {};_bfd :=[]*legendItem {};_ggg :=_c .Inf (1);_ef :=_c .Inf (-1);for _ ,_gba :=range _afc {var _bef string ;
if _ccf :=_gba .Tx ;_ccf !=nil {if _ggd :=_ccf .SerTxChoice ;_ggd !=nil {if _ggd .V !=nil {_bef =*_ggd .V ;}else if _efe :=_ggd .StrRef ;_efe !=nil {if _de :=_efe .StrCache ;_de !=nil {for _ ,_ddcg :=range _de .Pt {_bef =_ddcg .V ;};};};};};if _abeb :=_gba .Cat ;
_abeb !=nil {if _bb :=_abeb .AxDataSourceChoice ;_bb !=nil {if _gdb :=_bb .StrRef ;_gdb !=nil {if _dge :=_gdb .F ;_dge !=""&&_ddc !=nil {_gcd ,_bbe ,_bcf ,_cb :=ParseExcelRange (_dge );if _cb ==nil {for _ ,_fcg :=range _ddc .Sheets (){if _fcg .Name ()==_bf .Trim (_gcd ,"\u0027"){_dcd :=_bbe .String ();
for _bff :=_bbe .RowIdx ;_bff <=_bcf .RowIdx ;_bff +=1{_ddg :=_bf .ReplaceAll (_dcd ,_ff .Sprint (_bbe .RowIdx ),_ff .Sprint (_bff ));_fc .addCatName (_fcg .Cell (_ddg ).GetString (),_abf ,&_aaa );};break ;};};};};if _fff :=_gdb .StrCache ;_fff !=nil {for _ ,_deb :=range _fff .Pt {_fc .addCatName (_deb .V ,_abf ,&_aaa );
};};}else if _eea :=_bb .NumRef ;_eea !=nil {if _gfe :=_eea .NumCache ;_gfe !=nil {var _afg string ;if _gfe .FormatCode !=nil {_afg =*_gfe .FormatCode ;};for _ ,_abef :=range _gfe .Pt {var _dga string ;if _abef .FormatCodeAttr ==nil {_dga =_afg ;}else {_dga =*_abef .FormatCodeAttr ;
};var _fgc string ;_dbg ,_gca :=_e .ParseFloat (_abef .V ,64);if _gca !=nil {_fgc =_abef .V ;}else {_fgc =_gc .Number (_dbg ,_dga );};_fc .addCatName (_fgc ,_abf ,&_aaa );};};};};};if _aff :=_gba .Val ;_aff !=nil {if _fgcd :=_aff .NumDataSourceChoice ;
_fgcd !=nil {if _aac :=_fgcd .NumRef ;_aac !=nil {if _aeag :=_aac .F ;_aeag !=""&&_ddc !=nil {_dca ,_gac ,_aee ,_ba :=ParseExcelRange (_aeag );if _ba ==nil {for _ ,_edd :=range _ddc .Sheets (){if _edd .Name ()==_bf .Trim (_dca ,"\u0027"){_bgf :=_gac .String ();
for _bea :=_gac .RowIdx ;_bea <=_aee .RowIdx ;_bea +=1{_gee :=_bf .ReplaceAll (_bgf ,_ff .Sprint (_gac .RowIdx ),_ff .Sprint (_bea ));if _edd .FormulaContext ().HasFormula (_gee ){_gbad :=_gcc .NewEvaluator ();_bgg :=_edd .FormulaContext ().Cell (_gee ,_gbad );
_ecf :=_bgg .Value ();_fc .addCatValue (_ecf ,_abf ,_aaa ,(int )(_bea -_gac .RowIdx ),&_ggg ,&_ef ,_bef ,_gba .SpPr );}else {_bfdg :=_edd .Cell (_gee ).GetString ();_fc .addCatValue (_bfdg ,_abf ,_aaa ,(int )(_bea -_gac .RowIdx ),&_ggg ,&_ef ,_bef ,_gba .SpPr );
};};break ;};};};};if _fb :=_aac .NumCache ;_fb !=nil {for _gaac ,_dbf :=range _fb .Pt {_fc .addCatValue (_dbf .V ,_abf ,_aaa ,_gaac ,&_ggg ,&_ef ,_bef ,_gba .SpPr );};};};};};_bfd =append (_bfd ,&legendItem {_fbge :_bef ,_gbfc :_gba .SpPr });};var _bgfb float64 ;
var _aacd ,_beaf float64 ;if _ef ==0&&_ggg ==0{_bgfb =0.2;_beaf =0;_aacd =1;}else {var _bbc float64 ;if _bed :=_c .Abs (_ggg );_ef < _bed {_bbc =_bed ;}else {_bbc =_ef ;};_efg :=_c .Pow (10,_c .Floor (_c .Log10 (_bbc )));_bbed :=_bbc /_efg ;if _bbed < 4.29{_bgfb =0.5;
}else if _bbed >=4.29&&_bbed < 8.58{_bgfb =1;}else {_bgfb =2;};_bgfb *=_efg ;if _ef <=0{_aacd =0;}else {_aacd =(_c .Ceil (_ef /_bgfb )+1)*_bgfb ;};if _ggg >=0{_beaf =0;}else {_beaf =(_c .Floor (_ggg /_bgfb )-1)*_bgfb ;};};_bffc :=_fc .drawAxes (_aga ,_beaf ,_aacd ,_bgfb ,_aaa ,_eae ,_agc );
if _bffc !=nil {return nil ,_bffc ;};_ecc :=0.0;if _aa .GapWidth !=nil {if _ca :=_aa .GapWidth .ValAttr ;_ca !=nil {if _geb :=_ca .ST_GapAmountUShort ;_geb !=nil {_ecc =float64 (*_geb )/100.0;};};};_cfe :=_eae .Right -_eae .Left ;_afa :=_eae .Bottom -_eae .Top ;
_bga :=float64 (len (_aaa ));if _agc {_cd :=_aacd /(_aacd -_beaf )*_cfe ;_fbe :=-_beaf /(_aacd -_beaf )*_cfe ;_dgd :=_eae .Left +_fbe ;_dba :=_afa /_bga ;for _ega ,_eag :=range _aaa {_bggd :=_abf [_eag ];_ede :=float64 (len (_bggd ._gdab ))+_ecc ;_eaf :=_dba /_ede ;
_eage :=_eaf *_ecc ;_fffg :=_eae .Bottom -float64 (_ega )*_dba -_eage /2-_eaf ;for _ ,_dgdf :=range _bggd ._gdab {if _dgdf ._cfg ==0{continue ;};var _cba ,_gdd float64 ;if _dgdf ._cfg > 0{_gdd =_dgdf ._cfg /_aacd *_cd ;_fc .drawRectangleWithProps (_dgdf ._fbgc ,_dgd ,_fffg ,_gdd ,_eaf ,false );
}else {_gdd =_dgdf ._cfg /_beaf *_fbe ;_cba =_dgd -_gdd ;_fc .drawRectangleWithProps (_dgdf ._fbgc ,_cba ,_fffg ,_gdd ,_eaf ,false );};_fffg -=_eaf ;};};}else {_beg :=_aacd /(_aacd -_beaf )*_afa ;_dcbc :=-_beaf /(_aacd -_beaf )*_afa ;_ecg :=_eae .Top +_beg ;
_cfb :=_cfe /_bga ;for _cbb ,_gab :=range _aaa {_bfdf :=_abf [_gab ];_ddd :=float64 (len (_bfdf ._gdab ))+_ecc ;_cbg :=_cfb /_ddd ;_bd :=_cbg *_ecc ;_eb :=_eae .Left +float64 (_cbb )*_cfb +_bd /2;for _ ,_ddb :=range _bfdf ._gdab {var _cga ,_fad float64 ;
if _ddb ._cfg > 0{_fad =_ddb ._cfg /_aacd *_beg ;_cga =_ecg -_fad ;_fc .drawRectangleWithProps (_ddb ._fbgc ,_eb ,_cga ,_cbg ,_fad ,false );}else {_fad =_ddb ._cfg /_beaf *_dcbc ;_fc .drawRectangleWithProps (_ddb ._fbgc ,_eb ,_ecg ,_cbg ,_fad ,false );
};_eb +=_cbg ;};};};return _bfd ,nil ;};func MakeTempCreator (width ,height float64 )*_ga .Creator {_afcc :=_ga .New ();_afcc .SetPageSize (_ga .PageSize {width ,height });_afcc .SetPageMargins (0,0,0,0);return _afcc ;};var (DefaultFontSize =12.0;DefaultImageEncoder _df .StreamEncoder ;
DefaultPageSize =PageSizeA4 ;_aedc =map[PageSize ]_ga .PageSize {PageSizeA3 :_ga .PageSizeA3 ,PageSizeA4 :_ga .PageSizeA4 ,PageSizeA5 :_ga .PageSizeA5 ,PageSizeLetter :_ga .PageSizeLetter ,PageSizeLegal :_ga .PageSizeLegal };);func ClearRegisteredFonts (){_bdb ._cef .Lock ();
_bdb ._eeb =map[string ]map[FontStyle ]*_gb .PdfFont {};_bdb ._cef .Unlock ();};type fontsMap struct{_cef *_gg .Mutex ;_eeb map[string ]map[FontStyle ]*_gb .PdfFont ;};func (_fcad *creatorContext )drawPieChart (_afgd *_ad .CT_PieChart ,_fdeb *Rectangle ,_agdb *_dfa .Workbook ,_begf float64 )([]*legendItem ,error ){_aedb :=[]*legendItem {};
_adgg :=map[string ]serCategory {};_bcfg :=[]string {};_abgc :=_c .Inf (1);_baf :=_c .Inf (-1);_fegf :=_afgd .Ser ;for _ ,_gdcg :=range _fegf {var _cgfe string ;if _eadg :=_gdcg .Tx ;_eadg !=nil {if _bagbe :=_eadg .SerTxChoice ;_bagbe !=nil {if _bagbe .V !=nil {_cgfe =*_bagbe .V ;
}else if _eeae :=_bagbe .StrRef ;_eeae !=nil {if _ccbbc :=_eeae .StrCache ;_ccbbc !=nil {for _ ,_cbbdc :=range _ccbbc .Pt {_cgfe =_cbbdc .V ;};};};};};if _begd :=_gdcg .Cat ;_begd !=nil {if _ecae :=_begd .AxDataSourceChoice ;_ecae !=nil {if _gbcg :=_ecae .StrRef ;
_gbcg !=nil {if _gdec :=_gbcg .F ;_gdec !=""&&_agdb !=nil {_gccc ,_bggf ,_cgeb ,_fbb :=ParseExcelRange (_gdec );if _fbb ==nil {for _ ,_gdcff :=range _agdb .Sheets (){if _gdcff .Name ()==_bf .Trim (_gccc ,"\u0027"){_daea :=_bggf .String ();for _bdgg :=_bggf .RowIdx ;
_bdgg <=_cgeb .RowIdx ;_bdgg +=1{_cdag :=_bf .ReplaceAll (_daea ,_ff .Sprint (_bggf .RowIdx ),_ff .Sprint (_bdgg ));_fcad .addCatName (_gdcff .Cell (_cdag ).GetString (),_adgg ,&_bcfg );};break ;};};};};if _fgga :=_gbcg .StrCache ;_fgga !=nil {for _ ,_gefb :=range _fgga .Pt {_fcad .addCatName (_gefb .V ,_adgg ,&_bcfg );
};};}else if _bdggf :=_ecae .NumRef ;_bdggf !=nil {if _bfb :=_bdggf .NumCache ;_bfb !=nil {var _agbg string ;if _bfb .FormatCode !=nil {_agbg =*_bfb .FormatCode ;};for _ ,_egg :=range _bfb .Pt {var _ffbd string ;if _egg .FormatCodeAttr ==nil {_ffbd =_agbg ;
}else {_ffbd =*_egg .FormatCodeAttr ;};var _aaeg string ;_faea ,_acc :=_e .ParseFloat (_egg .V ,64);if _acc !=nil {_aaeg =_egg .V ;}else {_aaeg =_gc .Number (_faea ,_ffbd );};_fcad .addCatName (_aaeg ,_adgg ,&_bcfg );};};};};};if _efaa :=_gdcg .Val ;_efaa !=nil {if _cdg :=_efaa .NumDataSourceChoice ;
_cdg !=nil {if _eebb :=_cdg .NumRef ;_eebb !=nil {if _cecc :=_eebb .F ;_cecc !=""&&_agdb !=nil {_eggb ,_afbf ,_aade ,_dagc :=ParseExcelRange (_cecc );if _dagc ==nil {for _ ,_edc :=range _agdb .Sheets (){if _edc .Name ()==_bf .Trim (_eggb ,"\u0027"){_fcgdc :=_afbf .String ();
for _ddcgg :=_afbf .RowIdx ;_ddcgg <=_aade .RowIdx ;_ddcgg +=1{_fdebe :=_bf .ReplaceAll (_fcgdc ,_ff .Sprint (_afbf .RowIdx ),_ff .Sprint (_ddcgg ));if _edc .FormulaContext ().HasFormula (_fdebe ){_cffa :=_gcc .NewEvaluator ();_fgaa :=_edc .FormulaContext ().Cell (_fdebe ,_cffa );
_aegdd :=_fgaa .Value ();_fcad .addCatValue (_aegdd ,_adgg ,_bcfg ,(int )(_ddcgg -_afbf .RowIdx ),&_abgc ,&_baf ,_cgfe ,_gdcg .SpPr );}else {_gcae :=_edc .Cell (_fdebe ).GetString ();_fcad .addCatValue (_gcae ,_adgg ,_bcfg ,(int )(_ddcgg -_afbf .RowIdx ),&_abgc ,&_baf ,_cgfe ,_gdcg .SpPr );
};};break ;};};};};if _ffce :=_eebb .NumCache ;_ffce !=nil {for _feda ,_cfgg :=range _ffce .Pt {_fcad .addCatValue (_cfgg .V ,_adgg ,_bcfg ,_feda ,&_abgc ,&_baf ,_cgfe ,_gdcg .SpPr );};};};};};};_fdge :=&_eg .PieChart {Values :[]_gfa .Value {}};for _ ,_fefc :=range _bcfg {_debd :=_adgg [_fefc ];
if len (_debd ._gdab )> 0{_fdge .Values =append (_fdge .Values ,_gfa .Value {Value :_debd ._gdab [0]._cfg ,Label :_fefc ,Style :_aeb .Style {FontSize :12*_begf }});};};_fdge .SetHeight (int (_fdeb .Top -_fdeb .Bottom ));_fdge .SetWidth (int (_fdeb .Right -_fdeb .Left ));
_ggbd :=_fcad ._gcfga ;_agef :=_ga .NewChart (_fdge );_agef .SetPos (_fdeb .Left ,_fdeb .Top );_ddcgad :=_ggbd .Draw (_agef );if _ddcgad !=nil {return nil ,_ddcgad ;};return _aedb ,nil ;};type legendItem struct{_fbge string ;_gbfc *_abe .CT_ShapeProperties ;
};const (PageSizeA4 PageSize =iota ;PageSizeA3 ;PageSizeA5 ;PageSizeLetter ;PageSizeLegal ;Percent100 =100000.0;MaxPageHeight =11906;);func AssignStdFontByName (style _ga .TextStyle ,fontName string )*_gb .PdfFont {_babf :=_gb .StdFontName (fontName );
return _gb .NewStandard14FontMustCompile (_babf );};func AdjustColorByShade (colorStr string ,shade float64 )string {var _cfbd ,_cbaf ,_gccb uint8 ;_bbcc ,_ :=_ff .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_cfbd ,&_cbaf ,&_gccb );
if _bbcc !=3{return "";};return _aefb (_cfbd ,shade )+_aefb (_cbaf ,shade )+_aefb (_gccb ,shade );};func _dbfc (_fdc ,_fdd ,_ddga float64 )float64 {if _fdc *6< 1{return _ddga +(_fdd -_ddga )*6*_fdc ;}else if _fdc *2< 1{return _fdd ;}else if _fdc *3< 2{return _ddga +(_fdd -_ddga )*(2.0/3.0-_fdc )*6;
}else {return _ddga ;};};func _eeg (_ccd string )error {if !_bf .HasSuffix (_ccd ,"\u002e\u0074\u0074\u0066"){_bc .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _ff .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_bgab ,_gabc :=_ab .ParseFile (_ccd );if _gabc !=nil {_bc .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gabc );return _gabc ;};_cabg ,_gabc :=_gb .NewCompositePdfFontFromTTFFile (_ccd );
if _gabc !=nil {return _gabc ;};_dfga :=_bgab .GetNameRecords ();for _ ,_febc :=range _dfga {_dgga :=_febc [1];if _dgga ==""{continue ;};_bfcb :=make ([]byte ,0);for _afbd :=0;_afbd < len (_dgga );_afbd ++{if _dgga [_afbd ]==39||_dgga [_afbd ]==92{continue ;
};_ccac :=4;if _afbd +_ccac < len (_dgga ){if _dgga [_afbd :_afbd +_ccac ]=="\u0000"{_afbd =_afbd +_ccac +1;continue ;};};_bfcb =append (_bfcb ,_dgga [_afbd ]);};_dgga =_bf .Replace (string (_bfcb ),"\u0078\u0030\u0030","",-1);_ceba :=_febc [2];if _ceba ==""{return _ff .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_ccd );
};_bfcb =make ([]byte ,0);for _fdb :=0;_fdb < len (_ceba );_fdb ++{if _ceba [_fdb ]==39||_ceba [_fdb ]==92{continue ;};_ddgg :=4;if _fdb +_ddgg < len (_ceba ){if _ceba [_fdb :_fdb +_ddgg ]=="\u0000"{_fdb =_fdb +_ddgg +1;continue ;};};_bfcb =append (_bfcb ,_ceba [_fdb ]);
};_ceba =_bf .Replace (string (_bfcb ),"\u0078\u0030\u0030","",-1);RegisterFont (_dgga ,_ddce [_ceba ],_cabg );};return nil ;};func MakeBlockFromCreator (c *_ga .Creator )(*_ga .Block ,error ){_acag ,_ddbac :=GetPageFromCreator (c );if _ddbac !=nil {return nil ,_ddbac ;
};_ffbde ,_ddbac :=_ga .NewBlockFromPage (_acag );if _ddbac !=nil {return nil ,_ddbac ;};return _ffbde ,nil ;};func _bebda (_eabb ,_feeb ,_aace uint8 )(float64 ,float64 ,float64 ){_fbga ,_aeda ,_efgf :=float64 (_eabb )/255,float64 (_feeb )/255,float64 (_aace )/255;
_gaee :=_fbga ;if _aeda < _gaee {_gaee =_aeda ;};if _efgf < _gaee {_gaee =_efgf ;};var _dbd ,_ade bool ;_gecb :=_fbga ;if _aeda > _gecb {_gecb =_aeda ;_dbd =true ;};if _efgf > _gecb {_gecb =_efgf ;_dbd =false ;_ade =true ;};_bfde :=(_gaee +_gecb )/2;var _gdce float64 ;
if _gaee !=_gecb {if _bfde <=0.5{_gdce =(_gecb -_gaee )/(_gecb +_gaee );}else {_gdce =(_gecb -_gaee )/(2.0-_gecb -_gaee );};};var _deda float64 ;if _gaee !=_gecb {if _dbd {_deda =2.0+(_efgf -_fbga )/(_gecb -_gaee );}else if _ade {_deda =4.0+(_fbga -_aeda )/(_gecb -_gaee );
}else {_deda =(_aeda -_efgf )/(_gecb -_gaee );};_deda *=60;if _deda < 0{_deda +=360;};};return _deda ,_gdce ,_bfde ;};