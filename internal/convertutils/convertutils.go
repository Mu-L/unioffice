//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_c "bytes";_gf "errors";_d "fmt";_cd "github.com/unidoc/unichart";_cf "github.com/unidoc/unichart/dataset";_bc "github.com/unidoc/unichart/render";_bdg "github.com/unidoc/unioffice/v2/common/logger";_de "github.com/unidoc/unioffice/v2/document";
_ab "github.com/unidoc/unioffice/v2/measurement";_ga "github.com/unidoc/unioffice/v2/schema/soo/dml";_df "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_gg "github.com/unidoc/unioffice/v2/spreadsheet";_eef "github.com/unidoc/unioffice/v2/spreadsheet/format";
_fe "github.com/unidoc/unioffice/v2/spreadsheet/formula";_ea "github.com/unidoc/unioffice/v2/spreadsheet/reference";_cc "github.com/unidoc/unipdf/v3/core";_fbf "github.com/unidoc/unipdf/v3/creator";_fbfd "github.com/unidoc/unipdf/v3/model";_bd "github.com/unidoc/unipdf/v3/render";
_b "github.com/unidoc/unitype";_g "image";_f "image/color";_ee "math";_fb "os";_fd "regexp";_ge "sort";_eg "strconv";_ec "strings";_ae "sync";_e "unicode";);type PageSize int ;func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _ecda ,_gef ,_egdf uint8 ;
_gbgf ,_ :=_d .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_ecda ,&_gef ,&_egdf );if _gbgf !=3{return "";};_eaebb ,_fegcb ,_fagc :=_gecc (_ecda ,_gef ,_egdf );_fagc =lum *_fagc ;_ecda ,_gef ,_egdf =_dec (_eaebb ,_fegcb ,_fagc );
return _d .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_ecda ,_gef ,_egdf );};func AdjustColorByTint (colorStr string ,tint float64 )string {var _gga ,_addb ,_ecfc uint8 ;_afad ,_ :=_d .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_gga ,&_addb ,&_ecfc );
if _afad !=3{return "";};return _ecd (_gga ,tint )+_ecd (_addb ,tint )+_ecd (_ecfc ,tint );};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_ab .Twips *10+0.5))/10;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;
FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;
);func (_ac *creatorContext )drawBarChart (_bfc *_df .CT_BarChart ,_afb *Rectangle ,_acf []*_df .CT_PlotAreaChoice1 ,_gfa *_gg .Workbook )([]*legendItem ,error ){var _gae bool ;if _fef :=_bfc .BarDir ;_fef !=nil {_gae =_fef .ValAttr ==_df .ST_BarDirBar ;
};_deb :=_bfc .Ser ;_ge .Sort (barSerByOrder (_deb ));_gagf :=map[string ]serCategory {};_fc :=[]string {};_ged :=[]*legendItem {};_ad :=_ee .Inf (1);_eag :=_ee .Inf (-1);for _ ,_ddb :=range _deb {var _cgc string ;if _cda :=_ddb .Tx ;_cda !=nil {if _bbdb :=_cda .SerTxChoice ;
_bbdb !=nil {if _bbdb .V !=nil {_cgc =*_bbdb .V ;}else if _cgf :=_bbdb .StrRef ;_cgf !=nil {if _ba :=_cgf .StrCache ;_ba !=nil {for _ ,_affe :=range _ba .Pt {_cgc =_affe .V ;};};};};};if _eae :=_ddb .Cat ;_eae !=nil {if _eb :=_eae .AxDataSourceChoice ;
_eb !=nil {if _gdc :=_eb .StrRef ;_gdc !=nil {if _ag :=_gdc .F ;_ag !=""&&_gfa !=nil {_abfc ,_add ,_bgc ,_ede :=ParseExcelRange (_ag );if _ede ==nil {for _ ,_baa :=range _gfa .Sheets (){if _baa .Name ()==_ec .Trim (_abfc ,"\u0027"){_gdg :=_add .String ();
for _bgb :=_add .RowIdx ;_bgb <=_bgc .RowIdx ;_bgb +=1{_bad :=_ec .ReplaceAll (_gdg ,_d .Sprint (_add .RowIdx ),_d .Sprint (_bgb ));_ac .addCatName (_baa .Cell (_bad ).GetString (),_gagf ,&_fc );};break ;};};};};if _ccf :=_gdc .StrCache ;_ccf !=nil {for _ ,_dcd :=range _ccf .Pt {_ac .addCatName (_dcd .V ,_gagf ,&_fc );
};};}else if _ced :=_eb .NumRef ;_ced !=nil {if _fea :=_ced .NumCache ;_fea !=nil {var _cff string ;if _fea .FormatCode !=nil {_cff =*_fea .FormatCode ;};for _ ,_gaef :=range _fea .Pt {var _ege string ;if _gaef .FormatCodeAttr ==nil {_ege =_cff ;}else {_ege =*_gaef .FormatCodeAttr ;
};var _cfd string ;_fdf ,_ecb :=_eg .ParseFloat (_gaef .V ,64);if _ecb !=nil {_cfd =_gaef .V ;}else {_cfd =_eef .Number (_fdf ,_ege );};_ac .addCatName (_cfd ,_gagf ,&_fc );};};};};};if _abeg :=_ddb .Val ;_abeg !=nil {if _bbc :=_abeg .NumDataSourceChoice ;
_bbc !=nil {if _gde :=_bbc .NumRef ;_gde !=nil {if _bab :=_gde .F ;_bab !=""&&_gfa !=nil {_bed ,_agd ,_fcb ,_cdgb :=ParseExcelRange (_bab );if _cdgb ==nil {for _ ,_ecf :=range _gfa .Sheets (){if _ecf .Name ()==_ec .Trim (_bed ,"\u0027"){_bcb :=_agd .String ();
for _dbg :=_agd .RowIdx ;_dbg <=_fcb .RowIdx ;_dbg +=1{_cee :=_ec .ReplaceAll (_bcb ,_d .Sprint (_agd .RowIdx ),_d .Sprint (_dbg ));if _ecf .FormulaContext ().HasFormula (_cee ){_bfb :=_fe .NewEvaluator ();_ddg :=_ecf .FormulaContext ().Cell (_cee ,_bfb );
_bfce :=_ddg .Value ();_ac .addCatValue (_bfce ,_gagf ,_fc ,(int )(_dbg -_agd .RowIdx ),&_ad ,&_eag ,_cgc ,_ddb .SpPr );}else {_bbe :=_ecf .Cell (_cee ).GetString ();_ac .addCatValue (_bbe ,_gagf ,_fc ,(int )(_dbg -_agd .RowIdx ),&_ad ,&_eag ,_cgc ,_ddb .SpPr );
};};break ;};};};};if _ddd :=_gde .NumCache ;_ddd !=nil {for _beb ,_eff :=range _ddd .Pt {_ac .addCatValue (_eff .V ,_gagf ,_fc ,_beb ,&_ad ,&_eag ,_cgc ,_ddb .SpPr );};};};};};_ged =append (_ged ,&legendItem {_agce :_cgc ,_caf :_ddb .SpPr });};var _gc float64 ;
var _agc ,_cb float64 ;if _eag ==0&&_ad ==0{_gc =0.2;_cb =0;_agc =1;}else {var _bdb float64 ;if _dbc :=_ee .Abs (_ad );_eag < _dbc {_bdb =_dbc ;}else {_bdb =_eag ;};_gec :=_ee .Pow (10,_ee .Floor (_ee .Log10 (_bdb )));_acg :=_bdb /_gec ;if _acg < 4.29{_gc =0.5;
}else if _acg >=4.29&&_acg < 8.58{_gc =1;}else {_gc =2;};_gc *=_gec ;if _eag <=0{_agc =0;}else {_agc =(_ee .Ceil (_eag /_gc )+1)*_gc ;};if _ad >=0{_cb =0;}else {_cb =(_ee .Floor (_ad /_gc )-1)*_gc ;};};_abff :=_ac .drawAxes (_acf ,_cb ,_agc ,_gc ,_fc ,_afb ,_gae );
if _abff !=nil {return nil ,_abff ;};_bgba :=0.0;if _bfc .GapWidth !=nil {if _agdb :=_bfc .GapWidth .ValAttr ;_agdb !=nil {if _eaa :=_agdb .ST_GapAmountUShort ;_eaa !=nil {_bgba =float64 (*_eaa )/100.0;};};};_fce :=_afb .Right -_afb .Left ;_dg :=_afb .Bottom -_afb .Top ;
_ddbe :=float64 (len (_fc ));if _gae {_bbf :=_agc /(_agc -_cb )*_fce ;_ff :=-_cb /(_agc -_cb )*_fce ;_def :=_afb .Left +_ff ;_gada :=_dg /_ddbe ;for _egec ,_gbg :=range _fc {_bef :=_gagf [_gbg ];_dab :=float64 (len (_bef ._dcf ))+_bgba ;_ead :=_gada /_dab ;
_bdf :=_ead *_bgba ;_eed :=_afb .Bottom -float64 (_egec )*_gada -_bdf /2-_ead ;for _ ,_afga :=range _bef ._dcf {if _afga ._bcc ==0{continue ;};var _aa ,_baf float64 ;if _afga ._bcc > 0{_baf =_afga ._bcc /_agc *_bbf ;_ac .drawRectangleWithProps (_afga ._cec ,_def ,_eed ,_baf ,_ead ,false );
}else {_baf =_afga ._bcc /_cb *_ff ;_aa =_def -_baf ;_ac .drawRectangleWithProps (_afga ._cec ,_aa ,_eed ,_baf ,_ead ,false );};_eed -=_ead ;};};}else {_cedf :=_agc /(_agc -_cb )*_dg ;_gfac :=-_cb /(_agc -_cb )*_dg ;_aac :=_afb .Top +_cedf ;_cdf :=_fce /_ddbe ;
for _agcc ,_fde :=range _fc {_ebgc :=_gagf [_fde ];_fecd :=float64 (len (_ebgc ._dcf ))+_bgba ;_edd :=_cdf /_fecd ;_eea :=_edd *_bgba ;_feg :=_afb .Left +float64 (_agcc )*_cdf +_eea /2;for _ ,_ddbc :=range _ebgc ._dcf {var _bedg ,_cga float64 ;if _ddbc ._bcc > 0{_cga =_ddbc ._bcc /_agc *_cedf ;
_bedg =_aac -_cga ;_ac .drawRectangleWithProps (_ddbc ._cec ,_feg ,_bedg ,_edd ,_cga ,false );}else {_cga =_ddbc ._bcc /_cb *_gfac ;_ac .drawRectangleWithProps (_ddbc ._cec ,_feg ,_aac ,_edd ,_cga ,false );};_feg +=_edd ;};};};return _ged ,nil ;};func (_cfc FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_cfc )];
};type fontsMap struct{_gbac *_ae .Mutex ;_ebgcd map[string ]map[FontStyle ]*_fbfd .PdfFont ;};func _dec (_cgd ,_dfd ,_cdgg float64 )(uint8 ,uint8 ,uint8 ){var _cdgbf float64 ;if _cdgg < 0.5{_cdgbf =_cdgg *(1+_dfd );}else {_cdgbf =_cdgg +_dfd -_cdgg *_dfd ;
};_aef :=_cdgg *2-_cdgbf ;_cgd /=360.0;_bddfc :=_bffa (_cgd +1.0/3.0);_cfdf :=_bffa (_cgd );_cef :=_bffa (_cgd -1.0/3.0);_gebg :=_beda (_bddfc ,_cdgbf ,_aef );_egeba :=_beda (_cfdf ,_cdgbf ,_aef );_bfae :=_beda (_cef ,_cdgbf ,_aef );return uint8 (255*_gebg ),uint8 (255*_egeba ),uint8 (255*_bfae );
};var _efg =_fdae (1.5);type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};var (DefaultFontSize =12.0;DefaultImageEncoder _cc .StreamEncoder ;DefaultPageSize =PageSizeA4 ;_bgbg =map[PageSize ]_fbf .PageSize {PageSizeA3 :_fbf .PageSizeA3 ,PageSizeA4 :_fbf .PageSizeA4 ,PageSizeA5 :_fbf .PageSizeA5 ,PageSizeLetter :_fbf .PageSizeLetter ,PageSizeLegal :_fbf .PageSizeLegal };
);func (_bge *creatorContext )addCatName (_dgf string ,_fcbb map[string ]serCategory ,_cgfd *[]string ){if _ ,_adc :=_fcbb [_dgf ];!_adc {_fcbb [_dgf ]=serCategory {_efe :_dgf ,_dcf :[]serValue {}};*_cgfd =append (*_cgfd ,_dgf );};};func _caff (_dea *_df .ChartSpace ,_ddga ,_cca float64 ,_cafc *_ga .Theme ,_dfg bool ,_gded *_gg .Workbook )(*_fbf .Creator ,error ){_baaf :=1.0;
if _dfg {_baaf =8.0;};_bag :=&Rectangle {};_fdfe :=&Rectangle {Top :_bag .Top ,Bottom :_cca -_bag .Bottom ,Left :_bag .Left ,Right :_ddga -_bag .Right };_bcf :=MakeTempCreator (_ddga *_baaf +1,_cca *_baaf +1);_ebgg :=&creatorContext {_bfd :_bcf ,_fgd :_cafc ,_fed :_baaf };
var _bgg bool ;if _fdd :=_dea .Chart ;_fdd !=nil {_ebe :=_fdd .PlotArea ;if _ebe ==nil {return nil ,_gf .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_edde :=0.0;if _fdd .AutoTitleDeleted !=nil &&_fdd .AutoTitleDeleted .ValAttr !=nil &&!*_fdd .AutoTitleDeleted .ValAttr {if _fdd .Title !=nil &&_fdd .Title .Overlay !=nil &&_fdd .Title .Overlay .ValAttr !=nil &&!*_fdd .Title .Overlay .ValAttr {_edde =_fdae (10);
};_cce :=_ebgg .getTitle (_fdd .Title );if _cce ==""{_cce ="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";};_ebgg .drawTitle (_cce ,_fdfe .Left +_fdfe .Right /2,_fdae (5));};_fbe :=&Rectangle {Top :_fdae (10)+_edde ,Bottom :_fdfe .Bottom -_fdae (15),Left :_fdae (10),Right :_fdfe .Right -_fdae (10)};
var _aab *Rectangle ;_eab :=_fdd .Legend ;if _eab !=nil {_gbc :=_eab .Overlay !=nil &&_eab .Overlay .ValAttr !=nil &&*_eab .Overlay .ValAttr ;if _agca :=_eab .LegendPos ;_agca !=nil {switch _agca .ValAttr {case _df .ST_LegendPosTr :if !_gbc {_fbe =&Rectangle {Top :_fdae (25)+_edde ,Bottom :_fdfe .Bottom -_fdae (10),Left :_fdae (10),Right :_fdfe .Right -_fdae (25)};
};_aab =&Rectangle {Top :_fdae (2.5)+_edde ,Bottom :_fdae (22.5),Left :_fdfe .Right -_fdae (22.5),Right :_fdfe .Right -_fdae (2.5)};case _df .ST_LegendPosT :_aab =&Rectangle {Top :_fdae (2.5)+_edde ,Bottom :_fdae (7.5),Left :(_fdfe .Right -_fdfe .Left )*0.25,Right :(_fdfe .Right -_fdfe .Left )*0.75};
if !_gbc {_fbe =&Rectangle {Top :_fdae (12.5)+_edde ,Bottom :_fdfe .Bottom -_fdae (15),Left :_fdae (10),Right :_fdfe .Right -_fdae (5)};};_bgg =true ;case _df .ST_LegendPosB :_aab =&Rectangle {Top :_fdfe .Bottom -_fdae (7.5)+_edde ,Bottom :_fdfe .Bottom -_fdae (2.5),Left :(_fdfe .Right -_fdfe .Left )*0.25,Right :(_fdfe .Right -_fdfe .Left )*0.75};
if !_gbc {_fbe =&Rectangle {Top :_fdae (5)+_edde ,Bottom :_fdfe .Bottom -_fdae (15),Left :_fdae (10),Right :_fdfe .Right -_fdae (5)};};_bgg =true ;case _df .ST_LegendPosR :_aab =&Rectangle {Top :(_fdfe .Bottom -_fdfe .Top )/2-_fdae (10)+_edde ,Bottom :(_fdfe .Bottom -_fdfe .Top )/2+_fdae (10),Left :_fdfe .Right -_fdae (22.5),Right :_fdfe .Right -_fdae (2.5)};
if !_gbc {_fbe =&Rectangle {Top :_fdae (5)+_edde ,Bottom :_fdfe .Bottom -_fdae (12.5),Left :_fdae (10),Right :_fdfe .Right -_fdae (25)};};case _df .ST_LegendPosL :_aab =&Rectangle {Top :(_fdfe .Bottom -_fdfe .Top )/2-_fdae (10)+_edde ,Bottom :(_fdfe .Bottom -_fdfe .Top )/2+_fdae (10),Left :_fdae (2.5),Right :_fdae (22.5)};
if !_gbc {_fbe =&Rectangle {Top :_fdae (5)+_edde ,Bottom :_fdfe .Bottom -_fdae (12.5),Left :_fdae (30),Right :_fdfe .Right -_fdae (5)};};default:_aab =&Rectangle {Top :(_fdfe .Bottom -_fdfe .Top )/2-_fdae (10)+_edde ,Bottom :(_fdfe .Bottom -_fdfe .Top )/2+_fdae (10),Left :_fdfe .Right -_fdae (25),Right :_fdfe .Right -_fdae (5)};
if !_gbc {_fbe =&Rectangle {Top :_fdae (5)+_edde ,Bottom :_fdfe .Bottom -_fdae (12.5),Left :_fdae (100),Right :_fdfe .Right -_fdae (25)};};};};};_fbe .scale (_baaf );_ebgg .drawBorderWithProps (_ebe .SpPr ,_fbe ,_eeag );_aee :=[]*legendItem {};var _ggf error ;
_abgd :=_ebe .PlotAreaChoice1 ;for _ ,_acfg :=range _ebe .PlotAreaChoice {if _beg :=_acfg .BarChart ;_beg !=nil {_aee ,_ggf =_ebgg .drawBarChart (_beg ,_fbe ,_abgd ,_gded );if _ggf !=nil {return nil ,_ggf ;};break ;};if _gbd :=_acfg .PieChart ;_gbd !=nil {_aee ,_ggf =_ebgg .drawPieChart (_gbd ,_fbe ,_gded ,_baaf );
if _ggf !=nil {return nil ,_ggf ;};break ;};if _ccaf :=_acfg .ScatterChart ;_ccaf !=nil {_aee ,_ggf =_ebgg .drawScatterChart (_ccaf ,_fbe ,_abgd ,_baaf );if _ggf !=nil {return nil ,_ggf ;};break ;};if _bgf :=_acfg .LineChart ;_bgf !=nil {_aee ,_ggf =_ebgg .drawLineChart (_bgf ,_fbe ,_abgd ,_baaf );
if _ggf !=nil {return nil ,_ggf ;};break ;};if _dac :=_acfg .AreaChart ;_dac !=nil {_aee ,_ggf =_ebgg .drawAreaChart (_dac ,_fbe ,_abgd ,_baaf );if _ggf !=nil {return nil ,_ggf ;};break ;};};if _eab !=nil {_aab .scale (_baaf );_ebgg .drawBorderWithProps (_eab .SpPr ,_aab ,_eeag );
if len (_aee )!=0{_ebgg .drawLegend (_aab ,_aee ,_bgg );};};};_fdfe .scale (_baaf );_ebgg .drawBorderWithProps (_dea .SpPr ,_fdfe ,_eeag );return _bcf ,nil ;};type BorderPosition byte ;func _bffa (_bea float64 )float64 {if _bea < 0{_bea +=float64 (-int (_bea )+1);
}else if _bea > 1{_bea -=float64 (int (_bea ));};return _bea ;};type FontStyle byte ;func GetOpacityFromColorTransform (trs []*_ga .EG_ColorTransform )float64 {for _ ,_cgfdf :=range trs {if _cgfdf !=nil {if _ecfb :=_cgfdf .ColorTransformChoice .Alpha ;
_ecfb !=nil {if _gadb :=_ecfb .ValAttr .ST_PositiveFixedPercentageDecimal ;_gadb !=nil {return float64 (*_gadb )/Percent100 ;};};};};return 1.0;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func MakeBlockFromChartSpace (cs *_df .ChartSpace ,width ,height float64 ,theme *_ga .Theme )(*_fbf .Block ,error ){_dcfc ,_fbd :=_caff (cs ,width ,height ,theme ,false ,nil );
if _fbd !=nil {return nil ,_fbd ;};_dfe ,_fbd :=GetPageFromCreator (_dcfc );if _fbd !=nil {return nil ,_fbd ;};_ccc ,_fbd :=_fbf .NewBlockFromPage (_dfe );if _fbd !=nil {return nil ,_fbd ;};return _ccc ,nil ;};func GetDefaultPageSize ()_fbf .PageSize {return _bgbg [DefaultPageSize ]};
func (_faa barSerByOrder )Swap (i ,j int ){_faa [i ],_faa [j ]=_faa [j ],_faa [i ]};func _bdbg (_egeb *_df .CT_ValAx )(uint32 ,_df .ST_AxPos ,_df .ST_TickMark ,_df .ST_TickLblPos ,*_df .CT_ChartLines ,uint32 ,*_ga .CT_ShapeProperties ,error ){var _gaeg ,_ddgf uint32 ;
var _fad _df .ST_AxPos ;var _gdae _df .ST_TickMark ;var _gdef *_df .CT_ChartLines ;var _bbeg _df .ST_TickLblPos ;if _egeb .AxId ==nil {return _gaeg ,_fad ,_gdae ,_bbeg ,_gdef ,_ddgf ,_egeb .SpPr ,_gf .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_gaeg =_egeb .AxId .ValAttr ;};if _egeb .AxPos ==nil {return _gaeg ,_fad ,_gdae ,_bbeg ,_gdef ,_ddgf ,_egeb .SpPr ,_gf .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_fad =_egeb .AxPos .ValAttr ;
};if _egeb .MajorTickMark !=nil {_gdae =_egeb .MajorTickMark .ValAttr ;};if _egeb .TickLblPos !=nil {_bbeg =_egeb .TickLblPos .ValAttr ;};if _egeb .CrossAx ==nil {return _gaeg ,_fad ,_gdae ,_bbeg ,_gdef ,_ddgf ,_egeb .SpPr ,_gf .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_ddgf =_egeb .CrossAx .ValAttr ;};_gdef =_egeb .MajorGridlines ;return _gaeg ,_fad ,_gdae ,_bbeg ,_gdef ,_ddgf ,_egeb .SpPr ,nil ;};type barSerByOrder []*_df .CT_BarSer ;func AdjustColorByLumOff (colorStr string ,lumOff float64 )string {var _cgbb ,_bfgdc ,_gbcd uint8 ;
_gbed ,_ :=_d .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_cgbb ,&_bfgdc ,&_gbcd );if _gbed !=3{return "";};_aeec ,_ffb ,_cgcc :=_gecc (_cgbb ,_bfgdc ,_gbcd );_cgcc =_cgcc +lumOff ;_cgbb ,_bfgdc ,_gbcd =_dec (_aeec ,_ffb ,_cgcc );
return _d .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_cgbb ,_bfgdc ,_gbcd );};func _aba (_bddf _ga .ST_SchemeColorVal ,_bfgd *_ga .Theme )string {if _bcad :=_bfgd .ThemeElements ;_bcad !=nil {if _egb :=_bcad .ClrScheme ;
_egb !=nil {switch _bddf {case _ga .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_egb .Lt1 );case _ga .ST_SchemeColorValDk1 ,_ga .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_egb .Dk1 );case _ga .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_egb .Lt2 );
case _ga .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_egb .Dk2 );case _ga .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_egb .Accent1 );case _ga .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_egb .Accent2 );
case _ga .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_egb .Accent3 );case _ga .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_egb .Accent4 );case _ga .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_egb .Accent5 );
case _ga .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_egb .Accent6 );};};};return "";};func AdjustColorByShade (colorStr string ,shade float64 )string {var _dggc ,_gaga ,_affa uint8 ;_cdef ,_ :=_d .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_dggc ,&_gaga ,&_affa );
if _cdef !=3{return "";};return _bfba (_dggc ,shade )+_bfba (_gaga ,shade )+_bfba (_affa ,shade );};func AdjustColor (colorStr string ,EG_ColorTransform []*_ga .EG_ColorTransform )string {for _ ,_agcd :=range EG_ColorTransform {if _aagf :=_agcd .ColorTransformChoice .Tint ;
_aagf !=nil {if _dggg :=_aagf .ValAttr .ST_PositiveFixedPercentageDecimal ;_dggg !=nil {colorStr =AdjustColorByTint (colorStr ,1.0-float64 (*_dggg )/Percent100 );};};if _fcbgc :=_agcd .ColorTransformChoice .Shade ;_fcbgc !=nil {if _adga :=_fcbgc .ValAttr .ST_PositiveFixedPercentageDecimal ;
_adga !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_adga )/Percent100 );};};if _gge :=_agcd .ColorTransformChoice .LumMod ;_gge !=nil {if _gfcb :=_gge .ValAttr .ST_PercentageDecimal ;_gfcb !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_gfcb )/Percent100 );
};};if _ccd :=_agcd .ColorTransformChoice .LumOff ;_ccd !=nil {if _bba :=_ccd .ValAttr .ST_PercentageDecimal ;_bba !=nil {colorStr =AdjustColorByLumOff (colorStr ,float64 (*_bba )/Percent100 );};};};return colorStr ;};func (_agf *creatorContext )addCatValue (_cbb string ,_bgad map[string ]serCategory ,_gfe []string ,_bdd int ,_bcg ,_gdb *float64 ,_abg string ,_bdde *_ga .CT_ShapeProperties ){_dae ,_bebg :=_eg .ParseFloat (_cbb ,64);
if _bebg !=nil {_dae =0;_bdg .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_bebg );};if _dae > *_gdb {*_gdb =_dae ;};if _dae < *_bcg {*_bcg =_dae ;};_dcc :=_bgad [_gfe [_bdd ]];_dcc ._dcf =append (_dcc ._dcf ,serValue {_ffe :_abg ,_bcc :_dae ,_cec :_bdde });
_bgad [_gfe [_bdd ]]=_dcc ;};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func LoadFontFromFile (filename string )(*_fbfd .PdfFont ,error ){if !_ec .HasSuffix (filename ,"\u002e\u0074\u0074\u0066"){_bdg .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return nil ,_d .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_ggg ,_ffdd :=_fbfd .NewCompositePdfFontFromTTFFile (filename );if _ffdd !=nil {return nil ,_ffdd ;};return _ggg ,nil ;};type serCategory struct{_efe string ;_dcf []serValue ;};var _bgec =fontsMap {_gbac :&_ae .Mutex {},_ebgcd :map[string ]map[FontStyle ]*_fbfd .PdfFont {}};
func IsNoSpaceLanguage (symbol string )bool {for _ ,_aacb :=range symbol {if _e .Is (_e .Han ,_aacb ){return true ;};};return false ;};func GetColorStringFromDmlColor (dmlColor *_ga .CT_Color )string {var _dda string ;if _abgg :=dmlColor .SrgbClr ;_abgg !=nil {_dda =_abgg .ValAttr ;
}else if _gafc :=dmlColor .SysClr ;_gafc !=nil {if _gafc .LastClrAttr !=nil {return *_gafc .LastClrAttr ;};return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _dda ;};func _fdae (_gcd float64 )float64 {return _gcd *_ab .Millimeter };func (_agcb *creatorContext )getTitle (_defc *_df .CT_Title )string {_ebd :="";
if _defc !=nil &&_defc .Tx !=nil &&_defc .Tx .TxChoice !=nil &&_defc .Tx .TxChoice .Rich !=nil {if len (_defc .Tx .TxChoice .Rich .P )> 0{for _ ,_fdb :=range _defc .Tx .TxChoice .Rich .P {if len (_fdb .EG_TextRun )> 0{_ebd +="\u000a"+_fdb .EG_TextRun [0].TextRunChoice .R .T ;
};};};};return _ebd ;};func (_fcee *creatorContext )drawLegend (_bgaa *Rectangle ,_gfc []*legendItem ,_ccg bool ){_cdad :=_fcee ._fed ;_caea :=_fdae (2.5)*_cdad ;_cgba :=_fegc *_cdad ;_bcbe :=(_caea -_cgba )/2;_bec :=float64 (len (_gfc ));if _ccg {_fafa :=&Rectangle {Top :_bgaa .Top +_fdae (1)*_cdad ,Bottom :_bgaa .Bottom -_fdae (1)*_cdad ,Left :_bgaa .Left +_fdae (2.5)*_cdad ,Right :_bgaa .Right -_fdae (2.5)*_cdad };
var _geg float64 ;if _bec > 1{_geg =(_fafa .Right -_fafa .Left )/_bec ;};_dgc :=_fafa .Left ;_debf :=_fafa .Top ;for _ ,_dad :=range _gfc {if _fee :=_dad ._caf ;_fee !=nil {_fcee .drawRectangleWithProps (_fee ,_dgc ,_debf +_bcbe ,_cgba ,_cgba ,false );
_bfg :=_dgc +_cgba *2;_cedc :=_fcee ._bfd .NewStyledParagraph ();_cedc .SetPos (_bfg ,_debf );_edec :=_cedc .Append (_dad ._agce );_bca ,_ffa :=_fbfd .NewStandard14Font (_fbfd .HelveticaName );if _ffa ==nil {_fbfc :=_fcee ._bfd .NewTextStyle ();_fbfc .Font =_bca ;
_fbfc .FontSize =_caea ;_fbfc .TextRise =0.4;_edec .Style =_fbfc ;_fcee ._bfd .Draw (_cedc );};};_dgc +=_geg ;};}else {_fca :=&Rectangle {Top :_bgaa .Top +_fdae (2.5)*_cdad ,Bottom :_bgaa .Bottom -_fdae (2.5)*_cdad ,Left :_bgaa .Left +_fdae (2.5)*_cdad ,Right :_bgaa .Right -_fdae (2.5)*_cdad };
var _fded float64 ;if _bec > 1{_fded =(_fca .Bottom -_fca .Top -_caea )/(_bec -1);if _fded < _caea {_fded =_caea ;};};_aae :=_fca .Top ;_gfdg :=_fca .Left ;_bece :=_gfdg +_cgba *2;for _ ,_beee :=range _gfc {if _egd :=_beee ._caf ;_egd !=nil {_fcee .drawRectangleWithProps (_egd ,_gfdg ,_aae +_bcbe ,_cgba ,_cgba ,false );
_acb :=_fcee ._bfd .NewStyledParagraph ();_acb .SetPos (_bece ,_aae );_acb .SetWidth (_fca .Right -_fca .Left );_ccb :=_acb .Append (_beee ._agce );_dccf ,_gbe :=_fbfd .NewStandard14Font (_fbfd .HelveticaName );if _gbe ==nil {_begb :=_fcee ._bfd .NewTextStyle ();
_begb .Font =_dccf ;_begb .FontSize =_caea ;_begb .TextRise =0.4;_ccb .Style =_begb ;_fcee ._bfd .Draw (_acb );};};_aae +=_fded ;};};};func FromSTCoordinate (st _ga .ST_Coordinate )int64 {if _fcbed :=st .ST_CoordinateUnqualified ;_fcbed !=nil {return *_fcbed ;
};return 0;};func (_eeca *creatorContext )drawRectangleWithProps (_cdfd *_ga .CT_ShapeProperties ,_fac ,_ggd ,_ccgf ,_gefb float64 ,_caed bool ){_gabfg :=_eeca ._bfd .NewRectangle (_fac ,_ggd ,_ccgf ,_gefb );if _cdfd ==nil {if _caed {_gabfg .SetBorderWidth (_eeag );
}else {return ;};}else {_dfbd :=_eeca .getPdfColorFromSolidFill (_cdfd .FillPropertiesChoice .SolidFill );if _dfbd !=nil {_gabfg .SetFillColor (_dfbd );};if _abdd :=_cdfd .Ln ;_abdd !=nil {if _efc :=_abdd .WAttr ;_efc !=nil {_gadf :=_ab .FromEMU (int64 (*_efc ));
_gabfg .SetBorderWidth (_gadf );if _abec :=_abdd .LineFillPropertiesChoice .SolidFill ;_abec !=nil {_cafbe :=_eeca .getPdfColorFromSolidFill (_abec );if _cafbe !=nil {_gabfg .SetBorderColor (_cafbe );};};}else {_gabfg .SetBorderWidth (0);};};};_eeca ._bfd .Draw (_gabfg );
};func MakeImageFromChartSpace (cs *_df .ChartSpace ,width ,height float64 ,theme *_ga .Theme ,workbook *_gg .Workbook )(_g .Image ,error ){_gfda ,_cgb :=_caff (cs ,width ,height ,theme ,true ,workbook );if _cgb !=nil {return nil ,_cgb ;};_eaeb ,_cgb :=GetPageFromCreator (_gfda );
if _cgb !=nil {return nil ,_cgb ;};return _bd .NewImageDevice ().Render (_eaeb );};var _fegc =_fdae (1.5);func _bfba (_cgge uint8 ,_aabf float64 )string {_aca :=float64 (_cgge );return _d .Sprintf ("\u0025\u0030\u0032\u0078",int (_aca *_aabf ));};func (_gda barSerByOrder )Len ()int {return len (_gda )};
func MakeBlockFromCreator (c *_fbf .Creator )(*_fbf .Block ,error ){_debc ,_afec :=GetPageFromCreator (c );if _afec !=nil {return nil ,_afec ;};_cdac ,_afec :=_fbf .NewBlockFromPage (_debc );if _afec !=nil {return nil ,_afec ;};return _cdac ,nil ;};func (_affb *creatorContext )drawPieChart (_dfgb *_df .CT_PieChart ,_caa *Rectangle ,_dfec *_gg .Workbook ,_feb float64 )([]*legendItem ,error ){_cdba :=[]*legendItem {};
_fbec :=map[string ]serCategory {};_gdf :=[]string {};_fcbgf :=_ee .Inf (1);_ggc :=_ee .Inf (-1);_cefb :=_dfgb .Ser ;for _ ,_agfd :=range _cefb {var _bebge string ;if _bbbb :=_agfd .Tx ;_bbbb !=nil {if _dca :=_bbbb .SerTxChoice ;_dca !=nil {if _dca .V !=nil {_bebge =*_dca .V ;
}else if _gggb :=_dca .StrRef ;_gggb !=nil {if _dcfg :=_gggb .StrCache ;_dcfg !=nil {for _ ,_cadg :=range _dcfg .Pt {_bebge =_cadg .V ;};};};};};if _gcc :=_agfd .Cat ;_gcc !=nil {if _ffg :=_gcc .AxDataSourceChoice ;_ffg !=nil {if _ffae :=_ffg .StrRef ;
_ffae !=nil {if _gdecf :=_ffae .F ;_gdecf !=""&&_dfec !=nil {_dfcce ,_ffaa ,_egab ,_fcae :=ParseExcelRange (_gdecf );if _fcae ==nil {for _ ,_bcfc :=range _dfec .Sheets (){if _bcfc .Name ()==_ec .Trim (_dfcce ,"\u0027"){_ebea :=_ffaa .String ();for _deec :=_ffaa .RowIdx ;
_deec <=_egab .RowIdx ;_deec +=1{_fddd :=_ec .ReplaceAll (_ebea ,_d .Sprint (_ffaa .RowIdx ),_d .Sprint (_deec ));_affb .addCatName (_bcfc .Cell (_fddd ).GetString (),_fbec ,&_gdf );};break ;};};};};if _bfcc :=_ffae .StrCache ;_bfcc !=nil {for _ ,_fbfb :=range _bfcc .Pt {_affb .addCatName (_fbfb .V ,_fbec ,&_gdf );
};};}else if _fdfc :=_ffg .NumRef ;_fdfc !=nil {if _egf :=_fdfc .NumCache ;_egf !=nil {var _fcc string ;if _egf .FormatCode !=nil {_fcc =*_egf .FormatCode ;};for _ ,_ebge :=range _egf .Pt {var _adb string ;if _ebge .FormatCodeAttr ==nil {_adb =_fcc ;}else {_adb =*_ebge .FormatCodeAttr ;
};var _eabc string ;_abdcg ,_fadb :=_eg .ParseFloat (_ebge .V ,64);if _fadb !=nil {_eabc =_ebge .V ;}else {_eabc =_eef .Number (_abdcg ,_adb );};_affb .addCatName (_eabc ,_fbec ,&_gdf );};};};};};if _fcg :=_agfd .Val ;_fcg !=nil {if _bgdg :=_fcg .NumDataSourceChoice ;
_bgdg !=nil {if _cfg :=_bgdg .NumRef ;_cfg !=nil {if _faad :=_cfg .F ;_faad !=""&&_dfec !=nil {_gbca ,_cbc ,_gecca ,_cadc :=ParseExcelRange (_faad );if _cadc ==nil {for _ ,_ddgfe :=range _dfec .Sheets (){if _ddgfe .Name ()==_ec .Trim (_gbca ,"\u0027"){_bgae :=_cbc .String ();
for _ebee :=_cbc .RowIdx ;_ebee <=_gecca .RowIdx ;_ebee +=1{_accg :=_ec .ReplaceAll (_bgae ,_d .Sprint (_cbc .RowIdx ),_d .Sprint (_ebee ));if _ddgfe .FormulaContext ().HasFormula (_accg ){_bgcd :=_fe .NewEvaluator ();_dbge :=_ddgfe .FormulaContext ().Cell (_accg ,_bgcd );
_egff :=_dbge .Value ();_affb .addCatValue (_egff ,_fbec ,_gdf ,(int )(_ebee -_cbc .RowIdx ),&_fcbgf ,&_ggc ,_bebge ,_agfd .SpPr );}else {_gedf :=_ddgfe .Cell (_accg ).GetString ();_affb .addCatValue (_gedf ,_fbec ,_gdf ,(int )(_ebee -_cbc .RowIdx ),&_fcbgf ,&_ggc ,_bebge ,_agfd .SpPr );
};};break ;};};};};if _cceg :=_cfg .NumCache ;_cceg !=nil {for _gged ,_bdda :=range _cceg .Pt {_affb .addCatValue (_bdda .V ,_fbec ,_gdf ,_gged ,&_fcbgf ,&_ggc ,_bebge ,_agfd .SpPr );};};};};};};_eefc :=&_cd .PieChart {Values :[]_cf .Value {}};for _ ,_cbg :=range _gdf {_aegg :=_fbec [_cbg ];
if len (_aegg ._dcf )> 0{_eefc .Values =append (_eefc .Values ,_cf .Value {Value :_aegg ._dcf [0]._bcc ,Label :_cbg ,Style :_bc .Style {FontSize :12*_feb }});};};_eefc .SetHeight (int (_caa .Top -_caa .Bottom ));_eefc .SetWidth (int (_caa .Right -_caa .Left ));
_fgeb :=_affb ._bfd ;_efbe :=_fbf .NewChart (_eefc );_efbe .SetPos (_caa .Left ,_caa .Top );_agdd :=_fgeb .Draw (_efbe );if _agdd !=nil {return nil ,_agdd ;};return _cdba ,nil ;};func (_febf *Rectangle )scale (_aefc float64 ){_febf .Top *=_aefc ;_febf .Bottom *=_aefc ;
_febf .Left *=_aefc ;_febf .Right *=_aefc ;};func _deaa (_cde *_df .CT_CatAx )(uint32 ,_df .ST_AxPos ,_df .ST_TickMark ,_df .ST_TickLblPos ,*_df .CT_ChartLines ,uint32 ,*_ga .CT_ShapeProperties ,error ){var _aaaa ,_ggb uint32 ;var _bfbfa _df .ST_AxPos ;
var _cge _df .ST_TickMark ;var _bbcd *_df .CT_ChartLines ;var _afbc _df .ST_TickLblPos ;if _cde .AxId ==nil {return _aaaa ,_bfbfa ,_cge ,_afbc ,_bbcd ,_ggb ,_cde .SpPr ,_gf .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_aaaa =_cde .AxId .ValAttr ;
};if _cde .AxPos ==nil {return _aaaa ,_bfbfa ,_cge ,_afbc ,_bbcd ,_ggb ,_cde .SpPr ,_gf .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_bfbfa =_cde .AxPos .ValAttr ;};if _cde .MajorTickMark !=nil {_cge =_cde .MajorTickMark .ValAttr ;
};if _cde .TickLblPos !=nil {_afbc =_cde .TickLblPos .ValAttr ;};if _cde .CrossAx ==nil {return _aaaa ,_bfbfa ,_cge ,_afbc ,_bbcd ,_ggb ,_cde .SpPr ,_gf .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_ggb =_cde .CrossAx .ValAttr ;
};_bbcd =_cde .MajorGridlines ;return _aaaa ,_bfbfa ,_cge ,_afbc ,_bbcd ,_ggb ,_cde .SpPr ,nil ;};func _bbeb (_gcf *_de .Document ,_gdedb ,_fda ,_aeaf string )error {_dfb ,_eaae :=_gcf .GetFontBytesByRelId (_fda );if _eaae !=nil {return _eaae ;};_fgf ,_eaae :=_abef (_aeaf );
if _eaae !=nil {return _eaae ;};for _fdfd :=0;_fdfd < 32;_fdfd ++{_ffba :=_fdfd %len (_fgf );_dfb [_fdfd ]=_dfb [_fdfd ]^_fgf [_ffba ];};_ebgf :=_gcf .TmpPath +"\u002f"+_gdedb +"\u002e\u0074\u0074\u0066";_eaae =_fb .WriteFile (_ebgf ,_dfb ,0644);if _eaae !=nil {return _eaae ;
};_abed (_ebgf );return nil ;};const (PageSizeA4 PageSize =iota ;PageSizeA3 ;PageSizeA5 ;PageSizeLetter ;PageSizeLegal ;Percent100 =100000.0;);func _abed (_abga string )error {if !_ec .HasSuffix (_abga ,"\u002e\u0074\u0074\u0066"){_bdg .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _d .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_ada ,_acdf :=_b .ParseFile (_abga );if _acdf !=nil {_bdg .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_acdf );return _acdf ;};_cedd ,_acdf :=_fbfd .NewCompositePdfFontFromTTFFile (_abga );
if _acdf !=nil {return _acdf ;};_ddc :=_ada .GetNameRecords ();for _ ,_ccgd :=range _ddc {_eeg :=_ccgd [1];if _eeg ==""{continue ;};_agff :=make ([]byte ,0);for _deca :=0;_deca < len (_eeg );_deca ++{if _eeg [_deca ]==39||_eeg [_deca ]==92{continue ;};
_cdce :=4;if _deca +_cdce < len (_eeg ){if _eeg [_deca :_deca +_cdce ]=="\u0000"{_deca =_deca +_cdce +1;continue ;};};_agff =append (_agff ,_eeg [_deca ]);};_eeg =_ec .Replace (string (_agff ),"\u0078\u0030\u0030","",-1);_aga :=_ccgd [2];if _aga ==""{return _d .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_abga );
};_agff =make ([]byte ,0);for _cdda :=0;_cdda < len (_aga );_cdda ++{if _aga [_cdda ]==39||_aga [_cdda ]==92{continue ;};_eec :=4;if _cdda +_eec < len (_aga ){if _aga [_cdda :_cdda +_eec ]=="\u0000"{_cdda =_cdda +_eec +1;continue ;};};_agff =append (_agff ,_aga [_cdda ]);
};_aga =_ec .Replace (string (_agff ),"\u0078\u0030\u0030","",-1);RegisterFont (_eeg ,_fece [_aga ],_cedd );};return nil ;};func FromSTCoordinate32 (st _ga .ST_Coordinate32 )int64 {if _fcaeg :=st .ST_Coordinate32Unqualified ;_fcaeg !=nil {return int64 (*_fcaeg );
};return 0;};func _geb (_abag _ga .ST_SchemeColorVal ,_cged *_ga .Theme )string {if _eaef :=_cged .ThemeElements ;_eaef !=nil {if _cab :=_eaef .ClrScheme ;_cab !=nil {switch _abag {case _ga .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_cab .Lt1 );
case _ga .ST_SchemeColorValDk1 ,_ga .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_cab .Dk1 );case _ga .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_cab .Lt2 );case _ga .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_cab .Dk2 );
case _ga .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_cab .Accent1 );case _ga .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_cab .Accent2 );case _ga .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_cab .Accent3 );
case _ga .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_cab .Accent4 );case _ga .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_cab .Accent5 );case _ga .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_cab .Accent6 );
};};};return "";};func CropImageByRect (sourceImg _g .Image ,rect _g .Rectangle )_g .Image {_feaf ,_dfge ,_fdfg ,_gbf :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;_efea :=_g .NewNRGBA (_g .Rect (0,0,_fdfg -_feaf ,_gbf -_dfge ));for _gcda :=_feaf ;
_gcda < _fdfg ;_gcda ++{for _ddf :=_dfge ;_ddf < _gbf ;_ddf ++{_efea .Set (_gcda -_feaf ,_ddf -_dfge ,sourceImg .At (_gcda ,_ddf ));};};return _efea ;};type serValue struct{_ffe string ;_bcc float64 ;_cec *_ga .CT_ShapeProperties ;};type legendItem struct{_agce string ;
_caf *_ga .CT_ShapeProperties ;};func (_cfb *Rectangle )Translate (x ,y float64 ){_cfb .Left +=x ;_cfb .Right +=x ;_cfb .Top +=y ;_cfb .Bottom +=y ;};func _adf (_aeaa *_df .CT_DateAx )(uint32 ,_df .ST_AxPos ,_df .ST_TickMark ,_df .ST_TickLblPos ,*_df .CT_ChartLines ,uint32 ,*_ga .CT_ShapeProperties ,error ){var _eaea ,_dfcc uint32 ;
var _afaf _df .ST_AxPos ;var _fbb _df .ST_TickMark ;var _gbbd *_df .CT_ChartLines ;var _gfag _df .ST_TickLblPos ;if _aeaa .AxId ==nil {return _eaea ,_afaf ,_fbb ,_gfag ,_gbbd ,_dfcc ,_aeaa .SpPr ,_gf .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_eaea =_aeaa .AxId .ValAttr ;};if _aeaa .AxPos ==nil {return _eaea ,_afaf ,_fbb ,_gfag ,_gbbd ,_dfcc ,_aeaa .SpPr ,_gf .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_afaf =_aeaa .AxPos .ValAttr ;
};if _aeaa .MajorTickMark !=nil {_fbb =_aeaa .MajorTickMark .ValAttr ;};if _aeaa .TickLblPos !=nil {_gfag =_aeaa .TickLblPos .ValAttr ;};if _aeaa .CrossAx ==nil {return _eaea ,_afaf ,_fbb ,_gfag ,_gbbd ,_dfcc ,_aeaa .SpPr ,_gf .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_dfcc =_aeaa .CrossAx .ValAttr ;};_gbbd =_aeaa .MajorGridlines ;return _eaea ,_afaf ,_fbb ,_gfag ,_gbbd ,_dfcc ,_aeaa .SpPr ,nil ;};func (_age *creatorContext )drawScatterChart (_cbf *_df .CT_ScatterChart ,_beca *Rectangle ,_daee []*_df .CT_PlotAreaChoice1 ,_bffab float64 )([]*legendItem ,error ){_acgd :=[]*legendItem {};
_gbef :=_cbf .Ser ;_acga :=make (map[string ]float64 );_dfdb :=make (map[string ][]float64 );_daff :=make (map[string ][]float64 );_cbfc :=[]string {};for _ ,_eddc :=range _gbef {var _dde string ;if _fba :=_eddc .Tx ;_fba !=nil {if _ccff :=_fba .SerTxChoice ;
_ccff !=nil {if _ccff .V !=nil {_dde =*_ccff .V ;}else if _fcea :=_ccff .StrRef ;_fcea !=nil {if _efef :=_fcea .StrCache ;_efef !=nil {for _ ,_cedfd :=range _efef .Pt {_dde =_cedfd .V ;};};};_cbfc =append (_cbfc ,_dde );};};if _eddc .Marker !=nil &&_eddc .Marker .Size !=nil {_acga [_dde ]=float64 (*_eddc .Marker .Size .ValAttr );
}else {_acga [_dde ]=-1.0;};if _daaf :=_eddc .XVal ;_daaf !=nil {if _dcg :=_daaf .AxDataSourceChoice ;_dcg !=nil {if _gfg :=_dcg .NumRef ;_gfg !=nil {if _eebd :=_gfg .NumCache ;_eebd !=nil {for _ ,_gege :=range _eebd .Pt {_bcca ,_ :=_eg .ParseFloat (_ec .TrimSpace (_gege .V ),64);
_dfdb [_dde ]=append (_dfdb [_dde ],_bcca );};};};};};if _fff :=_eddc .YVal ;_fff !=nil {if _cbaf :=_fff .NumDataSourceChoice ;_cbaf !=nil {if _cfcg :=_cbaf .NumRef ;_cfcg !=nil {if _ccfe :=_cfcg .NumCache ;_ccfe !=nil {for _ ,_ccac :=range _ccfe .Pt {_cddg ,_ :=_eg .ParseFloat (_ec .TrimSpace (_ccac .V ),64);
_daff [_dde ]=append (_daff [_dde ],_cddg );};};};};};};_aabff :=true ;_fdbbf :="";_aadd :="";if len (_daee )> 1{if _daee [0].ValAx .Delete !=nil &&_daee [1].ValAx .Delete !=nil {if !*(*_daee [0].ValAx .Delete ).ValAttr &&!*(*_daee [1].ValAx .Delete ).ValAttr {_aabff =false ;
};};_fdbbf =_age .getTitle (_daee [0].ValAx .Title );_aadd =_age .getTitle (_daee [1].ValAx .Title );};_gea :=_bc .Style {Hidden :_aabff ,FontSize :8*_bffab };_abcd :=&_cd .Chart {Series :[]_cf .Series {},YAxisSecondary :_cd .YAxis {Style :_gea ,Name :_aadd ,NameStyle :_gea },XAxis :_cd .XAxis {Style :_gea ,Name :_fdbbf ,NameStyle :_gea },YAxis :_cd .YAxis {Style :_bc .Style {Hidden :true }}};
for _ ,_badc :=range _cbfc {_cgdc :=_cf .ContinuousSeries {XValues :_dfdb [_badc ],YValues :_daff [_badc ],Style :_bc .Style {StrokeWidth :-1,DotWidth :_acga [_badc ]}};_abcd .Series =append (_abcd .Series ,_cgdc );};_abcd .SetHeight (int (_ee .Abs (_beca .Top -_beca .Bottom )));
_abcd .SetWidth (int (_ee .Abs (_beca .Right -_beca .Left )));_bfe :=_age ._bfd ;_cefe :=_fbf .NewChart (_abcd );_cefe .SetPos (_beca .Left ,_beca .Top );_gfgc :=_bfe .Draw (_cefe );if _gfgc !=nil {return nil ,_gfgc ;};return _acgd ,nil ;};func GetPageFromCreator (c *_fbf .Creator )(*_fbfd .PdfPage ,error ){_adae :=_c .NewBuffer ([]byte {});
_afgg :=c .Write (_adae );if _afgg !=nil {return nil ,_afgg ;};_bagd :=_c .NewReader (_adae .Bytes ());_edgb ,_afgg :=_fbfd .NewPdfReader (_bagd );if _afgg !=nil {return nil ,_afgg ;};return _edgb .GetPage (1);};func (_cdg *creatorContext )drawAreaChart (_ecg *_df .CT_AreaChart ,_af *Rectangle ,_gag []*_df .CT_PlotAreaChoice1 ,_gad float64 )([]*legendItem ,error ){_cdb :=[]*legendItem {};
_ce :=_ecg .Ser ;_eeb :=make (map[int ][]float64 );_dd :=make (map[int ][]float64 );_afg :=make (map[int ]_fbf .Color );for _bb ,_gd :=range _ce {_afg [_bb ]=_fbf .ColorWhite ;if _abe :=_gd .SpPr ;_abe !=nil {_dc :=_cdg .getPdfColorFromSolidFill (_abe .FillPropertiesChoice .SolidFill );
if _dc !=nil {_afg [_bb ]=_dc ;};};if _bg :=_gd .Val ;_bg !=nil {if _cg :=_bg .NumDataSourceChoice ;_cg !=nil {if _bga :=_cg .NumRef ;_bga !=nil {if _abf :=_bga .NumCache ;_abf !=nil {for _ ,_aff :=range _abf .Pt {_eeb [_bb ]=append (_eeb [_bb ],float64 (_aff .IdxAttr ));
_bbd ,_ :=_eg .ParseFloat (_ec .TrimSpace (_aff .V ),64);_dd [_bb ]=append (_dd [_bb ],_bbd );};};};};};};_gaf :=true ;_cdd :="";_fec :="";if len (_gag )> 1{if _gag [0].ValAx !=nil &&_gag [1].ValAx !=nil {if _gag [0].ValAx .Delete !=nil &&_gag [1].ValAx .Delete !=nil {if !*(*_gag [0].ValAx .Delete ).ValAttr &&!*(*_gag [1].ValAx .Delete ).ValAttr {_gaf =false ;
};};_cdd =_cdg .getTitle (_gag [0].ValAx .Title );_fec =_cdg .getTitle (_gag [1].ValAx .Title );};};_ed :=_bc .Style {Hidden :_gaf ,FontSize :8*_gad };_db :=&_cd .Chart {Series :[]_cf .Series {},YAxisSecondary :_cd .YAxis {Style :_ed ,Name :_fec ,NameStyle :_ed },XAxis :_cd .XAxis {Style :_ed ,Name :_cdd ,NameStyle :_ed },YAxis :_cd .YAxis {Style :_bc .Style {Hidden :true }}};
for _ca :=0;_ca < len (_afg );_ca ++{_da ,_fa ,_ef :=_afg [_ca ].ToRGB ();_bf :=_cf .ContinuousSeries {XValues :_eeb [_ca ],YValues :_dd [_ca ],Style :_bc .Style {StrokeWidth :1,FillColor :_f .RGBA {uint8 (_da *255),uint8 (_fa *255),uint8 (_ef *255),255}}};
_db .Series =append (_db .Series ,_bf );};_db .SetHeight (int (_ee .Abs (_af .Top -_af .Bottom )));_db .SetWidth (int (_ee .Abs (_af .Right -_af .Left )));_ceb :=_cdg ._bfd ;_cdbd :=_fbf .NewChart (_db );_cdbd .SetPos (_af .Left ,_af .Top );_fg :=_ceb .Draw (_cdbd );
if _fg !=nil {return nil ,_fg ;};return _cdb ,nil ;};func GetPageDimensions (size PageSize )_fbf .PageSize {return _bgbg [size ]};func RegisterFontsFromDirectory (dirName string )error {_bce ,_gfb :=_fb .Open (dirName );if _gfb !=nil {return _gfb ;};defer _bce .Close ();
_ebdf ,_gfb :=_bce .Readdirnames (0);if _gfb !=nil {return _gfb ;};for _ ,_agg :=range _ebdf {if _ec .HasSuffix (_agg ,"\u002e\u0074\u0074\u0066"){_gca :=dirName +"\u002f"+_agg ;_acgc :=_abed (_gca );if _acgc !=nil {_bdg .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_acgc );
continue ;};};};return nil ;};func ClearRegisteredFonts (){_bgec ._gbac .Lock ();_bgec ._ebgcd =map[string ]map[FontStyle ]*_fbfd .PdfFont {};_bgec ._gbac .Unlock ();};var _eeag =_fdae (0.125);func GetRegisteredFont (name string ,style FontStyle )*_fbfd .PdfFont {_bgec ._gbac .Lock ();
defer _bgec ._gbac .Unlock ();if _fgg ,_acfe :=_bgec ._ebgcd [name ];_acfe {if _ccdc ,_aad :=_fgg [style ];_aad {return _ccdc ;};};return nil ;};var _fece =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
func DrawLine (c *_fbf .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _fbf .Color ){if color ==nil {return ;};_cgfc :=c .NewLine (x0 ,y0 ,x1 ,y1 );_cgfc .SetLineWidth (width );_cgfc .SetColor (color );c .Draw (_cgfc );};var RtlFontFile *_fbfd .PdfFont ;
func FromSTPercentage (st *_ga .ST_Percentage )float64 {if _ecbe :=st .ST_PercentageDecimal ;_ecbe !=nil {return float64 (*_ecbe )/Percent100 ;};return 0;};const _dade =6.0;func (_bebf *creatorContext )drawLineWithProps (_afgd *_ga .CT_ShapeProperties ,_gaff ,_bda ,_cefd ,_fab float64 ,_ceca bool ){if _afgd !=nil {if _afdf :=_afgd .Ln ;
_afdf !=nil {_aadc :=_bebf .getPdfColorFromSolidFill (_afdf .LineFillPropertiesChoice .SolidFill );if _aadc ==nil &&_ceca {_aadc =_fbf .ColorBlack ;};if _aadc !=nil {var _cgac float64 ;if _gecg :=_afdf .WAttr ;_gecg !=nil {_cgac =_ab .FromEMU (int64 (*_gecg ));
}else {_cgac =_eeag ;};DrawLine (_bebf ._bfd ,_gaff ,_bda ,_cefd ,_fab ,_cgac ,_aadc );};};};};func _abef (_edb string )([]byte ,error ){_debe :=_fd .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");_edb =_debe .ReplaceAllString (_edb ,"");
_fga :=[]rune (_edb );_gffa :=[]byte {};for _dadeb :=len (_fga )-2;_dadeb >=0;_dadeb -=2{_gbde ,_fbg :=_eg .ParseUint (string (_fga [_dadeb ])+string (_fga [_dadeb +1]),16,8);if _fbg !=nil {return nil ,_fbg ;};_gffa =append (_gffa ,byte (_gbde ));};return _gffa ,nil ;
};func (_cbbd barSerByOrder )Less (i ,j int )bool {return _cbbd [i ].Order .ValAttr < _cbbd [j ].Order .ValAttr ;};func _daae (_eagc *_df .CT_SerAx )(uint32 ,_df .ST_AxPos ,_df .ST_TickMark ,_df .ST_TickLblPos ,*_df .CT_ChartLines ,uint32 ,*_ga .CT_ShapeProperties ,error ){var _afgc ,_aed uint32 ;
var _ade _df .ST_AxPos ;var _daaa _df .ST_TickMark ;var _adeb *_df .CT_ChartLines ;var _cfa _df .ST_TickLblPos ;if _eagc .AxId ==nil {return _afgc ,_ade ,_daaa ,_cfa ,_adeb ,_aed ,_eagc .SpPr ,_gf .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_afgc =_eagc .AxId .ValAttr ;};if _eagc .AxPos ==nil {return _afgc ,_ade ,_daaa ,_cfa ,_adeb ,_aed ,_eagc .SpPr ,_gf .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ade =_eagc .AxPos .ValAttr ;
};if _eagc .MajorTickMark !=nil {_daaa =_eagc .MajorTickMark .ValAttr ;};if _eagc .TickLblPos !=nil {_cfa =_eagc .TickLblPos .ValAttr ;};if _eagc .CrossAx ==nil {return _afgc ,_ade ,_daaa ,_cfa ,_adeb ,_aed ,_eagc .SpPr ,_gf .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_aed =_eagc .CrossAx .ValAttr ;};_adeb =_eagc .MajorGridlines ;return _afgc ,_ade ,_daaa ,_cfa ,_adeb ,_aed ,_eagc .SpPr ,nil ;};func GetDataFromXfrm (xfrm *_ga .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _gcgc ,_cdbg ,_dag ,_febd float64 ;
if _dbcbf :=xfrm .Off ;_dbcbf !=nil {_gcgc =_ab .FromEMU (FromSTCoordinate (_dbcbf .XAttr ));_cdbg =_ab .FromEMU (FromSTCoordinate (_dbcbf .YAttr ));};if _fbfcf :=xfrm .Ext ;_fbfcf !=nil {_dag =_ab .FromEMU (_fbfcf .CxAttr );_febd =_ab .FromEMU (_fbfcf .CyAttr );
};return _gcgc ,_cdbg ,_dag ,_febd ;};func _beda (_abac ,_cafb ,_ffd float64 )float64 {if _abac *6< 1{return _ffd +(_cafb -_ffd )*6*_abac ;}else if _abac *2< 1{return _cafb ;}else if _abac *3< 2{return _ffd +(_cafb -_ffd )*(2.0/3.0-_abac )*6;}else {return _ffd ;
};};var _ebdg =_fdae (7.5);func GetGroupOffsetFromXfrm (xfrm *_ga .CT_GroupTransform2D )(float64 ,float64 ){var _adbe ,_ceed float64 ;if xfrm .Off !=nil &&xfrm .ChOff !=nil {_adbe =_ab .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_ab .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));
_ceed =_ab .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_ab .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));};return _adbe ,_ceed ;};func (_aacc *creatorContext )drawTitle (_ebc string ,_afa ,_deae float64 ){_ebgd :=_aacc ._fed ;_cgaa :=_aacc ._bfd .NewStyledParagraph ();
_gdac :=_cgaa .SetText (_ebc );_fbeb ,_cae :=_fbfd .NewStandard14Font (_fbfd .HelveticaName );if _cae ==nil {_dfa :=_aacc ._bfd .NewTextStyle ();_dfa .Font =_fbeb ;_dfa .FontSize =14;_dfa .TextRise =0.4;_gdac .Style =_dfa ;_cgaa .SetPos (_afa -_cgaa .Width ()*_ebgd /2,_deae );
_aacc ._bfd .Draw (_cgaa );};};func (_fbff *creatorContext )drawLineChart (_cfde *_df .CT_LineChart ,_bcbd *Rectangle ,_gaab []*_df .CT_PlotAreaChoice1 ,_debd float64 )([]*legendItem ,error ){_cggg :=[]*legendItem {};_cag :=_cfde .Ser ;_bcec :=make (map[int ][]float64 );
_dcbf :=make (map[int ][]float64 );_cebg :=make (map[int ]_fbf .Color );_cegf :=make (map[int ]float64 );for _beag ,_gbdb :=range _cag {var _dfggg string ;if _eadc :=_gbdb .Tx ;_eadc !=nil {if _egebf :=_eadc .SerTxChoice ;_egebf !=nil {if _egebf .V !=nil {_dfggg =*_egebf .V ;
}else if _ccbf :=_egebf .StrRef ;_ccbf !=nil {if _ccef :=_ccbf .StrCache ;_ccef !=nil {for _ ,_cdbe :=range _ccef .Pt {_dfggg =_cdbe .V ;};};};};};_cebg [_beag ]=_fbf .ColorWhite ;if _aedg :=_gbdb .SpPr ;_aedg !=nil {if _cad :=_aedg .Ln ;_cad !=nil {if _ecdag :=_cad .WAttr ;
_ecdag !=nil {_cegf [_beag ]=_ab .FromEMU (int64 (*_ecdag ));if _gecb :=_cad .LineFillPropertiesChoice .SolidFill ;_gecb !=nil {_gcgf :=_fbff .getPdfColorFromSolidFill (_gecb );if _gcgf !=nil {_cebg [_beag ]=_gcgf ;};};};};};if _fdbb :=_gbdb .Val ;_fdbb !=nil {if _bcce :=_fdbb .NumDataSourceChoice ;
_bcce !=nil {if _ebcf :=_bcce .NumRef ;_ebcf !=nil {if _cefg :=_ebcf .NumCache ;_cefg !=nil {for _ ,_effgg :=range _cefg .Pt {_bcec [_beag ]=append (_bcec [_beag ],float64 (_effgg .IdxAttr ));_affc ,_ :=_eg .ParseFloat (_ec .TrimSpace (_effgg .V ),64);
_dcbf [_beag ]=append (_dcbf [_beag ],_affc );};};};};};_cggg =append (_cggg ,&legendItem {_agce :_dfggg ,_caf :_gbdb .SpPr });};_bbb :=true ;_feeg :=true ;_gedd :="";_fge :="";if len (_gaab )> 0{for _ ,_gaae :=range _gaab {if _gaae .CatAx !=nil {if _gaae .CatAx .Delete !=nil {if !*(*_gaae .CatAx .Delete ).ValAttr {_bbb =false ;
};};_gedd =_fbff .getTitle (_gaae .CatAx .Title );}else if _gaae .ValAx !=nil {if _gaae .ValAx .Delete !=nil {if !*(*_gaae .ValAx .Delete ).ValAttr {_feeg =false ;};};_fge =_fbff .getTitle (_gaae .ValAx .Title );};};};_ebb :=_bc .Style {Hidden :_bbb ,FontSize :8*_debd };
_dge :=_bc .Style {Hidden :_feeg ,FontSize :8*_debd };_agaf :=&_cd .Chart {Series :[]_cf .Series {},YAxisSecondary :_cd .YAxis {Style :_dge ,Name :_fge ,NameStyle :_dge },XAxis :_cd .XAxis {Style :_ebb ,Name :_gedd ,NameStyle :_ebb },YAxis :_cd .YAxis {Style :_bc .Style {Hidden :true }}};
for _bgd :=0;_bgd < len (_cebg );_bgd ++{_bcd ,_bfge ,_fcbe :=_cebg [_bgd ].ToRGB ();_becc :=_cf .ContinuousSeries {XValues :_bcec [_bgd ],YValues :_dcbf [_bgd ],Style :_bc .Style {StrokeColor :_f .RGBA {uint8 (_bcd *255),uint8 (_bfge *255),uint8 (_fcbe *255),255},StrokeWidth :_cegf [_bgd ]}};
_agaf .Series =append (_agaf .Series ,_becc );};_agaf .SetHeight (int (_ee .Abs (_bcbd .Top -_bcbd .Bottom )));_agaf .SetWidth (int (_ee .Abs (_bcbd .Right -_bcbd .Left )));_gdaa :=_fbff ._bfd ;_fae :=_fbf .NewChart (_agaf );_fae .SetPos (_bcbd .Left ,_bcbd .Top );
_cagb :=_gdaa .Draw (_fae );if _cagb !=nil {return nil ,_cagb ;};return _cggg ,nil ;};func DrawRectangle (c *_fbf .Creator ,r *Rectangle ,w float64 ,color _fbf .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );
DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};func (_bfbb *creatorContext )drawBorderWithProps (_fcaa *_ga .CT_ShapeProperties ,_ffbe *Rectangle ,_begg float64 ){if _ffbe !=nil &&_fcaa !=nil &&_fcaa .Ln !=nil &&_fcaa .Ln .LineFillPropertiesChoice .SolidFill !=nil {_bgcgb :=_bfbb .getPdfColorFromSolidFill (_fcaa .Ln .LineFillPropertiesChoice .SolidFill );
DrawRectangle (_bfbb ._bfd ,_ffbe ,_begg ,_bgcgb );};};func GetImage (c *_fbf .Creator ,goImg _g .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_fbf .Image ,error ){if goImg ==nil {return nil ,nil ;};_defcf :=goImg .Bounds ().Size ();
_daffc :=_defcf .X ;_eeff :=_defcf .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_daffc );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_eeff );};var _ebgde _g .Rectangle ;switch part {case ImgPart_t :_ebgde =_g .Rect (0,0,_daffc ,int (dividerY ));
case ImgPart_b :_ebgde =_g .Rect (0,int (dividerY ),_daffc ,_eeff );case ImgPart_l :_ebgde =_g .Rect (0,0,int (dividerX ),_eeff );case ImgPart_r :_ebgde =_g .Rect (int (dividerX ),0,_daffc ,_eeff );case ImgPart_lt :_ebgde =_g .Rect (0,0,int (dividerX ),int (dividerY ));
case ImgPart_rt :_ebgde =_g .Rect (int (dividerX ),0,_daffc ,int (dividerY ));case ImgPart_lb :_ebgde =_g .Rect (0,int (dividerY ),int (dividerX ),_eeff );case ImgPart_rb :_ebgde =_g .Rect (int (dividerX ),int (dividerY ),_daffc ,_eeff );default:_ebgde =_g .Rect (0,0,_daffc ,_eeff );
};_ebf :=CropImageByRect (goImg ,_ebgde );_ddbea ,_aaab :=c .NewImageFromGoImage (_ebf );if _aaab !=nil {return nil ,_aaab ;};_ddbea .Scale (imgWidth /float64 (_daffc ),imgHeight /float64 (_eeff ));_ddbea .SetPos (left ,top );return _ddbea ,nil ;};func TwipsFromPoints (points float64 )float64 {return points /_ab .Twips };
var _bff =_fdae (1.5);var _dfc =_fdae (5);func RegisterFont (name string ,style FontStyle ,font *_fbfd .PdfFont ){_bgec ._gbac .Lock ();if _bgec ._ebgcd [name ]==nil {_bgec ._ebgcd [name ]=map[FontStyle ]*_fbfd .PdfFont {};};_bgec ._ebgcd [name ][style ]=font ;
_bgec ._gbac .Unlock ();};func _gecc (_ccbb ,_deff ,_dacd uint8 )(float64 ,float64 ,float64 ){_ceee ,_eba ,_cgce :=float64 (_ccbb )/255,float64 (_deff )/255,float64 (_dacd )/255;_gac :=_ceee ;if _eba < _gac {_gac =_eba ;};if _cgce < _gac {_gac =_cgce ;
};var _bccc ,_egg bool ;_ceg :=_ceee ;if _eba > _ceg {_ceg =_eba ;_bccc =true ;};if _cgce > _ceg {_ceg =_cgce ;_bccc =false ;_egg =true ;};_ecff :=(_gac +_ceg )/2;var _ffbf float64 ;if _gac !=_ceg {if _ecff <=0.5{_ffbf =(_ceg -_gac )/(_ceg +_gac );}else {_ffbf =(_ceg -_gac )/(2.0-_ceg -_gac );
};};var _dcb float64 ;if _gac !=_ceg {if _bccc {_dcb =2.0+(_cgce -_ceee )/(_ceg -_gac );}else if _egg {_dcb =4.0+(_ceee -_eba )/(_ceg -_gac );}else {_dcb =(_eba -_cgce )/(_ceg -_gac );};_dcb *=60;if _dcb < 0{_dcb +=360;};};return _dcb ,_ffbf ,_ecff ;};
func RegisterEmbeddedFonts (d *_de .Document )error {_efga :=d .FontTable ();if _efga ==nil {return nil ;};for _ ,_gagb :=range _efga .Font {if _gagb .EmbedRegular !=nil {return _bbeb (d ,_gagb .NameAttr ,_gagb .EmbedRegular .IdAttr ,_gagb .EmbedRegular .FontKeyAttr );
};if _gagb .EmbedBold !=nil {return _bbeb (d ,_gagb .NameAttr ,_gagb .EmbedBold .IdAttr ,_gagb .EmbedBold .FontKeyAttr );};if _gagb .EmbedItalic !=nil {return _bbeb (d ,_gagb .NameAttr ,_gagb .EmbedItalic .IdAttr ,_gagb .EmbedItalic .FontKeyAttr );};if _gagb .EmbedBoldItalic !=nil {return _bbeb (d ,_gagb .NameAttr ,_gagb .EmbedBoldItalic .IdAttr ,_gagb .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};func _ecd (_gdbb uint8 ,_fddf float64 )string {_gce :=float64 (_gdbb );var _efa float64 ;if _fddf < 0{_efa =_gce *(1+_fddf );}else {_efa =_gce +(255-_gce )*_fddf ;};return _d .Sprintf ("\u0025\u0030\u0032\u0078",int (_efa ));};func RegisterFontsFromFiles (files []string )error {for _ ,_adcg :=range files {if _ec .HasSuffix (_adcg ,"\u002e\u0074\u0074\u0066"){_gdeg :=_abed (_adcg );
if _gdeg !=nil {_bdg .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gdeg );
continue ;};};};return nil ;};const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);func AssignStdFontByName (style _fbf .TextStyle ,fontName string )*_fbfd .PdfFont {_afeb :=_fbfd .StdFontName (fontName );
return _fbfd .NewStandard14FontMustCompile (_afeb );};func MakeTempCreator (width ,height float64 )*_fbf .Creator {_cagg :=_fbf .New ();_cagg .SetPageSize (_fbf .PageSize {width ,height });_cagg .SetPageMargins (0,0,0,0);return _cagg ;};func (_gba *creatorContext )drawAxes (_bgbd []*_df .CT_PlotAreaChoice1 ,_dfag ,_dadd ,_cafe float64 ,_dbcb []string ,_egde *Rectangle ,_dgd bool )error {_aea :=_gba ._bfd ;
_fcab :=_gba ._fed ;if _bgbd ==nil {return _gf .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};var (_gagc *_df .CT_ValAx ;_gbb *_df .CT_CatAx ;_cdc *_df .CT_DateAx ;_aeg *_df .CT_SerAx ;
);for _ ,_defe :=range _bgbd {if _defe .ValAx !=nil {_gagc =_defe .ValAx ;}else if _defe .CatAx !=nil {_gbb =_defe .CatAx ;}else if _defe .DateAx !=nil {_cdc =_defe .DateAx ;}else if _defe .SerAx !=nil {_aeg =_defe .SerAx ;};};if _gagc ==nil ||(_gbb ==nil &&_cdc ==nil &&_aeg ==nil ){return _gf .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _aag ,_begc ,_dbb ,_bada uint32 ;var _dee ,_gbgd _df .ST_AxPos ;var _eaad ,_eabf _df .ST_TickMark ;var _fefg ,_gbbe *_df .CT_ChartLines ;var _ecc ,_ffc _df .ST_TickLblPos ;var _acd ,_aaec *_ga .CT_ShapeProperties ;var _fbc error ;_badb :=_egde .Right -_egde .Left ;
_fcbg :=_egde .Bottom -_egde .Top ;if _gagc !=nil {_begc ,_gbgd ,_eabf ,_ffc ,_gbbe ,_bada ,_aaec ,_fbc =_bdbg (_gagc );};if _gbgd !=_df .ST_AxPosL &&_gbgd !=_df .ST_AxPosB {return _gf .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_cgcd :=_dadd -_dfag ;_dbcf :=int (_cgcd /_cafe )+1;var _bafb ,_cba float64 ;switch _eabf {case _df .ST_TickMarkIn :_bafb ,_cba =_baae ,0;case _df .ST_TickMarkOut :_bafb ,_cba =0,_baae ;case _df .ST_TickMarkCross :_bafb ,_cba =_baae ,_baae ;};_bafb =_bafb *_fcab ;
_cba =_cba *_fcab ;var _aacf *_ga .CT_ShapeProperties ;if _gbbe !=nil {_aacf =_gbbe .SpPr ;};_bdbe ,_bbca :=_ecc !=_df .ST_TickLblPosNone ,_ffc !=_df .ST_TickLblPosNone ;_eccg :=_dfag ;if _gbb !=nil {_aag ,_dee ,_eaad ,_ecc ,_fefg ,_dbb ,_acd ,_fbc =_deaa (_gbb );
}else if _cdc !=nil {_aag ,_dee ,_eaad ,_ecc ,_fefg ,_dbb ,_acd ,_fbc =_adf (_cdc );}else if _aeg !=nil {_aag ,_dee ,_eaad ,_ecc ,_fefg ,_dbb ,_acd ,_fbc =_daae (_aeg );};if _fbc !=nil {return _fbc ;};if _dee !=_df .ST_AxPosL &&_dee !=_df .ST_AxPosB {return _gf .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _aag !=_bada ||_begc !=_dbb {return _gf .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_eccd :=len (_dbcb )+1;var _daa ,_adg float64 ;switch _eaad {case _df .ST_TickMarkIn :_daa ,_adg =_baae ,0;
case _df .ST_TickMarkOut :_daa ,_adg =0,_baae ;case _df .ST_TickMarkCross :_daa ,_adg =_baae ,_baae ;};_daa =_daa *_fcab ;_adg =_adg *_fcab ;var _abd *_ga .CT_ShapeProperties ;if _fefg !=nil {_abd =_fefg .SpPr ;};if _dgd {_dabb :=_fcbg /float64 (len (_dbcb ));
_gaa :=_egde .Left -_dfag *_badb /_cgcd ;_acc :=_gaa -_ebdg *_fcab ;if _bdbe {var _cbd float64 ;for _cea :=0;_cea < _eccd ;_cea ++{_aaf :=_egde .Bottom -float64 (_cea )*_dabb ;if _cea < _eccd -1{_abdg :=_aea .NewParagraph (_dbcb [_cea ]);_abdg .SetFontSize (_dade *_fcab );
_abdg .SetPos (_acc ,_aaf -_dabb /2-_efg *_fcab );_aea .Draw (_abdg );_gdgc :=(_abdg .Width ()/1000-_ebdg )*_fcab ;if _gdgc > 0&&_gdgc > _cbd {_cbd =_gdgc ;};};};if _cbd > 0{_egde .Left +=_cbd +_bac ;_gaa =_egde .Left -_dfag *_badb /_cgcd ;_badb =_egde .Right -_egde .Left ;
};};_addf :=_gaa -_adg ;_ebcg :=_gaa +_daa ;_dabf :=_egde .Left ;_ded :=_egde .Right ;for _begbb :=0;_begbb < _eccd ;_begbb ++{_gee :=_egde .Bottom -float64 (_begbb )*_dabb ;_gba .drawLineWithProps (_acd ,_addf ,_gee ,_ebcg ,_gee ,true );_gba .drawLineWithProps (_abd ,_dabf ,_gee ,_ded ,_gee ,true );
};_fag :=_badb /_cgcd ;_dgg :=_egde .Bottom -_bafb ;_gadd :=_egde .Bottom +_cba ;_bcga :=_egde .Top ;_dgfb :=_egde .Bottom ;for _efge :=0;_efge < _dbcf ;_efge ++{_ega :=_egde .Left +(_eccg -_dfag )*_fag ;_gba .drawLineWithProps (_aaec ,_ega ,_dgg ,_ega ,_gadd ,true );
_gba .drawLineWithProps (_aacf ,_ega ,_bcga ,_ega ,_dgfb ,true );if _bbca {_gcb :=_aea .NewParagraph (_eg .FormatFloat (_eccg ,'g',-1,64));_gcb .SetFontSize (_dade *_fcab );_gcb .SetPos (_ega -_afd *_fcab ,_dgfb +_bff *_fcab );_aea .Draw (_gcb );};_eccg +=_cafe ;
};}else {_agced :=_fcbg /_cgcd ;_babe :=_egde .Left ;if _bbca {var _bfbf float64 ;for _gdec :=0;_gdec < _dbcf ;_gdec ++{_abc :=_egde .Bottom -(_eccg -_dfag )*_agced ;_dfga :=_aea .NewParagraph (_eg .FormatFloat (_eccg ,'g',-1,64));_dfga .SetFontSize (_dade *_fcab );
_dfga .SetPos (_babe -_ebdg *_fcab ,_abc -_efg *_fcab );_aea .Draw (_dfga );_eeagc :=(_dfga .Width ()/1000-_ebdg )*_fcab ;if _eeagc > 0&&_eeagc > _bfbf {_bfbf =_eeagc ;};_eccg +=_cafe ;};if _bfbf > 0{_egde .Left +=_bfbf +_bac ;_badb =_egde .Right -_egde .Left ;
};};_eccg =_dfag ;_becb :=_egde .Left -_cba ;_ddgb :=_egde .Left +_bafb ;_babe =_egde .Left ;_bdc :=_egde .Right ;for _bbcg :=0;_bbcg < _dbcf ;_bbcg ++{_bfa :=_egde .Bottom -(_eccg -_dfag )*_agced ;_gba .drawLineWithProps (_aaec ,_becb ,_bfa ,_ddgb ,_bfa ,true );
_gba .drawLineWithProps (_aacf ,_babe ,_bfa ,_bdc ,_bfa ,true );_eccg +=_cafe ;};_bfgg :=_badb /float64 (len (_dbcb ));_bdfd :=_egde .Bottom +_dfag *_fcbg /_cgcd ;_befc :=_bdfd -_daa ;_aaa :=_bdfd +_adg ;_gecf :=_egde .Top ;_gcbc :=_egde .Bottom ;_gegd :=_bdfd +_bff *_fcab ;
for _daf :=0;_daf < _eccd ;_daf ++{_dfgg :=_egde .Left +float64 (_daf )*_bfgg ;_gba .drawLineWithProps (_acd ,_dfgg ,_befc ,_dfgg ,_aaa ,true );_gba .drawLineWithProps (_abd ,_dfgg ,_gecf ,_dfgg ,_gcbc ,true );if _bdbe &&_daf < _eccd -1{_cac :=_aea .NewParagraph (_dbcb [_daf ]);
_cac .SetFontSize (_dade *_fcab );_cac .SetPos (_dfgg +_dfc *_fcab ,_gegd );_aea .Draw (_cac );};};};return nil ;};type creatorContext struct{_bfd *_fbf .Creator ;_fgd *_ga .Theme ;_fed float64 ;};func MakeTempCreatorMaxHeight (width float64 )*_fbf .Creator {return MakeTempCreator (width ,_ee .MaxFloat64 );
};func ParseExcelRange (s string )(string ,_ea .CellReference ,_ea .CellReference ,error ){_cfac :=_ec .FieldsFunc (s ,func (_afbb rune )bool {return _afbb ==':'||_afbb =='!'});if len (_cfac )==3{_bgce ,_ccfb :=_ea .ParseCellReference (_cfac [1]);if _ccfb !=nil {return "",_ea .CellReference {},_ea .CellReference {},_ccfb ;
};_faag ,_ccfb :=_ea .ParseCellReference (_cfac [2]);if _ccfb !=nil {return "",_ea .CellReference {},_ea .CellReference {},_ccfb ;};return _cfac [0],_bgce ,_faag ,nil ;};return "",_ea .CellReference {},_ea .CellReference {},_gf .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");
};func FillRectangle (c *_fbf .Creator ,x ,y ,width ,height float64 ,color _fbf .Color ){if color ==nil {return ;};_aec :=c .NewRectangle (x ,y ,width ,height );_aec .SetFillColor (color );_aec .SetBorderWidth (0);c .Draw (_aec );};var _bac =_fdae (2);
func (_fbce *creatorContext )getPdfColorFromSolidFill (_bcfg *_ga .CT_SolidColorFillProperties )_fbf .Color {if _bcfg ==nil {return nil ;};_eaf :="";if _eafc :=_bcfg .SrgbClr ;_eafc !=nil {_eaf =_eafc .ValAttr ;}else if _ddcf :=_bcfg .SchemeClr ;_ddcf !=nil {_eaf =_aba (_ddcf .ValAttr ,_fbce ._fgd );
_eaf =AdjustColor (_eaf ,_ddcf .EG_ColorTransform );};if _eaf ==""{return nil ;};return _fbf .ColorRGBFromHex ("\u0023"+_eaf );};var _afd =_fdae (0.5);var _baae =_fdae (1);type ImgPart byte ;