//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_cb "bytes";_e "errors";_f "fmt";_ea "github.com/unidoc/unichart";_ge "github.com/unidoc/unichart/dataset";_ec "github.com/unidoc/unichart/render";_ca "github.com/unidoc/unioffice/common/logger";_ff "github.com/unidoc/unioffice/document";
_ccb "github.com/unidoc/unioffice/measurement";_af "github.com/unidoc/unioffice/schema/soo/dml";_gf "github.com/unidoc/unioffice/schema/soo/dml/chart";_dg "github.com/unidoc/unioffice/spreadsheet";_bc "github.com/unidoc/unioffice/spreadsheet/format";_fe "github.com/unidoc/unioffice/spreadsheet/formula";
_bgg "github.com/unidoc/unioffice/spreadsheet/reference";_ed "github.com/unidoc/unipdf/v3/core";_cd "github.com/unidoc/unipdf/v3/creator";_db "github.com/unidoc/unipdf/v3/model";_ece "github.com/unidoc/unipdf/v3/render";_eae "github.com/unidoc/unitype";
_a "image";_gc "math";_g "os";_be "regexp";_d "sort";_cc "strconv";_ag "strings";_bg "sync";_b "unicode";);func (_bbe barSerByOrder )Len ()int {return len (_bbe )};var _abd =_adgf (7.5);func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func GetGroupOffsetFromXfrm (xfrm *_af .CT_GroupTransform2D )(float64 ,float64 ){var _fagg ,_debg float64 ;
if xfrm .Off !=nil &&xfrm .ChOff !=nil {_fagg =_ccb .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_ccb .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));_debg =_ccb .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_ccb .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));
};return _fagg ,_debg ;};func _gdgg (_caag *_gf .ChartSpace ,_fge ,_ffef float64 ,_bfe *_af .Theme ,_begd bool ,_gff *_dg .Workbook )(*_cd .Creator ,error ){_gbgf :=1.0;if _begd {_gbgf =8.0;};_cdab :=&Rectangle {};_fged :=&Rectangle {Top :_cdab .Top ,Bottom :_ffef -_cdab .Bottom ,Left :_cdab .Left ,Right :_fge -_cdab .Right };
_dcfb :=MakeTempCreator (_fge *_gbgf +1,_ffef *_gbgf +1);_bbb :=&creatorContext {_dba :_dcfb ,_bbed :_bfe ,_abc :_gbgf };var _ged bool ;if _dec :=_caag .Chart ;_dec !=nil {_egc :=_dec .PlotArea ;if _egc ==nil {return nil ,_e .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");
};_fec :=0.0;if _dec .AutoTitleDeleted !=nil &&_dec .AutoTitleDeleted .ValAttr !=nil &&!*_dec .AutoTitleDeleted .ValAttr {_aed :="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";if _dec .Title !=nil &&_dec .Title .Overlay !=nil &&_dec .Title .Overlay .ValAttr !=nil &&!*_dec .Title .Overlay .ValAttr {_fec =_adgf (10);
};if _dec .Title !=nil &&_dec .Title .Tx !=nil &&_dec .Title .Tx .Choice !=nil &&_dec .Title .Tx .Choice .Rich !=nil {if len (_dec .Title .Tx .Choice .Rich .P )> 0{if len (_dec .Title .Tx .Choice .Rich .P [0].EG_TextRun )> 0{_aed =_dec .Title .Tx .Choice .Rich .P [0].EG_TextRun [0].R .T ;
};};};_bbb .drawTitle (_aed ,_fged .Left +_fged .Right /2,_adgf (5));};_fd :=&Rectangle {Top :_adgf (10)+_fec ,Bottom :_fged .Bottom -_adgf (15),Left :_adgf (10),Right :_fged .Right -_adgf (10)};var _ccd *Rectangle ;_cba :=_dec .Legend ;if _cba !=nil {_cef :=_cba .Overlay !=nil &&_cba .Overlay .ValAttr !=nil &&*_cba .Overlay .ValAttr ;
if _bdeb :=_cba .LegendPos ;_bdeb !=nil {switch _bdeb .ValAttr {case _gf .ST_LegendPosTr :if !_cef {_fd =&Rectangle {Top :_adgf (25)+_fec ,Bottom :_fged .Bottom -_adgf (10),Left :_adgf (10),Right :_fged .Right -_adgf (25)};};_ccd =&Rectangle {Top :_adgf (2.5)+_fec ,Bottom :_adgf (22.5),Left :_fged .Right -_adgf (22.5),Right :_fged .Right -_adgf (2.5)};
case _gf .ST_LegendPosT :_ccd =&Rectangle {Top :_adgf (2.5)+_fec ,Bottom :_adgf (7.5),Left :(_fged .Right -_fged .Left )*0.25,Right :(_fged .Right -_fged .Left )*0.75};if !_cef {_fd =&Rectangle {Top :_adgf (12.5)+_fec ,Bottom :_fged .Bottom -_adgf (15),Left :_adgf (10),Right :_fged .Right -_adgf (5)};
};_ged =true ;case _gf .ST_LegendPosB :_ccd =&Rectangle {Top :_fged .Bottom -_adgf (7.5)+_fec ,Bottom :_fged .Bottom -_adgf (2.5),Left :(_fged .Right -_fged .Left )*0.25,Right :(_fged .Right -_fged .Left )*0.75};if !_cef {_fd =&Rectangle {Top :_adgf (5)+_fec ,Bottom :_fged .Bottom -_adgf (15),Left :_adgf (10),Right :_fged .Right -_adgf (5)};
};_ged =true ;case _gf .ST_LegendPosR :_ccd =&Rectangle {Top :(_fged .Bottom -_fged .Top )/2-_adgf (10)+_fec ,Bottom :(_fged .Bottom -_fged .Top )/2+_adgf (10),Left :_fged .Right -_adgf (22.5),Right :_fged .Right -_adgf (2.5)};if !_cef {_fd =&Rectangle {Top :_adgf (5)+_fec ,Bottom :_fged .Bottom -_adgf (12.5),Left :_adgf (10),Right :_fged .Right -_adgf (25)};
};case _gf .ST_LegendPosL :_ccd =&Rectangle {Top :(_fged .Bottom -_fged .Top )/2-_adgf (10)+_fec ,Bottom :(_fged .Bottom -_fged .Top )/2+_adgf (10),Left :_adgf (2.5),Right :_adgf (22.5)};if !_cef {_fd =&Rectangle {Top :_adgf (5)+_fec ,Bottom :_fged .Bottom -_adgf (12.5),Left :_adgf (30),Right :_fged .Right -_adgf (5)};
};default:_ccd =&Rectangle {Top :(_fged .Bottom -_fged .Top )/2-_adgf (10)+_fec ,Bottom :(_fged .Bottom -_fged .Top )/2+_adgf (10),Left :_fged .Right -_adgf (25),Right :_fged .Right -_adgf (5)};if !_cef {_fd =&Rectangle {Top :_adgf (5)+_fec ,Bottom :_fged .Bottom -_adgf (12.5),Left :_adgf (100),Right :_fged .Right -_adgf (25)};
};};};};_fd .scale (_gbgf );_bbb .drawBorderWithProps (_egc .SpPr ,_fd ,_gba );_ffee :=[]*legendItem {};var _cgd error ;_dccb :=_egc .CChoice ;for _ ,_faa :=range _egc .Choice {if _dac :=_faa .BarChart ;_dac !=nil {_ffee ,_cgd =_bbb .drawBarChart (_dac ,_fd ,_dccb ,_gff );
if _cgd !=nil {return nil ,_cgd ;};};if _bgc :=_faa .PieChart ;_bgc !=nil {_ffee ,_cgd =_bbb .drawPieChart (_bgc ,_fd ,_gff ,_gbgf );if _cgd !=nil {return nil ,_cgd ;};};};if _cba !=nil {_ccd .scale (_gbgf );_bbb .drawBorderWithProps (_cba .SpPr ,_ccd ,_gba );
if len (_ffee )!=0{_bbb .drawLegend (_ccd ,_ffee ,_ged );};};};_fged .scale (_gbgf );_bbb .drawBorderWithProps (_caag .SpPr ,_fged ,_gba );return _dcfb ,nil ;};func (_ebc barSerByOrder )Swap (i ,j int ){_ebc [i ],_ebc [j ]=_ebc [j ],_ebc [i ]};func ClearRegisteredFonts (){_gcbd ._gdda .Lock ();
_gcbd ._faed =map[string ]map[FontStyle ]*_db .PdfFont {};_gcbd ._gdda .Unlock ();};func RegisterFontsFromDirectory (dirName string )error {_gcf ,_fdbf :=_g .Open (dirName );if _fdbf !=nil {return _fdbf ;};defer _gcf .Close ();_ead ,_fdbf :=_gcf .Readdirnames (0);
if _fdbf !=nil {return _fdbf ;};for _ ,_cfeg :=range _ead {if _ag .HasSuffix (_cfeg ,"\u002e\u0074\u0074\u0066"){_fbad :=dirName +"\u002f"+_cfeg ;_cbba :=_gee (_fbad );if _cbba !=nil {_ca .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_cbba );
continue ;};};};return nil ;};var (DefaultFontSize =12.0;DefaultImageEncoder _ed .StreamEncoder ;);func GetOpacityFromColorTransform (trs []*_af .EG_ColorTransform )float64 {for _ ,_bcgf :=range trs {if _bcgf !=nil {if _fcd :=_bcgf .Alpha ;_fcd !=nil {if _effg :=_fcd .ValAttr .ST_PositiveFixedPercentageDecimal ;
_effg !=nil {return float64 (*_effg )/100000;};};};};return 1.0;};func _gcab (_aefg *_ff .Document ,_accg ,_beaa ,_gfd string )error {_bce ,_aba :=_aefg .GetFontBytesByRelId (_beaa );if _aba !=nil {return _aba ;};_egdg ,_aba :=_geddf (_gfd );if _aba !=nil {return _aba ;
};for _dfg :=0;_dfg < 32;_dfg ++{_bcgcf :=_dfg %len (_egdg );_bce [_dfg ]=_bce [_dfg ]^_egdg [_bcgcf ];};_ffd :=_aefg .TmpPath +"\u002f"+_accg +"\u002e\u0074\u0074\u0066";_aba =_g .WriteFile (_ffd ,_bce ,0644);if _aba !=nil {return _aba ;};_gee (_ffd );
return nil ;};type fontsMap struct{_gdda *_bg .Mutex ;_faed map[string ]map[FontStyle ]*_db .PdfFont ;};func _adgf (_gfcde float64 )float64 {return _gfcde *_ccb .Millimeter };var _aaf =_adgf (1.5);func GetColorStringFromDmlColor (dmlColor *_af .CT_Color )string {var _cbc string ;
if _bag :=dmlColor .SrgbClr ;_bag !=nil {_cbc =_bag .ValAttr ;}else if _ega :=dmlColor .SysClr ;_ega !=nil {if _ega .LastClrAttr !=nil {return *_ega .LastClrAttr ;};return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _cbc ;};func _dgeg (_bcdb uint8 ,_gefb float64 )string {_eccc :=float64 (_bcdb );
var _gce float64 ;if _gefb < 0{_gce =_eccc *(1+_gefb );}else {_gce =_eccc +(255-_eccc )*_gefb ;};return _f .Sprintf ("\u0025\u0030\u0032\u0078",int (_gce ));};func AssignStdFontByName (style _cd .TextStyle ,fontName string )*_db .PdfFont {_cfaab :=_db .StdFontName (fontName );
return _db .NewStandard14FontMustCompile (_cfaab );};var _bece =_adgf (1.5);type serValue struct{_daf string ;_edg float64 ;_dcef *_af .CT_ShapeProperties ;};func (_cdde *Rectangle )scale (_efeb float64 ){_cdde .Top *=_efeb ;_cdde .Bottom *=_efeb ;_cdde .Left *=_efeb ;
_cdde .Right *=_efeb ;};func _bgf (_geaf *_gf .CT_ValAx )(uint32 ,_gf .ST_AxPos ,_gf .ST_TickMark ,_gf .ST_TickLblPos ,*_gf .CT_ChartLines ,uint32 ,*_af .CT_ShapeProperties ,error ){var _deb ,_bgaf uint32 ;var _dae _gf .ST_AxPos ;var _fca _gf .ST_TickMark ;
var _bef *_gf .CT_ChartLines ;var _dcfbf _gf .ST_TickLblPos ;if _geaf .AxId ==nil {return _deb ,_dae ,_fca ,_dcfbf ,_bef ,_bgaf ,_geaf .SpPr ,_e .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_deb =_geaf .AxId .ValAttr ;
};if _geaf .AxPos ==nil {return _deb ,_dae ,_fca ,_dcfbf ,_bef ,_bgaf ,_geaf .SpPr ,_e .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_dae =_geaf .AxPos .ValAttr ;};if _geaf .MajorTickMark !=nil {_fca =_geaf .MajorTickMark .ValAttr ;
};if _geaf .TickLblPos !=nil {_dcfbf =_geaf .TickLblPos .ValAttr ;};if _geaf .CrossAx ==nil {return _deb ,_dae ,_fca ,_dcfbf ,_bef ,_bgaf ,_geaf .SpPr ,_e .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bgaf =_geaf .CrossAx .ValAttr ;
};_bef =_geaf .MajorGridlines ;return _deb ,_dae ,_fca ,_dcfbf ,_bef ,_bgaf ,_geaf .SpPr ,nil ;};func IsNoSpaceLanguage (symbol string )bool {for _ ,_edb :=range symbol {if _b .Is (_b .Han ,_edb ){return true ;};};return false ;};func (_cbd barSerByOrder )Less (i ,j int )bool {return _cbd [i ].Order .ValAttr < _cbd [j ].Order .ValAttr };
func (_cagc *creatorContext )drawLineWithProps (_gggb *_af .CT_ShapeProperties ,_ggeed ,_egbc ,_bege ,_fag float64 ,_fcg bool ){if _gggb !=nil {if _beced :=_gggb .Ln ;_beced !=nil {_cebd :=_cagc .getPdfColorFromSolidFill (_beced .SolidFill );if _cebd ==nil &&_fcg {_cebd =_cd .ColorBlack ;
};if _cebd !=nil {var _bcac float64 ;if _bdaa :=_beced .WAttr ;_bdaa !=nil {_bcac =_ccb .FromEMU (int64 (*_bdaa ));}else {_bcac =_gba ;};DrawLine (_cagc ._dba ,_ggeed ,_egbc ,_bege ,_fag ,_bcac ,_cebd );};};};};var _fdb =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);var RtlFontFile *_db .PdfFont ;var _gcbd =fontsMap {_gdda :&_bg .Mutex {},_faed :map[string ]map[FontStyle ]*_db .PdfFont {}};
func TwipsFromPoints (points float64 )float64 {return points /_ccb .Twips };func (_dcf *creatorContext )addCatValue (_abef string ,_fedf map[string ]serCategory ,_gge []string ,_agc int ,_dce ,_bcd *float64 ,_aaa string ,_gdg *_af .CT_ShapeProperties ){_ddb ,_eef :=_cc .ParseFloat (_abef ,64);
if _eef !=nil {_ddb =0;_ca .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_eef );};if _ddb > *_bcd {*_bcd =_ddb ;};if _ddb < *_dce {*_dce =_ddb ;};_ffe :=_fedf [_gge [_agc ]];_ffe ._afe =append (_ffe ._afe ,serValue {_daf :_aaa ,_edg :_ddb ,_dcef :_gdg });
_fedf [_gge [_agc ]]=_ffe ;};func _gef (_gcad *_gf .CT_DateAx )(uint32 ,_gf .ST_AxPos ,_gf .ST_TickMark ,_gf .ST_TickLblPos ,*_gf .CT_ChartLines ,uint32 ,*_af .CT_ShapeProperties ,error ){var _abedg ,_adg uint32 ;var _baab _gf .ST_AxPos ;var _dccf _gf .ST_TickMark ;
var _edfb *_gf .CT_ChartLines ;var _gcbe _gf .ST_TickLblPos ;if _gcad .AxId ==nil {return _abedg ,_baab ,_dccf ,_gcbe ,_edfb ,_adg ,_gcad .SpPr ,_e .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_abedg =_gcad .AxId .ValAttr ;
};if _gcad .AxPos ==nil {return _abedg ,_baab ,_dccf ,_gcbe ,_edfb ,_adg ,_gcad .SpPr ,_e .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_baab =_gcad .AxPos .ValAttr ;};if _gcad .MajorTickMark !=nil {_dccf =_gcad .MajorTickMark .ValAttr ;
};if _gcad .TickLblPos !=nil {_gcbe =_gcad .TickLblPos .ValAttr ;};if _gcad .CrossAx ==nil {return _abedg ,_baab ,_dccf ,_gcbe ,_edfb ,_adg ,_gcad .SpPr ,_e .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_adg =_gcad .CrossAx .ValAttr ;};_edfb =_gcad .MajorGridlines ;return _abedg ,_baab ,_dccf ,_gcbe ,_edfb ,_adg ,_gcad .SpPr ,nil ;};func _geac (_gac *_gf .CT_CatAx )(uint32 ,_gf .ST_AxPos ,_gf .ST_TickMark ,_gf .ST_TickLblPos ,*_gf .CT_ChartLines ,uint32 ,*_af .CT_ShapeProperties ,error ){var _daab ,_cbaf uint32 ;
var _bbd _gf .ST_AxPos ;var _bcda _gf .ST_TickMark ;var _afbbe *_gf .CT_ChartLines ;var _dacb _gf .ST_TickLblPos ;if _gac .AxId ==nil {return _daab ,_bbd ,_bcda ,_dacb ,_afbbe ,_cbaf ,_gac .SpPr ,_e .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_daab =_gac .AxId .ValAttr ;};if _gac .AxPos ==nil {return _daab ,_bbd ,_bcda ,_dacb ,_afbbe ,_cbaf ,_gac .SpPr ,_e .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_bbd =_gac .AxPos .ValAttr ;
};if _gac .MajorTickMark !=nil {_bcda =_gac .MajorTickMark .ValAttr ;};if _gac .TickLblPos !=nil {_dacb =_gac .TickLblPos .ValAttr ;};if _gac .CrossAx ==nil {return _daab ,_bbd ,_bcda ,_dacb ,_afbbe ,_cbaf ,_gac .SpPr ,_e .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_cbaf =_gac .CrossAx .ValAttr ;};_afbbe =_gac .MajorGridlines ;return _daab ,_bbd ,_bcda ,_dacb ,_afbbe ,_cbaf ,_gac .SpPr ,nil ;};func CropImageByRect (sourceImg _a .Image ,rect _a .Rectangle )_a .Image {_fddf ,_edfe ,_gcc ,_bgba :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;
_gcae :=_a .NewNRGBA (_a .Rect (0,0,_gcc -_fddf ,_bgba -_edfe ));for _fcga :=_fddf ;_fcga < _gcc ;_fcga ++{for _aebe :=_edfe ;_aebe < _bgba ;_aebe ++{_gcae .Set (_fcga -_fddf ,_aebe -_edfe ,sourceImg .At (_fcga ,_aebe ));};};return _gcae ;};const (FontStyle_Regular FontStyle =0;
FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);var _gead =_adgf (0.5);func _geddf (_dgee string )([]byte ,error ){_acb :=_be .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");
_dgee =_acb .ReplaceAllString (_dgee ,"");_fecg :=[]rune (_dgee );_effgb :=[]byte {};for _dfgf :=len (_fecg )-2;_dfgf >=0;_dfgf -=2{_eab ,_eaac :=_cc .ParseUint (string (_fecg [_dfgf ])+string (_fecg [_dfgf +1]),16,8);if _eaac !=nil {return nil ,_eaac ;
};_effgb =append (_effgb ,byte (_eab ));};return _effgb ,nil ;};func _ecd (_bbc float64 )float64 {if _bbc < 0{_bbc +=float64 (-int (_bbc )+1);}else if _bbc > 1{_bbc -=float64 (int (_bbc ));};return _bbc ;};func _ebgc (_fcag ,_cddb ,_cffe float64 )(uint8 ,uint8 ,uint8 ){var _bbf float64 ;
if _cffe < 0.5{_bbf =_cffe *(1+_cddb );}else {_bbf =_cffe +_cddb -_cffe *_cddb ;};_befb :=_cffe *2-_bbf ;_fcag /=360.0;_cdfd :=_ecd (_fcag +1.0/3.0);_gedd :=_ecd (_fcag );_agaab :=_ecd (_fcag -1.0/3.0);_aca :=_cdg (_cdfd ,_bbf ,_befb );_fegc :=_cdg (_gedd ,_bbf ,_befb );
_baad :=_cdg (_agaab ,_bbf ,_befb );return uint8 (255*_aca ),uint8 (255*_fegc ),uint8 (255*_baad );};func (_gbe *creatorContext )drawAxes (_ebg *_gf .CT_PlotAreaChoice1 ,_dea ,_eff ,_gdgf float64 ,_bafa []string ,_dgg *Rectangle ,_fbg bool )error {_ebb :=_gbe ._dba ;
_gddd :=_gbe ._abc ;if _ebg ==nil {return _e .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_ebg .ValAx )==0||(len (_ebg .CatAx )==0&&len (_ebg .DateAx )==0&&len (_ebg .SerAx )==0){return _e .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _bafc ,_bgbe ,_fgac ,_gcg uint32 ;var _aeb ,_bgbb _gf .ST_AxPos ;var _ada ,_gcb _gf .ST_TickMark ;var _dcag ,_ggeb *_gf .CT_ChartLines ;var _cgab ,_efe _gf .ST_TickLblPos ;var _gaac ,_bdf *_af .CT_ShapeProperties ;var _ccc error ;_eefd :=_dgg .Right -_dgg .Left ;
_cdc :=_dgg .Bottom -_dgg .Top ;if len (_ebg .ValAx )> 0{_bgbe ,_bgbb ,_gcb ,_efe ,_ggeb ,_gcg ,_bdf ,_ccc =_bgf (_ebg .ValAx [0]);};if _bgbb !=_gf .ST_AxPosL &&_bgbb !=_gf .ST_AxPosB {return _e .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_cbdb :=_eff -_dea ;_bdd :=int (_cbdb /_gdgf )+1;var _gfag ,_ceb float64 ;switch _gcb {case _gf .ST_TickMarkIn :_gfag ,_ceb =_egd ,0;case _gf .ST_TickMarkOut :_gfag ,_ceb =0,_egd ;case _gf .ST_TickMarkCross :_gfag ,_ceb =_egd ,_egd ;};_gfag =_gfag *_gddd ;
_ceb =_ceb *_gddd ;var _abg *_af .CT_ShapeProperties ;if _ggeb !=nil {_abg =_ggeb .SpPr ;};_gfe ,_ebbf :=_cgab !=_gf .ST_TickLblPosNone ,_efe !=_gf .ST_TickLblPosNone ;_cagd :=_dea ;if len (_ebg .CatAx )> 0{_bafc ,_aeb ,_ada ,_cgab ,_dcag ,_fgac ,_gaac ,_ccc =_geac (_ebg .CatAx [0]);
}else if len (_ebg .DateAx )> 0{_bafc ,_aeb ,_ada ,_cgab ,_dcag ,_fgac ,_gaac ,_ccc =_gef (_ebg .DateAx [0]);}else if len (_ebg .SerAx )> 0{_bafc ,_aeb ,_ada ,_cgab ,_dcag ,_fgac ,_gaac ,_ccc =_gfg (_ebg .SerAx [0]);};if _ccc !=nil {return _ccc ;};if _aeb !=_gf .ST_AxPosL &&_aeb !=_gf .ST_AxPosB {return _e .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _bafc !=_gcg ||_bgbe !=_fgac {return _e .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_gcgb :=len (_bafa )+1;var _ddd ,_bfad float64 ;switch _ada {case _gf .ST_TickMarkIn :_ddd ,_bfad =_egd ,0;
case _gf .ST_TickMarkOut :_ddd ,_bfad =0,_egd ;case _gf .ST_TickMarkCross :_ddd ,_bfad =_egd ,_egd ;};_ddd =_ddd *_gddd ;_bfad =_bfad *_gddd ;var _ffeg *_af .CT_ShapeProperties ;if _dcag !=nil {_ffeg =_dcag .SpPr ;};if _fbg {_bfg :=_cdc /float64 (len (_bafa ));
_aefc :=_dgg .Left -_dea *_eefd /_cbdb ;_dedc :=_aefc -_abd *_gddd ;if _gfe {var _gfagg float64 ;for _bea :=0;_bea < _gcgb ;_bea ++{_cdb :=_dgg .Bottom -float64 (_bea )*_bfg ;if _bea < _gcgb -1{_cdf :=_ebb .NewParagraph (_bafa [_bea ]);_cdf .SetFontSize (_bga *_gddd );
_cdf .SetPos (_dedc ,_cdb -_bfg /2-_aaf *_gddd );_ebb .Draw (_cdf );_cff :=(_cdf .Width ()/1000-_abd )*_gddd ;if _cff > 0&&_cff > _gfagg {_gfagg =_cff ;};};};if _gfagg > 0{_dgg .Left +=_gfagg +_bda ;_aefc =_dgg .Left -_dea *_eefd /_cbdb ;_eefd =_dgg .Right -_dgg .Left ;
};};_aad :=_aefc -_bfad ;_bbeg :=_aefc +_ddd ;_bfadf :=_dgg .Left ;_dgbc :=_dgg .Right ;for _fgga :=0;_fgga < _gcgb ;_fgga ++{_gggd :=_dgg .Bottom -float64 (_fgga )*_bfg ;_gbe .drawLineWithProps (_gaac ,_aad ,_gggd ,_bbeg ,_gggd ,true );_gbe .drawLineWithProps (_ffeg ,_bfadf ,_gggd ,_dgbc ,_gggd ,true );
};_bdfg :=_eefd /_cbdb ;_geg :=_dgg .Bottom -_gfag ;_fdc :=_dgg .Bottom +_ceb ;_dde :=_dgg .Top ;_eba :=_dgg .Bottom ;for _fbc :=0;_fbc < _bdd ;_fbc ++{_gcba :=_dgg .Left +(_cagd -_dea )*_bdfg ;_gbe .drawLineWithProps (_bdf ,_gcba ,_geg ,_gcba ,_fdc ,true );
_gbe .drawLineWithProps (_abg ,_gcba ,_dde ,_gcba ,_eba ,true );if _ebbf {_bed :=_ebb .NewParagraph (_cc .FormatFloat (_cagd ,'g',-1,64));_bed .SetFontSize (_bga *_gddd );_bed .SetPos (_gcba -_gead *_gddd ,_eba +_bece *_gddd );_ebb .Draw (_bed );};_cagd +=_gdgf ;
};}else {_bfc :=_cdc /_cbdb ;_fba :=_dgg .Left ;if _ebbf {var _agd float64 ;for _dfc :=0;_dfc < _bdd ;_dfc ++{_edfg :=_dgg .Bottom -(_cagd -_dea )*_bfc ;_dbc :=_ebb .NewParagraph (_cc .FormatFloat (_cagd ,'g',-1,64));_dbc .SetFontSize (_bga *_gddd );_dbc .SetPos (_fba -_abd *_gddd ,_edfg -_aaf *_gddd );
_ebb .Draw (_dbc );_faae :=(_dbc .Width ()/1000-_abd )*_gddd ;if _faae > 0&&_faae > _agd {_agd =_faae ;};_cagd +=_gdgf ;};if _agd > 0{_dgg .Left +=_agd +_bda ;_eefd =_dgg .Right -_dgg .Left ;};};_cagd =_dea ;_dge :=_dgg .Left -_ceb ;_fda :=_dgg .Left +_gfag ;
_fba =_dgg .Left ;_edd :=_dgg .Right ;for _bddb :=0;_bddb < _bdd ;_bddb ++{_aec :=_dgg .Bottom -(_cagd -_dea )*_bfc ;_gbe .drawLineWithProps (_bdf ,_dge ,_aec ,_fda ,_aec ,true );_gbe .drawLineWithProps (_abg ,_fba ,_aec ,_edd ,_aec ,true );_cagd +=_gdgf ;
};_cded :=_eefd /float64 (len (_bafa ));_cfb :=_dgg .Bottom +_dea *_cdc /_cbdb ;_gebf :=_cfb -_ddd ;_bdff :=_cfb +_bfad ;_daa :=_dgg .Top ;_dab :=_dgg .Bottom ;_gbc :=_cfb +_bece *_gddd ;for _dda :=0;_dda < _gcgb ;_dda ++{_adc :=_dgg .Left +float64 (_dda )*_cded ;
_gbe .drawLineWithProps (_gaac ,_adc ,_gebf ,_adc ,_bdff ,true );_gbe .drawLineWithProps (_ffeg ,_adc ,_daa ,_adc ,_dab ,true );if _gfe &&_dda < _gcgb -1{_afbfg :=_ebb .NewParagraph (_bafa [_dda ]);_afbfg .SetFontSize (_bga *_gddd );_afbfg .SetPos (_adc +_bbg *_gddd ,_gbc );
_ebb .Draw (_afbfg );};};};return nil ;};func (_dbfe *creatorContext )addCatName (_acc string ,_gfbe map[string ]serCategory ,_edf *[]string ){if _ ,_fgg :=_gfbe [_acc ];!_fgg {_gfbe [_acc ]=serCategory {_fbb :_acc ,_afe :[]serValue {}};*_edf =append (*_edf ,_acc );
};};var _bggb =_adgf (1.5);func ParseExcelRange (s string )(string ,_bgg .CellReference ,_bgg .CellReference ,error ){_ddda :=_ag .FieldsFunc (s ,func (_aebb rune )bool {return _aebb ==':'||_aebb =='!'});if len (_ddda )==3{_eegf ,_dfe :=_bgg .ParseCellReference (_ddda [1]);
if _dfe !=nil {return "",_bgg .CellReference {},_bgg .CellReference {},_dfe ;};_gcff ,_dfe :=_bgg .ParseCellReference (_ddda [2]);if _dfe !=nil {return "",_bgg .CellReference {},_bgg .CellReference {},_dfe ;};return _ddda [0],_eegf ,_gcff ,nil ;};return "",_bgg .CellReference {},_bgg .CellReference {},_e .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");
};const _bga =6.0;type serCategory struct{_fbb string ;_afe []serValue ;};func LoadFontFromFile (filename string )(*_db .PdfFont ,error ){if !_ag .HasSuffix (filename ,"\u002e\u0074\u0074\u0066"){_ca .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return nil ,_f .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_bggc ,_gceg :=_db .NewCompositePdfFontFromTTFFile (filename );if _gceg !=nil {return nil ,_gceg ;};return _bggc ,nil ;};func GetPageFromCreator (c *_cd .Creator )(*_db .PdfPage ,error ){_efag :=_cb .NewBuffer ([]byte {});_ffdf :=c .Write (_efag );if _ffdf !=nil {return nil ,_ffdf ;
};_egfb :=_cb .NewReader (_efag .Bytes ());_agcd ,_ffdf :=_db .NewPdfReader (_egfb );if _ffdf !=nil {return nil ,_ffdf ;};return _agcd .GetPage (1);};func (_dfad *creatorContext )drawLegend (_fcc *Rectangle ,_afee []*legendItem ,_dgd bool ){_cdag :=_dfad ._abc ;
_gca :=_adgf (2.5)*_cdag ;_fffe :=_bggb *_cdag ;_fbe :=(_gca -_fffe )/2;_ggef :=float64 (len (_afee ));if _dgd {_bbbc :=&Rectangle {Top :_fcc .Top +_adgf (1)*_cdag ,Bottom :_fcc .Bottom -_adgf (1)*_cdag ,Left :_fcc .Left +_adgf (2.5)*_cdag ,Right :_fcc .Right -_adgf (2.5)*_cdag };
var _feba float64 ;if _ggef > 1{_feba =(_bbbc .Right -_bbbc .Left )/_ggef ;};_gdd :=_bbbc .Left ;_baa :=_bbbc .Top ;for _ ,_gbgc :=range _afee {if _aaad :=_gbgc ._dfd ;_aaad !=nil {_dfad .drawRectangleWithProps (_aaad ,_gdd ,_baa +_fbe ,_fffe ,_fffe ,false );
_aac :=_gdd +_fffe *2;_efa :=_dfad ._dba .NewStyledParagraph ();_efa .SetPos (_aac ,_baa );_gad :=_efa .Append (_gbgc ._gfce );_gebd ,_ceff :=_db .NewStandard14Font (_db .HelveticaName );if _ceff ==nil {_ddc :=_dfad ._dba .NewTextStyle ();_ddc .Font =_gebd ;
_ddc .FontSize =_gca ;_ddc .TextRise =0.4;_gad .Style =_ddc ;_dfad ._dba .Draw (_efa );};};_gdd +=_feba ;};}else {_cac :=&Rectangle {Top :_fcc .Top +_adgf (2.5)*_cdag ,Bottom :_fcc .Bottom -_adgf (2.5)*_cdag ,Left :_fcc .Left +_adgf (2.5)*_cdag ,Right :_fcc .Right -_adgf (2.5)*_cdag };
var _dfaf float64 ;if _ggef > 1{_dfaf =(_cac .Bottom -_cac .Top -_gca )/(_ggef -1);if _dfaf < _gca {_dfaf =_gca ;};};_fgf :=_cac .Top ;_afd :=_cac .Left ;_baf :=_afd +_fffe *2;for _ ,_bfa :=range _afee {if _aef :=_bfa ._dfd ;_aef !=nil {_dfad .drawRectangleWithProps (_aef ,_afd ,_fgf +_fbe ,_fffe ,_fffe ,false );
_ecf :=_dfad ._dba .NewStyledParagraph ();_ecf .SetPos (_baf ,_fgf );_ecf .SetWidth (_cac .Right -_cac .Left );_cfce :=_ecf .Append (_bfa ._gfce );_abf ,_abed :=_db .NewStandard14Font (_db .HelveticaName );if _abed ==nil {_gddf :=_dfad ._dba .NewTextStyle ();
_gddf .Font =_abf ;_gddf .FontSize =_gca ;_gddf .TextRise =0.4;_cfce .Style =_gddf ;_dfad ._dba .Draw (_ecf );};};_fgf +=_dfaf ;};};};func MakeTempCreator (width ,height float64 )*_cd .Creator {_dgdc :=_cd .New ();_dgdc .SetPageSize (_cd .PageSize {width ,height });
_dgdc .SetPageMargins (0,0,0,0);return _dgdc ;};func RegisterEmbeddedFonts (d *_ff .Document )error {_gbgcg :=d .FontTable ();if _gbgcg ==nil {return nil ;};for _ ,_agdd :=range _gbgcg .Font {if _agdd .EmbedRegular !=nil {return _gcab (d ,_agdd .NameAttr ,_agdd .EmbedRegular .IdAttr ,_agdd .EmbedRegular .FontKeyAttr );
};if _agdd .EmbedBold !=nil {return _gcab (d ,_agdd .NameAttr ,_agdd .EmbedBold .IdAttr ,_agdd .EmbedBold .FontKeyAttr );};if _agdd .EmbedItalic !=nil {return _gcab (d ,_agdd .NameAttr ,_agdd .EmbedItalic .IdAttr ,_agdd .EmbedItalic .FontKeyAttr );};if _agdd .EmbedBoldItalic !=nil {return _gcab (d ,_agdd .NameAttr ,_agdd .EmbedBoldItalic .IdAttr ,_agdd .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};func DrawRectangle (c *_cd .Creator ,r *Rectangle ,w float64 ,color _cd .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );
DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};func _cebc (_bdce _af .ST_SchemeColorVal ,_dbce *_af .Theme )string {if _fcaf :=_dbce .ThemeElements ;_fcaf !=nil {if _gfab :=_fcaf .ClrScheme ;_gfab !=nil {switch _bdce {case _af .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_gfab .Lt1 );
case _af .ST_SchemeColorValDk1 ,_af .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_gfab .Dk1 );case _af .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_gfab .Lt2 );case _af .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_gfab .Dk2 );
case _af .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_gfab .Accent1 );case _af .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_gfab .Accent2 );case _af .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_gfab .Accent3 );
case _af .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_gfab .Accent4 );case _af .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_gfab .Accent5 );case _af .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_gfab .Accent6 );
};};};return "";};func (_age *creatorContext )drawPieChart (_gbgb *_gf .CT_PieChart ,_dgf *Rectangle ,_gbb *_dg .Workbook ,_cdba float64 )([]*legendItem ,error ){_fbeg :=[]*legendItem {};_aaeb :=map[string ]serCategory {};_cbde :=[]string {};_cefa :=_gc .Inf (1);
_cecf :=_gc .Inf (-1);_agca :=_gbgb .Ser ;for _ ,_eaeb :=range _agca {var _fccb string ;if _geddg :=_eaeb .Tx ;_geddg !=nil {if _bggcd :=_geddg .Choice ;_bggcd !=nil {if _bggcd .V !=nil {_fccb =*_bggcd .V ;}else if _cfdb :=_bggcd .StrRef ;_cfdb !=nil {if _eed :=_cfdb .StrCache ;
_eed !=nil {for _ ,_ggec :=range _eed .Pt {_fccb =_ggec .V ;};};};};};if _bdcd :=_eaeb .Cat ;_bdcd !=nil {if _fee :=_bdcd .Choice ;_fee !=nil {if _agcab :=_fee .StrRef ;_agcab !=nil {if _cfccb :=_agcab .F ;_cfccb !=""&&_gbb !=nil {_bgcb ,_gafd ,_gedg ,_egge :=ParseExcelRange (_cfccb );
if _egge ==nil {for _ ,_gag :=range _gbb .Sheets (){if _gag .Name ()==_ag .Trim (_bgcb ,"\u0027"){_gaec :=_gafd .String ();for _abfe :=_gafd .RowIdx ;_abfe <=_gedg .RowIdx ;_abfe +=1{_faaa :=_ag .ReplaceAll (_gaec ,_f .Sprint (_gafd .RowIdx ),_f .Sprint (_abfe ));
_age .addCatName (_gag .Cell (_faaa ).GetString (),_aaeb ,&_cbde );};break ;};};};};if _fgde :=_agcab .StrCache ;_fgde !=nil {for _ ,_efg :=range _fgde .Pt {_age .addCatName (_efg .V ,_aaeb ,&_cbde );};};}else if _accc :=_fee .NumRef ;_accc !=nil {if _efd :=_accc .NumCache ;
_efd !=nil {var _acg string ;if _efd .FormatCode !=nil {_acg =*_efd .FormatCode ;};for _ ,_egbed :=range _efd .Pt {var _gcbag string ;if _egbed .FormatCodeAttr ==nil {_gcbag =_acg ;}else {_gcbag =*_egbed .FormatCodeAttr ;};var _acba string ;_gefg ,_fcda :=_cc .ParseFloat (_egbed .V ,64);
if _fcda !=nil {_acba =_egbed .V ;}else {_acba =_bc .Number (_gefg ,_gcbag );};_age .addCatName (_acba ,_aaeb ,&_cbde );};};};};};if _efb :=_eaeb .Val ;_efb !=nil {if _bcbfa :=_efb .Choice ;_bcbfa !=nil {if _dacc :=_bcbfa .NumRef ;_dacc !=nil {if _deab :=_dacc .F ;
_deab !=""&&_gbb !=nil {_ceac ,_gffc ,_gec ,_bacf :=ParseExcelRange (_deab );if _bacf ==nil {for _ ,_eaff :=range _gbb .Sheets (){if _eaff .Name ()==_ag .Trim (_ceac ,"\u0027"){_dgbd :=_gffc .String ();for _gabg :=_gffc .RowIdx ;_gabg <=_gec .RowIdx ;_gabg +=1{_feae :=_ag .ReplaceAll (_dgbd ,_f .Sprint (_gffc .RowIdx ),_f .Sprint (_gabg ));
if _eaff .FormulaContext ().HasFormula (_feae ){_gfcd :=_fe .NewEvaluator ();_afc :=_eaff .FormulaContext ().Cell (_feae ,_gfcd );_gcgf :=_afc .Value ();_age .addCatValue (_gcgf ,_aaeb ,_cbde ,(int )(_gabg -_gffc .RowIdx ),&_cefa ,&_cecf ,_fccb ,_eaeb .SpPr );
}else {_bddf :=_eaff .Cell (_feae ).GetString ();_age .addCatValue (_bddf ,_aaeb ,_cbde ,(int )(_gabg -_gffc .RowIdx ),&_cefa ,&_cecf ,_fccb ,_eaeb .SpPr );};};break ;};};};};if _fdg :=_dacc .NumCache ;_fdg !=nil {for _bae ,_cdede :=range _fdg .Pt {_age .addCatValue (_cdede .V ,_aaeb ,_cbde ,_bae ,&_cefa ,&_cecf ,_fccb ,_eaeb .SpPr );
};};};};};};_dgeeb :=&_ea .PieChart {Values :[]_ge .Value {}};for _ ,_dbd :=range _cbde {_gdc :=_aaeb [_dbd ];if len (_gdc ._afe )> 0{_dgeeb .Values =append (_dgeeb .Values ,_ge .Value {Value :_gdc ._afe [0]._edg ,Label :_dbd ,Style :_ec .Style {FontSize :12*_cdba }});
};};_dgeeb .SetHeight (int (_dgf .Top -_dgf .Bottom ));_dgeeb .SetWidth (int (_dgf .Right -_dgf .Left ));_bdece :=_age ._dba ;_dege :=_cd .NewChart (_dgeeb );_dege .SetPos (_dgf .Left ,_dgf .Top );_fffef :=_bdece .Draw (_dege );if _fffef !=nil {return nil ,_fffef ;
};return _fbeg ,nil ;};func RegisterFontsFromFiles (files []string )error {for _ ,_cae :=range files {if _ag .HasSuffix (_cae ,"\u002e\u0074\u0074\u0066"){_fdcb :=_gee (_cae );if _fdcb !=nil {_ca .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_fdcb );
continue ;};};};return nil ;};func DrawLine (c *_cd .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _cd .Color ){if color ==nil {return ;};_adcf :=c .NewLine (x0 ,y0 ,x1 ,y1 );_adcf .SetLineWidth (width );_adcf .SetColor (color );c .Draw (_adcf );};func (_bad FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_bad )];
};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func GetImage (c *_cd .Creator ,goImg _a .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_cd .Image ,error ){if goImg ==nil {return nil ,nil ;};_cbcc :=goImg .Bounds ().Size ();_bgad :=_cbcc .X ;_cfccba :=_cbcc .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_bgad );
};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_cfccba );};var _aff _a .Rectangle ;switch part {case ImgPart_t :_aff =_a .Rect (0,0,_bgad ,int (dividerY ));case ImgPart_b :_aff =_a .Rect (0,int (dividerY ),_bgad ,_cfccba );case ImgPart_l :_aff =_a .Rect (0,0,int (dividerX ),_cfccba );
case ImgPart_r :_aff =_a .Rect (int (dividerX ),0,_bgad ,_cfccba );case ImgPart_lt :_aff =_a .Rect (0,0,int (dividerX ),int (dividerY ));case ImgPart_rt :_aff =_a .Rect (int (dividerX ),0,_bgad ,int (dividerY ));case ImgPart_lb :_aff =_a .Rect (0,int (dividerY ),int (dividerX ),_cfccba );
case ImgPart_rb :_aff =_a .Rect (int (dividerX ),int (dividerY ),_bgad ,_cfccba );default:_aff =_a .Rect (0,0,_bgad ,_cfccba );};_fage :=CropImageByRect (goImg ,_aff );_gaaa ,_dagd :=c .NewImageFromGoImage (_fage );if _dagd !=nil {return nil ,_dagd ;};
_gaaa .Scale (imgWidth /float64 (_bgad ),imgHeight /float64 (_cfccba ));_gaaa .SetPos (left ,top );return _gaaa ,nil ;};func (_gea *creatorContext )drawBarChart (_ga *_gf .CT_BarChart ,_ac *Rectangle ,_afb *_gf .CT_PlotAreaChoice1 ,_ee *_dg .Workbook )([]*legendItem ,error ){var _bf bool ;
if _afbf :=_ga .BarDir ;_afbf !=nil {_bf =_afbf .ValAttr ==_gf .ST_BarDirBar ;};_cda :=_ga .Ser ;_d .Sort (barSerByOrder (_cda ));_gaa :=map[string ]serCategory {};_ef :=[]string {};_dc :=[]*legendItem {};_cg :=_gc .Inf (1);_eg :=_gc .Inf (-1);for _ ,_cdd :=range _cda {var _fef string ;
if _de :=_cdd .Tx ;_de !=nil {if _gbf :=_de .Choice ;_gbf !=nil {if _gbf .V !=nil {_fef =*_gbf .V ;}else if _ab :=_gbf .StrRef ;_ab !=nil {if _beg :=_ab .StrCache ;_beg !=nil {for _ ,_efc :=range _beg .Pt {_fef =_efc .V ;};};};};};if _agf :=_cdd .Cat ;
_agf !=nil {if _cde :=_agf .Choice ;_cde !=nil {if _bd :=_cde .StrRef ;_bd !=nil {if _cf :=_bd .F ;_cf !=""&&_ee !=nil {_gg ,_fc ,_abe ,_gfa :=ParseExcelRange (_cf );if _gfa ==nil {for _ ,_gd :=range _ee .Sheets (){if _gd .Name ()==_ag .Trim (_gg ,"\u0027"){_dcd :=_fc .String ();
for _ba :=_fc .RowIdx ;_ba <=_abe .RowIdx ;_ba +=1{_bca :=_ag .ReplaceAll (_dcd ,_f .Sprint (_fc .RowIdx ),_f .Sprint (_ba ));_gea .addCatName (_gd .Cell (_bca ).GetString (),_gaa ,&_ef );};break ;};};};};if _eeb :=_bd .StrCache ;_eeb !=nil {for _ ,_fa :=range _eeb .Pt {_gea .addCatName (_fa .V ,_gaa ,&_ef );
};};}else if _aa :=_cde .NumRef ;_aa !=nil {if _eaf :=_aa .NumCache ;_eaf !=nil {var _dgb string ;if _eaf .FormatCode !=nil {_dgb =*_eaf .FormatCode ;};for _ ,_gfb :=range _eaf .Pt {var _cfc string ;if _gfb .FormatCodeAttr ==nil {_cfc =_dgb ;}else {_cfc =*_gfb .FormatCodeAttr ;
};var _eaa string ;_aga ,_cfe :=_cc .ParseFloat (_gfb .V ,64);if _cfe !=nil {_eaa =_gfb .V ;}else {_eaa =_bc .Number (_aga ,_cfc );};_gea .addCatName (_eaa ,_gaa ,&_ef );};};};};};if _fff :=_cdd .Val ;_fff !=nil {if _fcb :=_fff .Choice ;_fcb !=nil {if _gfc :=_fcb .NumRef ;
_gfc !=nil {if _dcc :=_gfc .F ;_dcc !=""&&_ee !=nil {_ggc ,_ecc ,_bfb ,_geb :=ParseExcelRange (_dcc );if _geb ==nil {for _ ,_dd :=range _ee .Sheets (){if _dd .Name ()==_ag .Trim (_ggc ,"\u0027"){_dcdg :=_ecc .String ();for _dbf :=_ecc .RowIdx ;_dbf <=_bfb .RowIdx ;
_dbf +=1{_ggg :=_ag .ReplaceAll (_dcdg ,_f .Sprint (_ecc .RowIdx ),_f .Sprint (_dbf ));if _dd .FormulaContext ().HasFormula (_ggg ){_ce :=_fe .NewEvaluator ();_bac :=_dd .FormulaContext ().Cell (_ggg ,_ce );_gae :=_bac .Value ();_gea .addCatValue (_gae ,_gaa ,_ef ,(int )(_dbf -_ecc .RowIdx ),&_cg ,&_eg ,_fef ,_cdd .SpPr );
}else {_agfb :=_dd .Cell (_ggg ).GetString ();_gea .addCatValue (_agfb ,_gaa ,_ef ,(int )(_dbf -_ecc .RowIdx ),&_cg ,&_eg ,_fef ,_cdd .SpPr );};};break ;};};};};if _cceb :=_gfc .NumCache ;_cceb !=nil {for _da ,_egb :=range _cceb .Pt {_gea .addCatValue (_egb .V ,_gaa ,_ef ,_da ,&_cg ,&_eg ,_fef ,_cdd .SpPr );
};};};};};_dc =append (_dc ,&legendItem {_gfce :_fef ,_dfd :_cdd .SpPr });};var _bb float64 ;var _eeg ,_afbe float64 ;if _eg ==0&&_cg ==0{_bb =0.2;_afbe =0;_eeg =1;}else {var _bec float64 ;if _fed :=_gc .Abs (_cg );_eg < _fed {_bec =_fed ;}else {_bec =_eg ;
};_df :=_gc .Pow (10,_gc .Floor (_gc .Log10 (_bec )));_cceg :=_bec /_df ;if _cceg < 4.29{_bb =0.5;}else if _cceg >=4.29&&_cceg < 8.58{_bb =1;}else {_bb =2;};_bb *=_df ;if _eg <=0{_eeg =0;}else {_eeg =(_gc .Ceil (_eg /_bb )+1)*_bb ;};if _cg >=0{_afbe =0;
}else {_afbe =(_gc .Floor (_cg /_bb )-1)*_bb ;};};_gab :=_gea .drawAxes (_afb ,_afbe ,_eeg ,_bb ,_ef ,_ac ,_bf );if _gab !=nil {return nil ,_gab ;};_ded :=0.0;if _ga .GapWidth !=nil {if _faf :=_ga .GapWidth .ValAttr ;_faf !=nil {if _bdc :=_faf .ST_GapAmountUShort ;
_bdc !=nil {_ded =float64 (*_bdc )/100.0;};};};_ccbg :=_ac .Right -_ac .Left ;_egg :=_ac .Bottom -_ac .Top ;_bcb :=float64 (len (_ef ));if _bf {_eaef :=_eeg /(_eeg -_afbe )*_ccbg ;_gga :=-_afbe /(_eeg -_afbe )*_ccbg ;_agfa :=_ac .Left +_gga ;_ace :=_egg /_bcb ;
for _eb ,_caa :=range _ef {_bde :=_gaa [_caa ];_cec :=float64 (len (_bde ._afe ))+_ded ;_cbe :=_ace /_cec ;_fad :=_cbe *_ded ;_aae :=_ac .Bottom -float64 (_eb )*_ace -_fad /2-_cbe ;for _ ,_cad :=range _bde ._afe {if _cad ._edg ==0{continue ;};var _beb ,_bdcg float64 ;
if _cad ._edg > 0{_bdcg =_cad ._edg /_eeg *_eaef ;_gea .drawRectangleWithProps (_cad ._dcef ,_agfa ,_aae ,_bdcg ,_cbe ,false );}else {_bdcg =_cad ._edg /_afbe *_gga ;_beb =_agfa -_bdcg ;_gea .drawRectangleWithProps (_cad ._dcef ,_beb ,_aae ,_bdcg ,_cbe ,false );
};_aae -=_cbe ;};};}else {_cgb :=_eeg /(_eeg -_afbe )*_egg ;_deg :=-_afbe /(_eeg -_afbe )*_egg ;_dgc :=_ac .Top +_cgb ;_gdf :=_ccbg /_bcb ;for _feg ,_dga :=range _ef {_fb :=_gaa [_dga ];_fg :=float64 (len (_fb ._afe ))+_ded ;_feb :=_gdf /_fg ;_febg :=_feb *_ded ;
_fae :=_ac .Left +float64 (_feg )*_gdf +_febg /2;for _ ,_fafd :=range _fb ._afe {var _ggf ,_dbff float64 ;if _fafd ._edg > 0{_dbff =_fafd ._edg /_eeg *_cgb ;_ggf =_dgc -_dbff ;_gea .drawRectangleWithProps (_fafd ._dcef ,_fae ,_ggf ,_feb ,_dbff ,false );
}else {_dbff =_fafd ._edg /_afbe *_deg ;_gea .drawRectangleWithProps (_fafd ._dcef ,_fae ,_dgc ,_feb ,_dbff ,false );};_fae +=_feb ;};};};return _dc ,nil ;};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_ccb .Twips *10+0.5))/10;
};func (_gcac *creatorContext )getPdfColorFromSolidFill (_aafd *_af .CT_SolidColorFillProperties )_cd .Color {if _aafd ==nil {return nil ;};_cgdc :="";if _acbb :=_aafd .SrgbClr ;_acbb !=nil {_cgdc =_acbb .ValAttr ;}else if _dgegc :=_aafd .SchemeClr ;_dgegc !=nil {_cgdc =_cebc (_dgegc .ValAttr ,_gcac ._bbed );
};if _cgdc ==""{return nil ;};return _cd .ColorRGBFromHex ("\u0023"+_cgdc );};func (_fggf *creatorContext )drawRectangleWithProps (_cfag *_af .CT_ShapeProperties ,_efcb ,_gbad ,_aafc ,_cdge float64 ,_gege bool ){_eeda :=_fggf ._dba .NewRectangle (_efcb ,_gbad ,_aafc ,_cdge );
if _cfag ==nil {if _gege {_eeda .SetBorderWidth (_gba );}else {return ;};}else {_gda :=_fggf .getPdfColorFromSolidFill (_cfag .SolidFill );if _gda !=nil {_eeda .SetFillColor (_gda );};if _afg :=_cfag .Ln ;_afg !=nil {if _gfaa :=_afg .WAttr ;_gfaa !=nil {_cfaae :=_ccb .FromEMU (int64 (*_gfaa ));
_eeda .SetBorderWidth (_cfaae );if _gcbae :=_afg .SolidFill ;_gcbae !=nil {_aab :=_fggf .getPdfColorFromSolidFill (_gcbae );if _aab !=nil {_eeda .SetBorderColor (_aab );};};}else {_eeda .SetBorderWidth (0);};};};_fggf ._dba .Draw (_eeda );};type BorderPosition byte ;
func _gee (_fde string )error {if !_ag .HasSuffix (_fde ,"\u002e\u0074\u0074\u0066"){_ca .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _f .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_cgbc ,_fgef :=_eae .ParseFile (_fde );if _fgef !=nil {_ca .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_fgef );return _fgef ;};_efefc ,_fgef :=_db .NewCompositePdfFontFromTTFFile (_fde );
if _fgef !=nil {return _fgef ;};_cbfd :=_cgbc .GetNameRecords ();for _ ,_aeg :=range _cbfd {_bfbc :=_aeg [1];if _bfbc ==""{continue ;};_caea :=make ([]byte ,0);for _bcee :=0;_bcee < len (_bfbc );_bcee ++{if _bfbc [_bcee ]==39||_bfbc [_bcee ]==92{continue ;
};_cfaa :=4;if _bcee +_cfaa < len (_bfbc ){if _bfbc [_bcee :_bcee +_cfaa ]=="\u0000"{_bcee =_bcee +_cfaa +1;continue ;};};_caea =append (_caea ,_bfbc [_bcee ]);};_bfbc =_ag .Replace (string (_caea ),"\u0078\u0030\u0030","",-1);_eadg :=_aeg [2];if _eadg ==""{return _f .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_fde );
};_caea =make ([]byte ,0);for _caf :=0;_caf < len (_eadg );_caf ++{if _eadg [_caf ]==39||_eadg [_caf ]==92{continue ;};_ecde :=4;if _caf +_ecde < len (_eadg ){if _eadg [_caf :_caf +_ecde ]=="\u0000"{_caf =_caf +_ecde +1;continue ;};};_caea =append (_caea ,_eadg [_caf ]);
};_eadg =_ag .Replace (string (_caea ),"\u0078\u0030\u0030","",-1);RegisterFont (_bfbc ,_fdb [_eadg ],_efefc );};return nil ;};type barSerByOrder []*_gf .CT_BarSer ;func FromSTPercentage (st *_af .ST_Percentage )float64 {if _bgca :=st .ST_PercentageDecimal ;
_bgca !=nil {return float64 (*_bgca )/100000;};return 0;};const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);var _bda =_adgf (2);func FromSTCoordinate32 (st _af .ST_Coordinate32 )int64 {if _bgfc :=st .ST_Coordinate32Unqualified ;
_bgfc !=nil {return int64 (*_bgfc );};return 0;};func AdjustColorByTint (colorStr string ,tint float64 )string {var _cecd ,_fefe ,_cbb uint8 ;_bcgc ,_ :=_f .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_cecd ,&_fefe ,&_cbb );
if _bcgc !=3{return "";};return _dgeg (_cecd ,tint )+_dgeg (_fefe ,tint )+_dgeg (_cbb ,tint );};func _eaag (_gbd uint8 ,_dcdc float64 )string {_fgd :=float64 (_gbd );return _f .Sprintf ("\u0025\u0030\u0032\u0078",int (_fgd *_dcdc ));};func FillRectangle (c *_cd .Creator ,x ,y ,width ,height float64 ,color _cd .Color ){if color ==nil {return ;
};_cgc :=c .NewRectangle (x ,y ,width ,height );_cgc .SetFillColor (color );_cgc .SetBorderWidth (0);c .Draw (_cgc );};func _cdg (_eage ,_bdg ,_cfcc float64 )float64 {if _eage *6< 1{return _cfcc +(_bdg -_cfcc )*6*_eage ;}else if _eage *2< 1{return _bdg ;
}else if _eage *3< 2{return _cfcc +(_bdg -_cfcc )*(2.0/3.0-_eage )*6;}else {return _cfcc ;};};func (_ced *creatorContext )drawTitle (_bcbf string ,_ggcg ,_cga float64 ){_dfa :=_ced ._abc ;_bgb :=_ced ._dba .NewStyledParagraph ();_feca :=_bgb .SetText (_bcbf );
_bdec ,_afbb :=_db .NewStandard14Font (_db .HelveticaName );if _afbb ==nil {_aee :=_ced ._dba .NewTextStyle ();_aee .Font =_bdec ;_aee .FontSize =14;_aee .TextRise =0.4;_feca .Style =_aee ;_bgb .SetPos (_ggcg -_bgb .Width ()*_dfa /2,_cga );_ced ._dba .Draw (_bgb );
};};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _gaf ,_bcc ,_effe uint8 ;_gcaa ,_ :=_f .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_gaf ,&_bcc ,&_effe );if _gcaa !=3{return "";};_eaad ,_eccb ,_efea :=_fcdc (_gaf ,_bcc ,_effe );
_efea =lum *_efea ;_gaf ,_bcc ,_effe =_ebgc (_eaad ,_eccb ,_efea );return _f .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_gaf ,_bcc ,_effe );};func _fcdc (_dabe ,_agce ,_cbf uint8 )(float64 ,float64 ,float64 ){_cfa ,_eag ,_fgab :=float64 (_dabe )/255,float64 (_agce )/255,float64 (_cbf )/255;
_edec :=_cfa ;if _eag < _edec {_edec =_eag ;};if _fgab < _edec {_edec =_fgab ;};var _becc ,_bcgd bool ;_daeg :=_cfa ;if _eag > _daeg {_daeg =_eag ;_becc =true ;};if _fgab > _daeg {_daeg =_fgab ;_becc =false ;_bcgd =true ;};_dbfeg :=(_edec +_daeg )/2;var _fdd float64 ;
if _edec !=_daeg {if _dbfeg <=0.5{_fdd =(_daeg -_edec )/(_daeg +_edec );}else {_fdd =(_daeg -_edec )/(2.0-_daeg -_edec );};};var _bff float64 ;if _edec !=_daeg {if _becc {_bff =2.0+(_fgab -_cfa )/(_daeg -_edec );}else if _bcgd {_bff =4.0+(_cfa -_eag )/(_daeg -_edec );
}else {_bff =(_eag -_fgab )/(_daeg -_edec );};_bff *=60;if _bff < 0{_bff +=360;};};return _bff ,_fdd ,_dbfeg ;};func MakeTempCreatorMaxHeight (width float64 )*_cd .Creator {return MakeTempCreator (width ,_gc .MaxFloat64 );};var _bbg =_adgf (5);func AdjustColor (colorStr string ,EG_ColorTransform []*_af .EG_ColorTransform )string {for _ ,_efef :=range EG_ColorTransform {if _fab :=_efef .Tint ;
_fab !=nil {if _ade :=_fab .ValAttr .ST_PositiveFixedPercentageDecimal ;_ade !=nil {colorStr =AdjustColorByTint (colorStr ,float64 (*_ade )/100000);};};if _bedf :=_efef .Shade ;_bedf !=nil {if _bafb :=_bedf .ValAttr .ST_PositiveFixedPercentageDecimal ;
_bafb !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_bafb )/100000);};};if _cbdc :=_efef .LumMod ;_cbdc !=nil {if _ccebb :=_cbdc .ValAttr .ST_PercentageDecimal ;_ccebb !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_ccebb )/100000);
};};};return colorStr ;};func MakeBlockFromChartSpace (cs *_gf .ChartSpace ,width ,height float64 ,theme *_af .Theme )(*_cd .Block ,error ){_bee ,_gbg :=_gdgg (cs ,width ,height ,theme ,false ,nil );if _gbg !=nil {return nil ,_gbg ;};_ad ,_gbg :=GetPageFromCreator (_bee );
if _gbg !=nil {return nil ,_gbg ;};_fga ,_gbg :=_cd .NewBlockFromPage (_ad );if _gbg !=nil {return nil ,_gbg ;};return _fga ,nil ;};type creatorContext struct{_dba *_cd .Creator ;_bbed *_af .Theme ;_abc float64 ;};type FontStyle byte ;var _gba =_adgf (0.125);
func _eddc (_egdd _af .ST_SchemeColorVal ,_cdfg *_af .Theme )string {if _dgaf :=_cdfg .ThemeElements ;_dgaf !=nil {if _befa :=_dgaf .ClrScheme ;_befa !=nil {switch _egdd {case _af .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_befa .Lt1 );case _af .ST_SchemeColorValDk1 ,_af .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_befa .Dk1 );
case _af .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_befa .Lt2 );case _af .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_befa .Dk2 );case _af .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_befa .Accent1 );case _af .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_befa .Accent2 );
case _af .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_befa .Accent3 );case _af .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_befa .Accent4 );case _af .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_befa .Accent5 );
case _af .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_befa .Accent6 );};};};return "";};func RegisterFont (name string ,style FontStyle ,font *_db .PdfFont ){_gcbd ._gdda .Lock ();if _gcbd ._faed [name ]==nil {_gcbd ._faed [name ]=map[FontStyle ]*_db .PdfFont {};
};_gcbd ._faed [name ][style ]=font ;_gcbd ._gdda .Unlock ();};var _egd =_adgf (1);func FromSTCoordinate (st _af .ST_Coordinate )int64 {if _dee :=st .ST_CoordinateUnqualified ;_dee !=nil {return *_dee ;};return 0;};func GetRegisteredFont (name string ,style FontStyle )*_db .PdfFont {_gcbd ._gdda .Lock ();
defer _gcbd ._gdda .Unlock ();if _fddd ,_fbd :=_gcbd ._faed [name ];_fbd {if _cdbg ,_eaagb :=_fddd [style ];_eaagb {return _cdbg ;};};return nil ;};type legendItem struct{_gfce string ;_dfd *_af .CT_ShapeProperties ;};type Rectangle struct{Top float64 ;
Bottom float64 ;Left float64 ;Right float64 ;};func MakeBlockFromCreator (c *_cd .Creator )(*_cd .Block ,error ){_bbda ,_dff :=GetPageFromCreator (c );if _dff !=nil {return nil ,_dff ;};_aadg ,_dff :=_cd .NewBlockFromPage (_bbda );if _dff !=nil {return nil ,_dff ;
};return _aadg ,nil ;};func _gfg (_dbe *_gf .CT_SerAx )(uint32 ,_gf .ST_AxPos ,_gf .ST_TickMark ,_gf .ST_TickLblPos ,*_gf .CT_ChartLines ,uint32 ,*_af .CT_ShapeProperties ,error ){var _egbe ,_aebf uint32 ;var _fcf _gf .ST_AxPos ;var _bcad _gf .ST_TickMark ;
var _aacg *_gf .CT_ChartLines ;var _cbae _gf .ST_TickLblPos ;if _dbe .AxId ==nil {return _egbe ,_fcf ,_bcad ,_cbae ,_aacg ,_aebf ,_dbe .SpPr ,_e .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_egbe =_dbe .AxId .ValAttr ;
};if _dbe .AxPos ==nil {return _egbe ,_fcf ,_bcad ,_cbae ,_aacg ,_aebf ,_dbe .SpPr ,_e .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_fcf =_dbe .AxPos .ValAttr ;};if _dbe .MajorTickMark !=nil {_bcad =_dbe .MajorTickMark .ValAttr ;
};if _dbe .TickLblPos !=nil {_cbae =_dbe .TickLblPos .ValAttr ;};if _dbe .CrossAx ==nil {return _egbe ,_fcf ,_bcad ,_cbae ,_aacg ,_aebf ,_dbe .SpPr ,_e .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_aebf =_dbe .CrossAx .ValAttr ;
};_aacg =_dbe .MajorGridlines ;return _egbe ,_fcf ,_bcad ,_cbae ,_aacg ,_aebf ,_dbe .SpPr ,nil ;};func (_gcd *Rectangle )Translate (x ,y float64 ){_gcd .Left +=x ;_gcd .Right +=x ;_gcd .Top +=y ;_gcd .Bottom +=y ;};func GetDataFromXfrm (xfrm *_af .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _ccf ,_gfgg ,_egag ,_aefb float64 ;
if _cfbg :=xfrm .Off ;_cfbg !=nil {_ccf =_ccb .FromEMU (FromSTCoordinate (_cfbg .XAttr ));_gfgg =_ccb .FromEMU (FromSTCoordinate (_cfbg .YAttr ));};if _faec :=xfrm .Ext ;_faec !=nil {_egag =_ccb .FromEMU (_faec .CxAttr );_aefb =_ccb .FromEMU (_faec .CyAttr );
};return _ccf ,_gfgg ,_egag ,_aefb ;};func (_gcdg *creatorContext )drawBorderWithProps (_ggge *_af .CT_ShapeProperties ,_agde *Rectangle ,_bcbd float64 ){if _agde !=nil &&_ggge !=nil &&_ggge .Ln !=nil &&_ggge .Ln .SolidFill !=nil {_afec :=_gcdg .getPdfColorFromSolidFill (_ggge .Ln .SolidFill );
DrawRectangle (_gcdg ._dba ,_agde ,_bcbd ,_afec );};};func AdjustColorByShade (colorStr string ,shade float64 )string {var _ggee ,_fbf ,_aea uint8 ;_ggd ,_ :=_f .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_ggee ,&_fbf ,&_aea );
if _ggd !=3{return "";};return _eaag (_ggee ,shade )+_eaag (_fbf ,shade )+_eaag (_aea ,shade );};type ImgPart byte ;func MakeImageFromChartSpace (cs *_gf .ChartSpace ,width ,height float64 ,theme *_af .Theme ,workbook *_dg .Workbook )(_a .Image ,error ){_bcg ,_agb :=_gdgg (cs ,width ,height ,theme ,true ,workbook );
if _agb !=nil {return nil ,_agb ;};_cbeb ,_agb :=GetPageFromCreator (_bcg );if _agb !=nil {return nil ,_agb ;};return _ece .NewImageDevice ().Render (_cbeb );};