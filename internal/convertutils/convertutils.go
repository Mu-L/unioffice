//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_gg "bytes";_dd "errors";_fd "fmt";_bb "github.com/unidoc/unichart";_ddd "github.com/unidoc/unichart/dataset";_ab "github.com/unidoc/unichart/render";_ce "github.com/unidoc/unioffice/v2/common/logger";_bg "github.com/unidoc/unioffice/v2/document";
_dda "github.com/unidoc/unioffice/v2/measurement";_eb "github.com/unidoc/unioffice/v2/schema/soo/dml";_ad "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_bgb "github.com/unidoc/unioffice/v2/spreadsheet";_da "github.com/unidoc/unioffice/v2/spreadsheet/format";
_fcf "github.com/unidoc/unioffice/v2/spreadsheet/formula";_ged "github.com/unidoc/unioffice/v2/spreadsheet/reference";_fc "github.com/unidoc/unipdf/v3/core";_fae "github.com/unidoc/unipdf/v3/creator";_cc "github.com/unidoc/unipdf/v3/model";_a "github.com/unidoc/unipdf/v3/render";
_c "github.com/unidoc/unitype";_d "image";_g "image/color";_ge "math";_fa "os";_b "regexp";_ed "sort";_fg "strconv";_eff "strings";_f "sync";_ef "unicode";);func _gbb (_gbbe *_ad .CT_SerAx )(uint32 ,_ad .ST_AxPos ,_ad .ST_TickMark ,_ad .ST_TickLblPos ,*_ad .CT_ChartLines ,uint32 ,*_eb .CT_ShapeProperties ,error ){var _bbca ,_bfa uint32 ;
var _ggbd _ad .ST_AxPos ;var _ebea _ad .ST_TickMark ;var _efae *_ad .CT_ChartLines ;var _affc _ad .ST_TickLblPos ;if _gbbe .AxId ==nil {return _bbca ,_ggbd ,_ebea ,_affc ,_efae ,_bfa ,_gbbe .SpPr ,_dd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_bbca =_gbbe .AxId .ValAttr ;};if _gbbe .AxPos ==nil {return _bbca ,_ggbd ,_ebea ,_affc ,_efae ,_bfa ,_gbbe .SpPr ,_dd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ggbd =_gbbe .AxPos .ValAttr ;
};if _gbbe .MajorTickMark !=nil {_ebea =_gbbe .MajorTickMark .ValAttr ;};if _gbbe .TickLblPos !=nil {_affc =_gbbe .TickLblPos .ValAttr ;};if _gbbe .CrossAx ==nil {return _bbca ,_ggbd ,_ebea ,_affc ,_efae ,_bfa ,_gbbe .SpPr ,_dd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_bfa =_gbbe .CrossAx .ValAttr ;};_efae =_gbbe .MajorGridlines ;return _bbca ,_ggbd ,_ebea ,_affc ,_efae ,_bfa ,_gbbe .SpPr ,nil ;};var _eaa =_ccbe (1.5);func (_bag *creatorContext )drawLegend (_fbdec *Rectangle ,_aee []*legendItem ,_bdeg bool ){_dea :=_bag ._ddage ;
_bcfb :=_ccbe (2.5)*_dea ;_fbgg :=_ggd *_dea ;_bbc :=(_bcfb -_fbgg )/2;_gde :=float64 (len (_aee ));if _bdeg {_gdf :=&Rectangle {Top :_fbdec .Top +_ccbe (1)*_dea ,Bottom :_fbdec .Bottom -_ccbe (1)*_dea ,Left :_fbdec .Left +_ccbe (2.5)*_dea ,Right :_fbdec .Right -_ccbe (2.5)*_dea };
var _dga float64 ;if _gde > 1{_dga =(_gdf .Right -_gdf .Left )/_gde ;};_fdbb :=_gdf .Left ;_ddda :=_gdf .Top ;for _ ,_bdb :=range _aee {if _dgdg :=_bdb ._beef ;_dgdg !=nil {_bag .drawRectangleWithProps (_dgdg ,_fdbb ,_ddda +_bbc ,_fbgg ,_fbgg ,false );
_edbd :=_fdbb +_fbgg *2;_cdb :=_bag ._aada .NewStyledParagraph ();_cdb .SetPos (_edbd ,_ddda );_dbd :=_cdb .Append (_bdb ._ae );_ffcc ,_fff :=_cc .NewStandard14Font (_cc .HelveticaName );if _fff ==nil {_dddg :=_bag ._aada .NewTextStyle ();_dddg .Font =_ffcc ;
_dddg .FontSize =_bcfb ;_dddg .TextRise =0.4;_dbd .Style =_dddg ;_bag ._aada .Draw (_cdb );};};_fdbb +=_dga ;};}else {_babbe :=&Rectangle {Top :_fbdec .Top +_ccbe (2.5)*_dea ,Bottom :_fbdec .Bottom -_ccbe (2.5)*_dea ,Left :_fbdec .Left +_ccbe (2.5)*_dea ,Right :_fbdec .Right -_ccbe (2.5)*_dea };
var _efdd float64 ;if _gde > 1{_efdd =(_babbe .Bottom -_babbe .Top -_bcfb )/(_gde -1);if _efdd < _bcfb {_efdd =_bcfb ;};};_gdag :=_babbe .Top ;_ebdf :=_babbe .Left ;_cda :=_ebdf +_fbgg *2;for _ ,_eag :=range _aee {if _ffea :=_eag ._beef ;_ffea !=nil {_bag .drawRectangleWithProps (_ffea ,_ebdf ,_gdag +_bbc ,_fbgg ,_fbgg ,false );
_aaf :=_bag ._aada .NewStyledParagraph ();_aaf .SetPos (_cda ,_gdag );_aaf .SetWidth (_babbe .Right -_babbe .Left );_fgg :=_aaf .Append (_eag ._ae );_gge ,_gaa :=_cc .NewStandard14Font (_cc .HelveticaName );if _gaa ==nil {_fdc :=_bag ._aada .NewTextStyle ();
_fdc .Font =_gge ;_fdc .FontSize =_bcfb ;_fdc .TextRise =0.4;_fgg .Style =_fdc ;_bag ._aada .Draw (_aaf );};};_gdag +=_efdd ;};};};func (_feab *creatorContext )drawLineChart (_cdgc *_ad .CT_LineChart ,_ggff *Rectangle ,_fadg []*_ad .CT_PlotAreaChoice1 ,_gegd float64 )([]*legendItem ,error ){_gfec :=[]*legendItem {};
_cae :=_cdgc .Ser ;_egfe :=make (map[int ][]float64 );_bbfa :=make (map[int ][]float64 );_begd :=make (map[int ]_fae .Color );_fdae :=make (map[int ]float64 );for _abed ,_cfg :=range _cae {var _cgeda string ;if _bedf :=_cfg .Tx ;_bedf !=nil {if _fccg :=_bedf .SerTxChoice ;
_fccg !=nil {if _fccg .V !=nil {_cgeda =*_fccg .V ;}else if _bfg :=_fccg .StrRef ;_bfg !=nil {if _fffb :=_bfg .StrCache ;_fffb !=nil {for _ ,_bcge :=range _fffb .Pt {_cgeda =_bcge .V ;};};};};};_begd [_abed ]=_fae .ColorWhite ;if _gfg :=_cfg .SpPr ;_gfg !=nil {if _gce :=_gfg .Ln ;
_gce !=nil {if _edd :=_gce .WAttr ;_edd !=nil {_fdae [_abed ]=_dda .FromEMU (int64 (*_edd ));if _dca :=_gce .LineFillPropertiesChoice .SolidFill ;_dca !=nil {_beda :=_feab .getPdfColorFromSolidFill (_dca );if _beda !=nil {_begd [_abed ]=_beda ;};};};};
};if _cebg :=_cfg .Val ;_cebg !=nil {if _decd :=_cebg .NumDataSourceChoice ;_decd !=nil {if _ebdd :=_decd .NumRef ;_ebdd !=nil {if _cdgd :=_ebdd .NumCache ;_cdgd !=nil {for _ ,_cbeab :=range _cdgd .Pt {_egfe [_abed ]=append (_egfe [_abed ],float64 (_cbeab .IdxAttr ));
_gbcg ,_ :=_fg .ParseFloat (_eff .TrimSpace (_cbeab .V ),64);_bbfa [_abed ]=append (_bbfa [_abed ],_gbcg );};};};};};_gfec =append (_gfec ,&legendItem {_ae :_cgeda ,_beef :_cfg .SpPr });};_caef :=true ;_aeg :=true ;_ggae :="";_dffa :="";if len (_fadg )> 0{for _ ,_gcd :=range _fadg {if _gcd .CatAx !=nil {if _gcd .CatAx .Delete !=nil {if !*(*_gcd .CatAx .Delete ).ValAttr {_caef =false ;
};};_ggae =_feab .getTitle (_gcd .CatAx .Title );}else if _gcd .ValAx !=nil {if _gcd .ValAx .Delete !=nil {if !*(*_gcd .ValAx .Delete ).ValAttr {_aeg =false ;};};_dffa =_feab .getTitle (_gcd .ValAx .Title );};};};_aebb :=_ab .Style {Hidden :_caef ,FontSize :8*_gegd };
_fgfe :=_ab .Style {Hidden :_aeg ,FontSize :8*_gegd };_egdg :=&_bb .Chart {Series :[]_ddd .Series {},YAxisSecondary :_bb .YAxis {Style :_fgfe ,Name :_dffa ,NameStyle :_fgfe },XAxis :_bb .XAxis {Style :_aebb ,Name :_ggae ,NameStyle :_aebb },YAxis :_bb .YAxis {Style :_ab .Style {Hidden :true }}};
for _aebe :=0;_aebe < len (_begd );_aebe ++{_cfec ,_dbce ,_badd :=_begd [_aebe ].ToRGB ();_beaf :=_ddd .ContinuousSeries {XValues :_egfe [_aebe ],YValues :_bbfa [_aebe ],Style :_ab .Style {StrokeColor :_g .RGBA {uint8 (_cfec *255),uint8 (_dbce *255),uint8 (_badd *255),255},StrokeWidth :_fdae [_aebe ]}};
_egdg .Series =append (_egdg .Series ,_beaf );};_egdg .SetHeight (int (_ge .Abs (_ggff .Top -_ggff .Bottom )));_egdg .SetWidth (int (_ge .Abs (_ggff .Right -_ggff .Left )));_bgff :=_feab ._aada ;_dbfc :=_fae .NewChart (_egdg );_dbfc .SetPos (_ggff .Left ,_ggff .Top );
_ffda :=_bgff .Draw (_dbfc );if _ffda !=nil {return nil ,_ffda ;};return _gfec ,nil ;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };var _efef =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func RegisterFontsFromFiles (files []string )error {for _ ,_edgd :=range files {if _eff .HasSuffix (_edgd ,"\u002e\u0074\u0074\u0066"){_bcg :=_fege (_edgd );
if _bcg !=nil {_ce .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_bcg );
continue ;};};};return nil ;};type PageSize int ;func RegisterFont (name string ,style FontStyle ,font *_cc .PdfFont ){_geg ._gecb .Lock ();if _geg ._bffa [name ]==nil {_geg ._bffa [name ]=map[FontStyle ]*_cc .PdfFont {};};_geg ._bffa [name ][style ]=font ;
_geg ._gecb .Unlock ();};type legendItem struct{_ae string ;_beef *_eb .CT_ShapeProperties ;};func _fbgf (_dag ,_abfa ,_cgge float64 )(uint8 ,uint8 ,uint8 ){var _degd float64 ;if _cgge < 0.5{_degd =_cgge *(1+_abfa );}else {_degd =_cgge +_abfa -_cgge *_abfa ;
};_cgd :=_cgge *2-_degd ;_dag /=360.0;_cce :=_bgdf (_dag +1.0/3.0);_agff :=_bgdf (_dag );_cgf :=_bgdf (_dag -1.0/3.0);_ccbf :=_bgc (_cce ,_degd ,_cgd );_aecb :=_bgc (_agff ,_degd ,_cgd );_babee :=_bgc (_cgf ,_degd ,_cgd );return uint8 (255*_ccbf ),uint8 (255*_aecb ),uint8 (255*_babee );
};var _dgb =_ccbe (7.5);func _bgdf (_ead float64 )float64 {if _ead < 0{_ead +=float64 (-int (_ead )+1);}else if _ead > 1{_ead -=float64 (int (_ead ));};return _ead ;};func ClearRegisteredFonts (){_geg ._gecb .Lock ();_geg ._bffa =map[string ]map[FontStyle ]*_cc .PdfFont {};
_geg ._gecb .Unlock ();};func _efaa (_acff *_ad .CT_ValAx )(uint32 ,_ad .ST_AxPos ,_ad .ST_TickMark ,_ad .ST_TickLblPos ,*_ad .CT_ChartLines ,uint32 ,*_eb .CT_ShapeProperties ,error ){var _bff ,_ggf uint32 ;var _afa _ad .ST_AxPos ;var _cgb _ad .ST_TickMark ;
var _cfe *_ad .CT_ChartLines ;var _ebfa _ad .ST_TickLblPos ;if _acff .AxId ==nil {return _bff ,_afa ,_cgb ,_ebfa ,_cfe ,_ggf ,_acff .SpPr ,_dd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bff =_acff .AxId .ValAttr ;
};if _acff .AxPos ==nil {return _bff ,_afa ,_cgb ,_ebfa ,_cfe ,_ggf ,_acff .SpPr ,_dd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_afa =_acff .AxPos .ValAttr ;};if _acff .MajorTickMark !=nil {_cgb =_acff .MajorTickMark .ValAttr ;
};if _acff .TickLblPos !=nil {_ebfa =_acff .TickLblPos .ValAttr ;};if _acff .CrossAx ==nil {return _bff ,_afa ,_cgb ,_ebfa ,_cfe ,_ggf ,_acff .SpPr ,_dd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_ggf =_acff .CrossAx .ValAttr ;
};_cfe =_acff .MajorGridlines ;return _bff ,_afa ,_cgb ,_ebfa ,_cfe ,_ggf ,_acff .SpPr ,nil ;};func _fabe (_dad ,_dadb ,_debd uint8 )(float64 ,float64 ,float64 ){_eac ,_fcb ,_dgdge :=float64 (_dad )/255,float64 (_dadb )/255,float64 (_debd )/255;_bffc :=_eac ;
if _fcb < _bffc {_bffc =_fcb ;};if _dgdge < _bffc {_bffc =_dgdge ;};var _eae ,_cbcb bool ;_decg :=_eac ;if _fcb > _decg {_decg =_fcb ;_eae =true ;};if _dgdge > _decg {_decg =_dgdge ;_eae =false ;_cbcb =true ;};_fgf :=(_bffc +_decg )/2;var _fac float64 ;
if _bffc !=_decg {if _fgf <=0.5{_fac =(_decg -_bffc )/(_decg +_bffc );}else {_fac =(_decg -_bffc )/(2.0-_decg -_bffc );};};var _ega float64 ;if _bffc !=_decg {if _eae {_ega =2.0+(_dgdge -_eac )/(_decg -_bffc );}else if _cbcb {_ega =4.0+(_eac -_fcb )/(_decg -_bffc );
}else {_ega =(_fcb -_dgdge )/(_decg -_bffc );};_ega *=60;if _ega < 0{_ega +=360;};};return _ega ,_fac ,_fgf ;};func (_cbbb *creatorContext )drawPieChart (_faac *_ad .CT_PieChart ,_cgab *Rectangle ,_beeg *_bgb .Workbook ,_gffd float64 )([]*legendItem ,error ){_fdad :=[]*legendItem {};
_dcc :=map[string ]serCategory {};_ccbca :=[]string {};_cacg :=_ge .Inf (1);_fdf :=_ge .Inf (-1);_cagc :=_faac .Ser ;for _ ,_agdf :=range _cagc {var _dbgf string ;if _bef :=_agdf .Tx ;_bef !=nil {if _cfea :=_bef .SerTxChoice ;_cfea !=nil {if _cfea .V !=nil {_dbgf =*_cfea .V ;
}else if _bbffd :=_cfea .StrRef ;_bbffd !=nil {if _fbe :=_bbffd .StrCache ;_fbe !=nil {for _ ,_bacf :=range _fbe .Pt {_dbgf =_bacf .V ;};};};};};if _edfe :=_agdf .Cat ;_edfe !=nil {if _bce :=_edfe .AxDataSourceChoice ;_bce !=nil {if _fgcbe :=_bce .StrRef ;
_fgcbe !=nil {if _ggfa :=_fgcbe .F ;_ggfa !=""&&_beeg !=nil {_fadgd ,_deea ,_eagc ,_dgdb :=ParseExcelRange (_ggfa );if _dgdb ==nil {for _ ,_faae :=range _beeg .Sheets (){if _faae .Name ()==_eff .Trim (_fadgd ,"\u0027"){_caga :=_deea .String ();for _aecbe :=_deea .RowIdx ;
_aecbe <=_eagc .RowIdx ;_aecbe +=1{_dbgfg :=_eff .ReplaceAll (_caga ,_fd .Sprint (_deea .RowIdx ),_fd .Sprint (_aecbe ));_cbbb .addCatName (_faae .Cell (_dbgfg ).GetString (),_dcc ,&_ccbca );};break ;};};};};if _caec :=_fgcbe .StrCache ;_caec !=nil {for _ ,_daaa :=range _caec .Pt {_cbbb .addCatName (_daaa .V ,_dcc ,&_ccbca );
};};}else if _cbef :=_bce .NumRef ;_cbef !=nil {if _fdfd :=_cbef .NumCache ;_fdfd !=nil {var _eed string ;if _fdfd .FormatCode !=nil {_eed =*_fdfd .FormatCode ;};for _ ,_gad :=range _fdfd .Pt {var _aefd string ;if _gad .FormatCodeAttr ==nil {_aefd =_eed ;
}else {_aefd =*_gad .FormatCodeAttr ;};var _fdca string ;_gfae ,_cdfba :=_fg .ParseFloat (_gad .V ,64);if _cdfba !=nil {_fdca =_gad .V ;}else {_fdca =_da .Number (_gfae ,_aefd );};_cbbb .addCatName (_fdca ,_dcc ,&_ccbca );};};};};};if _dbb :=_agdf .Val ;
_dbb !=nil {if _aacd :=_dbb .NumDataSourceChoice ;_aacd !=nil {if _debb :=_aacd .NumRef ;_debb !=nil {if _fdge :=_debb .F ;_fdge !=""&&_beeg !=nil {_gbag ,_cdagf ,_edgg ,_bcfc :=ParseExcelRange (_fdge );if _bcfc ==nil {for _ ,_efaeg :=range _beeg .Sheets (){if _efaeg .Name ()==_eff .Trim (_gbag ,"\u0027"){_ebdg :=_cdagf .String ();
for _dfad :=_cdagf .RowIdx ;_dfad <=_edgg .RowIdx ;_dfad +=1{_fabg :=_eff .ReplaceAll (_ebdg ,_fd .Sprint (_cdagf .RowIdx ),_fd .Sprint (_dfad ));if _efaeg .FormulaContext ().HasFormula (_fabg ){_gdda :=_fcf .NewEvaluator ();_acac :=_efaeg .FormulaContext ().Cell (_fabg ,_gdda );
_fdeg :=_acac .Value ();_cbbb .addCatValue (_fdeg ,_dcc ,_ccbca ,(int )(_dfad -_cdagf .RowIdx ),&_cacg ,&_fdf ,_dbgf ,_agdf .SpPr );}else {_bgbe :=_efaeg .Cell (_fabg ).GetString ();_cbbb .addCatValue (_bgbe ,_dcc ,_ccbca ,(int )(_dfad -_cdagf .RowIdx ),&_cacg ,&_fdf ,_dbgf ,_agdf .SpPr );
};};break ;};};};};if _cbba :=_debb .NumCache ;_cbba !=nil {for _bacfb ,_aafe :=range _cbba .Pt {_cbbb .addCatValue (_aafe .V ,_dcc ,_ccbca ,_bacfb ,&_cacg ,&_fdf ,_dbgf ,_agdf .SpPr );};};};};};};_dbfeg :=&_bb .PieChart {Values :[]_ddd .Value {}};for _ ,_baddd :=range _ccbca {_fed :=_dcc [_baddd ];
if len (_fed ._gead )> 0{_dbfeg .Values =append (_dbfeg .Values ,_ddd .Value {Value :_fed ._gead [0]._add ,Label :_baddd ,Style :_ab .Style {FontSize :12*_gffd }});};};_dbfeg .SetHeight (int (_cgab .Top -_cgab .Bottom ));_dbfeg .SetWidth (int (_cgab .Right -_cgab .Left ));
_bafe :=_cbbb ._aada ;_afae :=_fae .NewChart (_dbfeg );_afae .SetPos (_cgab .Left ,_cgab .Top );_ggga :=_bafe .Draw (_afae );if _ggga !=nil {return nil ,_ggga ;};return _fdad ,nil ;};func GetDefaultPageSize ()_fae .PageSize {return _bbcg [DefaultPageSize ]};
func RegisterEmbeddedFonts (d *_bg .Document )error {_gae :=d .FontTable ();if _gae ==nil {return nil ;};for _ ,_adga :=range _gae .Font {if _adga .EmbedRegular !=nil {return _ddbf (d ,_adga .NameAttr ,_adga .EmbedRegular .IdAttr ,_adga .EmbedRegular .FontKeyAttr );
};if _adga .EmbedBold !=nil {return _ddbf (d ,_adga .NameAttr ,_adga .EmbedBold .IdAttr ,_adga .EmbedBold .FontKeyAttr );};if _adga .EmbedItalic !=nil {return _ddbf (d ,_adga .NameAttr ,_adga .EmbedItalic .IdAttr ,_adga .EmbedItalic .FontKeyAttr );};if _adga .EmbedBoldItalic !=nil {return _ddbf (d ,_adga .NameAttr ,_adga .EmbedBoldItalic .IdAttr ,_adga .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};type serValue struct{_ecee string ;_add float64 ;_babb *_eb .CT_ShapeProperties ;};func (_gec barSerByOrder )Less (i ,j int )bool {return _gec [i ].Order .ValAttr < _gec [j ].Order .ValAttr };func GetPageFromCreator (c *_fae .Creator )(*_cc .PdfPage ,error ){_dacf :=_gg .NewBuffer ([]byte {});
_dge :=c .Write (_dacf );if _dge !=nil {return nil ,_dge ;};_ccce :=_gg .NewReader (_dacf .Bytes ());_egg ,_dge :=_cc .NewPdfReader (_ccce );if _dge !=nil {return nil ,_dge ;};return _egg .GetPage (1);};func AdjustColorByLumOff (colorStr string ,lumOff float64 )string {var _cgea ,_fade ,_dgg uint8 ;
_babe ,_ :=_fd .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_cgea ,&_fade ,&_dgg );if _babe !=3{return "";};_dbe ,_fbdcd ,_cdfgc :=_fabe (_cgea ,_fade ,_dgg );_cdfgc =_cdfgc +lumOff ;_cgea ,_fade ,_dgg =_fbgf (_dbe ,_fbdcd ,_cdfgc );
return _fd .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_cgea ,_fade ,_dgg );};type barSerByOrder []*_ad .CT_BarSer ;func (_dde *creatorContext )drawTitle (_gede string ,_gfa ,_cbeg float64 ){_fdbg :=_dde ._ddage ;_adg :=_dde ._aada .NewStyledParagraph ();
_cgc :=_adg .SetText (_gede );_bedg ,_abeg :=_cc .NewStandard14Font (_cc .HelveticaName );if _abeg ==nil {_ffd :=_dde ._aada .NewTextStyle ();_ffd .Font =_bedg ;_ffd .FontSize =14;_ffd .TextRise =0.4;_cgc .Style =_ffd ;_adg .SetPos (_gfa -_adg .Width ()*_fdbg /2,_cbeg );
_dde ._aada .Draw (_adg );};};var _ffa =_ccbe (1);type FontStyle byte ;func FromSTCoordinate32 (st _eb .ST_Coordinate32 )int64 {if _fbaea :=st .ST_Coordinate32Unqualified ;_fbaea !=nil {return int64 (*_fbaea );};return 0;};var (DefaultFontSize =12.0;DefaultImageEncoder _fc .StreamEncoder ;
DefaultPageSize =PageSizeA4 ;_bbcg =map[PageSize ]_fae .PageSize {PageSizeA3 :_fae .PageSizeA3 ,PageSizeA4 :_fae .PageSizeA4 ,PageSizeA5 :_fae .PageSizeA5 ,PageSizeLetter :_fae .PageSizeLetter ,PageSizeLegal :_fae .PageSizeLegal };);func _bgc (_edbdb ,_ggfe ,_bggc float64 )float64 {if _edbdb *6< 1{return _bggc +(_ggfe -_bggc )*6*_edbdb ;
}else if _edbdb *2< 1{return _ggfe ;}else if _edbdb *3< 2{return _bggc +(_ggfe -_bggc )*(2.0/3.0-_edbdb )*6;}else {return _bggc ;};};func (_fbdc *creatorContext )drawAxes (_cdda []*_ad .CT_PlotAreaChoice1 ,_gcagc ,_cba ,_cddc float64 ,_fdg []string ,_ebg *Rectangle ,_ceba bool )error {_effg :=_fbdc ._aada ;
_eagf :=_fbdc ._ddage ;if _cdda ==nil {return _dd .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};var (_caa *_ad .CT_ValAx ;_cbaf *_ad .CT_CatAx ;_afc *_ad .CT_DateAx ;_degb *_ad .CT_SerAx ;
);for _ ,_aca :=range _cdda {if _aca .ValAx !=nil {_caa =_aca .ValAx ;}else if _aca .CatAx !=nil {_cbaf =_aca .CatAx ;}else if _aca .DateAx !=nil {_afc =_aca .DateAx ;}else if _aca .SerAx !=nil {_degb =_aca .SerAx ;};};if _caa ==nil ||(_cbaf ==nil &&_afc ==nil &&_degb ==nil ){return _dd .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _fgce ,_deb ,_cdag ,_eef uint32 ;var _ffce ,_eaaf _ad .ST_AxPos ;var _fgbc ,_bcd _ad .ST_TickMark ;var _adc ,_gbcc *_ad .CT_ChartLines ;var _daad ,_bfdb _ad .ST_TickLblPos ;var _afe ,_ffg *_eb .CT_ShapeProperties ;var _bdc error ;_bgbg :=_ebg .Right -_ebg .Left ;
_fbggb :=_ebg .Bottom -_ebg .Top ;if _caa !=nil {_deb ,_eaaf ,_bcd ,_bfdb ,_gbcc ,_eef ,_ffg ,_bdc =_efaa (_caa );};if _eaaf !=_ad .ST_AxPosL &&_eaaf !=_ad .ST_AxPosB {return _dd .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_cge :=_cba -_gcagc ;_fcc :=int (_cge /_cddc )+1;var _cgef ,_cfb float64 ;switch _bcd {case _ad .ST_TickMarkIn :_cgef ,_cfb =_ffa ,0;case _ad .ST_TickMarkOut :_cgef ,_cfb =0,_ffa ;case _ad .ST_TickMarkCross :_cgef ,_cfb =_ffa ,_ffa ;};_cgef =_cgef *_eagf ;
_cfb =_cfb *_eagf ;var _egbe *_eb .CT_ShapeProperties ;if _gbcc !=nil {_egbe =_gbcc .SpPr ;};_fda ,_aae :=_daad !=_ad .ST_TickLblPosNone ,_bfdb !=_ad .ST_TickLblPosNone ;_cdg :=_gcagc ;if _cbaf !=nil {_fgce ,_ffce ,_fgbc ,_daad ,_adc ,_cdag ,_afe ,_bdc =_ebc (_cbaf );
}else if _afc !=nil {_fgce ,_ffce ,_fgbc ,_daad ,_adc ,_cdag ,_afe ,_bdc =_adb (_afc );}else if _degb !=nil {_fgce ,_ffce ,_fgbc ,_daad ,_adc ,_cdag ,_afe ,_bdc =_gbb (_degb );};if _bdc !=nil {return _bdc ;};if _ffce !=_ad .ST_AxPosL &&_ffce !=_ad .ST_AxPosB {return _dd .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _fgce !=_eef ||_deb !=_cdag {return _dd .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_cgg :=len (_fdg )+1;var _dfba ,_dbdd float64 ;switch _fgbc {case _ad .ST_TickMarkIn :_dfba ,_dbdd =_ffa ,0;
case _ad .ST_TickMarkOut :_dfba ,_dbdd =0,_ffa ;case _ad .ST_TickMarkCross :_dfba ,_dbdd =_ffa ,_ffa ;};_dfba =_dfba *_eagf ;_dbdd =_dbdd *_eagf ;var _bdgg *_eb .CT_ShapeProperties ;if _adc !=nil {_bdgg =_adc .SpPr ;};if _ceba {_bfdd :=_fbggb /float64 (len (_fdg ));
_beg :=_ebg .Left -_gcagc *_bgbg /_cge ;_bda :=_beg -_dgb *_eagf ;if _fda {var _aeea float64 ;for _gacb :=0;_gacb < _cgg ;_gacb ++{_fgcb :=_ebg .Bottom -float64 (_gacb )*_bfdd ;if _gacb < _cgg -1{_ffeg :=_effg .NewParagraph (_fdg [_gacb ]);_ffeg .SetFontSize (_bad *_eagf );
_ffeg .SetPos (_bda ,_fgcb -_bfdd /2-_eaa *_eagf );_effg .Draw (_ffeg );_ccf :=(_ffeg .Width ()/1000-_dgb )*_eagf ;if _ccf > 0&&_ccf > _aeea {_aeea =_ccf ;};};};if _aeea > 0{_ebg .Left +=_aeea +_faea ;_beg =_ebg .Left -_gcagc *_bgbg /_cge ;_bgbg =_ebg .Right -_ebg .Left ;
};};_bfcc :=_beg -_dbdd ;_fdga :=_beg +_dfba ;_aed :=_ebg .Left ;_gdff :=_ebg .Right ;for _bedgc :=0;_bedgc < _cgg ;_bedgc ++{_ddg :=_ebg .Bottom -float64 (_bedgc )*_bfdd ;_fbdc .drawLineWithProps (_afe ,_bfcc ,_ddg ,_fdga ,_ddg ,true );_fbdc .drawLineWithProps (_bdgg ,_aed ,_ddg ,_gdff ,_ddg ,true );
};_eeb :=_bgbg /_cge ;_fgadc :=_ebg .Bottom -_cgef ;_cdfb :=_ebg .Bottom +_cfb ;_feee :=_ebg .Top ;_dfd :=_ebg .Bottom ;for _abd :=0;_abd < _fcc ;_abd ++{_ceg :=_ebg .Left +(_cdg -_gcagc )*_eeb ;_fbdc .drawLineWithProps (_ffg ,_ceg ,_fgadc ,_ceg ,_cdfb ,true );
_fbdc .drawLineWithProps (_egbe ,_ceg ,_feee ,_ceg ,_dfd ,true );if _aae {_dfde :=_effg .NewParagraph (_fg .FormatFloat (_cdg ,'g',-1,64));_dfde .SetFontSize (_bad *_eagf );_dfde .SetPos (_ceg -_efb *_eagf ,_dfd +_aafb *_eagf );_effg .Draw (_dfde );};_cdg +=_cddc ;
};}else {_bdaa :=_fbggb /_cge ;_fdce :=_ebg .Left ;if _aae {var _fccc float64 ;for _bdbg :=0;_bdbg < _fcc ;_bdbg ++{_ggcg :=_ebg .Bottom -(_cdg -_gcagc )*_bdaa ;_aga :=_effg .NewParagraph (_fg .FormatFloat (_cdg ,'g',-1,64));_aga .SetFontSize (_bad *_eagf );
_aga .SetPos (_fdce -_dgb *_eagf ,_ggcg -_eaa *_eagf );_effg .Draw (_aga );_gaf :=(_aga .Width ()/1000-_dgb )*_eagf ;if _gaf > 0&&_gaf > _fccc {_fccc =_gaf ;};_cdg +=_cddc ;};if _fccc > 0{_ebg .Left +=_fccc +_faea ;_bgbg =_ebg .Right -_ebg .Left ;};};_cdg =_gcagc ;
_adde :=_ebg .Left -_cfb ;_ddcb :=_ebg .Left +_cgef ;_fdce =_ebg .Left ;_daeg :=_ebg .Right ;for _bdgb :=0;_bdgb < _fcc ;_bdgb ++{_ffbe :=_ebg .Bottom -(_cdg -_gcagc )*_bdaa ;_fbdc .drawLineWithProps (_ffg ,_adde ,_ffbe ,_ddcb ,_ffbe ,true );_fbdc .drawLineWithProps (_egbe ,_fdce ,_ffbe ,_daeg ,_ffbe ,true );
_cdg +=_cddc ;};_eabc :=_bgbg /float64 (len (_fdg ));_effb :=_ebg .Bottom +_gcagc *_fbggb /_cge ;_afec :=_effb -_dfba ;_aad :=_effb +_dbdd ;_aedd :=_ebg .Top ;_dcbb :=_ebg .Bottom ;_edg :=_effb +_aafb *_eagf ;for _bac :=0;_bac < _cgg ;_bac ++{_gff :=_ebg .Left +float64 (_bac )*_eabc ;
_fbdc .drawLineWithProps (_afe ,_gff ,_afec ,_gff ,_aad ,true );_fbdc .drawLineWithProps (_bdgg ,_gff ,_aedd ,_gff ,_dcbb ,true );if _fda &&_bac < _cgg -1{_dacb :=_effg .NewParagraph (_fdg [_bac ]);_dacb .SetFontSize (_bad *_eagf );_dacb .SetPos (_gff +_dab *_eagf ,_edg );
_effg .Draw (_dacb );};};};return nil ;};func (_eea *creatorContext )addCatName (_defg string ,_dfb map[string ]serCategory ,_ecdf *[]string ){if _ ,_gcag :=_dfb [_defg ];!_gcag {_dfb [_defg ]=serCategory {_gdg :_defg ,_gead :[]serValue {}};*_ecdf =append (*_ecdf ,_defg );
};};func _gaff (_ffdb _eb .ST_SchemeColorVal ,_egbf *_eb .Theme )string {if _bddd :=_egbf .ThemeElements ;_bddd !=nil {if _gbf :=_bddd .ClrScheme ;_gbf !=nil {switch _ffdb {case _eb .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_gbf .Lt1 );
case _eb .ST_SchemeColorValDk1 ,_eb .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_gbf .Dk1 );case _eb .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_gbf .Lt2 );case _eb .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_gbf .Dk2 );
case _eb .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_gbf .Accent1 );case _eb .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_gbf .Accent2 );case _eb .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_gbf .Accent3 );
case _eb .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_gbf .Accent4 );case _eb .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_gbf .Accent5 );case _eb .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_gbf .Accent6 );
};};};return "";};type ImgPart byte ;type creatorContext struct{_aada *_fae .Creator ;_begg *_eb .Theme ;_ddage float64 ;};func CropImageByRect (sourceImg _d .Image ,rect _d .Rectangle )_d .Image {_edcf ,_deaf ,_efec ,_cage :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;
_agdbd :=_d .NewNRGBA (_d .Rect (0,0,_efec -_edcf ,_cage -_deaf ));for _eebb :=_edcf ;_eebb < _efec ;_eebb ++{for _cad :=_deaf ;_cad < _cage ;_cad ++{_agdbd .Set (_eebb -_edcf ,_cad -_deaf ,sourceImg .At (_eebb ,_cad ));};};return _agdbd ;};type fontsMap struct{_gecb *_f .Mutex ;
_bffa map[string ]map[FontStyle ]*_cc .PdfFont ;};var _aafb =_ccbe (1.5);func TwipsFromPoints (points float64 )float64 {return points /_dda .Twips };func _eebc (_bgca string )([]byte ,error ){_gbfa :=_b .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");
_bgca =_gbfa .ReplaceAllString (_bgca ,"");_fbdb :=[]rune (_bgca );_ddbfa :=[]byte {};for _aeb :=len (_fbdb )-2;_aeb >=0;_aeb -=2{_cbea ,_egd :=_fg .ParseUint (string (_fbdb [_aeb ])+string (_fbdb [_aeb +1]),16,8);if _egd !=nil {return nil ,_egd ;};_ddbfa =append (_ddbfa ,byte (_cbea ));
};return _ddbfa ,nil ;};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);func _bgea (_decf uint8 ,_aeeb float64 )string {_ffdfc :=float64 (_decf );
var _adfc float64 ;if _aeeb < 0{_adfc =_ffdfc *(1+_aeeb );}else {_adfc =_ffdfc +(255-_ffdfc )*_aeeb ;};return _fd .Sprintf ("\u0025\u0030\u0032\u0078",int (_adfc ));};var RtlFontFile *_cc .PdfFont ;func GetPageDimensions (size PageSize )_fae .PageSize {return _bbcg [size ]};
func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_dda .Twips *10+0.5))/10;};func (_gb *creatorContext )drawAreaChart (_ggc *_ad .CT_AreaChart ,_ca *Rectangle ,_ac []*_ad .CT_PlotAreaChoice1 ,_bf float64 )([]*legendItem ,error ){_dae :=[]*legendItem {};
_ada :=_ggc .Ser ;_dg :=make (map[int ][]float64 );_fb :=make (map[int ][]float64 );_cea :=make (map[int ]_fae .Color );for _gef ,_db :=range _ada {_cea [_gef ]=_fae .ColorWhite ;if _fcd :=_db .SpPr ;_fcd !=nil {_ccb :=_gb .getPdfColorFromSolidFill (_fcd .FillPropertiesChoice .SolidFill );
if _ccb !=nil {_cea [_gef ]=_ccb ;};};if _ec :=_db .Val ;_ec !=nil {if _dc :=_ec .NumDataSourceChoice ;_dc !=nil {if _be :=_dc .NumRef ;_be !=nil {if _ba :=_be .NumCache ;_ba !=nil {for _ ,_ddc :=range _ba .Pt {_dg [_gef ]=append (_dg [_gef ],float64 (_ddc .IdxAttr ));
_ag ,_ :=_fg .ParseFloat (_eff .TrimSpace (_ddc .V ),64);_fb [_gef ]=append (_fb [_gef ],_ag );};};};};};};_edb :=true ;_dbf :="";_cee :="";if len (_ac )> 1{if _ac [0].ValAx !=nil &&_ac [1].ValAx !=nil {if _ac [0].ValAx .Delete !=nil &&_ac [1].ValAx .Delete !=nil {if !*(*_ac [0].ValAx .Delete ).ValAttr &&!*(*_ac [1].ValAx .Delete ).ValAttr {_edb =false ;
};};_dbf =_gb .getTitle (_ac [0].ValAx .Title );_cee =_gb .getTitle (_ac [1].ValAx .Title );};};_gda :=_ab .Style {Hidden :_edb ,FontSize :8*_bf };_dgd :=&_bb .Chart {Series :[]_ddd .Series {},YAxisSecondary :_bb .YAxis {Style :_gda ,Name :_cee ,NameStyle :_gda },XAxis :_bb .XAxis {Style :_gda ,Name :_dbf ,NameStyle :_gda },YAxis :_bb .YAxis {Style :_ab .Style {Hidden :true }}};
for _gc :=0;_gc < len (_cea );_gc ++{_dcf ,_fe ,_ee :=_cea [_gc ].ToRGB ();_cg :=_ddd .ContinuousSeries {XValues :_dg [_gc ],YValues :_fb [_gc ],Style :_ab .Style {StrokeWidth :1,FillColor :_g .RGBA {uint8 (_dcf *255),uint8 (_fe *255),uint8 (_ee *255),255}}};
_dgd .Series =append (_dgd .Series ,_cg );};_dgd .SetHeight (int (_ge .Abs (_ca .Top -_ca .Bottom )));_dgd .SetWidth (int (_ge .Abs (_ca .Right -_ca .Left )));_bfe :=_gb ._aada ;_ggg :=_fae .NewChart (_dgd );_ggg .SetPos (_ca .Left ,_ca .Top );_bd :=_bfe .Draw (_ggg );
if _bd !=nil {return nil ,_bd ;};return _dae ,nil ;};func AssignStdFontByName (style _fae .TextStyle ,fontName string )*_cc .PdfFont {_bfcd :=_cc .StdFontName (fontName );return _cc .NewStandard14FontMustCompile (_bfcd );};func AdjustColorByTint (colorStr string ,tint float64 )string {var _ebge ,_bgd ,_cbb uint8 ;
_dec ,_ :=_fd .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_ebge ,&_bgd ,&_cbb );if _dec !=3{return "";};return _bgea (_ebge ,tint )+_bgea (_bgd ,tint )+_bgea (_cbb ,tint );};func (_ece *creatorContext )addCatValue (_fad string ,_fdef map[string ]serCategory ,_gcg []string ,_ebf int ,_agg ,_gbd *float64 ,_dfbd string ,_ade *_eb .CT_ShapeProperties ){_dfg ,_fbae :=_fg .ParseFloat (_fad ,64);
if _fbae !=nil {_dfg =0;_ce .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_fbae );};if _dfg > *_gbd {*_gbd =_dfg ;};if _dfg < *_agg {*_agg =_dfg ;};_ebe :=_fdef [_gcg [_ebf ]];_ebe ._gead =append (_ebe ._gead ,serValue {_ecee :_dfbd ,_add :_dfg ,_babb :_ade });
_fdef [_gcg [_ebf ]]=_ebe ;};func IsNoSpaceLanguage (symbol string )bool {for _ ,_gbce :=range symbol {if _ef .Is (_ef .Han ,_gbce ){return true ;};};return false ;};func GetOpacityFromColorTransform (trs []*_eb .EG_ColorTransform )float64 {for _ ,_dcfa :=range trs {if _dcfa !=nil {if _ffdf :=_dcfa .ColorTransformChoice .Alpha ;
_ffdf !=nil {if _dbddf :=_ffdf .ValAttr .ST_PositiveFixedPercentageDecimal ;_dbddf !=nil {return float64 (*_dbddf )/Percent100 ;};};};};return 1.0;};func MakeBlockFromCreator (c *_fae .Creator )(*_fae .Block ,error ){_cbcf ,_agc :=GetPageFromCreator (c );
if _agc !=nil {return nil ,_agc ;};_cbagd ,_agc :=_fae .NewBlockFromPage (_cbcf );if _agc !=nil {return nil ,_agc ;};return _cbagd ,nil ;};func MakeTempCreator (width ,height float64 )*_fae .Creator {_bbbc :=_fae .New ();_bbbc .SetPageSize (_fae .PageSize {width ,height });
_bbbc .SetPageMargins (0,0,0,0);return _bbbc ;};func (_degg *creatorContext )getTitle (_cbf *_ad .CT_Title )string {_ggb :="";if _cbf !=nil &&_cbf .Tx !=nil &&_cbf .Tx .TxChoice !=nil &&_cbf .Tx .TxChoice .Rich !=nil {if len (_cbf .Tx .TxChoice .Rich .P )> 0{for _ ,_edf :=range _cbf .Tx .TxChoice .Rich .P {if len (_edf .EG_TextRun )> 0{_ggb +="\u000a"+_edf .EG_TextRun [0].TextRunChoice .R .T ;
};};};};return _ggb ;};func DrawRectangle (c *_fae .Creator ,r *Rectangle ,w float64 ,color _fae .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );
DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};func (_gag *Rectangle )scale (_abc float64 ){_gag .Top *=_abc ;_gag .Bottom *=_abc ;_gag .Left *=_abc ;_gag .Right *=_abc ;
};type serCategory struct{_gdg string ;_gead []serValue ;};func GetColorStringFromDmlColor (dmlColor *_eb .CT_Color )string {var _aba string ;if _cbag :=dmlColor .SrgbClr ;_cbag !=nil {_aba =_cbag .ValAttr ;}else if _aab :=dmlColor .SysClr ;_aab !=nil {if _aab .LastClrAttr !=nil {return *_aab .LastClrAttr ;
};return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _aba ;};var _efb =_ccbe (0.5);func AdjustColor (colorStr string ,EG_ColorTransform []*_eb .EG_ColorTransform )string {for _ ,_cdfg :=range EG_ColorTransform {if _dcbbc :=_cdfg .ColorTransformChoice .Tint ;
_dcbbc !=nil {if _gefc :=_dcbbc .ValAttr .ST_PositiveFixedPercentageDecimal ;_gefc !=nil {colorStr =AdjustColorByTint (colorStr ,1.0-float64 (*_gefc )/Percent100 );};};if _dbfdd :=_cdfg .ColorTransformChoice .Shade ;_dbfdd !=nil {if _cgac :=_dbfdd .ValAttr .ST_PositiveFixedPercentageDecimal ;
_cgac !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_cgac )/Percent100 );};};if _ecf :=_cdfg .ColorTransformChoice .LumMod ;_ecf !=nil {if _ebded :=_ecf .ValAttr .ST_PercentageDecimal ;_ebded !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_ebded )/Percent100 );
};};if _bfb :=_cdfg .ColorTransformChoice .LumOff ;_bfb !=nil {if _geadf :=_bfb .ValAttr .ST_PercentageDecimal ;_geadf !=nil {colorStr =AdjustColorByLumOff (colorStr ,float64 (*_geadf )/Percent100 );};};};return colorStr ;};func ParseExcelRange (s string )(string ,_ged .CellReference ,_ged .CellReference ,error ){_fec :=_eff .FieldsFunc (s ,func (_bfddg rune )bool {return _bfddg ==':'||_bfddg =='!'});
if len (_fec )==3{_fadgc ,_acaf :=_ged .ParseCellReference (_fec [1]);if _acaf !=nil {return "",_ged .CellReference {},_ged .CellReference {},_acaf ;};_gfef ,_acaf :=_ged .ParseCellReference (_fec [2]);if _acaf !=nil {return "",_ged .CellReference {},_ged .CellReference {},_acaf ;
};return _fec [0],_fadgc ,_gfef ,nil ;};return "",_ged .CellReference {},_ged .CellReference {},_dd .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");};func (_fbb *creatorContext )getPdfColorFromSolidFill (_gabf *_eb .CT_SolidColorFillProperties )_fae .Color {if _gabf ==nil {return nil ;
};_ggbb :="";if _bbbg :=_gabf .SrgbClr ;_bbbg !=nil {_ggbb =_bbbg .ValAttr ;}else if _effd :=_gabf .SchemeClr ;_effd !=nil {_ggbb =_gaff (_effd .ValAttr ,_fbb ._begg );_ggbb =AdjustColor (_ggbb ,_effd .EG_ColorTransform );};if _ggbb ==""{return nil ;};
return _fae .ColorRGBFromHex ("\u0023"+_ggbb );};func GetImage (c *_fae .Creator ,goImg _d .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_fae .Image ,error ){if goImg ==nil {return nil ,nil ;};_bged :=goImg .Bounds ().Size ();
_gfac :=_bged .X ;_fdfb :=_bged .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_gfac );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_fdfb );};var _acgg _d .Rectangle ;switch part {case ImgPart_t :_acgg =_d .Rect (0,0,_gfac ,int (dividerY ));
case ImgPart_b :_acgg =_d .Rect (0,int (dividerY ),_gfac ,_fdfb );case ImgPart_l :_acgg =_d .Rect (0,0,int (dividerX ),_fdfb );case ImgPart_r :_acgg =_d .Rect (int (dividerX ),0,_gfac ,_fdfb );case ImgPart_lt :_acgg =_d .Rect (0,0,int (dividerX ),int (dividerY ));
case ImgPart_rt :_acgg =_d .Rect (int (dividerX ),0,_gfac ,int (dividerY ));case ImgPart_lb :_acgg =_d .Rect (0,int (dividerY ),int (dividerX ),_fdfb );case ImgPart_rb :_acgg =_d .Rect (int (dividerX ),int (dividerY ),_gfac ,_fdfb );default:_acgg =_d .Rect (0,0,_gfac ,_fdfb );
};_gedc :=CropImageByRect (goImg ,_acgg );_cbbg ,_fag :=c .NewImageFromGoImage (_gedc );if _fag !=nil {return nil ,_fag ;};_cbbg .Scale (imgWidth /float64 (_gfac ),imgHeight /float64 (_fdfb ));_cbbg .SetPos (left ,top );return _cbbg ,nil ;};func (_gafd *creatorContext )drawScatterChart (_bedfb *_ad .CT_ScatterChart ,_gebgg *Rectangle ,_ggdc []*_ad .CT_PlotAreaChoice1 ,_aebbd float64 )([]*legendItem ,error ){_gbad :=[]*legendItem {};
_gcga :=_bedfb .Ser ;_bfga :=make (map[string ]float64 );_cacb :=make (map[string ][]float64 );_feed :=make (map[string ][]float64 );_cefg :=[]string {};for _ ,_ccc :=range _gcga {var _ddf string ;if _gfag :=_ccc .Tx ;_gfag !=nil {if _agffc :=_gfag .SerTxChoice ;
_agffc !=nil {if _agffc .V !=nil {_ddf =*_agffc .V ;}else if _beff :=_agffc .StrRef ;_beff !=nil {if _feb :=_beff .StrCache ;_feb !=nil {for _ ,_dgcd :=range _feb .Pt {_ddf =_dgcd .V ;};};};_cefg =append (_cefg ,_ddf );};};if _ccc .Marker !=nil &&_ccc .Marker .Size !=nil {_bfga [_ddf ]=float64 (*_ccc .Marker .Size .ValAttr );
}else {_bfga [_ddf ]=-1.0;};if _ebeag :=_ccc .XVal ;_ebeag !=nil {if _gfda :=_ebeag .AxDataSourceChoice ;_gfda !=nil {if _ebeg :=_gfda .NumRef ;_ebeg !=nil {if _gdae :=_ebeg .NumCache ;_gdae !=nil {for _ ,_fbce :=range _gdae .Pt {_befg ,_ :=_fg .ParseFloat (_eff .TrimSpace (_fbce .V ),64);
_cacb [_ddf ]=append (_cacb [_ddf ],_befg );};};};};};if _dabd :=_ccc .YVal ;_dabd !=nil {if _bgdfc :=_dabd .NumDataSourceChoice ;_bgdfc !=nil {if _dbgb :=_bgdfc .NumRef ;_dbgb !=nil {if _dggc :=_dbgb .NumCache ;_dggc !=nil {for _ ,_edcg :=range _dggc .Pt {_gddb ,_ :=_fg .ParseFloat (_eff .TrimSpace (_edcg .V ),64);
_feed [_ddf ]=append (_feed [_ddf ],_gddb );};};};};};};_fdbd :=true ;_gcbb :="";_cgcf :="";if len (_ggdc )> 1{if _ggdc [0].ValAx .Delete !=nil &&_ggdc [1].ValAx .Delete !=nil {if !*(*_ggdc [0].ValAx .Delete ).ValAttr &&!*(*_ggdc [1].ValAx .Delete ).ValAttr {_fdbd =false ;
};};_gcbb =_gafd .getTitle (_ggdc [0].ValAx .Title );_cgcf =_gafd .getTitle (_ggdc [1].ValAx .Title );};_dfgf :=_ab .Style {Hidden :_fdbd ,FontSize :8*_aebbd };_eeg :=&_bb .Chart {Series :[]_ddd .Series {},YAxisSecondary :_bb .YAxis {Style :_dfgf ,Name :_cgcf ,NameStyle :_dfgf },XAxis :_bb .XAxis {Style :_dfgf ,Name :_gcbb ,NameStyle :_dfgf },YAxis :_bb .YAxis {Style :_ab .Style {Hidden :true }}};
for _ ,_ddeg :=range _cefg {_gdea :=_ddd .ContinuousSeries {XValues :_cacb [_ddeg ],YValues :_feed [_ddeg ],Style :_ab .Style {StrokeWidth :-1,DotWidth :_bfga [_ddeg ]}};_eeg .Series =append (_eeg .Series ,_gdea );};_eeg .SetHeight (int (_ge .Abs (_gebgg .Top -_gebgg .Bottom )));
_eeg .SetWidth (int (_ge .Abs (_gebgg .Right -_gebgg .Left )));_gebc :=_gafd ._aada ;_cecd :=_fae .NewChart (_eeg );_cecd .SetPos (_gebgg .Left ,_gebgg .Top );_cdbf :=_gebc .Draw (_cecd );if _cdbf !=nil {return nil ,_cdbf ;};return _gbad ,nil ;};func MakeBlockFromChartSpace (cs *_ad .ChartSpace ,width ,height float64 ,theme *_eb .Theme )(*_fae .Block ,error ){_afb ,_ebb :=_babg (cs ,width ,height ,theme ,false ,nil );
if _ebb !=nil {return nil ,_ebb ;};_bca ,_ebb :=GetPageFromCreator (_afb );if _ebb !=nil {return nil ,_ebb ;};_dee ,_ebb :=_fae .NewBlockFromPage (_bca );if _ebb !=nil {return nil ,_ebb ;};return _dee ,nil ;};func _fege (_gaae string )error {if !_eff .HasSuffix (_gaae ,"\u002e\u0074\u0074\u0066"){_ce .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _fd .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_fgbca ,_abac :=_c .ParseFile (_gaae );if _abac !=nil {_ce .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_abac );return _abac ;};_dece ,_abac :=_cc .NewCompositePdfFontFromTTFFile (_gaae );
if _abac !=nil {return _abac ;};_caf :=_fgbca .GetNameRecords ();for _ ,_abegb :=range _caf {_gdad :=_abegb [1];if _gdad ==""{continue ;};_daed :=make ([]byte ,0);for _bgfc :=0;_bgfc < len (_gdad );_bgfc ++{if _gdad [_bgfc ]==39||_gdad [_bgfc ]==92{continue ;
};_ffdd :=4;if _bgfc +_ffdd < len (_gdad ){if _gdad [_bgfc :_bgfc +_ffdd ]=="\u0000"{_bgfc =_bgfc +_ffdd +1;continue ;};};_daed =append (_daed ,_gdad [_bgfc ]);};_gdad =_eff .Replace (string (_daed ),"\u0078\u0030\u0030","",-1);_efc :=_abegb [2];if _efc ==""{return _fd .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_gaae );
};_daed =make ([]byte ,0);for _ace :=0;_ace < len (_efc );_ace ++{if _efc [_ace ]==39||_efc [_ace ]==92{continue ;};_bfbba :=4;if _ace +_bfbba < len (_efc ){if _efc [_ace :_ace +_bfbba ]=="\u0000"{_ace =_ace +_bfbba +1;continue ;};};_daed =append (_daed ,_efc [_ace ]);
};_efc =_eff .Replace (string (_daed ),"\u0078\u0030\u0030","",-1);RegisterFont (_gdad ,_efef [_efc ],_dece );};return nil ;};func (_dbfd barSerByOrder )Swap (i ,j int ){_dbfd [i ],_dbfd [j ]=_dbfd [j ],_dbfd [i ]};func RegisterFontsFromDirectory (dirName string )error {_dcgg ,_fcge :=_fa .Open (dirName );
if _fcge !=nil {return _fcge ;};defer _dcgg .Close ();_gfd ,_fcge :=_dcgg .Readdirnames (0);if _fcge !=nil {return _fcge ;};for _ ,_dbc :=range _gfd {if _eff .HasSuffix (_dbc ,"\u002e\u0074\u0074\u0066"){_ffead :=dirName +"\u002f"+_dbc ;_defa :=_fege (_ffead );
if _defa !=nil {_ce .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_defa );
continue ;};};};return nil ;};func (_bga *creatorContext )drawBorderWithProps (_gaeb *_eb .CT_ShapeProperties ,_aebg *Rectangle ,_abbf float64 ){if _aebg !=nil &&_gaeb !=nil &&_gaeb .Ln !=nil &&_gaeb .Ln .LineFillPropertiesChoice .SolidFill !=nil {_ecdg :=_bga .getPdfColorFromSolidFill (_gaeb .Ln .LineFillPropertiesChoice .SolidFill );
DrawRectangle (_bga ._aada ,_aebg ,_abbf ,_ecdg );};};func MakeImageFromChartSpace (cs *_ad .ChartSpace ,width ,height float64 ,theme *_eb .Theme ,workbook *_bgb .Workbook )(_d .Image ,error ){_cfc ,_efg :=_babg (cs ,width ,height ,theme ,true ,workbook );
if _efg !=nil {return nil ,_efg ;};_gcfe ,_efg :=GetPageFromCreator (_cfc );if _efg !=nil {return nil ,_efg ;};return _a .NewImageDevice ().Render (_gcfe );};func GetGroupOffsetFromXfrm (xfrm *_eb .CT_GroupTransform2D )(float64 ,float64 ){var _fdec ,_gdgg float64 ;
if xfrm .Off !=nil &&xfrm .ChOff !=nil {_fdec =_dda .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_dda .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));_gdgg =_dda .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_dda .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));
};return _fdec ,_gdgg ;};var _faea =_ccbe (2);const _bad =6.0;func _eda (_edaf _eb .ST_SchemeColorVal ,_gcfc *_eb .Theme )string {if _abf :=_gcfc .ThemeElements ;_abf !=nil {if _fead :=_abf .ClrScheme ;_fead !=nil {switch _edaf {case _eb .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_fead .Lt1 );
case _eb .ST_SchemeColorValDk1 ,_eb .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_fead .Dk1 );case _eb .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_fead .Lt2 );case _eb .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_fead .Dk2 );
case _eb .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_fead .Accent1 );case _eb .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_fead .Accent2 );case _eb .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_fead .Accent3 );
case _eb .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_fead .Accent4 );case _eb .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_fead .Accent5 );case _eb .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_fead .Accent6 );
};};};return "";};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func _adb (_cged *_ad .CT_DateAx )(uint32 ,_ad .ST_AxPos ,_ad .ST_TickMark ,_ad .ST_TickLblPos ,*_ad .CT_ChartLines ,uint32 ,*_eb .CT_ShapeProperties ,error ){var _aec ,_bfdf uint32 ;var _fdeb _ad .ST_AxPos ;var _agf _ad .ST_TickMark ;var _daf *_ad .CT_ChartLines ;
var _fegd _ad .ST_TickLblPos ;if _cged .AxId ==nil {return _aec ,_fdeb ,_agf ,_fegd ,_daf ,_bfdf ,_cged .SpPr ,_dd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_aec =_cged .AxId .ValAttr ;};if _cged .AxPos ==nil {return _aec ,_fdeb ,_agf ,_fegd ,_daf ,_bfdf ,_cged .SpPr ,_dd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_fdeb =_cged .AxPos .ValAttr ;};if _cged .MajorTickMark !=nil {_agf =_cged .MajorTickMark .ValAttr ;};if _cged .TickLblPos !=nil {_fegd =_cged .TickLblPos .ValAttr ;};if _cged .CrossAx ==nil {return _aec ,_fdeb ,_agf ,_fegd ,_daf ,_bfdf ,_cged .SpPr ,_dd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_bfdf =_cged .CrossAx .ValAttr ;};_daf =_cged .MajorGridlines ;return _aec ,_fdeb ,_agf ,_fegd ,_daf ,_bfdf ,_cged .SpPr ,nil ;};func FromSTCoordinate (st _eb .ST_Coordinate )int64 {if _ffcb :=st .ST_CoordinateUnqualified ;_ffcb !=nil {return *_ffcb ;
};return 0;};func GetDataFromXfrm (xfrm *_eb .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _gbafc ,_dfed ,_cbda ,_bbcc float64 ;if _abede :=xfrm .Off ;_abede !=nil {_gbafc =_dda .FromEMU (FromSTCoordinate (_abede .XAttr ));_dfed =_dda .FromEMU (FromSTCoordinate (_abede .YAttr ));
};if _dgf :=xfrm .Ext ;_dgf !=nil {_cbda =_dda .FromEMU (_dgf .CxAttr );_bbcc =_dda .FromEMU (_dgf .CyAttr );};return _gbafc ,_dfed ,_cbda ,_bbcc ;};func FromSTPercentage (st *_eb .ST_Percentage )float64 {if _gaed :=st .ST_PercentageDecimal ;_gaed !=nil {return float64 (*_gaed )/Percent100 ;
};return 0;};func _aac (_fega uint8 ,_ggce float64 )string {_gbg :=float64 (_fega );return _fd .Sprintf ("\u0025\u0030\u0032\u0078",int (_gbg *_ggce ));};func DrawLine (c *_fae .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _fae .Color ){if color ==nil {return ;
};_gefbf :=c .NewLine (x0 ,y0 ,x1 ,y1 );_gefbf .SetLineWidth (width );_gefbf .SetColor (color );c .Draw (_gefbf );};func LoadFontFromFile (filename string )(*_cc .PdfFont ,error ){if !_eff .HasSuffix (filename ,"\u002e\u0074\u0074\u0066"){_ce .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return nil ,_fd .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_ecfg ,_bbff :=_cc .NewCompositePdfFontFromTTFFile (filename );if _bbff !=nil {return nil ,_bbff ;};return _ecfg ,nil ;};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _bede ,_efac ,_cbc uint8 ;_gdd ,_ :=_fd .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_bede ,&_efac ,&_cbc );
if _gdd !=3{return "";};_ggca ,_fdd ,_bfbb :=_fabe (_bede ,_efac ,_cbc );_bfbb =lum *_bfbb ;_bede ,_efac ,_cbc =_fbgf (_ggca ,_fdd ,_bfbb );return _fd .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_bede ,_efac ,_cbc );
};func (_deg barSerByOrder )Len ()int {return len (_deg )};func MakeTempCreatorMaxHeight (width float64 )*_fae .Creator {return MakeTempCreator (width ,_ge .MaxFloat64 );};func _ccbe (_bggcb float64 )float64 {return _bggcb *_dda .Millimeter };func AdjustColorByShade (colorStr string ,shade float64 )string {var _cfbf ,_cgcc ,_afbd uint8 ;
_dabg ,_ :=_fd .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_cfbf ,&_cgcc ,&_afbd );if _dabg !=3{return "";};return _aac (_cfbf ,shade )+_aac (_cgcc ,shade )+_aac (_afbd ,shade );};func _babg (_bcf *_ad .ChartSpace ,_dff ,_aff float64 ,_ebd *_eb .Theme ,_fdba bool ,_daa *_bgb .Workbook )(*_fae .Creator ,error ){_faee :=1.0;
if _fdba {_faee =8.0;};_cgaa :=&Rectangle {};_age :=&Rectangle {Top :_cgaa .Top ,Bottom :_aff -_cgaa .Bottom ,Left :_cgaa .Left ,Right :_dff -_cgaa .Right };_gba :=MakeTempCreator (_dff *_faee +1,_aff *_faee +1);_acbg :=&creatorContext {_aada :_gba ,_begg :_ebd ,_ddage :_faee };
var _fab bool ;if _fbc :=_bcf .Chart ;_fbc !=nil {_baf :=_fbc .PlotArea ;if _baf ==nil {return nil ,_dd .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_ffb :=0.0;if _fbc .AutoTitleDeleted !=nil &&_fbc .AutoTitleDeleted .ValAttr !=nil &&!*_fbc .AutoTitleDeleted .ValAttr {if _fbc .Title !=nil &&_fbc .Title .Overlay !=nil &&_fbc .Title .Overlay .ValAttr !=nil &&!*_fbc .Title .Overlay .ValAttr {_ffb =_ccbe (10);
};_ebde :=_acbg .getTitle (_fbc .Title );if _ebde ==""{_ebde ="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";};_acbg .drawTitle (_ebde ,_age .Left +_age .Right /2,_ccbe (5));};_edc :=&Rectangle {Top :_ccbe (10)+_ffb ,Bottom :_age .Bottom -_ccbe (15),Left :_ccbe (10),Right :_age .Right -_ccbe (10)};
var _aded *Rectangle ;_ddb :=_fbc .Legend ;if _ddb !=nil {_faf :=_ddb .Overlay !=nil &&_ddb .Overlay .ValAttr !=nil &&*_ddb .Overlay .ValAttr ;if _acg :=_ddb .LegendPos ;_acg !=nil {switch _acg .ValAttr {case _ad .ST_LegendPosTr :if !_faf {_edc =&Rectangle {Top :_ccbe (25)+_ffb ,Bottom :_age .Bottom -_ccbe (10),Left :_ccbe (10),Right :_age .Right -_ccbe (25)};
};_aded =&Rectangle {Top :_ccbe (2.5)+_ffb ,Bottom :_ccbe (22.5),Left :_age .Right -_ccbe (22.5),Right :_age .Right -_ccbe (2.5)};case _ad .ST_LegendPosT :_aded =&Rectangle {Top :_ccbe (2.5)+_ffb ,Bottom :_ccbe (7.5),Left :(_age .Right -_age .Left )*0.25,Right :(_age .Right -_age .Left )*0.75};
if !_faf {_edc =&Rectangle {Top :_ccbe (12.5)+_ffb ,Bottom :_age .Bottom -_ccbe (15),Left :_ccbe (10),Right :_age .Right -_ccbe (5)};};_fab =true ;case _ad .ST_LegendPosB :_aded =&Rectangle {Top :_age .Bottom -_ccbe (7.5)+_ffb ,Bottom :_age .Bottom -_ccbe (2.5),Left :(_age .Right -_age .Left )*0.25,Right :(_age .Right -_age .Left )*0.75};
if !_faf {_edc =&Rectangle {Top :_ccbe (5)+_ffb ,Bottom :_age .Bottom -_ccbe (15),Left :_ccbe (10),Right :_age .Right -_ccbe (5)};};_fab =true ;case _ad .ST_LegendPosR :_aded =&Rectangle {Top :(_age .Bottom -_age .Top )/2-_ccbe (10)+_ffb ,Bottom :(_age .Bottom -_age .Top )/2+_ccbe (10),Left :_age .Right -_ccbe (22.5),Right :_age .Right -_ccbe (2.5)};
if !_faf {_edc =&Rectangle {Top :_ccbe (5)+_ffb ,Bottom :_age .Bottom -_ccbe (12.5),Left :_ccbe (10),Right :_age .Right -_ccbe (25)};};case _ad .ST_LegendPosL :_aded =&Rectangle {Top :(_age .Bottom -_age .Top )/2-_ccbe (10)+_ffb ,Bottom :(_age .Bottom -_age .Top )/2+_ccbe (10),Left :_ccbe (2.5),Right :_ccbe (22.5)};
if !_faf {_edc =&Rectangle {Top :_ccbe (5)+_ffb ,Bottom :_age .Bottom -_ccbe (12.5),Left :_ccbe (30),Right :_age .Right -_ccbe (5)};};default:_aded =&Rectangle {Top :(_age .Bottom -_age .Top )/2-_ccbe (10)+_ffb ,Bottom :(_age .Bottom -_age .Top )/2+_ccbe (10),Left :_age .Right -_ccbe (25),Right :_age .Right -_ccbe (5)};
if !_faf {_edc =&Rectangle {Top :_ccbe (5)+_ffb ,Bottom :_age .Bottom -_ccbe (12.5),Left :_ccbe (100),Right :_age .Right -_ccbe (25)};};};};};_edc .scale (_faee );_acbg .drawBorderWithProps (_baf .SpPr ,_edc ,_ffc );_ccbc :=[]*legendItem {};var _cdf error ;
_ebba :=_baf .PlotAreaChoice1 ;for _ ,_bgge :=range _baf .PlotAreaChoice {if _aa :=_bgge .BarChart ;_aa !=nil {_ccbc ,_cdf =_acbg .drawBarChart (_aa ,_edc ,_ebba ,_daa );if _cdf !=nil {return nil ,_cdf ;};break ;};if _bdf :=_bgge .PieChart ;_bdf !=nil {_ccbc ,_cdf =_acbg .drawPieChart (_bdf ,_edc ,_daa ,_faee );
if _cdf !=nil {return nil ,_cdf ;};break ;};if _gbc :=_bgge .ScatterChart ;_gbc !=nil {_ccbc ,_cdf =_acbg .drawScatterChart (_gbc ,_edc ,_ebba ,_faee );if _cdf !=nil {return nil ,_cdf ;};break ;};if _bggae :=_bgge .LineChart ;_bggae !=nil {_ccbc ,_cdf =_acbg .drawLineChart (_bggae ,_edc ,_ebba ,_faee );
if _cdf !=nil {return nil ,_cdf ;};break ;};if _dbfg :=_bgge .AreaChart ;_dbfg !=nil {_ccbc ,_cdf =_acbg .drawAreaChart (_dbfg ,_edc ,_ebba ,_faee );if _cdf !=nil {return nil ,_cdf ;};break ;};};if _ddb !=nil {_aded .scale (_faee );_acbg .drawBorderWithProps (_ddb .SpPr ,_aded ,_ffc );
if len (_ccbc )!=0{_acbg .drawLegend (_aded ,_ccbc ,_fab );};};};_age .scale (_faee );_acbg .drawBorderWithProps (_bcf .SpPr ,_age ,_ffc );return _gba ,nil ;};func _ddbf (_dfbb *_bg .Document ,_ffee ,_bdge ,_fdbc string )error {_caaf ,_ceeb :=_dfbb .GetFontBytesByRelId (_bdge );
if _ceeb !=nil {return _ceeb ;};_abde ,_ceeb :=_eebc (_fdbc );if _ceeb !=nil {return _ceeb ;};for _agda :=0;_agda < 32;_agda ++{_ebdb :=_agda %len (_abde );_caaf [_agda ]=_caaf [_agda ]^_abde [_ebdb ];};_bffg :=_dfbb .TmpPath +"\u002f"+_ffee +"\u002e\u0074\u0074\u0066";
_ceeb =_fa .WriteFile (_bffg ,_caaf ,0644);if _ceeb !=nil {return _ceeb ;};_fege (_bffg );return nil ;};type BorderPosition byte ;func (_ede *creatorContext )drawRectangleWithProps (_dba *_eb .CT_ShapeProperties ,_aedb ,_bcgb ,_bcfba ,_eabg float64 ,_bddf bool ){_abda :=_ede ._aada .NewRectangle (_aedb ,_bcgb ,_bcfba ,_eabg );
if _dba ==nil {if _bddf {_abda .SetBorderWidth (_ffc );}else {return ;};}else {_bba :=_ede .getPdfColorFromSolidFill (_dba .FillPropertiesChoice .SolidFill );if _bba !=nil {_abda .SetFillColor (_bba );};if _gffg :=_dba .Ln ;_gffg !=nil {if _cgcg :=_gffg .WAttr ;
_cgcg !=nil {_bfaf :=_dda .FromEMU (int64 (*_cgcg ));_abda .SetBorderWidth (_bfaf );if _cbec :=_gffg .LineFillPropertiesChoice .SolidFill ;_cbec !=nil {_acab :=_ede .getPdfColorFromSolidFill (_cbec );if _acab !=nil {_abda .SetBorderColor (_acab );};};}else {_abda .SetBorderWidth (0);
};};};_ede ._aada .Draw (_abda );};func GetRegisteredFont (name string ,style FontStyle )*_cc .PdfFont {_geg ._gecb .Lock ();defer _geg ._gecb .Unlock ();if _faeaf ,_bcdb :=_geg ._bffa [name ];_bcdb {if _dafa ,_aeef :=_faeaf [style ];_aeef {return _dafa ;
};};return nil ;};func _ebc (_caae *_ad .CT_CatAx )(uint32 ,_ad .ST_AxPos ,_ad .ST_TickMark ,_ad .ST_TickLblPos ,*_ad .CT_ChartLines ,uint32 ,*_eb .CT_ShapeProperties ,error ){var _egc ,_feea uint32 ;var _cddg _ad .ST_AxPos ;var _agdb _ad .ST_TickMark ;
var _cggc *_ad .CT_ChartLines ;var _geab _ad .ST_TickLblPos ;if _caae .AxId ==nil {return _egc ,_cddg ,_agdb ,_geab ,_cggc ,_feea ,_caae .SpPr ,_dd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_egc =_caae .AxId .ValAttr ;
};if _caae .AxPos ==nil {return _egc ,_cddg ,_agdb ,_geab ,_cggc ,_feea ,_caae .SpPr ,_dd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_cddg =_caae .AxPos .ValAttr ;};if _caae .MajorTickMark !=nil {_agdb =_caae .MajorTickMark .ValAttr ;
};if _caae .TickLblPos !=nil {_geab =_caae .TickLblPos .ValAttr ;};if _caae .CrossAx ==nil {return _egc ,_cddg ,_agdb ,_geab ,_cggc ,_feea ,_caae .SpPr ,_dd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_feea =_caae .CrossAx .ValAttr ;};_cggc =_caae .MajorGridlines ;return _egc ,_cddg ,_agdb ,_geab ,_cggc ,_feea ,_caae .SpPr ,nil ;};var _dab =_ccbe (5);var _ffc =_ccbe (0.125);var _geg =fontsMap {_gecb :&_f .Mutex {},_bffa :map[string ]map[FontStyle ]*_cc .PdfFont {}};
func FillRectangle (c *_fae .Creator ,x ,y ,width ,height float64 ,color _fae .Color ){if color ==nil {return ;};_gcfg :=c .NewRectangle (x ,y ,width ,height );_gcfg .SetFillColor (color );_gcfg .SetBorderWidth (0);c .Draw (_gcfg );};const (BorderPositionTop BorderPosition =0;
BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);var _ggd =_ccbe (1.5);const (PageSizeA4 PageSize =iota ;PageSizeA3 ;PageSizeA5 ;PageSizeLetter ;PageSizeLegal ;Percent100 =100000.0;);type Rectangle struct{Top float64 ;
Bottom float64 ;Left float64 ;Right float64 ;};func (_cefa *Rectangle )Translate (x ,y float64 ){_cefa .Left +=x ;_cefa .Right +=x ;_cefa .Top +=y ;_cefa .Bottom +=y ;};func (_ddag FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_ddag )];
};func (_ecd *creatorContext )drawBarChart (_gdc *_ad .CT_BarChart ,_df *Rectangle ,_bge []*_ad .CT_PlotAreaChoice1 ,_faa *_bgb .Workbook )([]*legendItem ,error ){var _fce bool ;if _efd :=_gdc .BarDir ;_efd !=nil {_fce =_efd .ValAttr ==_ad .ST_BarDirBar ;
};_acb :=_gdc .Ser ;_ed .Sort (barSerByOrder (_acb ));_gga :=map[string ]serCategory {};_fcg :=[]string {};_cb :=[]*legendItem {};_adae :=_ge .Inf (1);_eec :=_ge .Inf (-1);for _ ,_bc :=range _acb {var _ff string ;if _bee :=_bc .Tx ;_bee !=nil {if _de :=_bee .SerTxChoice ;
_de !=nil {if _de .V !=nil {_ff =*_de .V ;}else if _gcc :=_de .StrRef ;_gcc !=nil {if _dbfe :=_gcc .StrCache ;_dbfe !=nil {for _ ,_gcf :=range _dbfe .Pt {_ff =_gcf .V ;};};};};};if _acbe :=_bc .Cat ;_acbe !=nil {if _ffe :=_acbe .AxDataSourceChoice ;_ffe !=nil {if _dgdf :=_ffe .StrRef ;
_dgdf !=nil {if _ceea :=_dgdf .F ;_ceea !=""&&_faa !=nil {_dgc ,_eca ,_cf ,_geb :=ParseExcelRange (_ceea );if _geb ==nil {for _ ,_eee :=range _faa .Sheets (){if _eee .Name ()==_eff .Trim (_dgc ,"\u0027"){_fee :=_eca .String ();for _bgg :=_eca .RowIdx ;
_bgg <=_cf .RowIdx ;_bgg +=1{_gdacg :=_eff .ReplaceAll (_fee ,_fd .Sprint (_eca .RowIdx ),_fd .Sprint (_bgg ));_ecd .addCatName (_eee .Cell (_gdacg ).GetString (),_gga ,&_fcg );};break ;};};};};if _dcg :=_dgdf .StrCache ;_dcg !=nil {for _ ,_bbf :=range _dcg .Pt {_ecd .addCatName (_bbf .V ,_gga ,&_fcg );
};};}else if _fgb :=_ffe .NumRef ;_fgb !=nil {if _agd :=_fgb .NumCache ;_agd !=nil {var _abe string ;if _agd .FormatCode !=nil {_abe =*_agd .FormatCode ;};for _ ,_ga :=range _agd .Pt {var _bea string ;if _ga .FormatCodeAttr ==nil {_bea =_abe ;}else {_bea =*_ga .FormatCodeAttr ;
};var _gab string ;_ggag ,_bab :=_fg .ParseFloat (_ga .V ,64);if _bab !=nil {_gab =_ga .V ;}else {_gab =_da .Number (_ggag ,_bea );};_ecd .addCatName (_gab ,_gga ,&_fcg );};};};};};if _efe :=_bc .Val ;_efe !=nil {if _dbg :=_efe .NumDataSourceChoice ;_dbg !=nil {if _bfd :=_dbg .NumRef ;
_bfd !=nil {if _acc :=_bfd .F ;_acc !=""&&_faa !=nil {_fea ,_gf ,_gac ,_acca :=ParseExcelRange (_acc );if _acca ==nil {for _ ,_ecda :=range _faa .Sheets (){if _ecda .Name ()==_eff .Trim (_fea ,"\u0027"){_bgf :=_gf .String ();for _fcef :=_gf .RowIdx ;_fcef <=_gac .RowIdx ;
_fcef +=1{_cd :=_eff .ReplaceAll (_bgf ,_fd .Sprint (_gf .RowIdx ),_fd .Sprint (_fcef ));if _ecda .FormulaContext ().HasFormula (_cd ){_baa :=_fcf .NewEvaluator ();_fbg :=_ecda .FormulaContext ().Cell (_cd ,_baa );_fcfg :=_fbg .Value ();_ecd .addCatValue (_fcfg ,_gga ,_fcg ,(int )(_fcef -_gf .RowIdx ),&_adae ,&_eec ,_ff ,_bc .SpPr );
}else {_bgec :=_ecda .Cell (_cd ).GetString ();_ecd .addCatValue (_bgec ,_gga ,_fcg ,(int )(_fcef -_gf .RowIdx ),&_adae ,&_eec ,_ff ,_bc .SpPr );};};break ;};};};};if _bdd :=_bfd .NumCache ;_bdd !=nil {for _fca ,_def :=range _bdd .Pt {_ecd .addCatValue (_def .V ,_gga ,_fcg ,_fca ,&_adae ,&_eec ,_ff ,_bc .SpPr );
};};};};};_cb =append (_cb ,&legendItem {_ae :_ff ,_beef :_bc .SpPr });};var _bfc float64 ;var _gcb ,_dfa float64 ;if _eec ==0&&_adae ==0{_bfc =0.2;_dfa =0;_gcb =1;}else {var _feg float64 ;if _deff :=_ge .Abs (_adae );_eec < _deff {_feg =_deff ;}else {_feg =_eec ;
};_gefb :=_ge .Pow (10,_ge .Floor (_ge .Log10 (_feg )));_bbg :=_feg /_gefb ;if _bbg < 4.29{_bfc =0.5;}else if _bbg >=4.29&&_bbg < 8.58{_bfc =1;}else {_bfc =2;};_bfc *=_gefb ;if _eec <=0{_gcb =0;}else {_gcb =(_ge .Ceil (_eec /_bfc )+1)*_bfc ;};if _adae >=0{_dfa =0;
}else {_dfa =(_ge .Floor (_adae /_bfc )-1)*_bfc ;};};_dgcc :=_ecd .drawAxes (_bge ,_dfa ,_gcb ,_bfc ,_fcg ,_df ,_fce );if _dgcc !=nil {return nil ,_dgcc ;};_cec :=0.0;if _gdc .GapWidth !=nil {if _gdb :=_gdc .GapWidth .ValAttr ;_gdb !=nil {if _cac :=_gdb .ST_GapAmountUShort ;
_cac !=nil {_cec =float64 (*_cac )/100.0;};};};_bfda :=_df .Right -_df .Left ;_gabd :=_df .Bottom -_df .Top ;_bde :=float64 (len (_fcg ));if _fce {_fbd :=_gcb /(_gcb -_dfa )*_bfda ;_fgc :=-_dfa /(_gcb -_dfa )*_bfda ;_dcb :=_df .Left +_fgc ;_gbe :=_gabd /_bde ;
for _bbb ,_bgfg :=range _fcg {_bed :=_gga [_bgfg ];_gea :=float64 (len (_bed ._gead ))+_cec ;_ccd :=_gbe /_gea ;_fga :=_ccd *_cec ;_fba :=_df .Bottom -float64 (_bbb )*_gbe -_fga /2-_ccd ;for _ ,_cga :=range _bed ._gead {if _cga ._add ==0{continue ;};var _abef ,_adf float64 ;
if _cga ._add > 0{_adf =_cga ._add /_gcb *_fbd ;_ecd .drawRectangleWithProps (_cga ._babb ,_dcb ,_fba ,_adf ,_ccd ,false );}else {_adf =_cga ._add /_dfa *_fgc ;_abef =_dcb -_adf ;_ecd .drawRectangleWithProps (_cga ._babb ,_abef ,_fba ,_adf ,_ccd ,false );
};_fba -=_ccd ;};};}else {_bdg :=_gcb /(_gcb -_dfa )*_gabd ;_ecc :=-_dfa /(_gcb -_dfa )*_gabd ;_bgga :=_df .Top +_bdg ;_gebg :=_bfda /_bde ;for _gca ,_abeb :=range _fcg {_cag :=_gga [_abeb ];_cdd :=float64 (len (_cag ._gead ))+_cec ;_fdb :=_gebg /_cdd ;
_egb :=_fdb *_cec ;_fgaa :=_df .Left +float64 (_gca )*_gebg +_egb /2;for _ ,_ceb :=range _cag ._gead {var _fde ,_gfe float64 ;if _ceb ._add > 0{_gfe =_ceb ._add /_gcb *_bdg ;_fde =_bgga -_gfe ;_ecd .drawRectangleWithProps (_ceb ._babb ,_fgaa ,_fde ,_fdb ,_gfe ,false );
}else {_gfe =_ceb ._add /_dfa *_ecc ;_ecd .drawRectangleWithProps (_ceb ._babb ,_fgaa ,_bgga ,_fdb ,_gfe ,false );};_fgaa +=_fdb ;};};};return _cb ,nil ;};func (_bae *creatorContext )drawLineWithProps (_cdae *_eb .CT_ShapeProperties ,_abdf ,_dfeg ,_geaf ,_gfgd float64 ,_abfe bool ){if _cdae !=nil {if _gafb :=_cdae .Ln ;
_gafb !=nil {_gefa :=_bae .getPdfColorFromSolidFill (_gafb .LineFillPropertiesChoice .SolidFill );if _gefa ==nil &&_abfe {_gefa =_fae .ColorBlack ;};if _gefa !=nil {var _eaed float64 ;if _debg :=_gafb .WAttr ;_debg !=nil {_eaed =_dda .FromEMU (int64 (*_debg ));
}else {_eaed =_ffc ;};DrawLine (_bae ._aada ,_abdf ,_dfeg ,_geaf ,_gfgd ,_eaed ,_gefa );};};};};