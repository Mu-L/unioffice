//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_fb "bytes";_fd "errors";_gb "fmt";_a "github.com/unidoc/unichart";_ag "github.com/unidoc/unichart/dataset";_gfa "github.com/unidoc/unichart/render";_aa "github.com/unidoc/unioffice/common/logger";_cd "github.com/unidoc/unioffice/document";
_fbc "github.com/unidoc/unioffice/measurement";_ea "github.com/unidoc/unioffice/schema/soo/dml";_ge "github.com/unidoc/unioffice/schema/soo/dml/chart";_gc "github.com/unidoc/unioffice/spreadsheet";_ac "github.com/unidoc/unioffice/spreadsheet/format";_edgd "github.com/unidoc/unioffice/spreadsheet/formula";
_ff "github.com/unidoc/unioffice/spreadsheet/reference";_edg "github.com/unidoc/unipdf/v3/core";_ba "github.com/unidoc/unipdf/v3/creator";_c "github.com/unidoc/unipdf/v3/model";_db "github.com/unidoc/unipdf/v3/render";_ga "github.com/unidoc/unitype";_ed "image";
_f "image/color";_gf "math";_e "os";_bf "regexp";_g "sort";_de "strconv";_bb "strings";_dc "sync";_b "unicode";);func FromSTCoordinate (st _ea .ST_Coordinate )int64 {if _eegf :=st .ST_CoordinateUnqualified ;_eegf !=nil {return *_eegf ;};return 0;};func LoadFontFromFile (filename string )(*_c .PdfFont ,error ){if !_bb .HasSuffix (filename ,"\u002e\u0074\u0074\u0066"){_aa .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return nil ,_gb .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_ccd ,_gfbc :=_c .NewCompositePdfFontFromTTFFile (filename );if _gfbc !=nil {return nil ,_gfbc ;};return _ccd ,nil ;};var _fdfb =_aafg (0.125);func (_fedfg *creatorContext )drawRectangleWithProps (_cdebe *_ea .CT_ShapeProperties ,_fbbe ,_fggg ,_bbgbd ,_gbbe float64 ,_gfge bool ){_daae :=_fedfg ._bdfb .NewRectangle (_fbbe ,_fggg ,_bbgbd ,_gbbe );
if _cdebe ==nil {if _gfge {_daae .SetBorderWidth (_fdfb );}else {return ;};}else {_fae :=_fedfg .getPdfColorFromSolidFill (_cdebe .SolidFill );if _fae !=nil {_daae .SetFillColor (_fae );};if _cga :=_cdebe .Ln ;_cga !=nil {if _bged :=_cga .WAttr ;_bged !=nil {_cbf :=_fbc .FromEMU (int64 (*_bged ));
_daae .SetBorderWidth (_cbf );if _gcd :=_cga .SolidFill ;_gcd !=nil {_gecc :=_fedfg .getPdfColorFromSolidFill (_gcd );if _gecc !=nil {_daae .SetBorderColor (_gecc );};};}else {_daae .SetBorderWidth (0);};};};_fedfg ._bdfb .Draw (_daae );};func GetRegisteredFont (name string ,style FontStyle )*_c .PdfFont {_bgec ._bba .Lock ();
defer _bgec ._bba .Unlock ();if _eefg ,_fcfac :=_bgec ._bcfc [name ];_fcfac {if _gdaa ,_cff :=_eefg [style ];_cff {return _gdaa ;};};return nil ;};var _eae =_aafg (1);func MakeBlockFromChartSpace (cs *_ge .ChartSpace ,width ,height float64 ,theme *_ea .Theme )(*_ba .Block ,error ){_adcf ,_ffbb :=_efef (cs ,width ,height ,theme ,false ,nil );
if _ffbb !=nil {return nil ,_ffbb ;};_abde ,_ffbb :=GetPageFromCreator (_adcf );if _ffbb !=nil {return nil ,_ffbb ;};_ebg ,_ffbb :=_ba .NewBlockFromPage (_abde );if _ffbb !=nil {return nil ,_ffbb ;};return _ebg ,nil ;};func (_ffg *creatorContext )addCatName (_gagf string ,_gde map[string ]serCategory ,_gbae *[]string ){if _ ,_fffg :=_gde [_gagf ];
!_fffg {_gde [_gagf ]=serCategory {_ggd :_gagf ,_cbb :[]serValue {}};*_gbae =append (*_gbae ,_gagf );};};func _gbgf (_baab *_ge .CT_ValAx )(uint32 ,_ge .ST_AxPos ,_ge .ST_TickMark ,_ge .ST_TickLblPos ,*_ge .CT_ChartLines ,uint32 ,*_ea .CT_ShapeProperties ,error ){var _fda ,_ddbg uint32 ;
var _bbef _ge .ST_AxPos ;var _cgd _ge .ST_TickMark ;var _bfdd *_ge .CT_ChartLines ;var _edgc _ge .ST_TickLblPos ;if _baab .AxId ==nil {return _fda ,_bbef ,_cgd ,_edgc ,_bfdd ,_ddbg ,_baab .SpPr ,_fd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_fda =_baab .AxId .ValAttr ;};if _baab .AxPos ==nil {return _fda ,_bbef ,_cgd ,_edgc ,_bfdd ,_ddbg ,_baab .SpPr ,_fd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_bbef =_baab .AxPos .ValAttr ;
};if _baab .MajorTickMark !=nil {_cgd =_baab .MajorTickMark .ValAttr ;};if _baab .TickLblPos !=nil {_edgc =_baab .TickLblPos .ValAttr ;};if _baab .CrossAx ==nil {return _fda ,_bbef ,_cgd ,_edgc ,_bfdd ,_ddbg ,_baab .SpPr ,_fd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_ddbg =_baab .CrossAx .ValAttr ;};_bfdd =_baab .MajorGridlines ;return _fda ,_bbef ,_cgd ,_edgc ,_bfdd ,_ddbg ,_baab .SpPr ,nil ;};func (_fefgg *creatorContext )drawPieChart (_gfef *_ge .CT_PieChart ,_afd *Rectangle ,_cbad *_gc .Workbook ,_aeb float64 )([]*legendItem ,error ){_efff :=[]*legendItem {};
_gffe :=map[string ]serCategory {};_gfbf :=[]string {};_fgf :=_gf .Inf (1);_ebcc :=_gf .Inf (-1);_baba :=_gfef .Ser ;for _ ,_dfc :=range _baba {var _gbeb string ;if _babf :=_dfc .Tx ;_babf !=nil {if _fcce :=_babf .Choice ;_fcce !=nil {if _fcce .V !=nil {_gbeb =*_fcce .V ;
}else if _efcb :=_fcce .StrRef ;_efcb !=nil {if _eadc :=_efcb .StrCache ;_eadc !=nil {for _ ,_afbfd :=range _eadc .Pt {_gbeb =_afbfd .V ;};};};};};if _ccbb :=_dfc .Cat ;_ccbb !=nil {if _acbe :=_ccbb .Choice ;_acbe !=nil {if _agfg :=_acbe .StrRef ;_agfg !=nil {if _ebcd :=_agfg .F ;
_ebcd !=""&&_cbad !=nil {_bbefg ,_agef ,_aeac ,_dcg :=ParseExcelRange (_ebcd );if _dcg ==nil {for _ ,_ggf :=range _cbad .Sheets (){if _ggf .Name ()==_bb .Trim (_bbefg ,"\u0027"){_eage :=_agef .String ();for _babc :=_agef .RowIdx ;_babc <=_aeac .RowIdx ;
_babc +=1{_bbbb :=_bb .ReplaceAll (_eage ,_gb .Sprint (_agef .RowIdx ),_gb .Sprint (_babc ));_fefgg .addCatName (_ggf .Cell (_bbbb ).GetString (),_gffe ,&_gfbf );};break ;};};};};if _baad :=_agfg .StrCache ;_baad !=nil {for _ ,_ebec :=range _baad .Pt {_fefgg .addCatName (_ebec .V ,_gffe ,&_gfbf );
};};}else if _bbfa :=_acbe .NumRef ;_bbfa !=nil {if _eege :=_bbfa .NumCache ;_eege !=nil {var _affc string ;if _eege .FormatCode !=nil {_affc =*_eege .FormatCode ;};for _ ,_eebd :=range _eege .Pt {var _bfde string ;if _eebd .FormatCodeAttr ==nil {_bfde =_affc ;
}else {_bfde =*_eebd .FormatCodeAttr ;};var _fcbg string ;_dcfd ,_faa :=_de .ParseFloat (_eebd .V ,64);if _faa !=nil {_fcbg =_eebd .V ;}else {_fcbg =_ac .Number (_dcfd ,_bfde );};_fefgg .addCatName (_fcbg ,_gffe ,&_gfbf );};};};};};if _aacba :=_dfc .Val ;
_aacba !=nil {if _dadf :=_aacba .Choice ;_dadf !=nil {if _fdbf :=_dadf .NumRef ;_fdbf !=nil {if _ege :=_fdbf .F ;_ege !=""&&_cbad !=nil {_fcdd ,_fea ,_dcea ,_eceg :=ParseExcelRange (_ege );if _eceg ==nil {for _ ,_cbcb :=range _cbad .Sheets (){if _cbcb .Name ()==_bb .Trim (_fcdd ,"\u0027"){_faaf :=_fea .String ();
for _caab :=_fea .RowIdx ;_caab <=_dcea .RowIdx ;_caab +=1{_gaafe :=_bb .ReplaceAll (_faaf ,_gb .Sprint (_fea .RowIdx ),_gb .Sprint (_caab ));if _cbcb .FormulaContext ().HasFormula (_gaafe ){_fbab :=_edgd .NewEvaluator ();_bga :=_cbcb .FormulaContext ().Cell (_gaafe ,_fbab );
_aaegf :=_bga .Value ();_fefgg .addCatValue (_aaegf ,_gffe ,_gfbf ,(int )(_caab -_fea .RowIdx ),&_fgf ,&_ebcc ,_gbeb ,_dfc .SpPr );}else {_degc :=_cbcb .Cell (_gaafe ).GetString ();_fefgg .addCatValue (_degc ,_gffe ,_gfbf ,(int )(_caab -_fea .RowIdx ),&_fgf ,&_ebcc ,_gbeb ,_dfc .SpPr );
};};break ;};};};};if _cdfbf :=_fdbf .NumCache ;_cdfbf !=nil {for _bbd ,_fddg :=range _cdfbf .Pt {_fefgg .addCatValue (_fddg .V ,_gffe ,_gfbf ,_bbd ,&_fgf ,&_ebcc ,_gbeb ,_dfc .SpPr );};};};};};};_begb :=&_a .PieChart {Values :[]_ag .Value {}};for _ ,_bacd :=range _gfbf {_acgc :=_gffe [_bacd ];
if len (_acgc ._cbb )> 0{_begb .Values =append (_begb .Values ,_ag .Value {Value :_acgc ._cbb [0]._dbg ,Label :_bacd ,Style :_gfa .Style {FontSize :12*_aeb }});};};_begb .SetHeight (int (_afd .Top -_afd .Bottom ));_begb .SetWidth (int (_afd .Right -_afd .Left ));
_fdcc :=_fefgg ._bdfb ;_ggb :=_ba .NewChart (_begb );_ggb .SetPos (_afd .Left ,_afd .Top );_babe :=_fdcc .Draw (_ggb );if _babe !=nil {return nil ,_babe ;};return _efff ,nil ;};func AdjustColorByTint (colorStr string ,tint float64 )string {var _egcfb ,_fefg ,_bece uint8 ;
_agbe ,_ :=_gb .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_egcfb ,&_fefg ,&_bece );if _agbe !=3{return "";};return _edd (_egcfb ,tint )+_edd (_fefg ,tint )+_edd (_bece ,tint );};func _afga (_adgc *_ge .CT_DateAx )(uint32 ,_ge .ST_AxPos ,_ge .ST_TickMark ,_ge .ST_TickLblPos ,*_ge .CT_ChartLines ,uint32 ,*_ea .CT_ShapeProperties ,error ){var _ccbc ,_effa uint32 ;
var _afcc _ge .ST_AxPos ;var _bcg _ge .ST_TickMark ;var _dfed *_ge .CT_ChartLines ;var _cbbg _ge .ST_TickLblPos ;if _adgc .AxId ==nil {return _ccbc ,_afcc ,_bcg ,_cbbg ,_dfed ,_effa ,_adgc .SpPr ,_fd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_ccbc =_adgc .AxId .ValAttr ;};if _adgc .AxPos ==nil {return _ccbc ,_afcc ,_bcg ,_cbbg ,_dfed ,_effa ,_adgc .SpPr ,_fd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_afcc =_adgc .AxPos .ValAttr ;
};if _adgc .MajorTickMark !=nil {_bcg =_adgc .MajorTickMark .ValAttr ;};if _adgc .TickLblPos !=nil {_cbbg =_adgc .TickLblPos .ValAttr ;};if _adgc .CrossAx ==nil {return _ccbc ,_afcc ,_bcg ,_cbbg ,_dfed ,_effa ,_adgc .SpPr ,_fd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_effa =_adgc .CrossAx .ValAttr ;};_dfed =_adgc .MajorGridlines ;return _ccbc ,_afcc ,_bcg ,_cbbg ,_dfed ,_effa ,_adgc .SpPr ,nil ;};func RegisterFontsFromFiles (files []string )error {for _ ,_bfeg :=range files {if _bb .HasSuffix (_bfeg ,"\u002e\u0074\u0074\u0066"){_cdafee :=_egaf (_bfeg );
if _cdafee !=nil {_aa .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_cdafee );
continue ;};};};return nil ;};func FromSTCoordinate32 (st _ea .ST_Coordinate32 )int64 {if _bdfe :=st .ST_Coordinate32Unqualified ;_bdfe !=nil {return int64 (*_bdfe );};return 0;};func _bgb (_bbbe *_ge .CT_SerAx )(uint32 ,_ge .ST_AxPos ,_ge .ST_TickMark ,_ge .ST_TickLblPos ,*_ge .CT_ChartLines ,uint32 ,*_ea .CT_ShapeProperties ,error ){var _ccg ,_ace uint32 ;
var _fbgb _ge .ST_AxPos ;var _bgdd _ge .ST_TickMark ;var _bbge *_ge .CT_ChartLines ;var _gbe _ge .ST_TickLblPos ;if _bbbe .AxId ==nil {return _ccg ,_fbgb ,_bgdd ,_gbe ,_bbge ,_ace ,_bbbe .SpPr ,_fd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_ccg =_bbbe .AxId .ValAttr ;};if _bbbe .AxPos ==nil {return _ccg ,_fbgb ,_bgdd ,_gbe ,_bbge ,_ace ,_bbbe .SpPr ,_fd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_fbgb =_bbbe .AxPos .ValAttr ;
};if _bbbe .MajorTickMark !=nil {_bgdd =_bbbe .MajorTickMark .ValAttr ;};if _bbbe .TickLblPos !=nil {_gbe =_bbbe .TickLblPos .ValAttr ;};if _bbbe .CrossAx ==nil {return _ccg ,_fbgb ,_bgdd ,_gbe ,_bbge ,_ace ,_bbbe .SpPr ,_fd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_ace =_bbbe .CrossAx .ValAttr ;};_bbge =_bbbe .MajorGridlines ;return _ccg ,_fbgb ,_bgdd ,_gbe ,_bbge ,_ace ,_bbbe .SpPr ,nil ;};func MakeImageFromChartSpace (cs *_ge .ChartSpace ,width ,height float64 ,theme *_ea .Theme ,workbook *_gc .Workbook )(_ed .Image ,error ){_geec ,_gaa :=_efef (cs ,width ,height ,theme ,true ,workbook );
if _gaa !=nil {return nil ,_gaa ;};_dac ,_gaa :=GetPageFromCreator (_geec );if _gaa !=nil {return nil ,_gaa ;};return _db .NewImageDevice ().Render (_dac );};func GetGroupOffsetFromXfrm (xfrm *_ea .CT_GroupTransform2D )(float64 ,float64 ){var _bfff ,_cfbg float64 ;
if xfrm .Off !=nil &&xfrm .ChOff !=nil {_bfff =_fbc .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_fbc .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));_cfbg =_fbc .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_fbc .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));
};return _bfff ,_cfbg ;};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);const _bda =6.0;var (DefaultFontSize =12.0;
DefaultImageEncoder _edg .StreamEncoder ;);func _gac (_ddca string )([]byte ,error ){_bdef :=_bf .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");_ddca =_bdef .ReplaceAllString (_ddca ,"");_ebbg :=[]rune (_ddca );
_deff :=[]byte {};for _agde :=len (_ebbg )-2;_agde >=0;_agde -=2{_dbbg ,_gbcd :=_de .ParseUint (string (_ebbg [_agde ])+string (_ebbg [_agde +1]),16,8);if _gbcd !=nil {return nil ,_gbcd ;};_deff =append (_deff ,byte (_dbbg ));};return _deff ,nil ;};type ImgPart byte ;
func MakeTempCreator (width ,height float64 )*_ba .Creator {_bfg :=_ba .New ();_bfg .SetPageSize (_ba .PageSize {width ,height });_bfg .SetPageMargins (0,0,0,0);return _bfg ;};type BorderPosition byte ;func _gaea (_bfec _ea .ST_SchemeColorVal ,_dacg *_ea .Theme )string {if _defg :=_dacg .ThemeElements ;
_defg !=nil {if _adeb :=_defg .ClrScheme ;_adeb !=nil {switch _bfec {case _ea .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_adeb .Lt1 );case _ea .ST_SchemeColorValDk1 ,_ea .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_adeb .Dk1 );
case _ea .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_adeb .Lt2 );case _ea .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_adeb .Dk2 );case _ea .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_adeb .Accent1 );case _ea .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_adeb .Accent2 );
case _ea .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_adeb .Accent3 );case _ea .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_adeb .Accent4 );case _ea .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_adeb .Accent5 );
case _ea .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_adeb .Accent6 );};};};return "";};func (_degb *Rectangle )Translate (x ,y float64 ){_degb .Left +=x ;_degb .Right +=x ;_degb .Top +=y ;_degb .Bottom +=y ;};func (_cbaa barSerByOrder )Swap (i ,j int ){_cbaa [i ],_cbaa [j ]=_cbaa [j ],_cbaa [i ]};
func FillRectangle (c *_ba .Creator ,x ,y ,width ,height float64 ,color _ba .Color ){if color ==nil {return ;};_adf :=c .NewRectangle (x ,y ,width ,height );_adf .SetFillColor (color );_adf .SetBorderWidth (0);c .Draw (_adf );};func RegisterEmbeddedFonts (d *_cd .Document )error {_dbgc :=d .FontTable ();
if _dbgc ==nil {return nil ;};for _ ,_gca :=range _dbgc .Font {if _gca .EmbedRegular !=nil {return _adbc (d ,_gca .NameAttr ,_gca .EmbedRegular .IdAttr ,_gca .EmbedRegular .FontKeyAttr );};if _gca .EmbedBold !=nil {return _adbc (d ,_gca .NameAttr ,_gca .EmbedBold .IdAttr ,_gca .EmbedBold .FontKeyAttr );
};if _gca .EmbedItalic !=nil {return _adbc (d ,_gca .NameAttr ,_gca .EmbedItalic .IdAttr ,_gca .EmbedItalic .FontKeyAttr );};if _gca .EmbedBoldItalic !=nil {return _adbc (d ,_gca .NameAttr ,_gca .EmbedBoldItalic .IdAttr ,_gca .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};type FontStyle byte ;func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func ClearRegisteredFonts (){_bgec ._bba .Lock ();_bgec ._bcfc =map[string ]map[FontStyle ]*_c .PdfFont {};_bgec ._bba .Unlock ();};func _dca (_gbad float64 )float64 {if _gbad < 0{_gbad +=float64 (-int (_gbad )+1);
}else if _gbad > 1{_gbad -=float64 (int (_gbad ));};return _gbad ;};func RegisterFontsFromDirectory (dirName string )error {_bedc ,_aee :=_e .Open (dirName );if _aee !=nil {return _aee ;};defer _bedc .Close ();_cdfb ,_aee :=_bedc .Readdirnames (0);if _aee !=nil {return _aee ;
};for _ ,_efba :=range _cdfb {if _bb .HasSuffix (_efba ,"\u002e\u0074\u0074\u0066"){_bbf :=dirName +"\u002f"+_efba ;_efbaf :=_egaf (_bbf );if _efbaf !=nil {_aa .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_efbaf );
continue ;};};};return nil ;};func (_fde *creatorContext )drawAreaChart (_gbc *_ge .CT_AreaChart ,_fdb *Rectangle ,_dea *_ge .CT_PlotAreaChoice1 ,_cb float64 )([]*legendItem ,error ){_ffb :=[]*legendItem {};_ce :=_gbc .Ser ;_cg :=make (map[int ][]float64 );
_gag :=make (map[int ][]float64 );_gd :=make (map[int ]_ba .Color );for _fa ,_gbcg :=range _ce {_gd [_fa ]=_ba .ColorWhite ;if _af :=_gbcg .SpPr ;_af !=nil {_ede :=_fde .getPdfColorFromSolidFill (_af .SolidFill );if _ede !=nil {_gd [_fa ]=_ede ;};};if _da :=_gbcg .Val ;
_da !=nil {if _afe :=_da .Choice ;_afe !=nil {if _eg :=_afe .NumRef ;_eg !=nil {if _cda :=_eg .NumCache ;_cda !=nil {for _ ,_ad :=range _cda .Pt {_cg [_fa ]=append (_cg [_fa ],float64 (_ad .IdxAttr ));_bd ,_ :=_de .ParseFloat (_bb .TrimSpace (_ad .V ),64);
_gag [_fa ]=append (_gag [_fa ],_bd );};};};};};};_dd :=true ;_ead :="";_ab :="";if len (_dea .ValAx )> 1{if _dea .ValAx [0].Delete !=nil &&_dea .ValAx [1].Delete !=nil {if !*(*_dea .ValAx [0].Delete ).ValAttr &&!*(*_dea .ValAx [1].Delete ).ValAttr {_dd =false ;
};};_ead =_fde .getTitle (_dea .ValAx [0].Title );_ab =_fde .getTitle (_dea .ValAx [1].Title );};_dag :=_gfa .Style {Hidden :_dd ,FontSize :8*_cb };_acd :=&_a .Chart {Series :[]_ag .Series {},YAxisSecondary :_a .YAxis {Style :_dag ,Name :_ab ,NameStyle :_dag },XAxis :_a .XAxis {Style :_dag ,Name :_ead ,NameStyle :_dag },YAxis :_a .YAxis {Style :_gfa .Style {Hidden :true }}};
for _fba :=0;_fba < len (_gd );_fba ++{_fac ,_dbd ,_dde :=_gd [_fba ].ToRGB ();_ceb :=_ag .ContinuousSeries {XValues :_cg [_fba ],YValues :_gag [_fba ],Style :_gfa .Style {StrokeWidth :1,FillColor :_f .RGBA {uint8 (_fac *255),uint8 (_dbd *255),uint8 (_dde *255),255}}};
_acd .Series =append (_acd .Series ,_ceb );};_acd .SetHeight (int (_gf .Abs (_fdb .Top -_fdb .Bottom )));_acd .SetWidth (int (_gf .Abs (_fdb .Right -_fdb .Left )));_cf :=_fde ._bdfb ;_gbb :=_ba .NewChart (_acd );_gbb .SetPos (_fdb .Left ,_fdb .Top );_cba :=_cf .Draw (_gbb );
if _cba !=nil {return nil ,_cba ;};return _ffb ,nil ;};type barSerByOrder []*_ge .CT_BarSer ;type serCategory struct{_ggd string ;_cbb []serValue ;};var _fcgf =_aafg (2);func (_begg FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_begg )];
};var _bfaf =_aafg (1.5);type fontsMap struct{_bba *_dc .Mutex ;_bcfc map[string ]map[FontStyle ]*_c .PdfFont ;};func _cgbf (_cdag uint8 ,_dgce float64 )string {_bdbd :=float64 (_cdag );return _gb .Sprintf ("\u0025\u0030\u0032\u0078",int (_bdbd *_dgce ));
};func (_gbba *creatorContext )drawTitle (_add string ,_bbg ,_baga float64 ){_dedg :=_gbba ._bagg ;_ddf :=_gbba ._bdfb .NewStyledParagraph ();_gff :=_ddf .SetText (_add );_ged ,_bbe :=_c .NewStandard14Font (_c .HelveticaName );if _bbe ==nil {_accd :=_gbba ._bdfb .NewTextStyle ();
_accd .Font =_ged ;_accd .FontSize =14;_accd .TextRise =0.4;_gff .Style =_accd ;_ddf .SetPos (_bbg -_ddf .Width ()*_dedg /2,_baga );_gbba ._bdfb .Draw (_ddf );};};var _eff =_aafg (7.5);func (_ecf barSerByOrder )Less (i ,j int )bool {return _ecf [i ].Order .ValAttr < _ecf [j ].Order .ValAttr };
const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func RegisterFont (name string ,style FontStyle ,font *_c .PdfFont ){_bgec ._bba .Lock ();if _bgec ._bcfc [name ]==nil {_bgec ._bcfc [name ]=map[FontStyle ]*_c .PdfFont {};
};_bgec ._bcfc [name ][style ]=font ;_bgec ._bba .Unlock ();};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_fbc .Twips *10+0.5))/10;};var RtlFontFile *_c .PdfFont ;func (_aaa *creatorContext )drawScatterChart (_edgf *_ge .CT_ScatterChart ,_fgfd *Rectangle ,_eba *_ge .CT_PlotAreaChoice1 ,_affe float64 )([]*legendItem ,error ){_edf :=[]*legendItem {};
_aedb :=_edgf .Ser ;_adbcd :=make (map[string ]float64 );_edgg :=make (map[string ][]float64 );_gfcf :=make (map[string ][]float64 );_ggbb :=[]string {};for _ ,_dgf :=range _aedb {var _fdeg string ;if _cdab :=_dgf .Tx ;_cdab !=nil {if _ageba :=_cdab .Choice ;
_ageba !=nil {if _ageba .V !=nil {_fdeg =*_ageba .V ;}else if _cdc :=_ageba .StrRef ;_cdc !=nil {if _defa :=_cdc .StrCache ;_defa !=nil {for _ ,_ggde :=range _defa .Pt {_fdeg =_ggde .V ;};};};_ggbb =append (_ggbb ,_fdeg );};};if _dgf .Marker !=nil &&_dgf .Marker .Size !=nil {_adbcd [_fdeg ]=float64 (*_dgf .Marker .Size .ValAttr );
}else {_adbcd [_fdeg ]=-1.0;};if _efgf :=_dgf .XVal ;_efgf !=nil {if _fagfe :=_efgf .Choice ;_fagfe !=nil {if _ecea :=_fagfe .NumRef ;_ecea !=nil {if _cgcc :=_ecea .NumCache ;_cgcc !=nil {for _ ,_faggd :=range _cgcc .Pt {_aade ,_ :=_de .ParseFloat (_bb .TrimSpace (_faggd .V ),64);
_edgg [_fdeg ]=append (_edgg [_fdeg ],_aade );};};};};};if _baaea :=_dgf .YVal ;_baaea !=nil {if _cfdg :=_baaea .Choice ;_cfdg !=nil {if _gagbd :=_cfdg .NumRef ;_gagbd !=nil {if _bcfa :=_gagbd .NumCache ;_bcfa !=nil {for _ ,_bca :=range _bcfa .Pt {_cfaf ,_ :=_de .ParseFloat (_bb .TrimSpace (_bca .V ),64);
_gfcf [_fdeg ]=append (_gfcf [_fdeg ],_cfaf );};};};};};};_dggb :=true ;_dggbd :="";_addgb :="";if len (_eba .ValAx )> 1{if _eba .ValAx [0].Delete !=nil &&_eba .ValAx [1].Delete !=nil {if !*(*_eba .ValAx [0].Delete ).ValAttr &&!*(*_eba .ValAx [1].Delete ).ValAttr {_dggb =false ;
};};_dggbd =_aaa .getTitle (_eba .ValAx [0].Title );_addgb =_aaa .getTitle (_eba .ValAx [1].Title );};_gdd :=_gfa .Style {Hidden :_dggb ,FontSize :8*_affe };_ddbc :=&_a .Chart {Series :[]_ag .Series {},YAxisSecondary :_a .YAxis {Style :_gdd ,Name :_addgb ,NameStyle :_gdd },XAxis :_a .XAxis {Style :_gdd ,Name :_dggbd ,NameStyle :_gdd },YAxis :_a .YAxis {Style :_gfa .Style {Hidden :true }}};
for _ ,_ecba :=range _ggbb {_fggf :=_ag .ContinuousSeries {XValues :_edgg [_ecba ],YValues :_gfcf [_ecba ],Style :_gfa .Style {StrokeWidth :-1,DotWidth :_adbcd [_ecba ]}};_ddbc .Series =append (_ddbc .Series ,_fggf );};_ddbc .SetHeight (int (_gf .Abs (_fgfd .Top -_fgfd .Bottom )));
_ddbc .SetWidth (int (_gf .Abs (_fgfd .Right -_fgfd .Left )));_faaa :=_aaa ._bdfb ;_gddf :=_ba .NewChart (_ddbc );_gddf .SetPos (_fgfd .Left ,_fgfd .Top );_bcfd :=_faaa .Draw (_gddf );if _bcfd !=nil {return nil ,_bcfd ;};return _edf ,nil ;};func IsNoSpaceLanguage (symbol string )bool {for _ ,_aacb :=range symbol {if _b .Is (_b .Han ,_aacb ){return true ;
};};return false ;};type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};func (_gagb *creatorContext )addCatValue (_fbce string ,_bde map[string ]serCategory ,_ddbe []string ,_ced int ,_fab ,_aedf *float64 ,_cbdd string ,_cgbb *_ea .CT_ShapeProperties ){_ded ,_eed :=_de .ParseFloat (_fbce ,64);
if _eed !=nil {_ded =0;_aa .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_eed );};if _ded > *_aedf {*_aedf =_ded ;};if _ded < *_fab {*_fab =_ded ;};_cdb :=_bde [_ddbe [_ced ]];_cdb ._cbb =append (_cdb ._cbb ,serValue {_dbe :_cbdd ,_dbg :_ded ,_bac :_cgbb });
_bde [_ddbe [_ced ]]=_cdb ;};func (_dbbf *creatorContext )drawBorderWithProps (_bfddd *_ea .CT_ShapeProperties ,_dbcg *Rectangle ,_bef float64 ){if _dbcg !=nil &&_bfddd !=nil &&_bfddd .Ln !=nil &&_bfddd .Ln .SolidFill !=nil {_ddfb :=_dbbf .getPdfColorFromSolidFill (_bfddd .Ln .SolidFill );
DrawRectangle (_dbbf ._bdfb ,_dbcg ,_bef ,_ddfb );};};func (_aad *creatorContext )drawBarChart (_ffc *_ge .CT_BarChart ,_agg *Rectangle ,_ec *_ge .CT_PlotAreaChoice1 ,_fg *_gc .Workbook )([]*legendItem ,error ){var _eded bool ;if _be :=_ffc .BarDir ;_be !=nil {_eded =_be .ValAttr ==_ge .ST_BarDirBar ;
};_cbc :=_ffc .Ser ;_g .Sort (barSerByOrder (_cbc ));_fgb :=map[string ]serCategory {};_gfc :=[]string {};_adc :=[]*legendItem {};_fc :=_gf .Inf (1);_cfc :=_gf .Inf (-1);for _ ,_cee :=range _cbc {var _gbbg string ;if _ef :=_cee .Tx ;_ef !=nil {if _bbc :=_ef .Choice ;
_bbc !=nil {if _bbc .V !=nil {_gbbg =*_bbc .V ;}else if _fcc :=_bbc .StrRef ;_fcc !=nil {if _fgg :=_fcc .StrCache ;_fgg !=nil {for _ ,_cfa :=range _fgg .Pt {_gbbg =_cfa .V ;};};};};};if _fgbg :=_cee .Cat ;_fgbg !=nil {if _cfd :=_fgbg .Choice ;_cfd !=nil {if _cfg :=_cfd .StrRef ;
_cfg !=nil {if _ddb :=_cfg .F ;_ddb !=""&&_fg !=nil {_dcd ,_gef ,_cbd ,_dab :=ParseExcelRange (_ddb );if _dab ==nil {for _ ,_eada :=range _fg .Sheets (){if _eada .Name ()==_bb .Trim (_dcd ,"\u0027"){_abc :=_gef .String ();for _ee :=_gef .RowIdx ;_ee <=_cbd .RowIdx ;
_ee +=1{_beg :=_bb .ReplaceAll (_abc ,_gb .Sprint (_gef .RowIdx ),_gb .Sprint (_ee ));_aad .addCatName (_eada .Cell (_beg ).GetString (),_fgb ,&_gfc );};break ;};};};};if _efc :=_cfg .StrCache ;_efc !=nil {for _ ,_afed :=range _efc .Pt {_aad .addCatName (_afed .V ,_fgb ,&_gfc );
};};}else if _gcf :=_cfd .NumRef ;_gcf !=nil {if _gce :=_gcf .NumCache ;_gce !=nil {var _deaa string ;if _gce .FormatCode !=nil {_deaa =*_gce .FormatCode ;};for _ ,_gcea :=range _gce .Pt {var _aba string ;if _gcea .FormatCodeAttr ==nil {_aba =_deaa ;}else {_aba =*_gcea .FormatCodeAttr ;
};var _baa string ;_ca ,_acda :=_de .ParseFloat (_gcea .V ,64);if _acda !=nil {_baa =_gcea .V ;}else {_baa =_ac .Number (_ca ,_aba );};_aad .addCatName (_baa ,_fgb ,&_gfc );};};};};};if _gec :=_cee .Val ;_gec !=nil {if _agf :=_gec .Choice ;_agf !=nil {if _bfa :=_agf .NumRef ;
_bfa !=nil {if _feb :=_bfa .F ;_feb !=""&&_fg !=nil {_bec ,_cgg ,_cab ,_afg :=ParseExcelRange (_feb );if _afg ==nil {for _ ,_cgb :=range _fg .Sheets (){if _cgb .Name ()==_bb .Trim (_bec ,"\u0027"){_fcg :=_cgg .String ();for _cfda :=_cgg .RowIdx ;_cfda <=_cab .RowIdx ;
_cfda +=1{_dcc :=_bb .ReplaceAll (_fcg ,_gb .Sprint (_cgg .RowIdx ),_gb .Sprint (_cfda ));if _cgb .FormulaContext ().HasFormula (_dcc ){_fag :=_edgd .NewEvaluator ();_egac :=_cgb .FormulaContext ().Cell (_dcc ,_fag );_eb :=_egac .Value ();_aad .addCatValue (_eb ,_fgb ,_gfc ,(int )(_cfda -_cgg .RowIdx ),&_fc ,&_cfc ,_gbbg ,_cee .SpPr );
}else {_ade :=_cgb .Cell (_dcc ).GetString ();_aad .addCatValue (_ade ,_fgb ,_gfc ,(int )(_cfda -_cgg .RowIdx ),&_fc ,&_cfc ,_gbbg ,_cee .SpPr );};};break ;};};};};if _cef :=_bfa .NumCache ;_cef !=nil {for _age ,_edb :=range _cef .Pt {_aad .addCatValue (_edb .V ,_fgb ,_gfc ,_age ,&_fc ,&_cfc ,_gbbg ,_cee .SpPr );
};};};};};_adc =append (_adc ,&legendItem {_fdf :_gbbg ,_bbb :_cee .SpPr });};var _ddd float64 ;var _dcb ,_ecd float64 ;if _cfc ==0&&_fc ==0{_ddd =0.2;_ecd =0;_dcb =1;}else {var _afc float64 ;if _ecb :=_gf .Abs (_fc );_cfc < _ecb {_afc =_ecb ;}else {_afc =_cfc ;
};_fagb :=_gf .Pow (10,_gf .Floor (_gf .Log10 (_afc )));_eadb :=_afc /_fagb ;if _eadb < 4.29{_ddd =0.5;}else if _eadb >=4.29&&_eadb < 8.58{_ddd =1;}else {_ddd =2;};_ddd *=_fagb ;if _cfc <=0{_dcb =0;}else {_dcb =(_gf .Ceil (_cfc /_ddd )+1)*_ddd ;};if _fc >=0{_ecd =0;
}else {_ecd =(_gf .Floor (_fc /_ddd )-1)*_ddd ;};};_fff :=_aad .drawAxes (_ec ,_ecd ,_dcb ,_ddd ,_gfc ,_agg ,_eded );if _fff !=nil {return nil ,_fff ;};_caa :=0.0;if _ffc .GapWidth !=nil {if _fef :=_ffc .GapWidth .ValAttr ;_fef !=nil {if _abaf :=_fef .ST_GapAmountUShort ;
_abaf !=nil {_caa =float64 (*_abaf )/100.0;};};};_dg :=_agg .Right -_agg .Left ;_bea :=_agg .Bottom -_agg .Top ;_gg :=float64 (len (_gfc ));if _eded {_efe :=_dcb /(_dcb -_ecd )*_dg ;_dcf :=-_ecd /(_dcb -_ecd )*_dg ;_efb :=_agg .Left +_dcf ;_fad :=_bea /_gg ;
for _fagd ,_bc :=range _gfc {_egc :=_fgb [_bc ];_bfd :=float64 (len (_egc ._cbb ))+_caa ;_beb :=_fad /_bfd ;_baaa :=_beb *_caa ;_gba :=_agg .Bottom -float64 (_fagd )*_fad -_baaa /2-_beb ;for _ ,_aae :=range _egc ._cbb {if _aae ._dbg ==0{continue ;};var _cdf ,_ceg float64 ;
if _aae ._dbg > 0{_ceg =_aae ._dbg /_dcb *_efe ;_aad .drawRectangleWithProps (_aae ._bac ,_efb ,_gba ,_ceg ,_beb ,false );}else {_ceg =_aae ._dbg /_ecd *_dcf ;_cdf =_efb -_ceg ;_aad .drawRectangleWithProps (_aae ._bac ,_cdf ,_gba ,_ceg ,_beb ,false );};
_gba -=_beb ;};};}else {_cae :=_dcb /(_dcb -_ecd )*_bea ;_gee :=-_ecd /(_dcb -_ecd )*_bea ;_deb :=_agg .Top +_cae ;_gfca :=_dg /_gg ;for _edba ,_aed :=range _gfc {_aaeg :=_fgb [_aed ];_gfb :=float64 (len (_aaeg ._cbb ))+_caa ;_gga :=_gfca /_gfb ;_abd :=_gga *_caa ;
_egcb :=_agg .Left +float64 (_edba )*_gfca +_abd /2;for _ ,_egcf :=range _aaeg ._cbb {var _bdc ,_dge float64 ;if _egcf ._dbg > 0{_dge =_egcf ._dbg /_dcb *_cae ;_bdc =_deb -_dge ;_aad .drawRectangleWithProps (_egcf ._bac ,_egcb ,_bdc ,_gga ,_dge ,false );
}else {_dge =_egcf ._dbg /_ecd *_gee ;_aad .drawRectangleWithProps (_egcf ._bac ,_egcb ,_deb ,_gga ,_dge ,false );};_egcb +=_gga ;};};};return _adc ,nil ;};func _adbc (_deg *_cd .Document ,_bbgb ,_fedf ,_dfgf string )error {_gbga ,_adga :=_deg .GetFontBytesByRelId (_fedf );
if _adga !=nil {return _adga ;};_baag ,_adga :=_gac (_dfgf );if _adga !=nil {return _adga ;};for _ecg :=0;_ecg < 32;_ecg ++{_aga :=_ecg %len (_baag );_gbga [_ecg ]=_gbga [_ecg ]^_baag [_aga ];};_acfe :=_deg .TmpPath +"\u002f"+_bbgb +"\u002e\u0074\u0074\u0066";
_adga =_e .WriteFile (_acfe ,_gbga ,0644);if _adga !=nil {return _adga ;};_egaf (_acfe );return nil ;};func (_eca barSerByOrder )Len ()int {return len (_eca )};func _eab (_fceb ,_agea ,_ceda uint8 )(float64 ,float64 ,float64 ){_agbf ,_gdee ,_dgbbf :=float64 (_fceb )/255,float64 (_agea )/255,float64 (_ceda )/255;
_cdeb :=_agbf ;if _gdee < _cdeb {_cdeb =_gdee ;};if _dgbbf < _cdeb {_cdeb =_dgbbf ;};var _dgee ,_eac bool ;_eaeg :=_agbf ;if _gdee > _eaeg {_eaeg =_gdee ;_dgee =true ;};if _dgbbf > _eaeg {_eaeg =_dgbbf ;_dgee =false ;_eac =true ;};_fcdc :=(_cdeb +_eaeg )/2;
var _afbd float64 ;if _cdeb !=_eaeg {if _fcdc <=0.5{_afbd =(_eaeg -_cdeb )/(_eaeg +_cdeb );}else {_afbd =(_eaeg -_cdeb )/(2.0-_eaeg -_cdeb );};};var _bce float64 ;if _cdeb !=_eaeg {if _dgee {_bce =2.0+(_dgbbf -_agbf )/(_eaeg -_cdeb );}else if _eac {_bce =4.0+(_agbf -_gdee )/(_eaeg -_cdeb );
}else {_bce =(_gdee -_dgbbf )/(_eaeg -_cdeb );};_bce *=60;if _bce < 0{_bce +=360;};};return _bce ,_afbd ,_fcdc ;};func GetDataFromXfrm (xfrm *_ea .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _ebbf ,_gcdc ,_bcfe ,_ecfc float64 ;if _fece :=xfrm .Off ;
_fece !=nil {_ebbf =_fbc .FromEMU (FromSTCoordinate (_fece .XAttr ));_gcdc =_fbc .FromEMU (FromSTCoordinate (_fece .YAttr ));};if _bebb :=xfrm .Ext ;_bebb !=nil {_bcfe =_fbc .FromEMU (_bebb .CxAttr );_ecfc =_fbc .FromEMU (_bebb .CyAttr );};return _ebbf ,_gcdc ,_bcfe ,_ecfc ;
};var _dgg =_aafg (1.5);const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);func _efef (_eeb *_ge .ChartSpace ,_acc ,_aaf float64 ,_bfb *_ea .Theme ,_fdg bool ,_ffcf *_gc .Workbook )(*_ba .Creator ,error ){_bdg :=1.0;
if _fdg {_bdg =8.0;};_ecdb :=&Rectangle {};_eag :=&Rectangle {Top :_ecdb .Top ,Bottom :_aaf -_ecdb .Bottom ,Left :_ecdb .Left ,Right :_acc -_ecdb .Right };_gdc :=MakeTempCreator (_acc *_bdg +1,_aaf *_bdg +1);_ecaa :=&creatorContext {_bdfb :_gdc ,_cbg :_bfb ,_bagg :_bdg };
var _fdd bool ;if _eef :=_eeb .Chart ;_eef !=nil {_gcb :=_eef .PlotArea ;if _gcb ==nil {return nil ,_fd .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_df :=0.0;if _eef .AutoTitleDeleted !=nil &&_eef .AutoTitleDeleted .ValAttr !=nil &&!*_eef .AutoTitleDeleted .ValAttr {if _eef .Title !=nil &&_eef .Title .Overlay !=nil &&_eef .Title .Overlay .ValAttr !=nil &&!*_eef .Title .Overlay .ValAttr {_df =_aafg (10);
};_acde :=_ecaa .getTitle (_eef .Title );if _acde ==""{_acde ="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";};_ecaa .drawTitle (_acde ,_eag .Left +_eag .Right /2,_aafg (5));};_fbg :=&Rectangle {Top :_aafg (10)+_df ,Bottom :_eag .Bottom -_aafg (15),Left :_aafg (10),Right :_eag .Right -_aafg (10)};
var _bg *Rectangle ;_cdac :=_eef .Legend ;if _cdac !=nil {_febb :=_cdac .Overlay !=nil &&_cdac .Overlay .ValAttr !=nil &&*_cdac .Overlay .ValAttr ;if _gbg :=_cdac .LegendPos ;_gbg !=nil {switch _gbg .ValAttr {case _ge .ST_LegendPosTr :if !_febb {_fbg =&Rectangle {Top :_aafg (25)+_df ,Bottom :_eag .Bottom -_aafg (10),Left :_aafg (10),Right :_eag .Right -_aafg (25)};
};_bg =&Rectangle {Top :_aafg (2.5)+_df ,Bottom :_aafg (22.5),Left :_eag .Right -_aafg (22.5),Right :_eag .Right -_aafg (2.5)};case _ge .ST_LegendPosT :_bg =&Rectangle {Top :_aafg (2.5)+_df ,Bottom :_aafg (7.5),Left :(_eag .Right -_eag .Left )*0.25,Right :(_eag .Right -_eag .Left )*0.75};
if !_febb {_fbg =&Rectangle {Top :_aafg (12.5)+_df ,Bottom :_eag .Bottom -_aafg (15),Left :_aafg (10),Right :_eag .Right -_aafg (5)};};_fdd =true ;case _ge .ST_LegendPosB :_bg =&Rectangle {Top :_eag .Bottom -_aafg (7.5)+_df ,Bottom :_eag .Bottom -_aafg (2.5),Left :(_eag .Right -_eag .Left )*0.25,Right :(_eag .Right -_eag .Left )*0.75};
if !_febb {_fbg =&Rectangle {Top :_aafg (5)+_df ,Bottom :_eag .Bottom -_aafg (15),Left :_aafg (10),Right :_eag .Right -_aafg (5)};};_fdd =true ;case _ge .ST_LegendPosR :_bg =&Rectangle {Top :(_eag .Bottom -_eag .Top )/2-_aafg (10)+_df ,Bottom :(_eag .Bottom -_eag .Top )/2+_aafg (10),Left :_eag .Right -_aafg (22.5),Right :_eag .Right -_aafg (2.5)};
if !_febb {_fbg =&Rectangle {Top :_aafg (5)+_df ,Bottom :_eag .Bottom -_aafg (12.5),Left :_aafg (10),Right :_eag .Right -_aafg (25)};};case _ge .ST_LegendPosL :_bg =&Rectangle {Top :(_eag .Bottom -_eag .Top )/2-_aafg (10)+_df ,Bottom :(_eag .Bottom -_eag .Top )/2+_aafg (10),Left :_aafg (2.5),Right :_aafg (22.5)};
if !_febb {_fbg =&Rectangle {Top :_aafg (5)+_df ,Bottom :_eag .Bottom -_aafg (12.5),Left :_aafg (30),Right :_eag .Right -_aafg (5)};};default:_bg =&Rectangle {Top :(_eag .Bottom -_eag .Top )/2-_aafg (10)+_df ,Bottom :(_eag .Bottom -_eag .Top )/2+_aafg (10),Left :_eag .Right -_aafg (25),Right :_eag .Right -_aafg (5)};
if !_febb {_fbg =&Rectangle {Top :_aafg (5)+_df ,Bottom :_eag .Bottom -_aafg (12.5),Left :_aafg (100),Right :_eag .Right -_aafg (25)};};};};};_fbg .scale (_bdg );_ecaa .drawBorderWithProps (_gcb .SpPr ,_fbg ,_fdfb );_bgg :=[]*legendItem {};var _ecc error ;
_ebd :=_gcb .CChoice ;for _ ,_dga :=range _gcb .Choice {if _fed :=_dga .BarChart ;_fed !=nil {_bgg ,_ecc =_ecaa .drawBarChart (_fed ,_fbg ,_ebd ,_ffcf );if _ecc !=nil {return nil ,_ecc ;};break ;};if _fee :=_dga .PieChart ;_fee !=nil {_bgg ,_ecc =_ecaa .drawPieChart (_fee ,_fbg ,_ffcf ,_bdg );
if _ecc !=nil {return nil ,_ecc ;};break ;};if _gbf :=_dga .ScatterChart ;_gbf !=nil {_bgg ,_ecc =_ecaa .drawScatterChart (_gbf ,_fbg ,_ebd ,_bdg );if _ecc !=nil {return nil ,_ecc ;};break ;};if _bdec :=_dga .LineChart ;_bdec !=nil {break ;};if _dbgb :=_dga .AreaChart ;
_dbgb !=nil {_bgg ,_ecc =_ecaa .drawAreaChart (_dbgb ,_fbg ,_ebd ,_bdg );if _ecc !=nil {return nil ,_ecc ;};break ;};};if _cdac !=nil {_bg .scale (_bdg );_ecaa .drawBorderWithProps (_cdac .SpPr ,_bg ,_fdfb );if len (_bgg )!=0{_ecaa .drawLegend (_bg ,_bgg ,_fdd );
};};};_eag .scale (_bdg );_ecaa .drawBorderWithProps (_eeb .SpPr ,_eag ,_fdfb );return _gdc ,nil ;};func _cfac (_aeda _ea .ST_SchemeColorVal ,_gbfa *_ea .Theme )string {if _gfab :=_gbfa .ThemeElements ;_gfab !=nil {if _dfee :=_gfab .ClrScheme ;_dfee !=nil {switch _aeda {case _ea .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_dfee .Lt1 );
case _ea .ST_SchemeColorValDk1 ,_ea .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_dfee .Dk1 );case _ea .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_dfee .Lt2 );case _ea .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_dfee .Dk2 );
case _ea .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_dfee .Accent1 );case _ea .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_dfee .Accent2 );case _ea .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_dfee .Accent3 );
case _ea .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_dfee .Accent4 );case _ea .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_dfee .Accent5 );case _ea .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_dfee .Accent6 );
};};};return "";};var _bfe =_aafg (5);func (_ggdd *creatorContext )drawLegend (_aff *Rectangle ,_ebdd []*legendItem ,_bfaa bool ){_ecfa :=_ggdd ._bagg ;_fagf :=_aafg (2.5)*_ecfa ;_afb :=_bfaf *_ecfa ;_aea :=(_fagf -_afb )/2;_bcf :=float64 (len (_ebdd ));
if _bfaa {_bdf :=&Rectangle {Top :_aff .Top +_aafg (1)*_ecfa ,Bottom :_aff .Bottom -_aafg (1)*_ecfa ,Left :_aff .Left +_aafg (2.5)*_ecfa ,Right :_aff .Right -_aafg (2.5)*_ecfa };var _addg float64 ;if _bcf > 1{_addg =(_bdf .Right -_bdf .Left )/_bcf ;};_fcd :=_bdf .Left ;
_bge :=_bdf .Top ;for _ ,_def :=range _ebdd {if _bed :=_def ._bbb ;_bed !=nil {_ggdd .drawRectangleWithProps (_bed ,_fcd ,_bge +_aea ,_afb ,_afb ,false );_afbf :=_fcd +_afb *2;_edc :=_ggdd ._bdfb .NewStyledParagraph ();_edc .SetPos (_afbf ,_bge );_agb :=_edc .Append (_def ._fdf );
_cc ,_aded :=_c .NewStandard14Font (_c .HelveticaName );if _aded ==nil {_eda :=_ggdd ._bdfb .NewTextStyle ();_eda .Font =_cc ;_eda .FontSize =_fagf ;_eda .TextRise =0.4;_agb .Style =_eda ;_ggdd ._bdfb .Draw (_edc );};};_fcd +=_addg ;};}else {_cea :=&Rectangle {Top :_aff .Top +_aafg (2.5)*_ecfa ,Bottom :_aff .Bottom -_aafg (2.5)*_ecfa ,Left :_aff .Left +_aafg (2.5)*_ecfa ,Right :_aff .Right -_aafg (2.5)*_ecfa };
var _cdaf float64 ;if _bcf > 1{_cdaf =(_cea .Bottom -_cea .Top -_fagf )/(_bcf -1);if _cdaf < _fagf {_cdaf =_fagf ;};};_gfd :=_cea .Top ;_adg :=_cea .Left ;_ccb :=_adg +_afb *2;for _ ,_dfg :=range _ebdd {if _agd :=_dfg ._bbb ;_agd !=nil {_ggdd .drawRectangleWithProps (_agd ,_adg ,_gfd +_aea ,_afb ,_afb ,false );
_ecde :=_ggdd ._bdfb .NewStyledParagraph ();_ecde .SetPos (_ccb ,_gfd );_ecde .SetWidth (_cea .Right -_cea .Left );_ebdb :=_ecde .Append (_dfg ._fdf );_fbgf ,_aag :=_c .NewStandard14Font (_c .HelveticaName );if _aag ==nil {_bff :=_ggdd ._bdfb .NewTextStyle ();
_bff .Font =_fbgf ;_bff .FontSize =_fagf ;_bff .TextRise =0.4;_ebdb .Style =_bff ;_ggdd ._bdfb .Draw (_ecde );};};_gfd +=_cdaf ;};};};func FromSTPercentage (st *_ea .ST_Percentage )float64 {if _gefe :=st .ST_PercentageDecimal ;_gefe !=nil {return float64 (*_gefe )/100000;
};return 0;};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _gbgfb ,_fcfa ,_ece uint8 ;_efa ,_ :=_gb .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_gbgfb ,&_fcfa ,&_ece );if _efa !=3{return "";
};_fbgfa ,_gab ,_fffe :=_eab (_gbgfb ,_fcfa ,_ece );_fffe =lum *_fffe ;_gbgfb ,_fcfa ,_ece =_egga (_fbgfa ,_gab ,_fffe );return _gb .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_gbgfb ,_fcfa ,_ece );};var _dfbe =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
func (_ccbd *Rectangle )scale (_ceca float64 ){_ccbd .Top *=_ceca ;_ccbd .Bottom *=_ceca ;_ccbd .Left *=_ceca ;_ccbd .Right *=_ceca ;};func GetPageFromCreator (c *_ba .Creator )(*_c .PdfPage ,error ){_ddga :=_fb .NewBuffer ([]byte {});_cebf :=c .Write (_ddga );
if _cebf !=nil {return nil ,_cebf ;};_aaac :=_fb .NewReader (_ddga .Bytes ());_fcbd ,_cebf :=_c .NewPdfReader (_aaac );if _cebf !=nil {return nil ,_cebf ;};return _fcbd .GetPage (1);};type legendItem struct{_fdf string ;_bbb *_ea .CT_ShapeProperties ;};
func (_adfg *creatorContext )getPdfColorFromSolidFill (_cbfe *_ea .CT_SolidColorFillProperties )_ba .Color {if _cbfe ==nil {return nil ;};_dddb :="";if _dcdd :=_cbfe .SrgbClr ;_dcdd !=nil {_dddb =_dcdd .ValAttr ;}else if _cgce :=_cbfe .SchemeClr ;_cgce !=nil {_dddb =_cfac (_cgce .ValAttr ,_adfg ._cbg );
_dddb =AdjustColor (_dddb ,_cgce .EG_ColorTransform );};if _dddb ==""{return nil ;};return _ba .ColorRGBFromHex ("\u0023"+_dddb );};func AssignStdFontByName (style _ba .TextStyle ,fontName string )*_c .PdfFont {_ddabd :=_c .StdFontName (fontName );return _c .NewStandard14FontMustCompile (_ddabd );
};func _dgc (_dad *_ge .CT_CatAx )(uint32 ,_ge .ST_AxPos ,_ge .ST_TickMark ,_ge .ST_TickLblPos ,*_ge .CT_ChartLines ,uint32 ,*_ea .CT_ShapeProperties ,error ){var _gfcc ,_fcba uint32 ;var _ddgc _ge .ST_AxPos ;var _ffce _ge .ST_TickMark ;var _dce *_ge .CT_ChartLines ;
var _ggdc _ge .ST_TickLblPos ;if _dad .AxId ==nil {return _gfcc ,_ddgc ,_ffce ,_ggdc ,_dce ,_fcba ,_dad .SpPr ,_fd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_gfcc =_dad .AxId .ValAttr ;};if _dad .AxPos ==nil {return _gfcc ,_ddgc ,_ffce ,_ggdc ,_dce ,_fcba ,_dad .SpPr ,_fd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_ddgc =_dad .AxPos .ValAttr ;};if _dad .MajorTickMark !=nil {_ffce =_dad .MajorTickMark .ValAttr ;};if _dad .TickLblPos !=nil {_ggdc =_dad .TickLblPos .ValAttr ;};if _dad .CrossAx ==nil {return _gfcc ,_ddgc ,_ffce ,_ggdc ,_dce ,_fcba ,_dad .SpPr ,_fd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_fcba =_dad .CrossAx .ValAttr ;};_dce =_dad .MajorGridlines ;return _gfcc ,_ddgc ,_ffce ,_ggdc ,_dce ,_fcba ,_dad .SpPr ,nil ;};type creatorContext struct{_bdfb *_ba .Creator ;_cbg *_ea .Theme ;_bagg float64 ;};func (_afeb *creatorContext )drawLineWithProps (_baf *_ea .CT_ShapeProperties ,_fgbc ,_affd ,_cfafd ,_efbfb float64 ,_bfbg bool ){if _baf !=nil {if _aggb :=_baf .Ln ;
_aggb !=nil {_gcbg :=_afeb .getPdfColorFromSolidFill (_aggb .SolidFill );if _gcbg ==nil &&_bfbg {_gcbg =_ba .ColorBlack ;};if _gcbg !=nil {var _gcad float64 ;if _daca :=_aggb .WAttr ;_daca !=nil {_gcad =_fbc .FromEMU (int64 (*_daca ));}else {_gcad =_fdfb ;
};DrawLine (_afeb ._bdfb ,_fgbc ,_affd ,_cfafd ,_efbfb ,_gcad ,_gcbg );};};};};type serValue struct{_dbe string ;_dbg float64 ;_bac *_ea .CT_ShapeProperties ;};func AdjustColor (colorStr string ,EG_ColorTransform []*_ea .EG_ColorTransform )string {for _ ,_fca :=range EG_ColorTransform {if _ggc :=_fca .Tint ;
_ggc !=nil {if _abe :=_ggc .ValAttr .ST_PositiveFixedPercentageDecimal ;_abe !=nil {colorStr =AdjustColorByTint (colorStr ,float64 (*_abe )/100000);};};if _cad :=_fca .Shade ;_cad !=nil {if _adde :=_cad .ValAttr .ST_PositiveFixedPercentageDecimal ;_adde !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_adde )/100000);
};};if _ddab :=_fca .LumMod ;_ddab !=nil {if _affad :=_ddab .ValAttr .ST_PercentageDecimal ;_affad !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_affad )/100000);};};};return colorStr ;};func MakeBlockFromCreator (c *_ba .Creator )(*_ba .Block ,error ){_ccdg ,_dabe :=GetPageFromCreator (c );
if _dabe !=nil {return nil ,_dabe ;};_ccbbf ,_dabe :=_ba .NewBlockFromPage (_ccdg );if _dabe !=nil {return nil ,_dabe ;};return _ccbbf ,nil ;};var _edag =_aafg (1.5);var _bgec =fontsMap {_bba :&_dc .Mutex {},_bcfc :map[string ]map[FontStyle ]*_c .PdfFont {}};
func GetColorStringFromDmlColor (dmlColor *_ea .CT_Color )string {var _ggac string ;if _ecfb :=dmlColor .SrgbClr ;_ecfb !=nil {_ggac =_ecfb .ValAttr ;}else if _eedf :=dmlColor .SysClr ;_eedf !=nil {if _eedf .LastClrAttr !=nil {return *_eedf .LastClrAttr ;
};return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _ggac ;};func TwipsFromPoints (points float64 )float64 {return points /_fbc .Twips };func ParseExcelRange (s string )(string ,_ff .CellReference ,_ff .CellReference ,error ){_edec :=_bb .FieldsFunc (s ,func (_eacf rune )bool {return _eacf ==':'||_eacf =='!'});
if len (_edec )==3{_edef ,_feea :=_ff .ParseCellReference (_edec [1]);if _feea !=nil {return "",_ff .CellReference {},_ff .CellReference {},_feea ;};_ecgg ,_feea :=_ff .ParseCellReference (_edec [2]);if _feea !=nil {return "",_ff .CellReference {},_ff .CellReference {},_feea ;
};return _edec [0],_edef ,_ecgg ,nil ;};return "",_ff .CellReference {},_ff .CellReference {},_fd .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");};func DrawLine (c *_ba .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _ba .Color ){if color ==nil {return ;
};_cdff :=c .NewLine (x0 ,y0 ,x1 ,y1 );_cdff .SetLineWidth (width );_cdff .SetColor (color );c .Draw (_cdff );};func AdjustColorByShade (colorStr string ,shade float64 )string {var _cge ,_fadbf ,_cgff uint8 ;_eeg ,_ :=_gb .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_cge ,&_fadbf ,&_cgff );
if _eeg !=3{return "";};return _cgbf (_cge ,shade )+_cgbf (_fadbf ,shade )+_cgbf (_cgff ,shade );};func DrawRectangle (c *_ba .Creator ,r *Rectangle ,w float64 ,color _ba .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );
DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};func GetOpacityFromColorTransform (trs []*_ea .EG_ColorTransform )float64 {for _ ,_gfg :=range trs {if _gfg !=nil {if _cac :=_gfg .Alpha ;
_cac !=nil {if _agfe :=_cac .ValAttr .ST_PositiveFixedPercentageDecimal ;_agfe !=nil {return float64 (*_agfe )/100000;};};};};return 1.0;};func (_dgb *creatorContext )getTitle (_bag *_ge .CT_Title )string {_cgf :="";if _bag !=nil &&_bag .Tx !=nil &&_bag .Tx .Choice !=nil &&_bag .Tx .Choice .Rich !=nil {if len (_bag .Tx .Choice .Rich .P )> 0{for _ ,_baae :=range _bag .Tx .Choice .Rich .P {if len (_baae .EG_TextRun )> 0{_cgf +="\u000a"+_baae .EG_TextRun [0].R .T ;
};};};};return _cgf ;};func CropImageByRect (sourceImg _ed .Image ,rect _ed .Rectangle )_ed .Image {_dbfa ,_aaee ,_adfe ,_cbe :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;_faca :=_ed .NewNRGBA (_ed .Rect (0,0,_adfe -_dbfa ,_cbe -_aaee ));for _fccd :=_dbfa ;
_fccd < _adfe ;_fccd ++{for _agacb :=_aaee ;_agacb < _cbe ;_agacb ++{_faca .Set (_fccd -_dbfa ,_agacb -_aaee ,sourceImg .At (_fccd ,_agacb ));};};return _faca ;};func _edd (_cdef uint8 ,_acg float64 )string {_fbef :=float64 (_cdef );var _fadb float64 ;
if _acg < 0{_fadb =_fbef *(1+_acg );}else {_fadb =_fbef +(255-_fbef )*_acg ;};return _gb .Sprintf ("\u0025\u0030\u0032\u0078",int (_fadb ));};func _egaf (_fefa string )error {if !_bb .HasSuffix (_fefa ,"\u002e\u0074\u0074\u0066"){_aa .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _gb .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_dfbf ,_gfe :=_ga .ParseFile (_fefa );if _gfe !=nil {_aa .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gfe );return _gfe ;};_efaf ,_gfe :=_c .NewCompositePdfFontFromTTFFile (_fefa );
if _gfe !=nil {return _gfe ;};_ecab :=_dfbf .GetNameRecords ();for _ ,_ccea :=range _ecab {_efca :=_ccea [1];if _efca ==""{continue ;};_eaef :=make ([]byte ,0);for _ecfbe :=0;_ecfbe < len (_efca );_ecfbe ++{if _efca [_ecfbe ]==39||_efca [_ecfbe ]==92{continue ;
};_abcd :=4;if _ecfbe +_abcd < len (_efca ){if _efca [_ecfbe :_ecfbe +_abcd ]=="\u0000"{_ecfbe =_ecfbe +_abcd +1;continue ;};};_eaef =append (_eaef ,_efca [_ecfbe ]);};_efca =_bb .Replace (string (_eaef ),"\u0078\u0030\u0030","",-1);_fabe :=_ccea [2];if _fabe ==""{return _gb .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_fefa );
};_eaef =make ([]byte ,0);for _daa :=0;_daa < len (_fabe );_daa ++{if _fabe [_daa ]==39||_fabe [_daa ]==92{continue ;};_cgc :=4;if _daa +_cgc < len (_fabe ){if _fabe [_daa :_daa +_cgc ]=="\u0000"{_daa =_daa +_cgc +1;continue ;};};_eaef =append (_eaef ,_fabe [_daa ]);
};_fabe =_bb .Replace (string (_eaef ),"\u0078\u0030\u0030","",-1);RegisterFont (_efca ,_dfbe [_fabe ],_efaf );};return nil ;};func GetImage (c *_ba .Creator ,goImg _ed .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_ba .Image ,error ){if goImg ==nil {return nil ,nil ;
};_edbdc :=goImg .Bounds ().Size ();_dbf :=_edbdc .X ;_beff :=_edbdc .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_dbf );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_beff );};var _cbbc _ed .Rectangle ;switch part {case ImgPart_t :_cbbc =_ed .Rect (0,0,_dbf ,int (dividerY ));
case ImgPart_b :_cbbc =_ed .Rect (0,int (dividerY ),_dbf ,_beff );case ImgPart_l :_cbbc =_ed .Rect (0,0,int (dividerX ),_beff );case ImgPart_r :_cbbc =_ed .Rect (int (dividerX ),0,_dbf ,_beff );case ImgPart_lt :_cbbc =_ed .Rect (0,0,int (dividerX ),int (dividerY ));
case ImgPart_rt :_cbbc =_ed .Rect (int (dividerX ),0,_dbf ,int (dividerY ));case ImgPart_lb :_cbbc =_ed .Rect (0,int (dividerY ),int (dividerX ),_beff );case ImgPart_rb :_cbbc =_ed .Rect (int (dividerX ),int (dividerY ),_dbf ,_beff );default:_cbbc =_ed .Rect (0,0,_dbf ,_beff );
};_ceac :=CropImageByRect (goImg ,_cbbc );_abcf ,_gffa :=c .NewImageFromGoImage (_ceac );if _gffa !=nil {return nil ,_gffa ;};_abcf .Scale (imgWidth /float64 (_dbf ),imgHeight /float64 (_beff ));_abcf .SetPos (left ,top );return _abcf ,nil ;};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func _aafg (_eead float64 )float64 {return _eead *_fbc .Millimeter };func (_ffd *creatorContext )drawAxes (_abf *_ge .CT_PlotAreaChoice1 ,_gbgb ,_bae ,_gae float64 ,_fbaf []string ,_fcb *Rectangle ,_bgd bool )error {_ffa :=_ffd ._bdfb ;_ffe :=_ffd ._bagg ;
if _abf ==nil {return _fd .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_abf .ValAx )==0||(len (_abf .CatAx )==0&&len (_abf .DateAx )==0&&len (_abf .SerAx )==0){return _fd .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _ebb ,_gcg ,_fcf ,_adb uint32 ;var _ccc ,_gda _ge .ST_AxPos ;var _ecdc ,_bdb _ge .ST_TickMark ;var _caaf ,_edbd *_ge .CT_ChartLines ;var _dda ,_abfg _ge .ST_TickLblPos ;var _fcbf ,_gcc *_ea .CT_ShapeProperties ;var _agec error ;_afgc :=_fcb .Right -_fcb .Left ;
_dgae :=_fcb .Bottom -_fcb .Top ;if len (_abf .ValAx )> 0{_gcg ,_gda ,_bdb ,_abfg ,_edbd ,_adb ,_gcc ,_agec =_gbgf (_abf .ValAx [0]);};if _gda !=_ge .ST_AxPosL &&_gda !=_ge .ST_AxPosB {return _fd .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_dead :=_bae -_gbgb ;_efg :=int (_dead /_gae )+1;var _gaf ,_eee float64 ;switch _bdb {case _ge .ST_TickMarkIn :_gaf ,_eee =_eae ,0;case _ge .ST_TickMarkOut :_gaf ,_eee =0,_eae ;case _ge .ST_TickMarkCross :_gaf ,_eee =_eae ,_eae ;};_gaf =_gaf *_ffe ;_eee =_eee *_ffe ;
var _dba *_ea .CT_ShapeProperties ;if _edbd !=nil {_dba =_edbd .SpPr ;};_fbe ,_adbd :=_dda !=_ge .ST_TickLblPosNone ,_abfg !=_ge .ST_TickLblPosNone ;_effe :=_gbgb ;if len (_abf .CatAx )> 0{_ebb ,_ccc ,_ecdc ,_dda ,_caaf ,_fcf ,_fcbf ,_agec =_dgc (_abf .CatAx [0]);
}else if len (_abf .DateAx )> 0{_ebb ,_ccc ,_ecdc ,_dda ,_caaf ,_fcf ,_fcbf ,_agec =_afga (_abf .DateAx [0]);}else if len (_abf .SerAx )> 0{_ebb ,_ccc ,_ecdc ,_dda ,_caaf ,_fcf ,_fcbf ,_agec =_bgb (_abf .SerAx [0]);};if _agec !=nil {return _agec ;};if _ccc !=_ge .ST_AxPosL &&_ccc !=_ge .ST_AxPosB {return _fd .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _ebb !=_adb ||_gcg !=_fcf {return _fd .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_eea :=len (_fbaf )+1;var _cdafe ,_eeaa float64 ;switch _ecdc {case _ge .ST_TickMarkIn :_cdafe ,_eeaa =_eae ,0;
case _ge .ST_TickMarkOut :_cdafe ,_eeaa =0,_eae ;case _ge .ST_TickMarkCross :_cdafe ,_eeaa =_eae ,_eae ;};_cdafe =_cdafe *_ffe ;_eeaa =_eeaa *_ffe ;var _dbda *_ea .CT_ShapeProperties ;if _caaf !=nil {_dbda =_caaf .SpPr ;};if _bgd {_cccd :=_dgae /float64 (len (_fbaf ));
_gaaf :=_fcb .Left -_gbgb *_afgc /_dead ;_gbcgc :=_gaaf -_eff *_ffe ;if _fbe {var _gdf float64 ;for _dbag :=0;_dbag < _eea ;_dbag ++{_dgbf :=_fcb .Bottom -float64 (_dbag )*_cccd ;if _dbag < _eea -1{_ageb :=_ffa .NewParagraph (_fbaf [_dbag ]);_ageb .SetFontSize (_bda *_ffe );
_ageb .SetPos (_gbcgc ,_dgbf -_cccd /2-_dgg *_ffe );_ffa .Draw (_ageb );_eebb :=(_ageb .Width ()/1000-_eff )*_ffe ;if _eebb > 0&&_eebb > _gdf {_gdf =_eebb ;};};};if _gdf > 0{_fcb .Left +=_gdf +_fcgf ;_gaaf =_fcb .Left -_gbgb *_afgc /_dead ;_afgc =_fcb .Right -_fcb .Left ;
};};_aafa :=_gaaf -_eeaa ;_fbced :=_gaaf +_cdafe ;_ddg :=_fcb .Left ;_ecbc :=_fcb .Right ;for _aef :=0;_aef < _eea ;_aef ++{_afbb :=_fcb .Bottom -float64 (_aef )*_cccd ;_ffd .drawLineWithProps (_fcbf ,_aafa ,_afbb ,_fbced ,_afbb ,true );_ffd .drawLineWithProps (_dbda ,_ddg ,_afbb ,_ecbc ,_afbb ,true );
};_bbbg :=_afgc /_dead ;_dddd :=_fcb .Bottom -_gaf ;_edbb :=_fcb .Bottom +_eee ;_fcdg :=_fcb .Top ;_gdg :=_fcb .Bottom ;for _abdf :=0;_abdf < _efg ;_abdf ++{_eaa :=_fcb .Left +(_effe -_gbgb )*_bbbg ;_ffd .drawLineWithProps (_gcc ,_eaa ,_dddd ,_eaa ,_edbb ,true );
_ffd .drawLineWithProps (_dba ,_eaa ,_fcdg ,_eaa ,_gdg ,true );if _adbd {_ebf :=_ffa .NewParagraph (_de .FormatFloat (_effe ,'g',-1,64));_ebf .SetFontSize (_bda *_ffe );_ebf .SetPos (_eaa -_aadg *_ffe ,_gdg +_edag *_ffe );_ffa .Draw (_ebf );};_effe +=_gae ;
};}else {_beac :=_dgae /_dead ;_egg :=_fcb .Left ;if _adbd {var _fccf float64 ;for _dff :=0;_dff < _efg ;_dff ++{_ebe :=_fcb .Bottom -(_effe -_gbgb )*_beac ;_dgeb :=_ffa .NewParagraph (_de .FormatFloat (_effe ,'g',-1,64));_dgeb .SetFontSize (_bda *_ffe );
_dgeb .SetPos (_egg -_eff *_ffe ,_ebe -_dgg *_ffe );_ffa .Draw (_dgeb );_bee :=(_dgeb .Width ()/1000-_eff )*_ffe ;if _bee > 0&&_bee > _fccf {_fccf =_bee ;};_effe +=_gae ;};if _fccf > 0{_fcb .Left +=_fccf +_fcgf ;_afgc =_fcb .Right -_fcb .Left ;};};_effe =_gbgb ;
_gdaf :=_fcb .Left -_eee ;_fec :=_fcb .Left +_gaf ;_egg =_fcb .Left ;_feca :=_fcb .Right ;for _fce :=0;_fce < _efg ;_fce ++{_bdab :=_fcb .Bottom -(_effe -_gbgb )*_beac ;_ffd .drawLineWithProps (_gcc ,_gdaf ,_bdab ,_fec ,_bdab ,true );_ffd .drawLineWithProps (_dba ,_egg ,_bdab ,_feca ,_bdab ,true );
_effe +=_gae ;};_aaec :=_afgc /float64 (len (_fbaf ));_cde :=_fcb .Bottom +_gbgb *_dgae /_dead ;_ebbb :=_cde -_cdafe ;_affa :=_cde +_eeaa ;_dfe :=_fcb .Top ;_ebc :=_fcb .Bottom ;_fgab :=_cde +_edag *_ffe ;for _baec :=0;_baec < _eea ;_baec ++{_ddgf :=_fcb .Left +float64 (_baec )*_aaec ;
_ffd .drawLineWithProps (_fcbf ,_ddgf ,_ebbb ,_ddgf ,_affa ,true );_ffd .drawLineWithProps (_dbda ,_ddgf ,_dfe ,_ddgf ,_ebc ,true );if _fbe &&_baec < _eea -1{_fge :=_ffa .NewParagraph (_fbaf [_baec ]);_fge .SetFontSize (_bda *_ffe );_fge .SetPos (_ddgf +_bfe *_ffe ,_fgab );
_ffa .Draw (_fge );};};};return nil ;};var _aadg =_aafg (0.5);func _egga (_adee ,_efbf ,_cfae float64 )(uint8 ,uint8 ,uint8 ){var _cce float64 ;if _cfae < 0.5{_cce =_cfae *(1+_efbf );}else {_cce =_cfae +_efbf -_cfae *_efbf ;};_ada :=_cfae *2-_cce ;_adee /=360.0;
_dbbc :=_dca (_adee +1.0/3.0);_dcee :=_dca (_adee );_bfdc :=_dca (_adee -1.0/3.0);_eec :=_dgd (_dbbc ,_cce ,_ada );_dggd :=_dgd (_dcee ,_cce ,_ada );_acb :=_dgd (_bfdc ,_cce ,_ada );return uint8 (255*_eec ),uint8 (255*_dggd ),uint8 (255*_acb );};func _dgd (_fcfb ,_fgd ,_efga float64 )float64 {if _fcfb *6< 1{return _efga +(_fgd -_efga )*6*_fcfb ;
}else if _fcfb *2< 1{return _fgd ;}else if _fcfb *3< 2{return _efga +(_fgd -_efga )*(2.0/3.0-_fcfb )*6;}else {return _efga ;};};func MakeTempCreatorMaxHeight (width float64 )*_ba .Creator {return MakeTempCreator (width ,_gf .MaxFloat64 );};