//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_e "bytes";_fa "errors";_ba "fmt";_ad "github.com/unidoc/unichart";_df "github.com/unidoc/unichart/dataset";_g "github.com/unidoc/unichart/render";_a "github.com/unidoc/unioffice/common/logger";_ee "github.com/unidoc/unioffice/document";
_ec "github.com/unidoc/unioffice/measurement";_efa "github.com/unidoc/unioffice/schema/soo/dml";_fg "github.com/unidoc/unioffice/schema/soo/dml/chart";_ef "github.com/unidoc/unioffice/spreadsheet";_ab "github.com/unidoc/unioffice/spreadsheet/format";_ca "github.com/unidoc/unioffice/spreadsheet/formula";
_ccf "github.com/unidoc/unioffice/spreadsheet/reference";_af "github.com/unidoc/unipdf/v3/creator";_eea "github.com/unidoc/unipdf/v3/model";_ge "github.com/unidoc/unipdf/v3/render";_fb "github.com/unidoc/unitype";_be "image";_db "math";_f "os";_c "regexp";
_fc "sort";_cc "strconv";_bc "strings";_bd "sync";_d "unicode";);type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};type ImgPart byte ;func DrawLine (c *_af .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _af .Color ){if color ==nil {return ;
};_ecdbg :=c .NewLine (x0 ,y0 ,x1 ,y1 );_ecdbg .SetLineWidth (width );_ecdbg .SetColor (color );c .Draw (_ecdbg );};func (_fadb *Rectangle )Translate (x ,y float64 ){_fadb .Left +=x ;_fadb .Right +=x ;_fadb .Top +=y ;_fadb .Bottom +=y ;};func FromSTCoordinate (st _efa .ST_Coordinate )int64 {if _bcfd :=st .ST_CoordinateUnqualified ;
_bcfd !=nil {return *_bcfd ;};return 0;};func _deed (_gdag *_ee .Document ,_acga ,_bbad ,_befb string )error {_gfead ,_fcad :=_gdag .GetFontBytesByRelId (_bbad );if _fcad !=nil {return _fcad ;};_dbcb ,_fcad :=_afg (_befb );if _fcad !=nil {return _fcad ;
};for _eaec :=0;_eaec < 32;_eaec ++{_afbf :=_eaec %len (_dbcb );_gfead [_eaec ]=_gfead [_eaec ]^_dbcb [_afbf ];};_gcg :=_gdag .TmpPath +"\u002f"+_acga +"\u002e\u0074\u0074\u0066";_fcad =_f .WriteFile (_gcg ,_gfead ,0644);if _fcad !=nil {return _fcad ;};
_cbfb (_gcg );return nil ;};func MakeBlockFromChartSpace (cs *_fg .ChartSpace ,width ,height float64 ,theme *_efa .Theme )(*_af .Block ,error ){_fdd ,_cgd :=_fge (cs ,width ,height ,theme ,false ,nil );if _cgd !=nil {return nil ,_cgd ;};_fbcb ,_cgd :=GetPageFromCreator (_fdd );
if _cgd !=nil {return nil ,_cgd ;};_ead ,_cgd :=_af .NewBlockFromPage (_fbcb );if _cgd !=nil {return nil ,_cgd ;};return _ead ,nil ;};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;
ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);func GetRegisteredFont (name string ,style FontStyle )*_eea .PdfFont {_eecb ._baed .Lock ();defer _eecb ._baed .Unlock ();if _ceef ,_abcd :=_eecb ._dcc [name ];_abcd {if _dfega ,_cfdg :=_ceef [style ];
_cfdg {return _dfega ;};};return nil ;};func (_ecbg *Rectangle )scale (_bfd float64 ){_ecbg .Top *=_bfd ;_ecbg .Bottom *=_bfd ;_ecbg .Left *=_bfd ;_ecbg .Right *=_bfd ;};var _afc =_eed (1.5);func (_de *creatorContext )drawBarChart (_ae *_fg .CT_BarChart ,_cd *Rectangle ,_fe *_fg .CT_PlotAreaChoice1 ,_bcb *_ef .Workbook )([]*legendItem ,error ){var _da bool ;
if _dbd :=_ae .BarDir ;_dbd !=nil {_da =_dbd .ValAttr ==_fg .ST_BarDirBar ;};_dc :=_ae .Ser ;_fc .Sort (barSerByOrder (_dc ));_cg :=map[string ]serCategory {};_fd :=[]string {};_aa :=[]*legendItem {};_geb :=_db .Inf (1);_bg :=_db .Inf (-1);for _ ,_ff :=range _dc {var _dcf string ;
if _dcfc :=_ff .Tx ;_dcfc !=nil {if _efae :=_dcfc .Choice ;_efae !=nil {if _efae .V !=nil {_dcf =*_efae .V ;}else if _bab :=_efae .StrRef ;_bab !=nil {if _gg :=_bab .StrCache ;_gg !=nil {for _ ,_eag :=range _gg .Pt {_dcf =_eag .V ;};};};};};if _fbd :=_ff .Cat ;
_fbd !=nil {if _ac :=_fbd .Choice ;_ac !=nil {if _ce :=_ac .StrRef ;_ce !=nil {if _bag :=_ce .F ;_bag !=""&&_bcb !=nil {_gge ,_dfe ,_bgc ,_dg :=ParseExcelRange (_bag );if _dg ==nil {for _ ,_bgb :=range _bcb .Sheets (){if _bgb .Name ()==_bc .Trim (_gge ,"\u0027"){_dd :=_dfe .String ();
for _bb :=_dfe .RowIdx ;_bb <=_bgc .RowIdx ;_bb +=1{_ecg :=_bc .ReplaceAll (_dd ,_ba .Sprint (_dfe .RowIdx ),_ba .Sprint (_bb ));_de .addCatName (_bgb .Cell (_ecg ).GetString (),_cg ,&_fd );};break ;};};};};if _cce :=_ce .StrCache ;_cce !=nil {for _ ,_bf :=range _cce .Pt {_de .addCatName (_bf .V ,_cg ,&_fd );
};};}else if _dgd :=_ac .NumRef ;_dgd !=nil {if _afd :=_dgd .NumCache ;_afd !=nil {var _gea string ;if _afd .FormatCode !=nil {_gea =*_afd .FormatCode ;};for _ ,_ag :=range _afd .Pt {var _dbb string ;if _ag .FormatCodeAttr ==nil {_dbb =_gea ;}else {_dbb =*_ag .FormatCodeAttr ;
};var _abb string ;_fcg ,_fce :=_cc .ParseFloat (_ag .V ,64);if _fce !=nil {_abb =_ag .V ;}else {_abb =_ab .Number (_fcg ,_dbb );};_de .addCatName (_abb ,_cg ,&_fd );};};};};};if _dce :=_ff .Val ;_dce !=nil {if _fbg :=_dce .Choice ;_fbg !=nil {if _dbc :=_fbg .NumRef ;
_dbc !=nil {if _ecc :=_dbc .F ;_ecc !=""&&_bcb !=nil {_dga ,_dcb ,_dab ,_gf :=ParseExcelRange (_ecc );if _gf ==nil {for _ ,_eaga :=range _bcb .Sheets (){if _eaga .Name ()==_bc .Trim (_dga ,"\u0027"){_cf :=_dcb .String ();for _bee :=_dcb .RowIdx ;_bee <=_dab .RowIdx ;
_bee +=1{_ed :=_bc .ReplaceAll (_cf ,_ba .Sprint (_dcb .RowIdx ),_ba .Sprint (_bee ));if _eaga .FormulaContext ().HasFormula (_ed ){_eb :=_ca .NewEvaluator ();_fad :=_eaga .FormulaContext ().Cell (_ed ,_eb );_bbg :=_fad .Value ();_de .addCatValue (_bbg ,_cg ,_fd ,(int )(_bee -_dcb .RowIdx ),&_geb ,&_bg ,_dcf ,_ff .SpPr );
}else {_acc :=_eaga .Cell (_ed ).GetString ();_de .addCatValue (_acc ,_cg ,_fd ,(int )(_bee -_dcb .RowIdx ),&_geb ,&_bg ,_dcf ,_ff .SpPr );};};break ;};};};};if _acg :=_dbc .NumCache ;_acg !=nil {for _afb ,_fed :=range _acg .Pt {_de .addCatValue (_fed .V ,_cg ,_fd ,_afb ,&_geb ,&_bg ,_dcf ,_ff .SpPr );
};};};};};_aa =append (_aa ,&legendItem {_bba :_dcf ,_gda :_ff .SpPr });};var _agf float64 ;var _cga ,_beed float64 ;if _bg ==0&&_geb ==0{_agf =0.2;_beed =0;_cga =1;}else {var _abd float64 ;if _ga :=_db .Abs (_geb );_bg < _ga {_abd =_ga ;}else {_abd =_bg ;
};_efd :=_db .Pow (10,_db .Floor (_db .Log10 (_abd )));_cge :=_abd /_efd ;if _cge < 4.29{_agf =0.5;}else if _cge >=4.29&&_cge < 8.58{_agf =1;}else {_agf =2;};_agf *=_efd ;if _bg <=0{_cga =0;}else {_cga =(_db .Ceil (_bg /_agf )+1)*_agf ;};if _geb >=0{_beed =0;
}else {_beed =(_db .Floor (_geb /_agf )-1)*_agf ;};};_cgab :=_de .drawAxes (_fe ,_beed ,_cga ,_agf ,_fd ,_cd ,_da );if _cgab !=nil {return nil ,_cgab ;};_dbe :=0.0;if _ae .GapWidth !=nil {if _aga :=_ae .GapWidth .ValAttr ;_aga !=nil {if _dbde :=_aga .ST_GapAmountUShort ;
_dbde !=nil {_dbe =float64 (*_dbde )/100.0;};};};_bcba :=_cd .Right -_cd .Left ;_ggg :=_cd .Bottom -_cd .Top ;_aaa :=float64 (len (_fd ));if _da {_cac :=_cga /(_cga -_beed )*_bcba ;_deb :=-_beed /(_cga -_beed )*_bcba ;_acb :=_cd .Left +_deb ;_aed :=_ggg /_aaa ;
for _aef ,_fab :=range _fd {_cba :=_cg [_fab ];_gfc :=float64 (len (_cba ._gff ))+_dbe ;_ebc :=_aed /_gfc ;_fedb :=_ebc *_dbe ;_gef :=_cd .Bottom -float64 (_aef )*_aed -_fedb /2-_ebc ;for _ ,_ebe :=range _cba ._gff {if _ebe ._ebeg ==0{continue ;};var _fag ,_gb float64 ;
if _ebe ._ebeg > 0{_gb =_ebe ._ebeg /_cga *_cac ;_de .drawRectangleWithProps (_ebe ._gc ,_acb ,_gef ,_gb ,_ebc ,false );}else {_gb =_ebe ._ebeg /_beed *_deb ;_fag =_acb -_gb ;_de .drawRectangleWithProps (_ebe ._gc ,_fag ,_gef ,_gb ,_ebc ,false );};_gef -=_ebc ;
};};}else {_edd :=_cga /(_cga -_beed )*_ggg ;_adc :=-_beed /(_cga -_beed )*_ggg ;_ddg :=_cd .Top +_edd ;_fgg :=_bcba /_aaa ;for _aee ,_aec :=range _fd {_ffdc :=_cg [_aec ];_acd :=float64 (len (_ffdc ._gff ))+_dbe ;_fbe :=_fgg /_acd ;_fef :=_fbe *_dbe ;
_gfb :=_cd .Left +float64 (_aee )*_fgg +_fef /2;for _ ,_fbc :=range _ffdc ._gff {var _eg ,_gd float64 ;if _fbc ._ebeg > 0{_gd =_fbc ._ebeg /_cga *_edd ;_eg =_ddg -_gd ;_de .drawRectangleWithProps (_fbc ._gc ,_gfb ,_eg ,_fbe ,_gd ,false );}else {_gd =_fbc ._ebeg /_beed *_adc ;
_de .drawRectangleWithProps (_fbc ._gc ,_gfb ,_ddg ,_fbe ,_gd ,false );};_gfb +=_fbe ;};};};return _aa ,nil ;};func GetDataFromXfrm (xfrm *_efa .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _ddde ,_dgce ,_edegg ,_bebg float64 ;if _ccae :=xfrm .Off ;
_ccae !=nil {_ddde =_ec .FromEMU (FromSTCoordinate (_ccae .XAttr ));_dgce =_ec .FromEMU (FromSTCoordinate (_ccae .YAttr ));};if _abde :=xfrm .Ext ;_abde !=nil {_edegg =_ec .FromEMU (_abde .CxAttr );_bebg =_ec .FromEMU (_abde .CyAttr );};return _ddde ,_dgce ,_edegg ,_bebg ;
};func AdjustColorByShade (colorStr string ,shade float64 )string {var _faa ,_acba ,_eaed uint8 ;_dae ,_ :=_ba .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_faa ,&_acba ,&_eaed );if _dae !=3{return "";};return _fbce (_faa ,shade )+_fbce (_acba ,shade )+_fbce (_eaed ,shade );
};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func FromSTCoordinate32 (st _efa .ST_Coordinate32 )int64 {if _dcea :=st .ST_Coordinate32Unqualified ;_dcea !=nil {return int64 (*_dcea );};return 0;};func _bebf (_ccca *_fg .CT_CatAx )(uint32 ,_fg .ST_AxPos ,_fg .ST_TickMark ,_fg .ST_TickLblPos ,*_fg .CT_ChartLines ,uint32 ,*_efa .CT_ShapeProperties ,error ){var _ace ,_dac uint32 ;
var _gcf _fg .ST_AxPos ;var _gfbe _fg .ST_TickMark ;var _bagg *_fg .CT_ChartLines ;var _bgf _fg .ST_TickLblPos ;if _ccca .AxId ==nil {return _ace ,_gcf ,_gfbe ,_bgf ,_bagg ,_dac ,_ccca .SpPr ,_fa .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_ace =_ccca .AxId .ValAttr ;};if _ccca .AxPos ==nil {return _ace ,_gcf ,_gfbe ,_bgf ,_bagg ,_dac ,_ccca .SpPr ,_fa .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_gcf =_ccca .AxPos .ValAttr ;
};if _ccca .MajorTickMark !=nil {_gfbe =_ccca .MajorTickMark .ValAttr ;};if _ccca .TickLblPos !=nil {_bgf =_ccca .TickLblPos .ValAttr ;};if _ccca .CrossAx ==nil {return _ace ,_gcf ,_gfbe ,_bgf ,_bagg ,_dac ,_ccca .SpPr ,_fa .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_dac =_ccca .CrossAx .ValAttr ;};_bagg =_ccca .MajorGridlines ;return _ace ,_gcf ,_gfbe ,_bgf ,_bagg ,_dac ,_ccca .SpPr ,nil ;};func RegisterFont (name string ,style FontStyle ,font *_eea .PdfFont ){_eecb ._baed .Lock ();if _eecb ._dcc [name ]==nil {_eecb ._dcc [name ]=map[FontStyle ]*_eea .PdfFont {};
};_eecb ._dcc [name ][style ]=font ;_eecb ._baed .Unlock ();};func RegisterFontsFromFiles (files []string )error {for _ ,_caccd :=range files {if _bc .HasSuffix (_caccd ,"\u002e\u0074\u0074\u0066"){_fbbb :=_cbfb (_caccd );if _fbbb !=nil {_a .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_fbbb );
continue ;};};};return nil ;};func _gfee (_bfbe ,_bgcg ,_fedf float64 )(uint8 ,uint8 ,uint8 ){var _age float64 ;if _fedf < 0.5{_age =_fedf *(1+_bgcg );}else {_age =_fedf +_bgcg -_fedf *_bgcg ;};_ggf :=_fedf *2-_age ;_bfbe /=360.0;_afeb :=_bdaa (_bfbe +1.0/3.0);
_bcbd :=_bdaa (_bfbe );_gffc :=_bdaa (_bfbe -1.0/3.0);_baga :=_eda (_afeb ,_age ,_ggf );_daaa :=_eda (_bcbd ,_age ,_ggf );_gbab :=_eda (_gffc ,_age ,_ggf );return uint8 (255*_baga ),uint8 (255*_daaa ),uint8 (255*_gbab );};var _cgc =_eed (1.5);type fontsMap struct{_baed *_bd .Mutex ;
_dcc map[string ]map[FontStyle ]*_eea .PdfFont ;};var DefaultFontSize =12.0;var _bbe =_eed (5);func RegisterFontsFromDirectory (dirName string )error {_bfa ,_becd :=_f .Open (dirName );if _becd !=nil {return _becd ;};defer _bfa .Close ();_ega ,_becd :=_bfa .Readdirnames (0);
if _becd !=nil {return _becd ;};for _ ,_fdbe :=range _ega {if _bc .HasSuffix (_fdbe ,"\u002e\u0074\u0074\u0066"){_abe :=dirName +"\u002f"+_fdbe ;_ebff :=_cbfb (_abe );if _ebff !=nil {_a .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_ebff );
continue ;};};};return nil ;};func _efcg (_bdc *_fg .CT_SerAx )(uint32 ,_fg .ST_AxPos ,_fg .ST_TickMark ,_fg .ST_TickLblPos ,*_fg .CT_ChartLines ,uint32 ,*_efa .CT_ShapeProperties ,error ){var _abda ,_dgacg uint32 ;var _decc _fg .ST_AxPos ;var _bca _fg .ST_TickMark ;
var _gfea *_fg .CT_ChartLines ;var _dda _fg .ST_TickLblPos ;if _bdc .AxId ==nil {return _abda ,_decc ,_bca ,_dda ,_gfea ,_dgacg ,_bdc .SpPr ,_fa .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_abda =_bdc .AxId .ValAttr ;
};if _bdc .AxPos ==nil {return _abda ,_decc ,_bca ,_dda ,_gfea ,_dgacg ,_bdc .SpPr ,_fa .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_decc =_bdc .AxPos .ValAttr ;};if _bdc .MajorTickMark !=nil {_bca =_bdc .MajorTickMark .ValAttr ;
};if _bdc .TickLblPos !=nil {_dda =_bdc .TickLblPos .ValAttr ;};if _bdc .CrossAx ==nil {return _abda ,_decc ,_bca ,_dda ,_gfea ,_dgacg ,_bdc .SpPr ,_fa .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_dgacg =_bdc .CrossAx .ValAttr ;
};_gfea =_bdc .MajorGridlines ;return _abda ,_decc ,_bca ,_dda ,_gfea ,_dgacg ,_bdc .SpPr ,nil ;};type barSerByOrder []*_fg .CT_BarSer ;func GetImage (c *_af .Creator ,goImg _be .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_af .Image ,error ){if goImg ==nil {return nil ,nil ;
};_gbd :=goImg .Bounds ().Size ();_fcgg :=_gbd .X ;_eadb :=_gbd .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_fcgg );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_eadb );};var _fabaf _be .Rectangle ;switch part {case ImgPart_t :_fabaf =_be .Rect (0,0,_fcgg ,int (dividerY ));
case ImgPart_b :_fabaf =_be .Rect (0,int (dividerY ),_fcgg ,_eadb );case ImgPart_l :_fabaf =_be .Rect (0,0,int (dividerX ),_eadb );case ImgPart_r :_fabaf =_be .Rect (int (dividerX ),0,_fcgg ,_eadb );case ImgPart_lt :_fabaf =_be .Rect (0,0,int (dividerX ),int (dividerY ));
case ImgPart_rt :_fabaf =_be .Rect (int (dividerX ),0,_fcgg ,int (dividerY ));case ImgPart_lb :_fabaf =_be .Rect (0,int (dividerY ),int (dividerX ),_eadb );case ImgPart_rb :_fabaf =_be .Rect (int (dividerX ),int (dividerY ),_fcgg ,_eadb );default:_fabaf =_be .Rect (0,0,_fcgg ,_eadb );
};_adfb :=CropImageByRect (goImg ,_fabaf );_ddad ,_eeg :=c .NewImageFromGoImage (_adfb );if _eeg !=nil {return nil ,_eeg ;};_ddad .Scale (imgWidth /float64 (_fcgg ),imgHeight /float64 (_eadb ));_ddad .SetPos (left ,top );return _ddad ,nil ;};func GetOpacityFromColorTransform (trs []*_efa .EG_ColorTransform )float64 {for _ ,_eaee :=range trs {if _eaee !=nil {if _ebf :=_eaee .Alpha ;
_ebf !=nil {if _daca :=_ebf .ValAttr .ST_PositiveFixedPercentageDecimal ;_daca !=nil {return float64 (*_daca )/100000;};};};};return 1.0;};type creatorContext struct{_gccf *_af .Creator ;_abff *_efa .Theme ;_gecag float64 ;};type serCategory struct{_dad string ;
_gff []serValue ;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func (_gcc *creatorContext )drawAxes (_ebd *_fg .CT_PlotAreaChoice1 ,_adgb ,_bec ,_abbf float64 ,_fcgb []string ,_fdcc *Rectangle ,_debe bool )error {_cabd :=_gcc ._gccf ;_fcee :=_gcc ._gecag ;
if _ebd ==nil {return _fa .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_ebd .ValAx )==0||(len (_ebd .CatAx )==0&&len (_ebd .DateAx )==0&&len (_ebd .SerAx )==0){return _fa .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _ggeb ,_fdb ,_dfd ,_dadd uint32 ;var _dfeg ,_fca _fg .ST_AxPos ;var _cgg ,_fegf _fg .ST_TickMark ;var _gdd ,_fgfb *_fg .CT_ChartLines ;var _fbca ,_ecb _fg .ST_TickLblPos ;var _cef ,_cff *_efa .CT_ShapeProperties ;var _ffa error ;_gfa :=_fdcc .Right -_fdcc .Left ;
_cdb :=_fdcc .Bottom -_fdcc .Top ;if len (_ebd .ValAx )> 0{_fdb ,_fca ,_fegf ,_ecb ,_fgfb ,_dadd ,_cff ,_ffa =_feda (_ebd .ValAx [0]);};if _fca !=_fg .ST_AxPosL &&_fca !=_fg .ST_AxPosB {return _fa .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_aefc :=_bec -_adgb ;_gag :=int (_aefc /_abbf )+1;var _bge ,_baeb float64 ;switch _fegf {case _fg .ST_TickMarkIn :_bge ,_baeb =_fggg ,0;case _fg .ST_TickMarkOut :_bge ,_baeb =0,_fggg ;case _fg .ST_TickMarkCross :_bge ,_baeb =_fggg ,_fggg ;};_bge =_bge *_fcee ;
_baeb =_baeb *_fcee ;var _bgbc *_efa .CT_ShapeProperties ;if _fgfb !=nil {_bgbc =_fgfb .SpPr ;};_adcbe ,_dgc :=_fbca !=_fg .ST_TickLblPosNone ,_ecb !=_fg .ST_TickLblPosNone ;_bcd :=_adgb ;if len (_ebd .CatAx )> 0{_ggeb ,_dfeg ,_cgg ,_fbca ,_gdd ,_dfd ,_cef ,_ffa =_bebf (_ebd .CatAx [0]);
}else if len (_ebd .DateAx )> 0{_ggeb ,_dfeg ,_cgg ,_fbca ,_gdd ,_dfd ,_cef ,_ffa =_aacf (_ebd .DateAx [0]);}else if len (_ebd .SerAx )> 0{_ggeb ,_dfeg ,_cgg ,_fbca ,_gdd ,_dfd ,_cef ,_ffa =_efcg (_ebd .SerAx [0]);};if _ffa !=nil {return _ffa ;};if _dfeg !=_fg .ST_AxPosL &&_dfeg !=_fg .ST_AxPosB {return _fa .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _ggeb !=_dadd ||_fdb !=_dfd {return _fa .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_fbdc :=len (_fcgb )+1;var _gee ,_egg float64 ;switch _cgg {case _fg .ST_TickMarkIn :_gee ,_egg =_fggg ,0;
case _fg .ST_TickMarkOut :_gee ,_egg =0,_fggg ;case _fg .ST_TickMarkCross :_gee ,_egg =_fggg ,_fggg ;};_gee =_gee *_fcee ;_egg =_egg *_fcee ;var _fcfd *_efa .CT_ShapeProperties ;if _gdd !=nil {_fcfd =_gdd .SpPr ;};if _debe {_gdb :=_cdb /float64 (len (_fcgb ));
_fff :=_fdcc .Left -_adgb *_gfa /_aefc ;_bbab :=_fff -_ccea *_fcee ;if _adcbe {var _ebga float64 ;for _geg :=0;_geg < _fbdc ;_geg ++{_dfb :=_fdcc .Bottom -float64 (_geg )*_gdb ;if _geg < _fbdc -1{_bcbf :=_cabd .NewParagraph (_fcgb [_geg ]);_bcbf .SetFontSize (_ggda *_fcee );
_bcbf .SetPos (_bbab ,_dfb -_gdb /2-_cgc *_fcee );_cabd .Draw (_bcbf );_ffab :=(_bcbf .Width ()/1000-_ccea )*_fcee ;if _ffab > 0&&_ffab > _ebga {_ebga =_ffab ;};};};if _ebga > 0{_fdcc .Left +=_ebga +_cacc ;_fff =_fdcc .Left -_adgb *_gfa /_aefc ;_gfa =_fdcc .Right -_fdcc .Left ;
};};_cca :=_fff -_egg ;_dbce :=_fff +_gee ;_efc :=_fdcc .Left ;_gfab :=_fdcc .Right ;for _dgcd :=0;_dgcd < _fbdc ;_dgcd ++{_dced :=_fdcc .Bottom -float64 (_dgcd )*_gdb ;_gcc .drawLineWithProps (_cef ,_cca ,_dced ,_dbce ,_dced ,true );_gcc .drawLineWithProps (_fcfd ,_efc ,_dced ,_gfab ,_dced ,true );
};_cecb :=_gfa /_aefc ;_cffd :=_fdcc .Bottom -_bge ;_cgee :=_fdcc .Bottom +_baeb ;_bcee :=_fdcc .Top ;_gac :=_fdcc .Bottom ;for _gbaf :=0;_gbaf < _gag ;_gbaf ++{_bga :=_fdcc .Left +(_bcd -_adgb )*_cecb ;_gcc .drawLineWithProps (_cff ,_bga ,_cffd ,_bga ,_cgee ,true );
_gcc .drawLineWithProps (_bgbc ,_bga ,_bcee ,_bga ,_gac ,true );if _dgc {_dag :=_cabd .NewParagraph (_cc .FormatFloat (_bcd ,'g',-1,64));_dag .SetFontSize (_ggda *_fcee );_dag .SetPos (_bga -_bae *_fcee ,_gac +_afc *_fcee );_cabd .Draw (_dag );};_bcd +=_abbf ;
};}else {_agg :=_cdb /_aefc ;_beff :=_fdcc .Left ;if _dgc {var _dcg float64 ;for _cdc :=0;_cdc < _gag ;_cdc ++{_aedd :=_fdcc .Bottom -(_bcd -_adgb )*_agg ;_dgab :=_cabd .NewParagraph (_cc .FormatFloat (_bcd ,'g',-1,64));_dgab .SetFontSize (_ggda *_fcee );
_dgab .SetPos (_beff -_ccea *_fcee ,_aedd -_cgc *_fcee );_cabd .Draw (_dgab );_eccb :=(_dgab .Width ()/1000-_ccea )*_fcee ;if _eccb > 0&&_eccb > _dcg {_dcg =_eccb ;};_bcd +=_abbf ;};if _dcg > 0{_fdcc .Left +=_dcg +_cacc ;_gfa =_fdcc .Right -_fdcc .Left ;
};};_bcd =_adgb ;_bfc :=_fdcc .Left -_baeb ;_bebb :=_fdcc .Left +_bge ;_beff =_fdcc .Left ;_dfc :=_fdcc .Right ;for _bfg :=0;_bfg < _gag ;_bfg ++{_dec :=_fdcc .Bottom -(_bcd -_adgb )*_agg ;_gcc .drawLineWithProps (_cff ,_bfc ,_dec ,_bebb ,_dec ,true );
_gcc .drawLineWithProps (_bgbc ,_beff ,_dec ,_dfc ,_dec ,true );_bcd +=_abbf ;};_cedc :=_gfa /float64 (len (_fcgb ));_cad :=_fdcc .Bottom +_adgb *_cdb /_aefc ;_gbg :=_cad -_gee ;_afa :=_cad +_egg ;_dee :=_fdcc .Top ;_dfbe :=_fdcc .Bottom ;_aafe :=_cad +_afc *_fcee ;
for _cbf :=0;_cbf < _fbdc ;_cbf ++{_fdgb :=_fdcc .Left +float64 (_cbf )*_cedc ;_gcc .drawLineWithProps (_cef ,_fdgb ,_gbg ,_fdgb ,_afa ,true );_gcc .drawLineWithProps (_fcfd ,_fdgb ,_dee ,_fdgb ,_dfbe ,true );if _adcbe &&_cbf < _fbdc -1{_gfd :=_cabd .NewParagraph (_fcgb [_cbf ]);
_gfd .SetFontSize (_ggda *_fcee );_gfd .SetPos (_fdgb +_bbe *_fcee ,_aafe );_cabd .Draw (_gfd );};};};return nil ;};func TwipsFromPoints (points float64 )float64 {return points /_ec .Twips };func _feda (_bace *_fg .CT_ValAx )(uint32 ,_fg .ST_AxPos ,_fg .ST_TickMark ,_fg .ST_TickLblPos ,*_fg .CT_ChartLines ,uint32 ,*_efa .CT_ShapeProperties ,error ){var _bbac ,_agc uint32 ;
var _fcd _fg .ST_AxPos ;var _bdg _fg .ST_TickMark ;var _aace *_fg .CT_ChartLines ;var _dbbd _fg .ST_TickLblPos ;if _bace .AxId ==nil {return _bbac ,_fcd ,_bdg ,_dbbd ,_aace ,_agc ,_bace .SpPr ,_fa .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_bbac =_bace .AxId .ValAttr ;};if _bace .AxPos ==nil {return _bbac ,_fcd ,_bdg ,_dbbd ,_aace ,_agc ,_bace .SpPr ,_fa .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_fcd =_bace .AxPos .ValAttr ;
};if _bace .MajorTickMark !=nil {_bdg =_bace .MajorTickMark .ValAttr ;};if _bace .TickLblPos !=nil {_dbbd =_bace .TickLblPos .ValAttr ;};if _bace .CrossAx ==nil {return _bbac ,_fcd ,_bdg ,_dbbd ,_aace ,_agc ,_bace .SpPr ,_fa .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_agc =_bace .CrossAx .ValAttr ;};_aace =_bace .MajorGridlines ;return _bbac ,_fcd ,_bdg ,_dbbd ,_aace ,_agc ,_bace .SpPr ,nil ;};func IsNoSpaceLanguage (symbol string )bool {for _ ,_gbba :=range symbol {if _d .Is (_d .Han ,_gbba ){return true ;};
};return false ;};func (_abab barSerByOrder )Swap (i ,j int ){_abab [i ],_abab [j ]=_abab [j ],_abab [i ]};func CropImageByRect (sourceImg _be .Image ,rect _be .Rectangle )_be .Image {_beea ,_bea ,_dacg ,_adgbf :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;
_cfag :=_be .NewNRGBA (_be .Rect (0,0,_dacg -_beea ,_adgbf -_bea ));for _aabd :=_beea ;_aabd < _dacg ;_aabd ++{for _gdgg :=_bea ;_gdgg < _adgbf ;_gdgg ++{_cfag .Set (_aabd -_beea ,_gdgg -_bea ,sourceImg .At (_aabd ,_gdgg ));};};return _cfag ;};func _eed (_bdcc float64 )float64 {return _bdcc *_ec .Millimeter };
func _aacf (_ecbb *_fg .CT_DateAx )(uint32 ,_fg .ST_AxPos ,_fg .ST_TickMark ,_fg .ST_TickLblPos ,*_fg .CT_ChartLines ,uint32 ,*_efa .CT_ShapeProperties ,error ){var _edeg ,_gfe uint32 ;var _eagg _fg .ST_AxPos ;var _cbac _fg .ST_TickMark ;var _fbb *_fg .CT_ChartLines ;
var _dgac _fg .ST_TickLblPos ;if _ecbb .AxId ==nil {return _edeg ,_eagg ,_cbac ,_dgac ,_fbb ,_gfe ,_ecbb .SpPr ,_fa .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_edeg =_ecbb .AxId .ValAttr ;};if _ecbb .AxPos ==nil {return _edeg ,_eagg ,_cbac ,_dgac ,_fbb ,_gfe ,_ecbb .SpPr ,_fa .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_eagg =_ecbb .AxPos .ValAttr ;};if _ecbb .MajorTickMark !=nil {_cbac =_ecbb .MajorTickMark .ValAttr ;};if _ecbb .TickLblPos !=nil {_dgac =_ecbb .TickLblPos .ValAttr ;};if _ecbb .CrossAx ==nil {return _edeg ,_eagg ,_cbac ,_dgac ,_fbb ,_gfe ,_ecbb .SpPr ,_fa .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_gfe =_ecbb .CrossAx .ValAttr ;};_fbb =_ecbb .MajorGridlines ;return _edeg ,_eagg ,_cbac ,_dgac ,_fbb ,_gfe ,_ecbb .SpPr ,nil ;};func _afg (_abef string )([]byte ,error ){_cccg :=_c .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");
_abef =_cccg .ReplaceAllString (_abef ,"");_acgaf :=[]rune (_abef );_cgfe :=[]byte {};for _efcb :=len (_acgaf )-2;_efcb >=0;_efcb -=2{_abce ,_acca :=_cc .ParseUint (string (_acgaf [_efcb ])+string (_acgaf [_efcb +1]),16,8);if _acca !=nil {return nil ,_acca ;
};_cgfe =append (_cgfe ,byte (_abce ));};return _cgfe ,nil ;};var _cda =_eed (0.125);var _bae =_eed (0.5);var _fggg =_eed (1);func (_fgc *creatorContext )addCatName (_cbg string ,_cee map[string ]serCategory ,_fadg *[]string ){if _ ,_fga :=_cee [_cbg ];
!_fga {_cee [_cbg ]=serCategory {_dad :_cbg ,_gff :[]serValue {}};*_fadg =append (*_fadg ,_cbg );};};func AdjustColorByTint (colorStr string ,tint float64 )string {var _ege ,_cfe ,_bbc uint8 ;_dddc ,_ :=_ba .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_ege ,&_cfe ,&_bbc );
if _dddc !=3{return "";};return _fadc (_ege ,tint )+_fadc (_cfe ,tint )+_fadc (_bbc ,tint );};func RegisterEmbeddedFonts (d *_ee .Document )error {_dbbde :=d .FontTable ();if _dbbde ==nil {return nil ;};for _ ,_add :=range _dbbde .Font {if _add .EmbedRegular !=nil {return _deed (d ,_add .NameAttr ,_add .EmbedRegular .IdAttr ,_add .EmbedRegular .FontKeyAttr );
};if _add .EmbedBold !=nil {return _deed (d ,_add .NameAttr ,_add .EmbedBold .IdAttr ,_add .EmbedBold .FontKeyAttr );};if _add .EmbedItalic !=nil {return _deed (d ,_add .NameAttr ,_add .EmbedItalic .IdAttr ,_add .EmbedItalic .FontKeyAttr );};if _add .EmbedBoldItalic !=nil {return _deed (d ,_add .NameAttr ,_add .EmbedBoldItalic .IdAttr ,_add .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};func MakeImageFromChartSpace (cs *_fg .ChartSpace ,width ,height float64 ,theme *_efa .Theme ,workbook *_ef .Workbook )(_be .Image ,error ){_fbec ,_fcea :=_fge (cs ,width ,height ,theme ,true ,workbook );if _fcea !=nil {return nil ,_fcea ;
};_ebg ,_fcea :=GetPageFromCreator (_fbec );if _fcea !=nil {return nil ,_fcea ;};return _ge .NewImageDevice ().Render (_ebg );};func AssignStdFontByName (style _af .TextStyle ,fontName string )*_eea .PdfFont {_gfad :=_eea .StdFontName (fontName );return _eea .NewStandard14FontMustCompile (_gfad );
};func (_bac barSerByOrder )Len ()int {return len (_bac )};var _eecb =fontsMap {_baed :&_bd .Mutex {},_dcc :map[string ]map[FontStyle ]*_eea .PdfFont {}};func (_ffcg *creatorContext )drawRectangleWithProps (_ggc *_efa .CT_ShapeProperties ,_bebc ,_efdb ,_eecbc ,_beedc float64 ,_dfbf bool ){_gfda :=_ffcg ._gccf .NewRectangle (_bebc ,_efdb ,_eecbc ,_beedc );
if _ggc ==nil {if _dfbf {_gfda .SetBorderWidth (_cda );}else {return ;};}else {_aca :=_ffcg .getPdfColorFromSolidFill (_ggc .SolidFill );if _aca !=nil {_gfda .SetFillColor (_aca );};if _bdcb :=_ggc .Ln ;_bdcb !=nil {if _dacd :=_bdcb .WAttr ;_dacd !=nil {_badd :=_ec .FromEMU (int64 (*_dacd ));
_gfda .SetBorderWidth (_badd );if _dgabd :=_bdcb .SolidFill ;_dgabd !=nil {_eddb :=_ffcg .getPdfColorFromSolidFill (_dgabd );if _eddb !=nil {_gfda .SetBorderColor (_eddb );};};}else {_gfda .SetBorderWidth (0);};};};_ffcg ._gccf .Draw (_gfda );};func (_fgf *creatorContext )drawTitle (_aaaa string ,_cage ,_aac float64 ){_eeaf :=_fgf ._gecag ;
_fdg :=_fgf ._gccf .NewStyledParagraph ();_beb :=_fdg .SetText (_aaaa );_fgab ,_agfe :=_eea .NewStandard14Font (_eea .HelveticaName );if _agfe ==nil {_abba :=_fgf ._gccf .NewTextStyle ();_abba .Font =_fgab ;_abba .FontSize =14;_abba .TextRise =0.4;_beb .Style =_abba ;
_fdg .SetPos (_cage -_fdg .Width ()*_eeaf /2,_aac );_fgf ._gccf .Draw (_fdg );};};func _fadc (_abc uint8 ,_ceb float64 )string {_adgc :=float64 (_abc );var _eff float64 ;if _ceb < 0{_eff =_adgc *(1+_ceb );}else {_eff =_adgc +(255-_adgc )*_ceb ;};return _ba .Sprintf ("\u0025\u0030\u0032\u0078",int (_eff ));
};var _cggc =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
func _fcc (_cadg _efa .ST_SchemeColorVal ,_efcd *_efa .Theme )string {if _gecc :=_efcd .ThemeElements ;_gecc !=nil {if _cdd :=_gecc .ClrScheme ;_cdd !=nil {switch _cadg {case _efa .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_cdd .Lt1 );case _efa .ST_SchemeColorValDk1 ,_efa .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_cdd .Dk1 );
case _efa .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_cdd .Lt2 );case _efa .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_cdd .Dk2 );case _efa .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_cdd .Accent1 );case _efa .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_cdd .Accent2 );
case _efa .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_cdd .Accent3 );case _efa .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_cdd .Accent4 );case _efa .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_cdd .Accent5 );
case _efa .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_cdd .Accent6 );};};};return "";};func (_dfgb *creatorContext )drawLegend (_cgf *Rectangle ,_ggb []*legendItem ,_bbd bool ){_ggd :=_dfgb ._gecag ;_bdb :=_eed (2.5)*_ggd ;_ccd :=_deg *_ggd ;
_deae :=(_bdb -_ccd )/2;_gce :=float64 (len (_ggb ));if _bbd {_aag :=&Rectangle {Top :_cgf .Top +_eed (1)*_ggd ,Bottom :_cgf .Bottom -_eed (1)*_ggd ,Left :_cgf .Left +_eed (2.5)*_ggd ,Right :_cgf .Right -_eed (2.5)*_ggd };var _daa float64 ;if _gce > 1{_daa =(_aag .Right -_aag .Left )/_gce ;
};_ddd :=_aag .Left ;_fdgc :=_aag .Top ;for _ ,_bdd :=range _ggb {if _fbda :=_bdd ._gda ;_fbda !=nil {_dfgb .drawRectangleWithProps (_fbda ,_ddd ,_fdgc +_deae ,_ccd ,_ccd ,false );_ddga :=_ddd +_ccd *2;_dfa :=_dfgb ._gccf .NewStyledParagraph ();_dfa .SetPos (_ddga ,_fdgc );
_gdaa :=_dfa .Append (_bdd ._bba );_fda ,_gade :=_eea .NewStandard14Font (_eea .HelveticaName );if _gade ==nil {_fbf :=_dfgb ._gccf .NewTextStyle ();_fbf .Font =_fda ;_fbf .FontSize =_bdb ;_fbf .TextRise =0.4;_gdaa .Style =_fbf ;_dfgb ._gccf .Draw (_dfa );
};};_ddd +=_daa ;};}else {_geab :=&Rectangle {Top :_cgf .Top +_eed (2.5)*_ggd ,Bottom :_cgf .Bottom -_eed (2.5)*_ggd ,Left :_cgf .Left +_eed (2.5)*_ggd ,Right :_cgf .Right -_eed (2.5)*_ggd };var _acdc float64 ;if _gce > 1{_acdc =(_geab .Bottom -_geab .Top -_bdb )/(_gce -1);
if _acdc < _bdb {_acdc =_bdb ;};};_ddb :=_geab .Top ;_gaf :=_geab .Left ;_gab :=_gaf +_ccd *2;for _ ,_daag :=range _ggb {if _gdg :=_daag ._gda ;_gdg !=nil {_dfgb .drawRectangleWithProps (_gdg ,_gaf ,_ddb +_deae ,_ccd ,_ccd ,false );_eae :=_dfgb ._gccf .NewStyledParagraph ();
_eae .SetPos (_gab ,_ddb );_eae .SetWidth (_geab .Right -_geab .Left );_fgff :=_eae .Append (_daag ._bba );_adcb ,_dba :=_eea .NewStandard14Font (_eea .HelveticaName );if _dba ==nil {_ced :=_dfgb ._gccf .NewTextStyle ();_ced .Font =_adcb ;_ced .FontSize =_bdb ;
_ced .TextRise =0.4;_fgff .Style =_ced ;_dfgb ._gccf .Draw (_eae );};};_ddb +=_acdc ;};};};func _cbfb (_gcdd string )error {if !_bc .HasSuffix (_gcdd ,"\u002e\u0074\u0074\u0066"){_a .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _ba .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_faba ,_dbad :=_fb .ParseFile (_gcdd );if _dbad !=nil {_a .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_dbad );return _dbad ;};_dfda ,_dbad :=_eea .NewCompositePdfFontFromTTFFile (_gcdd );
if _dbad !=nil {return _dbad ;};_dcee :=_faba .GetNameRecords ();for _ ,_bagf :=range _dcee {_gfbb :=_bagf [1];if _gfbb ==""{continue ;};_dfaa :=make ([]byte ,0);for _cebe :=0;_cebe < len (_gfbb );_cebe ++{if _gfbb [_cebe ]==39||_gfbb [_cebe ]==92{continue ;
};_abaa :=4;if _cebe +_abaa < len (_gfbb ){if _gfbb [_cebe :_cebe +_abaa ]=="\u0000"{_cebe =_cebe +_abaa +1;continue ;};};_dfaa =append (_dfaa ,_gfbb [_cebe ]);};_gfbb =_bc .Replace (string (_dfaa ),"\u0078\u0030\u0030","",-1);_fdce :=_bagf [2];if _fdce ==""{return _ba .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_gcdd );
};_dfaa =make ([]byte ,0);for _bcf :=0;_bcf < len (_fdce );_bcf ++{if _fdce [_bcf ]==39||_fdce [_bcf ]==92{continue ;};_daae :=4;if _bcf +_daae < len (_fdce ){if _fdce [_bcf :_bcf +_daae ]=="\u0000"{_bcf =_bcf +_daae +1;continue ;};};_dfaa =append (_dfaa ,_fdce [_bcf ]);
};_fdce =_bc .Replace (string (_dfaa ),"\u0078\u0030\u0030","",-1);RegisterFont (_gfbb ,_cggc [_fdce ],_dfda );};return nil ;};type FontStyle byte ;func (_aeb *creatorContext )drawPieChart (_cdce *_fg .CT_PieChart ,_ebge *Rectangle ,_ebbg *_ef .Workbook ,_cadge float64 )([]*legendItem ,error ){_aab :=[]*legendItem {};
_afgf :=map[string ]serCategory {};_gae :=[]string {};_gcb :=_db .Inf (1);_fgb :=_db .Inf (-1);_geced :=_cdce .Ser ;for _ ,_gefc :=range _geced {var _fegde string ;if _bgcd :=_gefc .Tx ;_bgcd !=nil {if _gfg :=_bgcd .Choice ;_gfg !=nil {if _gfg .V !=nil {_fegde =*_gfg .V ;
}else if _bfgf :=_gfg .StrRef ;_bfgf !=nil {if _fdaf :=_bfgf .StrCache ;_fdaf !=nil {for _ ,_bfbf :=range _fdaf .Pt {_fegde =_bfbf .V ;};};};};};if _abcc :=_gefc .Cat ;_abcc !=nil {if _abaac :=_abcc .Choice ;_abaac !=nil {if _fde :=_abaac .StrRef ;_fde !=nil {if _dcfe :=_fde .F ;
_dcfe !=""&&_ebbg !=nil {_baf ,_fagf ,_ecf ,_geca :=ParseExcelRange (_dcfe );if _geca ==nil {for _ ,_edb :=range _ebbg .Sheets (){if _edb .Name ()==_bc .Trim (_baf ,"\u0027"){_gde :=_fagf .String ();for _gcea :=_fagf .RowIdx ;_gcea <=_ecf .RowIdx ;_gcea +=1{_ggge :=_bc .ReplaceAll (_gde ,_ba .Sprint (_fagf .RowIdx ),_ba .Sprint (_gcea ));
_aeb .addCatName (_edb .Cell (_ggge ).GetString (),_afgf ,&_gae );};break ;};};};};if _caeb :=_fde .StrCache ;_caeb !=nil {for _ ,_cde :=range _caeb .Pt {_aeb .addCatName (_cde .V ,_afgf ,&_gae );};};}else if _cade :=_abaac .NumRef ;_cade !=nil {if _cbff :=_cade .NumCache ;
_cbff !=nil {var _ebfb string ;if _cbff .FormatCode !=nil {_ebfb =*_cbff .FormatCode ;};for _ ,_ffc :=range _cbff .Pt {var _acec string ;if _ffc .FormatCodeAttr ==nil {_acec =_ebfb ;}else {_acec =*_ffc .FormatCodeAttr ;};var _fcfg string ;_aded ,_gaea :=_cc .ParseFloat (_ffc .V ,64);
if _gaea !=nil {_fcfg =_ffc .V ;}else {_fcfg =_ab .Number (_aded ,_acec );};_aeb .addCatName (_fcfg ,_afgf ,&_gae );};};};};};if _abdab :=_gefc .Val ;_abdab !=nil {if _ded :=_abdab .Choice ;_ded !=nil {if _ddgac :=_ded .NumRef ;_ddgac !=nil {if _gdab :=_ddgac .F ;
_gdab !=""&&_ebbg !=nil {_bfe ,_gca ,_gabc ,_egb :=ParseExcelRange (_gdab );if _egb ==nil {for _ ,_gbcd :=range _ebbg .Sheets (){if _gbcd .Name ()==_bc .Trim (_bfe ,"\u0027"){_beg :=_gca .String ();for _ccba :=_gca .RowIdx ;_ccba <=_gabc .RowIdx ;_ccba +=1{_daaef :=_bc .ReplaceAll (_beg ,_ba .Sprint (_gca .RowIdx ),_ba .Sprint (_ccba ));
if _gbcd .FormulaContext ().HasFormula (_daaef ){_fecb :=_ca .NewEvaluator ();_gbcdf :=_gbcd .FormulaContext ().Cell (_daaef ,_fecb );_dgdg :=_gbcdf .Value ();_aeb .addCatValue (_dgdg ,_afgf ,_gae ,(int )(_ccba -_gca .RowIdx ),&_gcb ,&_fgb ,_fegde ,_gefc .SpPr );
}else {_egba :=_gbcd .Cell (_daaef ).GetString ();_aeb .addCatValue (_egba ,_afgf ,_gae ,(int )(_ccba -_gca .RowIdx ),&_gcb ,&_fgb ,_fegde ,_gefc .SpPr );};};break ;};};};};if _gcef :=_ddgac .NumCache ;_gcef !=nil {for _fba ,_dbag :=range _gcef .Pt {_aeb .addCatValue (_dbag .V ,_afgf ,_gae ,_fba ,&_gcb ,&_fgb ,_fegde ,_gefc .SpPr );
};};};};};};_dgcf :=&_ad .PieChart {Values :[]_df .Value {}};for _ ,_ffcc :=range _gae {_fgbf :=_afgf [_ffcc ];if len (_fgbf ._gff )> 0{_dgcf .Values =append (_dgcf .Values ,_df .Value {Value :_fgbf ._gff [0]._ebeg ,Label :_ffcc ,Style :_g .Style {FontSize :12*_cadge }});
};};_dgcf .SetHeight (int (_ebge .Top -_ebge .Bottom ));_dgcf .SetWidth (int (_ebge .Right -_ebge .Left ));_gfdg :=_aeb ._gccf ;_acce :=_af .NewChart (_dgcf );_acce .SetPos (_ebge .Left ,_ebge .Top );_ebega :=_gfdg .Draw (_acce );if _ebega !=nil {return nil ,_ebega ;
};return _aab ,nil ;};func GetColorStringFromDmlColor (dmlColor *_efa .CT_Color )string {var _gga string ;if _bbf :=dmlColor .SrgbClr ;_bbf !=nil {_gga =_bbf .ValAttr ;}else if _gcd :=dmlColor .SysClr ;_gcd !=nil {if _gcd .LastClrAttr !=nil {return *_gcd .LastClrAttr ;
};return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _gga ;};func (_adf FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_adf )];
};func (_cag *creatorContext )addCatValue (_dea string ,_ged map[string ]serCategory ,_cab []string ,_aeeg int ,_aefe ,_dbda *float64 ,_fdc string ,_aba *_efa .CT_ShapeProperties ){_beeb ,_fgac :=_cc .ParseFloat (_dea ,64);if _fgac !=nil {_beeb =0;_a .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_fgac );
};if _beeb > *_dbda {*_dbda =_beeb ;};if _beeb < *_aefe {*_aefe =_beeb ;};_ade :=_ged [_cab [_aeeg ]];_ade ._gff =append (_ade ._gff ,serValue {_gad :_fdc ,_ebeg :_beeb ,_gc :_aba });_ged [_cab [_aeeg ]]=_ade ;};func _gefd (_ebbd _efa .ST_SchemeColorVal ,_cgdd *_efa .Theme )string {if _fbdce :=_cgdd .ThemeElements ;
_fbdce !=nil {if _fggc :=_fbdce .ClrScheme ;_fggc !=nil {switch _ebbd {case _efa .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_fggc .Lt1 );case _efa .ST_SchemeColorValDk1 ,_efa .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_fggc .Dk1 );
case _efa .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_fggc .Lt2 );case _efa .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_fggc .Dk2 );case _efa .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_fggc .Accent1 );case _efa .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_fggc .Accent2 );
case _efa .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_fggc .Accent3 );case _efa .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_fggc .Accent4 );case _efa .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_fggc .Accent5 );
case _efa .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_fggc .Accent6 );};};};return "";};func ClearRegisteredFonts (){_eecb ._baed .Lock ();_eecb ._dcc =map[string ]map[FontStyle ]*_eea .PdfFont {};_eecb ._baed .Unlock ();};func GetGroupOffsetFromXfrm (xfrm *_efa .CT_GroupTransform2D )(float64 ,float64 ){var _fddd ,_dgg float64 ;
if xfrm .Off !=nil &&xfrm .ChOff !=nil {_fddd =_ec .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_ec .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));_dgg =_ec .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_ec .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));
};return _fddd ,_dgg ;};func AdjustColor (colorStr string ,EG_ColorTransform []*_efa .EG_ColorTransform )string {for _ ,_cfd :=range EG_ColorTransform {if _bacd :=_cfd .Tint ;_bacd !=nil {if _acdf :=_bacd .ValAttr .ST_PositiveFixedPercentageDecimal ;_acdf !=nil {colorStr =AdjustColorByTint (colorStr ,float64 (*_acdf )/100000);
};};if _bed :=_cfd .Shade ;_bed !=nil {if _bbea :=_bed .ValAttr .ST_PositiveFixedPercentageDecimal ;_bbea !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_bbea )/100000);};};if _egfc :=_cfd .LumMod ;_egfc !=nil {if _fbfb :=_egfc .ValAttr .ST_PercentageDecimal ;
_fbfb !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_fbfb )/100000);};};};return colorStr ;};func _accc (_eec ,_gcee ,_babc uint8 )(float64 ,float64 ,float64 ){_fadf ,_abf ,_gbb :=float64 (_eec )/255,float64 (_gcee )/255,float64 (_babc )/255;
_fcb :=_fadf ;if _abf < _fcb {_fcb =_abf ;};if _gbb < _fcb {_fcb =_gbb ;};var _badg ,_ecdb bool ;_gafc :=_fadf ;if _abf > _gafc {_gafc =_abf ;_badg =true ;};if _gbb > _gafc {_gafc =_gbb ;_badg =false ;_ecdb =true ;};_gdgf :=(_fcb +_gafc )/2;var _cdaa float64 ;
if _fcb !=_gafc {if _gdgf <=0.5{_cdaa =(_gafc -_fcb )/(_gafc +_fcb );}else {_cdaa =(_gafc -_fcb )/(2.0-_gafc -_fcb );};};var _ddgd float64 ;if _fcb !=_gafc {if _badg {_ddgd =2.0+(_gbb -_fadf )/(_gafc -_fcb );}else if _ecdb {_ddgd =4.0+(_fadf -_abf )/(_gafc -_fcb );
}else {_ddgd =(_abf -_gbb )/(_gafc -_fcb );};_ddgd *=60;if _ddgd < 0{_ddgd +=360;};};return _ddgd ,_cdaa ,_gdgf ;};func _bdaa (_gece float64 )float64 {if _gece < 0{_gece +=float64 (-int (_gece )+1);}else if _gece > 1{_gece -=float64 (int (_gece ));};return _gece ;
};func FillRectangle (c *_af .Creator ,x ,y ,width ,height float64 ,color _af .Color ){if color ==nil {return ;};_cbe :=c .NewRectangle (x ,y ,width ,height );_cbe .SetFillColor (color );_cbe .SetBorderWidth (0);c .Draw (_cbe );};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_ec .Twips *10+0.5))/10;
};func (_adb *creatorContext )getPdfColorFromSolidFill (_dfea *_efa .CT_SolidColorFillProperties )_af .Color {if _dfea ==nil {return nil ;};_cdac :="";if _aede :=_dfea .SrgbClr ;_aede !=nil {_cdac =_aede .ValAttr ;}else if _eddbb :=_dfea .SchemeClr ;_eddbb !=nil {_cdac =_gefd (_eddbb .ValAttr ,_adb ._abff );
};if _cdac ==""{return nil ;};return _af .ColorRGBFromHex ("\u0023"+_cdac );};func MakeTempCreator (width ,height float64 )*_af .Creator {_gfba :=_af .New ();_gfba .SetPageSize (_af .PageSize {width ,height });_gfba .SetPageMargins (0,0,0,0);return _gfba ;
};func (_gefa *creatorContext )drawLineWithProps (_eaa *_efa .CT_ShapeProperties ,_ggga ,_aegf ,_afdf ,_baa float64 ,_daad bool ){if _eaa !=nil {if _eca :=_eaa .Ln ;_eca !=nil {_gfge :=_gefa .getPdfColorFromSolidFill (_eca .SolidFill );if _gfge ==nil &&_daad {_gfge =_af .ColorBlack ;
};if _gfge !=nil {var _ceed float64 ;if _aff :=_eca .WAttr ;_aff !=nil {_ceed =_ec .FromEMU (int64 (*_aff ));}else {_ceed =_cda ;};DrawLine (_gefa ._gccf ,_ggga ,_aegf ,_afdf ,_baa ,_ceed ,_gfge );};};};};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;
FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func MakeTempCreatorMaxHeight (width float64 )*_af .Creator {return MakeTempCreator (width ,_db .MaxFloat64 );};func _eda (_abfc ,_eeb ,_agfeb float64 )float64 {if _abfc *6< 1{return _agfeb +(_eeb -_agfeb )*6*_abfc ;
}else if _abfc *2< 1{return _eeb ;}else if _abfc *3< 2{return _agfeb +(_eeb -_agfeb )*(2.0/3.0-_abfc )*6;}else {return _agfeb ;};};type BorderPosition byte ;func (_cfg *creatorContext )drawBorderWithProps (_dgde *_efa .CT_ShapeProperties ,_cfa *Rectangle ,_dff float64 ){if _cfa !=nil &&_dgde !=nil &&_dgde .Ln !=nil &&_dgde .Ln .SolidFill !=nil {_eaea :=_cfg .getPdfColorFromSolidFill (_dgde .Ln .SolidFill );
DrawRectangle (_cfg ._gccf ,_cfa ,_dff ,_eaea );};};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _bde ,_bad ,_geba uint8 ;_agfd ,_ :=_ba .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_bde ,&_bad ,&_geba );
if _agfd !=3{return "";};_fggd ,_bgdc ,_bfb :=_accc (_bde ,_bad ,_geba );_bfb =lum *_bfb ;_bde ,_bad ,_geba =_gfee (_fggd ,_bgdc ,_bfb );return _ba .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_bde ,_bad ,_geba );};type serValue struct{_gad string ;
_ebeg float64 ;_gc *_efa .CT_ShapeProperties ;};func _fge (_aeg *_fg .ChartSpace ,_adg ,_gdac float64 ,_afe *_efa .Theme ,_gbc bool ,_ddf *_ef .Workbook )(*_af .Creator ,error ){_fea :=1.0;if _gbc {_fea =8.0;};_ccfb :=&Rectangle {};_cgdc :=&Rectangle {Top :_ccfb .Top ,Bottom :_gdac -_ccfb .Bottom ,Left :_ccfb .Left ,Right :_adg -_ccfb .Right };
_dcd :=MakeTempCreator (_adg *_fea +1,_gdac *_fea +1);_bgd :=&creatorContext {_gccf :_dcd ,_abff :_afe ,_gecag :_fea };var _caf bool ;if _afba :=_aeg .Chart ;_afba !=nil {_ecd :=_afba .PlotArea ;if _ecd ==nil {return nil ,_fa .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");
};_fec :=0.0;if _afba .AutoTitleDeleted !=nil &&_afba .AutoTitleDeleted .ValAttr !=nil &&!*_afba .AutoTitleDeleted .ValAttr {_cec :="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";if _afba .Title !=nil &&_afba .Title .Overlay !=nil &&_afba .Title .Overlay .ValAttr !=nil &&!*_afba .Title .Overlay .ValAttr {_fec =_eed (10);
};if _afba .Title !=nil &&_afba .Title .Tx !=nil &&_afba .Title .Tx .Choice !=nil &&_afba .Title .Tx .Choice .Rich !=nil {if len (_afba .Title .Tx .Choice .Rich .P )> 0{if len (_afba .Title .Tx .Choice .Rich .P [0].EG_TextRun )> 0{_cec =_afba .Title .Tx .Choice .Rich .P [0].EG_TextRun [0].R .T ;
};};};_bgd .drawTitle (_cec ,_cgdc .Left +_cgdc .Right /2,_eed (5));};_dbbc :=&Rectangle {Top :_eed (10)+_fec ,Bottom :_cgdc .Bottom -_eed (15),Left :_eed (10),Right :_cgdc .Right -_eed (10)};var _fbga *Rectangle ;_egf :=_afba .Legend ;if _egf !=nil {_aaf :=_egf .Overlay !=nil &&_egf .Overlay .ValAttr !=nil &&*_egf .Overlay .ValAttr ;
if _bce :=_egf .LegendPos ;_bce !=nil {switch _bce .ValAttr {case _fg .ST_LegendPosTr :if !_aaf {_dbbc =&Rectangle {Top :_eed (25)+_fec ,Bottom :_cgdc .Bottom -_eed (10),Left :_eed (10),Right :_cgdc .Right -_eed (25)};};_fbga =&Rectangle {Top :_eed (2.5)+_fec ,Bottom :_eed (22.5),Left :_cgdc .Right -_eed (22.5),Right :_cgdc .Right -_eed (2.5)};
case _fg .ST_LegendPosT :_fbga =&Rectangle {Top :_eed (2.5)+_fec ,Bottom :_eed (7.5),Left :(_cgdc .Right -_cgdc .Left )*0.25,Right :(_cgdc .Right -_cgdc .Left )*0.75};if !_aaf {_dbbc =&Rectangle {Top :_eed (12.5)+_fec ,Bottom :_cgdc .Bottom -_eed (15),Left :_eed (10),Right :_cgdc .Right -_eed (5)};
};_caf =true ;case _fg .ST_LegendPosB :_fbga =&Rectangle {Top :_cgdc .Bottom -_eed (7.5)+_fec ,Bottom :_cgdc .Bottom -_eed (2.5),Left :(_cgdc .Right -_cgdc .Left )*0.25,Right :(_cgdc .Right -_cgdc .Left )*0.75};if !_aaf {_dbbc =&Rectangle {Top :_eed (5)+_fec ,Bottom :_cgdc .Bottom -_eed (15),Left :_eed (10),Right :_cgdc .Right -_eed (5)};
};_caf =true ;case _fg .ST_LegendPosR :_fbga =&Rectangle {Top :(_cgdc .Bottom -_cgdc .Top )/2-_eed (10)+_fec ,Bottom :(_cgdc .Bottom -_cgdc .Top )/2+_eed (10),Left :_cgdc .Right -_eed (22.5),Right :_cgdc .Right -_eed (2.5)};if !_aaf {_dbbc =&Rectangle {Top :_eed (5)+_fec ,Bottom :_cgdc .Bottom -_eed (12.5),Left :_eed (10),Right :_cgdc .Right -_eed (25)};
};case _fg .ST_LegendPosL :_fbga =&Rectangle {Top :(_cgdc .Bottom -_cgdc .Top )/2-_eed (10)+_fec ,Bottom :(_cgdc .Bottom -_cgdc .Top )/2+_eed (10),Left :_eed (2.5),Right :_eed (22.5)};if !_aaf {_dbbc =&Rectangle {Top :_eed (5)+_fec ,Bottom :_cgdc .Bottom -_eed (12.5),Left :_eed (30),Right :_cgdc .Right -_eed (5)};
};default:_fbga =&Rectangle {Top :(_cgdc .Bottom -_cgdc .Top )/2-_eed (10)+_fec ,Bottom :(_cgdc .Bottom -_cgdc .Top )/2+_eed (10),Left :_cgdc .Right -_eed (25),Right :_cgdc .Right -_eed (5)};if !_aaf {_dbbc =&Rectangle {Top :_eed (5)+_fec ,Bottom :_cgdc .Bottom -_eed (12.5),Left :_eed (100),Right :_cgdc .Right -_eed (25)};
};};};};_dbbc .scale (_fea );_bgd .drawBorderWithProps (_ecd .SpPr ,_dbbc ,_cda );_ggef :=[]*legendItem {};var _dgf error ;_ede :=_ecd .CChoice ;for _ ,_ccc :=range _ecd .Choice {if _dabf :=_ccc .BarChart ;_dabf !=nil {_ggef ,_dgf =_bgd .drawBarChart (_dabf ,_dbbc ,_ede ,_ddf );
if _dgf !=nil {return nil ,_dgf ;};};if _gba :=_ccc .PieChart ;_gba !=nil {_ggef ,_dgf =_bgd .drawPieChart (_gba ,_dbbc ,_ddf ,_fea );if _dgf !=nil {return nil ,_dgf ;};};};if _egf !=nil {_fbga .scale (_fea );_bgd .drawBorderWithProps (_egf .SpPr ,_fbga ,_cda );
if len (_ggef )!=0{_bgd .drawLegend (_fbga ,_ggef ,_caf );};};};_cgdc .scale (_fea );_bgd .drawBorderWithProps (_aeg .SpPr ,_cgdc ,_cda );return _dcd ,nil ;};func FromSTPercentage (st *_efa .ST_Percentage )float64 {if _dcgc :=st .ST_PercentageDecimal ;
_dcgc !=nil {return float64 (*_dcgc )/100000;};return 0;};func DrawRectangle (c *_af .Creator ,r *Rectangle ,w float64 ,color _af .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );
DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};func MakeBlockFromCreator (c *_af .Creator )(*_af .Block ,error ){_fffd ,_dgb :=GetPageFromCreator (c );if _dgb !=nil {return nil ,_dgb ;
};_effe ,_dgb :=_af .NewBlockFromPage (_fffd );if _dgb !=nil {return nil ,_dgb ;};return _effe ,nil ;};var _cacc =_eed (2);func _fbce (_fbff uint8 ,_fae float64 )string {_fbbe :=float64 (_fbff );return _ba .Sprintf ("\u0025\u0030\u0032\u0078",int (_fbbe *_fae ));
};func ParseExcelRange (s string )(string ,_ccf .CellReference ,_ccf .CellReference ,error ){_dfce :=_bc .FieldsFunc (s ,func (_afgb rune )bool {return _afgb ==':'||_afgb =='!'});if len (_dfce )==3{_ddgaca ,_dbae :=_ccf .ParseCellReference (_dfce [1]);
if _dbae !=nil {return "",_ccf .CellReference {},_ccf .CellReference {},_dbae ;};_egd ,_dbae :=_ccf .ParseCellReference (_dfce [2]);if _dbae !=nil {return "",_ccf .CellReference {},_ccf .CellReference {},_dbae ;};return _dfce [0],_ddgaca ,_egd ,nil ;};
return "",_ccf .CellReference {},_ccf .CellReference {},_fa .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");};func GetPageFromCreator (c *_af .Creator )(*_eea .PdfPage ,error ){_dbeb :=_e .NewBuffer ([]byte {});
_bfde :=c .Write (_dbeb );if _bfde !=nil {return nil ,_bfde ;};_eada :=_e .NewReader (_dbeb .Bytes ());_gafa ,_bfde :=_eea .NewPdfReader (_eada );if _bfde !=nil {return nil ,_bfde ;};return _gafa .GetPage (1);};const (BorderPositionTop BorderPosition =0;
BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);const _ggda =6.0;type legendItem struct{_bba string ;_gda *_efa .CT_ShapeProperties ;};func (_ebb barSerByOrder )Less (i ,j int )bool {return _ebb [i ].Order .ValAttr < _ebb [j ].Order .ValAttr };
var _deg =_eed (1.5);var _ccea =_eed (7.5);