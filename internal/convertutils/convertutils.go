//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_eb "bytes";_ga "errors";_eg "fmt";_b "github.com/unidoc/unioffice/common/logger";_cb "github.com/unidoc/unioffice/document";_ceg "github.com/unidoc/unioffice/measurement";_dc "github.com/unidoc/unioffice/schema/soo/dml";_ee "github.com/unidoc/unioffice/schema/soo/dml/chart";
_ec "github.com/unidoc/unioffice/spreadsheet/format";_df "github.com/unidoc/unipdf/v3/creator";_ba "github.com/unidoc/unipdf/v3/model";_fbf "github.com/unidoc/unipdf/v3/render";_fbd "github.com/unidoc/unitype";_edb "image";_e "math";_g "os";_f "regexp";
_fb "sort";_ea "strconv";_ed "strings";_ce "sync";_c "unicode";);func RegisterFont (name string ,style FontStyle ,font *_ba .PdfFont ){_dfc ._daff .Lock ();if _dfc ._cgff [name ]==nil {_dfc ._cgff [name ]=map[FontStyle ]*_ba .PdfFont {};};_dfc ._cgff [name ][style ]=font ;
_dfc ._daff .Unlock ();};var _fbg =_ffcb (1.5);func _fgeg (_fged string )error {if !_ed .HasSuffix (_fged ,"\u002e\u0074\u0074\u0066"){_b .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _eg .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_eggg ,_bgc :=_fbd .ParseFile (_fged );if _bgc !=nil {_b .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_bgc );return _bgc ;};_bcbad ,_bgc :=_ba .NewCompositePdfFontFromTTFFile (_fged );
if _bgc !=nil {return _bgc ;};_bdce :=_eggg .GetNameRecords ();for _ ,_egcf :=range _bdce {_ebgd :=_egcf [1];if _ebgd ==""{continue ;};_ddgc :=make ([]byte ,0);for _ccc :=0;_ccc < len (_ebgd );_ccc ++{if _ebgd [_ccc ]==39||_ebgd [_ccc ]==92{continue ;};
_eca :=4;if _ccc +_eca < len (_ebgd ){if _ebgd [_ccc :_ccc +_eca ]=="\u0000"{_ccc =_ccc +_eca +1;continue ;};};_ddgc =append (_ddgc ,_ebgd [_ccc ]);};_ebgd =_ed .Replace (string (_ddgc ),"\u0078\u0030\u0030","",-1);_dcbb :=_egcf [2];if _dcbb ==""{return _eg .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_fged );
};_ddgc =make ([]byte ,0);for _beaf :=0;_beaf < len (_dcbb );_beaf ++{if _dcbb [_beaf ]==39||_dcbb [_beaf ]==92{continue ;};_bfg :=4;if _beaf +_bfg < len (_dcbb ){if _dcbb [_beaf :_beaf +_bfg ]=="\u0000"{_beaf =_beaf +_bfg +1;continue ;};};_ddgc =append (_ddgc ,_dcbb [_beaf ]);
};_dcbb =_ed .Replace (string (_ddgc ),"\u0078\u0030\u0030","",-1);RegisterFont (_ebgd ,_edfb [_dcbb ],_bcbad );};return nil ;};var _abd =_ffcb (1.5);type ImgPart byte ;type barSerByOrder []*_ee .CT_BarSer ;var _ae =_ffcb (0.125);func MakeTempCreator (width ,height float64 )*_df .Creator {_dbbb :=_df .New ();
_dbbb .SetPageSize (_df .PageSize {width ,height });_dbbb .SetPageMargins (0,0,0,0);return _dbbb ;};func _gba (_gcba float64 )float64 {if _gcba < 0{_gcba +=float64 (-int (_gcba )+1);}else if _gcba > 1{_gcba -=float64 (int (_gcba ));};return _gcba ;};func AdjustColor (colorStr string ,EG_ColorTransform []*_dc .EG_ColorTransform )string {for _ ,_bde :=range EG_ColorTransform {if _fbcf :=_bde .Tint ;
_fbcf !=nil {if _caec :=_fbcf .ValAttr .ST_PositiveFixedPercentageDecimal ;_caec !=nil {colorStr =AdjustColorByTint (colorStr ,float64 (*_caec )/100000);};};if _adcg :=_bde .Shade ;_adcg !=nil {if _cdeb :=_adcg .ValAttr .ST_PositiveFixedPercentageDecimal ;
_cdeb !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_cdeb )/100000);};};if _dgbb :=_bde .LumMod ;_dgbb !=nil {if _dbf :=_dgbb .ValAttr .ST_PercentageDecimal ;_dbf !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_dbf )/100000);};};};
return colorStr ;};func (_fgd *creatorContext )drawBorderWithProps (_gcefd *_dc .CT_ShapeProperties ,_gbf *Rectangle ,_bgfe float64 ){if _gbf !=nil &&_gcefd !=nil &&_gcefd .Ln !=nil &&_gcefd .Ln .SolidFill !=nil {_ageg :=_fgd .getPdfColorFromSolidFill (_gcefd .Ln .SolidFill );
DrawRectangle (_fgd ._cccg ,_gbf ,_bgfe ,_ageg );};};func _bca (_aaef *_ee .CT_CatAx )(uint32 ,_ee .ST_AxPos ,_ee .ST_TickMark ,_ee .ST_TickLblPos ,*_ee .CT_ChartLines ,uint32 ,*_dc .CT_ShapeProperties ,error ){var _fbgg ,_bbg uint32 ;var _bfbb _ee .ST_AxPos ;
var _fcg _ee .ST_TickMark ;var _dbaa *_ee .CT_ChartLines ;var _dce _ee .ST_TickLblPos ;if _aaef .AxId ==nil {return _fbgg ,_bfbb ,_fcg ,_dce ,_dbaa ,_bbg ,_aaef .SpPr ,_ga .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_fbgg =_aaef .AxId .ValAttr ;
};if _aaef .AxPos ==nil {return _fbgg ,_bfbb ,_fcg ,_dce ,_dbaa ,_bbg ,_aaef .SpPr ,_ga .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_bfbb =_aaef .AxPos .ValAttr ;};if _aaef .MajorTickMark !=nil {_fcg =_aaef .MajorTickMark .ValAttr ;
};if _aaef .TickLblPos !=nil {_dce =_aaef .TickLblPos .ValAttr ;};if _aaef .CrossAx ==nil {return _fbgg ,_bfbb ,_fcg ,_dce ,_dbaa ,_bbg ,_aaef .SpPr ,_ga .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bbg =_aaef .CrossAx .ValAttr ;
};_dbaa =_aaef .MajorGridlines ;return _fbgg ,_bfbb ,_fcg ,_dce ,_dbaa ,_bbg ,_aaef .SpPr ,nil ;};func _bcfa (_adf ,_bgg ,_gag float64 )float64 {if _adf *6< 1{return _gag +(_bgg -_gag )*6*_adf ;}else if _adf *2< 1{return _bgg ;}else if _adf *3< 2{return _gag +(_bgg -_gag )*(2.0/3.0-_adf )*6;
}else {return _gag ;};};type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};func (_cagg barSerByOrder )Len ()int {return len (_cagg )};var _cgeb =_ffcb (2);func (_fbb *creatorContext )drawBarChart (_baa *_ee .CT_BarChart ,_ff *Rectangle ,_fe *_ee .CT_PlotAreaChoice1 )([]*legendItem ,error ){var _be bool ;
if _dfe :=_baa .BarDir ;_dfe !=nil {_be =_dfe .ValAttr ==_ee .ST_BarDirBar ;};_dg :=_baa .Ser ;_fb .Sort (barSerByOrder (_dg ));_dgf :=map[string ]serCategory {};_bad :=[]string {};_dd :=[]*legendItem {};_ef :=_e .Inf (1);_gf :=_e .Inf (-1);for _ ,_eae :=range _dg {var _cbad string ;
if _a :=_eae .Tx ;_a !=nil {if _ag :=_a .Choice ;_ag !=nil {if _ag .V !=nil {_cbad =*_ag .V ;}else if _ad :=_ag .StrRef ;_ad !=nil {if _cc :=_ad .StrCache ;_cc !=nil {for _ ,_cf :=range _cc .Pt {_cbad =_cf .V ;};};};};};if _fg :=_eae .Cat ;_fg !=nil {if _cg :=_fg .Choice ;
_cg !=nil {if _ab :=_cg .StrRef ;_ab !=nil {if _eag :=_ab .StrCache ;_eag !=nil {for _ ,_ca :=range _eag .Pt {_de :=_ca .V ;if _ ,_fgf :=_dgf [_de ];!_fgf {_dgf [_de ]=serCategory {_ffdg :_de ,_baec :[]serValue {}};_bad =append (_bad ,_de );};};};}else if _fef :=_cg .NumRef ;
_fef !=nil {if _gfe :=_fef .NumCache ;_gfe !=nil {var _ac string ;if _gfe .FormatCode !=nil {_ac =*_gfe .FormatCode ;};for _ ,_bd :=range _gfe .Pt {var _abg string ;if _bd .FormatCodeAttr ==nil {_abg =_ac ;}else {_abg =*_bd .FormatCodeAttr ;};var _bee string ;
_eaga ,_dcd :=_ea .ParseFloat (_bd .V ,64);if _dcd !=nil {_bee =_bd .V ;}else {_bee =_ec .Number (_eaga ,_abg );};if _ ,_ggf :=_dgf [_bee ];!_ggf {_dgf [_bee ]=serCategory {_ffdg :_bee ,_baec :[]serValue {}};_bad =append (_bad ,_bee );};};};};};};if _cfe :=_eae .Val ;
_cfe !=nil {if _cgf :=_cfe .Choice ;_cgf !=nil {if _cea :=_cgf .NumRef ;_cea !=nil {if _bdc :=_cea .NumCache ;_bdc !=nil {for _edd ,_ccf :=range _bdc .Pt {_bae ,_dda :=_ea .ParseFloat (_ccf .V ,64);if _dda !=nil {_bae =0;_b .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_dda );
};if _bae > _gf {_gf =_bae ;};if _bae < _ef {_ef =_bae ;};_ege :=_dgf [_bad [_edd ]];_ege ._baec =append (_ege ._baec ,serValue {_eab :_cbad ,_aaff :_bae ,_abc :_eae .SpPr });_dgf [_bad [_edd ]]=_ege ;};};};};};_dd =append (_dd ,&legendItem {_cade :_cbad ,_afb :_eae .SpPr });
};var _acf float64 ;var _gga ,_eaef float64 ;if _gf ==0&&_ef ==0{_acf =0.2;_eaef =0;_gga =1;}else {var _db float64 ;if _bf :=_e .Abs (_ef );_gf < _bf {_db =_bf ;}else {_db =_gf ;};_cbg :=_e .Pow (10,_e .Floor (_e .Log10 (_db )));_acc :=_db /_cbg ;if _acc >=1.715&&_acc < 4.29{_acf =0.5;
}else if _acc >=4.29&&_acc < 8.58{_acf =1;}else {_acf =2;};_acf *=_cbg ;if _gf <=0{_gga =0;}else {_gga =(_e .Ceil (_gf /_acf )+1)*_acf ;};if _ef >=0{_eaef =0;}else {_eaef =(_e .Floor (_ef /_acf )-1)*_acf ;};};_fa :=_fbb .drawAxes (_fe ,_eaef ,_gga ,_acf ,_bad ,_ff ,_be );
if _fa !=nil {return nil ,_fa ;};_ge :=0.0;if _baa .GapWidth !=nil {if _gd :=_baa .GapWidth .ValAttr ;_gd !=nil {if _cce :=_gd .ST_GapAmountUShort ;_cce !=nil {_ge =float64 (*_cce )/100.0;};};};_dcdf :=_ff .Right -_ff .Left ;_ecd :=_ff .Bottom -_ff .Top ;
_fge :=float64 (len (_bad ));if _be {_ffd :=_gga /(_gga -_eaef )*_dcdf ;_eef :=-_eaef /(_gga -_eaef )*_dcdf ;_aa :=_ff .Left +_eef ;_ddd :=_ecd /_fge ;for _eefa ,_da :=range _bad {_ddf :=_dgf [_da ];_bb :=float64 (len (_ddf ._baec ))+_ge ;_ddb :=_ddd /_bb ;
_dcc :=_ddb *_ge ;_cad :=_ff .Bottom -float64 (_eefa )*_ddd -_dcc /2-_ddb ;for _ ,_bc :=range _ddf ._baec {if _bc ._aaff ==0{continue ;};var _beg ,_fab float64 ;if _bc ._aaff > 0{_fab =_bc ._aaff /_gga *_ffd ;_fbb .drawRectangleWithProps (_bc ._abc ,_aa ,_cad ,_fab ,_ddb ,false );
}else {_fab =_bc ._aaff /_eaef *_eef ;_beg =_aa -_fab ;_fbb .drawRectangleWithProps (_bc ._abc ,_beg ,_cad ,_fab ,_ddb ,false );};_cad -=_ddb ;};};}else {_dgc :=_gga /(_gga -_eaef )*_ecd ;_egb :=-_eaef /(_gga -_eaef )*_ecd ;_gb :=_ff .Top +_dgc ;_dbe :=_dcdf /_fge ;
for _add ,_dcb :=range _bad {_gff :=_dgf [_dcb ];_ede :=float64 (len (_gff ._baec ))+_ge ;_aaf :=_dbe /_ede ;_bcb :=_aaf *_ge ;_gde :=_ff .Left +float64 (_add )*_dbe +_bcb /2;for _ ,_bed :=range _gff ._baec {var _ebg ,_gc float64 ;if _bed ._aaff > 0{_gc =_bed ._aaff /_gga *_dgc ;
_ebg =_gb -_gc ;_fbb .drawRectangleWithProps (_bed ._abc ,_gde ,_ebg ,_aaf ,_gc ,false );}else {_gc =_bed ._aaff /_eaef *_egb ;_fbb .drawRectangleWithProps (_bed ._abc ,_gde ,_gb ,_aaf ,_gc ,false );};_gde +=_aaf ;};};};return _dd ,nil ;};func _ebab (_dag _dc .ST_SchemeColorVal ,_eeff *_dc .Theme )string {if _dcbd :=_eeff .ThemeElements ;
_dcbd !=nil {if _bffc :=_dcbd .ClrScheme ;_bffc !=nil {switch _dag {case _dc .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_bffc .Lt1 );case _dc .ST_SchemeColorValDk1 ,_dc .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_bffc .Dk1 );
case _dc .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_bffc .Lt2 );case _dc .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_bffc .Dk2 );case _dc .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_bffc .Accent1 );case _dc .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_bffc .Accent2 );
case _dc .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_bffc .Accent3 );case _dc .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_bffc .Accent4 );case _dc .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_bffc .Accent5 );
case _dc .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_bffc .Accent6 );};};};return "";};type fontsMap struct{_daff *_ce .Mutex ;_cgff map[string ]map[FontStyle ]*_ba .PdfFont ;};func (_eda *creatorContext )drawLineWithProps (_bbgf *_dc .CT_ShapeProperties ,_eggd ,_gebdc ,_fddf ,_abgd float64 ,_fgfe bool ){if _bbgf !=nil {if _fac :=_bbgf .Ln ;
_fac !=nil {_aebc :=_eda .getPdfColorFromSolidFill (_fac .SolidFill );if _aebc ==nil &&_fgfe {_aebc =_df .ColorBlack ;};if _aebc !=nil {var _aadfc float64 ;if _caeb :=_fac .WAttr ;_caeb !=nil {_aadfc =_ceg .FromEMU (int64 (*_caeb ));}else {_aadfc =_ae ;
};DrawLine (_eda ._cccg ,_eggd ,_gebdc ,_fddf ,_abgd ,_aadfc ,_aebc );};};};};func GetImage (c *_df .Creator ,goImg _edb .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_df .Image ,error ){if goImg ==nil {return nil ,nil ;
};_ffe :=goImg .Bounds ().Size ();_dbc :=_ffe .X ;_dgbe :=_ffe .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_dbc );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_dgbe );};var _edga _edb .Rectangle ;switch part {case ImgPart_t :_edga =_edb .Rect (0,0,_dbc ,int (dividerY ));
case ImgPart_b :_edga =_edb .Rect (0,int (dividerY ),_dbc ,_dgbe );case ImgPart_l :_edga =_edb .Rect (0,0,int (dividerX ),_dgbe );case ImgPart_r :_edga =_edb .Rect (int (dividerX ),0,_dbc ,_dgbe );case ImgPart_lt :_edga =_edb .Rect (0,0,int (dividerX ),int (dividerY ));
case ImgPart_rt :_edga =_edb .Rect (int (dividerX ),0,_dbc ,int (dividerY ));case ImgPart_lb :_edga =_edb .Rect (0,int (dividerY ),int (dividerX ),_dgbe );case ImgPart_rb :_edga =_edb .Rect (int (dividerX ),int (dividerY ),_dbc ,_dgbe );default:_edga =_edb .Rect (0,0,_dbc ,_dgbe );
};_abag :=CropImageByRect (goImg ,_edga );_eddc ,_gdb :=c .NewImageFromGoImage (_abag );if _gdb !=nil {return nil ,_gdb ;};_eddc .Scale (imgWidth /float64 (_dbc ),imgHeight /float64 (_dgbe ));_eddc .SetPos (left ,top );return _eddc ,nil ;};func (_fbde *creatorContext )drawAxes (_bgd *_ee .CT_PlotAreaChoice1 ,_cbf ,_bcg ,_dadb float64 ,_edcg []string ,_aae *Rectangle ,_fca bool )error {_gfb :=_fbde ._cccg ;
_caf :=_fbde ._fddb ;if _bgd ==nil {return _ga .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_bgd .ValAx )==0||(len (_bgd .CatAx )==0&&len (_bgd .DateAx )==0&&len (_bgd .SerAx )==0){return _ga .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _cgdc ,_dae ,_cde ,_aaab uint32 ;var _ceb ,_aade _ee .ST_AxPos ;var _cee ,_bcbc _ee .ST_TickMark ;var _afcb ,_cfg *_ee .CT_ChartLines ;var _gbe ,_geba _ee .ST_TickLblPos ;var _gcb ,_ggbd *_dc .CT_ShapeProperties ;var _cab error ;_gaf :=_aae .Right -_aae .Left ;
_cdf :=_aae .Bottom -_aae .Top ;if len (_bgd .ValAx )> 0{_dae ,_aade ,_bcbc ,_geba ,_cfg ,_aaab ,_ggbd ,_cab =_fcc (_bgd .ValAx [0]);};if _aade !=_ee .ST_AxPosL &&_aade !=_ee .ST_AxPosB {return _ga .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_gcga :=_bcg -_cbf ;_aag :=int (_gcga /_dadb )+1;var _dgfd ,_agg float64 ;switch _bcbc {case _ee .ST_TickMarkIn :_dgfd ,_agg =_gecb ,0;case _ee .ST_TickMarkOut :_dgfd ,_agg =0,_gecb ;case _ee .ST_TickMarkCross :_dgfd ,_agg =_gecb ,_gecb ;};_dgfd =_dgfd *_caf ;
_agg =_agg *_caf ;var _fcb *_dc .CT_ShapeProperties ;if _cfg !=nil {_fcb =_cfg .SpPr ;};_gda ,_dddc :=_gbe !=_ee .ST_TickLblPosNone ,_geba !=_ee .ST_TickLblPosNone ;_bcba :=_cbf ;if len (_bgd .CatAx )> 0{_cgdc ,_ceb ,_cee ,_gbe ,_afcb ,_cde ,_gcb ,_cab =_bca (_bgd .CatAx [0]);
}else if len (_bgd .DateAx )> 0{_cgdc ,_ceb ,_cee ,_gbe ,_afcb ,_cde ,_gcb ,_cab =_dcae (_bgd .DateAx [0]);}else if len (_bgd .SerAx )> 0{_cgdc ,_ceb ,_cee ,_gbe ,_afcb ,_cde ,_gcb ,_cab =_ega (_bgd .SerAx [0]);};if _cab !=nil {return _cab ;};if _ceb !=_ee .ST_AxPosL &&_ceb !=_ee .ST_AxPosB {return _ga .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _cgdc !=_aaab ||_dae !=_cde {return _ga .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_fag :=len (_edcg )+1;var _dca ,_bfb float64 ;switch _cee {case _ee .ST_TickMarkIn :_dca ,_bfb =_gecb ,0;
case _ee .ST_TickMarkOut :_dca ,_bfb =0,_gecb ;case _ee .ST_TickMarkCross :_dca ,_bfb =_gecb ,_gecb ;};_dca =_dca *_caf ;_bfb =_bfb *_caf ;var _ceag *_dc .CT_ShapeProperties ;if _afcb !=nil {_ceag =_afcb .SpPr ;};if _fca {_ecg :=_cdf /float64 (len (_edcg ));
_aadea :=_aae .Left -_cbf *_gaf /_gcga ;_eged :=_aadea -_afcf *_caf ;if _gda {var _gdea float64 ;for _fbbg :=0;_fbbg < _fag ;_fbbg ++{_cbgc :=_aae .Bottom -float64 (_fbbg )*_ecg ;if _fbbg < _fag -1{_geg :=_gfb .NewParagraph (_edcg [_fbbg ]);_geg .SetFontSize (_abe *_caf );
_geg .SetPos (_eged ,_cbgc -_ecg /2-_fbg *_caf );_gfb .Draw (_geg );_dga :=(_geg .Width ()/1000-_afcf )*_caf ;if _dga > 0&&_dga > _gdea {_gdea =_dga ;};};};if _gdea > 0{_aae .Left +=_gdea +_cgeb ;_aadea =_aae .Left -_cbf *_gaf /_gcga ;_gaf =_aae .Right -_aae .Left ;
};};_aff :=_aadea -_bfb ;_afd :=_aadea +_dca ;_cff :=_aae .Left ;_abea :=_aae .Right ;for _aab :=0;_aab < _fag ;_aab ++{_dfa :=_aae .Bottom -float64 (_aab )*_ecg ;_fbde .drawLineWithProps (_gcb ,_aff ,_dfa ,_afd ,_dfa ,true );_fbde .drawLineWithProps (_ceag ,_cff ,_dfa ,_abea ,_dfa ,true );
};_gdec :=_gaf /_gcga ;_cced :=_aae .Bottom -_dgfd ;_adcb :=_aae .Bottom +_agg ;_fbff :=_aae .Top ;_bef :=_aae .Bottom ;for _dcac :=0;_dcac < _aag ;_dcac ++{_cae :=_aae .Left +(_bcba -_cbf )*_gdec ;_fbde .drawLineWithProps (_ggbd ,_cae ,_cced ,_cae ,_adcb ,true );
_fbde .drawLineWithProps (_fcb ,_cae ,_fbff ,_cae ,_bef ,true );if _dddc {_gcef :=_gfb .NewParagraph (_ea .FormatFloat (_bcba ,'g',-1,64));_gcef .SetFontSize (_abe *_caf );_gcef .SetPos (_cae -_edf *_caf ,_bef +_abd *_caf );_gfb .Draw (_gcef );};_bcba +=_dadb ;
};}else {_fcd :=_cdf /_gcga ;_ebd :=_aae .Left ;if _dddc {var _gdcg float64 ;for _egg :=0;_egg < _aag ;_egg ++{_ggg :=_aae .Bottom -(_bcba -_cbf )*_fcd ;_afde :=_gfb .NewParagraph (_ea .FormatFloat (_bcba ,'g',-1,64));_afde .SetFontSize (_abe *_caf );_afde .SetPos (_ebd -_afcf *_caf ,_ggg -_fbg *_caf );
_gfb .Draw (_afde );_cdeg :=(_afde .Width ()/1000-_afcf )*_caf ;if _cdeg > 0&&_cdeg > _gdcg {_gdcg =_cdeg ;};_bcba +=_dadb ;};if _gdcg > 0{_aae .Left +=_gdcg +_cgeb ;_gaf =_aae .Right -_aae .Left ;};};_bcba =_cbf ;_dab :=_aae .Left -_agg ;_cda :=_aae .Left +_dgfd ;
_ebd =_aae .Left ;_dgb :=_aae .Right ;for _cfa :=0;_cfa < _aag ;_cfa ++{_ccfa :=_aae .Bottom -(_bcba -_cbf )*_fcd ;_fbde .drawLineWithProps (_ggbd ,_dab ,_ccfa ,_cda ,_ccfa ,true );_fbde .drawLineWithProps (_fcb ,_ebd ,_ccfa ,_dgb ,_ccfa ,true );_bcba +=_dadb ;
};_baf :=_gaf /float64 (len (_edcg ));_aggd :=_aae .Bottom +_cbf *_cdf /_gcga ;_cfae :=_aggd -_dca ;_agb :=_aggd +_bfb ;_fagb :=_aae .Top ;_aecc :=_aae .Bottom ;_fga :=_aggd +_abd *_caf ;for _ceea :=0;_ceea < _fag ;_ceea ++{_ddgg :=_aae .Left +float64 (_ceea )*_baf ;
_fbde .drawLineWithProps (_gcb ,_ddgg ,_cfae ,_ddgg ,_agb ,true );_fbde .drawLineWithProps (_ceag ,_ddgg ,_fagb ,_ddgg ,_aecc ,true );if _gda &&_ceea < _fag -1{_egc :=_gfb .NewParagraph (_edcg [_ceea ]);_egc .SetFontSize (_abe *_caf );_egc .SetPos (_ddgg +_ddg *_caf ,_fga );
_gfb .Draw (_egc );};};};return nil ;};func _gfgg (_dfg ,_cec ,_aeb uint8 )(float64 ,float64 ,float64 ){_eabf ,_cdd ,_cbd :=float64 (_dfg )/255,float64 (_cec )/255,float64 (_aeb )/255;_gcd :=_eabf ;if _cdd < _gcd {_gcd =_cdd ;};if _cbd < _gcd {_gcd =_cbd ;
};var _gebg ,_eefg bool ;_agc :=_eabf ;if _cdd > _agc {_agc =_cdd ;_gebg =true ;};if _cbd > _agc {_agc =_cbd ;_gebg =false ;_eefg =true ;};_daef :=(_gcd +_agc )/2;var _bcff float64 ;if _gcd !=_agc {if _daef <=0.5{_bcff =(_agc -_gcd )/(_agc +_gcd );}else {_bcff =(_agc -_gcd )/(2.0-_agc -_gcd );
};};var _gcee float64 ;if _gcd !=_agc {if _gebg {_gcee =2.0+(_cbd -_eabf )/(_agc -_gcd );}else if _eefg {_gcee =4.0+(_eabf -_cdd )/(_agc -_gcd );}else {_gcee =(_cdd -_cbd )/(_agc -_gcd );};_gcee *=60;if _gcee < 0{_gcee +=360;};};return _gcee ,_bcff ,_daef ;
};func _bgf (_eeea uint8 ,_dgdc float64 )string {_ebc :=float64 (_eeea );var _dcf float64 ;if _dgdc < 0{_dcf =_ebc *(1+_dgdc );}else {_dcf =_ebc +(255-_ebc )*_dgdc ;};return _eg .Sprintf ("\u0025\u0030\u0032\u0078",int (_dcf ));};type BorderPosition byte ;
var _gecb =_ffcb (1);func _cecf (_cegb string )([]byte ,error ){_abde :=_f .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");_cegb =_abde .ReplaceAllString (_cegb ,"");_dafg :=[]rune (_cegb );_bcec :=[]byte {};
for _bea :=len (_dafg )-2;_bea >=0;_bea -=2{_dgcc ,_bbf :=_ea .ParseUint (string (_dafg [_bea ])+string (_dafg [_bea +1]),16,8);if _bbf !=nil {return nil ,_bbf ;};_bcec =append (_bcec ,byte (_dgcc ));};return _bcec ,nil ;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };
func FromSTCoordinate (st _dc .ST_Coordinate )int64 {if _eabc :=st .ST_CoordinateUnqualified ;_eabc !=nil {return *_eabc ;};return 0;};func (_egea *Rectangle )Translate (x ,y float64 ){_egea .Left +=x ;_egea .Right +=x ;_egea .Top +=y ;_egea .Bottom +=y ;
};func GetDataFromXfrm (xfrm *_dc .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _adcd ,_ffbf ,_cffe ,_aed float64 ;if _eaec :=xfrm .Off ;_eaec !=nil {_adcd =_ceg .FromEMU (FromSTCoordinate (_eaec .XAttr ));_ffbf =_ceg .FromEMU (FromSTCoordinate (_eaec .YAttr ));
};if _bgcg :=xfrm .Ext ;_bgcg !=nil {_cffe =_ceg .FromEMU (_bgcg .CxAttr );_aed =_ceg .FromEMU (_bgcg .CyAttr );};return _adcd ,_ffbf ,_cffe ,_aed ;};func _fbbc (_gca _dc .ST_SchemeColorVal ,_gef *_dc .Theme )string {if _ggc :=_gef .ThemeElements ;_ggc !=nil {if _aaabd :=_ggc .ClrScheme ;
_aaabd !=nil {switch _gca {case _dc .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_aaabd .Lt1 );case _dc .ST_SchemeColorValDk1 ,_dc .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_aaabd .Dk1 );case _dc .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_aaabd .Lt2 );
case _dc .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_aaabd .Dk2 );case _dc .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_aaabd .Accent1 );case _dc .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_aaabd .Accent2 );
case _dc .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_aaabd .Accent3 );case _dc .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_aaabd .Accent4 );case _dc .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_aaabd .Accent5 );
case _dc .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_aaabd .Accent6 );};};};return "";};type creatorContext struct{_cccg *_df .Creator ;_deba *_dc .Theme ;_fddb float64 ;};func _dcae (_fadb *_ee .CT_DateAx )(uint32 ,_ee .ST_AxPos ,_ee .ST_TickMark ,_ee .ST_TickLblPos ,*_ee .CT_ChartLines ,uint32 ,*_dc .CT_ShapeProperties ,error ){var _bffa ,_gaa uint32 ;
var _ddgd _ee .ST_AxPos ;var _adcc _ee .ST_TickMark ;var _fdc *_ee .CT_ChartLines ;var _cdaf _ee .ST_TickLblPos ;if _fadb .AxId ==nil {return _bffa ,_ddgd ,_adcc ,_cdaf ,_fdc ,_gaa ,_fadb .SpPr ,_ga .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_bffa =_fadb .AxId .ValAttr ;};if _fadb .AxPos ==nil {return _bffa ,_ddgd ,_adcc ,_cdaf ,_fdc ,_gaa ,_fadb .SpPr ,_ga .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ddgd =_fadb .AxPos .ValAttr ;
};if _fadb .MajorTickMark !=nil {_adcc =_fadb .MajorTickMark .ValAttr ;};if _fadb .TickLblPos !=nil {_cdaf =_fadb .TickLblPos .ValAttr ;};if _fadb .CrossAx ==nil {return _bffa ,_ddgd ,_adcc ,_cdaf ,_fdc ,_gaa ,_fadb .SpPr ,_ga .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_gaa =_fadb .CrossAx .ValAttr ;};_fdc =_fadb .MajorGridlines ;return _bffa ,_ddgd ,_adcc ,_cdaf ,_fdc ,_gaa ,_fadb .SpPr ,nil ;};var _bff =_ffcb (1.5);func AssignStdFontByName (style _df .TextStyle ,fontName string )*_ba .PdfFont {_cdafc :=_ba .StdFontName (fontName );
return _ba .NewStandard14FontMustCompile (_cdafc );};func (_acg barSerByOrder )Less (i ,j int )bool {return _acg [i ].Order .ValAttr < _acg [j ].Order .ValAttr };func MakeBlockFromCreator (c *_df .Creator )(*_df .Block ,error ){_gebd ,_gaaf :=GetPageFromCreator (c );
if _gaaf !=nil {return nil ,_gaaf ;};_fcgb ,_gaaf :=_df .NewBlockFromPage (_gebd );if _gaaf !=nil {return nil ,_gaaf ;};return _fcgb ,nil ;};func AdjustColorByShade (colorStr string ,shade float64 )string {var _ccg ,_deg ,_acce uint8 ;_deb ,_ :=_eg .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_ccg ,&_deg ,&_acce );
if _deb !=3{return "";};return _bce (_ccg ,shade )+_bce (_deg ,shade )+_bce (_acce ,shade );};func MakeBlockFromChartSpace (cs *_ee .ChartSpace ,width ,height float64 ,theme *_dc .Theme )(*_df .Block ,error ){_dde ,_aad :=_fbc (cs ,width ,height ,theme ,false );
if _aad !=nil {return nil ,_aad ;};_bega ,_aad :=GetPageFromCreator (_dde );if _aad !=nil {return nil ,_aad ;};_fad ,_aad :=_df .NewBlockFromPage (_bega );if _aad !=nil {return nil ,_aad ;};return _fad ,nil ;};func RegisterFontsFromFiles (files []string )error {for _ ,_ebfa :=range files {if _ed .HasSuffix (_ebfa ,"\u002e\u0074\u0074\u0066"){_bbgc :=_fgeg (_ebfa );
if _bbgc !=nil {_b .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_bbgc );
continue ;};};};return nil ;};func ClearRegisteredFonts (){_dfc ._daff .Lock ();_dfc ._cgff =map[string ]map[FontStyle ]*_ba .PdfFont {};_dfc ._daff .Unlock ();};func GetPageFromCreator (c *_df .Creator )(*_ba .PdfPage ,error ){_edg :=_eb .NewBuffer ([]byte {});
_aaaa :=c .Write (_edg );if _aaaa !=nil {return nil ,_aaaa ;};_aaee :=_eb .NewReader (_edg .Bytes ());_fgee ,_aaaa :=_ba .NewPdfReader (_aaee );if _aaaa !=nil {return nil ,_aaaa ;};return _fgee .GetPage (1);};func AdjustColorByTint (colorStr string ,tint float64 )string {var _gadb ,_bafe ,_cgc uint8 ;
_bdd ,_ :=_eg .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_gadb ,&_bafe ,&_cgc );if _bdd !=3{return "";};return _bgf (_gadb ,tint )+_bgf (_bafe ,tint )+_bgf (_cgc ,tint );};func GetGroupOffsetFromXfrm (xfrm *_dc .CT_GroupTransform2D )(float64 ,float64 ){var _dffa ,_febc float64 ;
if xfrm .Off !=nil &&xfrm .ChOff !=nil {_dffa =_ceg .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_ceg .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));_febc =_ceg .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_ceg .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));
};return _dffa ,_febc ;};func DrawLine (c *_df .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _df .Color ){if color ==nil {return ;};_afcc :=c .NewLine (x0 ,y0 ,x1 ,y1 );_afcc .SetLineWidth (width );_afcc .SetColor (color );c .Draw (_afcc );};type serValue struct{_eab string ;
_aaff float64 ;_abc *_dc .CT_ShapeProperties ;};var _dfc =fontsMap {_daff :&_ce .Mutex {},_cgff :map[string ]map[FontStyle ]*_ba .PdfFont {}};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _gced ,_dfab ,_ded uint8 ;_gcc ,_ :=_eg .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_gced ,&_dfab ,&_ded );if _gcc !=3{return "";};_gfc ,_dcbe ,_acgg :=_gfgg (_gced ,_dfab ,_ded );
_acgg =lum *_acgg ;_gced ,_dfab ,_ded =_gaag (_gfc ,_dcbe ,_acgg );return _eg .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_gced ,_dfab ,_ded );};func _ega (_cgec *_ee .CT_SerAx )(uint32 ,_ee .ST_AxPos ,_ee .ST_TickMark ,_ee .ST_TickLblPos ,*_ee .CT_ChartLines ,uint32 ,*_dc .CT_ShapeProperties ,error ){var _abb ,_gbg uint32 ;
var _fefb _ee .ST_AxPos ;var _cgg _ee .ST_TickMark ;var _aafa *_ee .CT_ChartLines ;var _eaf _ee .ST_TickLblPos ;if _cgec .AxId ==nil {return _abb ,_fefb ,_cgg ,_eaf ,_aafa ,_gbg ,_cgec .SpPr ,_ga .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_abb =_cgec .AxId .ValAttr ;};if _cgec .AxPos ==nil {return _abb ,_fefb ,_cgg ,_eaf ,_aafa ,_gbg ,_cgec .SpPr ,_ga .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_fefb =_cgec .AxPos .ValAttr ;
};if _cgec .MajorTickMark !=nil {_cgg =_cgec .MajorTickMark .ValAttr ;};if _cgec .TickLblPos !=nil {_eaf =_cgec .TickLblPos .ValAttr ;};if _cgec .CrossAx ==nil {return _abb ,_fefb ,_cgg ,_eaf ,_aafa ,_gbg ,_cgec .SpPr ,_ga .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_gbg =_cgec .CrossAx .ValAttr ;};_aafa =_cgec .MajorGridlines ;return _abb ,_fefb ,_cgg ,_eaf ,_aafa ,_gbg ,_cgec .SpPr ,nil ;};func _fbc (_aec *_ee .ChartSpace ,_age ,_baab float64 ,_gac *_dc .Theme ,_eaed bool )(*_df .Creator ,error ){_dge :=1.0;
if _eaed {_dge =8.0;};_faa :=&Rectangle {};_fbe :=&Rectangle {Top :_faa .Top ,Bottom :_baab -_faa .Bottom ,Left :_faa .Left ,Right :_age -_faa .Right };_gdc :=MakeTempCreator (_age *_dge +1,_baab *_dge +1);_fc :=&creatorContext {_cccg :_gdc ,_deba :_gac ,_fddb :_dge };
var _ggfb bool ;if _gcg :=_aec .Chart ;_gcg !=nil {_bg :=_gcg .PlotArea ;if _bg ==nil {return nil ,_ga .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_eba :=0.0;if _gcg .AutoTitleDeleted !=nil &&_gcg .AutoTitleDeleted .ValAttr !=nil &&!*_gcg .AutoTitleDeleted .ValAttr {_bab :="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";
if _gcg .Title !=nil &&_gcg .Title .Overlay !=nil &&_gcg .Title .Overlay .ValAttr !=nil &&!*_gcg .Title .Overlay .ValAttr {_eba =_ffcb (10);};if _gcg .Title !=nil &&_gcg .Title .Tx !=nil &&_gcg .Title .Tx .Choice !=nil &&_gcg .Title .Tx .Choice .Rich !=nil {if len (_gcg .Title .Tx .Choice .Rich .P )> 0{if len (_gcg .Title .Tx .Choice .Rich .P [0].EG_TextRun )> 0{_bab =_gcg .Title .Tx .Choice .Rich .P [0].EG_TextRun [0].R .T ;
};};};_fc .drawTitle (_bab ,_fbe .Left +_fbe .Right /2,_ffcb (5));};_cgd :=&Rectangle {Top :_ffcb (10)+_eba ,Bottom :_fbe .Bottom -_ffcb (15),Left :_ffcb (10),Right :_fbe .Right -_ffcb (10)};var _fd *Rectangle ;_baac :=_gcg .Legend ;if _baac !=nil {_acfd :=_baac .Overlay !=nil &&_baac .Overlay .ValAttr !=nil &&*_baac .Overlay .ValAttr ;
if _gae :=_baac .LegendPos ;_gae !=nil {switch _gae .ValAttr {case _ee .ST_LegendPosTr :if !_acfd {_cgd =&Rectangle {Top :_ffcb (25)+_eba ,Bottom :_fbe .Bottom -_ffcb (10),Left :_ffcb (10),Right :_fbe .Right -_ffcb (25)};};_fd =&Rectangle {Top :_ffcb (2.5)+_eba ,Bottom :_ffcb (22.5),Left :_fbe .Right -_ffcb (22.5),Right :_fbe .Right -_ffcb (2.5)};
case _ee .ST_LegendPosT :_fd =&Rectangle {Top :_ffcb (2.5)+_eba ,Bottom :_ffcb (7.5),Left :(_fbe .Right -_fbe .Left )*0.25,Right :(_fbe .Right -_fbe .Left )*0.75};if !_acfd {_cgd =&Rectangle {Top :_ffcb (12.5)+_eba ,Bottom :_fbe .Bottom -_ffcb (15),Left :_ffcb (10),Right :_fbe .Right -_ffcb (5)};
};_ggfb =true ;case _ee .ST_LegendPosB :_fd =&Rectangle {Top :_fbe .Bottom -_ffcb (7.5)+_eba ,Bottom :_fbe .Bottom -_ffcb (2.5),Left :(_fbe .Right -_fbe .Left )*0.25,Right :(_fbe .Right -_fbe .Left )*0.75};if !_acfd {_cgd =&Rectangle {Top :_ffcb (5)+_eba ,Bottom :_fbe .Bottom -_ffcb (15),Left :_ffcb (10),Right :_fbe .Right -_ffcb (5)};
};_ggfb =true ;case _ee .ST_LegendPosR :_fd =&Rectangle {Top :(_fbe .Bottom -_fbe .Top )/2-_ffcb (10)+_eba ,Bottom :(_fbe .Bottom -_fbe .Top )/2+_ffcb (10),Left :_fbe .Right -_ffcb (22.5),Right :_fbe .Right -_ffcb (2.5)};if !_acfd {_cgd =&Rectangle {Top :_ffcb (5)+_eba ,Bottom :_fbe .Bottom -_ffcb (12.5),Left :_ffcb (10),Right :_fbe .Right -_ffcb (25)};
};case _ee .ST_LegendPosL :_fd =&Rectangle {Top :(_fbe .Bottom -_fbe .Top )/2-_ffcb (10)+_eba ,Bottom :(_fbe .Bottom -_fbe .Top )/2+_ffcb (10),Left :_ffcb (2.5),Right :_ffcb (22.5)};if !_acfd {_cgd =&Rectangle {Top :_ffcb (5)+_eba ,Bottom :_fbe .Bottom -_ffcb (12.5),Left :_ffcb (30),Right :_fbe .Right -_ffcb (5)};
};default:_fd =&Rectangle {Top :(_fbe .Bottom -_fbe .Top )/2-_ffcb (10)+_eba ,Bottom :(_fbe .Bottom -_fbe .Top )/2+_ffcb (10),Left :_fbe .Right -_ffcb (25),Right :_fbe .Right -_ffcb (5)};if !_acfd {_cgd =&Rectangle {Top :_ffcb (5)+_eba ,Bottom :_fbe .Bottom -_ffcb (12.5),Left :_ffcb (100),Right :_fbe .Right -_ffcb (25)};
};};};};_cgd .scale (_dge );_fc .drawBorderWithProps (_bg .SpPr ,_cgd ,_ae );_bcf :=[]*legendItem {};var _ggb error ;_edc :=_bg .CChoice ;for _ ,_faaf :=range _bg .Choice {if _adc :=_faaf .BarChart ;_adc !=nil {_bcf ,_ggb =_fc .drawBarChart (_adc ,_cgd ,_edc );
if _ggb !=nil {return nil ,_ggb ;};};};if _baac !=nil {_fd .scale (_dge );_fc .drawBorderWithProps (_baac .SpPr ,_fd ,_ae );if len (_bcf )!=0{_fc .drawLegend (_fd ,_bcf ,_ggfb );};};};_fbe .scale (_dge );_fc .drawBorderWithProps (_aec .SpPr ,_fbe ,_ae );
return _gdc ,nil ;};func _ffcb (_abeag float64 )float64 {return _abeag *_ceg .Millimeter };const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);func (_ffb *Rectangle )scale (_dbb float64 ){_ffb .Top *=_dbb ;
_ffb .Bottom *=_dbb ;_ffb .Left *=_dbb ;_ffb .Right *=_dbb ;};func DrawRectangle (c *_df .Creator ,r *Rectangle ,w float64 ,color _df .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );
DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};func _bce (_eeg uint8 ,_dbd float64 )string {_cbaa :=float64 (_eeg );return _eg .Sprintf ("\u0025\u0030\u0032\u0078",int (_cbaa *_dbd ));
};func IsNoSpaceLanguage (symbol string )bool {for _ ,_fee :=range symbol {if _c .Is (_c .Han ,_fee ){return true ;};};return false ;};type legendItem struct{_cade string ;_afb *_dc .CT_ShapeProperties ;};var _afcf =_ffcb (7.5);func (_adb *creatorContext )drawTitle (_bge string ,_dcdb ,_febd float64 ){_bcbg :=_adb ._fddb ;
_fabe :=_adb ._cccg .NewStyledParagraph ();_fdf :=_fabe .SetText (_bge );_gbb ,_bfc :=_ba .NewStandard14Font (_ba .HelveticaName );if _bfc ==nil {_gfg :=_adb ._cccg .NewTextStyle ();_gfg .Font =_gbb ;_gfg .FontSize =14;_gfg .TextRise =0.4;_fdf .Style =_gfg ;
_fabe .SetPos (_dcdb -_fabe .Width ()*_bcbg /2,_febd );_adb ._cccg .Draw (_fabe );};};func _gaag (_aaffa ,_bcae ,_aecce float64 )(uint8 ,uint8 ,uint8 ){var _aga float64 ;if _aecce < 0.5{_aga =_aecce *(1+_bcae );}else {_aga =_aecce +_bcae -_aecce *_bcae ;
};_daf :=_aecce *2-_aga ;_aaffa /=360.0;_ebe :=_gba (_aaffa +1.0/3.0);_dceg :=_gba (_aaffa );_gaee :=_gba (_aaffa -1.0/3.0);_eadb :=_bcfa (_ebe ,_aga ,_daf );_eaff :=_bcfa (_dceg ,_aga ,_daf );_dddf :=_bcfa (_gaee ,_aga ,_daf );return uint8 (255*_eadb ),uint8 (255*_eaff ),uint8 (255*_dddf );
};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);var DefaultFontSize =12.0;func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_ceg .Twips *10+0.5))/10;
};func CropImageByRect (sourceImg _edb .Image ,rect _edb .Rectangle )_edb .Image {_bcab ,_fddd ,_bfd ,_gcefc :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;_ggd :=_edb .NewNRGBA (_edb .Rect (0,0,_bfd -_bcab ,_gcefc -_fddd ));for _cddc :=_bcab ;
_cddc < _bfd ;_cddc ++{for _cfb :=_fddd ;_cfb < _gcefc ;_cfb ++{_ggd .Set (_cddc -_bcab ,_cfb -_fddd ,sourceImg .At (_cddc ,_cfb ));};};return _ggd ;};func (_cd *creatorContext )drawLegend (_dff *Rectangle ,_dba []*legendItem ,_bec bool ){_cdc :=_cd ._fddb ;
_dffg :=_ffcb (2.5)*_cdc ;_fda :=_bff *_cdc ;_gce :=(_dffg -_fda )/2;_gge :=float64 (len (_dba ));if _bec {_bba :=&Rectangle {Top :_dff .Top +_ffcb (1)*_cdc ,Bottom :_dff .Bottom -_ffcb (1)*_cdc ,Left :_dff .Left +_ffcb (2.5)*_cdc ,Right :_dff .Right -_ffcb (2.5)*_cdc };
var _ebf float64 ;if _gge > 1{_ebf =(_bba .Right -_bba .Left )/_gge ;};_efb :=_bba .Left ;_ggbg :=_bba .Top ;for _ ,_cgb :=range _dba {if _ade :=_cgb ._afb ;_ade !=nil {_cd .drawRectangleWithProps (_ade ,_efb ,_ggbg +_gce ,_fda ,_fda ,false );_gec :=_efb +_fda *2;
_gfd :=_cd ._cccg .NewStyledParagraph ();_gfd .SetPos (_gec ,_ggbg );_dad :=_gfd .Append (_cgb ._cade );_cge ,_cdb :=_ba .NewStandard14Font (_ba .HelveticaName );if _cdb ==nil {_eaedd :=_cd ._cccg .NewTextStyle ();_eaedd .Font =_cge ;_eaedd .FontSize =_dffg ;
_eaedd .TextRise =0.4;_dad .Style =_eaedd ;_cd ._cccg .Draw (_gfd );};};_efb +=_ebf ;};}else {_ffc :=&Rectangle {Top :_dff .Top +_ffcb (2.5)*_cdc ,Bottom :_dff .Bottom -_ffcb (2.5)*_cdc ,Left :_dff .Left +_ffcb (2.5)*_cdc ,Right :_dff .Right -_ffcb (2.5)*_cdc };
var _dgd float64 ;if _gge > 1{_dgd =(_ffc .Bottom -_ffc .Top -_dffg )/(_gge -1);};_geb :=_ffc .Top ;_gad :=_ffc .Left ;_gace :=_gad +_fda *2;for _ ,_eec :=range _dba {if _cfc :=_eec ._afb ;_cfc !=nil {_cd .drawRectangleWithProps (_cfc ,_gad ,_geb +_gce ,_fda ,_fda ,false );
_dec :=_cd ._cccg .NewStyledParagraph ();_dec .SetPos (_gace ,_geb );_ecdd :=_dec .Append (_eec ._cade );_eac ,_beec :=_ba .NewStandard14Font (_ba .HelveticaName );if _beec ==nil {_bcc :=_cd ._cccg .NewTextStyle ();_bcc .Font =_eac ;_bcc .FontSize =_dffg ;
_bcc .TextRise =0.4;_ecdd .Style =_bcc ;_cd ._cccg .Draw (_dec );};};_geb +=_dgd ;};};};func GetOpacityFromColorTransform (trs []*_dc .EG_ColorTransform )float64 {for _ ,_ead :=range trs {if _ead !=nil {if _daa :=_ead .Alpha ;_daa !=nil {if _afa :=_daa .ValAttr .ST_PositiveFixedPercentageDecimal ;
_afa !=nil {return float64 (*_afa )/100000;};};};};return 1.0;};func FromSTCoordinate32 (st _dc .ST_Coordinate32 )int64 {if _cdfe :=st .ST_Coordinate32Unqualified ;_cdfe !=nil {return int64 (*_cdfe );};return 0;};func TwipsFromPoints (points float64 )float64 {return points /_ceg .Twips };
type serCategory struct{_ffdg string ;_baec []serValue ;};var _edf =_ffcb (0.5);func RegisterFontsFromDirectory (dirName string )error {_aeg ,_aega :=_g .Open (dirName );if _aega !=nil {return _aega ;};defer _aeg .Close ();_aegaa ,_aega :=_aeg .Readdirnames (0);
if _aega !=nil {return _aega ;};for _ ,_bffb :=range _aegaa {if _ed .HasSuffix (_bffb ,"\u002e\u0074\u0074\u0066"){_bedd :=dirName +"\u002f"+_bffb ;_cfgb :=_fgeg (_bedd );if _cfgb !=nil {_b .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_cfgb );
continue ;};};};return nil ;};func (_gdd *creatorContext )getPdfColorFromSolidFill (_dedc *_dc .CT_SolidColorFillProperties )_df .Color {if _dedc ==nil {return nil ;};_ccfb :="";if _dbad :=_dedc .SrgbClr ;_dbad !=nil {_ccfb =_dbad .ValAttr ;}else if _egca :=_dedc .SchemeClr ;
_egca !=nil {_ccfb =_ebab (_egca .ValAttr ,_gdd ._deba );};if _ccfb ==""{return nil ;};return _df .ColorRGBFromHex ("\u0023"+_ccfb );};func _bgea (_bdeg *_cb .Document ,_egf ,_eefb ,_gbbg string )error {_aadf ,_cbgf :=_bdeg .GetFontBytesByRelId (_eefb );
if _cbgf !=nil {return _cbgf ;};_bgb ,_cbgf :=_cecf (_gbbg );if _cbgf !=nil {return _cbgf ;};for _edde :=0;_edde < 32;_edde ++{_dfca :=_edde %len (_bgb );_aadf [_edde ]=_aadf [_edde ]^_bgb [_dfca ];};_addc :=_bdeg .TmpPath +"\u002f"+_egf +"\u002e\u0074\u0074\u0066";
_cbgf =_g .WriteFile (_addc ,_aadf ,0644);if _cbgf !=nil {return _cbgf ;};_fgeg (_addc );return nil ;};func GetColorStringFromDmlColor (dmlColor *_dc .CT_Color )string {var _becc string ;if _decb :=dmlColor .SrgbClr ;_decb !=nil {_becc =_decb .ValAttr ;
}else if _bffe :=dmlColor .SysClr ;_bffe !=nil {return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _becc ;};func RegisterEmbeddedFonts (d *_cb .Document )error {_dcdd :=d .FontTable ();if _dcdd ==nil {return nil ;};for _ ,_fdg :=range _dcdd .Font {if _fdg .EmbedRegular !=nil {return _bgea (d ,_fdg .NameAttr ,_fdg .EmbedRegular .IdAttr ,_fdg .EmbedRegular .FontKeyAttr );
};if _fdg .EmbedBold !=nil {return _bgea (d ,_fdg .NameAttr ,_fdg .EmbedBold .IdAttr ,_fdg .EmbedBold .FontKeyAttr );};if _fdg .EmbedItalic !=nil {return _bgea (d ,_fdg .NameAttr ,_fdg .EmbedItalic .IdAttr ,_fdg .EmbedItalic .FontKeyAttr );};if _fdg .EmbedBoldItalic !=nil {return _bgea (d ,_fdg .NameAttr ,_fdg .EmbedBoldItalic .IdAttr ,_fdg .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};func GetRegisteredFont (name string ,style FontStyle )*_ba .PdfFont {_dfc ._daff .Lock ();defer _dfc ._daff .Unlock ();if _dcea ,_fdd :=_dfc ._cgff [name ];_fdd {if _afad ,_cga :=_dcea [style ];_cga {return _afad ;};};return nil ;};func (_bag *creatorContext )drawRectangleWithProps (_gggc *_dc .CT_ShapeProperties ,_ace ,_babe ,_dcaed ,_ecaf float64 ,_cbgcb bool ){_eea :=_bag ._cccg .NewRectangle (_ace ,_babe ,_dcaed ,_ecaf );
if _gggc ==nil {if _cbgcb {_eea .SetBorderWidth (_ae );}else {return ;};}else {_dgg :=_bag .getPdfColorFromSolidFill (_gggc .SolidFill );if _dgg !=nil {_eea .SetFillColor (_dgg );};if _dea :=_gggc .Ln ;_dea !=nil {if _ccef :=_dea .WAttr ;_ccef !=nil {_cbgb :=_ceg .FromEMU (int64 (*_ccef ));
_eea .SetBorderWidth (_cbgb );if _fcf :=_dea .SolidFill ;_fcf !=nil {_dcdff :=_bag .getPdfColorFromSolidFill (_fcf );if _dcdff !=nil {_eea .SetBorderColor (_dcdff );};};}else {_eea .SetBorderWidth (0);};};};_bag ._cccg .Draw (_eea );};type FontStyle byte ;
func FromSTPercentage (st *_dc .ST_Percentage )float64 {if _egag :=st .ST_PercentageDecimal ;_egag !=nil {return float64 (*_egag )/100000;};return 0;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;
);func (_gffd FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_gffd )];};func MakeImageFromChartSpace (cs *_ee .ChartSpace ,width ,height float64 ,theme *_dc .Theme )(_edb .Image ,error ){_ddef ,_aaa :=_fbc (cs ,width ,height ,theme ,true );
if _aaa !=nil {return nil ,_aaa ;};_efd ,_aaa :=GetPageFromCreator (_ddef );if _aaa !=nil {return nil ,_aaa ;};return _fbf .NewImageDevice ().Render (_efd );};func _fcc (_gfeg *_ee .CT_ValAx )(uint32 ,_ee .ST_AxPos ,_ee .ST_TickMark ,_ee .ST_TickLblPos ,*_ee .CT_ChartLines ,uint32 ,*_dc .CT_ShapeProperties ,error ){var _fgc ,_dfea uint32 ;
var _aac _ee .ST_AxPos ;var _aba _ee .ST_TickMark ;var _eeb *_ee .CT_ChartLines ;var _fdab _ee .ST_TickLblPos ;if _gfeg .AxId ==nil {return _fgc ,_aac ,_aba ,_fdab ,_eeb ,_dfea ,_gfeg .SpPr ,_ga .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_fgc =_gfeg .AxId .ValAttr ;};if _gfeg .AxPos ==nil {return _fgc ,_aac ,_aba ,_fdab ,_eeb ,_dfea ,_gfeg .SpPr ,_ga .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_aac =_gfeg .AxPos .ValAttr ;
};if _gfeg .MajorTickMark !=nil {_aba =_gfeg .MajorTickMark .ValAttr ;};if _gfeg .TickLblPos !=nil {_fdab =_gfeg .TickLblPos .ValAttr ;};if _gfeg .CrossAx ==nil {return _fgc ,_aac ,_aba ,_fdab ,_eeb ,_dfea ,_gfeg .SpPr ,_ga .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_dfea =_gfeg .CrossAx .ValAttr ;};_eeb =_gfeg .MajorGridlines ;return _fgc ,_aac ,_aba ,_fdab ,_eeb ,_dfea ,_gfeg .SpPr ,nil ;};const _abe =6.0;var _ddg =_ffcb (5);var _edfb =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
func (_ebb barSerByOrder )Swap (i ,j int ){_ebb [i ],_ebb [j ]=_ebb [j ],_ebb [i ]};