//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_g "bytes";_cd "errors";_gd "fmt";_f "github.com/unidoc/unichart";_fcg "github.com/unidoc/unichart/dataset";_ae "github.com/unidoc/unichart/render";_abe "github.com/unidoc/unioffice/v2/common/logger";_ab "github.com/unidoc/unioffice/v2/document";
_gffe "github.com/unidoc/unioffice/v2/measurement";_dc "github.com/unidoc/unioffice/v2/schema/soo/dml";_gff "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_bee "github.com/unidoc/unioffice/v2/spreadsheet";_de "github.com/unidoc/unioffice/v2/spreadsheet/format";
_cda "github.com/unidoc/unioffice/v2/spreadsheet/formula";_ag "github.com/unidoc/unioffice/v2/spreadsheet/reference";_fcb "github.com/unidoc/unipdf/v4/core";_fc "github.com/unidoc/unipdf/v4/creator";_a "github.com/unidoc/unipdf/v4/model";_bg "github.com/unidoc/unipdf/v4/render";
_gf "github.com/unidoc/unitype";_gb "image";_d "image/color";_be "math";_eb "os";_e "regexp";_b "sort";_da "strconv";_bf "strings";_cg "sync";_cb "unicode";);func (_edgb *creatorContext )drawRectangleWithProps (_eccg *_dc .CT_ShapeProperties ,_ebec ,_fadb ,_gggd ,_gecg float64 ,_ggba bool ){_edce :=_edgb ._bfba .NewRectangle (_ebec ,_fadb ,_gggd ,_gecg );
if _eccg ==nil {if _ggba {_edce .SetBorderWidth (_fad );}else {return ;};}else {_dccb :=_edgb .getPdfColorFromSolidFill (_eccg .FillPropertiesChoice .SolidFill );if _dccb !=nil {_edce .SetFillColor (_dccb );};if _cgec :=_eccg .Ln ;_cgec !=nil {if _gbgg :=_cgec .WAttr ;
_gbgg !=nil {_fbca :=_gffe .FromEMU (int64 (*_gbgg ));_edce .SetBorderWidth (_fbca );if _faeb :=_cgec .LineFillPropertiesChoice .SolidFill ;_faeb !=nil {_dfea :=_edgb .getPdfColorFromSolidFill (_faeb );if _dfea !=nil {_edce .SetBorderColor (_dfea );};};
}else {_edce .SetBorderWidth (0);};};};_edgb ._bfba .Draw (_edce );};type FontStyle byte ;func MakeImageFromChartSpace (cs *_gff .ChartSpace ,width ,height float64 ,theme *_dc .Theme ,workbook *_bee .Workbook )(_gb .Image ,error ){_ccc ,_gda :=_cfc (cs ,width ,height ,theme ,true ,workbook );
if _gda !=nil {return nil ,_gda ;};_aefe ,_gda :=GetPageFromCreator (_ccc );if _gda !=nil {return nil ,_gda ;};return _bg .NewImageDevice ().Render (_aefe );};func _cgde (_bgfg _dc .ST_SchemeColorVal ,_eecc *_dc .Theme )string {if _cac :=_eecc .ThemeElements ;
_cac !=nil {if _agaa :=_cac .ClrScheme ;_agaa !=nil {switch _bgfg {case _dc .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_agaa .Lt1 );case _dc .ST_SchemeColorValDk1 ,_dc .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_agaa .Dk1 );
case _dc .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_agaa .Lt2 );case _dc .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_agaa .Dk2 );case _dc .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_agaa .Accent1 );case _dc .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_agaa .Accent2 );
case _dc .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_agaa .Accent3 );case _dc .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_agaa .Accent4 );case _dc .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_agaa .Accent5 );
case _dc .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_agaa .Accent6 );};};};return "";};var _fad =_eedce (0.125);type creatorContext struct{_bfba *_fc .Creator ;_aada *_dc .Theme ;_bbgec float64 ;};const (BorderPositionTop BorderPosition =0;
BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);var _ccb =_eedce (1.5);func (_bed *creatorContext )drawBarChart (_cfd *_gff .CT_BarChart ,_fg *Rectangle ,_cdg []*_gff .CT_PlotAreaChoice1 ,_bbf *_bee .Workbook )([]*legendItem ,error ){var _cff bool ;
if _dg :=_cfd .BarDir ;_dg !=nil {_cff =_dg .ValAttr ==_gff .ST_BarDirBar ;};_cbb :=_cfd .Ser ;_b .Sort (barSerByOrder (_cbb ));_fa :=map[string ]serCategory {};_bdb :=[]string {};_acd :=[]*legendItem {};_bga :=_be .Inf (1);_ba :=_be .Inf (-1);for _ ,_abg :=range _cbb {var _fdg string ;
if _geb :=_abg .Tx ;_geb !=nil {if _baa :=_geb .SerTxChoice ;_baa !=nil {if _baa .V !=nil {_fdg =*_baa .V ;}else if _bbb :=_baa .StrRef ;_bbb !=nil {if _bca :=_bbb .StrCache ;_bca !=nil {for _ ,_af :=range _bca .Pt {_fdg =_af .V ;};};};};};if _agdg :=_abg .Cat ;
_agdg !=nil {if _ff :=_agdg .AxDataSourceChoice ;_ff !=nil {if _deg :=_ff .StrRef ;_deg !=nil {if _ga :=_deg .F ;_ga !=""&&_bbf !=nil {_cdf ,_aec ,_dag ,_bdf :=ParseExcelRange (_ga );if _bdf ==nil {for _ ,_faa :=range _bbf .Sheets (){if _faa .Name ()==_bf .Trim (_cdf ,"\u0027"){_dgd :=_aec .String ();
for _deb :=_aec .RowIdx ;_deb <=_dag .RowIdx ;_deb +=1{_cgb :=_bf .ReplaceAll (_dgd ,_gd .Sprint (_aec .RowIdx ),_gd .Sprint (_deb ));_bed .addCatName (_faa .Cell (_cgb ).GetString (),_fa ,&_bdb );};break ;};};};};if _fca :=_deg .StrCache ;_fca !=nil {for _ ,_gcc :=range _fca .Pt {_bed .addCatName (_gcc .V ,_fa ,&_bdb );
};};}else if _aef :=_ff .NumRef ;_aef !=nil {if _bbfc :=_aef .NumCache ;_bbfc !=nil {var _cgbc string ;if _bbfc .FormatCode !=nil {_cgbc =*_bbfc .FormatCode ;};for _ ,_fgg :=range _bbfc .Pt {var _fcag string ;if _fgg .FormatCodeAttr ==nil {_fcag =_cgbc ;
}else {_fcag =*_fgg .FormatCodeAttr ;};var _gcca string ;_agc ,_gad :=_da .ParseFloat (_fgg .V ,64);if _gad !=nil {_gcca =_fgg .V ;}else {_gcca =_de .Number (_agc ,_fcag );};_bed .addCatName (_gcca ,_fa ,&_bdb );};};};};};if _fac :=_abg .Val ;_fac !=nil {if _aaf :=_fac .NumDataSourceChoice ;
_aaf !=nil {if _dcc :=_aaf .NumRef ;_dcc !=nil {if _fae :=_dcc .F ;_fae !=""&&_bbf !=nil {_cga ,_fee ,_eac ,_agcf :=ParseExcelRange (_fae );if _agcf ==nil {for _ ,_agf :=range _bbf .Sheets (){if _agf .Name ()==_bf .Trim (_cga ,"\u0027"){_cc :=_fee .String ();
for _agfe :=_fee .RowIdx ;_agfe <=_eac .RowIdx ;_agfe +=1{_efc :=_bf .ReplaceAll (_cc ,_gd .Sprint (_fee .RowIdx ),_gd .Sprint (_agfe ));if _agf .FormulaContext ().HasFormula (_efc ){_dda :=_cda .NewEvaluator ();_eae :=_agf .FormulaContext ().Cell (_efc ,_dda );
_ad :=_eae .Value ();_bed .addCatValue (_ad ,_fa ,_bdb ,(int )(_agfe -_fee .RowIdx ),&_bga ,&_ba ,_fdg ,_abg .SpPr );}else {_dbd :=_agf .Cell (_efc ).GetString ();_bed .addCatValue (_dbd ,_fa ,_bdb ,(int )(_agfe -_fee .RowIdx ),&_bga ,&_ba ,_fdg ,_abg .SpPr );
};};break ;};};};};if _fcfb :=_dcc .NumCache ;_fcfb !=nil {for _cffc ,_fcbc :=range _fcfb .Pt {_bed .addCatValue (_fcbc .V ,_fa ,_bdb ,_cffc ,&_bga ,&_ba ,_fdg ,_abg .SpPr );};};};};};_acd =append (_acd ,&legendItem {_ada :_fdg ,_acf :_abg .SpPr });};var _ecg float64 ;
var _cgdd ,_ade float64 ;if _ba ==0&&_bga ==0{_ecg =0.2;_ade =0;_cgdd =1;}else {var _efe float64 ;if _bge :=_be .Abs (_bga );_ba < _bge {_efe =_bge ;}else {_efe =_ba ;};_cgc :=_be .Pow (10,_be .Floor (_be .Log10 (_efe )));_gea :=_efe /_cgc ;if _gea < 4.29{_ecg =0.5;
}else if _gea >=4.29&&_gea < 8.58{_ecg =1;}else {_ecg =2;};_ecg *=_cgc ;if _ba <=0{_cgdd =0;}else {_cgdd =(_be .Ceil (_ba /_ecg )+1)*_ecg ;};if _bga >=0{_ade =0;}else {_ade =(_be .Floor (_bga /_ecg )-1)*_ecg ;};};_adb :=_bed .drawAxes (_cdg ,_ade ,_cgdd ,_ecg ,_bdb ,_fg ,_cff );
if _adb !=nil {return nil ,_adb ;};_dae :=0.0;if _cfd .GapWidth !=nil {if _bbg :=_cfd .GapWidth .ValAttr ;_bbg !=nil {if _bfb :=_bbg .ST_GapAmountUShort ;_bfb !=nil {_dae =float64 (*_bfb )/100.0;};};};_gac :=_fg .Right -_fg .Left ;_gfd :=_fg .Bottom -_fg .Top ;
_bba :=float64 (len (_bdb ));if _cff {_aga :=_cgdd /(_cgdd -_ade )*_gac ;_bfg :=-_ade /(_cgdd -_ade )*_gac ;_gge :=_fg .Left +_bfg ;_fag :=_gfd /_bba ;for _efce ,_ca :=range _bdb {_cbg :=_fa [_ca ];_eab :=float64 (len (_cbg ._caf ))+_dae ;_abee :=_fag /_eab ;
_gdd :=_abee *_dae ;_bbgg :=_fg .Bottom -float64 (_efce )*_fag -_gdd /2-_abee ;for _ ,_fb :=range _cbg ._caf {if _fb ._beg ==0{continue ;};var _bfdg ,_cbbc float64 ;if _fb ._beg > 0{_cbbc =_fb ._beg /_cgdd *_aga ;_bed .drawRectangleWithProps (_fb ._gfc ,_gge ,_bbgg ,_cbbc ,_abee ,false );
}else {_cbbc =_fb ._beg /_ade *_bfg ;_bfdg =_gge -_cbbc ;_bed .drawRectangleWithProps (_fb ._gfc ,_bfdg ,_bbgg ,_cbbc ,_abee ,false );};_bbgg -=_abee ;};};}else {_gfe :=_cgdd /(_cgdd -_ade )*_gfd ;_ffa :=-_ade /(_cgdd -_ade )*_gfd ;_aba :=_fg .Top +_gfe ;
_ecbb :=_gac /_bba ;for _aff ,_fba :=range _bdb {_gdcd :=_fa [_fba ];_eedg :=float64 (len (_gdcd ._caf ))+_dae ;_cgcf :=_ecbb /_eedg ;_feb :=_cgcf *_dae ;_aecd :=_fg .Left +float64 (_aff )*_ecbb +_feb /2;for _ ,_bea :=range _gdcd ._caf {var _adbg ,_ccd float64 ;
if _bea ._beg > 0{_ccd =_bea ._beg /_cgdd *_gfe ;_adbg =_aba -_ccd ;_bed .drawRectangleWithProps (_bea ._gfc ,_aecd ,_adbg ,_cgcf ,_ccd ,false );}else {_ccd =_bea ._beg /_ade *_ffa ;_bed .drawRectangleWithProps (_bea ._gfc ,_aecd ,_aba ,_cgcf ,_ccd ,false );
};_aecd +=_cgcf ;};};};return _acd ,nil ;};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _fdea ,_bdd ,_beab uint8 ;_adeg ,_ :=_gd .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_fdea ,&_bdd ,&_beab );
if _adeg !=3{return "";};_cedb ,_fffg ,_gdg :=_dca (_fdea ,_bdd ,_beab );_gdg =lum *_gdg ;_fdea ,_bdd ,_beab =_dge (_cedb ,_fffg ,_gdg );return _gd .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_fdea ,_bdd ,_beab );};func GetColorStringFromDmlColor (dmlColor *_dc .CT_Color )string {var _fcfe string ;
if _gddb :=dmlColor .SrgbClr ;_gddb !=nil {_fcfe =_gddb .ValAttr ;}else if _cgcb :=dmlColor .SysClr ;_cgcb !=nil {if _cgcb .LastClrAttr !=nil {return *_cgcb .LastClrAttr ;};return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _fcfe ;};func GetPageDimensions (size PageSize )_fc .PageSize {return _geea [size ]};
func RegisterEmbeddedFonts (d *_ab .Document )error {_ecec :=d .FontTable ();if _ecec ==nil {return nil ;};for _ ,_dbdf :=range _ecec .Font {if _dbdf .EmbedRegular !=nil {return _gccb (d ,_dbdf .NameAttr ,_dbdf .EmbedRegular .IdAttr ,_dbdf .EmbedRegular .FontKeyAttr );
};if _dbdf .EmbedBold !=nil {return _gccb (d ,_dbdf .NameAttr ,_dbdf .EmbedBold .IdAttr ,_dbdf .EmbedBold .FontKeyAttr );};if _dbdf .EmbedItalic !=nil {return _gccb (d ,_dbdf .NameAttr ,_dbdf .EmbedItalic .IdAttr ,_dbdf .EmbedItalic .FontKeyAttr );};if _dbdf .EmbedBoldItalic !=nil {return _gccb (d ,_dbdf .NameAttr ,_dbdf .EmbedBoldItalic .IdAttr ,_dbdf .EmbedBoldItalic .FontKeyAttr );
};};return nil ;};func (_ecgb *creatorContext )drawAxes (_ede []*_gff .CT_PlotAreaChoice1 ,_ebfe ,_cgfc ,_bcg float64 ,_baad []string ,_bde *Rectangle ,_cgcg bool )error {_gebb :=_ecgb ._bfba ;_ebc :=_ecgb ._bbgec ;if _ede ==nil {return _cd .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");
};var (_aeeb *_gff .CT_ValAx ;_faga *_gff .CT_CatAx ;_feef *_gff .CT_DateAx ;_cfdc *_gff .CT_SerAx ;);for _ ,_gcbf :=range _ede {if _gcbf .ValAx !=nil {_aeeb =_gcbf .ValAx ;}else if _gcbf .CatAx !=nil {_faga =_gcbf .CatAx ;}else if _gcbf .DateAx !=nil {_feef =_gcbf .DateAx ;
}else if _gcbf .SerAx !=nil {_cfdc =_gcbf .SerAx ;};};if _aeeb ==nil ||(_faga ==nil &&_feef ==nil &&_cfdc ==nil ){return _cd .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");};var _dccc ,_bgf ,_agdf ,_bbe uint32 ;
var _aggd ,_ged _gff .ST_AxPos ;var _edg ,_eea _gff .ST_TickMark ;var _ce ,_cdec *_gff .CT_ChartLines ;var _fbf ,_gcda _gff .ST_TickLblPos ;var _baf ,_eba *_dc .CT_ShapeProperties ;var _cbc error ;_fbgg :=_bde .Right -_bde .Left ;_ffbd :=_bde .Bottom -_bde .Top ;
if _aeeb !=nil {_bgf ,_ged ,_eea ,_gcda ,_cdec ,_bbe ,_eba ,_cbc =_dedd (_aeeb );};if _ged !=_gff .ST_AxPosL &&_ged !=_gff .ST_AxPosB {return _cd .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_aeec :=_cgfc -_ebfe ;_bbbg :=int (_aeec /_bcg )+1;var _cab ,_gacd float64 ;switch _eea {case _gff .ST_TickMarkIn :_cab ,_gacd =_cbf ,0;case _gff .ST_TickMarkOut :_cab ,_gacd =0,_cbf ;case _gff .ST_TickMarkCross :_cab ,_gacd =_cbf ,_cbf ;};_cab =_cab *_ebc ;
_gacd =_gacd *_ebc ;var _eff *_dc .CT_ShapeProperties ;if _cdec !=nil {_eff =_cdec .SpPr ;};_baee ,_bede :=_fbf !=_gff .ST_TickLblPosNone ,_gcda !=_gff .ST_TickLblPosNone ;_fff :=_ebfe ;if _faga !=nil {_dccc ,_aggd ,_edg ,_fbf ,_ce ,_agdf ,_baf ,_cbc =_bgce (_faga );
}else if _feef !=nil {_dccc ,_aggd ,_edg ,_fbf ,_ce ,_agdf ,_baf ,_cbc =_ecbf (_feef );}else if _cfdc !=nil {_dccc ,_aggd ,_edg ,_fbf ,_ce ,_agdf ,_baf ,_cbc =_dff (_cfdc );};if _cbc !=nil {return _cbc ;};if _aggd !=_gff .ST_AxPosL &&_aggd !=_gff .ST_AxPosB {return _cd .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _dccc !=_bbe ||_bgf !=_agdf {return _cd .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_gaga :=len (_baad )+1;var _cffd ,_eaf float64 ;switch _edg {case _gff .ST_TickMarkIn :_cffd ,_eaf =_cbf ,0;
case _gff .ST_TickMarkOut :_cffd ,_eaf =0,_cbf ;case _gff .ST_TickMarkCross :_cffd ,_eaf =_cbf ,_cbf ;};_cffd =_cffd *_ebc ;_eaf =_eaf *_ebc ;var _cdc *_dc .CT_ShapeProperties ;if _ce !=nil {_cdc =_ce .SpPr ;};if _cgcg {_ddg :=_ffbd /float64 (len (_baad ));
_ddab :=_bde .Left -_ebfe *_fbgg /_aeec ;_egcd :=_ddab -_fge *_ebc ;if _baee {var _bda float64 ;for _eddf :=0;_eddf < _gaga ;_eddf ++{_debe :=_bde .Bottom -float64 (_eddf )*_ddg ;if _eddf < _gaga -1{_dfgg :=_gebb .NewParagraph (_baad [_eddf ]);_dfgg .SetFontSize (_bgac *_ebc );
_dfgg .SetPos (_egcd ,_debe -_ddg /2-_degd *_ebc );_gebb .Draw (_dfgg );_bfdf :=(_dfgg .Width ()/1000-_fge )*_ebc ;if _bfdf > 0&&_bfdf > _bda {_bda =_bfdf ;};};};if _bda > 0{_bde .Left +=_bda +_daf ;_ddab =_bde .Left -_ebfe *_fbgg /_aeec ;_fbgg =_bde .Right -_bde .Left ;
};};_bafa :=_ddab -_eaf ;_ccdc :=_ddab +_cffd ;_cbff :=_bde .Left ;_gab :=_bde .Right ;for _bdgc :=0;_bdgc < _gaga ;_bdgc ++{_bfgf :=_bde .Bottom -float64 (_bdgc )*_ddg ;_ecgb .drawLineWithProps (_baf ,_bafa ,_bfgf ,_ccdc ,_bfgf ,true );_ecgb .drawLineWithProps (_cdc ,_cbff ,_bfgf ,_gab ,_bfgf ,true );
};_ggbd :=_fbgg /_aeec ;_bcgf :=_bde .Bottom -_cab ;_aab :=_bde .Bottom +_gacd ;_cfdcb :=_bde .Top ;_fbaf :=_bde .Bottom ;for _eedd :=0;_eedd < _bbbg ;_eedd ++{_ebad :=_bde .Left +(_fff -_ebfe )*_ggbd ;_ecgb .drawLineWithProps (_eba ,_ebad ,_bcgf ,_ebad ,_aab ,true );
_ecgb .drawLineWithProps (_eff ,_ebad ,_cfdcb ,_ebad ,_fbaf ,true );if _bede {_eaea :=_gebb .NewParagraph (_da .FormatFloat (_fff ,'g',-1,64));_eaea .SetFontSize (_bgac *_ebc );_eaea .SetPos (_ebad -_efd *_ebc ,_fbaf +_gcf *_ebc );_gebb .Draw (_eaea );
};_fff +=_bcg ;};}else {_aeb :=_ffbd /_aeec ;_bdgcd :=_bde .Left ;if _bede {var _agae float64 ;for _caac :=0;_caac < _bbbg ;_caac ++{_bgb :=_bde .Bottom -(_fff -_ebfe )*_aeb ;_dbge :=_gebb .NewParagraph (_da .FormatFloat (_fff ,'g',-1,64));_dbge .SetFontSize (_bgac *_ebc );
_dbge .SetPos (_bdgcd -_fge *_ebc ,_bgb -_degd *_ebc );_gebb .Draw (_dbge );_gdb :=(_dbge .Width ()/1000-_fge )*_ebc ;if _gdb > 0&&_gdb > _agae {_agae =_gdb ;};_fff +=_bcg ;};if _agae > 0{_bde .Left +=_agae +_daf ;_fbgg =_bde .Right -_bde .Left ;};};_fff =_ebfe ;
_gfdd :=_bde .Left -_gacd ;_egae :=_bde .Left +_cab ;_bdgcd =_bde .Left ;_cbd :=_bde .Right ;for _eaec :=0;_eaec < _bbbg ;_eaec ++{_bcec :=_bde .Bottom -(_fff -_ebfe )*_aeb ;_ecgb .drawLineWithProps (_eba ,_gfdd ,_bcec ,_egae ,_bcec ,true );_ecgb .drawLineWithProps (_eff ,_bdgcd ,_bcec ,_cbd ,_bcec ,true );
_fff +=_bcg ;};_ddb :=_fbgg /float64 (len (_baad ));_bafg :=_bde .Bottom +_ebfe *_ffbd /_aeec ;_ggbe :=_bafg -_cffd ;_cffdf :=_bafg +_eaf ;_ece :=_bde .Top ;_agfea :=_bde .Bottom ;_gadg :=_bafg +_gcf *_ebc ;for _ebfa :=0;_ebfa < _gaga ;_ebfa ++{_baae :=_bde .Left +float64 (_ebfa )*_ddb ;
_ecgb .drawLineWithProps (_baf ,_baae ,_ggbe ,_baae ,_cffdf ,true );_ecgb .drawLineWithProps (_cdc ,_baae ,_ece ,_baae ,_agfea ,true );if _baee &&_ebfa < _gaga -1{_dbf :=_gebb .NewParagraph (_baad [_ebfa ]);_dbf .SetFontSize (_bgac *_ebc );_dbf .SetPos (_baae +_gfa *_ebc ,_gadg );
_gebb .Draw (_dbf );};};};return nil ;};func MakeBlockFromChartSpace (cs *_gff .ChartSpace ,width ,height float64 ,theme *_dc .Theme )(*_fc .Block ,error ){_bfgc ,_bff :=_cfc (cs ,width ,height ,theme ,false ,nil );if _bff !=nil {return nil ,_bff ;};_bae ,_bff :=GetPageFromCreator (_bfgc );
if _bff !=nil {return nil ,_bff ;};_bcd ,_bff :=_fc .NewBlockFromPage (_bae );if _bff !=nil {return nil ,_bff ;};return _bcd ,nil ;};func (_bbgb *creatorContext )drawBorderWithProps (_acdg *_dc .CT_ShapeProperties ,_ffcfd *Rectangle ,_efbe float64 ){if _ffcfd !=nil &&_acdg !=nil &&_acdg .Ln !=nil &&_acdg .Ln .LineFillPropertiesChoice .SolidFill !=nil {_aag :=_bbgb .getPdfColorFromSolidFill (_acdg .Ln .LineFillPropertiesChoice .SolidFill );
DrawRectangle (_bbgb ._bfba ,_ffcfd ,_efbe ,_aag );};};func _gccb (_gddf *_ab .Document ,_dbgc ,_ebabg ,_dbga string )error {_cadc ,_adcf :=_gddf .GetFontBytesByRelId (_ebabg );if _adcf !=nil {return _adcf ;};_egbec ,_adcf :=_ggc (_dbga );if _adcf !=nil {return _adcf ;
};for _cge :=0;_cge < 32;_cge ++{_bab :=_cge %len (_egbec );_cadc [_cge ]=_cadc [_cge ]^_egbec [_bab ];};_cgcc :=_gddf .TmpPath +"\u002f"+_dbgc +"\u002e\u0074\u0074\u0066";_adcf =_eb .WriteFile (_cgcc ,_cadc ,0644);if _adcf !=nil {return _adcf ;};_gee (_cgcc );
return nil ;};func _bcca (_cbab float64 )float64 {if _cbab < 0{_cbab +=float64 (-int (_cbab )+1);}else if _cbab > 1{_cbab -=float64 (int (_cbab ));};return _cbab ;};func (_cbge *Rectangle )scale (_ecbef float64 ){_cbge .Top *=_ecbef ;_cbge .Bottom *=_ecbef ;
_cbge .Left *=_ecbef ;_cbge .Right *=_ecbef ;};func _cfc (_ed *_gff .ChartSpace ,_acdf ,_gbc float64 ,_gead *_dc .Theme ,_dgdc bool ,_dbe *_bee .Workbook )(*_fc .Creator ,error ){_bedd :=1.0;if _dgdc {_bedd =8.0;};_fceg :=&Rectangle {};_ded :=&Rectangle {Top :_fceg .Top ,Bottom :_gbc -_fceg .Bottom ,Left :_fceg .Left ,Right :_acdf -_fceg .Right };
_dgde :=MakeTempCreator (_acdf *_bedd +1,_gbc *_bedd +1);_fcfd :=&creatorContext {_bfba :_dgde ,_aada :_gead ,_bbgec :_bedd };var _dabg bool ;if _dgc :=_ed .Chart ;_dgc !=nil {_fed :=_dgc .PlotArea ;if _fed ==nil {return nil ,_cd .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");
};_eeb :=0.0;if _dgc .AutoTitleDeleted !=nil &&_dgc .AutoTitleDeleted .ValAttr !=nil &&!*_dgc .AutoTitleDeleted .ValAttr {if _dgc .Title !=nil &&_dgc .Title .Overlay !=nil &&_dgc .Title .Overlay .ValAttr !=nil &&!*_dgc .Title .Overlay .ValAttr {_eeb =_eedce (10);
};_cfe :=_fcfd .getTitle (_dgc .Title );if _cfe ==""{_cfe ="C\u0068\u0061\u0072\u0074\u0020\u0054\u0069\u0074\u006c\u0065";};_fcfd .drawTitle (_cfe ,_ded .Left +_ded .Right /2,_eedce (5));};_dfa :=&Rectangle {Top :_eedce (10)+_eeb ,Bottom :_ded .Bottom -_eedce (15),Left :_eedce (10),Right :_ded .Right -_eedce (10)};
var _ega *Rectangle ;_gcd :=_dgc .Legend ;if _gcd !=nil {_dfg :=_gcd .Overlay !=nil &&_gcd .Overlay .ValAttr !=nil &&*_gcd .Overlay .ValAttr ;if _faee :=_gcd .LegendPos ;_faee !=nil {switch _faee .ValAttr {case _gff .ST_LegendPosTr :if !_dfg {_dfa =&Rectangle {Top :_eedce (25)+_eeb ,Bottom :_ded .Bottom -_eedce (10),Left :_eedce (10),Right :_ded .Right -_eedce (25)};
};_ega =&Rectangle {Top :_eedce (2.5)+_eeb ,Bottom :_eedce (22.5),Left :_ded .Right -_eedce (22.5),Right :_ded .Right -_eedce (2.5)};case _gff .ST_LegendPosT :_ega =&Rectangle {Top :_eedce (2.5)+_eeb ,Bottom :_eedce (7.5),Left :(_ded .Right -_ded .Left )*0.25,Right :(_ded .Right -_ded .Left )*0.75};
if !_dfg {_dfa =&Rectangle {Top :_eedce (12.5)+_eeb ,Bottom :_ded .Bottom -_eedce (15),Left :_eedce (10),Right :_ded .Right -_eedce (5)};};_dabg =true ;case _gff .ST_LegendPosB :_ega =&Rectangle {Top :_ded .Bottom -_eedce (7.5)+_eeb ,Bottom :_ded .Bottom -_eedce (2.5),Left :(_ded .Right -_ded .Left )*0.25,Right :(_ded .Right -_ded .Left )*0.75};
if !_dfg {_dfa =&Rectangle {Top :_eedce (5)+_eeb ,Bottom :_ded .Bottom -_eedce (15),Left :_eedce (10),Right :_ded .Right -_eedce (5)};};_dabg =true ;case _gff .ST_LegendPosR :_ega =&Rectangle {Top :(_ded .Bottom -_ded .Top )/2-_eedce (10)+_eeb ,Bottom :(_ded .Bottom -_ded .Top )/2+_eedce (10),Left :_ded .Right -_eedce (22.5),Right :_ded .Right -_eedce (2.5)};
if !_dfg {_dfa =&Rectangle {Top :_eedce (5)+_eeb ,Bottom :_ded .Bottom -_eedce (12.5),Left :_eedce (10),Right :_ded .Right -_eedce (25)};};case _gff .ST_LegendPosL :_ega =&Rectangle {Top :(_ded .Bottom -_ded .Top )/2-_eedce (10)+_eeb ,Bottom :(_ded .Bottom -_ded .Top )/2+_eedce (10),Left :_eedce (2.5),Right :_eedce (22.5)};
if !_dfg {_dfa =&Rectangle {Top :_eedce (5)+_eeb ,Bottom :_ded .Bottom -_eedce (12.5),Left :_eedce (30),Right :_ded .Right -_eedce (5)};};default:_ega =&Rectangle {Top :(_ded .Bottom -_ded .Top )/2-_eedce (10)+_eeb ,Bottom :(_ded .Bottom -_ded .Top )/2+_eedce (10),Left :_ded .Right -_eedce (25),Right :_ded .Right -_eedce (5)};
if !_dfg {_dfa =&Rectangle {Top :_eedce (5)+_eeb ,Bottom :_ded .Bottom -_eedce (12.5),Left :_eedce (100),Right :_ded .Right -_eedce (25)};};};};};_dfa .scale (_bedd );_fcfd .drawBorderWithProps (_fed .SpPr ,_dfa ,_fad );_edd :=[]*legendItem {};var _cgff error ;
_dcb :=_fed .PlotAreaChoice1 ;for _ ,_gce :=range _fed .PlotAreaChoice {if _ace :=_gce .BarChart ;_ace !=nil {_edd ,_cgff =_fcfd .drawBarChart (_ace ,_dfa ,_dcb ,_dbe );if _cgff !=nil {return nil ,_cgff ;};break ;};if _aefd :=_gce .PieChart ;_aefd !=nil {_edd ,_cgff =_fcfd .drawPieChart (_aefd ,_dfa ,_dbe ,_bedd );
if _cgff !=nil {return nil ,_cgff ;};break ;};if _bcfb :=_gce .ScatterChart ;_bcfb !=nil {_edd ,_cgff =_fcfd .drawScatterChart (_bcfb ,_dfa ,_dcb ,_bedd );if _cgff !=nil {return nil ,_cgff ;};break ;};if _cag :=_gce .LineChart ;_cag !=nil {_edd ,_cgff =_fcfd .drawLineChart (_cag ,_dfa ,_dcb ,_bedd );
if _cgff !=nil {return nil ,_cgff ;};break ;};if _bffg :=_gce .AreaChart ;_bffg !=nil {_edd ,_cgff =_fcfd .drawAreaChart (_bffg ,_dfa ,_dcb ,_bedd );if _cgff !=nil {return nil ,_cgff ;};break ;};};if _gcd !=nil {_ega .scale (_bedd );_fcfd .drawBorderWithProps (_gcd .SpPr ,_ega ,_fad );
if len (_edd )!=0{_fcfd .drawLegend (_ega ,_edd ,_dabg );};};};_ded .scale (_bedd );_fcfd .drawBorderWithProps (_ed .SpPr ,_ded ,_fad );return _dgde ,nil ;};func AdjustColorByShade (colorStr string ,shade float64 )string {var _fbge ,_cbfd ,_eda uint8 ;
_bgfa ,_ :=_gd .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_fbge ,&_cbfd ,&_eda );if _bgfa !=3{return "";};return _aaa (_fbge ,shade )+_aaa (_cbfd ,shade )+_aaa (_eda ,shade );};func _dedd (_dfc *_gff .CT_ValAx )(uint32 ,_gff .ST_AxPos ,_gff .ST_TickMark ,_gff .ST_TickLblPos ,*_gff .CT_ChartLines ,uint32 ,*_dc .CT_ShapeProperties ,error ){var _fbfg ,_bgeg uint32 ;
var _eeaa _gff .ST_AxPos ;var _gefa _gff .ST_TickMark ;var _ebab *_gff .CT_ChartLines ;var _bcb _gff .ST_TickLblPos ;if _dfc .AxId ==nil {return _fbfg ,_eeaa ,_gefa ,_bcb ,_ebab ,_bgeg ,_dfc .SpPr ,_cd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_fbfg =_dfc .AxId .ValAttr ;};if _dfc .AxPos ==nil {return _fbfg ,_eeaa ,_gefa ,_bcb ,_ebab ,_bgeg ,_dfc .SpPr ,_cd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_eeaa =_dfc .AxPos .ValAttr ;
};if _dfc .MajorTickMark !=nil {_gefa =_dfc .MajorTickMark .ValAttr ;};if _dfc .TickLblPos !=nil {_bcb =_dfc .TickLblPos .ValAttr ;};if _dfc .CrossAx ==nil {return _fbfg ,_eeaa ,_gefa ,_bcb ,_ebab ,_bgeg ,_dfc .SpPr ,_cd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_bgeg =_dfc .CrossAx .ValAttr ;};_ebab =_dfc .MajorGridlines ;return _fbfg ,_eeaa ,_gefa ,_bcb ,_ebab ,_bgeg ,_dfc .SpPr ,nil ;};func _ggc (_fbad string )([]byte ,error ){_fcff :=_e .MustCompile ("\u005b\u005e\u0061\u002d\u007a\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u002b");
_fbad =_fcff .ReplaceAllString (_fbad ,"");_add :=[]rune (_fbad );_gfedg :=[]byte {};for _gfea :=len (_add )-2;_gfea >=0;_gfea -=2{_ggd ,_cgca :=_da .ParseUint (string (_add [_gfea ])+string (_add [_gfea +1]),16,8);if _cgca !=nil {return nil ,_cgca ;};
_gfedg =append (_gfedg ,byte (_ggd ));};return _gfedg ,nil ;};func _dff (_gbfb *_gff .CT_SerAx )(uint32 ,_gff .ST_AxPos ,_gff .ST_TickMark ,_gff .ST_TickLblPos ,*_gff .CT_ChartLines ,uint32 ,*_dc .CT_ShapeProperties ,error ){var _dgaf ,_gfad uint32 ;var _gcdd _gff .ST_AxPos ;
var _egb _gff .ST_TickMark ;var _baaeb *_gff .CT_ChartLines ;var _fda _gff .ST_TickLblPos ;if _gbfb .AxId ==nil {return _dgaf ,_gcdd ,_egb ,_fda ,_baaeb ,_gfad ,_gbfb .SpPr ,_cd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_dgaf =_gbfb .AxId .ValAttr ;};if _gbfb .AxPos ==nil {return _dgaf ,_gcdd ,_egb ,_fda ,_baaeb ,_gfad ,_gbfb .SpPr ,_cd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_gcdd =_gbfb .AxPos .ValAttr ;
};if _gbfb .MajorTickMark !=nil {_egb =_gbfb .MajorTickMark .ValAttr ;};if _gbfb .TickLblPos !=nil {_fda =_gbfb .TickLblPos .ValAttr ;};if _gbfb .CrossAx ==nil {return _dgaf ,_gcdd ,_egb ,_fda ,_baaeb ,_gfad ,_gbfb .SpPr ,_cd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_gfad =_gbfb .CrossAx .ValAttr ;};_baaeb =_gbfb .MajorGridlines ;return _dgaf ,_gcdd ,_egb ,_fda ,_baaeb ,_gfad ,_gbfb .SpPr ,nil ;};func (_aeg *creatorContext )getTitle (_gag *_gff .CT_Title )string {_daa :="";if _gag !=nil &&_gag .Tx !=nil &&_gag .Tx .TxChoice !=nil &&_gag .Tx .TxChoice .Rich !=nil {if len (_gag .Tx .TxChoice .Rich .P )> 0{for _ ,_gadd :=range _gag .Tx .TxChoice .Rich .P {if len (_gadd .EG_TextRun )> 0{_daa +="\u000a"+_gadd .EG_TextRun [0].TextRunChoice .R .T ;
};};};};return _daa ;};var _gfa =_eedce (5);func IsNoSpaceLanguage (symbol string )bool {for _ ,_begc :=range symbol {if _cb .Is (_cb .Han ,_begc ){return true ;};};return false ;};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
func MakeTempCreator (width ,height float64 )*_fc .Creator {_gggb :=_fc .New ();_gggb .SetPageSize (_fc .PageSize {width ,height });_gggb .SetPageMargins (0,0,0,0);return _gggb ;};func GetRegisteredFont (name string ,style FontStyle )*_a .PdfFont {_fbc ._dbef .Lock ();
defer _fbc ._dbef .Unlock ();if _aecb ,_ggf :=_fbc ._gbd [name ];_ggf {if _edeg ,_eebb :=_aecb [style ];_eebb {return _edeg ;};};return nil ;};func (_acbbb *creatorContext )drawPieChart (_ebg *_gff .CT_PieChart ,_dfce *Rectangle ,_efdg *_bee .Workbook ,_geaf float64 )([]*legendItem ,error ){_ffbb :=[]*legendItem {};
_eecb :=map[string ]serCategory {};_fcddc :=[]string {};_aaca :=_be .Inf (1);_ccaa :=_be .Inf (-1);_abb :=_ebg .Ser ;for _ ,_aefea :=range _abb {var _ddc string ;if _fgc :=_aefea .Tx ;_fgc !=nil {if _fbdg :=_fgc .SerTxChoice ;_fbdg !=nil {if _fbdg .V !=nil {_ddc =*_fbdg .V ;
}else if _gga :=_fbdg .StrRef ;_gga !=nil {if _bgbf :=_gga .StrCache ;_bgbf !=nil {for _ ,_cfdg :=range _bgbf .Pt {_ddc =_cfdg .V ;};};};};};if _dcg :=_aefea .Cat ;_dcg !=nil {if _gbff :=_dcg .AxDataSourceChoice ;_gbff !=nil {if _edfb :=_gbff .StrRef ;
_edfb !=nil {if _gdcdc :=_edfb .F ;_gdcdc !=""&&_efdg !=nil {_bdge ,_ebgd ,_dgeg ,_gedf :=ParseExcelRange (_gdcdc );if _gedf ==nil {for _ ,_bag :=range _efdg .Sheets (){if _bag .Name ()==_bf .Trim (_bdge ,"\u0027"){_ccf :=_ebgd .String ();for _aebd :=_ebgd .RowIdx ;
_aebd <=_dgeg .RowIdx ;_aebd +=1{_edc :=_bf .ReplaceAll (_ccf ,_gd .Sprint (_ebgd .RowIdx ),_gd .Sprint (_aebd ));_acbbb .addCatName (_bag .Cell (_edc ).GetString (),_eecb ,&_fcddc );};break ;};};};};if _fdgf :=_edfb .StrCache ;_fdgf !=nil {for _ ,_ffce :=range _fdgf .Pt {_acbbb .addCatName (_ffce .V ,_eecb ,&_fcddc );
};};}else if _afag :=_gbff .NumRef ;_afag !=nil {if _cbcc :=_afag .NumCache ;_cbcc !=nil {var _cabe string ;if _cbcc .FormatCode !=nil {_cabe =*_cbcc .FormatCode ;};for _ ,_cfced :=range _cbcc .Pt {var _dbff string ;if _cfced .FormatCodeAttr ==nil {_dbff =_cabe ;
}else {_dbff =*_cfced .FormatCodeAttr ;};var _bafgg string ;_gffee ,_agbf :=_da .ParseFloat (_cfced .V ,64);if _agbf !=nil {_bafgg =_cfced .V ;}else {_bafgg =_de .Number (_gffee ,_dbff );};_acbbb .addCatName (_bafgg ,_eecb ,&_fcddc );};};};};};if _fcc :=_aefea .Val ;
_fcc !=nil {if _dfcd :=_fcc .NumDataSourceChoice ;_dfcd !=nil {if _baff :=_dfcd .NumRef ;_baff !=nil {if _bbcd :=_baff .F ;_bbcd !=""&&_efdg !=nil {_aaba ,_dbcd ,_gbfe ,_aacb :=ParseExcelRange (_bbcd );if _aacb ==nil {for _ ,_gceg :=range _efdg .Sheets (){if _gceg .Name ()==_bf .Trim (_aaba ,"\u0027"){_cfga :=_dbcd .String ();
for _ffg :=_dbcd .RowIdx ;_ffg <=_gbfe .RowIdx ;_ffg +=1{_faaa :=_bf .ReplaceAll (_cfga ,_gd .Sprint (_dbcd .RowIdx ),_gd .Sprint (_ffg ));if _gceg .FormulaContext ().HasFormula (_faaa ){_gade :=_cda .NewEvaluator ();_cgddc :=_gceg .FormulaContext ().Cell (_faaa ,_gade );
_fgca :=_cgddc .Value ();_acbbb .addCatValue (_fgca ,_eecb ,_fcddc ,(int )(_ffg -_dbcd .RowIdx ),&_aaca ,&_ccaa ,_ddc ,_aefea .SpPr );}else {_effc :=_gceg .Cell (_faaa ).GetString ();_acbbb .addCatValue (_effc ,_eecb ,_fcddc ,(int )(_ffg -_dbcd .RowIdx ),&_aaca ,&_ccaa ,_ddc ,_aefea .SpPr );
};};break ;};};};};if _ddge :=_baff .NumCache ;_ddge !=nil {for _bcdg ,_cecf :=range _ddge .Pt {_acbbb .addCatValue (_cecf .V ,_eecb ,_fcddc ,_bcdg ,&_aaca ,&_ccaa ,_ddc ,_aefea .SpPr );};};};};};};_baaa :=&_f .PieChart {Values :[]_fcg .Value {}};for _ ,_gcbc :=range _fcddc {_fgf :=_eecb [_gcbc ];
if len (_fgf ._caf )> 0{_baaa .Values =append (_baaa .Values ,_fcg .Value {Value :_fgf ._caf [0]._beg ,Label :_gcbc ,Style :_ae .Style {FontSize :12*_geaf }});};};_baaa .SetHeight (int (_dfce .Top -_dfce .Bottom ));_baaa .SetWidth (int (_dfce .Right -_dfce .Left ));
_ddbf :=_acbbb ._bfba ;_bagd :=_fc .NewChart (_baaa );_bagd .SetPos (_dfce .Left ,_dfce .Top );_feac :=_ddbf .Draw (_bagd );if _feac !=nil {return nil ,_feac ;};return _ffbb ,nil ;};func GetOpacityFromColorTransform (trs []*_dc .EG_ColorTransform )float64 {for _ ,_aabg :=range trs {if _aabg !=nil {if _cfa :=_aabg .ColorTransformChoice .Alpha ;
_cfa !=nil {if _cbfe :=_cfa .ValAttr .ST_PositiveFixedPercentageDecimal ;_cbfe !=nil {return float64 (*_cbfe )/Percent100 ;};};};};return 1.0;};type BorderPosition byte ;func ClearRegisteredFonts (){_fbc ._dbef .Lock ();_fbc ._gbd =map[string ]map[FontStyle ]*_a .PdfFont {};
_fbc ._dbef .Unlock ();};func (_dafde *creatorContext )drawLineWithProps (_ecd *_dc .CT_ShapeProperties ,_aafe ,_afga ,_gadc ,_fcffa float64 ,_bdbe bool ){if _ecd !=nil {if _affg :=_ecd .Ln ;_affg !=nil {_gabb :=_dafde .getPdfColorFromSolidFill (_affg .LineFillPropertiesChoice .SolidFill );
if _gabb ==nil &&_bdbe {_gabb =_fc .ColorBlack ;};if _gabb !=nil {var _eacg float64 ;if _abd :=_affg .WAttr ;_abd !=nil {_eacg =_gffe .FromEMU (int64 (*_abd ));}else {_eacg =_fad ;};DrawLine (_dafde ._bfba ,_aafe ,_afga ,_gadc ,_fcffa ,_eacg ,_gabb );};
};};};func (_agge *creatorContext )addCatName (_abgf string ,_afc map[string ]serCategory ,_ebf *[]string ){if _ ,_gddc :=_afc [_abgf ];!_gddc {_afc [_abgf ]=serCategory {_ggg :_abgf ,_caf :[]serValue {}};*_ebf =append (*_ebf ,_abgf );};};func AssignStdFontByName (style _fc .TextStyle ,fontName string )*_a .PdfFont {_gbfbc :=_a .StdFontName (fontName );
return _a .NewStandard14FontMustCompile (_gbfbc );};const (PageSizeA4 PageSize =iota ;PageSizeA3 ;PageSizeA5 ;PageSizeLetter ;PageSizeLegal ;Percent100 =100000.0;MaxPageHeight =11906;);var _degd =_eedce (1.5);var _gcf =_eedce (1.5);func (_fdcb *creatorContext )getPdfColorFromSolidFill (_dceg *_dc .CT_SolidColorFillProperties )_fc .Color {if _dceg ==nil {return nil ;
};_feaad :="";if _bgead :=_dceg .SrgbClr ;_bgead !=nil {_feaad =_bgead .ValAttr ;}else if _ffbe :=_dceg .SchemeClr ;_ffbe !=nil {_feaad =_cgde (_ffbe .ValAttr ,_fdcb ._aada );_feaad =AdjustColor (_feaad ,_ffbe .EG_ColorTransform );};if _feaad ==""{return nil ;
};return _fc .ColorRGBFromHex ("\u0023"+_feaad );};func _dge (_eef ,_afdb ,_bgaa float64 )(uint8 ,uint8 ,uint8 ){var _dgag float64 ;if _bgaa < 0.5{_dgag =_bgaa *(1+_afdb );}else {_dgag =_bgaa +_afdb -_bgaa *_afdb ;};_ccaf :=_bgaa *2-_dgag ;_eef /=360.0;
_cffcf :=_bcca (_eef +1.0/3.0);_bfc :=_bcca (_eef );_fga :=_bcca (_eef -1.0/3.0);_edde :=_fded (_cffcf ,_dgag ,_ccaf );_abf :=_fded (_bfc ,_dgag ,_ccaf );_dccf :=_fded (_fga ,_dgag ,_ccaf );return uint8 (255*_edde ),uint8 (255*_abf ),uint8 (255*_dccf );
};func GetGroupOffsetFromXfrm (xfrm *_dc .CT_GroupTransform2D )(float64 ,float64 ){var _ddeb ,_cgdf float64 ;if xfrm .Off !=nil &&xfrm .ChOff !=nil {_ddeb =_gffe .FromEMU (FromSTCoordinate (xfrm .Off .XAttr ))-_gffe .FromEMU (FromSTCoordinate (xfrm .ChOff .XAttr ));
_cgdf =_gffe .FromEMU (FromSTCoordinate (xfrm .Off .YAttr ))-_gffe .FromEMU (FromSTCoordinate (xfrm .ChOff .YAttr ));};return _ddeb ,_cgdf ;};var _fbc =fontsMap {_dbef :&_cg .Mutex {},_gbd :map[string ]map[FontStyle ]*_a .PdfFont {}};func DrawRectangle (c *_fc .Creator ,r *Rectangle ,w float64 ,color _fc .Color ){if color ==nil {return ;
};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};
const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func DrawLine (c *_fc .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _fc .Color ){if color ==nil {return ;};_dfgd :=c .NewLine (x0 ,y0 ,x1 ,y1 );
_dfgd .SetLineWidth (width );_dfgd .SetColor (color );c .Draw (_dfgd );};var _dfacb =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
func (_cage *creatorContext )drawLineChart (_ceg *_gff .CT_LineChart ,_cbdg *Rectangle ,_debea []*_gff .CT_PlotAreaChoice1 ,_gbaa float64 )([]*legendItem ,error ){_gec :=[]*legendItem {};_gdge :=_ceg .Ser ;_dced :=make (map[int ][]float64 );_gfg :=make (map[int ][]float64 );
_affb :=make (map[int ]_fc .Color );_dee :=make (map[int ]float64 );for _gged ,_cfda :=range _gdge {var _gbg string ;if _cce :=_cfda .Tx ;_cce !=nil {if _efcc :=_cce .SerTxChoice ;_efcc !=nil {if _efcc .V !=nil {_gbg =*_efcc .V ;}else if _gdbf :=_efcc .StrRef ;
_gdbf !=nil {if _ccbe :=_gdbf .StrCache ;_ccbe !=nil {for _ ,_bcee :=range _ccbe .Pt {_gbg =_bcee .V ;};};};};};_affb [_gged ]=_fc .ColorWhite ;if _ddd :=_cfda .SpPr ;_ddd !=nil {if _fdd :=_ddd .Ln ;_fdd !=nil {if _gbfa :=_fdd .WAttr ;_gbfa !=nil {_dee [_gged ]=_gffe .FromEMU (int64 (*_gbfa ));
if _aece :=_fdd .LineFillPropertiesChoice .SolidFill ;_aece !=nil {_gagaf :=_cage .getPdfColorFromSolidFill (_aece );if _gagaf !=nil {_affb [_gged ]=_gagaf ;};};};};};if _affd :=_cfda .Val ;_affd !=nil {if _bceb :=_affd .NumDataSourceChoice ;_bceb !=nil {if _fgdd :=_bceb .NumRef ;
_fgdd !=nil {if _efb :=_fgdd .NumCache ;_efb !=nil {for _ ,_fgea :=range _efb .Pt {_dced [_gged ]=append (_dced [_gged ],float64 (_fgea .IdxAttr ));_bbbd ,_ :=_da .ParseFloat (_bf .TrimSpace (_fgea .V ),64);_gfg [_gged ]=append (_gfg [_gged ],_bbbd );};
};};};};_gec =append (_gec ,&legendItem {_ada :_gbg ,_acf :_cfda .SpPr });};_cafd :=true ;_cbcb :=true ;_dddd :="";_ffc :="";if len (_debea )> 0{for _ ,_fdfg :=range _debea {if _fdfg .CatAx !=nil {if _fdfg .CatAx .Delete !=nil {if !*(*_fdfg .CatAx .Delete ).ValAttr {_cafd =false ;
};};_dddd =_cage .getTitle (_fdfg .CatAx .Title );}else if _fdfg .ValAx !=nil {if _fdfg .ValAx .Delete !=nil {if !*(*_fdfg .ValAx .Delete ).ValAttr {_cbcb =false ;};};_ffc =_cage .getTitle (_fdfg .ValAx .Title );};};};_ebb :=_ae .Style {Hidden :_cafd ,FontSize :8*_gbaa };
_gde :=_ae .Style {Hidden :_cbcb ,FontSize :8*_gbaa };_bcff :=&_f .Chart {Series :[]_fcg .Series {},YAxisSecondary :_f .YAxis {Style :_gde ,Name :_ffc ,NameStyle :_gde },XAxis :_f .XAxis {Style :_ebb ,Name :_dddd ,NameStyle :_ebb },YAxis :_f .YAxis {Style :_ae .Style {Hidden :true }}};
for _adge :=0;_adge < len (_affb );_adge ++{_aegg ,_gefg ,_cdfd :=_affb [_adge ].ToRGB ();_gggf :=_fcg .ContinuousSeries {XValues :_dced [_adge ],YValues :_gfg [_adge ],Style :_ae .Style {StrokeColor :_d .RGBA {uint8 (_aegg *255),uint8 (_gefg *255),uint8 (_cdfd *255),255},StrokeWidth :_dee [_adge ]}};
_bcff .Series =append (_bcff .Series ,_gggf );};_bcff .SetHeight (int (_be .Abs (_cbdg .Top -_cbdg .Bottom )));_bcff .SetWidth (int (_be .Abs (_cbdg .Right -_cbdg .Left )));_gcg :=_cage ._bfba ;_cgda :=_fc .NewChart (_bcff );_cgda .SetPos (_cbdg .Left ,_cbdg .Top );
_eafa :=_gcg .Draw (_cgda );if _eafa !=nil {return nil ,_eafa ;};return _gec ,nil ;};func (_eaeb FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_eaeb )];
};func RegisterFontsFromFiles (files []string )error {for _ ,_ceca :=range files {if _bf .HasSuffix (_ceca ,"\u002e\u0074\u0074\u0066"){_fgga :=_gee (_ceca );if _fgga !=nil {_abe .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_fgga );
continue ;};};};return nil ;};func FromSTCoordinate (st _dc .ST_Coordinate )int64 {if _gfdf :=st .ST_CoordinateUnqualified ;_gfdf !=nil {return *_gfdf ;};return 0;};func _bgce (_gef *_gff .CT_CatAx )(uint32 ,_gff .ST_AxPos ,_gff .ST_TickMark ,_gff .ST_TickLblPos ,*_gff .CT_ChartLines ,uint32 ,*_dc .CT_ShapeProperties ,error ){var _ffdb ,_fgd uint32 ;
var _bad _gff .ST_AxPos ;var _ced _gff .ST_TickMark ;var _dga *_gff .CT_ChartLines ;var _fcgg _gff .ST_TickLblPos ;if _gef .AxId ==nil {return _ffdb ,_bad ,_ced ,_fcgg ,_dga ,_fgd ,_gef .SpPr ,_cd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_ffdb =_gef .AxId .ValAttr ;};if _gef .AxPos ==nil {return _ffdb ,_bad ,_ced ,_fcgg ,_dga ,_fgd ,_gef .SpPr ,_cd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_bad =_gef .AxPos .ValAttr ;
};if _gef .MajorTickMark !=nil {_ced =_gef .MajorTickMark .ValAttr ;};if _gef .TickLblPos !=nil {_fcgg =_gef .TickLblPos .ValAttr ;};if _gef .CrossAx ==nil {return _ffdb ,_bad ,_ced ,_fcgg ,_dga ,_fgd ,_gef .SpPr ,_cd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_fgd =_gef .CrossAx .ValAttr ;};_dga =_gef .MajorGridlines ;return _ffdb ,_bad ,_ced ,_fcgg ,_dga ,_fgd ,_gef .SpPr ,nil ;};func RegisterFont (name string ,style FontStyle ,font *_a .PdfFont ){_fbc ._dbef .Lock ();if _fbc ._gbd [name ]==nil {_fbc ._gbd [name ]=map[FontStyle ]*_a .PdfFont {};
};_fbc ._gbd [name ][style ]=font ;_fbc ._dbef .Unlock ();};func (_fffe *creatorContext )drawScatterChart (_cafa *_gff .CT_ScatterChart ,_dcgf *Rectangle ,_dbffe []*_gff .CT_PlotAreaChoice1 ,_bbae float64 )([]*legendItem ,error ){_cgdab :=[]*legendItem {};
_dafd :=_cafa .Ser ;_gdgb :=make (map[string ]float64 );_aafd :=make (map[string ][]float64 );_dgg :=make (map[string ][]float64 );_acad :=[]string {};for _ ,_bcfd :=range _dafd {var _aeea string ;if _defb :=_bcfd .Tx ;_defb !=nil {if _acef :=_defb .SerTxChoice ;
_acef !=nil {if _acef .V !=nil {_aeea =*_acef .V ;}else if _dcag :=_acef .StrRef ;_dcag !=nil {if _fdca :=_dcag .StrCache ;_fdca !=nil {for _ ,_bdde :=range _fdca .Pt {_aeea =_bdde .V ;};};};_acad =append (_acad ,_aeea );};};if _bcfd .Marker !=nil &&_bcfd .Marker .Size !=nil {_gdgb [_aeea ]=float64 (*_bcfd .Marker .Size .ValAttr );
}else {_gdgb [_aeea ]=-1.0;};if _bgd :=_bcfd .XVal ;_bgd !=nil {if _gbb :=_bgd .AxDataSourceChoice ;_gbb !=nil {if _agaag :=_gbb .NumRef ;_agaag !=nil {if _beb :=_agaag .NumCache ;_beb !=nil {for _ ,_abc :=range _beb .Pt {_acee ,_ :=_da .ParseFloat (_bf .TrimSpace (_abc .V ),64);
_aafd [_aeea ]=append (_aafd [_aeea ],_acee );};};};};};if _dcee :=_bcfd .YVal ;_dcee !=nil {if _efed :=_dcee .NumDataSourceChoice ;_efed !=nil {if _cgba :=_efed .NumRef ;_cgba !=nil {if _abbc :=_cgba .NumCache ;_abbc !=nil {for _ ,_eadc :=range _abbc .Pt {_cfcg ,_ :=_da .ParseFloat (_bf .TrimSpace (_eadc .V ),64);
_dgg [_aeea ]=append (_dgg [_aeea ],_cfcg );};};};};};};_ceaa :=true ;_aegge :="";_bgea :="";if len (_dbffe )> 1{if _dbffe [0].ValAx .Delete !=nil &&_dbffe [1].ValAx .Delete !=nil {if !*(*_dbffe [0].ValAx .Delete ).ValAttr &&!*(*_dbffe [1].ValAx .Delete ).ValAttr {_ceaa =false ;
};};_aegge =_fffe .getTitle (_dbffe [0].ValAx .Title );_bgea =_fffe .getTitle (_dbffe [1].ValAx .Title );};_gdcg :=_ae .Style {Hidden :_ceaa ,FontSize :8*_bbae };_afdf :=&_f .Chart {Series :[]_fcg .Series {},YAxisSecondary :_f .YAxis {Style :_gdcg ,Name :_bgea ,NameStyle :_gdcg },XAxis :_f .XAxis {Style :_gdcg ,Name :_aegge ,NameStyle :_gdcg },YAxis :_f .YAxis {Style :_ae .Style {Hidden :true }}};
for _ ,_ceda :=range _acad {_gfeb :=_fcg .ContinuousSeries {XValues :_aafd [_ceda ],YValues :_dgg [_ceda ],Style :_ae .Style {StrokeWidth :-1,DotWidth :_gdgb [_ceda ]}};_afdf .Series =append (_afdf .Series ,_gfeb );};_afdf .SetHeight (int (_be .Abs (_dcgf .Top -_dcgf .Bottom )));
_afdf .SetWidth (int (_be .Abs (_dcgf .Right -_dcgf .Left )));_dfec :=_fffe ._bfba ;_cbfg :=_fc .NewChart (_afdf );_cbfg .SetPos (_dcgf .Left ,_dcgf .Top );_geaa :=_dfec .Draw (_cbfg );if _geaa !=nil {return nil ,_geaa ;};return _cgdab ,nil ;};func AdjustColorByLumOff (colorStr string ,lumOff float64 )string {var _egcf ,_faff ,_gaf uint8 ;
_acfd ,_ :=_gd .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_egcf ,&_faff ,&_gaf );if _acfd !=3{return "";};_dce ,_ead ,_fgeg :=_dca (_egcf ,_faff ,_gaf );_fgeg =_fgeg +lumOff ;_egcf ,_faff ,_gaf =_dge (_dce ,_ead ,_fgeg );
return _gd .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_egcf ,_faff ,_gaf );};func (_fadf *creatorContext )drawLegend (_cad *Rectangle ,_ggga []*legendItem ,_ddf bool ){_bdgg :=_fadf ._bbgec ;_egc :=_eedce (2.5)*_bdgg ;
_fea :=_ccb *_bdgg ;_fggf :=(_egc -_fea )/2;_adf :=float64 (len (_ggga ));if _ddf {_bce :=&Rectangle {Top :_cad .Top +_eedce (1)*_bdgg ,Bottom :_cad .Bottom -_eedce (1)*_bdgg ,Left :_cad .Left +_eedce (2.5)*_bdgg ,Right :_cad .Right -_eedce (2.5)*_bdgg };
var _eagb float64 ;if _adf > 1{_eagb =(_bce .Right -_bce .Left )/_adf ;};_fdc :=_bce .Left ;_bgad :=_bce .Top ;for _ ,_gbf :=range _ggga {if _bcdc :=_gbf ._acf ;_bcdc !=nil {_fadf .drawRectangleWithProps (_bcdc ,_fdc ,_bgad +_fggf ,_fea ,_fea ,false );
_aecc :=_fdc +_fea *2;_fcd :=_fadf ._bfba .NewStyledParagraph ();_fcd .SetPos (_aecc ,_bgad );_dac :=_fcd .Append (_gbf ._ada );_bgcb ,_eddg :=_a .NewStandard14Font (_a .HelveticaName );if _eddg ==nil {_acbb :=_fadf ._bfba .NewTextStyle ();_acbb .Font =_bgcb ;
_acbb .FontSize =_egc ;_acbb .TextRise =0.4;_dac .Style =_acbb ;_fadf ._bfba .Draw (_fcd );};};_fdc +=_eagb ;};}else {_ffd :=&Rectangle {Top :_cad .Top +_eedce (2.5)*_bdgg ,Bottom :_cad .Bottom -_eedce (2.5)*_bdgg ,Left :_cad .Left +_eedce (2.5)*_bdgg ,Right :_cad .Right -_eedce (2.5)*_bdgg };
var _acea float64 ;if _adf > 1{_acea =(_ffd .Bottom -_ffd .Top -_egc )/(_adf -1);if _acea < _egc {_acea =_egc ;};};_fbd :=_ffd .Top ;_cgfb :=_ffd .Left ;_aega :=_cgfb +_fea *2;for _ ,_daad :=range _ggga {if _agfg :=_daad ._acf ;_agfg !=nil {_fadf .drawRectangleWithProps (_agfg ,_cgfb ,_fbd +_fggf ,_fea ,_fea ,false );
_dbc :=_fadf ._bfba .NewStyledParagraph ();_dbc .SetPos (_aega ,_fbd );_dbc .SetWidth (_ffd .Right -_ffd .Left );_cfce :=_dbc .Append (_daad ._ada );_dbg ,_faf :=_a .NewStandard14Font (_a .HelveticaName );if _faf ==nil {_eec :=_fadf ._bfba .NewTextStyle ();
_eec .Font =_dbg ;_eec .FontSize =_egc ;_eec .TextRise =0.4;_cfce .Style =_eec ;_fadf ._bfba .Draw (_dbc );};};_fbd +=_acea ;};};};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };type ImgPart byte ;const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;
ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);func _aaa (_cdgb uint8 ,_cea float64 )string {_dbce :=float64 (_cdgb );return _gd .Sprintf ("\u0025\u0030\u0032\u0078",int (_dbce *_cea ));
};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_gffe .Twips *10+0.5))/10;};func TwipsFromPoints (points float64 )float64 {return points /_gffe .Twips };func ParseExcelRange (s string )(string ,_ag .CellReference ,_ag .CellReference ,error ){_bggg :=_bf .FieldsFunc (s ,func (_fcee rune )bool {return _fcee ==':'||_fcee =='!'});
if len (_bggg )==3{_gbga ,_gdfa :=_ag .ParseCellReference (_bggg [1]);if _gdfa !=nil {return "",_ag .CellReference {},_ag .CellReference {},_gdfa ;};_bfbd ,_gdfa :=_ag .ParseCellReference (_bggg [2]);if _gdfa !=nil {return "",_ag .CellReference {},_ag .CellReference {},_gdfa ;
};return _bggg [0],_gbga ,_bfbd ,nil ;};return "",_ag .CellReference {},_ag .CellReference {},_cd .New ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020e\u0078c\u0065\u006c\u0020\u0072\u0061\u006e\u0067e");};var _fge =_eedce (7.5);
func (_edee *Rectangle )Translate (x ,y float64 ){_edee .Left +=x ;_edee .Right +=x ;_edee .Top +=y ;_edee .Bottom +=y ;};var RtlFontFile *_a .PdfFont ;func AdjustColorByTint (colorStr string ,tint float64 )string {var _eedc ,_bbec ,_dfac uint8 ;_gccg ,_ :=_gd .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_eedc ,&_bbec ,&_dfac );
if _gccg !=3{return "";};return _cae (_eedc ,tint )+_cae (_bbec ,tint )+_cae (_dfac ,tint );};type barSerByOrder []*_gff .CT_BarSer ;func AdjustColor (colorStr string ,EG_ColorTransform []*_dc .EG_ColorTransform )string {for _ ,_gdf :=range EG_ColorTransform {if _cgg :=_gdf .ColorTransformChoice .Tint ;
_cgg !=nil {if _fcfa :=_cgg .ValAttr .ST_PositiveFixedPercentageDecimal ;_fcfa !=nil {colorStr =AdjustColorByTint (colorStr ,1.0-float64 (*_fcfa )/Percent100 );};};if _cba :=_gdf .ColorTransformChoice .Shade ;_cba !=nil {if _afd :=_cba .ValAttr .ST_PositiveFixedPercentageDecimal ;
_afd !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_afd )/Percent100 );};};if _edfe :=_gdf .ColorTransformChoice .LumMod ;_edfe !=nil {if _ecag :=_edfe .ValAttr .ST_PercentageDecimal ;_ecag !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_ecag )/Percent100 );
};};if _agcc :=_gdf .ColorTransformChoice .LumOff ;_agcc !=nil {if _aca :=_agcc .ValAttr .ST_PercentageDecimal ;_aca !=nil {colorStr =AdjustColorByLumOff (colorStr ,float64 (*_aca )/Percent100 );};};};return colorStr ;};func _ecbf (_cec *_gff .CT_DateAx )(uint32 ,_gff .ST_AxPos ,_gff .ST_TickMark ,_gff .ST_TickLblPos ,*_gff .CT_ChartLines ,uint32 ,*_dc .CT_ShapeProperties ,error ){var _egg ,_faeea uint32 ;
var _bcdcc _gff .ST_AxPos ;var _agdc _gff .ST_TickMark ;var _bdga *_gff .CT_ChartLines ;var _fcde _gff .ST_TickLblPos ;if _cec .AxId ==nil {return _egg ,_bcdcc ,_agdc ,_fcde ,_bdga ,_faeea ,_cec .SpPr ,_cd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_egg =_cec .AxId .ValAttr ;};if _cec .AxPos ==nil {return _egg ,_bcdcc ,_agdc ,_fcde ,_bdga ,_faeea ,_cec .SpPr ,_cd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_bcdcc =_cec .AxPos .ValAttr ;
};if _cec .MajorTickMark !=nil {_agdc =_cec .MajorTickMark .ValAttr ;};if _cec .TickLblPos !=nil {_fcde =_cec .TickLblPos .ValAttr ;};if _cec .CrossAx ==nil {return _egg ,_bcdcc ,_agdc ,_fcde ,_bdga ,_faeea ,_cec .SpPr ,_cd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_faeea =_cec .CrossAx .ValAttr ;};_bdga =_cec .MajorGridlines ;return _egg ,_bcdcc ,_agdc ,_fcde ,_bdga ,_faeea ,_cec .SpPr ,nil ;};func (_bdgb *creatorContext )addCatValue (_fab string ,_fggg map[string ]serCategory ,_cgf []string ,_dea int ,_aee ,_afce *float64 ,_ebe string ,_bcc *_dc .CT_ShapeProperties ){_bcf ,_gcb :=_da .ParseFloat (_fab ,64);
if _gcb !=nil {_bcf =0;_abe .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_gcb );};if _bcf > *_afce {*_afce =_bcf ;};if _bcf < *_aee {*_aee =_bcf ;};_aacg :=_fggg [_cgf [_dea ]];_aacg ._caf =append (_aacg ._caf ,serValue {_fbg :_ebe ,_beg :_bcf ,_gfc :_bcc });
_fggg [_cgf [_dea ]]=_aacg ;};func GetDataFromXfrm (xfrm *_dc .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _eace ,_cfed ,_dgf ,_gafe float64 ;if _gfff :=xfrm .Off ;_gfff !=nil {_eace =_gffe .FromEMU (FromSTCoordinate (_gfff .XAttr ));_cfed =_gffe .FromEMU (FromSTCoordinate (_gfff .YAttr ));
};if _bfdb :=xfrm .Ext ;_bfdb !=nil {_dgf =_gffe .FromEMU (_bfdb .CxAttr );_gafe =_gffe .FromEMU (_bfdb .CyAttr );};return _eace ,_cfed ,_dgf ,_gafe ;};type PageSize int ;func GetImage (c *_fc .Creator ,goImg _gb .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_fc .Image ,error ){if goImg ==nil {return nil ,nil ;
};_acbg :=goImg .Bounds ().Size ();_ecbbe :=_acbg .X ;_edfc :=_acbg .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_ecbbe );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_edfc );};var _ebba _gb .Rectangle ;switch part {case ImgPart_t :_ebba =_gb .Rect (0,0,_ecbbe ,int (dividerY ));
case ImgPart_b :_ebba =_gb .Rect (0,int (dividerY ),_ecbbe ,_edfc );case ImgPart_l :_ebba =_gb .Rect (0,0,int (dividerX ),_edfc );case ImgPart_r :_ebba =_gb .Rect (int (dividerX ),0,_ecbbe ,_edfc );case ImgPart_lt :_ebba =_gb .Rect (0,0,int (dividerX ),int (dividerY ));
case ImgPart_rt :_ebba =_gb .Rect (int (dividerX ),0,_ecbbe ,int (dividerY ));case ImgPart_lb :_ebba =_gb .Rect (0,int (dividerY ),int (dividerX ),_edfc );case ImgPart_rb :_ebba =_gb .Rect (int (dividerX ),int (dividerY ),_ecbbe ,_edfc );default:_ebba =_gb .Rect (0,0,_ecbbe ,_edfc );
};_gfcg :=CropImageByRect (goImg ,_ebba );_cadg ,_gcfc :=c .NewImageFromGoImage (_gfcg );if _gcfc !=nil {return nil ,_gcfc ;};_cadg .Scale (imgWidth /float64 (_ecbbe ),imgHeight /float64 (_edfc ));_cadg .SetPos (left ,top );return _cadg ,nil ;};func (_fce barSerByOrder )Swap (i ,j int ){_fce [i ],_fce [j ]=_fce [j ],_fce [i ]};
func (_fcga *creatorContext )drawTitle (_acb string ,_ffb ,_gdab float64 ){_edf :=_fcga ._bbgec ;_fdfb :=_fcga ._bfba .NewStyledParagraph ();_eag :=_fdfb .SetText (_acb );_cde ,_cbbcf :=_a .NewStandard14Font (_a .HelveticaName );if _cbbcf ==nil {_ffe :=_fcga ._bfba .NewTextStyle ();
_ffe .Font =_cde ;_ffe .FontSize =14;_ffe .TextRise =0.4;_eag .Style =_ffe ;_fdfb .SetPos (_ffb -_fdfb .Width ()*_edf /2,_gdab );_fcga ._bfba .Draw (_fdfb );};};var _daf =_eedce (2);func GetDefaultPageSize ()_fc .PageSize {return _geea [DefaultPageSize ]};
func CropImageByRect (sourceImg _gb .Image ,rect _gb .Rectangle )_gb .Image {_bgef ,_egbg ,_bbaec ,_agbg :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;_aded :=_gb .NewNRGBA (_gb .Rect (0,0,_bbaec -_bgef ,_agbg -_egbg ));for _ceag :=_bgef ;_ceag < _bbaec ;
_ceag ++{for _dbaf :=_egbg ;_dbaf < _agbg ;_dbaf ++{_aded .Set (_ceag -_bgef ,_dbaf -_egbg ,sourceImg .At (_ceag ,_dbaf ));};};return _aded ;};func MakeTempCreatorMaxHeight (width float64 )*_fc .Creator {return MakeTempCreator (width ,MaxPageHeight );};
func MakeBlockFromCreator (c *_fc .Creator )(*_fc .Block ,error ){_gggc ,_ccca :=GetPageFromCreator (c );if _ccca !=nil {return nil ,_ccca ;};_gfge ,_ccca :=_fc .NewBlockFromPage (_gggc );if _ccca !=nil {return nil ,_ccca ;};return _gfge ,nil ;};func _dca (_feaa ,_agcg ,_afa uint8 )(float64 ,float64 ,float64 ){_geac ,_cdaf ,_gbe :=float64 (_feaa )/255,float64 (_agcg )/255,float64 (_afa )/255;
_daef :=_geac ;if _cdaf < _daef {_daef =_cdaf ;};if _gbe < _daef {_daef =_gbe ;};var _fcdd ,_feeff bool ;_aed :=_geac ;if _cdaf > _aed {_aed =_cdaf ;_fcdd =true ;};if _gbe > _aed {_aed =_gbe ;_fcdd =false ;_feeff =true ;};_edac :=(_daef +_aed )/2;var _gcff float64 ;
if _daef !=_aed {if _edac <=0.5{_gcff =(_aed -_daef )/(_aed +_daef );}else {_gcff =(_aed -_daef )/(2.0-_aed -_daef );};};var _cdd float64 ;if _daef !=_aed {if _fcdd {_cdd =2.0+(_gbe -_geac )/(_aed -_daef );}else if _feeff {_cdd =4.0+(_geac -_cdaf )/(_aed -_daef );
}else {_cdd =(_cdaf -_gbe )/(_aed -_daef );};_cdd *=60;if _cdd < 0{_cdd +=360;};};return _cdd ,_gcff ,_edac ;};func GetPageFromCreator (c *_fc .Creator )(*_a .PdfPage ,error ){_aedg :=_g .NewBuffer ([]byte {});_efdgg :=c .Write (_aedg );if _efdgg !=nil {return nil ,_efdgg ;
};_fdcg :=_g .NewReader (_aedg .Bytes ());_fffea ,_efdgg :=_a .NewPdfReader (_fdcg );if _efdgg !=nil {return nil ,_efdgg ;};return _fffea .GetPage (1);};func FromSTCoordinate32 (st _dc .ST_Coordinate32 )int64 {if _ddcb :=st .ST_Coordinate32Unqualified ;
_ddcb !=nil {return int64 (*_ddcb );};return 0;};func (_eg barSerByOrder )Len ()int {return len (_eg )};var (DefaultFontSize =12.0;DefaultImageEncoder _fcb .StreamEncoder ;DefaultPageSize =PageSizeA4 ;_geea =map[PageSize ]_fc .PageSize {PageSizeA3 :_fc .PageSizeA3 ,PageSizeA4 :_fc .PageSizeA4 ,PageSizeA5 :_fc .PageSizeA5 ,PageSizeLetter :_fc .PageSizeLetter ,PageSizeLegal :_fc .PageSizeLegal };
);func FromSTPercentage (st *_dc .ST_Percentage )float64 {if _ggfe :=st .ST_PercentageDecimal ;_ggfe !=nil {return float64 (*_ggfe )/Percent100 ;};return 0;};type fontsMap struct{_dbef *_cg .Mutex ;_gbd map[string ]map[FontStyle ]*_a .PdfFont ;};const _bgac =6.0;
func (_ee *creatorContext )drawAreaChart (_cf *_gff .CT_AreaChart ,_ac *Rectangle ,_ea []*_gff .CT_PlotAreaChoice1 ,_aa float64 )([]*legendItem ,error ){_bb :=[]*legendItem {};_bd :=_cf .Ser ;_bgc :=make (map[int ][]float64 );_bfa :=make (map[int ][]float64 );
_df :=make (map[int ]_fc .Color );for _gg ,_fd :=range _bd {_df [_gg ]=_fc .ColorWhite ;if _fe :=_fd .SpPr ;_fe !=nil {_cgd :=_ee .getPdfColorFromSolidFill (_fe .FillPropertiesChoice .SolidFill );if _cgd !=nil {_df [_gg ]=_cgd ;};};if _ggb :=_fd .Val ;
_ggb !=nil {if _gc :=_ggb .NumDataSourceChoice ;_gc !=nil {if _ec :=_gc .NumRef ;_ec !=nil {if _eed :=_ec .NumCache ;_eed !=nil {for _ ,_aad :=range _eed .Pt {_bgc [_gg ]=append (_bgc [_gg ],float64 (_aad .IdxAttr ));_ecb ,_ :=_da .ParseFloat (_bf .TrimSpace (_aad .V ),64);
_bfa [_gg ]=append (_bfa [_gg ],_ecb );};};};};};};_aac :=true ;_agg :="";_bfd :="";if len (_ea )> 1{if _ea [0].ValAx !=nil &&_ea [1].ValAx !=nil {if _ea [0].ValAx .Delete !=nil &&_ea [1].ValAx .Delete !=nil {if !*(*_ea [0].ValAx .Delete ).ValAttr &&!*(*_ea [1].ValAx .Delete ).ValAttr {_aac =false ;
};};_agg =_ee .getTitle (_ea [0].ValAx .Title );_bfd =_ee .getTitle (_ea [1].ValAx .Title );};};_cfb :=_ae .Style {Hidden :_aac ,FontSize :8*_aa };_ge :=&_f .Chart {Series :[]_fcg .Series {},YAxisSecondary :_f .YAxis {Style :_cfb ,Name :_bfd ,NameStyle :_cfb },XAxis :_f .XAxis {Style :_cfb ,Name :_agg ,NameStyle :_cfb },YAxis :_f .YAxis {Style :_ae .Style {Hidden :true }}};
for _bc :=0;_bc < len (_df );_bc ++{_fcbb ,_ef ,_dd :=_df [_bc ].ToRGB ();_dab :=_fcg .ContinuousSeries {XValues :_bgc [_bc ],YValues :_bfa [_bc ],Style :_ae .Style {StrokeWidth :1,FillColor :_d .RGBA {uint8 (_fcbb *255),uint8 (_ef *255),uint8 (_dd *255),255}}};
_ge .Series =append (_ge .Series ,_dab );};_ge .SetHeight (int (_be .Abs (_ac .Top -_ac .Bottom )));_ge .SetWidth (int (_be .Abs (_ac .Right -_ac .Left )));_ecf :=_ee ._bfba ;_bbc :=_fc .NewChart (_ge );_bbc .SetPos (_ac .Left ,_ac .Top );_db :=_ecf .Draw (_bbc );
if _db !=nil {return nil ,_db ;};return _bb ,nil ;};func FillRectangle (c *_fc .Creator ,x ,y ,width ,height float64 ,color _fc .Color ){if color ==nil {return ;};_gebbc :=c .NewRectangle (x ,y ,width ,height );_gebbc .SetFillColor (color );_gebbc .SetBorderWidth (0);
c .Draw (_gebbc );};type serCategory struct{_ggg string ;_caf []serValue ;};var _efd =_eedce (0.5);func _fde (_dbdb _dc .ST_SchemeColorVal ,_dgafe *_dc .Theme )string {if _cgdc :=_dgafe .ThemeElements ;_cgdc !=nil {if _adc :=_cgdc .ClrScheme ;_adc !=nil {switch _dbdb {case _dc .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_adc .Lt1 );
case _dc .ST_SchemeColorValDk1 ,_dc .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_adc .Dk1 );case _dc .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_adc .Lt2 );case _dc .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_adc .Dk2 );
case _dc .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_adc .Accent1 );case _dc .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_adc .Accent2 );case _dc .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_adc .Accent3 );
case _dc .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_adc .Accent4 );case _dc .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_adc .Accent5 );case _dc .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_adc .Accent6 );
};};};return "";};var _cbf =_eedce (1);func _cae (_cef uint8 ,_fbdf float64 )string {_cbgd :=float64 (_cef );var _egf float64 ;if _fbdf < 0{_egf =_cbgd *(1+_fbdf );}else {_egf =_cbgd +(255-_cbgd )*_fbdf ;};return _gd .Sprintf ("\u0025\u0030\u0032\u0078",int (_egf ));
};func (_eca barSerByOrder )Less (i ,j int )bool {return _eca [i ].Order .ValAttr < _eca [j ].Order .ValAttr };type serValue struct{_fbg string ;_beg float64 ;_gfc *_dc .CT_ShapeProperties ;};type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;
Right float64 ;};func _gee (_ggea string )error {if !_bf .HasSuffix (_ggea ,"\u002e\u0074\u0074\u0066"){_abe .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _gd .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_ddfg ,_ebd :=_gf .ParseFile (_ggea );if _ebd !=nil {_abe .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_ebd );return _ebd ;};_adg ,_ebd :=_a .NewCompositePdfFontFromTTFFile (_ggea );
if _ebd !=nil {return _ebd ;};_gcddd :=_ddfg .GetNameRecords ();for _ ,_gcdab :=range _gcddd {_febb :=_gcdab [1];if _febb ==""{continue ;};_ecbe :=make ([]byte ,0);for _aegc :=0;_aegc < len (_febb );_aegc ++{if _febb [_aegc ]==39||_febb [_aegc ]==92{continue ;
};_eabf :=4;if _aegc +_eabf < len (_febb ){if _febb [_aegc :_aegc +_eabf ]=="\u0000"{_aegc =_aegc +_eabf +1;continue ;};};_ecbe =append (_ecbe ,_febb [_aegc ]);};_febb =_bf .Replace (string (_ecbe ),"\u0078\u0030\u0030","",-1);_eebg :=_gcdab [2];if _eebg ==""{return _gd .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_ggea );
};_ecbe =make ([]byte ,0);for _ecff :=0;_ecff < len (_eebg );_ecff ++{if _eebg [_ecff ]==39||_eebg [_ecff ]==92{continue ;};_aebf :=4;if _ecff +_aebf < len (_eebg ){if _eebg [_ecff :_ecff +_aebf ]=="\u0000"{_ecff =_ecff +_aebf +1;continue ;};};_ecbe =append (_ecbe ,_eebg [_ecff ]);
};_eebg =_bf .Replace (string (_ecbe ),"\u0078\u0030\u0030","",-1);RegisterFont (_febb ,_dfacb [_eebg ],_adg );};return nil ;};type legendItem struct{_ada string ;_acf *_dc .CT_ShapeProperties ;};func RegisterFontsFromDirectory (dirName string )error {_ddad ,_fbfe :=_eb .Open (dirName );
if _fbfe !=nil {return _fbfe ;};defer _ddad .Close ();_ecc ,_fbfe :=_ddad .Readdirnames (0);if _fbfe !=nil {return _fbfe ;};for _ ,_fbe :=range _ecc {if _bf .HasSuffix (_fbe ,"\u002e\u0074\u0074\u0066"){_effe :=dirName +"\u002f"+_fbe ;_gba :=_gee (_effe );
if _gba !=nil {_abe .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gba );
continue ;};};};return nil ;};func _eedce (_eebd float64 )float64 {return _eebd *_gffe .Millimeter };func LoadFontFromFile (filename string )(*_a .PdfFont ,error ){if !_bf .HasSuffix (filename ,"\u002e\u0074\u0074\u0066"){_abe .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return nil ,_gd .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_daeg ,_dfcc :=_a .NewCompositePdfFontFromTTFFile (filename );if _dfcc !=nil {return nil ,_dfcc ;};return _daeg ,nil ;};func _fded (_aae ,_abgfe ,_dfe float64 )float64 {if _aae *6< 1{return _dfe +(_abgfe -_dfe )*6*_aae ;}else if _aae *2< 1{return _abgfe ;
}else if _aae *3< 2{return _dfe +(_abgfe -_dfe )*(2.0/3.0-_aae )*6;}else {return _dfe ;};};