//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_de "bytes";_d "errors";_gb "github.com/unidoc/unioffice/common";_dc "github.com/unidoc/unioffice/common/logger";_f "github.com/unidoc/unioffice/common/tempstorage";_b "github.com/unidoc/unioffice/internal/convertutils";_ce "github.com/unidoc/unioffice/measurement";
_ag "github.com/unidoc/unioffice/presentation";_fa "github.com/unidoc/unioffice/schema/soo/dml";_bf "github.com/unidoc/unioffice/schema/soo/dml/chart";_ea "github.com/unidoc/unioffice/schema/soo/pml";_dg "github.com/unidoc/unipdf/v3/contentstream/draw";
_e "github.com/unidoc/unipdf/v3/core";_cd "github.com/unidoc/unipdf/v3/creator";_ca "github.com/unidoc/unipdf/v3/model";_ed "github.com/unidoc/unipdf/v3/render";_ace "image";_c "image/color";_ac "image/draw";_g "math";_ab "strconv";_cg "strings";);type convertContext struct{_dfeg *_cd .Creator ;
_gdgb *_b .Rectangle ;_ebdc *_ag .Presentation ;_gfcbf *_ag .Slide ;_cbaa *_ea .SldMaster ;_afc *_ea .SldLayout ;_gbcd float64 ;_fbea float64 ;_gefd []_cd .Drawable ;_dabf *background ;_efge *_fa .CT_TextParagraphProperties ;_cee *_fa .CT_TextCharacterProperties ;
_fad *_fa .CT_TextParagraphProperties ;_ccgd *_fa .CT_TextCharacterProperties ;_fgdg *_fa .CT_TextParagraphProperties ;_daff *_fa .CT_TextCharacterProperties ;_abgd []*_fa .CT_TextParagraphProperties ;_bbgd []*_fa .CT_TextParagraphProperties ;_dfag []*_fa .CT_TextParagraphProperties ;
_dcaf *_fa .Theme ;_ddgb *_fa .CT_ColorMappingOverride ;};func _bedb (_ddfg float64 )float64 {return _ddfg *_ce .Inch };type word struct{_fba []*symbol ;_abb float64 ;_cadd float64 ;_bbcb bool ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;
FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_eeaa *textboxContext )newWord (){_eeaa ._gefb =&word {_bbcb :true ,_abb :_eeaa ._fcdd ._dad }};type romanMatch struct{_aagf int ;_gaeb string ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _b .RegisterFontsFromDirectory (dirName )};func (_bbb *convertContext )tileImage (_bee *_cd .Image ,_ccdf *_fa .CT_TileInfoProperties ,_cce ,_gbb float64 )*_cd .Image {_cef ,_cca :=1.0,1.0;
if _adb :=_ccdf .SxAttr ;_adb !=nil {_cef =_b .FromSTPercentage (_adb );};if _ecf :=_ccdf .SyAttr ;_ecf !=nil {_cca =_b .FromSTPercentage (_ecf );};_agbf :=_b .MakeTempCreator (_cce ,_gbb );_bee .Scale (_cef ,_cca );_bae ,_gcd :=_bee .Width (),_bee .Height ();
var _fdba ,_bdf float64 ;if _cfd :=_ccdf .TxAttr ;_cfd !=nil {_fdba =_ce .FromEMU (_b .FromSTCoordinate (*_cfd ));};if _gd :=_ccdf .TyAttr ;_gd !=nil {_bdf =_ce .FromEMU (_b .FromSTCoordinate (*_gd ));};if _fdba > 0{_fdba -=_bae ;};if _bdf > 0{_bdf -=_gcd ;
};_efca :=_bbb ._fbea /_bae +1;_dced :=_bbb ._gbcd /_gcd +1;for _ee :=0.0;_ee <=_efca ;_ee ++{_ccg :=_ee *_bae ;for _fgd :=0.0;_fgd <=_dced ;_fgd ++{_dbc :=_fgd *_gcd ;_bee .SetPos (_ccg +_fdba ,_dbc +_bdf );_agbf .Draw (_bee );};};_dcc ,_gdb :=_b .GetPageFromCreator (_agbf );
if _gdb !=nil {_dc .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_gdb );return nil ;};_caed ,_gdb :=_ed .NewImageDevice ().Render (_dcc );
if _gdb !=nil {_dc .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_gdb );return nil ;};_gbc ,_gdb :=_bbb ._dfeg .NewImageFromGoImage (_caed );if _gdb !=nil {_dc .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_gdb );
return nil ;};return _gbc ;};func (_cbae *convertContext )addCellToTable (_efba *_cd .Table ,_caba *_fa .CT_TableCell ,_dbed *_fa .CT_TablePartStyle ,_dcg float64 ,_cbdc ,_adfa ,_def ,_agg bool )float64 {var _adff *_cd .TableCell ;_ggd :=1;if _caba .GridSpanAttr !=nil {_ggd =int (*_caba .GridSpanAttr );
};_adff =_efba .MultiColCell (_ggd );_cgcfc :=_caba .TcPr ;var _cdg *_fa .CT_TableStyleTextStyle ;if _dbed !=nil {_cgcfc =_gbag (_cgcfc ,_dbed .TcStyle ,_cbdc ,_adfa ,_def ,_agg );_cdg =_dbed .TcTxStyle ;};_bcea :=_deg ;_fccd :=_cd .CellVerticalAlignmentMiddle ;
_bafca :=_bedb (0.05);_bdg :=_bedb (0.05);if _cgcfc !=nil {if _dfa :=_cgcfc .LnL ;_dfa !=nil {_cddg ,_dca ,_ggg :=_cbae .getBorderStyle (_dfa );_adff .SetBorder (_cd .CellBorderSideLeft ,_cddg ,_ggg );if _dca !=nil &&*_dca !=nil {_adff .SetSideBorderColor (_cd .CellBorderSideLeft ,*_dca );
};};if _aca :=_cgcfc .LnT ;_aca !=nil {_gfcbd ,_dcgf ,_agcg :=_cbae .getBorderStyle (_aca );_adff .SetBorder (_cd .CellBorderSideTop ,_gfcbd ,_agcg );if _dcgf !=nil &&*_dcgf !=nil {_adff .SetSideBorderColor (_cd .CellBorderSideTop ,*_dcgf );};};if _bdfd :=_cgcfc .LnR ;
_bdfd !=nil {_bde ,_ebgc ,_bgd :=_cbae .getBorderStyle (_bdfd );_adff .SetBorder (_cd .CellBorderSideRight ,_bde ,_bgd );if _ebgc !=nil &&*_ebgc !=nil {_adff .SetSideBorderColor (_cd .CellBorderSideRight ,*_ebgc );};};if _daaa :=_cgcfc .LnB ;_daaa !=nil {_fbd ,_bbcg ,_cfaf :=_cbae .getBorderStyle (_daaa );
_adff .SetBorder (_cd .CellBorderSideBottom ,_fbd ,_cfaf );if _bbcg !=nil &&*_bbcg !=nil {_adff .SetSideBorderColor (_cd .CellBorderSideBottom ,*_bbcg );};};if _ebfd :=_cgcfc .MarLAttr ;_ebfd !=nil {_bcea =float64 (_b .FromSTCoordinate32 (*_ebfd ));};switch _cgcfc .AnchorAttr {case _fa .ST_TextAnchoringTypeT :_fccd =_cd .CellVerticalAlignmentTop ;
case _fa .ST_TextAnchoringTypeB :_fccd =_cd .CellVerticalAlignmentBottom ;};if _cgcfc .NoFill ==nil {if _dagf :=_cgcfc .SolidFill ;_dagf !=nil {_gfcg ,_ :=_cbae .getColorFromSolidFill (_dagf );_adff .SetBackgroundColor (_gfcg );};};if _bbgc :=_cgcfc .MarBAttr ;
_bbgc !=nil {_bafca =float64 (_b .FromSTCoordinate32 (*_bbgc ));};if _gea :=_cgcfc .MarTAttr ;_gea !=nil {_bdg =float64 (_b .FromSTCoordinate32 (*_gea ));};};_adff .SetVerticalAlignment (_fccd );_adff .SetIndent (_bcea );var _ddef float64 ;if _egg :=_caba .TxBody ;
_egg !=nil {_fcbb :=_cbae .makePdfDivisionFromTxBody (_egg ,_cdg );_ddef =_fcbb .Height ()+_bdg +_bafca ;_adff .SetContent (_fcbb );};return _ddef ;};func (_dcbc *textboxContext )drawParagraphs (){_dcbc ._dgfb .NewPage ();for _ ,_beed :=range _dcbc ._cged {for _ ,_afed :=range _beed ._daae {for _ ,_cecd :=range _afed ._dbaa {for _ ,_adfe :=range _cecd ._fba {_bdbe :=_dcbc ._dgfb .NewStyledParagraph ();
if _adfe ._gcbc {_adfe ._ebb =0;}else if _adfe ._cedaf {_adfe ._ebb =1.2*_afed ._aebac -_adfe ._gdd ;};_ffcc :=_cecd ._abb +_adfe ._dffe ;_fegd :=_beed ._aae +_afed ._fbec +_adfe ._ebb ;_bdbe .SetPos (_ffcc ,_fegd );_gbdeb :=_bdbe .Append (_adfe ._cgb );
if _adfe ._geda !=nil {_gbdeb .Style =*_adfe ._geda ;};_dcbc ._dgfb .Draw (_bdbe );if _adfe ._efe {_cafac :=_fegd +_adfe ._gdd +2;_b .DrawLine (_dcbc ._dgfb ,_ffcc ,_cafac ,_ffcc +_adfe ._caef ,_cafac ,1,_adfe ._geda .Color );};};};};};};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_b .FontStyle ;var _agga =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
func (_bcfb *textboxContext )addTextRun (_edebg *_fa .EG_TextRun ,_fbbb *_fa .CT_TextCharacterProperties ,_bdeb _cd .Color ,_cffb *prefixData ){if _gbdb :=_edebg .Br ;_gbdb !=nil {_bcfb .addCurrentWordToParagraph ();_bcfb .newLine ();_bcfb .newWord ();
}else if _cbe :=_edebg .R ;_cbe !=nil {var _gbgc _cd .Color ;if _cbe .RPr !=nil &&_cbe .RPr .SolidFill !=nil {_gbgc ,_ =_bcfb ._bdba .getColorFromSolidFill (_cbe .RPr .SolidFill );}else if _bdeb !=nil {_gbgc =_bdeb ;}else if _fbbb .SolidFill !=nil {_gbgc ,_ =_bcfb ._bdba .getColorFromSolidFill (_fbbb .SolidFill );
}else {_gbgc =_cd .ColorBlack ;};_fede :=_cdfe (_cbe .RPr ,_fbbb );_bgdf ,_geae ,_acgd ,_eaa :=_bcfb ._bdba .makeStyleFromRPr (_fede );_bgdf .Color =_gbgc ;if _cffb !=nil {_bcfb .addPrefix (_cffb ,_bgdf );};_gacf :=_gcfc (_cbe .T );for _ ,_aeec :=range _gacf {_aeec ._geda =_bgdf ;
_aeec ._gcbc =_geae ;_aeec ._cedaf =_acgd ;_aeec ._efe =_eaa ;if _fede .CapAttr ==_fa .ST_TextCapsTypeAll {_aeec ._cgb =_cg .ToUpper (_aeec ._cgb );};_bcfb .addTextSymbol (_aeec );};};};func _fga (_eeaca ,_aabg *_fa .CT_TextBody )(*_fa .CT_TextBodyProperties ,*_fa .CT_TextListStyle ){if _eeaca ==nil &&_aabg ==nil {return nil ,nil ;
};if _eeaca ==nil {return _aabg .BodyPr ,_aabg .LstStyle ;};if _aabg ==nil {return _eeaca .BodyPr ,_eeaca .LstStyle ;};_gdfe ,_dfgc :=_eeaca .BodyPr ,_eeaca .LstStyle ;_bdea ,_abbe :=_aabg .BodyPr ,_aabg .LstStyle ;_bea :=_bebd (_gdfe ,_bdea );_cdb :=_acce (_dfgc ,_abbe );
return _bea ,_cdb ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_ca .PdfFont ){_b .RegisterFont (name ,style ,font );};func _acce (_dadc ,_cdfeb *_fa .CT_TextListStyle )*_fa .CT_TextListStyle {_egae :=_fa .NewCT_TextListStyle ();if _dadc !=nil {*_egae =*_dadc ;
};if _cdfeb ==nil {return _egae ;};_egae .DefPPr =_fdg (_egae .DefPPr ,_cdfeb .DefPPr );_egae .Lvl1pPr =_fdg (_egae .Lvl1pPr ,_cdfeb .Lvl1pPr );_egae .Lvl2pPr =_fdg (_egae .Lvl2pPr ,_cdfeb .Lvl2pPr );_egae .Lvl3pPr =_fdg (_egae .Lvl3pPr ,_cdfeb .Lvl3pPr );
_egae .Lvl4pPr =_fdg (_egae .Lvl4pPr ,_cdfeb .Lvl4pPr );_egae .Lvl5pPr =_fdg (_egae .Lvl5pPr ,_cdfeb .Lvl5pPr );_egae .Lvl6pPr =_fdg (_egae .Lvl6pPr ,_cdfeb .Lvl6pPr );_egae .Lvl7pPr =_fdg (_egae .Lvl7pPr ,_cdfeb .Lvl7pPr );_egae .Lvl8pPr =_fdg (_egae .Lvl8pPr ,_cdfeb .Lvl8pPr );
_egae .Lvl9pPr =_fdg (_egae .Lvl9pPr ,_cdfeb .Lvl9pPr );return _egae ;};type paragraph struct{_ceca float64 ;_cffg float64 ;_cgga float64 ;_geac float64 ;_dgb float64 ;_fcgf float64 ;_aae float64 ;_aga float64 ;_dcd _fa .ST_TextAlignType ;_egc float64 ;
_bbf bool ;_daae []*line ;};func (_fbcd *convertContext )makeStyleFromRPr (_gfcb *_fa .CT_TextCharacterProperties )(*_cd .TextStyle ,bool ,bool ,bool ){var _bffc ,_dbcc ,_fcc bool ;_ebaea :=_fbcd ._dfeg .NewTextStyle ();if _gfcb !=nil {_feba :=_b .FontStyle_Regular ;
_eea :=_aagaa (_gfcb .BAttr );_dbba :=_aagaa (_gfcb .IAttr );if _eea &&_dbba {_feba =_b .FontStyle_BoldItalic ;}else if _eea {_feba =_b .FontStyle_Bold ;}else if _dbba {_feba =_b .FontStyle_Italic ;};_fcc =_gfcb .UAttr !=_fa .ST_TextUnderlineTypeUnset &&_gfcb .UAttr !=_fa .ST_TextUnderlineTypeNone ;
_ddg :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _fbe :=_gfcb .Latin ;_fbe !=nil {_ddg =_fbe .TypefaceAttr ;}else if _gbe :=_gfcb .Ea ;_gbe !=nil {_ddg =_gbe .TypefaceAttr ;}else if _baf :=_gfcb .Cs ;_baf !=nil {_ddg =_baf .TypefaceAttr ;}else if _adg :=_gfcb .Sym ;
_adg !=nil {_ddg =_adg .TypefaceAttr ;};if _cab ,_agde :=_b .StdFontsMap [_ddg ];_agde {_ebaea .Font =_b .AssignStdFontByName (_ebaea ,_cab [_feba ]);}else if _bfce :=_b .GetRegisteredFont (_ddg ,_feba );_bfce !=nil {_ebaea .Font =_bfce ;}else {_dc .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_ddg ,_feba );
_ebaea .Font =_b .AssignStdFontByName (_ebaea ,_b .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_feba ]);};var _daef float64 ;if _dfga :=_gfcb .SzAttr ;_dfga !=nil {_daef =_g .Round (float64 (*_dfga )/100)-0.5;}else {_daef =_b .DefaultFontSize ;
};if _adfg :=_gfcb .BaselineAttr ;_adfg !=nil {if _fgff :=_adfg .ST_PercentageDecimal ;_fgff !=nil {if *_fgff > 0{_bffc =true ;}else if *_fgff < 0{_dbcc =true ;};};};if _bffc ||_dbcc {_daef =_g .Round (_daef *0.64);};_ebaea .FontSize =_daef ;_febf :=0.0;
if _ddgd :=_gfcb .SpcAttr ;_ddgd !=nil {if _dba :=_ddgd .ST_TextPointUnqualified ;_dba !=nil &&*_dba > 0{_febf =float64 (*_dba )/100;};};_ebaea .CharSpacing =_febf ;};return &_ebaea ,_bffc ,_dbcc ,_fcc ;};func (_afbe *textboxContext )addTextSymbol (_fdcg *symbol ){_eaga :=_cd .New ();
_bege :=_eaga .NewStyledParagraph ();_bege .SetMargins (0,0,0,0);_ebfc :=_bege .Append (_fdcg ._cgb );_fbaa :=0.0;if _fdcg ._geda !=nil {_ebfc .Style =*_fdcg ._geda ;if _fdcg ._geda .CharSpacing !=0{_fbaa =_fdcg ._geda .CharSpacing ;};};_fdcg ._gdd =_bege .Height ();
_fdcg ._bfca =_bege .Height ()*1.2;if _fdcg ._caef ==0{_fdcg ._caef =_bege .Width ()+_fbaa ;};if len (_afbe ._gefb ._fba )> 0{_abbb :=_afbe ._gefb ._fba [len (_afbe ._gefb ._fba )-1]._cgb ;if _afbe ._aeg ._bbf ||_b .IsNoSpaceLanguage (_abbb )||(_abbb =="\u0020")!=(_fdcg ._cgb =="\u0020"){_afbe .addCurrentWordToParagraph ();
_afbe .newWord ();};};_afbe ._gefb ._fba =append (_afbe ._gefb ._fba ,_fdcg );_fdcg ._dffe =_afbe ._gefb ._cadd ;_afbe ._gefb ._cadd +=_fdcg ._caef ;if _fdcg ._cgb !="\u0020"{_afbe ._gefb ._bbcb =false ;};if _afbe ._gefb ._cadd >=_afbe ._aeg ._fcgf -_afbe ._aeg ._dgb {_afbe .addCurrentWordToParagraph ();
_afbe .newLine ();_afbe .newWord ();};};type textboxContext struct{_bdba *convertContext ;_gaf float64 ;_caff float64 ;_dgfb *_cd .Creator ;_adc float64 ;_cged []*paragraph ;_aeg *paragraph ;_fcdd *line ;_gefb *word ;_ccgdb bool ;};func _gbag (_dbbb *_fa .CT_TableCellProperties ,_gffe *_fa .CT_TableStyleCellStyle ,_fgeb ,_gbdc ,_gdec ,_bccg bool )*_fa .CT_TableCellProperties {_gfgd :=_fa .NewCT_TableCellProperties ();
if _dbbb !=nil {*_gfgd =*_dbbb ;};if _gffe ==nil {return _gfgd ;};if _eggf :=_gffe .FillRef ;_eggf !=nil {_gfd :=_fa .NewCT_SolidColorFillProperties ();_gfd .ScrgbClr =_eggf .ScrgbClr ;_gfd .SrgbClr =_eggf .SrgbClr ;_gfd .HslClr =_eggf .HslClr ;_gfd .SysClr =_eggf .SysClr ;
_gfd .SchemeClr =_eggf .SchemeClr ;_gfd .PrstClr =_eggf .PrstClr ;_gfgd .SolidFill =_gfd ;};if _gfgd .NoFill ==nil &&_gfgd .SolidFill ==nil {if _gege :=_gffe .Fill ;_gege !=nil {if _gfgd .NoFill ==nil {_gfgd .NoFill =_gege .NoFill ;};if _gfgd .SolidFill ==nil {_gfgd .SolidFill =_gege .SolidFill ;
};};};if _bdfg :=_gffe .TcBdr ;_bdfg !=nil {if _gfgd .LnL ==nil {var _dede *_fa .CT_ThemeableLineStyle ;if _gdec {_dede =_bdfg .Left ;}else {_dede =_bdfg .InsideV ;};if _dede !=nil {_gfgd .LnL =_dede .Ln ;};};if _gfgd .LnR ==nil {var _dfeb *_fa .CT_ThemeableLineStyle ;
if _bccg {_dfeb =_bdfg .Right ;}else {_dfeb =_bdfg .InsideV ;};if _dfeb !=nil {_gfgd .LnR =_dfeb .Ln ;};};if _gfgd .LnT ==nil {var _bbca *_fa .CT_ThemeableLineStyle ;if _fgeb {_bbca =_bdfg .Top ;}else {_bbca =_bdfg .InsideH ;};if _bbca !=nil {_gfgd .LnT =_bbca .Ln ;
};};if _gfgd .LnB ==nil {var _dcaff *_fa .CT_ThemeableLineStyle ;if _gbdc {_dcaff =_bdfg .Bottom ;}else {_dcaff =_bdfg .InsideH ;};if _dcaff !=nil {_gfgd .LnB =_dcaff .Ln ;};};};return _gfgd ;};func (_efd *textboxContext )alignSymbolsVertically (){for _ ,_fge :=range _efd ._cged {for _ ,_dcce :=range _fge ._daae {_cfecb :=0.0;
for _ ,_becaf :=range _dcce ._dbaa {for _ ,_bfef :=range _becaf ._fba {if _bfef ._bfca > _cfecb {_cfecb =_bfef ._bfca ;};};};for _ ,_fdcd :=range _dcce ._dbaa {for _ ,_dded :=range _fdcd ._fba {if _dded ._gdd < _cfecb {_dded ._ebb =_cfecb -_dded ._gdd ;
};};};};};};func (_gafc *textboxContext )alignParagraphsVertically (_agf _fa .ST_TextAnchoringType ){if _agf ==_fa .ST_TextAnchoringTypeT {return ;};_gcbea :=0.0;for _ ,_bfcea :=range _gafc ._cged {_gcbea +=_bfcea ._cffg +_bfcea ._aga +_bfcea ._cgga ;};
var _adba float64 ;switch _agf {case _fa .ST_TextAnchoringTypeCtr :_adba =(_gafc ._caff -_gcbea )/2;case _fa .ST_TextAnchoringTypeB :_adba =_gafc ._caff -_gcbea ;};for _ ,_dbad :=range _gafc ._cged {_dbad ._aae +=_adba ;};};func (_edc *convertContext )getBorderStyle (_fgdc *_fa .CT_LineProperties )(_cd .CellBorderStyle ,*_cd .Color ,float64 ){if _fgdc ==nil ||_fgdc .NoFill !=nil {return _cd .CellBorderStyleNone ,nil ,0;
};var _ccb _cd .Color ;if _afab :=_fgdc .SolidFill ;_afab !=nil {_ccb ,_ =_edc .getColorFromSolidFill (_afab );};_gbde :=0.0;if _dfgg :=_fgdc .WAttr ;_dfgg !=nil {_gbde =_ce .FromEMU (int64 (*_dfgg ));};return _cd .CellBorderStyleSingle ,&_ccb ,_gbde ;
};func (_agb *convertContext )extractDefaultProperties (){_ged :=_agb ._ebdc .X ();_eb :=_ged .DefaultTextStyle ;var _gf ,_feb ,_cb ,_gc ,_bc ,_gfa ,_dgc ,_eaf ,_ff ,_cbb *_fa .CT_TextParagraphProperties ;if _eb !=nil {_gf =_eb .DefPPr ;_feb =_fdg (_eb .Lvl1pPr ,_gf );
_cb =_fdg (_eb .Lvl2pPr ,_gf );_gc =_fdg (_eb .Lvl3pPr ,_gf );_bc =_fdg (_eb .Lvl4pPr ,_gf );_gfa =_fdg (_eb .Lvl5pPr ,_gf );_dgc =_fdg (_eb .Lvl6pPr ,_gf );_eaf =_fdg (_eb .Lvl7pPr ,_gf );_ff =_fdg (_eb .Lvl8pPr ,_gf );_cbb =_fdg (_eb .Lvl9pPr ,_gf );
_agb ._efge =_gf ;_agb ._cee =_gf .DefRPr ;};_agb ._abgd =make ([]*_fa .CT_TextParagraphProperties ,9);_agb ._abgd [0]=_feb ;_agb ._abgd [1]=_cb ;_agb ._abgd [2]=_gc ;_agb ._abgd [3]=_bc ;_agb ._abgd [4]=_gfa ;_agb ._abgd [5]=_dgc ;_agb ._abgd [6]=_eaf ;
_agb ._abgd [7]=_ff ;_agb ._abgd [8]=_cbb ;_gcc :=_agb ._ebdc .SlideMasters ()[0].X ();_ece :=_gcc .TxStyles ;_ba :=_ece .TitleStyle ;_agb ._fad =_fdg (_ba .DefPPr ,_gf );_agb ._ccgd =_agb ._fad .DefRPr ;_agb ._bbgd =make ([]*_fa .CT_TextParagraphProperties ,9);
_agb ._bbgd [0]=_fdg (_ba .Lvl1pPr ,_feb );_agb ._bbgd [1]=_fdg (_ba .Lvl2pPr ,_cb );_agb ._bbgd [2]=_fdg (_ba .Lvl3pPr ,_gc );_agb ._bbgd [3]=_fdg (_ba .Lvl4pPr ,_bc );_agb ._bbgd [4]=_fdg (_ba .Lvl5pPr ,_gfa );_agb ._bbgd [5]=_fdg (_ba .Lvl6pPr ,_dgc );
_agb ._bbgd [6]=_fdg (_ba .Lvl7pPr ,_eaf );_agb ._bbgd [7]=_fdg (_ba .Lvl8pPr ,_ff );_agb ._bbgd [8]=_fdg (_ba .Lvl9pPr ,_cbb );_eg :=_ece .BodyStyle ;_agb ._fgdg =_fdg (_eg .DefPPr ,_gf );_agb ._daff =_agb ._fgdg .DefRPr ;_agb ._dfag =make ([]*_fa .CT_TextParagraphProperties ,9);
_agb ._dfag [0]=_fdg (_eg .Lvl1pPr ,_feb );_agb ._dfag [1]=_fdg (_eg .Lvl2pPr ,_cb );_agb ._dfag [2]=_fdg (_eg .Lvl3pPr ,_gc );_agb ._dfag [3]=_fdg (_eg .Lvl4pPr ,_bc );_agb ._dfag [4]=_fdg (_eg .Lvl5pPr ,_gfa );_agb ._dfag [5]=_fdg (_eg .Lvl6pPr ,_dgc );
_agb ._dfag [6]=_fdg (_eg .Lvl7pPr ,_eaf );_agb ._dfag [7]=_fdg (_eg .Lvl8pPr ,_ff );_agb ._dfag [8]=_fdg (_eg .Lvl9pPr ,_cbb );};func (_fdb *convertContext )makeSlide (){_af :=_fdb ._gfcbf .GetSlideLayout ().CSld ;if _af !=nil {if _db :=_af .SpTree ;_db !=nil {for _ ,_fbc :=range _db .Choice {if _fbc !=nil {for _ ,_efc :=range _fbc .Pic {if _efc !=nil {var _gcf ,_edg ,_cf ,_ffa float64 ;
if _ad :=_efc .SpPr ;_ad !=nil {if _ecg :=_ad .Xfrm ;_ecg !=nil {_gcf ,_edg ,_cf ,_ffa =_b .GetDataFromXfrm (_ecg );};};if _ega :=_efc .BlipFill ;_ega !=nil {_aa :=_fdb .getShapeFromBlipFill (_ega ,_gcf ,_edg ,_cf ,_ffa ,true );_fdb ._gefd =append (_fdb ._gefd ,_aa );
};};};};};};};_af =_fdb ._gfcbf .X ().CSld ;if _af ==nil {return ;};_dbg :=&background {};if _geg :=_af .Bg ;_geg !=nil {if _ga :=_geg .BgPr ;_ga !=nil {if _ga .NoFill ==nil {if _cc :=_ga .SolidFill ;_cc !=nil {_bfg ,_eabe :=_fdb .getColorFromSolidFill (_cc );
if _bfg !=nil {_dbg ._bcef =_bfg ;_dbg ._cgfe =_eabe ;};}else if _cgf :=_ga .BlipFill ;_cgf !=nil {_dbg ._dfb =_cgf ;};};};};_fdb ._dabf =_dbg ;if _bd :=_af .SpTree ;_bd !=nil {for _ ,_dfd :=range _bd .Choice {if _dfd !=nil {for _ ,_egd :=range _dfd .Sp {if _egd !=nil {_ebe :=_fdb .getShapes (_egd );
_fdb ._gefd =append (_fdb ._gefd ,_ebe ...);};};for _ ,_dff :=range _dfd .GraphicFrame {if _dff !=nil {var _ced ,_dd ,_edd ,_dcee float64 ;if _fea :=_dff .Xfrm ;_fea !=nil {_ced ,_dd ,_edd ,_dcee =_b .GetDataFromXfrm (_fea );};if _edd ==0&&_dcee ==0{_edd =_fdb ._fbea ;
_dcee =_fdb ._gbcd ;};if _fg :=_dff .Graphic ;_fg !=nil {if _ffab :=_fg .GraphicData ;_ffab !=nil {for _ ,_dee :=range _ffab .Any {if _afe ,_eae :=_dee .(*_bf .Chart );_eae {_bad ,_fdec :=_fdb .makePdfBlockFromChart (_afe ,_edd ,_dcee );if _fdec !=nil {_dc .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_fdec );
};if _bad !=nil {_bad .SetPos (_ced ,_dd );_fdb ._gefd =append (_fdb ._gefd ,_bad );};}else if _cbf ,_aag :=_dee .(*_fa .Tbl );_aag {_baa :=_fdb .makePdfBlockFromTable (_cbf ,_edd );if _baa !=nil {_daf :=_cd .NewBlock (_edd ,_dcee );_daf .SetPos (_ced ,_dd );
_daf .Draw (_baa );_fdb ._gefd =append (_fdb ._gefd ,_daf );};};};};};};};for _ ,_gfc :=range _dfd .CxnSp {if _gfc !=nil {_be :=_fdb .getConnectors (_gfc );_fdb ._gefd =append (_fdb ._gefd ,_be ...);};};for _ ,_acf :=range _dfd .GrpSp {_cfa :=0.0;_cfe :=0.0;
if _fcd :=_acf .GrpSpPr .Xfrm ;_fcd !=nil {_cfa ,_cfe =_b .GetGroupOffsetFromXfrm (_fcd );};for _ ,_aba :=range _acf .Choice {for _ ,_edb :=range _aba .CxnSp {if _edb !=nil {_eda :=_fdb .getGroupConnectors (_edb ,_cfa ,_cfe );_fdb ._gefd =append (_fdb ._gefd ,_eda ...);
};};};};for _ ,_ffac :=range _dfd .Pic {if _ffac !=nil {var _ede ,_cgd ,_ddd ,_dfdb float64 ;if _ebg :=_ffac .SpPr ;_ebg !=nil {if _ccd :=_ebg .Xfrm ;_ccd !=nil {_ede ,_cgd ,_ddd ,_dfdb =_b .GetDataFromXfrm (_ccd );};};if _cec :=_ffac .BlipFill ;_cec !=nil {_ggc :=_fdb .getShapeFromBlipFill (_cec ,_ede ,_cgd ,_ddd ,_dfdb ,false );
_fdb ._gefd =append (_fdb ._gefd ,_ggc );};};};};};};};func (_cbbd *textboxContext )alignVertically (_bbcc _fa .ST_TextAnchoringType ){_cbbd .alignParagraphsVertically (_bbcc );_cbbd .alignSymbolsVertically ();};func (_cfac *convertContext )getShapes (_fbf *_ea .CT_Shape )[]_cd .Drawable {_fca :=[]_cd .Drawable {};
_beg :=_fbf .SpPr ;if _beg ==nil {return _fca ;};var _fdf bool ;if _afa :=_fbf .UseBgFillAttr ;_afa !=nil {_fdf =*_afa ;};_dcea ,_gdga ,_dfed ,_efa ,_cac ,_eba ,_ccdc :=_cfac .getShapesFromSpPr (_beg ,_fbf .Style ,_fdf ,0.0,0.0);_fca =append (_fca ,_dcea ...);
if _gae :=_fbf .TxBody ;_gae !=nil {_gcb ,_ffb ,_dccb ,_begf ,_ddc :=_cfac .getPhData (_fbf );if _gcb !=nil &&!_ccdc {_gdga ,_dfed ,_efa ,_cac =_b .GetDataFromXfrm (_gcb );};_bac ,_aebc :=_cfac .makePdfBlockFromTxBody (_gae ,_ffb ,_dccb ,_efa ,_cac ,_eba ,_begf ,_ddc );
if _aebc !=nil {_dc .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_aebc );
}else if _bac !=nil {_bac .SetPos (_gdga ,_dfed );_fca =append (_fca ,_bac );};};return _fca ;};func (_dabcc *convertContext )getInfoFromLn (_fgb *_fa .CT_LineProperties )(_cd .Color ,float64 ,float64 ){if _fgb ==nil ||_fgb .NoFill !=nil {return nil ,0,0;
};var _febbd float64 ;_gba ,_abga :=_dabcc .getColorFromSolidFill (_fgb .SolidFill );if _fbae :=_fgb .WAttr ;_fbae !=nil {_febbd =_ce .FromEMU (int64 (*_fbae ));}else {_febbd =1;};return _gba ,_febbd ,_abga ;};func (_beef *convertContext )applyBlipEffectsOnImg (_fbfff *_cd .Image ,_gfdd ,_fgad float64 ,_adge []*_fa .CT_BlipChoice )*_cd .Image {if len (_adge )==0{return _fbfff ;
};_fbfff .SetPos (_gfdd ,_fgad );_agbe ,_gfca :=_beef .renderPageWithDrawableToGoImage (_fbfff );if _gfca !=nil {_dc .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_gfca );
return _fbfff ;};_geff ,_gfca :=_beef .renderCurrentStateToGoImage ();if _gfca !=nil {_dc .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_gfca );
return _fbfff ;};_gbdd :=_agbe .Bounds ();_fbce :=_ace .NewRGBA (_gbdd );_bbec ,_eeed :=_fbfff .Width (),_fbfff .Height ();for _ ,_ecc :=range _adge {for _ ,_cgad :=range _ecc .AlphaModFix {if _bfba :=_cgad .AmtAttr ;_bfba !=nil {if _faa :=_bfba .ST_PositivePercentageDecimal ;
_faa !=nil {_fcbf :=uint8 (255*(*_faa )/100000);_dcdgd :=_ace .NewUniform (_c .Alpha {_fcbf });_ac .Draw (_fbce ,_gbdd ,_geff ,_ace .Point {0,0},_ac .Src );_ac .DrawMask (_fbce ,_gbdd ,_agbe ,_ace .Point {0,0},_dcdgd ,_ace .Point {0,0},_ac .Over );};};
};};_beea :=_ace .Rect (int (_gfdd ),int (_fgad ),int (_gfdd +_bbec )+1,int (_fgad +_eeed )+1);_fbbbc :=_b .CropImageByRect (_fbce ,_beea );_dffa ,_gfca :=_beef ._dfeg .NewImageFromGoImage (_fbbbc );if _gfca !=nil {_dc .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_gfca );
return _fbfff ;};return _dffa ;};func (_bfc *convertContext )getGroupConnectors (_aage *_ea .CT_Connector ,_fgf float64 ,_bcb float64 )[]_cd .Drawable {_gaee ,_ ,_ ,_ ,_ ,_ ,_ :=_bfc .getShapesFromSpPr (_aage .SpPr ,_aage .Style ,false ,_fgf ,_bcb );return _gaee ;
};func (_abd *convertContext )drawSlide (){_abd ._dfeg .NewPage ();for _ ,_degc :=range _abd ._gefd {if _degc !=nil {_abd ._dfeg .MoveTo (0,0);_abd ._dfeg .Draw (_degc );};};};func (_cgg *convertContext )makePdfDivisionFromTxBody (_dbf *_fa .CT_TextBody ,_cgc *_fa .CT_TableStyleTextStyle )*_cd .Division {_bda :=_cgg ._dfeg .NewDivision ();
_bec :=_cgg ._efge ;_gaef :=_fa .ST_TextAnchoringTypeT ;if _eeb :=_dbf .BodyPr ;_eeb !=nil {if _ebf :=_eeb .AnchorAttr ;_ebf !=_fa .ST_TextAnchoringTypeUnset {_gaef =_eeb .AnchorAttr ;};};if _dbb :=_dbf .LstStyle ;_dbb !=nil {var _cafa *_fa .CT_TextParagraphProperties ;
if _dbb .Lvl1pPr !=nil {_cafa =_dbb .Lvl1pPr ;}else {_cafa =_cgg ._abgd [0];};_bec =_fdg (_cafa ,_fdg (_dbb .DefPPr ,_bec ));};for _ ,_beca :=range _dbf .P {if _beca !=nil {_gge :=_cgg ._dfeg .NewStyledParagraph ();_cfee :=_fdg (_beca .PPr ,_bec );_cfgc :=_cdfe (_beca .EndParaRPr ,_cfee .DefRPr );
switch _cfee .AlgnAttr {case _fa .ST_TextAlignTypeR :_gge .SetTextAlignment (_cd .TextAlignmentRight );case _fa .ST_TextAlignTypeCtr :_gge .SetTextAlignment (_cd .TextAlignmentCenter );case _fa .ST_TextAlignTypeJust :_gge .SetTextAlignment (_cd .TextAlignmentJustify );
};if len (_beca .EG_TextRun )==0{_gge .Append ("\u000a");_bda .Add (_gge );continue ;};for _ ,_cda :=range _beca .EG_TextRun {if _bfaa :=_cda .Br ;_bfaa !=nil {_gge .Append ("\u000a");}else if _bgf :=_cda .R ;_bgf !=nil {_fbfg :=_afca (_bgf .RPr ,_cgc );
_fbfg =_cdfe (_fbfg ,_cfgc );var _ada _cd .Color ;if _fbfg .SolidFill !=nil {_ada ,_ =_cgg .getColorFromSolidFill (_fbfg .SolidFill );}else {_ada =_cd .ColorBlack ;};_febb ,_dfef ,_fcg ,_ :=_cgg .makeStyleFromRPr (_fbfg );_febb .Color =_ada ;if _dfef {_febb .TextRise =0.5;
}else if _fcg {_febb .TextRise =-0.5;};_abg :=_bgf .T ;if _fbfg .CapAttr ==_fa .ST_TextCapsTypeAll {for _ ,_bed :=range _abg {_bed =[]rune (_cg .ToUpper (string (_bed )))[0];};};_cba :=_gge .Append (_abg );_cba .Style =*_febb ;};};_ =_gaef ;_bda .Add (_gge );
};};return _bda ;};func _afca (_ffbbb *_fa .CT_TextCharacterProperties ,_eggb *_fa .CT_TableStyleTextStyle )*_fa .CT_TextCharacterProperties {_bdbb :=_fa .NewCT_TextCharacterProperties ();if _ffbbb !=nil {*_bdbb =*_ffbbb ;};if _eggb ==nil {return _bdbb ;
};if _bdbb .BAttr ==nil &&_eggb .BAttr !=_fa .ST_OnOffStyleTypeUnset {_aceb :=_eggb .BAttr ==_fa .ST_OnOffStyleTypeOn ;_bdbb .BAttr =&_aceb ;};if _bdbb .IAttr ==nil &&_eggb .IAttr !=_fa .ST_OnOffStyleTypeUnset {_gbbf :=_eggb .IAttr ==_fa .ST_OnOffStyleTypeOn ;
_bdbb .IAttr =&_gbbf ;};if _bdbb .NoFill ==nil &&_bdbb .SolidFill ==nil {_bdbb .SolidFill =_fa .NewCT_SolidColorFillProperties ();_bdbb .SolidFill .ScrgbClr =_eggb .ScrgbClr ;_bdbb .SolidFill .SrgbClr =_eggb .SrgbClr ;_bdbb .SolidFill .HslClr =_eggb .HslClr ;
_bdbb .SolidFill .SysClr =_eggb .SysClr ;_bdbb .SolidFill .SchemeClr =_eggb .SchemeClr ;_bdbb .SolidFill .PrstClr =_eggb .PrstClr ;};if _ddac :=_eggb .Font ;_ddac !=nil &&_bdbb .Latin ==nil &&_bdbb .Ea ==nil &&_bdbb .Cs ==nil {_bdbb .Latin =_ddac .Latin ;
_bdbb .Ea =_ddac .Ea ;_bdbb .Cs =_ddac .Cs ;};return _bdbb ;};type background struct{_bcef _cd .Color ;_cgfe float64 ;_dfb *_fa .CT_BlipFillProperties ;};func _ecfd (_cacfa ,_bcae *_fa .CT_TableStyleCellStyle )*_fa .CT_TableStyleCellStyle {_bbaf :=_fa .NewCT_TableStyleCellStyle ();
if _cacfa !=nil {*_bbaf =*_cacfa ;};if _bcae ==nil {return _bbaf ;};if _bbaf .TcBdr ==nil {_bbaf .TcBdr =_bcae .TcBdr ;};if _bbaf .Fill ==nil {_bbaf .Fill =_bcae .Fill ;};if _bbaf .FillRef ==nil {_bbaf .FillRef =_bcae .FillRef ;};return _bbaf ;};func (_bbgg *textboxContext )assignPropsToCurrentParagraph (_gbca *_fa .CT_TextParagraphProperties ){_bdc :=12.4;
if _gbca ==nil {_bbgg ._aeg ._egc =_bdc ;return ;};if _ccac :=_gbca .DefRPr ;_ccac !=nil {_dabg :=_ccac .SzAttr ;if _dabg !=nil {_ebgcg :=float64 (*_dabg )/1200;if _bdc <=_ebgcg {_bdc =_ebgcg ;};};};if _geef :=_gbca .MarLAttr ;_geef !=nil {_bbgg ._aeg ._dgb =_ce .FromEMU (int64 (*_geef ));
};_bbgg ._aeg ._fcgf =_bbgg ._gaf ;if _gcfa :=_gbca .MarRAttr ;_gcfa !=nil {_bbgg ._aeg ._fcgf -=_ce .FromEMU (int64 (*_gcfa ));};if _bgdb :=_gbca .IndentAttr ;_bgdb !=nil {_bbgg ._aeg ._geac =_ce .FromEMU (int64 (*_bgdb ));};if _dgba :=_gbca .LatinLnBrkAttr ;
_dgba !=nil {_bbgg ._aeg ._bbf =*_dgba ;};if _bgg :=_gbca .LnSpc ;_bgg !=nil {if _cgbd :=_bgg .SpcPct ;_cgbd !=nil {if _gede :=_cgbd .ValAttr .ST_TextSpacingPercent ;_gede !=nil {_bdc =float64 (*_gede )/5000;};};};var _fgg float64 ;if _bffg :=_gbca .SpcBef ;
_bffg !=nil {if _aaf :=_bffg .SpcPts ;_aaf !=nil {_fgg =float64 (_aaf .ValAttr )/100;};};_dedb :=_bbgg ._cged ;if len (_dedb )> 0{_fgg -=_dedb [len (_dedb )-1]._cgga ;if _fgg < 0{_fgg =0;};};_bbgg ._aeg ._cffg =_fgg ;if _ddgg :=_gbca .SpcAft ;_ddgg !=nil {if _gcea :=_ddgg .SpcPts ;
_gcea !=nil {_bbgg ._aeg ._cgga =float64 (_gcea .ValAttr )/100;};};_bbgg ._aeg ._egc =_bdc ;_bbgg ._aeg ._dcd =_gbca .AlgnAttr ;};func (_aeb *convertContext )stretchImage (_abe *_cd .Image ,_dgd *_fa .CT_StretchInfoProperties ,_gcdg ,_cff ,_efb ,_ded float64 )(*_cd .Image ,float64 ,float64 ){_dae :=_dgd .FillRect ;
if _dae ==nil {_cfc :=_abe .Width ()/_abe .Height ();_dfe :=_efb /_ded ;var _dbgb ,_aaa float64 ;if _cfc > _dfe {_aaa =_ded ;_dbgb =_ded *_cfc ;}else {_dbgb =_efb ;_aaa =_efb /_cfc ;};_abe .Scale (_dbgb /_abe .Width (),_aaa /_abe .Height ());return _abe ,_gcdg ,_cff ;
};var _dde ,_fbcg ,_gdg ,_deb float64 ;if _ebea :=_dae .LAttr ;_ebea !=nil {_gdg =_b .FromSTPercentage (_ebea );};if _ffg :=_dae .TAttr ;_ffg !=nil {_dde =_b .FromSTPercentage (_ffg );};if _acd :=_dae .RAttr ;_acd !=nil {_deb =_b .FromSTPercentage (_acd );
};if _bag :=_dae .BAttr ;_bag !=nil {_fbcg =_b .FromSTPercentage (_bag );};_eag :=_efb *(1-_gdg -_deb );_fdbf :=_ded *(1-_dde -_fbcg );_abe .Scale (_eag /_abe .Width (),_fdbf /_abe .Height ());return _abe ,_gcdg +_gdg *_efb ,_cff +_dde *_ded ;};func (_gadf *convertContext )getPhData (_dbdg *_ea .CT_Shape )(*_fa .CT_Transform2D ,*_fa .CT_TextBodyProperties ,*_fa .CT_TextListStyle ,bool ,bool ){_acgg ,_fbab :=_bffb (_dbdg );
_fgdcb :=_fbab ==nil ;_efda ,_fce ,_febfd ,_gedbg :=_fbbbg (_gadf ._cbaa .CSld ,_acgg ,_fbab ,_fgdcb );_gddgb ,_fdbd ,_bfadf ,_bgfa :=_fbbbg (_gadf ._afc .CSld ,_acgg ,_fbab ,_fgdcb );if _gddgb ==nil {_gddgb =_efda ;};_cfgd ,_fefb :=_fga (_fdbd ,_fce );
var _ceed ,_ggcc bool ;if _bfadf ==nil {if _febfd !=nil {_ceed =*_febfd ;};}else {_ceed =*_bfadf ;};if _bgfa ==nil {if _gedbg !=nil {_ggcc =*_gedbg ;};}else {_ggcc =*_bgfa ;};return _gddgb ,_cfgd ,_fefb ,_ceed ,_ggcc ;};func (_fd *convertContext )makePdfBlockFromChart (_fb *_bf .Chart ,_cad ,_ec float64 )(*_cd .Block ,error ){_fde :=_fb .CT_RelId .IdAttr ;
_ae :=_fd ._gfcbf .GetChartSpaceByRelId (_fde );if _ae ==nil {return nil ,_d .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _ge *_fa .Theme ;_ef :=_fd ._ebdc .Themes ();if len (_ef )> 0{_ge =_ef [0];};return _b .MakeBlockFromChartSpace (_ae ,_cad ,_ec ,_ge );
};var _deg =_dec (1.9);func _fdg (_gfag ,_gafca *_fa .CT_TextParagraphProperties )*_fa .CT_TextParagraphProperties {_dgbb :=_fa .NewCT_TextParagraphProperties ();if _gfag !=nil {*_dgbb =*_gfag ;};if _gafca ==nil {return _dgbb ;};if _dgbb .MarLAttr ==nil {_dgbb .MarLAttr =_gafca .MarLAttr ;
};if _dgbb .MarRAttr ==nil {_dgbb .MarRAttr =_gafca .MarRAttr ;};if _dgbb .LvlAttr ==nil {_dgbb .LvlAttr =_gafca .LvlAttr ;};if _dgbb .IndentAttr ==nil {_dgbb .IndentAttr =_gafca .IndentAttr ;};if _dgbb .AlgnAttr ==_fa .ST_TextAlignTypeUnset {_dgbb .AlgnAttr =_gafca .AlgnAttr ;
};if _dgbb .DefTabSzAttr ==nil {_dgbb .DefTabSzAttr =_gafca .DefTabSzAttr ;};if _dgbb .RtlAttr ==nil {_dgbb .RtlAttr =_gafca .RtlAttr ;};if _dgbb .EaLnBrkAttr ==nil {_dgbb .EaLnBrkAttr =_gafca .EaLnBrkAttr ;};if _dgbb .FontAlgnAttr ==_fa .ST_TextFontAlignTypeUnset {_dgbb .FontAlgnAttr =_gafca .FontAlgnAttr ;
};if _dgbb .LatinLnBrkAttr ==nil {_dgbb .LatinLnBrkAttr =_gafca .LatinLnBrkAttr ;};if _dgbb .HangingPunctAttr ==nil {_dgbb .HangingPunctAttr =_gafca .HangingPunctAttr ;};if _dgbb .LnSpc ==nil {_dgbb .LnSpc =_gafca .LnSpc ;};if _dgbb .SpcBef ==nil {_dgbb .SpcBef =_gafca .SpcBef ;
};if _dgbb .SpcAft ==nil {_dgbb .SpcAft =_gafca .SpcAft ;};if _dgbb .BuClrTx ==nil {_dgbb .BuClrTx =_gafca .BuClrTx ;};if _dgbb .BuClr ==nil {_dgbb .BuClr =_gafca .BuClr ;};if _dgbb .BuSzTx ==nil {_dgbb .BuSzTx =_gafca .BuSzTx ;};if _dgbb .BuSzPct ==nil {_dgbb .BuSzPct =_gafca .BuSzPct ;
};if _dgbb .BuSzPts ==nil {_dgbb .BuSzPts =_gafca .BuSzPts ;};if _dgbb .BuFontTx ==nil {_dgbb .BuFontTx =_gafca .BuFontTx ;};if _dgbb .BuFont ==nil {_dgbb .BuFont =_gafca .BuFont ;};if _dgbb .BuNone ==nil {_dgbb .BuNone =_gafca .BuNone ;};if _dgbb .BuAutoNum ==nil {_dgbb .BuAutoNum =_gafca .BuAutoNum ;
};if _dgbb .BuChar ==nil {_dgbb .BuChar =_gafca .BuChar ;};if _dgbb .BuBlip ==nil {_dgbb .BuBlip =_gafca .BuBlip ;};if _dgbb .TabLst ==nil {_dgbb .TabLst =_gafca .TabLst ;};if _dgbb .ExtLst ==nil {_dgbb .ExtLst =_gafca .ExtLst ;};_dgbb .DefRPr =_cdfe (_dgbb .DefRPr ,_gafca .DefRPr );
return _dgbb ;};func (_cga *textboxContext )newParagraph (){_bgc :=&paragraph {};_bgc ._aae =_cga ._adc ;_cga ._aeg =_bgc ;};func (_fcdb *convertContext )renderPageWithDrawableToGoImage (_fbacd _cd .Drawable )(_ace .Image ,error ){_cbdf :=_b .MakeTempCreator (_fcdb ._fbea ,_fcdb ._gbcd );
_cbdf .NewPage ();_cbdf .Draw (_fbacd );_cacg ,_ebac :=_b .GetPageFromCreator (_cbdf );if _ebac !=nil {return nil ,_ebac ;};return _ed .NewImageDevice ().Render (_cacg );};func (_abab *convertContext )getStyleColors (_gcbd *_fa .CT_ShapeStyle )(_cd .Color ,_cd .Color ,_cd .Color ){var _bdaf ,_fac ,_cedc _cd .Color ;
if _eecbd :=_gcbd .LnRef ;_eecbd !=nil {_fac =_abab .getColorFromMatrixReference (_eecbd );};if _fbba :=_gcbd .FillRef ;_fbba !=nil {_cedc =_abab .getColorFromMatrixReference (_fbba );};if _egdb :=_gcbd .FontRef ;_egdb !=nil {_bdaf =_abab .getColorFromFontReference (_egdb );
};return _bdaf ,_cedc ,_fac ;};type symbol struct{_cgb string ;_dffe float64 ;_bfca float64 ;_gdd float64 ;_ebb float64 ;_caef float64 ;_geda *_cd .TextStyle ;_agcb string ;_gcbc bool ;_cedaf bool ;_efe bool ;};func (_cde *convertContext )getConnectors (_bfa *_ea .CT_Connector )[]_cd .Drawable {_cecg ,_ ,_ ,_ ,_ ,_ ,_ :=_cde .getShapesFromSpPr (_bfa .SpPr ,_bfa .Style ,false ,0.0,0.0);
return _cecg ;};func _bffb (_afd *_ea .CT_Shape )(_ea .ST_PlaceholderType ,*uint32 ){if _cbba :=_afd .NvSpPr ;_cbba !=nil {if _dda :=_cbba .NvPr ;_dda !=nil {if _beba :=_dda .Ph ;_beba !=nil {return _beba .TypeAttr ,_beba .IdxAttr ;};};};return _ea .ST_PlaceholderTypeUnset ,nil ;
};func _aecg (_bbea int ,_ccbf bool )string {_fcge :=(_bbea -1)/26+1;_ggga :=byte ((_bbea -1)%26);if _ccbf {_ggga +=byte (65);}else {_ggga +=byte (97);};_efgb :=_de .NewBuffer ([]byte {});for _fab :=0;_fab < _fcge ;_fab ++{_efgb .Write ([]byte {_ggga });
};return _efgb .String ();};func _gbf (_bcbd *_fa .CT_AdjPoint2D )(float64 ,float64 ){var _dcdg ,_baad float64 ;_bbccd ,_bfga :=_bcbd .XAttr ,_bcbd .YAttr ;if _edf :=_bbccd .ST_Coordinate ;_edf !=nil {_dcdg =_ce .FromEMU (_b .FromSTCoordinate (*_edf ));
};if _cddb :=_bfga .ST_Coordinate ;_cddb !=nil {_baad =_ce .FromEMU (_b .FromSTCoordinate (*_cddb ));};return _dcdg ,_baad ;};func (_fec *convertContext )getShapesFromSpPr (_caf *_fa .CT_ShapeProperties ,_cadb *_fa .CT_ShapeStyle ,_fbb bool ,_beb float64 ,_agd float64 )([]_cd .Drawable ,float64 ,float64 ,float64 ,float64 ,_cd .Color ,bool ){_gfg :=[]_cd .Drawable {};
var _gee ,_bbc ,_gda ,_bfgg ,_ead float64 ;var _gde ,_eaeb ,_ebc ,_bcf _cd .Color ;var _fgc *_fa .CT_BlipFillProperties ;_fed ,_eca :=1.0,1.0;if _cadb !=nil {_gde ,_eaeb ,_bcf =_fec .getStyleColors (_cadb );};if _gef :=_caf .Ln ;_gef !=nil {if _gef .NoFill !=nil {_ebc ,_ead =nil ,0;
}else {_ebc ,_ead ,_fed =_fec .getInfoFromLn (_gef );if _ebc ==nil {_ebc =_bcf ;};};};if _caf .NoFill !=nil {_eaeb ,_eca =nil ,0;}else if _fbb {_eaeb =_fec ._dabf ._bcef ;_eca =_fec ._dabf ._cgfe ;_fgc =_fec ._dabf ._dfb ;}else if _edgf :=_caf .SolidFill ;
_edgf !=nil {_eaeb ,_eca =_fec .getColorFromSolidFill (_edgf );};var _bbg bool ;if _bfe :=_caf .Xfrm ;_bfe !=nil {_gee ,_bbc ,_gda ,_bfgg =_b .GetDataFromXfrm (_bfe );_gee +=_beb ;_bbc +=_agd ;_bbg =true ;};if _feg :=_caf .CustGeom ;_feg !=nil {_bg :=[]_dg .Point {};
_gdac ,_bagc :=1.0,1.0;if _cfed :=_feg .PathLst ;_cfed !=nil {for _ ,_dagd :=range _cfed .Path {if _dagd !=nil {if _fedg :=_dagd .WAttr ;_fedg !=nil {_gdac =_gda /_ce .FromEMU (*_fedg );};if _bfgf :=_dagd .HAttr ;_bfgf !=nil {_bagc =_bfgg /_ce .FromEMU (*_bfgf );
};for _ ,_cbfd :=range _dagd .Close {if _cbfd !=nil {};};for _ ,_gdf :=range _dagd .MoveTo {if _gdf !=nil &&_gdf .Pt !=nil {_dab ,_gedg :=_gbf (_gdf .Pt );_bg =append (_bg ,_dg .Point {X :_dab *_gdac +_gee ,Y :_gedg *_bagc +_bbc });};};for _ ,_fgcg :=range _dagd .LnTo {if _fgcg !=nil &&_fgcg .Pt !=nil {_ceda ,_dccbb :=_gbf (_fgcg .Pt );
_bg =append (_bg ,_dg .Point {X :_ceda *_gdac +_gee ,Y :_dccbb *_bagc +_bbc });};};_fbg :=_fec ._dfeg .NewPolygon ([][]_dg .Point {_bg });_fbg .SetFillColor (_eaeb );_fbg .SetFillOpacity (_eca );_fbg .SetBorderWidth (_ead );if _ebc !=nil {_fbg .SetBorderColor (_ebc );
_fbg .SetBorderOpacity (_fed );};_gfg =append (_gfg ,_fbg );};};};};if _egf :=_caf .PrstGeom ;_egf !=nil {switch _egf .PrstAttr {case _fa .ST_ShapeTypeRect :if _fgc !=nil {_dceg :=_fec .getShapeFromBlipFill (_fgc ,_gee ,_bbc ,_gda ,_bfgg ,false );_gfg =append (_gfg ,_dceg );
}else {_bdb :=_fec ._dfeg .NewRectangle (_gee ,_bbc ,_gda ,_bfgg );_aec :=_eaeb !=nil &&_eca > 0;if _aec {_bdb .SetFillColor (_eaeb );_bdb .SetFillOpacity (_eca );};_aaga :=_ebc !=nil &&_fed > 0&&_ead > 0;if _aaga {_bdb .SetBorderWidth (_ead );_bdb .SetBorderColor (_ebc );
_bdb .SetBorderOpacity (_fed );};if _aec ||_aaga {_gfg =append (_gfg ,_bdb );};};case _fa .ST_ShapeTypeLine :_gag :=_fec ._dfeg .NewLine (_gee ,_bbc ,_gee +_gda ,_bbc +_bfgg );_gag .SetLineWidth (_ead );if _ebc !=nil {_gag .SetColor (_ebc );};_gfg =append (_gfg ,_gag );
};};return _gfg ,_gee ,_bbc ,_gda ,_bfgg ,_gde ,_bbg ;};type line struct{_fbec float64 ;_gfe float64 ;_baag float64 ;_dad float64 ;_aebac float64 ;_dbaa []*word ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_ag .Presentation )*_cd .Creator {_dcf :=pr .X ().SldSz ;_dce :=_ce .FromEMU (int64 (_dcf .CxAttr ));_fe :=_ce .FromEMU (int64 (_dcf .CyAttr ));_da :=_cd .PageSize {_dce ,_fe };_fc :=_cd .New ();_fc .SetPageSize (_da );var _cae *_fa .Theme ;
if len (pr .Themes ())> 0{_cae =pr .Themes ()[0];};for _ ,_bb :=range pr .Slides (){if _bb .X ()==nil {continue ;};_df :=&convertContext {_dfeg :_fc ,_gfcbf :&_bb ,_afc :_bb .GetSlideLayout (),_cbaa :pr .SlideMasters ()[0].X (),_ebdc :pr ,_dcaf :_cae ,_ddgb :_bb .X ().ClrMapOvr ,_gbcd :_da [1],_fbea :_da [0]};
_df .extractDefaultProperties ();_df .makeSlide ();_df .drawSlide ();};return _fc ;};func _aebf (_cbfe ,_fbeb *_fa .CT_TableStyleTextStyle )*_fa .CT_TableStyleTextStyle {_dbae :=_fa .NewCT_TableStyleTextStyle ();if _cbfe !=nil {*_dbae =*_cbfe ;};if _fbeb ==nil {return _dbae ;
};if _dbae .BAttr ==_fa .ST_OnOffStyleTypeUnset {_dbae .BAttr =_fbeb .BAttr ;};if _dbae .IAttr ==_fa .ST_OnOffStyleTypeUnset {_dbae .IAttr =_fbeb .IAttr ;};if _dbae .Font ==nil {_dbae .Font =_fbeb .Font ;};if _dbae .FontRef ==nil {_dbae .FontRef =_fbeb .FontRef ;
};if _dbae .ScrgbClr ==nil {_dbae .ScrgbClr =_fbeb .ScrgbClr ;};if _dbae .SrgbClr ==nil {_dbae .SrgbClr =_fbeb .SrgbClr ;};if _dbae .HslClr ==nil {_dbae .HslClr =_fbeb .HslClr ;};if _dbae .SysClr ==nil {_dbae .SysClr =_fbeb .SysClr ;};if _dbae .SchemeClr ==nil {_dbae .SchemeClr =_fbeb .SchemeClr ;
};if _dbae .PrstClr ==nil {_dbae .PrstClr =_fbeb .PrstClr ;};return _dbae ;};type symbolStyle struct{_dadb *string ;_dcb *float64 ;_dafa *string ;_eee *bool ;_gce *bool ;_fbfga *bool ;_efcg *bool ;_fdc *bool ;};func (_gfceg *convertContext )getShapeFromBlipFill (_aff *_fa .CT_BlipFillProperties ,_fef ,_gcac ,_gdfc ,_acca float64 ,_abdc bool )_cd .Drawable {_bcbe ,_degeb ,_bfad :=_gfceg .makePdfImageFromBlipFill (_aff ,_abdc );
if _bfad !=nil {_dc .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_bfad );
return nil ;};if _bcbe ==nil {return nil ;};if _dbga :=_aff .Tile ;_dbga !=nil {_bcbe =_gfceg .tileImage (_bcbe ,_aff .Tile ,_gdfc ,_acca );};if _cdef :=_aff .Stretch ;_cdef !=nil {_bcbe ,_fef ,_gcac =_gfceg .stretchImage (_bcbe ,_aff .Stretch ,_fef ,_gcac ,_gdfc ,_acca );
};if _bcbe ==nil {return nil ;};if len (_degeb )==0{_bcbe .SetPos (_fef ,_gcac );return _bcbe ;};_bcbe =_gfceg .applyBlipEffectsOnImg (_bcbe ,_fef ,_gcac ,_degeb );_bcbe .SetPos (_fef ,_gcac );return _bcbe ;};func _aagaa (_agdeb *bool )bool {return _agdeb !=nil &&*_agdeb };
func (_bba *textboxContext )adjustHeights (_fedf float64 ){if _bba ._fcdd ._aebac < _fedf {_bba ._aeg ._aga +=(_fedf -_bba ._fcdd ._aebac );_bba ._fcdd ._aebac =_fedf ;};};func (_bcd *convertContext )getColorFromSolidFill (_fbgb *_fa .CT_SolidColorFillProperties )(_cd .Color ,float64 ){if _fbgb ==nil {return nil ,1;
};var _fece string ;_dcdd :=1.0;if _aada :=_fbgb .SrgbClr ;_aada !=nil {_fece =_aada .ValAttr ;_dcdd =_b .GetOpacityFromColorTransform (_aada .EG_ColorTransform );}else if _agac :=_fbgb .SchemeClr ;_agac !=nil {_fece =_b .GetColorStringFromDmlColor (_bcd ._gfcbf .GetColorBySchemeColor (_agac .ValAttr ));
_fece =_b .AdjustColor (_fece ,_agac .EG_ColorTransform );_dcdd =_b .GetOpacityFromColorTransform (_agac .EG_ColorTransform );};if _fece !=""{_gbcdg :=_cd .ColorRGBFromHex ("\u0023"+_fece );return _gbcdg ,_dcdd ;};return nil ,1;};func _bebd (_dedc ,_bcbg *_fa .CT_TextBodyProperties )*_fa .CT_TextBodyProperties {_ggde :=_fa .NewCT_TextBodyProperties ();
if _dedc !=nil {*_ggde =*_dedc ;};if _bcbg ==nil {return _ggde ;};if _ggde .RotAttr ==nil {_ggde .RotAttr =_bcbg .RotAttr ;};if _ggde .SpcFirstLastParaAttr ==nil {_ggde .SpcFirstLastParaAttr =_bcbg .SpcFirstLastParaAttr ;};if _ggde .VertOverflowAttr ==_fa .ST_TextVertOverflowTypeUnset {_ggde .VertOverflowAttr =_bcbg .VertOverflowAttr ;
};if _ggde .HorzOverflowAttr ==_fa .ST_TextHorzOverflowTypeUnset {_ggde .HorzOverflowAttr =_bcbg .HorzOverflowAttr ;};if _ggde .VertAttr ==_fa .ST_TextVerticalTypeUnset {_ggde .VertAttr =_bcbg .VertAttr ;};if _ggde .WrapAttr ==_fa .ST_TextWrappingTypeUnset {_ggde .WrapAttr =_bcbg .WrapAttr ;
};if _ggde .LInsAttr ==nil {_ggde .LInsAttr =_bcbg .LInsAttr ;};if _ggde .TInsAttr ==nil {_ggde .TInsAttr =_bcbg .TInsAttr ;};if _ggde .RInsAttr ==nil {_ggde .RInsAttr =_bcbg .RInsAttr ;};if _ggde .BInsAttr ==nil {_ggde .BInsAttr =_bcbg .BInsAttr ;};if _ggde .NumColAttr ==nil {_ggde .NumColAttr =_bcbg .NumColAttr ;
};if _ggde .SpcColAttr ==nil {_ggde .SpcColAttr =_bcbg .SpcColAttr ;};if _ggde .RtlColAttr ==nil {_ggde .RtlColAttr =_bcbg .RtlColAttr ;};if _ggde .AnchorAttr ==_fa .ST_TextAnchoringTypeUnset {_ggde .AnchorAttr =_bcbg .AnchorAttr ;};if _ggde .AnchorCtrAttr ==nil {_ggde .AnchorCtrAttr =_bcbg .AnchorCtrAttr ;
};if _ggde .ForceAAAttr ==nil {_ggde .ForceAAAttr =_bcbg .ForceAAAttr ;};if _ggde .UprightAttr ==nil {_ggde .UprightAttr =_bcbg .UprightAttr ;};if _ggde .CompatLnSpcAttr ==nil {_ggde .CompatLnSpcAttr =_bcbg .CompatLnSpcAttr ;};if _ggde .PrstTxWarp ==nil {_ggde .PrstTxWarp =_bcbg .PrstTxWarp ;
};if _ggde .NoAutofit ==nil {_ggde .NoAutofit =_bcbg .NoAutofit ;};if _ggde .NormAutofit ==nil {_ggde .NormAutofit =_bcbg .NormAutofit ;};if _ggde .SpAutoFit ==nil {_ggde .SpAutoFit =_bcbg .SpAutoFit ;};if _ggde .Scene3d ==nil {_ggde .Scene3d =_bcbg .Scene3d ;
};if _ggde .Sp3d ==nil {_ggde .Sp3d =_bcbg .Sp3d ;};if _ggde .FlatTx ==nil {_ggde .FlatTx =_bcbg .FlatTx ;};if _ggde .ExtLst ==nil {_ggde .ExtLst =_bcbg .ExtLst ;};return _ggde ;};func _aaec (_ecec int ,_aab bool )string {_eecb :=_de .NewBuffer ([]byte {});
for _ ,_cebg :=range _agga {for {if _ecec < _cebg ._aagf {break ;};_eecb .WriteString (_cebg ._gaeb );_ecec -=_cebg ._aagf ;};};_adffb :=_eecb .String ();if _aab {_adffb =_cg .ToUpper (_adffb );};return _adffb ;};func _gcfc (_gbg string )[]*symbol {_fbfd :=[]*symbol {};
for _ ,_eff :=range _gbg {_fbfd =append (_fbfd ,&symbol {_cgb :string (_eff )});};return _fbfd ;};func _fbbbg (_aecgg *_ea .CT_CommonSlideData ,_febe _ea .ST_PlaceholderType ,_bccb *uint32 ,_ebff bool )(*_fa .CT_Transform2D ,*_fa .CT_TextBody ,*bool ,*bool ){if _aecgg !=nil &&(_febe !=_ea .ST_PlaceholderTypeUnset ||!_ebff ){if _facc :=_aecgg .SpTree ;
_facc !=nil {for _ ,_feac :=range _facc .Choice {if _feac !=nil {for _ ,_eed :=range _feac .Sp {if _eed !=nil {_cacf ,_bdac :=_bffb (_eed );if _febe ==_cacf {if (_ebff &&_bdac ==nil )||(!_ebff &&_bdac !=nil &&*_bdac ==*_bccb ){var _deca *_fa .CT_Transform2D ;
if _eed .SpPr !=nil {_deca =_eed .SpPr .Xfrm ;};_ebbb :=_febe ==_ea .ST_PlaceholderTypeTitle ||_febe ==_ea .ST_PlaceholderTypeCtrTitle ;_ffcce :=!_ebbb &&_febe !=_ea .ST_PlaceholderTypeUnset ;return _deca ,_eed .TxBody ,&_ebbb ,&_ffcce ;};};};};};};};};
return nil ,nil ,nil ,nil ;};func (_cagd *textboxContext )addCurrentParagraph (){_cagd ._adc =_cagd ._aeg ._aae +_cagd ._aeg ._cffg +_cagd ._aeg ._aga +_cagd ._aeg ._cgga ;_cagd ._cged =append (_cagd ._cged ,_cagd ._aeg );_cagd .alignParagraph ();};func (_cdge *convertContext )renderCurrentStateToGoImage ()(_ace .Image ,error ){_bfab :=_b .MakeTempCreator (_cdge ._fbea ,_cdge ._gbcd );
_bfab .NewPage ();for _ ,_aef :=range _cdge ._gefd {if _aef !=nil {_bfab .MoveTo (0,0);_bfab .Draw (_aef );};};_bcbf ,_eeda :=_b .GetPageFromCreator (_bfab );if _eeda !=nil {return nil ,_eeda ;};return _ed .NewImageDevice ().Render (_bcbf );};func _dec (_febag float64 )float64 {return _febag *_ce .Millimeter };
func (_bca *textboxContext )newLine (){if _bca ._aeg ==nil {_bca .newParagraph ();};_cfab :=_bca ._aeg ._aga +_bca ._aeg ._cffg ;_bcaa :=&line {};_bcaa ._gfe =_bca ._aeg ._dgb ;if len (_bca ._aeg ._daae )==0{_bcaa ._gfe +=_bca ._aeg ._geac ;};_bcaa ._baag =_bca ._aeg ._fcgf ;
_bcaa ._dad =_bcaa ._gfe ;_bcaa ._fbec =_cfab ;_bca ._aeg ._daae =append (_bca ._aeg ._daae ,_bcaa );_bca ._fcdd =_bcaa ;};func (_agaf *convertContext )getColorFromMatrixReference (_ddb *_fa .CT_StyleMatrixReference )_cd .Color {if _ddb ==nil {return nil ;
};var _cfdg _cd .Color ;var _ddf string ;if _fcce :=_ddb .SrgbClr ;_fcce !=nil {_ddf =_fcce .ValAttr ;}else if _dege :=_ddb .SchemeClr ;_dege !=nil {_ddf =_b .GetColorStringFromDmlColor (_agaf ._ebdc .GetColorBySchemeColor (_dege .ValAttr ));_ddf =_b .AdjustColor (_ddf ,_dege .EG_ColorTransform );
};if _ddf !=""{_cfdg =_cd .ColorRGBFromHex ("\u0023"+_ddf );};return _cfdg ;};func (_adbd *convertContext )makePdfImageFromBlipFill (_ggdac *_fa .CT_BlipFillProperties ,_gfgb bool )(*_cd .Image ,[]*_fa .CT_BlipChoice ,error ){if _edeg :=_ggdac .Blip ;_edeg !=nil {if _bfgb :=_edeg .EmbedAttr ;
_bfgb !=nil {var _dbea _gb .ImageRef ;var _bbga bool ;if _gfgb {_dbea ,_bbga =_adbd ._gfcbf .GetLayoutImageByRelID (*_bfgb );}else {_dbea ,_bbga =_adbd ._gfcbf .GetImageByRelID (*_bfgb );};if _bbga {_gec ,_efbb :=_f .Open (_dbea .Path ());if _efbb !=nil {_dc .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_efbb );
return nil ,nil ,_efbb ;};defer _gec .Close ();_gedae ,_ ,_efbb :=_ace .Decode (_gec );if _efbb !=nil {_dc .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_efbb );return nil ,nil ,_efbb ;
};if _dfeca :=_ggdac .SrcRect ;_dfeca !=nil {_faec :=_gedae .Bounds ().Size ();_gfce :=_faec .X ;_agcf :=_faec .Y ;var _ccda ,_cadc ,_fdfcd ,_feaa int ;var _gff bool ;if _dceb :=_dfeca .LAttr ;_dceb !=nil {_ccda =int (float64 (_gfce )*_b .FromSTPercentage (_dceb ));
_gff =true ;}else {_ccda =0;};if _dbca :=_dfeca .TAttr ;_dbca !=nil {_fdfcd =int (float64 (_agcf )*_b .FromSTPercentage (_dbca ));_gff =true ;}else {_fdfcd =0;};if _eaee :=_dfeca .RAttr ;_eaee !=nil {_cadc =int (float64 (_gfce )*(1-_b .FromSTPercentage (_eaee )));
_gff =true ;}else {_cadc =_gfce ;};if _adbf :=_dfeca .BAttr ;_adbf !=nil {_feaa =int (float64 (_agcf )*(1-_b .FromSTPercentage (_adbf )));_gff =true ;}else {_feaa =_agcf ;};if _gff {_gedae =_b .CropImageByRect (_gedae ,_ace .Rect (_ccda ,_fdfcd ,_cadc +1,_feaa +1));
};};_afg ,_efbb :=_adbd ._dfeg .NewImageFromGoImage (_gedae );_afg .SetEncoder (_e .NewFlateEncoder ());if _efbb !=nil {_dc .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_efbb );
return nil ,nil ,_efbb ;};return _afg ,_edeg .Choice ,nil ;};};};return nil ,nil ,nil ;};func (_bbff *line )moveRight (_abdf float64 ){for _ ,_fdbg :=range _bbff ._dbaa {_fdbg ._abb +=_abdf ;};};func _aagb (_aeeg ,_cfgg *_fa .CT_TablePartStyle )*_fa .CT_TablePartStyle {_dagc :=_fa .NewCT_TablePartStyle ();
if _aeeg !=nil {*_dagc =*_aeeg ;};if _cfgg ==nil {return _dagc ;};if _dagc .TcTxStyle ==nil {_dagc .TcTxStyle =_cfgg .TcTxStyle ;}else {_dagc .TcTxStyle =_aebf (_dagc .TcTxStyle ,_cfgg .TcTxStyle );};if _dagc .TcStyle ==nil {_dagc .TcStyle =_cfgg .TcStyle ;
}else {_dagc .TcStyle =_ecfd (_dagc .TcStyle ,_cfgg .TcStyle );};return _dagc ;};func (_cedd *convertContext )getColorFromFontReference (_bfbb *_fa .CT_FontReference )_cd .Color {var _beeg _cd .Color ;var _febdf string ;if _gad :=_bfbb .SrgbClr ;_gad !=nil {_febdf =_gad .ValAttr ;
}else if _dfde :=_bfbb .SchemeClr ;_dfde !=nil {_febdf =_b .GetColorStringFromDmlColor (_cedd ._ebdc .GetColorBySchemeColor (_dfde .ValAttr ));_febdf =_b .AdjustColor (_febdf ,_dfde .EG_ColorTransform );};if _febdf !=""{_beeg =_cd .ColorRGBFromHex ("\u0023"+_febdf );
};return _beeg ;};func (_acgeb *textboxContext )addCurrentWordToParagraph (){if _acgeb ._ccgdb &&_acgeb ._fcdd ._dad +_acgeb ._gefb ._cadd > _acgeb ._fcdd ._baag {_acgeb .newLine ();};if !_acgeb ._gefb ._bbcb ||len (_acgeb ._fcdd ._dbaa )> 0{_acgeb ._gefb ._abb =_acgeb ._fcdd ._dad ;
_acgeb ._fcdd ._dbaa =append (_acgeb ._fcdd ._dbaa ,_acgeb ._gefb );_acgeb ._fcdd ._dad +=_acgeb ._gefb ._cadd ;for _ ,_gddg :=range _acgeb ._gefb ._fba {_acgeb .adjustHeights (_gddg ._bfca );};};};func (_febd *convertContext )makePdfBlockFromTxBody (_beda *_fa .CT_TextBody ,_acb *_fa .CT_TextBodyProperties ,_dgce *_fa .CT_TextListStyle ,_cbd ,_bede float64 ,_fbbg _cd .Color ,_cdab ,_bbbe bool )(*_cd .Block ,error ){var _feag *_fa .CT_TextParagraphProperties ;
if _cbc :=_beda .LstStyle ;_cbc !=nil {var _dgf *_fa .CT_TextParagraphProperties ;if _cbc .Lvl1pPr !=nil {_dgf =_cbc .Lvl1pPr ;};_feag =_fdg (_dgf ,_cbc .DefPPr );};var _cbfa *_fa .CT_TextParagraphProperties ;if _feag !=nil {if _cdab {_cbfa =_febd ._bbgd [0];
}else if _bbbe {_cbfa =_febd ._dfag [0];}else {_cbfa =_febd ._abgd [0];};if _dgce !=nil {_cbfa =_fdg (_fdg (_dgce .Lvl1pPr ,_dgce .DefPPr ),_cbfa );};_cbfa =_fdg (_feag ,_cbfa );}else {if _cdab {_cbfa =_febd ._fad ;}else if _bbbe {_cbfa =_febd ._fgdg ;
}else {_cbfa =_febd ._efge ;};};_dge ,_ebcf :=_dec (2.5),_dec (2.5);_ege ,_aac :=_dec (1.3),_dec (1.3);_cgcb :=true ;_dabc :=_fa .ST_TextAnchoringTypeT ;if _acb !=nil {if _gbba :=_acb .AnchorAttr ;_gbba !=_fa .ST_TextAnchoringTypeUnset {_dabc =_gbba ;};
};if _fcde :=_beda .BodyPr ;_fcde !=nil {if _cdc :=_fcde .LInsAttr ;_cdc !=nil {_dge =_ce .FromEMU (_b .FromSTCoordinate32 (*_cdc ));};if _bcg :=_fcde .TInsAttr ;_bcg !=nil {_ege =_ce .FromEMU (_b .FromSTCoordinate32 (*_bcg ));};if _dfg :=_fcde .RInsAttr ;
_dfg !=nil {_ebcf =_ce .FromEMU (_b .FromSTCoordinate32 (*_dfg ));};if _cag :=_fcde .BInsAttr ;_cag !=nil {_aac =_ce .FromEMU (_b .FromSTCoordinate32 (*_cag ));};_cgcb =_fcde .WrapAttr !=_fa .ST_TextWrappingTypeNone ;if _ebgd :=_fcde .AnchorAttr ;_ebgd !=_fa .ST_TextAnchoringTypeUnset {_dabc =_fcde .AnchorAttr ;
};};_bfb :=_b .MakeTempCreator (_cbd ,_bede );_bfb .SetPageMargins (_dge ,_ebcf ,_ege ,_aac );_edbg :=&textboxContext {_bdba :_febd ,_ccgdb :_cgcb ,_gaf :_cbd -_dge -_ebcf ,_caff :_bede -_ege -_aac ,_dgfb :_bfb ,_cged :[]*paragraph {}};_agdg :=1;for _ ,_bcc :=range _beda .P {if _bcc !=nil {_bfbd :=_bcc .PPr ;
var _acdd *prefixData ;if _bfbd !=nil &&_bfbd .BuNone ==nil {var _baec string ;var _dbd bool ;if _ebae :=_bfbd .BuAutoNum ;_ebae !=nil {var _dfge string ;if _cfeed :=_ebae .StartAtAttr ;_cfeed !=nil {_agdg =int (*_cfeed );};var _gcg string ;switch _ebae .TypeAttr {case _fa .ST_TextAutonumberSchemeAlphaUcParenBoth ,_fa .ST_TextAutonumberSchemeAlphaUcParenR ,_fa .ST_TextAutonumberSchemeAlphaUcPeriod :_gcg =_aecg (_agdg ,true );
case _fa .ST_TextAutonumberSchemeAlphaLcParenBoth ,_fa .ST_TextAutonumberSchemeAlphaLcParenR ,_fa .ST_TextAutonumberSchemeAlphaLcPeriod :_gcg =_aecg (_agdg ,false );case _fa .ST_TextAutonumberSchemeRomanUcParenBoth ,_fa .ST_TextAutonumberSchemeRomanUcParenR ,_fa .ST_TextAutonumberSchemeRomanUcPeriod :_gcg =_aaec (_agdg ,true );
case _fa .ST_TextAutonumberSchemeRomanLcParenBoth ,_fa .ST_TextAutonumberSchemeRomanLcParenR ,_fa .ST_TextAutonumberSchemeRomanLcPeriod :_gcg =_aaec (_agdg ,false );default:_gcg =_ab .Itoa (_agdg );};switch _ebae .TypeAttr {case _fa .ST_TextAutonumberSchemeAlphaLcPeriod ,_fa .ST_TextAutonumberSchemeAlphaUcPeriod ,_fa .ST_TextAutonumberSchemeArabicPeriod ,_fa .ST_TextAutonumberSchemeRomanLcPeriod ,_fa .ST_TextAutonumberSchemeRomanUcPeriod ,_fa .ST_TextAutonumberSchemeArabicDbPeriod ,_fa .ST_TextAutonumberSchemeEa1ChsPeriod ,_fa .ST_TextAutonumberSchemeEa1ChtPeriod ,_fa .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_fa .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_fa .ST_TextAutonumberSchemeThaiAlphaPeriod ,_fa .ST_TextAutonumberSchemeThaiNumPeriod ,_fa .ST_TextAutonumberSchemeHindiAlphaPeriod ,_fa .ST_TextAutonumberSchemeHindiNumPeriod ,_fa .ST_TextAutonumberSchemeHindiAlpha1Period :_dfge ="\u002e";
case _fa .ST_TextAutonumberSchemeAlphaLcParenR ,_fa .ST_TextAutonumberSchemeAlphaUcParenR ,_fa .ST_TextAutonumberSchemeArabicParenR ,_fa .ST_TextAutonumberSchemeRomanLcParenR ,_fa .ST_TextAutonumberSchemeRomanUcParenR ,_fa .ST_TextAutonumberSchemeThaiAlphaParenR ,_fa .ST_TextAutonumberSchemeThaiNumParenR ,_fa .ST_TextAutonumberSchemeHindiNumParenR :_dfge ="\u0029";
};_baec =_gcg +_dfge ;_agdg ++;}else if _dfefb :=_bfbd .BuChar ;_dfefb !=nil {_gefc :=_dfefb .CharAttr ;if _ffbb ,_daa :=_ebcd [_gefc ];_daa {_gefc =string (rune (_ffbb ));}else {_gefc ="\u2022";};_baec =_gefc ;_dbd =true ;};if _baec !=""{var _bge ,_debb float64 ;
if _bfbd .MarLAttr !=nil {_bge =_ce .FromEMU (int64 (*_bfbd .MarLAttr ));};if _bfbd .IndentAttr !=nil {_debb =_ce .FromEMU (int64 (*_bfbd .IndentAttr ));};_acdd =&prefixData {_bceg :_baec ,_cgec :_dbd ,_ggf :_bge ,_cceb :_debb };};};_bfbd =_fdg (_bfbd ,_cbfa );
_ggb :=_cdfe (_bcc .EndParaRPr ,_bfbd .DefRPr );_edbg .newParagraph ();_edbg .assignPropsToCurrentParagraph (_bfbd );_edbg .newLine ();_edbg .newWord ();for _gcdga ,_gegf :=range _bcc .EG_TextRun {_edbg .addTextRun (_gegf ,_ggb ,_fbbg ,_acdd );if _gcdga > 0{_acdd =nil ;
};};_edbg .addCurrentWordToParagraph ();};_edbg .addCurrentParagraph ();};_edbg .alignVertically (_dabc );_edbg .drawParagraphs ();return _b .MakeBlockFromCreator (_bfb );};func (_aeba *convertContext )makePdfBlockFromTable (_ebeab *_fa .Tbl ,_aee float64 )*_cd .Table {_ebd :=_ebeab .TblGrid ;
if _ebd ==nil {return nil ;};_bgb :=len (_ebd .GridCol );if _bgb ==0{return nil ;};_ggbe :=[]float64 {};_dfec :=0.0;for _ ,_fbcgc :=range _ebd .GridCol {_abec :=_ce .FromEMU (_b .FromSTCoordinate (_fbcgc .WAttr ));_ggbe =append (_ggbe ,_abec );_dfec +=_abec ;
};_agc :=[]float64 {};for _dcca :=0;_dcca < _bgb ;_dcca ++{_agc =append (_agc ,_ggbe [_dcca ]/_dfec );};_bafc :=_aeba ._dfeg .NewTable (_bgb );_bafc .SetColumnWidths (_agc ...);_dabd :=_ebeab .TblPr ;var _dbe *_fa .CT_TableStyle ;if _gca :=_dabd .Choice ;
_gca !=nil {if _gca .TableStyle !=nil {_dbe =_gca .TableStyle ;}else if _gca .TableStyleId !=nil {_dbe =_aeba ._ebdc .GetTableStyleById (*_gca .TableStyleId );};};_gcbe :=_fa .NewCT_TablePartStyle ();_gcbe .TcStyle =_fa .NewCT_TableStyleCellStyle ();_gcbe .TcTxStyle =_fa .NewCT_TableStyleTextStyle ();
if _dbe !=nil {if _dbe .WholeTbl !=nil {*_gcbe =*_dbe .WholeTbl ;};if _dbe .TblBg !=nil {if _gcbe .TcStyle .Fill ==nil {_gcbe .TcStyle .Fill =_dbe .TblBg .Fill ;};};};if _gcbe .TcStyle .Fill ==nil {_gcbe .TcStyle .Fill =_fa .NewCT_FillProperties ();_gcbe .TcStyle .Fill .NoFill =_dabd .NoFill ;
_gcbe .TcStyle .Fill .SolidFill =_dabd .SolidFill ;};_bbe :=len (_ebeab .Tr );for _fdfc ,_cge :=range _ebeab .Tr {_egee :=_fdfc ==0;_gdad :=_fdfc ==_bbe -1;_effc :=_fdfc %2==0;_afb :=len (_cge .Tc );var _cfec *_fa .CT_TablePartStyle ;if _dbe !=nil {if _egee {_cfec =_dbe .FirstRow ;
}else if _effc {_cfec =_dbe .Band2H ;}else {_cfec =_dbe .Band1H ;};};var _eabc float64 ;for _dfc ,_gbd :=range _cge .Tc {_eec :=_dfc ==0;_dgeg :=_dfc ==_afb -1;_fda :=_dfc %2==0;var _cdf *_fa .CT_TablePartStyle ;if _dbe !=nil {if _eec {_cdf =_dbe .FirstCol ;
}else if _fda {_cdf =_dbe .Band2V ;}else {_cdf =_dbe .Band1V ;};};_fcgc :=_aagb (_aagb (_cdf ,_cfec ),_gcbe );_bagb :=_aeba .addCellToTable (_bafc ,_gbd ,_fcgc ,_aee *_agc [_dfc ],_egee ,_gdad ,_eec ,_dgeg );if _bagb > _eabc {_eabc =_bagb ;};};_ecb :=_ce .FromEMU (_b .FromSTCoordinate (_cge .HAttr ));
if _ecb < _eabc {_ecb =_eabc ;};if _ecb < _dec (4){_ecb =_dec (4);};_bafc .SetRowHeight (_bafc .CurRow (),_ecb );};return _bafc ;};var _ebcd =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func (_adacg *textboxContext )alignParagraph (){_cfabc :=_adacg ._aeg ;
if _cfabc ._dcd ==_fa .ST_TextAlignTypeL {return ;};_agbfe :=len (_cfabc ._daae )-1;for _adgb ,_fbac :=range _cfabc ._daae {_cgbg :=true ;_bgcc :=len (_fbac ._dbaa );_age :=0.0;for _dfba :=len (_fbac ._dbaa )-1;_dfba >=0;_dfba --{_eeac :=_fbac ._dbaa [_dfba ];
if _cgbg &&_eeac ._bbcb {_bgcc =_dfba ;}else {_cgbg =false ;for _ ,_bcgf :=range _eeac ._fba {_age +=_bcgf ._caef ;};};};_fbac ._dbaa =_fbac ._dbaa [:_bgcc ];_bgbc :=_fbac ._baag -_fbac ._gfe -_age ;switch _cfabc ._dcd {case _fa .ST_TextAlignTypeR :_fbac .moveRight (_bgbc );
case _fa .ST_TextAlignTypeCtr :_fbac .moveRight (_bgbc /2);case _fa .ST_TextAlignTypeJust :if _adgb !=_agbfe {_aad :=[]*word {};for _ ,_cdea :=range _fbac ._dbaa {if _cdea ._bbcb {_aad =append (_aad ,_cdea );};};_ggda :=_bgbc /float64 (len (_aad ));for _ ,_fcf :=range _aad {_fcf ._cadd +=_ggda ;
};var _ccba *word ;for _ ,_ffbd :=range _fbac ._dbaa {if _ccba !=nil {_ffbd ._abb =_ccba ._abb +_ccba ._cadd ;};_ccba =_ffbd ;};};};};};func _cdfe (_edgd ,_cbce *_fa .CT_TextCharacterProperties )*_fa .CT_TextCharacterProperties {_ceff :=_fa .NewCT_TextCharacterProperties ();
if _edgd !=nil {*_ceff =*_edgd ;};if _cbce ==nil {return _ceff ;};if _ceff .KumimojiAttr ==nil {_ceff .KumimojiAttr =_cbce .KumimojiAttr ;};if _ceff .LangAttr ==nil {_ceff .LangAttr =_cbce .LangAttr ;};if _ceff .AltLangAttr ==nil {_ceff .AltLangAttr =_cbce .AltLangAttr ;
};if _ceff .SzAttr ==nil {_ceff .SzAttr =_cbce .SzAttr ;};if _ceff .BAttr ==nil {_ceff .BAttr =_cbce .BAttr ;};if _ceff .IAttr ==nil {_ceff .IAttr =_cbce .IAttr ;};if _ceff .UAttr ==_fa .ST_TextUnderlineTypeUnset {_ceff .UAttr =_cbce .UAttr ;};if _ceff .StrikeAttr ==_fa .ST_TextStrikeTypeUnset {_ceff .StrikeAttr =_cbce .StrikeAttr ;
};if _ceff .KernAttr ==nil {_ceff .KernAttr =_cbce .KernAttr ;};if _ceff .CapAttr ==_fa .ST_TextCapsTypeUnset {_ceff .CapAttr =_cbce .CapAttr ;};if _ceff .SpcAttr ==nil {_ceff .SpcAttr =_cbce .SpcAttr ;};if _ceff .NormalizeHAttr ==nil {_ceff .NormalizeHAttr =_cbce .NormalizeHAttr ;
};if _ceff .BaselineAttr ==nil {_ceff .BaselineAttr =_cbce .BaselineAttr ;};if _ceff .NoProofAttr ==nil {_ceff .NoProofAttr =_cbce .NoProofAttr ;};if _ceff .DirtyAttr ==nil {_ceff .DirtyAttr =_cbce .DirtyAttr ;};if _ceff .ErrAttr ==nil {_ceff .ErrAttr =_cbce .ErrAttr ;
};if _ceff .SmtCleanAttr ==nil {_ceff .SmtCleanAttr =_cbce .SmtCleanAttr ;};if _ceff .SmtIdAttr ==nil {_ceff .SmtIdAttr =_cbce .SmtIdAttr ;};if _ceff .BmkAttr ==nil {_ceff .BmkAttr =_cbce .BmkAttr ;};if _ceff .Ln ==nil {_ceff .Ln =_cbce .Ln ;};if _ceff .NoFill ==nil {_ceff .NoFill =_cbce .NoFill ;
};if _ceff .SolidFill ==nil {_ceff .SolidFill =_cbce .SolidFill ;};if _ceff .BlipFill ==nil {_ceff .BlipFill =_cbce .BlipFill ;};if _ceff .EffectLst ==nil {_ceff .EffectLst =_cbce .EffectLst ;};if _ceff .EffectDag ==nil {_ceff .EffectDag =_cbce .EffectDag ;
};if _ceff .Highlight ==nil {_ceff .Highlight =_cbce .Highlight ;};if _ceff .ULnTx ==nil {_ceff .ULnTx =_cbce .ULnTx ;};if _ceff .ULn ==nil {_ceff .ULn =_cbce .ULn ;};if _ceff .UFillTx ==nil {_ceff .UFillTx =_cbce .UFillTx ;};if _ceff .UFill ==nil {_ceff .UFill =_cbce .UFill ;
};if _ceff .Latin ==nil {_ceff .Latin =_cbce .Latin ;};if _ceff .Ea ==nil {_ceff .Ea =_cbce .Ea ;};if _ceff .Cs ==nil {_ceff .Cs =_cbce .Cs ;};if _ceff .Sym ==nil {_ceff .Sym =_cbce .Sym ;};if _ceff .Rtl ==nil {_ceff .Rtl =_cbce .Rtl ;};return _ceff ;};
type prefixData struct{_bceg string ;_cgec bool ;_ggf float64 ;_cceb float64 ;};func (_eafd *textboxContext )addPrefix (_ffaf *prefixData ,_gac *_cd .TextStyle ){_gfb :=_gcfc (_ffaf ._bceg );_fdbb :=*_gac ;if _ffaf ._cgec {_fdbb .Font =_b .AssignStdFontByName (_fdbb ,"\u0053\u0079\u006d\u0062\u006f\u006c");
};for _ ,_ebgdb :=range _gfb {_ebgdb ._geda =&_fdbb ;_eafd .addTextSymbol (_ebgdb );};_edbd :=-(_ffaf ._cceb +_eafd ._gefb ._cadd );if _edbd < 0{_edbd =0;};_dfggd :=&symbol {_cgb :"\u0020",_caef :_edbd };_eafd .addTextSymbol (_dfggd );_eafd ._gefb ._abb +=(_ffaf ._cceb +_ffaf ._ggf );
};