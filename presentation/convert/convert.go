//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_cc "bytes";_g "errors";_ac "github.com/unidoc/unioffice/common";_e "github.com/unidoc/unioffice/common/logger";_aa "github.com/unidoc/unioffice/common/tempstorage";_f "github.com/unidoc/unioffice/internal/convertutils";_gg "github.com/unidoc/unioffice/measurement";
_b "github.com/unidoc/unioffice/presentation";_fg "github.com/unidoc/unioffice/schema/soo/dml";_eag "github.com/unidoc/unioffice/schema/soo/dml/chart";_eg "github.com/unidoc/unioffice/schema/soo/pml";_gc "github.com/unidoc/unipdf/v3/contentstream/draw";
_ab "github.com/unidoc/unipdf/v3/core";_ge "github.com/unidoc/unipdf/v3/creator";_af "github.com/unidoc/unipdf/v3/model";_ea "github.com/unidoc/unipdf/v3/render";_ae "image";_c "image/color";_a "image/draw";_db "strconv";_dc "strings";);func (_fb *convertContext )makePdfBlockFromChart (_df *_eag .Chart ,_cf ,_gea float64 )(*_ge .Block ,error ){_dcg :=_df .CT_RelId .IdAttr ;
_gga :=_fb ._dcdc .GetChartSpaceByRelId (_dcg );if _gga ==nil {return nil ,_g .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _cfd *_fg .Theme ;_gcf :=_fb ._eaf .Themes ();if len (_gcf )> 0{_cfd =_gcf [0];};
return _f .MakeBlockFromChartSpace (_gga ,_cf ,_gea ,_cfd );};func (_deec *convertContext )makePdfDivisionFromTxBody (_ccce *_fg .CT_TextBody ,_abb *_fg .CT_TableStyleTextStyle )*_ge .Division {_cee :=_deec ._fffd .NewDivision ();_aaa :=_deec ._fddf ;_gbd :=_fg .ST_TextAnchoringTypeT ;
if _dgfb :=_ccce .BodyPr ;_dgfb !=nil {if _fad :=_dgfb .AnchorAttr ;_fad !=_fg .ST_TextAnchoringTypeUnset {_gbd =_dgfb .AnchorAttr ;};};if _gba :=_ccce .LstStyle ;_gba !=nil {var _ccd *_fg .CT_TextParagraphProperties ;if _gba .Lvl1pPr !=nil {_ccd =_gba .Lvl1pPr ;
}else {_ccd =_deec ._efc [0];};_aaa =_fbbc (_ccd ,_fbbc (_gba .DefPPr ,_aaa ));};for _ ,_gaf :=range _ccce .P {if _gaf !=nil {_cfa :=_deec ._fffd .NewStyledParagraph ();_gbdf :=_fbbc (_gaf .PPr ,_aaa );_cegg :=_geeb (_gaf .EndParaRPr ,_gbdf .DefRPr );if len (_gaf .EG_TextRun )==0{_cfa .Append ("\u000a");
_cee .Add (_cfa );continue ;};for _ ,_afcb :=range _gaf .EG_TextRun {if _dae :=_afcb .Br ;_dae !=nil {_cfa .Append ("\u000a");}else if _gccd :=_afcb .R ;_gccd !=nil {_cff :=_dcbae (_gccd .RPr ,_abb );_cff =_geeb (_cff ,_cegg );var _cge _ge .Color ;if _cff .SolidFill !=nil {_cge ,_ =_deec .getColorFromSolidFill (_cff .SolidFill );
}else {_cge =_ge .ColorBlack ;};_gcbb ,_dcad ,_fga ,_ :=_deec .makeStyleFromRPr (_cff );_gcbb .Color =_cge ;if _dcad {_gcbb .TextRise =0.5;}else if _fga {_gcbb .TextRise =-0.5;};_gegb :=_gccd .T ;if _cff .CapAttr ==_fg .ST_TextCapsTypeAll {for _ ,_afcf :=range _gegb {_afcf =[]rune (_dc .ToUpper (string (_afcf )))[0];
};};_eab :=_cfa .Append (_gegb );_eab .Style =*_gcbb ;};};_ =_gbd ;_cee .Add (_cfa );};};return _cee ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_f .FontStyle ;

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _f .RegisterFontsFromDirectory (dirName )};type symbol struct{_aecd string ;_fgbd float64 ;_fgf float64 ;_ffab float64 ;_fce float64 ;_beea float64 ;_eabf *_ge .TextStyle ;_dcag string ;_gdgd bool ;
_abed bool ;_dfgf bool ;};type prefixData struct{_gabe string ;_cgbg bool ;_ece float64 ;_gcfeg float64 ;};func _fbbc (_gefe ,_cagc *_fg .CT_TextParagraphProperties )*_fg .CT_TextParagraphProperties {_cddcg :=_fg .NewCT_TextParagraphProperties ();if _gefe !=nil {*_cddcg =*_gefe ;
};if _cagc ==nil {return _cddcg ;};if _cddcg .MarLAttr ==nil {_cddcg .MarLAttr =_cagc .MarLAttr ;};if _cddcg .MarRAttr ==nil {_cddcg .MarRAttr =_cagc .MarRAttr ;};if _cddcg .LvlAttr ==nil {_cddcg .LvlAttr =_cagc .LvlAttr ;};if _cddcg .IndentAttr ==nil {_cddcg .IndentAttr =_cagc .IndentAttr ;
};if _cddcg .AlgnAttr ==_fg .ST_TextAlignTypeUnset {_cddcg .AlgnAttr =_cagc .AlgnAttr ;};if _cddcg .DefTabSzAttr ==nil {_cddcg .DefTabSzAttr =_cagc .DefTabSzAttr ;};if _cddcg .RtlAttr ==nil {_cddcg .RtlAttr =_cagc .RtlAttr ;};if _cddcg .EaLnBrkAttr ==nil {_cddcg .EaLnBrkAttr =_cagc .EaLnBrkAttr ;
};if _cddcg .FontAlgnAttr ==_fg .ST_TextFontAlignTypeUnset {_cddcg .FontAlgnAttr =_cagc .FontAlgnAttr ;};if _cddcg .LatinLnBrkAttr ==nil {_cddcg .LatinLnBrkAttr =_cagc .LatinLnBrkAttr ;};if _cddcg .HangingPunctAttr ==nil {_cddcg .HangingPunctAttr =_cagc .HangingPunctAttr ;
};if _cddcg .LnSpc ==nil {_cddcg .LnSpc =_cagc .LnSpc ;};if _cddcg .SpcBef ==nil {_cddcg .SpcBef =_cagc .SpcBef ;};if _cddcg .SpcAft ==nil {_cddcg .SpcAft =_cagc .SpcAft ;};if _cddcg .BuClrTx ==nil {_cddcg .BuClrTx =_cagc .BuClrTx ;};if _cddcg .BuClr ==nil {_cddcg .BuClr =_cagc .BuClr ;
};if _cddcg .BuSzTx ==nil {_cddcg .BuSzTx =_cagc .BuSzTx ;};if _cddcg .BuSzPct ==nil {_cddcg .BuSzPct =_cagc .BuSzPct ;};if _cddcg .BuSzPts ==nil {_cddcg .BuSzPts =_cagc .BuSzPts ;};if _cddcg .BuFontTx ==nil {_cddcg .BuFontTx =_cagc .BuFontTx ;};if _cddcg .BuFont ==nil {_cddcg .BuFont =_cagc .BuFont ;
};if _cddcg .BuNone ==nil {_cddcg .BuNone =_cagc .BuNone ;};if _cddcg .BuAutoNum ==nil {_cddcg .BuAutoNum =_cagc .BuAutoNum ;};if _cddcg .BuChar ==nil {_cddcg .BuChar =_cagc .BuChar ;};if _cddcg .BuBlip ==nil {_cddcg .BuBlip =_cagc .BuBlip ;};if _cddcg .TabLst ==nil {_cddcg .TabLst =_cagc .TabLst ;
};if _cddcg .ExtLst ==nil {_cddcg .ExtLst =_cagc .ExtLst ;};_cddcg .DefRPr =_geeb (_cddcg .DefRPr ,_cagc .DefRPr );return _cddcg ;};func (_ffbf *textboxContext )addTextSymbol (_gabcg *symbol ){_cbggb :=_ge .New ();_bbee :=_cbggb .NewStyledParagraph ();
_bbee .SetMargins (0,0,0,0);_gada :=_bbee .Append (_gabcg ._aecd );_cdc :=0.0;if _gabcg ._eabf !=nil {_gada .Style =*_gabcg ._eabf ;if _gabcg ._eabf .CharSpacing !=0{_cdc =_gabcg ._eabf .CharSpacing ;};};_gabcg ._ffab =_bbee .Height ();_gabcg ._fgf =_bbee .Height ()*1.2;
if _gabcg ._fgf < _ffbf ._bfd ._dgcc {_gabcg ._fgf =_ffbf ._bfd ._dgcc ;};if _gabcg ._beea ==0{_gabcg ._beea =_bbee .Width ()+_cdc ;};if len (_ffbf ._cdbc ._egc )> 0{_dcba :=_ffbf ._cdbc ._egc [len (_ffbf ._cdbc ._egc )-1]._aecd ;if _ffbf ._bfd ._feg ||_f .IsNoSpaceLanguage (_dcba )||(_dcba =="\u0020")!=(_gabcg ._aecd =="\u0020"){_ffbf .addCurrentWordToParagraph ();
_ffbf .newWord ();};};_ffbf ._cdbc ._egc =append (_ffbf ._cdbc ._egc ,_gabcg );_gabcg ._fgbd =_ffbf ._cdbc ._dfd ;_ffbf ._cdbc ._dfd +=_gabcg ._beea ;if _gabcg ._aecd !="\u0020"{_ffbf ._cdbc ._cgdg =false ;};};func _fabg (_cffc *_fg .CT_TableCellProperties ,_aggfa *_fg .CT_TableStyleCellStyle ,_bcca ,_aabc ,_bage ,_feab bool )*_fg .CT_TableCellProperties {_gagd :=_fg .NewCT_TableCellProperties ();
if _cffc !=nil {*_gagd =*_cffc ;};if _aggfa ==nil {return _gagd ;};if _fbea :=_aggfa .FillRef ;_fbea !=nil {_egbf :=_fg .NewCT_SolidColorFillProperties ();_egbf .ScrgbClr =_fbea .ScrgbClr ;_egbf .SrgbClr =_fbea .SrgbClr ;_egbf .HslClr =_fbea .HslClr ;_egbf .SysClr =_fbea .SysClr ;
_egbf .SchemeClr =_fbea .SchemeClr ;_egbf .PrstClr =_fbea .PrstClr ;_gagd .SolidFill =_egbf ;};if _gagd .NoFill ==nil &&_gagd .SolidFill ==nil {if _daeed :=_aggfa .Fill ;_daeed !=nil {if _gagd .NoFill ==nil {_gagd .NoFill =_daeed .NoFill ;};if _gagd .SolidFill ==nil {_gagd .SolidFill =_daeed .SolidFill ;
};};};if _gbba :=_aggfa .TcBdr ;_gbba !=nil {if _gagd .LnL ==nil {var _fbbf *_fg .CT_ThemeableLineStyle ;if _bage {_fbbf =_gbba .Left ;}else {_fbbf =_gbba .InsideV ;};if _fbbf !=nil {_gagd .LnL =_fbbf .Ln ;};};if _gagd .LnR ==nil {var _begc *_fg .CT_ThemeableLineStyle ;
if _feab {_begc =_gbba .Right ;}else {_begc =_gbba .InsideV ;};if _begc !=nil {_gagd .LnR =_begc .Ln ;};};if _gagd .LnT ==nil {var _gafc *_fg .CT_ThemeableLineStyle ;if _bcca {_gafc =_gbba .Top ;}else {_gafc =_gbba .InsideH ;};if _gafc !=nil {_gagd .LnT =_gafc .Ln ;
};};if _gagd .LnB ==nil {var _dfcd *_fg .CT_ThemeableLineStyle ;if _aabc {_dfcd =_gbba .Bottom ;}else {_dfcd =_gbba .InsideH ;};if _dfcd !=nil {_gagd .LnB =_dfcd .Ln ;};};};return _gagd ;};func _ebab (_eabff ,_acbg *_fg .CT_TablePartStyle )*_fg .CT_TablePartStyle {_ebed :=_fg .NewCT_TablePartStyle ();
if _eabff !=nil {*_ebed =*_eabff ;};if _acbg ==nil {return _ebed ;};if _ebed .TcTxStyle ==nil {_ebed .TcTxStyle =_acbg .TcTxStyle ;}else {_ebed .TcTxStyle =_fcde (_ebed .TcTxStyle ,_acbg .TcTxStyle );};if _ebed .TcStyle ==nil {_ebed .TcStyle =_acbg .TcStyle ;
}else {_ebed .TcStyle =_dgbe (_ebed .TcStyle ,_acbg .TcStyle );};return _ebed ;};func (_dbfga *convertContext )getShapeFromBlipFill (_bbaf *_fg .CT_BlipFillProperties ,_affec ,_dcfa ,_dfagd ,_dfbad float64 ,_faba bool )_ge .Drawable {_fbec ,_fceg ,_bgbc :=_dbfga .makePdfImageFromBlipFill (_bbaf ,_faba );
if _bgbc !=nil {_e .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_bgbc );
return nil ;};if _fbec ==nil {return nil ;};if _cabac :=_bbaf .Tile ;_cabac !=nil {_fbec =_dbfga .tileImage (_fbec ,_bbaf .Tile ,_dfagd ,_dfbad );};if _begd :=_bbaf .Stretch ;_begd !=nil {_fbec ,_affec ,_dcfa =_dbfga .stretchImage (_fbec ,_bbaf .Stretch ,_affec ,_dcfa ,_dfagd ,_dfbad );
};if len (_fceg )==0{_fbec .SetPos (_affec ,_dcfa );return _fbec ;};_fbec =_dbfga .applyBlipEffectsOnImg (_fbec ,_affec ,_dcfa ,_fceg );_fbec .SetPos (_affec ,_dcfa );return _fbec ;};var _ddfg =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
func (_fegc *textboxContext )alignVertically (_agda _fg .ST_TextAnchoringType ){_fegc .alignParagraphsVertically (_agda );_fegc .alignSymbolsVertically ();};func (_cb *convertContext )tileImage (_gca *_ge .Image ,_gfa *_fg .CT_TileInfoProperties ,_aea ,_bgf float64 )*_ge .Image {_ded ,_cddc :=1.0,1.0;
if _aga :=_gfa .SxAttr ;_aga !=nil {_ded =_f .FromSTPercentage (_aga );};if _dgf :=_gfa .SyAttr ;_dgf !=nil {_cddc =_f .FromSTPercentage (_dgf );};_ceg :=_f .MakeTempCreator (_aea ,_bgf );_gca .Scale (_ded ,_cddc );_cbc ,_dee :=_gca .Width (),_gca .Height ();
var _dag ,_gfaf float64 ;if _bea :=_gfa .TxAttr ;_bea !=nil {_dag =_gg .FromEMU (_f .FromSTCoordinate (*_bea ));};if _agd :=_gfa .TyAttr ;_agd !=nil {_gfaf =_gg .FromEMU (_f .FromSTCoordinate (*_agd ));};if _dag > 0{_dag -=_cbc ;};if _gfaf > 0{_gfaf -=_dee ;
};_dagg :=_cb ._dfb /_cbc +1;_gfaa :=_cb ._ade /_dee +1;for _cbb :=0.0;_cbb <=_dagg ;_cbb ++{_fffc :=_cbb *_cbc ;for _cgfa :=0.0;_cgfa <=_gfaa ;_cgfa ++{_gcd :=_cgfa *_dee ;_gca .SetPos (_fffc +_dag ,_gcd +_gfaf );_ceg .Draw (_gca );};};_aef ,_fef :=_f .GetPageFromCreator (_ceg );
if _fef !=nil {_e .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_fef );return nil ;};_cgg ,_fef :=_ea .NewImageDevice ().Render (_aef );
if _fef !=nil {_e .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_fef );return nil ;};_gdc ,_fef :=_cb ._fffd .NewImageFromGoImage (_cgg );if _fef !=nil {_e .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_fef );
return nil ;};return _gdc ;};func (_cfdd *textboxContext )newParagraph (){_eebd :=&paragraph {};_eebd ._ebc =_cfdd ._adga ;_cfdd ._bfd =_eebd ;};func (_ccea *convertContext )renderCurrentStateToGoImage ()(_ae .Image ,error ){_cacb :=_f .MakeTempCreator (_ccea ._dfb ,_ccea ._ade );
_cacb .NewPage ();for _ ,_fdcg :=range _ccea ._gbbf {if _fdcg !=nil {_cacb .MoveTo (0,0);_cacb .Draw (_fdcg );};};_fbga ,_fead :=_f .GetPageFromCreator (_cacb );if _fead !=nil {return nil ,_fead ;};return _ea .NewImageDevice ().Render (_fbga );};func (_fec *convertContext )drawSlide (){_fec ._fffd .NewPage ();
for _ ,_bcd :=range _fec ._gbbf {if _bcd !=nil {_fec ._fffd .MoveTo (0,0);_fec ._fffd .Draw (_bcd );};};};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_b .Presentation )*_ge .Creator {_ec :=pr .X ().SldSz ;_ce :=_gg .FromEMU (int64 (_ec .CxAttr ));_bc :=_gg .FromEMU (int64 (_ec .CyAttr ));_fa :=_ge .PageSize {_ce ,_bc };_be :=_ge .New ();_be .SetPageSize (_fa );var _bac *_fg .Theme ;
if len (pr .Themes ())> 0{_bac =pr .Themes ()[0];};for _ ,_ed :=range pr .Slides (){if _ed .X ()==nil {continue ;};_fc :=&convertContext {_fffd :_be ,_dcdc :&_ed ,_bgcb :_ed .GetSlideLayout (),_dead :pr .SlideMasters ()[0].X (),_eaf :pr ,_bcg :_bac ,_fbce :_ed .X ().ClrMapOvr ,_ade :_fa [1],_dfb :_fa [0]};
_fc .extractDefaultProperties ();_fc .makeSlide ();_fc .drawSlide ();};return _be ;};func (_bbe *convertContext )stretchImage (_ced *_ge .Image ,_bba *_fg .CT_StretchInfoProperties ,_abf ,_cced ,_aba ,_ead float64 )(*_ge .Image ,float64 ,float64 ){_gfad :=_bba .FillRect ;
if _gfad ==nil {_dbga :=_ced .Width ()/_ced .Height ();_bgc :=_aba /_ead ;var _eec ,_cfg float64 ;if _dbga > _bgc {_cfg =_ead ;_eec =_ead *_dbga ;}else {_eec =_aba ;_cfg =_aba /_dbga ;};_ced .Scale (_eec /_ced .Width (),_cfg /_ced .Height ());return _ced ,_abf ,_cced ;
};var _afab ,_agf ,_ecb ,_eca float64 ;if _bgd :=_gfad .LAttr ;_bgd !=nil {_ecb =_f .FromSTPercentage (_bgd );};if _daf :=_gfad .TAttr ;_daf !=nil {_afab =_f .FromSTPercentage (_daf );};if _gfaag :=_gfad .RAttr ;_gfaag !=nil {_eca =_f .FromSTPercentage (_gfaag );
};if _fgg :=_gfad .BAttr ;_fgg !=nil {_agf =_f .FromSTPercentage (_fgg );};_afg :=_aba *(1-_ecb -_eca );_faea :=_ead *(1-_afab -_agf );_ced .Scale (_afg /_ced .Width (),_faea /_ced .Height ());return _ced ,_abf +_ecb *_aba ,_cced +_afab *_ead ;};func _degc (_cfbd *_eg .CT_Shape )(_eg .ST_PlaceholderType ,*uint32 ){if _aaff :=_cfbd .NvSpPr ;
_aaff !=nil {if _baae :=_aaff .NvPr ;_baae !=nil {if _begbf :=_baae .Ph ;_begbf !=nil {return _begbf .TypeAttr ,_begbf .IdxAttr ;};};};return _eg .ST_PlaceholderTypeUnset ,nil ;};func (_acc *convertContext )getGroupConnectors (_faa *_eg .CT_Connector ,_gcc float64 ,_dce float64 )[]_ge .Drawable {_ggd ,_ ,_ ,_ ,_ ,_ ,_ :=_acc .getShapesFromSpPr (_faa .SpPr ,_faa .Style ,false ,_gcc ,_dce );
return _ggd ;};func _dcbae (_daee *_fg .CT_TextCharacterProperties ,_adec *_fg .CT_TableStyleTextStyle )*_fg .CT_TextCharacterProperties {_bagdd :=_fg .NewCT_TextCharacterProperties ();if _daee !=nil {*_bagdd =*_daee ;};if _adec ==nil {return _bagdd ;};
if _bagdd .BAttr ==nil &&_adec .BAttr !=_fg .ST_OnOffStyleTypeUnset {_ecbf :=_adec .BAttr ==_fg .ST_OnOffStyleTypeOn ;_bagdd .BAttr =&_ecbf ;};if _bagdd .IAttr ==nil &&_adec .IAttr !=_fg .ST_OnOffStyleTypeUnset {_cdce :=_adec .IAttr ==_fg .ST_OnOffStyleTypeOn ;
_bagdd .IAttr =&_cdce ;};if _bagdd .NoFill ==nil &&_bagdd .SolidFill ==nil {_bagdd .SolidFill =_fg .NewCT_SolidColorFillProperties ();_bagdd .SolidFill .ScrgbClr =_adec .ScrgbClr ;_bagdd .SolidFill .SrgbClr =_adec .SrgbClr ;_bagdd .SolidFill .HslClr =_adec .HslClr ;
_bagdd .SolidFill .SysClr =_adec .SysClr ;_bagdd .SolidFill .SchemeClr =_adec .SchemeClr ;_bagdd .SolidFill .PrstClr =_adec .PrstClr ;};if _aaab :=_adec .Font ;_aaab !=nil &&_bagdd .Latin ==nil &&_bagdd .Ea ==nil &&_bagdd .Cs ==nil {_bagdd .Latin =_aaab .Latin ;
_bagdd .Ea =_aaab .Ea ;_bagdd .Cs =_aaab .Cs ;};return _bagdd ;};type convertContext struct{_fffd *_ge .Creator ;_faeaa *_f .Rectangle ;_eaf *_b .Presentation ;_dcdc *_b .Slide ;_dead *_eg .SldMaster ;_bgcb *_eg .SldLayout ;_ade float64 ;_dfb float64 ;
_gbbf []_ge .Drawable ;_dede *background ;_fddf *_fg .CT_TextParagraphProperties ;_cbgf *_fg .CT_TextCharacterProperties ;_aged *_fg .CT_TextParagraphProperties ;_deecd *_fg .CT_TextCharacterProperties ;_dbf *_fg .CT_TextParagraphProperties ;_gdb *_fg .CT_TextCharacterProperties ;
_efc []*_fg .CT_TextParagraphProperties ;_ccca []*_fg .CT_TextParagraphProperties ;_daa []*_fg .CT_TextParagraphProperties ;_bcg *_fg .Theme ;_fbce *_fg .CT_ColorMappingOverride ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;
FontStyle_BoldItalic FontStyle =3;);func (_ecaf *textboxContext )alignSymbolsVertically (){for _ ,_gge :=range _ecaf ._bbbb {for _ ,_bgea :=range _gge ._eeb {_eabb :=0.0;for _ ,_eef :=range _bgea ._bbgd {for _ ,_eagb :=range _eef ._egc {if _eagb ._fgf > _eabb {_eabb =_eagb ._fgf ;
};};};for _ ,_dedb :=range _bgea ._bbgd {for _ ,_caad :=range _dedb ._egc {if _caad ._ffab < _eabb {_caad ._fce =_eabb -_caad ._ffab ;};};};};};};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_af .PdfFont ){_f .RegisterFont (name ,style ,font );};func (_gcda *convertContext )getColorFromMatrixReference (_aaae *_fg .CT_StyleMatrixReference )_ge .Color {if _aaae ==nil {return nil ;};var _cggf _ge .Color ;
var _eedf string ;if _dcdb :=_aaae .SrgbClr ;_dcdb !=nil {_eedf =_dcdb .ValAttr ;}else if _fdbb :=_aaae .SchemeClr ;_fdbb !=nil {_eedf =_f .GetColorStringFromDmlColor (_gcda ._eaf .GetColorBySchemeColor (_fdbb .ValAttr ));_eedf =_f .AdjustColor (_eedf ,_fdbb .EG_ColorTransform );
};if _eedf !=""{_cggf =_ge .ColorRGBFromHex ("\u0023"+_eedf );};return _cggf ;};func (_fdbgd *convertContext )getShapesFromSpPr (_cag *_fg .CT_ShapeProperties ,_gag *_fg .CT_ShapeStyle ,_ccc bool ,_dcdgd float64 ,_gagf float64 )([]_ge .Drawable ,float64 ,float64 ,float64 ,float64 ,_ge .Color ,bool ){_dfg :=[]_ge .Drawable {};
var _ddb ,_fcg ,_bda ,_dde ,_abff float64 ;var _baa ,_cad ,_ggc ,_edf _ge .Color ;var _becb *_fg .CT_BlipFillProperties ;_dbb ,_fgd :=1.0,1.0;if _gag !=nil {_baa ,_cad ,_edf =_fdbgd .getStyleColors (_gag );};if _dbe :=_cag .Ln ;_dbe !=nil {if _dbe .NoFill !=nil {_ggc ,_abff =nil ,0;
}else {_ggc ,_abff ,_dbb =_fdbgd .getInfoFromLn (_dbe );if _ggc ==nil {_ggc =_edf ;};};};if _cag .NoFill !=nil {_cad ,_fgd =nil ,0;}else if _ccc {_cad =_fdbgd ._dede ._edeg ;_fgd =_fdbgd ._dede ._cedb ;_becb =_fdbgd ._dede ._fcdg ;}else if _eaed :=_cag .SolidFill ;
_eaed !=nil {_cad ,_fgd =_fdbgd .getColorFromSolidFill (_eaed );};var _ged bool ;if _cec :=_cag .Xfrm ;_cec !=nil {_ddb ,_fcg ,_bda ,_dde =_f .GetDataFromXfrm (_cec );_ddb +=_dcdgd ;_fcg +=_gagf ;_ged =true ;};if _cddd :=_cag .CustGeom ;_cddd !=nil {_fge :=[]_gc .Point {};
_dgfe ,_age :=1.0,1.0;if _fcd :=_cddd .PathLst ;_fcd !=nil {for _ ,_gfd :=range _fcd .Path {if _gfd !=nil {if _ffe :=_gfd .WAttr ;_ffe !=nil {_dgfe =_bda /_gg .FromEMU (*_ffe );};if _dace :=_gfd .HAttr ;_dace !=nil {_age =_dde /_gg .FromEMU (*_dace );};
for _ ,_ef :=range _gfd .Close {if _ef !=nil {};};for _ ,_cdg :=range _gfd .MoveTo {if _cdg !=nil &&_cdg .Pt !=nil {_agc ,_aed :=_fbef (_cdg .Pt );_fge =append (_fge ,_gc .Point {X :_agc *_dgfe +_ddb ,Y :_aed *_age +_fcg });};};for _ ,_bdd :=range _gfd .LnTo {if _bdd !=nil &&_bdd .Pt !=nil {_aca ,_fdbc :=_fbef (_bdd .Pt );
_fge =append (_fge ,_gc .Point {X :_aca *_dgfe +_ddb ,Y :_fdbc *_age +_fcg });};};_bdaf :=_fdbgd ._fffd .NewPolygon ([][]_gc .Point {_fge });_bdaf .SetFillColor (_cad );_bdaf .SetFillOpacity (_fgd );_bdaf .SetBorderWidth (_abff );if _ggc !=nil {_bdaf .SetBorderColor (_ggc );
_bdaf .SetBorderOpacity (_dbb );};_dfg =append (_dfg ,_bdaf );};};};};if _bgb :=_cag .PrstGeom ;_bgb !=nil {switch _bgb .PrstAttr {case _fg .ST_ShapeTypeRect :if _becb !=nil {_bfab :=_fdbgd .getShapeFromBlipFill (_becb ,_ddb ,_fcg ,_bda ,_dde ,false );
_dfg =append (_dfg ,_bfab );}else {_dgc :=_fdbgd ._fffd .NewRectangle (_ddb ,_fcg ,_bda ,_dde );_edeb :=_cad !=nil &&_fgd > 0;if _edeb {_dgc .SetFillColor (_cad );_dgc .SetFillOpacity (_fgd );};_gee :=_ggc !=nil &&_dbb > 0&&_abff > 0;if _gee {_dgc .SetBorderWidth (_abff );
_dgc .SetBorderColor (_ggc );_dgc .SetBorderOpacity (_dbb );};if _edeb ||_gee {_dfg =append (_dfg ,_dgc );};};case _fg .ST_ShapeTypeLine :_gbe :=_fdbgd ._fffd .NewLine (_ddb ,_fcg ,_ddb +_bda ,_fcg +_dde );_gbe .SetLineWidth (_abff );if _ggc !=nil {_gbe .SetColor (_ggc );
};_dfg =append (_dfg ,_gbe );};};return _dfg ,_ddb ,_fcg ,_bda ,_dde ,_baa ,_ged ;};func (_efea *convertContext )getBorderStyle (_caa *_fg .CT_LineProperties )(_ge .CellBorderStyle ,*_ge .Color ,float64 ){if _caa ==nil ||_caa .NoFill !=nil {return _ge .CellBorderStyleNone ,nil ,0;
};var _cde _ge .Color ;if _caea :=_caa .SolidFill ;_caea !=nil {_cde ,_ =_efea .getColorFromSolidFill (_caea );};_bcc :=0.0;if _afga :=_caa .WAttr ;_afga !=nil {_bcc =_gg .FromEMU (int64 (*_afga ));};return _ge .CellBorderStyleSingle ,&_cde ,_bcc ;};func _ggaf (_bcfg *_eg .CT_CommonSlideData ,_bgdff _eg .ST_PlaceholderType ,_acce *uint32 ,_dcde bool )(*_fg .CT_Transform2D ,*_fg .CT_TextBody ,*bool ,*bool ){if _bcfg !=nil &&(_bgdff !=_eg .ST_PlaceholderTypeUnset ||!_dcde ){if _cgec :=_bcfg .SpTree ;
_cgec !=nil {for _ ,_fdea :=range _cgec .Choice {if _fdea !=nil {for _ ,_agea :=range _fdea .Sp {if _agea !=nil {_eadag ,_cbce :=_degc (_agea );if _bgdff ==_eadag {if (_dcde &&_cbce ==nil )||(!_dcde &&_cbce !=nil &&*_cbce ==*_acce ){var _cfab *_fg .CT_Transform2D ;
if _agea .SpPr !=nil {_cfab =_agea .SpPr .Xfrm ;};_cccb :=_bgdff ==_eg .ST_PlaceholderTypeTitle ||_bgdff ==_eg .ST_PlaceholderTypeCtrTitle ;_ceb :=!_cccb &&_bgdff !=_eg .ST_PlaceholderTypeUnset ;return _cfab ,_agea .TxBody ,&_cccb ,&_ceb ;};};};};};};};
};return nil ,nil ,nil ,nil ;};func (_faf *convertContext )makePdfBlockFromTxBody (_bbcc *_fg .CT_TextBody ,_gfae *_fg .CT_TextBodyProperties ,_dda *_fg .CT_TextListStyle ,_bdaa ,_agcb float64 ,_dgec _ge .Color ,_ggf ,_ggcf bool )(*_ge .Block ,error ){var _ebdc *_fg .CT_TextParagraphProperties ;
if _gfe :=_bbcc .LstStyle ;_gfe !=nil {var _cbg *_fg .CT_TextParagraphProperties ;if _gfe .Lvl1pPr !=nil {_cbg =_gfe .Lvl1pPr ;};_ebdc =_fbbc (_cbg ,_gfe .DefPPr );};var _fca *_fg .CT_TextParagraphProperties ;if _ebdc !=nil {if _ggf {_fca =_faf ._ccca [0];
}else if _ggcf {_fca =_faf ._daa [0];}else {_fca =_faf ._efc [0];};if _dda !=nil {_fca =_fbbc (_fbbc (_dda .Lvl1pPr ,_dda .DefPPr ),_fca );};_fca =_fbbc (_ebdc ,_fca );}else {if _ggf {_fca =_faf ._aged ;}else if _ggcf {_fca =_faf ._dbf ;}else {_fca =_faf ._fddf ;
};};_egg ,_bbf :=_gcae (2.5),_gcae (2.5);_cdb ,_cege :=_gcae (1.3),_gcae (1.3);_dgecd :=true ;_ggag :=_fg .ST_TextAnchoringTypeT ;if _gfae !=nil {if _fgag :=_gfae .AnchorAttr ;_fgag !=_fg .ST_TextAnchoringTypeUnset {_ggag =_fgag ;};};if _fab :=_bbcc .BodyPr ;
_fab !=nil {if _bgbb :=_fab .LInsAttr ;_bgbb !=nil {_egg =_gg .FromEMU (_f .FromSTCoordinate32 (*_bgbb ));};if _bbgc :=_fab .TInsAttr ;_bbgc !=nil {_cdb =_gg .FromEMU (_f .FromSTCoordinate32 (*_bbgc ));};if _dfc :=_fab .RInsAttr ;_dfc !=nil {_bbf =_gg .FromEMU (_f .FromSTCoordinate32 (*_dfc ));
};if _eada :=_fab .BInsAttr ;_eada !=nil {_cege =_gg .FromEMU (_f .FromSTCoordinate32 (*_eada ));};_dgecd =_fab .WrapAttr !=_fg .ST_TextWrappingTypeNone ;if _dec :=_fab .AnchorAttr ;_dec !=_fg .ST_TextAnchoringTypeUnset {_ggag =_fab .AnchorAttr ;};};_fcc :=_f .MakeTempCreator (_bdaa ,_agcb );
_fcc .SetPageMargins (_egg ,_bbf ,_cdb ,_cege );_fabf :=&textboxContext {_fadc :_faf ,_bfb :_dgecd ,_dfba :_bdaa -_egg -_bbf ,_cace :_agcb -_cdb -_cege ,_bgab :_fcc ,_bbbb :[]*paragraph {}};_gbg :=1;for _ ,_gadc :=range _bbcc .P {if _gadc !=nil {_bdad :=_gadc .PPr ;
var _gfeg *prefixData ;if _bdad !=nil &&_bdad .BuNone ==nil {var _adg string ;var _bgeg bool ;if _agdg :=_bdad .BuAutoNum ;_agdg !=nil {var _agab string ;if _deed :=_agdg .StartAtAttr ;_deed !=nil {_gbg =int (*_deed );};var _beg string ;switch _agdg .TypeAttr {case _fg .ST_TextAutonumberSchemeAlphaUcParenBoth ,_fg .ST_TextAutonumberSchemeAlphaUcParenR ,_fg .ST_TextAutonumberSchemeAlphaUcPeriod :_beg =_dffc (_gbg ,true );
case _fg .ST_TextAutonumberSchemeAlphaLcParenBoth ,_fg .ST_TextAutonumberSchemeAlphaLcParenR ,_fg .ST_TextAutonumberSchemeAlphaLcPeriod :_beg =_dffc (_gbg ,false );case _fg .ST_TextAutonumberSchemeRomanUcParenBoth ,_fg .ST_TextAutonumberSchemeRomanUcParenR ,_fg .ST_TextAutonumberSchemeRomanUcPeriod :_beg =_dfbb (_gbg ,true );
case _fg .ST_TextAutonumberSchemeRomanLcParenBoth ,_fg .ST_TextAutonumberSchemeRomanLcParenR ,_fg .ST_TextAutonumberSchemeRomanLcPeriod :_beg =_dfbb (_gbg ,false );default:_beg =_db .Itoa (_gbg );};switch _agdg .TypeAttr {case _fg .ST_TextAutonumberSchemeAlphaLcPeriod ,_fg .ST_TextAutonumberSchemeAlphaUcPeriod ,_fg .ST_TextAutonumberSchemeArabicPeriod ,_fg .ST_TextAutonumberSchemeRomanLcPeriod ,_fg .ST_TextAutonumberSchemeRomanUcPeriod ,_fg .ST_TextAutonumberSchemeArabicDbPeriod ,_fg .ST_TextAutonumberSchemeEa1ChsPeriod ,_fg .ST_TextAutonumberSchemeEa1ChtPeriod ,_fg .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_fg .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_fg .ST_TextAutonumberSchemeThaiAlphaPeriod ,_fg .ST_TextAutonumberSchemeThaiNumPeriod ,_fg .ST_TextAutonumberSchemeHindiAlphaPeriod ,_fg .ST_TextAutonumberSchemeHindiNumPeriod ,_fg .ST_TextAutonumberSchemeHindiAlpha1Period :_agab ="\u002e";
case _fg .ST_TextAutonumberSchemeAlphaLcParenR ,_fg .ST_TextAutonumberSchemeAlphaUcParenR ,_fg .ST_TextAutonumberSchemeArabicParenR ,_fg .ST_TextAutonumberSchemeRomanLcParenR ,_fg .ST_TextAutonumberSchemeRomanUcParenR ,_fg .ST_TextAutonumberSchemeThaiAlphaParenR ,_fg .ST_TextAutonumberSchemeThaiNumParenR ,_fg .ST_TextAutonumberSchemeHindiNumParenR :_agab ="\u0029";
};_adg =_beg +_agab ;_gbg ++;}else if _eagg :=_bdad .BuChar ;_eagg !=nil {_bfc :=_eagg .CharAttr ;if _gfg ,_bgdb :=_afca [_bfc ];_bgdb {_bfc =string (rune (_gfg ));}else {_bfc ="\u2022";};_adg =_bfc ;_bgeg =true ;};if _adg !=""{var _cegc ,_cba float64 ;
if _bdad .MarLAttr !=nil {_cegc =_gg .FromEMU (int64 (*_bdad .MarLAttr ));};if _bdad .IndentAttr !=nil {_cba =_gg .FromEMU (int64 (*_bdad .IndentAttr ));};_gfeg =&prefixData {_gabe :_adg ,_cgbg :_bgeg ,_ece :_cegc ,_gcfeg :_cba };};};_bdad =_fbbc (_bdad ,_fca );
_dfgd :=_geeb (_gadc .EndParaRPr ,_bdad .DefRPr );_fabf .newParagraph ();_fabf .assignPropsToCurrentParagraph (_bdad );_fabf .newLine ();_fabf .newWord ();for _cfdg ,_adc :=range _gadc .EG_TextRun {_fabf .addTextRun (_adc ,_dfgd ,_dgec ,_gfeg );if _cfdg > 0{_gfeg =nil ;
};};_fabf .addCurrentWordToParagraph ();};_fabf .addCurrentParagraph ();};_fabf .alignVertically (_ggag );_fabf .drawParagraphs ();return _f .MakeBlockFromCreator (_fcc );};func (_deg *textboxContext )adjustHeights (_dbba float64 ){if _deg ._cef ._acb < _dbba {_deg ._bfd ._edgf +=(_dbba -_deg ._cef ._acb );
_deg ._cef ._acb =_dbba ;};};func _fcde (_fcad ,_daec *_fg .CT_TableStyleTextStyle )*_fg .CT_TableStyleTextStyle {_bbeb :=_fg .NewCT_TableStyleTextStyle ();if _fcad !=nil {*_bbeb =*_fcad ;};if _daec ==nil {return _bbeb ;};if _bbeb .BAttr ==_fg .ST_OnOffStyleTypeUnset {_bbeb .BAttr =_daec .BAttr ;
};if _bbeb .IAttr ==_fg .ST_OnOffStyleTypeUnset {_bbeb .IAttr =_daec .IAttr ;};if _bbeb .Font ==nil {_bbeb .Font =_daec .Font ;};if _bbeb .FontRef ==nil {_bbeb .FontRef =_daec .FontRef ;};if _bbeb .ScrgbClr ==nil {_bbeb .ScrgbClr =_daec .ScrgbClr ;};if _bbeb .SrgbClr ==nil {_bbeb .SrgbClr =_daec .SrgbClr ;
};if _bbeb .HslClr ==nil {_bbeb .HslClr =_daec .HslClr ;};if _bbeb .SysClr ==nil {_bbeb .SysClr =_daec .SysClr ;};if _bbeb .SchemeClr ==nil {_bbeb .SchemeClr =_daec .SchemeClr ;};if _bbeb .PrstClr ==nil {_bbeb .PrstClr =_daec .PrstClr ;};return _bbeb ;
};func (_cdgb *convertContext )getInfoFromLn (_fbg *_fg .CT_LineProperties )(_ge .Color ,float64 ,float64 ){if _fbg ==nil ||_fbg .NoFill !=nil {return nil ,0,0;};var _bddg float64 ;_cfed ,_cgdgc :=_cdgb .getColorFromSolidFill (_fbg .SolidFill );if _fgbb :=_fbg .WAttr ;
_fgbb !=nil {_bddg =_gg .FromEMU (int64 (*_fgbb ));}else {_bddg =1;};return _cfed ,_bddg ,_cgdgc ;};func _cgdc (_dfdd ,_eac *_fg .CT_TextBodyProperties )*_fg .CT_TextBodyProperties {_eefd :=_fg .NewCT_TextBodyProperties ();if _dfdd !=nil {*_eefd =*_dfdd ;
};if _eac ==nil {return _eefd ;};if _eefd .RotAttr ==nil {_eefd .RotAttr =_eac .RotAttr ;};if _eefd .SpcFirstLastParaAttr ==nil {_eefd .SpcFirstLastParaAttr =_eac .SpcFirstLastParaAttr ;};if _eefd .VertOverflowAttr ==_fg .ST_TextVertOverflowTypeUnset {_eefd .VertOverflowAttr =_eac .VertOverflowAttr ;
};if _eefd .HorzOverflowAttr ==_fg .ST_TextHorzOverflowTypeUnset {_eefd .HorzOverflowAttr =_eac .HorzOverflowAttr ;};if _eefd .VertAttr ==_fg .ST_TextVerticalTypeUnset {_eefd .VertAttr =_eac .VertAttr ;};if _eefd .WrapAttr ==_fg .ST_TextWrappingTypeUnset {_eefd .WrapAttr =_eac .WrapAttr ;
};if _eefd .LInsAttr ==nil {_eefd .LInsAttr =_eac .LInsAttr ;};if _eefd .TInsAttr ==nil {_eefd .TInsAttr =_eac .TInsAttr ;};if _eefd .RInsAttr ==nil {_eefd .RInsAttr =_eac .RInsAttr ;};if _eefd .BInsAttr ==nil {_eefd .BInsAttr =_eac .BInsAttr ;};if _eefd .NumColAttr ==nil {_eefd .NumColAttr =_eac .NumColAttr ;
};if _eefd .SpcColAttr ==nil {_eefd .SpcColAttr =_eac .SpcColAttr ;};if _eefd .RtlColAttr ==nil {_eefd .RtlColAttr =_eac .RtlColAttr ;};if _eefd .AnchorAttr ==_fg .ST_TextAnchoringTypeUnset {_eefd .AnchorAttr =_eac .AnchorAttr ;};if _eefd .AnchorCtrAttr ==nil {_eefd .AnchorCtrAttr =_eac .AnchorCtrAttr ;
};if _eefd .ForceAAAttr ==nil {_eefd .ForceAAAttr =_eac .ForceAAAttr ;};if _eefd .UprightAttr ==nil {_eefd .UprightAttr =_eac .UprightAttr ;};if _eefd .CompatLnSpcAttr ==nil {_eefd .CompatLnSpcAttr =_eac .CompatLnSpcAttr ;};if _eefd .PrstTxWarp ==nil {_eefd .PrstTxWarp =_eac .PrstTxWarp ;
};if _eefd .NoAutofit ==nil {_eefd .NoAutofit =_eac .NoAutofit ;};if _eefd .NormAutofit ==nil {_eefd .NormAutofit =_eac .NormAutofit ;};if _eefd .SpAutoFit ==nil {_eefd .SpAutoFit =_eac .SpAutoFit ;};if _eefd .Scene3d ==nil {_eefd .Scene3d =_eac .Scene3d ;
};if _eefd .Sp3d ==nil {_eefd .Sp3d =_eac .Sp3d ;};if _eefd .FlatTx ==nil {_eefd .FlatTx =_eac .FlatTx ;};if _eefd .ExtLst ==nil {_eefd .ExtLst =_eac .ExtLst ;};return _eefd ;};type paragraph struct{_dcadf float64 ;_bgef float64 ;_fdba float64 ;_ffa float64 ;
_gbad float64 ;_gdbg float64 ;_ebc float64 ;_edgf float64 ;_dbeg _fg .ST_TextAlignType ;_dgcc float64 ;_feg bool ;_eeb []*line ;};func (_dcb *convertContext )addCellToTable (_bdff *_ge .Table ,_bad *_fg .CT_TableCell ,_beb *_fg .CT_TablePartStyle ,_dgg float64 ,_bdcd ,_gfc ,_bacag ,_fggcg bool )float64 {var _gccb *_ge .TableCell ;
_ecbe :=1;if _bad .GridSpanAttr !=nil {_ecbe =int (*_bad .GridSpanAttr );};_gccb =_bdff .MultiColCell (_ecbe );_dggc :=_bad .TcPr ;var _bdab *_fg .CT_TableStyleTextStyle ;if _beb !=nil {_dggc =_fabg (_dggc ,_beb .TcStyle ,_bdcd ,_gfc ,_bacag ,_fggcg );
_bdab =_beb .TcTxStyle ;};_ebg :=_ba ;_ggae :=_ge .CellVerticalAlignmentMiddle ;_affe :=_dfaf (0.05);_gdgb :=_dfaf (0.05);if _dggc !=nil {if _gffb :=_dggc .LnL ;_gffb !=nil {_bdde ,_ffbe ,_acg :=_dcb .getBorderStyle (_gffb );_gccb .SetBorder (_ge .CellBorderSideLeft ,_bdde ,_acg );
if _ffbe !=nil &&*_ffbe !=nil {_gccb .SetSideBorderColor (_ge .CellBorderSideLeft ,*_ffbe );};};if _bbccf :=_dggc .LnT ;_bbccf !=nil {_cfff ,_bgcg ,_bgg :=_dcb .getBorderStyle (_bbccf );_gccb .SetBorder (_ge .CellBorderSideTop ,_cfff ,_bgg );if _bgcg !=nil &&*_bgcg !=nil {_gccb .SetSideBorderColor (_ge .CellBorderSideTop ,*_bgcg );
};};if _fcb :=_dggc .LnR ;_fcb !=nil {_eed ,_dbca ,_acef :=_dcb .getBorderStyle (_fcb );_gccb .SetBorder (_ge .CellBorderSideRight ,_eed ,_acef );if _dbca !=nil &&*_dbca !=nil {_gccb .SetSideBorderColor (_ge .CellBorderSideRight ,*_dbca );};};if _bbbc :=_dggc .LnB ;
_bbbc !=nil {_bfae ,_efef ,_eea :=_dcb .getBorderStyle (_bbbc );_gccb .SetBorder (_ge .CellBorderSideBottom ,_bfae ,_eea );if _efef !=nil &&*_efef !=nil {_gccb .SetSideBorderColor (_ge .CellBorderSideBottom ,*_efef );};};if _bade :=_dggc .MarLAttr ;_bade !=nil {_ebg =float64 (_f .FromSTCoordinate32 (*_bade ));
};switch _dggc .AnchorAttr {case _fg .ST_TextAnchoringTypeT :_ggae =_ge .CellVerticalAlignmentTop ;case _fg .ST_TextAnchoringTypeB :_ggae =_ge .CellVerticalAlignmentBottom ;};if _dggc .NoFill ==nil {if _cdfb :=_dggc .SolidFill ;_cdfb !=nil {_cega ,_ :=_dcb .getColorFromSolidFill (_cdfb );
_gccb .SetBackgroundColor (_cega );};};if _fdd :=_dggc .MarBAttr ;_fdd !=nil {_affe =float64 (_f .FromSTCoordinate32 (*_fdd ));};if _aead :=_dggc .MarTAttr ;_aead !=nil {_gdgb =float64 (_f .FromSTCoordinate32 (*_aead ));};};_gccb .SetVerticalAlignment (_ggae );
_gccb .SetIndent (_ebg );var _gcg float64 ;if _bbfa :=_bad .TxBody ;_bbfa !=nil {_daea :=_dcb .makePdfDivisionFromTxBody (_bbfa ,_bdab );_gcg =_daea .Height ()+_gdgb +_affe ;_gccb .SetContent (_daea );};return _gcg ;};func (_gaba *convertContext )makeStyleFromRPr (_bbaa *_fg .CT_TextCharacterProperties )(*_ge .TextStyle ,bool ,bool ,bool ){var _eeca ,_daed ,_bde bool ;
_aec :=_gaba ._fffd .NewTextStyle ();if _bbaa !=nil {_dcee :=_f .FontStyle_Regular ;_baaa :=_aeag (_bbaa .BAttr );_bce :=_aeag (_bbaa .IAttr );if _baaa &&_bce {_dcee =_f .FontStyle_BoldItalic ;}else if _baaa {_dcee =_f .FontStyle_Bold ;}else if _bce {_dcee =_f .FontStyle_Italic ;
};_bde =_bbaa .UAttr !=_fg .ST_TextUnderlineTypeUnset &&_bbaa .UAttr !=_fg .ST_TextUnderlineTypeNone ;_gbf :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _bcdd :=_bbaa .Latin ;_bcdd !=nil {_gbf =_bcdd .TypefaceAttr ;}else if _bged :=_bbaa .Ea ;_bged !=nil {_gbf =_bged .TypefaceAttr ;
}else if _abc :=_bbaa .Cs ;_abc !=nil {_gbf =_abc .TypefaceAttr ;}else if _ebbe :=_bbaa .Sym ;_ebbe !=nil {_gbf =_ebbe .TypefaceAttr ;};if _cgd ,_fafa :=_f .StdFontsMap [_gbf ];_fafa {_aec .Font =_f .AssignStdFontByName (_aec ,_cgd [_dcee ]);}else if _cbbb :=_f .GetRegisteredFont (_gbf ,_dcee );
_cbbb !=nil {_aec .Font =_cbbb ;}else {_e .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_gbf ,_dcee );
_aec .Font =_f .AssignStdFontByName (_aec ,_f .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_dcee ]);};var _adf float64 ;if _fece :=_bbaa .SzAttr ;_fece !=nil {_adf =float64 (*_fece )/100;}else {_adf =_f .DefaultFontSize ;};if _bddd :=_bbaa .BaselineAttr ;
_bddd !=nil {if _fed :=_bddd .ST_PercentageDecimal ;_fed !=nil {if *_fed > 0{_eeca =true ;}else if *_fed < 0{_daed =true ;};};};if _eeca ||_daed {_adf *=0.64;};_aec .FontSize =_adf ;_beaf :=0.0;if _efd :=_bbaa .SpcAttr ;_efd !=nil {if _ggfb :=_efd .ST_TextPointUnqualified ;
_ggfb !=nil {_beaf =float64 (*_ggfb )/100;};};_aec .CharSpacing =_beaf ;};return &_aec ,_eeca ,_daed ,_bde ;};func _dgbe (_fcbc ,_becc *_fg .CT_TableStyleCellStyle )*_fg .CT_TableStyleCellStyle {_gaff :=_fg .NewCT_TableStyleCellStyle ();if _fcbc !=nil {*_gaff =*_fcbc ;
};if _becc ==nil {return _gaff ;};if _gaff .TcBdr ==nil {_gaff .TcBdr =_becc .TcBdr ;};if _gaff .Fill ==nil {_gaff .Fill =_becc .Fill ;};if _gaff .FillRef ==nil {_gaff .FillRef =_becc .FillRef ;};return _gaff ;};var _afca =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};
func _geeb (_bfadb ,_aaee *_fg .CT_TextCharacterProperties )*_fg .CT_TextCharacterProperties {_ecac :=_fg .NewCT_TextCharacterProperties ();if _bfadb !=nil {*_ecac =*_bfadb ;};if _aaee ==nil {return _ecac ;};if _ecac .KumimojiAttr ==nil {_ecac .KumimojiAttr =_aaee .KumimojiAttr ;
};if _ecac .LangAttr ==nil {_ecac .LangAttr =_aaee .LangAttr ;};if _ecac .AltLangAttr ==nil {_ecac .AltLangAttr =_aaee .AltLangAttr ;};if _ecac .SzAttr ==nil {_ecac .SzAttr =_aaee .SzAttr ;};if _ecac .BAttr ==nil {_ecac .BAttr =_aaee .BAttr ;};if _ecac .IAttr ==nil {_ecac .IAttr =_aaee .IAttr ;
};if _ecac .UAttr ==_fg .ST_TextUnderlineTypeUnset {_ecac .UAttr =_aaee .UAttr ;};if _ecac .StrikeAttr ==_fg .ST_TextStrikeTypeUnset {_ecac .StrikeAttr =_aaee .StrikeAttr ;};if _ecac .KernAttr ==nil {_ecac .KernAttr =_aaee .KernAttr ;};if _ecac .CapAttr ==_fg .ST_TextCapsTypeUnset {_ecac .CapAttr =_aaee .CapAttr ;
};if _ecac .SpcAttr ==nil {_ecac .SpcAttr =_aaee .SpcAttr ;};if _ecac .NormalizeHAttr ==nil {_ecac .NormalizeHAttr =_aaee .NormalizeHAttr ;};if _ecac .BaselineAttr ==nil {_ecac .BaselineAttr =_aaee .BaselineAttr ;};if _ecac .NoProofAttr ==nil {_ecac .NoProofAttr =_aaee .NoProofAttr ;
};if _ecac .DirtyAttr ==nil {_ecac .DirtyAttr =_aaee .DirtyAttr ;};if _ecac .ErrAttr ==nil {_ecac .ErrAttr =_aaee .ErrAttr ;};if _ecac .SmtCleanAttr ==nil {_ecac .SmtCleanAttr =_aaee .SmtCleanAttr ;};if _ecac .SmtIdAttr ==nil {_ecac .SmtIdAttr =_aaee .SmtIdAttr ;
};if _ecac .BmkAttr ==nil {_ecac .BmkAttr =_aaee .BmkAttr ;};if _ecac .Ln ==nil {_ecac .Ln =_aaee .Ln ;};if _ecac .NoFill ==nil {_ecac .NoFill =_aaee .NoFill ;};if _ecac .SolidFill ==nil {_ecac .SolidFill =_aaee .SolidFill ;};if _ecac .BlipFill ==nil {_ecac .BlipFill =_aaee .BlipFill ;
};if _ecac .EffectLst ==nil {_ecac .EffectLst =_aaee .EffectLst ;};if _ecac .EffectDag ==nil {_ecac .EffectDag =_aaee .EffectDag ;};if _ecac .Highlight ==nil {_ecac .Highlight =_aaee .Highlight ;};if _ecac .ULnTx ==nil {_ecac .ULnTx =_aaee .ULnTx ;};if _ecac .ULn ==nil {_ecac .ULn =_aaee .ULn ;
};if _ecac .UFillTx ==nil {_ecac .UFillTx =_aaee .UFillTx ;};if _ecac .UFill ==nil {_ecac .UFill =_aaee .UFill ;};if _ecac .Latin ==nil {_ecac .Latin =_aaee .Latin ;};if _ecac .Ea ==nil {_ecac .Ea =_aaee .Ea ;};if _ecac .Cs ==nil {_ecac .Cs =_aaee .Cs ;
};if _ecac .Sym ==nil {_ecac .Sym =_aaee .Sym ;};if _ecac .Rtl ==nil {_ecac .Rtl =_aaee .Rtl ;};return _ecac ;};type symbolStyle struct{_aaad *string ;_gaa *float64 ;_gdce *string ;_dbfg *bool ;_cbd *bool ;_bcbc *bool ;_ffd *bool ;_adgd *bool ;};type textboxContext struct{_fadc *convertContext ;
_dfba float64 ;_cace float64 ;_bgab *_ge .Creator ;_adga float64 ;_bbbb []*paragraph ;_bfd *paragraph ;_cef *line ;_cdbc *word ;_bfb bool ;};func _dffc (_fgfa int ,_adcd bool )string {_dgbd :=(_fgfa -1)/26+1;_dedd :=byte ((_fgfa -1)%26);if _adcd {_dedd +=byte (65);
}else {_dedd +=byte (97);};_fgfg :=_cc .NewBuffer ([]byte {});for _fcda :=0;_fcda < _dgbd ;_fcda ++{_fgfg .Write ([]byte {_dedd });};return _fgfg .String ();};type word struct{_egc []*symbol ;_bdea float64 ;_dfd float64 ;_cgdg bool ;};func (_dgfd *convertContext )makePdfImageFromBlipFill (_cdgd *_fg .CT_BlipFillProperties ,_gcbc bool )(*_ge .Image ,[]*_fg .CT_BlipChoice ,error ){if _bgcba :=_cdgd .Blip ;
_bgcba !=nil {if _efcg :=_bgcba .EmbedAttr ;_efcg !=nil {var _aaac _ac .ImageRef ;var _deea bool ;if _gcbc {_aaac ,_deea =_dgfd ._dcdc .GetLayoutImageByRelID (*_efcg );}else {_aaac ,_deea =_dgfd ._dcdc .GetImageByRelID (*_efcg );};if _deea {_ggac ,_gfgc :=_aa .Open (_aaac .Path ());
if _gfgc !=nil {_e .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_gfgc );return nil ,nil ,_gfgc ;};defer _ggac .Close ();_bgca ,_ ,_gfgc :=_ae .Decode (_ggac );if _gfgc !=nil {_e .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_gfgc );
return nil ,nil ,_gfgc ;};if _fcab :=_cdgd .SrcRect ;_fcab !=nil {_gce :=_bgca .Bounds ().Size ();_ceff :=_gce .X ;_gbaf :=_gce .Y ;var _dfag ,_cefa ,_bdbg ,_bdbgg int ;var _bgegg bool ;if _egb :=_fcab .LAttr ;_egb !=nil {_dfag =int (float64 (_ceff )*_f .FromSTPercentage (_egb ));
_bgegg =true ;}else {_dfag =0;};if _cbe :=_fcab .TAttr ;_cbe !=nil {_bdbg =int (float64 (_gbaf )*_f .FromSTPercentage (_cbe ));_bgegg =true ;}else {_bdbg =0;};if _dacf :=_fcab .RAttr ;_dacf !=nil {_cefa =int (float64 (_ceff )*(1-_f .FromSTPercentage (_dacf )));
_bgegg =true ;}else {_cefa =_ceff ;};if _ecag :=_fcab .BAttr ;_ecag !=nil {_bdbgg =int (float64 (_gbaf )*(1-_f .FromSTPercentage (_ecag )));_bgegg =true ;}else {_bdbgg =_gbaf ;};if _bgegg {_bgca =_f .CropImageByRect (_bgca ,_ae .Rect (_dfag ,_bdbg ,_cefa +1,_bdbgg +1));
};};_gggc ,_gfgc :=_dgfd ._fffd .NewImageFromGoImage (_bgca );_gggc .SetEncoder (_ab .NewFlateEncoder ());if _gfgc !=nil {_e .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_gfgc );
return nil ,nil ,_gfgc ;};return _gggc ,_bgcba .Choice ,nil ;};};};return nil ,nil ,nil ;};func (_aedf *textboxContext )drawParagraphs (){_aedf ._bgab .NewPage ();for _ ,_eade :=range _aedf ._bbbb {for _ ,_bgbbe :=range _eade ._eeb {for _ ,_gadg :=range _bgbbe ._bbgd {for _ ,_caba :=range _gadg ._egc {_abcc :=_aedf ._bgab .NewStyledParagraph ();
if _caba ._gdgd {_caba ._fce =0;}else if _caba ._abed {_caba ._fce =1.2*_bgbbe ._acb -_caba ._ffab ;};_dffe :=_gadg ._bdea +_caba ._fgbd ;_cffd :=_eade ._ebc +_bgbbe ._aeb +_caba ._fce ;_abcc .SetPos (_dffe ,_cffd );_efed :=_abcc .Append (_caba ._aecd );
if _caba ._eabf !=nil {_efed .Style =*_caba ._eabf ;};_aedf ._bgab .Draw (_abcc );if _caba ._dfgf {_ecgd :=_cffd +_caba ._ffab +2;_f .DrawLine (_aedf ._bgab ,_dffe ,_ecgd ,_dffe +_caba ._beea ,_ecgd ,1,_caba ._eabf .Color );};};};};};};func (_ecd *textboxContext )addCurrentParagraph (){_ecd ._adga =_ecd ._bfd ._ebc +_ecd ._bfd ._bgef +_ecd ._bfd ._edgf +_ecd ._bfd ._fdba ;
_ecd ._bbbb =append (_ecd ._bbbb ,_ecd ._bfd );_ecd .alignParagraph ();};func (_eaca *convertContext )getPhData (_fea *_eg .CT_Shape )(*_fg .CT_Transform2D ,*_fg .CT_TextBodyProperties ,*_fg .CT_TextListStyle ,bool ,bool ){_bgcf ,_cdfd :=_degc (_fea );
_gfb :=_cdfd ==nil ;_egad ,_gacf ,_bddgc ,_fcee :=_ggaf (_eaca ._dead .CSld ,_bgcf ,_cdfd ,_gfb );_gegbc ,_caab ,_cgc ,_ecgg :=_ggaf (_eaca ._bgcb .CSld ,_bgcf ,_cdfd ,_gfb );if _gegbc ==nil {_gegbc =_egad ;};_ffgb ,_fdbga :=_fbf (_caab ,_gacf );var _bccc ,_gdcd bool ;
if _cgc ==nil {if _bddgc !=nil {_bccc =*_bddgc ;};}else {_bccc =*_cgc ;};if _ecgg ==nil {if _fcee !=nil {_gdcd =*_fcee ;};}else {_gdcd =*_ecgg ;};return _gegbc ,_ffgb ,_fdbga ,_bccc ,_gdcd ;};func _aeag (_gcgf *bool )bool {return _gcgf !=nil &&*_gcgf };
func (_aabb *textboxContext )alignParagraph (){_aedg :=_aabb ._bfd ;if _aedg ._dbeg ==_fg .ST_TextAlignTypeL {return ;};_ebef :=len (_aedg ._eeb )-1;for _befc ,_dgfbe :=range _aedg ._eeb {_bdef :=true ;_cccf :=len (_dgfbe ._bbgd );_ageg :=0.0;for _aaec :=len (_dgfbe ._bbgd )-1;
_aaec >=0;_aaec --{_gcfd :=_dgfbe ._bbgd [_aaec ];if _bdef &&_gcfd ._cgdg {_cccf =_aaec ;}else {_bdef =false ;for _ ,_bbgf :=range _gcfd ._egc {_ageg +=_bbgf ._beea ;};};};_dgfbe ._bbgd =_dgfbe ._bbgd [:_cccf ];_dggb :=_dgfbe ._aafd -_dgfbe ._efff -_ageg ;
switch _aedg ._dbeg {case _fg .ST_TextAlignTypeR :_dgfbe .moveRight (_dggb );case _fg .ST_TextAlignTypeCtr :_dgfbe .moveRight (_dggb /2);case _fg .ST_TextAlignTypeJust :if _befc !=_ebef {_bfaf :=[]*word {};for _ ,_gdcg :=range _dgfbe ._bbgd {if _gdcg ._cgdg {_bfaf =append (_bfaf ,_gdcg );
};};_dccc :=_dggb /float64 (len (_bfaf ));for _ ,_cffdb :=range _bfaf {_cffdb ._dfd +=_dccc ;};var _dadae *word ;for _ ,_edac :=range _dgfbe ._bbgd {if _dadae !=nil {_edac ._bdea =_dadae ._bdea +_dadae ._dfd ;};_dadae =_edac ;};};};};};func (_aafb *textboxContext )addPrefix (_ffdb *prefixData ,_fbdg *_ge .TextStyle ){_cgbc :=_ebbg (_ffdb ._gabe );
_aefed :=*_fbdg ;if _ffdb ._cgbg {_aefed .Font =_f .AssignStdFontByName (_aefed ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_daab :=range _cgbc {_daab ._eabf =&_aefed ;_aafb .addTextSymbol (_daab );};_fefa :=-(_ffdb ._gcfeg +_aafb ._cdbc ._dfd );
if _fefa < 0{_fefa =0;};_adbf :=&symbol {_aecd :"\u0020",_beea :_fefa };_aafb .addTextSymbol (_adbf );_aafb ._cdbc ._bdea +=(_ffdb ._gcfeg +_ffdb ._ece );};func (_aagg *line )moveRight (_baec float64 ){for _ ,_aced :=range _aagg ._bbgd {_aced ._bdea +=_baec ;
};};func (_cfc *convertContext )applyBlipEffectsOnImg (_egeb *_ge .Image ,_ddad ,_cafg float64 ,_bedb []*_fg .CT_BlipChoice )*_ge .Image {if len (_bedb )==0{return _egeb ;};_egeb .SetPos (_ddad ,_cafg );_cabe ,_edb :=_cfc .renderPageWithDrawableToGoImage (_egeb );
if _edb !=nil {_e .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_edb );
return _egeb ;};_cagg ,_edb :=_cfc .renderCurrentStateToGoImage ();if _edb !=nil {_e .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_edb );
return _egeb ;};_gefd :=_cabe .Bounds ();_aaada :=_ae .NewRGBA (_gefd );_fgef ,_bcddc :=_egeb .Width (),_egeb .Height ();for _ ,_fffa :=range _bedb {for _ ,_adcg :=range _fffa .AlphaModFix {if _adcgf :=_adcg .AmtAttr ;_adcgf !=nil {if _gdf :=_adcgf .ST_PositivePercentageDecimal ;
_gdf !=nil {_fbad :=uint8 (255*(*_gdf )/100000);_dcaf :=_ae .NewUniform (_c .Alpha {_fbad });_a .Draw (_aaada ,_gefd ,_cagg ,_ae .Point {0,0},_a .Src );_a .DrawMask (_aaada ,_gefd ,_cabe ,_ae .Point {0,0},_dcaf ,_ae .Point {0,0},_a .Over );};};};};_ddab :=_ae .Rect (int (_ddad ),int (_cafg ),int (_ddad +_fgef )+1,int (_cafg +_bcddc )+1);
_daae :=_f .CropImageByRect (_aaada ,_ddab );_ecba ,_edb :=_cfc ._fffd .NewImageFromGoImage (_daae );if _edb !=nil {_e .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_edb );
return _egeb ;};return _ecba ;};func _fbf (_aefb ,_bed *_fg .CT_TextBody )(*_fg .CT_TextBodyProperties ,*_fg .CT_TextListStyle ){if _aefb ==nil &&_bed ==nil {return nil ,nil ;};if _aefb ==nil {return _bed .BodyPr ,_bed .LstStyle ;};if _bed ==nil {return _aefb .BodyPr ,_aefb .LstStyle ;
};_egag ,_aac :=_aefb .BodyPr ,_aefb .LstStyle ;_agca ,_eged :=_bed .BodyPr ,_bed .LstStyle ;_aeg :=_cgdc (_egag ,_agca );_bdafg :=_dgcb (_aac ,_eged );return _aeg ,_bdafg ;};func (_dcdgc *convertContext )getColorFromFontReference (_aggf *_fg .CT_FontReference )_ge .Color {var _ccaa _ge .Color ;
var _bcgc string ;if _baaae :=_aggf .SrgbClr ;_baaae !=nil {_bcgc =_baaae .ValAttr ;}else if _afgdg :=_aggf .SchemeClr ;_afgdg !=nil {_bcgc =_f .GetColorStringFromDmlColor (_dcdgc ._eaf .GetColorBySchemeColor (_afgdg .ValAttr ));_bcgc =_f .AdjustColor (_bcgc ,_afgdg .EG_ColorTransform );
};if _bcgc !=""{_ccaa =_ge .ColorRGBFromHex ("\u0023"+_bcgc );};return _ccaa ;};func _dgcb (_fbcb ,_gbbe *_fg .CT_TextListStyle )*_fg .CT_TextListStyle {_acfb :=_fg .NewCT_TextListStyle ();if _fbcb !=nil {*_acfb =*_fbcb ;};if _gbbe ==nil {return _acfb ;
};_acfb .DefPPr =_fbbc (_acfb .DefPPr ,_gbbe .DefPPr );_acfb .Lvl1pPr =_fbbc (_acfb .Lvl1pPr ,_gbbe .Lvl1pPr );_acfb .Lvl2pPr =_fbbc (_acfb .Lvl2pPr ,_gbbe .Lvl2pPr );_acfb .Lvl3pPr =_fbbc (_acfb .Lvl3pPr ,_gbbe .Lvl3pPr );_acfb .Lvl4pPr =_fbbc (_acfb .Lvl4pPr ,_gbbe .Lvl4pPr );
_acfb .Lvl5pPr =_fbbc (_acfb .Lvl5pPr ,_gbbe .Lvl5pPr );_acfb .Lvl6pPr =_fbbc (_acfb .Lvl6pPr ,_gbbe .Lvl6pPr );_acfb .Lvl7pPr =_fbbc (_acfb .Lvl7pPr ,_gbbe .Lvl7pPr );_acfb .Lvl8pPr =_fbbc (_acfb .Lvl8pPr ,_gbbe .Lvl8pPr );_acfb .Lvl9pPr =_fbbc (_acfb .Lvl9pPr ,_gbbe .Lvl9pPr );
return _acfb ;};func (_gabc *convertContext )makePdfBlockFromTable (_cbcd *_fg .Tbl ,_cacd float64 )*_ge .Table {_eaeb :=_cbcd .TblGrid ;if _eaeb ==nil {return nil ;};_bgdf :=len (_eaeb .GridCol );if _bgdf ==0{return nil ;};_ada :=[]float64 {};_cae :=0.0;
for _ ,_aefe :=range _eaeb .GridCol {_bdb :=_gg .FromEMU (_f .FromSTCoordinate (_aefe .WAttr ));_ada =append (_ada ,_bdb );_cae +=_bdb ;};_cgga :=[]float64 {};for _ggagg :=0;_ggagg < _bgdf ;_ggagg ++{_cgga =append (_cgga ,_ada [_ggagg ]/_cae );};_cede :=_gabc ._fffd .NewTable (_bgdf );
_cede .SetColumnWidths (_cgga ...);_efe :=_cbcd .TblPr ;var _dcef *_fg .CT_TableStyle ;if _fdbcg :=_efe .Choice ;_fdbcg !=nil {if _fdbcg .TableStyle !=nil {_dcef =_fdbcg .TableStyle ;}else if _fdbcg .TableStyleId !=nil {_dcef =_gabc ._eaf .GetTableStyleById (*_fdbcg .TableStyleId );
};};_eba :=_fg .NewCT_TablePartStyle ();_eba .TcStyle =_fg .NewCT_TableStyleCellStyle ();_eba .TcTxStyle =_fg .NewCT_TableStyleTextStyle ();if _dcef !=nil {if _dcef .WholeTbl !=nil {*_eba =*_dcef .WholeTbl ;};if _dcef .TblBg !=nil {if _eba .TcStyle .Fill ==nil {_eba .TcStyle .Fill =_dcef .TblBg .Fill ;
};};};if _eba .TcStyle .Fill ==nil {_eba .TcStyle .Fill =_fg .NewCT_FillProperties ();_eba .TcStyle .Fill .NoFill =_efe .NoFill ;_eba .TcStyle .Fill .SolidFill =_efe .SolidFill ;};_fedd :=len (_cbcd .Tr );for _edd ,_geee :=range _cbcd .Tr {_bdc :=_edd ==0;
_eff :=_edd ==_fedd -1;_ffb :=_edd %2==0;_cfgb :=len (_geee .Tc );var _fgb *_fg .CT_TablePartStyle ;if _bdc {_fgb =_dcef .FirstRow ;}else if _ffb {_fgb =_dcef .Band2H ;}else {_fgb =_dcef .Band1H ;};var _cacc float64 ;for _ccg ,_acad :=range _geee .Tc {_edde :=_ccg ==0;
_fba :=_ccg ==_cfgb -1;_aae :=_ccg %2==0;var _gcce *_fg .CT_TablePartStyle ;if _edde {_gcce =_dcef .FirstCol ;}else if _aae {_gcce =_dcef .Band2V ;}else {_gcce =_dcef .Band1V ;};_abba :=_ebab (_ebab (_gcce ,_fgb ),_eba );_fbae :=_gabc .addCellToTable (_cede ,_acad ,_abba ,_cacd *_cgga [_ccg ],_bdc ,_eff ,_edde ,_fba );
if _fbae > _cacc {_cacc =_fbae ;};};_bdee :=_gg .FromEMU (_f .FromSTCoordinate (_geee .HAttr ));if _bdee < _cacc {_bdee =_cacc ;};if _bdee < _gcae (4){_bdee =_gcae (4);};_cede .SetRowHeight (_cede .CurRow (),_bdee );};return _cede ;};type background struct{_edeg _ge .Color ;
_cedb float64 ;_fcdg *_fg .CT_BlipFillProperties ;};func (_bagd *textboxContext )newWord (){_bagd ._cdbc =&word {_cgdg :true ,_bdea :_bagd ._cef ._bebf }};func (_cce *convertContext )makeSlide (){_fdb :=_cce ._dcdc .GetSlideLayout ().CSld ;if _fdb !=nil {if _dbg :=_fdb .SpTree ;
_dbg !=nil {for _ ,_fbb :=range _dbg .Choice {if _fbb !=nil {for _ ,_ca :=range _fbb .Pic {if _ca !=nil {var _gef ,_caf ,_gb ,_gdg float64 ;if _dca :=_ca .SpPr ;_dca !=nil {if _agg :=_dca .Xfrm ;_agg !=nil {_gef ,_caf ,_gb ,_gdg =_f .GetDataFromXfrm (_agg );
};};if _afd :=_ca .BlipFill ;_afd !=nil {_dg :=_cce .getShapeFromBlipFill (_afd ,_gef ,_caf ,_gb ,_gdg ,true );_cce ._gbbf =append (_cce ._gbbf ,_dg );};};};};};};};_fdb =_cce ._dcdc .X ().CSld ;if _fdb ==nil {return ;};_bb :=&background {};if _cfbg :=_fdb .Bg ;
_cfbg !=nil {if _afc :=_cfbg .BgPr ;_afc !=nil {if _afc .NoFill ==nil {if _cab :=_afc .SolidFill ;_cab !=nil {_bae ,_cfe :=_cce .getColorFromSolidFill (_cab );if _bae !=nil {_bb ._edeg =_bae ;_bb ._cedb =_cfe ;};}else if _cg :=_afc .BlipFill ;_cg !=nil {_bb ._fcdg =_cg ;
};};};};_cce ._dede =_bb ;if _gdd :=_fdb .SpTree ;_gdd !=nil {for _ ,_abe :=range _gdd .Choice {if _abe !=nil {for _ ,_cgf :=range _abe .Sp {if _cgf !=nil {_fbe :=_cce .getShapes (_cgf );_cce ._gbbf =append (_cce ._gbbf ,_fbe ...);};};for _ ,_fae :=range _abe .GraphicFrame {if _fae !=nil {var _dac ,_ebb ,_dad ,_cac float64 ;
if _dd :=_fae .Xfrm ;_dd !=nil {_dac ,_ebb ,_dad ,_cac =_f .GetDataFromXfrm (_dd );};if _dad ==0&&_cac ==0{_dad =_cce ._dfb ;_cac =_cce ._ade ;};if _bbc :=_fae .Graphic ;_bbc !=nil {if _ddg :=_bbc .GraphicData ;_ddg !=nil {for _ ,_bga :=range _ddg .Any {if _ddgc ,_geg :=_bga .(*_eag .Chart );
_geg {_fdf ,_ff :=_cce .makePdfBlockFromChart (_ddgc ,_dad ,_cac );if _ff !=nil {_e .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_ff );};if _fdf !=nil {_fdf .SetPos (_dac ,_ebb );_cce ._gbbf =append (_cce ._gbbf ,_fdf );
};}else if _ee ,_ggg :=_bga .(*_fg .Tbl );_ggg {_gff :=_cce .makePdfBlockFromTable (_ee ,_dad );if _gff !=nil {_cga :=_ge .NewBlock (_dad ,_cac );_cga .SetPos (_dac ,_ebb );_cga .Draw (_gff );_cce ._gbbf =append (_cce ._gbbf ,_cga );};};};};};};};for _ ,_fff :=range _abe .CxnSp {if _fff !=nil {_cd :=_cce .getConnectors (_fff );
_cce ._gbbf =append (_cce ._gbbf ,_cd ...);};};for _ ,_acd :=range _abe .GrpSp {_cdd :=0.0;_eae :=0.0;if _fbd :=_acd .GrpSpPr .Xfrm ;_fbd !=nil {_cdd ,_eae =_f .GetGroupOffsetFromXfrm (_fbd );};for _ ,_edg :=range _acd .Choice {for _ ,_cca :=range _edg .CxnSp {if _cca !=nil {_ecg :=_cce .getGroupConnectors (_cca ,_cdd ,_eae );
_cce ._gbbf =append (_cce ._gbbf ,_ecg ...);};};};};for _ ,_bec :=range _abe .Pic {if _bec !=nil {var _dgd ,_gcfe ,_ffg ,_de float64 ;if _gega :=_bec .SpPr ;_gega !=nil {if _dcgg :=_gega .Xfrm ;_dcgg !=nil {_dgd ,_gcfe ,_ffg ,_de =_f .GetDataFromXfrm (_dcgg );
};};if _gac :=_bec .BlipFill ;_gac !=nil {_cfef :=_cce .getShapeFromBlipFill (_gac ,_dgd ,_gcfe ,_ffg ,_de ,false );_cce ._gbbf =append (_cce ._gbbf ,_cfef );};};};};};};};func (_dceeb *textboxContext )newLine (){if _dceeb ._bfd ==nil {_dceeb .newParagraph ();
};_cabg :=_dceeb ._bfd ._edgf +_dceeb ._bfd ._bgef ;_fdbe :=&line {};_fdbe ._efff =_dceeb ._bfd ._gbad ;if len (_dceeb ._bfd ._eeb )==0{_fdbe ._efff +=_dceeb ._bfd ._ffa ;};_fdbe ._aafd =_dceeb ._bfd ._gdbg ;_fdbe ._bebf =_fdbe ._efff ;_fdbe ._aeb =_cabg ;
_dceeb ._bfd ._eeb =append (_dceeb ._bfd ._eeb ,_fdbe );_dceeb ._cef =_fdbe ;};func (_dbcc *convertContext )renderPageWithDrawableToGoImage (_fgfaf _ge .Drawable )(_ae .Image ,error ){_afef :=_f .MakeTempCreator (_dbcc ._dfb ,_dbcc ._ade );_afef .NewPage ();
_afef .Draw (_fgfaf );_gedg ,_bgdd :=_f .GetPageFromCreator (_afef );if _bgdd !=nil {return nil ,_bgdd ;};return _ea .NewImageDevice ().Render (_gedg );};func (_aaag *convertContext )getStyleColors (_fgc *_fg .CT_ShapeStyle )(_ge .Color ,_ge .Color ,_ge .Color ){var _gffa ,_dcaa ,_gfce _ge .Color ;
if _dgbf :=_fgc .LnRef ;_dgbf !=nil {_dcaa =_aaag .getColorFromMatrixReference (_dgbf );};if _eggf :=_fgc .FillRef ;_eggf !=nil {_gfce =_aaag .getColorFromMatrixReference (_eggf );};if _ccefd :=_fgc .FontRef ;_ccefd !=nil {_gffa =_aaag .getColorFromFontReference (_ccefd );
};return _gffa ,_gfce ,_dcaa ;};func _gcae (_ffbd float64 )float64 {return _ffbd *_gg .Millimeter };var _ba =_gcae (1.9);func (_fdbg *convertContext )getConnectors (_cdf *_eg .CT_Connector )[]_ge .Drawable {_fggc ,_ ,_ ,_ ,_ ,_ ,_ :=_fdbg .getShapesFromSpPr (_cdf .SpPr ,_cdf .Style ,false ,0.0,0.0);
return _fggc ;};func _fbef (_bcf *_fg .CT_AdjPoint2D )(float64 ,float64 ){var _ege ,_ccef float64 ;_gec ,_bafb :=_bcf .XAttr ,_bcf .YAttr ;if _ccf :=_gec .ST_Coordinate ;_ccf !=nil {_ege =_gg .FromEMU (_f .FromSTCoordinate (*_ccf ));};if _gcff :=_bafb .ST_Coordinate ;
_gcff !=nil {_ccef =_gg .FromEMU (_f .FromSTCoordinate (*_gcff ));};return _ege ,_ccef ;};func _dfaf (_fdc float64 )float64 {return _fdc *_gg .Inch };func _dfbb (_baea int ,_dfde bool )string {_fbbb :=_cc .NewBuffer ([]byte {});for _ ,_eeg :=range _ddfg {for {if _baea < _eeg ._acdb {break ;
};_fbbb .WriteString (_eeg ._dcff );_baea -=_eeg ._acdb ;};};_ebdd :=_fbbb .String ();if _dfde {_ebdd =_dc .ToUpper (_ebdd );};return _ebdd ;};type romanMatch struct{_acdb int ;_dcff string ;};func _ebbg (_cbgg string )[]*symbol {_bab :=[]*symbol {};for _ ,_dbbe :=range _cbgg {_bab =append (_bab ,&symbol {_aecd :string (_dbbe )});
};return _bab ;};func (_ddc *textboxContext )assignPropsToCurrentParagraph (_eded *_fg .CT_TextParagraphProperties ){_cgae :=12.4;if _eded ==nil {_ddc ._bfd ._dgcc =_cgae ;return ;};if _ecbc :=_eded .DefRPr ;_ecbc !=nil {_ffdd :=_ecbc .SzAttr ;if _ffdd !=nil {_add :=float64 (*_ffdd )/1200;
if _cgae <=_add {_cgae =_add ;};};};if _acf :=_eded .MarLAttr ;_acf !=nil {_ddc ._bfd ._gbad =_gg .FromEMU (int64 (*_acf ));};_ddc ._bfd ._gdbg =_ddc ._dfba ;if _cafa :=_eded .MarRAttr ;_cafa !=nil {_ddc ._bfd ._gdbg -=_gg .FromEMU (int64 (*_cafa ));};
if _ddgcg :=_eded .IndentAttr ;_ddgcg !=nil {_ddc ._bfd ._ffa =_gg .FromEMU (int64 (*_ddgcg ));};if _babd :=_eded .LatinLnBrkAttr ;_babd !=nil {_ddc ._bfd ._feg =*_babd ;};if _cbdg :=_eded .LnSpc ;_cbdg !=nil {if _gbbg :=_cbdg .SpcPct ;_gbbg !=nil {if _beac :=_gbbg .ValAttr .ST_TextSpacingPercent ;
_beac !=nil {_cgae =float64 (*_beac )/5000;};};};var _ggcb float64 ;if _cfda :=_eded .SpcBef ;_cfda !=nil {if _dcc :=_cfda .SpcPts ;_dcc !=nil {_ggcb =float64 (_dcc .ValAttr )/100;};};_dbag :=_ddc ._bbbb ;if len (_dbag )> 0{_ggcb -=_dbag [len (_dbag )-1]._fdba ;
if _ggcb < 0{_ggcb =0;};};_ddc ._bfd ._bgef =_ggcb ;if _caga :=_eded .SpcAft ;_caga !=nil {if _cgaa :=_caga .SpcPts ;_cgaa !=nil {_ddc ._bfd ._fdba =float64 (_cgaa .ValAttr )/100;};};_ddc ._bfd ._dgcc =_cgae ;_ddc ._bfd ._dbeg =_eded .AlgnAttr ;};func (_aag *textboxContext )addCurrentWordToParagraph (){if _aag ._bfb &&_aag ._cef ._bebf +_aag ._cdbc ._dfd > _aag ._cef ._aafd {_aag .newLine ();
};if !_aag ._cdbc ._cgdg ||len (_aag ._cef ._bbgd )> 0{_aag ._cdbc ._bdea =_aag ._cef ._bebf ;_aag ._cef ._bbgd =append (_aag ._cef ._bbgd ,_aag ._cdbc );_aag ._cef ._bebf +=_aag ._cdbc ._dfd ;for _ ,_abg :=range _aag ._cdbc ._egc {_aag .adjustHeights (_abg ._fgf );
};};};func (_eb *convertContext )extractDefaultProperties (){_da :=_eb ._eaf .X ();_bd :=_da .DefaultTextStyle ;var _ga ,_ag ,_afa ,_fd ,_ebd ,_ccb ,_dbc ,_gad ,_afac ,_cfb *_fg .CT_TextParagraphProperties ;if _bd !=nil {_ga =_bd .DefPPr ;_ag =_fbbc (_bd .Lvl1pPr ,_ga );
_afa =_fbbc (_bd .Lvl2pPr ,_ga );_fd =_fbbc (_bd .Lvl3pPr ,_ga );_ebd =_fbbc (_bd .Lvl4pPr ,_ga );_ccb =_fbbc (_bd .Lvl5pPr ,_ga );_dbc =_fbbc (_bd .Lvl6pPr ,_ga );_gad =_fbbc (_bd .Lvl7pPr ,_ga );_afac =_fbbc (_bd .Lvl8pPr ,_ga );_cfb =_fbbc (_bd .Lvl9pPr ,_ga );
_eb ._fddf =_ga ;_eb ._cbgf =_ga .DefRPr ;};_eb ._efc =make ([]*_fg .CT_TextParagraphProperties ,9);_eb ._efc [0]=_ag ;_eb ._efc [1]=_afa ;_eb ._efc [2]=_fd ;_eb ._efc [3]=_ebd ;_eb ._efc [4]=_ccb ;_eb ._efc [5]=_dbc ;_eb ._efc [6]=_gad ;_eb ._efc [7]=_afac ;
_eb ._efc [8]=_cfb ;_fde :=_eb ._eaf .SlideMasters ()[0].X ();_dcd :=_fde .TxStyles ;_fe :=_dcd .TitleStyle ;_eb ._aged =_fbbc (_fe .DefPPr ,_ga );_eb ._deecd =_eb ._aged .DefRPr ;_eb ._ccca =make ([]*_fg .CT_TextParagraphProperties ,9);_eb ._ccca [0]=_fbbc (_fe .Lvl1pPr ,_ag );
_eb ._ccca [1]=_fbbc (_fe .Lvl2pPr ,_afa );_eb ._ccca [2]=_fbbc (_fe .Lvl3pPr ,_fd );_eb ._ccca [3]=_fbbc (_fe .Lvl4pPr ,_ebd );_eb ._ccca [4]=_fbbc (_fe .Lvl5pPr ,_ccb );_eb ._ccca [5]=_fbbc (_fe .Lvl6pPr ,_dbc );_eb ._ccca [6]=_fbbc (_fe .Lvl7pPr ,_gad );
_eb ._ccca [7]=_fbbc (_fe .Lvl8pPr ,_afac );_eb ._ccca [8]=_fbbc (_fe .Lvl9pPr ,_cfb );_bg :=_dcd .BodyStyle ;_eb ._dbf =_fbbc (_bg .DefPPr ,_ga );_eb ._gdb =_eb ._dbf .DefRPr ;_eb ._daa =make ([]*_fg .CT_TextParagraphProperties ,9);_eb ._daa [0]=_fbbc (_bg .Lvl1pPr ,_ag );
_eb ._daa [1]=_fbbc (_bg .Lvl2pPr ,_afa );_eb ._daa [2]=_fbbc (_bg .Lvl3pPr ,_fd );_eb ._daa [3]=_fbbc (_bg .Lvl4pPr ,_ebd );_eb ._daa [4]=_fbbc (_bg .Lvl5pPr ,_ccb );_eb ._daa [5]=_fbbc (_bg .Lvl6pPr ,_dbc );_eb ._daa [6]=_fbbc (_bg .Lvl7pPr ,_gad );_eb ._daa [7]=_fbbc (_bg .Lvl8pPr ,_afac );
_eb ._daa [8]=_fbbc (_bg .Lvl9pPr ,_cfb );};func (_edec *textboxContext )alignParagraphsVertically (_fee _fg .ST_TextAnchoringType ){if _fee ==_fg .ST_TextAnchoringTypeT {return ;};_fddg :=0.0;for _ ,_dbcg :=range _edec ._bbbb {_fddg +=_dbcg ._bgef +_dbcg ._edgf +_dbcg ._fdba ;
};var _gbbff float64 ;switch _fee {case _fg .ST_TextAnchoringTypeCtr :_gbbff =(_edec ._cace -_fddg )/2;case _fg .ST_TextAnchoringTypeB :_gbbff =_edec ._cace -_fddg ;};for _ ,_fded :=range _edec ._bbbb {_fded ._ebc +=_gbbff ;};};func (_agcbf *textboxContext )addTextRun (_fgec *_fg .EG_TextRun ,_gefb *_fg .CT_TextCharacterProperties ,_bbfg _ge .Color ,_gaga *prefixData ){if _aecb :=_fgec .Br ;
_aecb !=nil {_agcbf .addCurrentWordToParagraph ();_agcbf .newLine ();_agcbf .newWord ();}else if _eega :=_fgec .R ;_eega !=nil {var _bdadg _ge .Color ;if _eega .RPr !=nil &&_eega .RPr .SolidFill !=nil {_bdadg ,_ =_agcbf ._fadc .getColorFromSolidFill (_eega .RPr .SolidFill );
}else if _bbfg !=nil {_bdadg =_bbfg ;}else if _gefb .SolidFill !=nil {_bdadg ,_ =_agcbf ._fadc .getColorFromSolidFill (_gefb .SolidFill );}else {_bdadg =_ge .ColorBlack ;};_gbfa :=_geeb (_eega .RPr ,_gefb );_cda ,_dgde ,_ccde ,_adcc :=_agcbf ._fadc .makeStyleFromRPr (_gbfa );
_cda .Color =_bdadg ;if _gaga !=nil {_agcbf .addPrefix (_gaga ,_cda );};_cfge :=_ebbg (_eega .T );for _ ,_bacae :=range _cfge {_bacae ._eabf =_cda ;_bacae ._gdgd =_dgde ;_bacae ._abed =_ccde ;_bacae ._dfgf =_adcc ;if _gbfa .CapAttr ==_fg .ST_TextCapsTypeAll {_bacae ._aecd =_dc .ToUpper (_bacae ._aecd );
};_agcbf .addTextSymbol (_bacae );};};};func (_cadb *convertContext )getColorFromSolidFill (_fadcd *_fg .CT_SolidColorFillProperties )(_ge .Color ,float64 ){if _fadcd ==nil {return nil ,1;};var _eggd string ;_abcf :=1.0;if _bace :=_fadcd .SrgbClr ;_bace !=nil {_eggd =_bace .ValAttr ;
_abcf =_f .GetOpacityFromColorTransform (_bace .EG_ColorTransform );}else if _afe :=_fadcd .SchemeClr ;_afe !=nil {_eggd =_f .GetColorStringFromDmlColor (_cadb ._dcdc .GetColorBySchemeColor (_afe .ValAttr ));_eggd =_f .AdjustColor (_eggd ,_afe .EG_ColorTransform );
_abcf =_f .GetOpacityFromColorTransform (_afe .EG_ColorTransform );};if _eggd !=""{_ega :=_ge .ColorRGBFromHex ("\u0023"+_eggd );return _ega ,_abcf ;};return nil ,1;};func (_ecae *convertContext )getShapes (_abeb *_eg .CT_Shape )[]_ge .Drawable {_bf :=[]_ge .Drawable {};
_cgb :=_abeb .SpPr ;if _cgb ==nil {return _bf ;};var _dge bool ;if _bef :=_abeb .UseBgFillAttr ;_bef !=nil {_dge =*_bef ;};_dff ,_ede ,_bfa ,_gbb ,_gcdc ,_fcf ,_dgb :=_ecae .getShapesFromSpPr (_cgb ,_abeb .Style ,_dge ,0.0,0.0);_bf =append (_bf ,_dff ...);
if _fbc :=_abeb .TxBody ;_fbc !=nil {_ebba ,_baca ,_dgff ,_bbg ,_geb :=_ecae .getPhData (_abeb );if _ebba !=nil &&!_dgb {_ede ,_bfa ,_gbb ,_gcdc =_f .GetDataFromXfrm (_ebba );};_bgaa ,_aff :=_ecae .makePdfBlockFromTxBody (_fbc ,_baca ,_dgff ,_gbb ,_gcdc ,_fcf ,_bbg ,_geb );
if _aff !=nil {_e .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_aff );
}else if _bgaa !=nil {_bgaa .SetPos (_ede ,_bfa );_bf =append (_bf ,_bgaa );};};return _bf ;};type line struct{_aeb float64 ;_efff float64 ;_aafd float64 ;_bebf float64 ;_acb float64 ;_bbgd []*word ;};