//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_e "bytes";_fe "errors";_fa "github.com/unidoc/unioffice/v2/common";_df "github.com/unidoc/unioffice/v2/common/logger";_ed "github.com/unidoc/unioffice/v2/common/tempstorage";_bc "github.com/unidoc/unioffice/v2/internal/convertutils";
_bd "github.com/unidoc/unioffice/v2/measurement";_bf "github.com/unidoc/unioffice/v2/presentation";_gg "github.com/unidoc/unioffice/v2/schema/soo/dml";_a "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_c "github.com/unidoc/unioffice/v2/schema/soo/pml";
_ef "github.com/unidoc/unipdf/v4/contentstream/draw";_fcd "github.com/unidoc/unipdf/v4/core";_ee "github.com/unidoc/unipdf/v4/creator";_fag "github.com/unidoc/unipdf/v4/model";_ec "github.com/unidoc/unipdf/v4/render";_g "image";_b "image/color";_fc "image/draw";
_ge "math";_d "strconv";_gc "strings";);func _geffd (_gceae int ,_ffddeg bool )string {_bfaf :=(_gceae -1)/26+1;_ddba :=byte ((_gceae -1)%26);if _ffddeg {_ddba +=byte (65);}else {_ddba +=byte (97);};_aaf :=_e .NewBuffer ([]byte {});for _bbfe :=0;_bbfe < _bfaf ;
_bbfe ++{_aaf .Write ([]byte {_ddba });};return _aaf .String ();};func (_baag *line )moveRight (_eedd float64 ){for _ ,_ebf :=range _baag ._ddbg {_ebf ._bddb +=_eedd ;};};func (_dddg *convertContext )getStyleColors (_cgab *_gg .CT_ShapeStyle )(_ee .Color ,_ee .Color ,_ee .Color ){var _dbcc ,_feef ,_eadb _ee .Color ;
if _dgf :=_cgab .LnRef ;_dgf !=nil {_feef =_dddg .getColorFromMatrixReference (_dgf );};if _gfed :=_cgab .FillRef ;_gfed !=nil {_eadb =_dddg .getColorFromMatrixReference (_gfed );};if _adfc :=_cgab .FontRef ;_adfc !=nil {_dbcc =_dddg .getColorFromFontReference (_adfc );
};return _dbcc ,_eadb ,_feef ;};func (_aca *convertContext )getShapesFromSpPr (_gebf *_gg .CT_ShapeProperties ,_bgg *_gg .CT_ShapeStyle ,_fabe bool ,_edge float64 ,_faed float64 )([]_ee .Drawable ,float64 ,float64 ,float64 ,float64 ,_ee .Color ,bool ){_cge :=[]_ee .Drawable {};
var _dea ,_caad ,_cffc ,_aee ,_dcf float64 ;var _fege ,_ffg ,_eae ,_acc _ee .Color ;var _fdb *_gg .CT_BlipFillProperties ;_gab ,_efe :=1.0,1.0;if _bgg !=nil {_fege ,_ffg ,_acc =_aca .getStyleColors (_bgg );};if _bec :=_gebf .Ln ;_bec !=nil {if _bec .LineFillPropertiesChoice .NoFill !=nil {_eae ,_dcf =nil ,0;
}else {_eae ,_dcf ,_gab =_aca .getInfoFromLn (_bec );if _eae ==nil {_eae =_acc ;};};};if _gebf .FillPropertiesChoice .NoFill !=nil {_ffg ,_efe =nil ,0;}else if _fabe {_ffg =_aca ._gagd ._bbdd ;_efe =_aca ._gagd ._ffee ;_fdb =_aca ._gagd ._dcee ;}else if _ageg :=_gebf .FillPropertiesChoice .SolidFill ;
_ageg !=nil {_ffg ,_efe =_aca .getColorFromSolidFill (_ageg );};var _gbc bool ;if _geec :=_gebf .Xfrm ;_geec !=nil {_dea ,_caad ,_cffc ,_aee =_bc .GetDataFromXfrm (_geec );_dea +=_edge ;_caad +=_faed ;_gbc =true ;};if _dbga :=_gebf .GeometryChoice .CustGeom ;
_dbga !=nil {_fga :=[]_ef .Point {};_gfe ,_egf :=1.0,1.0;if _dbbe :=_dbga .PathLst ;_dbbe !=nil {for _ ,_gcad :=range _dbbe .Path {if _gcad !=nil {if _afe :=_gcad .WAttr ;_afe !=nil {_gfe =_cffc /_bd .FromEMU (*_afe );};if _fge :=_gcad .HAttr ;_fge !=nil {_egf =_aee /_bd .FromEMU (*_fge );
};for _ ,_abde :=range _gcad .Path2DChoice {if _abde .Close !=nil {};if _cbd :=_abde .MoveTo ;_abde .MoveTo !=nil {if _cbd !=nil &&_cbd .Pt !=nil {_abc ,_efec :=_dbde (_cbd .Pt );_fga =append (_fga ,_ef .Point {X :_abc *_gfe +_dea ,Y :_efec *_egf +_caad });
};};if _bcbd :=_abde .LnTo ;_bcbd !=nil &&_bcbd .Pt !=nil {_dfdfc ,_ffdde :=_dbde (_bcbd .Pt );_fga =append (_fga ,_ef .Point {X :_dfdfc *_gfe +_dea ,Y :_ffdde *_egf +_caad });};};_fbe :=_aca ._eec .NewPolygon ([][]_ef .Point {_fga });_fbe .SetFillColor (_ffg );
_fbe .SetFillOpacity (_efe );_fbe .SetBorderWidth (_dcf );if _eae !=nil {_fbe .SetBorderColor (_eae );_fbe .SetBorderOpacity (_gab );};_cge =append (_cge ,_fbe );};};};};if _gbd :=_gebf .GeometryChoice .PrstGeom ;_gbd !=nil {switch _gbd .PrstAttr {case _gg .ST_ShapeTypeRect :if _fdb !=nil {_dad :=_aca .getShapeFromBlipFill (_fdb ,_dea ,_caad ,_cffc ,_aee ,false );
_cge =append (_cge ,_dad );}else {_bbc :=_aca ._eec .NewRectangle (_dea ,_caad ,_cffc ,_aee );_aga :=_ffg !=nil &&_efe > 0;if _aga {_bbc .SetFillColor (_ffg );_bbc .SetFillOpacity (_efe );};_agf :=_eae !=nil &&_gab > 0&&_dcf > 0;if _agf {_bbc .SetBorderWidth (_dcf );
_bbc .SetBorderColor (_eae );_bbc .SetBorderOpacity (_gab );};if _aga ||_agf {_cge =append (_cge ,_bbc );};};case _gg .ST_ShapeTypeLine :_aeg :=_aca ._eec .NewLine (_dea ,_caad ,_dea +_cffc ,_caad +_aee );_aeg .SetLineWidth (_dcf );if _eae !=nil {_aeg .SetColor (_eae );
};_cge =append (_cge ,_aeg );};};return _cge ,_dea ,_caad ,_cffc ,_aee ,_fege ,_gbc ;};func (_bcec *convertContext )applyBlipEffectsOnImg (_dfbd *_ee .Image ,_ecgd ,_bgef float64 ,_ccbc []*_gg .CT_BlipChoice )*_ee .Image {if len (_ccbc )==0{return _dfbd ;
};_dfbd .SetPos (_ecgd ,_bgef );_acfc ,_afad :=_bcec .renderPageWithDrawableToGoImage (_dfbd );if _afad !=nil {_df .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_afad );
return _dfbd ;};_dgbg ,_afad :=_bcec .renderCurrentStateToGoImage ();if _afad !=nil {_df .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_afad );
return _dfbd ;};_fefa :=_acfc .Bounds ();_bgde :=_g .NewRGBA (_fefa );_cdfc ,_eedc :=_dfbd .Width (),_dfbd .Height ();for _ ,_ggbc :=range _ccbc {if _ffde :=_ggbc .AlphaModFix ;_ffde ==nil {continue ;};if _fegg :=_ggbc .AlphaModFix .AmtAttr ;_fegg !=nil {if _agg :=_fegg .ST_PositivePercentageDecimal ;
_agg !=nil {_fccd :=uint8 (255*(*_agg )/100000);_fdfa :=_g .NewUniform (_b .Alpha {_fccd });_fc .Draw (_bgde ,_fefa ,_dgbg ,_g .Point {0,0},_fc .Src );_fc .DrawMask (_bgde ,_fefa ,_acfc ,_g .Point {0,0},_fdfa ,_g .Point {0,0},_fc .Over );};};};_cabe :=_g .Rect (int (_ecgd ),int (_bgef ),int (_ecgd +_cdfc )+1,int (_bgef +_eedc )+1);
_ccee :=_bc .CropImageByRect (_bgde ,_cabe );_feba ,_afad :=_bcec ._eec .NewImageFromGoImage (_ccee );if _afad !=nil {_df .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_afad );
return _dfbd ;};return _feba ;};type line struct{_dafc float64 ;_ced float64 ;_bgbe float64 ;_dge float64 ;_cgff float64 ;_ddbg []*word ;};type symbol struct{_gba string ;_ggcg float64 ;_fdbf float64 ;_fde float64 ;_cfade float64 ;_cbde float64 ;_fcac *_ee .TextStyle ;
_edbe string ;_fdgc bool ;_dae bool ;_bgee bool ;};func (_cdbc *convertContext )getBorderStyle (_bgb *_gg .CT_LineProperties )(_ee .CellBorderStyle ,*_ee .Color ,float64 ){if _bgb ==nil ||_bgb .LineFillPropertiesChoice .NoFill !=nil {return _ee .CellBorderStyleNone ,nil ,0;
};var _ffec _ee .Color ;if _egd :=_bgb .LineFillPropertiesChoice .SolidFill ;_egd !=nil {_ffec ,_ =_cdbc .getColorFromSolidFill (_egd );};_gegc :=0.0;if _defg :=_bgb .WAttr ;_defg !=nil {_gegc =_bd .FromEMU (int64 (*_defg ));};return _ee .CellBorderStyleSingle ,&_ffec ,_gegc ;
};type symbolStyle struct{_ceg *string ;_aec *float64 ;_agegc *string ;_fbgd *bool ;_gegd *bool ;_ecac *bool ;_ebab *bool ;_bbce *bool ;};func (_dbef *textboxContext )drawParagraphs (){_dbef ._cagf .NewPage ();for _ ,_fdaa :=range _dbef ._bea {for _ ,_baed :=range _fdaa ._dagf {for _ ,_fgae :=range _baed ._ddbg {for _ ,_aag :=range _fgae ._fabea {_dgbd :=_dbef ._cagf .NewStyledParagraph ();
if _aag ._fdgc {_aag ._cfade =0;}else if _aag ._dae {_aag ._cfade =1.2*_baed ._cgff -_aag ._fde ;};_caae :=_fgae ._bddb +_aag ._ggcg ;_egbd :=_fdaa ._ffbb +_baed ._dafc +_aag ._cfade ;_dgbd .SetPos (_caae ,_egbd );_cage :=_dgbd .Append (_aag ._gba );if _aag ._fcac !=nil {_cage .Style =*_aag ._fcac ;
};_dbef ._cagf .Draw (_dgbd );if _aag ._bgee {_cdeaf :=_egbd +_aag ._fde +2;_bc .DrawLine (_dbef ._cagf ,_caae ,_cdeaf ,_caae +_aag ._cbde ,_cdeaf ,1,_aag ._fcac .Color );};};};};};};func (_cbc *textboxContext )addCurrentWordToParagraph (){if _cbc ._dce &&_cbc ._bbbd ._dge +_cbc ._cfde ._bcge > _cbc ._bbbd ._bgbe {_cbc .newLine ();
};if !_cbc ._cfde ._cefg ||len (_cbc ._bbbd ._ddbg )> 0{_cbc ._cfde ._bddb =_cbc ._bbbd ._dge ;_cbc ._bbbd ._ddbg =append (_cbc ._bbbd ._ddbg ,_cbc ._cfde );_cbc ._bbbd ._dge +=_cbc ._cfde ._bcge ;for _ ,_dgb :=range _cbc ._cfde ._fabea {_cbc .adjustHeights (_dgb ._fdbf );
};};};func (_gaa *convertContext )makePdfBlockFromTable (_fce *_gg .Tbl )*_ee .Table {_dddd :=_fce .TblGrid ;if _dddd ==nil {return nil ;};_efa :=len (_dddd .GridCol );if _efa ==0{return nil ;};_eaba :=[]float64 {};_fgffg :=0.0;for _ ,_ede :=range _dddd .GridCol {_ffb :=_bd .FromEMU (_bc .FromSTCoordinate (_ede .WAttr ));
_eaba =append (_eaba ,_ffb );_fgffg +=_ffb ;};_gcea :=[]float64 {};for _eage :=0;_eage < _efa ;_eage ++{_gcea =append (_gcea ,_eaba [_eage ]/_fgffg );};_efad :=_gaa ._eec .NewTable (_efa );_efad .SetColumnWidths (_gcea ...);_gefeb :=_fce .TblPr ;var _eabc *_gg .CT_TableStyle ;
if _gefg :=_gefeb .TablePropertiesChoice ;_gefg !=nil {if _gefg .TableStyle !=nil {_eabc =_gefg .TableStyle ;}else if _gefg .TableStyleId !=nil {_eabc =_gaa ._eadg .GetTableStyleById (*_gefg .TableStyleId );};};_ceb :=_gg .NewCT_TablePartStyle ();_ceb .TcStyle =_gg .NewCT_TableStyleCellStyle ();
_ceb .TcTxStyle =_gg .NewCT_TableStyleTextStyle ();if _eabc !=nil {if _eabc .WholeTbl !=nil {*_ceb =*_eabc .WholeTbl ;};if _eabc .TblBg !=nil {if _ceb .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_ceb .TcStyle .ThemeableFillStyleChoice .Fill =_eabc .TblBg .ThemeableFillStyleChoice .Fill ;
};};};if _ceb .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_ceb .TcStyle .ThemeableFillStyleChoice .Fill =_gg .NewCT_FillProperties ();_ceb .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .NoFill =_gefeb .FillPropertiesChoice .NoFill ;
_ceb .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .SolidFill =_gefeb .FillPropertiesChoice .SolidFill ;};_cfa :=len (_fce .Tr );_baf :=_fce .TblPr .BandRowAttr !=nil &&*_fce .TblPr .BandRowAttr ;_eaae :=_fce .TblPr .FirstRowAttr !=nil &&*_fce .TblPr .FirstRowAttr ;
_gbcf :=_fce .TblPr .LastRowAttr !=nil &&*_fce .TblPr .LastRowAttr ;_ccfb :=_fce .TblPr .BandColAttr !=nil &&*_fce .TblPr .BandColAttr ;_cebc :=_fce .TblPr .FirstColAttr !=nil &&*_fce .TblPr .FirstColAttr ;_feb :=_fce .TblPr .LastColAttr !=nil &&*_fce .TblPr .LastColAttr ;
for _deaa ,_ebgg :=range _fce .Tr {_fbae :=_deaa ==0;_fea :=_deaa ==_cfa -1;_edgg :=_deaa %2==0;_eabb :=len (_ebgg .Tc );var _afc *_gg .CT_TablePartStyle ;if _eabc !=nil {if _fbae &&_eaae {_afc =_eabc .FirstRow ;}else if _fea &&_gbcf {_afc =_eabc .LastRow ;
}else if _edgg &&_baf {_afc =_eabc .Band2H ;}else if _baf {_afc =_eabc .Band1H ;};};var _ecg float64 ;for _eade ,_eac :=range _ebgg .Tc {_afeg :=_eade ==0;_gadb :=_eade ==_eabb -1;_bca :=_eade %2==0;var _adc *_gg .CT_TablePartStyle ;if _eabc !=nil {if _afeg &&_cebc {_adc =_eabc .FirstCol ;
}else if _gadb &&_feb {_adc =_eabc .LastCol ;}else if _bca &&_ccfb {_adc =_eabc .Band2V ;}else if _ccfb {_adc =_eabc .Band1V ;};};_dbf :=_dccgg (_dccgg (_adc ,_afc ),_ceb );_ffab :=_gaa .addCellToTable (_efad ,_eac ,_dbf ,_fbae ,_fea ,_afeg ,_gadb );if _ffab > _ecg {_ecg =_ffab ;
};};_cdea :=_bd .FromEMU (_bc .FromSTCoordinate (_ebgg .HAttr ));if _cdea < _ecg {_cdea =_ecg ;};if _cdea < _aged (4){_cdea =_aged (4);};_efad .SetRowHeight (_efad .CurRow (),_cdea );};return _efad ;};func _bbe (_ebc ,_gdcf *_gg .CT_TextListStyle )*_gg .CT_TextListStyle {_gbcfg :=_gg .NewCT_TextListStyle ();
if _ebc !=nil {*_gbcfg =*_ebc ;};if _gdcf ==nil {return _gbcfg ;};_gbcfg .DefPPr =_cacd (_gbcfg .DefPPr ,_gdcf .DefPPr );_gbcfg .Lvl1pPr =_cacd (_gbcfg .Lvl1pPr ,_gdcf .Lvl1pPr );_gbcfg .Lvl2pPr =_cacd (_gbcfg .Lvl2pPr ,_gdcf .Lvl2pPr );_gbcfg .Lvl3pPr =_cacd (_gbcfg .Lvl3pPr ,_gdcf .Lvl3pPr );
_gbcfg .Lvl4pPr =_cacd (_gbcfg .Lvl4pPr ,_gdcf .Lvl4pPr );_gbcfg .Lvl5pPr =_cacd (_gbcfg .Lvl5pPr ,_gdcf .Lvl5pPr );_gbcfg .Lvl6pPr =_cacd (_gbcfg .Lvl6pPr ,_gdcf .Lvl6pPr );_gbcfg .Lvl7pPr =_cacd (_gbcfg .Lvl7pPr ,_gdcf .Lvl7pPr );_gbcfg .Lvl8pPr =_cacd (_gbcfg .Lvl8pPr ,_gdcf .Lvl8pPr );
_gbcfg .Lvl9pPr =_cacd (_gbcfg .Lvl9pPr ,_gdcf .Lvl9pPr );return _gbcfg ;};type romanMatch struct{_gccff int ;_aff string ;};func (_gfde *textboxContext )newWord (){_gfde ._cfde =&word {_cefg :true ,_bddb :_gfde ._bbbd ._dge }};type background struct{_bbdd _ee .Color ;
_ffee float64 ;_dcee *_gg .CT_BlipFillProperties ;};type paragraph struct{_aaab float64 ;_cffe float64 ;_ecfb float64 ;_gggg float64 ;_eef float64 ;_fgeb float64 ;_ffbb float64 ;_cgbb float64 ;_adcc _gg .ST_TextAlignType ;_beebe float64 ;_ffcf bool ;_dagf []*line ;
};var _ca =_aged (1.9);func (_gdaf *convertContext )renderPageWithDrawableToGoImage (_egab _ee .Drawable )(_g .Image ,error ){_fece :=_bc .MakeTempCreator (_gdaf ._dbfd ,_gdaf ._feece );_fece .NewPage ();_fece .Draw (_egab );_bdcgg ,_abda :=_bc .GetPageFromCreator (_fece );
if _abda !=nil {return nil ,_abda ;};return _ec .NewImageDevice ().Render (_bdcgg );};func _aged (_addf float64 )float64 {return _addf *_bd .Millimeter };func (_fad *convertContext )addCellToTable (_dbba *_ee .Table ,_dbge *_gg .CT_TableCell ,_cfad *_gg .CT_TablePartStyle ,_fcc ,_gea ,_fdad ,_bbfcf bool )float64 {var _bdcf *_ee .TableCell ;
_cdfb :=1;if _dbge .GridSpanAttr !=nil {_cdfb =int (*_dbge .GridSpanAttr );};_bdcf =_dbba .MultiColCell (_cdfb );_dadf :=_dbge .TcPr ;var _egcf *_gg .CT_TableStyleTextStyle ;if _cfad !=nil {_dadf =_cccb (_dadf ,_cfad .TcStyle ,_fcc ,_gea ,_fdad ,_bbfcf );
_egcf =_cfad .TcTxStyle ;};_ggag :=_ca ;_gedab :=_ee .CellVerticalAlignmentMiddle ;_bbde :=_abec (0.05);_ccbd :=_abec (0.05);if _dadf !=nil {if _debc :=_dadf .LnL ;_debc !=nil {_cabd ,_fedd ,_fagg :=_fad .getBorderStyle (_debc );_bdcf .SetBorder (_ee .CellBorderSideLeft ,_cabd ,_fagg );
if _fedd !=nil &&*_fedd !=nil {_bdcf .SetSideBorderColor (_ee .CellBorderSideLeft ,*_fedd );};};if _bda :=_dadf .LnT ;_bda !=nil {_afg ,_dfa ,_edbg :=_fad .getBorderStyle (_bda );_bdcf .SetBorder (_ee .CellBorderSideTop ,_afg ,_edbg );if _dfa !=nil &&*_dfa !=nil {_bdcf .SetSideBorderColor (_ee .CellBorderSideTop ,*_dfa );
};};if _bcd :=_dadf .LnR ;_bcd !=nil {_ebge ,_ecbg ,_ddfe :=_fad .getBorderStyle (_bcd );_bdcf .SetBorder (_ee .CellBorderSideRight ,_ebge ,_ddfe );if _ecbg !=nil &&*_ecbg !=nil {_bdcf .SetSideBorderColor (_ee .CellBorderSideRight ,*_ecbg );};};if _egec :=_dadf .LnB ;
_egec !=nil {_gccf ,_gdc ,_caadc :=_fad .getBorderStyle (_egec );_bdcf .SetBorder (_ee .CellBorderSideBottom ,_gccf ,_caadc );if _gdc !=nil &&*_gdc !=nil {_bdcf .SetSideBorderColor (_ee .CellBorderSideBottom ,*_gdc );};};if _acb :=_dadf .MarLAttr ;_acb !=nil {_ggag =float64 (_bc .FromSTCoordinate32 (*_acb ));
};switch _dadf .AnchorAttr {case _gg .ST_TextAnchoringTypeT :_gedab =_ee .CellVerticalAlignmentTop ;case _gg .ST_TextAnchoringTypeB :_gedab =_ee .CellVerticalAlignmentBottom ;};if _dadf .FillPropertiesChoice .NoFill ==nil {if _dff :=_dadf .FillPropertiesChoice .SolidFill ;
_dff !=nil {_abad ,_cdbd :=_fad .getColorFromSolidFill (_dff );_bdcf .SetOpacity (_cdbd );_bdcf .SetBackgroundColor (_abad );};};if _fafa :=_dadf .MarBAttr ;_fafa !=nil {_bbde =float64 (_bc .FromSTCoordinate32 (*_fafa ));};if _eed :=_dadf .MarTAttr ;_eed !=nil {_ccbd =float64 (_bc .FromSTCoordinate32 (*_eed ));
};};_bdcf .SetVerticalAlignment (_gedab );_bdcf .SetIndent (_ggag );var _cgg float64 ;if _feec :=_dbge .TxBody ;_feec !=nil {_cabdf :=_fad .makePdfDivisionFromTxBody (_feec ,_egcf );_cgg =_cabdf .Height ()+_ccbd +_bbde ;_bdcf .SetContent (_cabdf );};return _cgg ;
};func (_ffdb *convertContext )stretchImage (_cgdcc *_ee .Image ,_fff *_gg .CT_StretchInfoProperties ,_dag ,_cfcf ,_fdg ,_dbe float64 )(*_ee .Image ,float64 ,float64 ){_fgf :=_fff .FillRect ;if _fgf ==nil {_cgde :=_cgdcc .Width ()/_cgdcc .Height ();_gfd :=_fdg /_dbe ;
var _ffdf ,_dba float64 ;if _cgde > _gfd {_dba =_dbe ;_ffdf =_dbe *_cgde ;}else {_ffdf =_fdg ;_dba =_fdg /_cgde ;};_cgdcc .Scale (_ffdf /_cgdcc .Width (),_dba /_cgdcc .Height ());return _cgdcc ,_dag ,_cfcf ;};var _eggc ,_gca ,_fgd ,_fef float64 ;if _abd :=_fgf .LAttr ;
_abd !=nil {_fgd =_bc .FromSTPercentage (_abd );};if _bee :=_fgf .TAttr ;_bee !=nil {_eggc =_bc .FromSTPercentage (_bee );};if _dg :=_fgf .RAttr ;_dg !=nil {_fef =_bc .FromSTPercentage (_dg );};if _eff :=_fgf .BAttr ;_eff !=nil {_gca =_bc .FromSTPercentage (_eff );
};_ddg :=_fdg *(1-_fgd -_fef );_ead :=_dbe *(1-_eggc -_gca );_cgdcc .Scale (_ddg /_cgdcc .Width (),_ead /_cgdcc .Height ());return _cgdcc ,_dag +_fgd *_fdg ,_cfcf +_eggc *_dbe ;};func _abec (_bgf float64 )float64 {return _bgf *_bd .Inch };

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _bc .PageSize ;};func (_fegf *convertContext )makeStyleFromRPr (_cde *_gg .CT_TextCharacterProperties )(*_ee .TextStyle ,bool ,bool ,bool ){var _ccb ,_bbd ,_cabg bool ;_egga :=_fegf ._eec .NewTextStyle ();if _cde !=nil {_deaf :=_bc .FontStyle_Regular ;
_eccb :=_cddd (_cde .BAttr );_aeaa :=_cddd (_cde .IAttr );if _eccb &&_aeaa {_deaf =_bc .FontStyle_BoldItalic ;}else if _eccb {_deaf =_bc .FontStyle_Bold ;}else if _aeaa {_deaf =_bc .FontStyle_Italic ;};_cabg =_cde .UAttr !=_gg .ST_TextUnderlineTypeUnset &&_cde .UAttr !=_gg .ST_TextUnderlineTypeNone ;
_bbg :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _dgdg :=_cde .Latin ;_dgdg !=nil {_bbg =_dgdg .TypefaceAttr ;}else if _caf :=_cde .Ea ;_caf !=nil {_bbg =_caf .TypefaceAttr ;}else if _eaa :=_cde .Cs ;_eaa !=nil {_bbg =_eaa .TypefaceAttr ;}else if _eda :=_cde .Sym ;
_eda !=nil {_bbg =_eda .TypefaceAttr ;};if _cfgf ,_gdf :=_bc .StdFontsMap [_bbg ];_gdf {_egga .Font =_bc .AssignStdFontByName (_egga ,_cfgf [_deaf ]);}else if _eadc :=_bc .GetRegisteredFont (_bbg ,_deaf );_eadc !=nil {_egga .Font =_eadc ;}else {_df .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_bbg ,_deaf );
_egga .Font =_bc .AssignStdFontByName (_egga ,_bc .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_deaf ]);};var _aaa float64 ;if _ebd :=_cde .SzAttr ;_ebd !=nil {_aaa =_ge .Round (float64 (*_ebd )/100)-0.5;}else {_aaa =_bc .DefaultFontSize ;};if _acac :=_cde .BaselineAttr ;
_acac !=nil {if _dab :=_acac .ST_PercentageDecimal ;_dab !=nil {if *_dab > 0{_ccb =true ;}else if *_dab < 0{_bbd =true ;};};};if _ccb ||_bbd {_aaa =_ge .Round (_aaa *0.64);};_egga .FontSize =_aaa ;_deb :=0.0;if _efecc :=_cde .SpcAttr ;_efecc !=nil {if _cfcc :=_efecc .ST_TextPointUnqualified ;
_cfcc !=nil &&*_cfcc > 0{_deb =float64 (*_cfcc )/100;};};_egga .CharSpacing =_deb ;};return &_egga ,_ccb ,_bbd ,_cabg ;};func _cddd (_dgbde *bool )bool {return _dgbde !=nil &&*_dgbde };func (_bga *convertContext )getConnectors (_add *_c .CT_Connector )[]_ee .Drawable {_eee ,_ ,_ ,_ ,_ ,_ ,_ :=_bga .getShapesFromSpPr (_add .SpPr ,_add .Style ,false ,0.0,0.0);
return _eee ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_bc .FontStyle ;func _dfed (_dfc int ,_faaa bool )string {_gbce :=_e .NewBuffer ([]byte {});for _ ,_cgdd :=range _efg {for {if _dfc < _cgdd ._gccff {break ;};_gbce .WriteString (_cgdd ._aff );_dfc -=_cgdd ._gccff ;};};_bcc :=_gbce .String ();
if _faaa {_bcc =_gc .ToUpper (_bcc );};return _bcc ;};func (_ddfc *convertContext )getColorFromFontReference (_gadga *_gg .CT_FontReference )_ee .Color {var _gdg _ee .Color ;var _abf string ;if _bfba :=_gadga .SrgbClr ;_bfba !=nil {_abf =_bfba .ValAttr ;
}else if _gdae :=_gadga .SchemeClr ;_gdae !=nil {_abf =_bc .GetColorStringFromDmlColor (_ddfc ._eadg .GetColorBySchemeColor (_gdae .ValAttr ));_abf =_bc .AdjustColor (_abf ,_gdae .EG_ColorTransform );};if _abf !=""{_gdg =_ee .ColorRGBFromHex ("\u0023"+_abf );
};return _gdg ;};func (_ebec *textboxContext )addTextRun (_ccgb *_gg .EG_TextRun ,_cdef *_gg .CT_TextCharacterProperties ,_egecc _ee .Color ,_bdcg *prefixData ){if _cbg :=_ccgb .TextRunChoice .Br ;_cbg !=nil {_ebec .addCurrentWordToParagraph ();_ebec .newLine ();
_ebec .newWord ();}else if _cdaac :=_ccgb .TextRunChoice .R ;_cdaac !=nil {var _fcfa _ee .Color ;if _cdaac .RPr !=nil &&_cdaac .RPr .FillPropertiesChoice .SolidFill !=nil {_fcfa ,_ =_ebec ._cceb .getColorFromSolidFill (_cdaac .RPr .FillPropertiesChoice .SolidFill );
}else if _egecc !=nil {_fcfa =_egecc ;}else if _cdef .FillPropertiesChoice .SolidFill !=nil {_fcfa ,_ =_ebec ._cceb .getColorFromSolidFill (_cdef .FillPropertiesChoice .SolidFill );}else {_fcfa =_ee .ColorBlack ;};_aade :=_aded (_cdaac .RPr ,_cdef );_baba ,_gcab ,_fec ,_fbeg :=_ebec ._cceb .makeStyleFromRPr (_aade );
_baba .Color =_fcfa ;if _bdcg !=nil {_ebec .addPrefix (_bdcg ,_baba );};_bddc :=_dfb (_cdaac .T );for _ ,_aadfd :=range _bddc {_aadfd ._fcac =_baba ;_aadfd ._fdgc =_gcab ;_aadfd ._dae =_fec ;_aadfd ._bgee =_fbeg ;if _aade .CapAttr ==_gg .ST_TextCapsTypeAll {_aadfd ._gba =_gc .ToUpper (_aadfd ._gba );
};_ebec .addTextSymbol (_aadfd );};};};func _bccb (_bdfb ,_gfb *_gg .CT_TableStyleCellStyle )*_gg .CT_TableStyleCellStyle {_ggef :=_gg .NewCT_TableStyleCellStyle ();if _bdfb !=nil {*_ggef =*_bdfb ;};if _gfb ==nil {return _ggef ;};if _ggef .TcBdr ==nil {_ggef .TcBdr =_gfb .TcBdr ;
}else {if _ggef .TcBdr .Left ==nil {_ggef .TcBdr .Left =_gfb .TcBdr .Left ;};if _ggef .TcBdr .Right ==nil {_ggef .TcBdr .Right =_gfb .TcBdr .Right ;};if _ggef .TcBdr .Top ==nil {_ggef .TcBdr .Top =_gfb .TcBdr .Top ;};if _ggef .TcBdr .Bottom ==nil {_ggef .TcBdr .Bottom =_gfb .TcBdr .Bottom ;
};if _ggef .TcBdr .InsideH ==nil {_ggef .TcBdr .InsideH =_gfb .TcBdr .InsideH ;};if _ggef .TcBdr .InsideV ==nil {_ggef .TcBdr .InsideV =_gfb .TcBdr .InsideV ;};};if _ggef .ThemeableFillStyleChoice .Fill ==nil {_ggef .ThemeableFillStyleChoice .Fill =_gfb .ThemeableFillStyleChoice .Fill ;
};if _ggef .ThemeableFillStyleChoice .FillRef ==nil {_ggef .ThemeableFillStyleChoice .FillRef =_gfb .ThemeableFillStyleChoice .FillRef ;};return _ggef ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _bc .RegisterFontsFromDirectory (dirName )};func (_gb *convertContext )makePdfBlockFromChart (_cc *_a .Chart ,_ga ,_edb float64 )(*_ee .Block ,error ){_fb :=_cc .CT_RelId .IdAttr ;_ff :=_gb ._cbbc .GetChartSpaceByRelId (_fb );
if _ff ==nil {return nil ,_fe .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _gef *_gg .Theme ;_cb :=_gb ._eadg .Themes ();if len (_cb )> 0{_gef =_cb [0];};return _bc .MakeBlockFromChartSpace (_ff ,_ga ,_edb ,_gef );
};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_bf .Presentation )*_ee .Creator {return ConvertToPdfWithOptions (pr ,nil )};func (_fceg *convertContext )getInfoFromLn (_efge *_gg .CT_LineProperties )(_ee .Color ,float64 ,float64 ){if _efge ==nil ||_efge .LineFillPropertiesChoice .NoFill !=nil {return nil ,0,0;
};var _afa float64 ;_cgcc ,_dfad :=_fceg .getColorFromSolidFill (_efge .LineFillPropertiesChoice .SolidFill );if _ggcd :=_efge .WAttr ;_ggcd !=nil {_afa =_bd .FromEMU (int64 (*_ggcd ));}else {_afa =1;};return _cgcc ,_afa ,_dfad ;};func (_egbc *convertContext )getColorFromSolidFill (_gfdc *_gg .CT_SolidColorFillProperties )(_ee .Color ,float64 ){if _gfdc ==nil {return nil ,1;
};var _gabd string ;_bacd :=1.0;if _gcd :=_gfdc .SrgbClr ;_gcd !=nil {_gabd =_gcd .ValAttr ;_bacd =_bc .GetOpacityFromColorTransform (_gcd .EG_ColorTransform );}else if _gaae :=_gfdc .SchemeClr ;_gaae !=nil {_gabd =_bc .GetColorStringFromDmlColor (_egbc ._cbbc .GetColorBySchemeColor (_gaae .ValAttr ));
_gabd =_bc .AdjustColor (_gabd ,_gaae .EG_ColorTransform );_bacd =_bc .GetOpacityFromColorTransform (_gaae .EG_ColorTransform );};if _gabd !=""{_gega :=_ee .ColorRGBFromHex ("\u0023"+_gabd );return _gega ,_bacd ;};return nil ,1;};func (_accb *textboxContext )newLine (){if _accb ._bba ==nil {_accb .newParagraph ();
};_fcee :=_accb ._bba ._cgbb +_accb ._bba ._cffe ;_efb :=&line {};_efb ._ced =_accb ._bba ._eef ;if len (_accb ._bba ._dagf )==0{_efb ._ced +=_accb ._bba ._gggg ;};_efb ._bgbe =_accb ._bba ._fgeb ;_efb ._dge =_efb ._ced ;_efb ._dafc =_fcee ;_accb ._bba ._dagf =append (_accb ._bba ._dagf ,_efb );
_accb ._bbbd =_efb ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_fag .PdfFont ){_bc .RegisterFont (name ,style ,font );};func _ccc (_cedb *_c .CT_CommonSlideData ,_eddb _c .ST_PlaceholderType ,_dccd *uint32 )(*_gg .CT_Transform2D ,*_gg .CT_TextBody ,*bool ,*bool ,*bool ){_baaab :=_dccd ==nil ;
if _cedb !=nil &&(_eddb !=_c .ST_PlaceholderTypeUnset ||!_baaab ){if _gede :=_cedb .SpTree ;_gede !=nil {for _ ,_ebaf :=range _gede .GroupShapeChoice {if _ebaf !=nil {if _ebaf .Sp !=nil {_gdeb ,_gefff :=_dabc (_ebaf .Sp );if _eddb ==_gdeb {if (_baaab &&_gefff ==nil )||(!_baaab &&_gefff !=nil &&*_gefff ==*_dccd ){var _cba *_gg .CT_Transform2D ;
if _ebaf .Sp .SpPr !=nil {_cba =_ebaf .Sp .SpPr .Xfrm ;};_dbebc :=_eddb ==_c .ST_PlaceholderTypeTitle ||_eddb ==_c .ST_PlaceholderTypeCtrTitle ;_dcgb :=_eddb ==_c .ST_PlaceholderTypeSubTitle ;_abfa :=!_dbebc &&_eddb !=_c .ST_PlaceholderTypeUnset ;return _cba ,_ebaf .Sp .TxBody ,&_dbebc ,&_dcgb ,&_abfa ;
};};};};};};};return nil ,nil ,nil ,nil ,nil ;};func _dccgg (_eedb ,_daee *_gg .CT_TablePartStyle )*_gg .CT_TablePartStyle {_adbb :=_gg .NewCT_TablePartStyle ();if _eedb !=nil {*_adbb =*_eedb ;};if _daee ==nil {return _adbb ;};if _adbb .TcTxStyle ==nil {_adbb .TcTxStyle =_daee .TcTxStyle ;
}else {_adbb .TcTxStyle =_cbbd (_adbb .TcTxStyle ,_daee .TcTxStyle );};if _adbb .TcStyle ==nil {_adbb .TcStyle =_daee .TcStyle ;}else {_adbb .TcStyle =_bccb (_adbb .TcStyle ,_daee .TcStyle );};return _adbb ;};func (_ba *convertContext )tileImage (_dbb *_ee .Image ,_gga *_gg .CT_TileInfoProperties ,_feg ,_ecd float64 )*_ee .Image {_fdd ,_egg :=1.0,1.0;
if _cdg :=_gga .SxAttr ;_cdg !=nil {_fdd =_bc .FromSTPercentage (_cdg );};if _bge :=_gga .SyAttr ;_bge !=nil {_egg =_bc .FromSTPercentage (_bge );};_fdc :=_bc .MakeTempCreator (_feg ,_ecd );_dbb .Scale (_fdd ,_egg );_cdf ,_ebg :=_dbb .Width (),_dbb .Height ();
var _gegb ,_fgg float64 ;if _efc :=_gga .TxAttr ;_efc !=nil {_gegb =_bd .FromEMU (_bc .FromSTCoordinate (*_efc ));};if _dcb :=_gga .TyAttr ;_dcb !=nil {_fgg =_bd .FromEMU (_bc .FromSTCoordinate (*_dcb ));};if _gegb > 0{_gegb -=_cdf ;};if _fgg > 0{_fgg -=_ebg ;
};_aefb :=_ba ._dbfd /_cdf +1;_be :=_ba ._feece /_ebg +1;for _bce :=0.0;_bce <=_aefb ;_bce ++{_fbb :=_bce *_cdf ;for _cfd :=0.0;_cfd <=_be ;_cfd ++{_dfd :=_cfd *_ebg ;_dbb .SetPos (_fbb +_gegb ,_dfd +_fgg );_fdc .Draw (_dbb );};};_age ,_geff :=_bc .GetPageFromCreator (_fdc );
if _geff !=nil {_df .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_geff );return nil ;};_gbe ,_geff :=_ec .NewImageDevice ().Render (_age );
if _geff !=nil {_df .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_geff );return nil ;};_ecdg ,_geff :=_ba ._eec .NewImageFromGoImage (_gbe );if _geff !=nil {_df .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_geff );
return nil ;};return _ecdg ;};func (_cbgf *textboxContext )adjustHeights (_dccg float64 ){if _cbgf ._bbbd ._cgff < _dccg {_cbgf ._bba ._cgbb +=(_dccg -_cbgf ._bbbd ._cgff );_cbgf ._bbbd ._cgff =_dccg ;};};func _dbefc (_aafg ,_cdee *_gg .CT_TextBody )(*_gg .CT_TextBodyProperties ,*_gg .CT_TextListStyle ){if _aafg ==nil &&_cdee ==nil {return nil ,nil ;
};if _aafg ==nil {return _cdee .BodyPr ,_cdee .LstStyle ;};if _cdee ==nil {return _aafg .BodyPr ,_aafg .LstStyle ;};_cafd ,_cbed :=_aafg .BodyPr ,_aafg .LstStyle ;_daa ,_eefd :=_cdee .BodyPr ,_cdee .LstStyle ;_cdddf :=_ecge (_cafd ,_daa );_ccab :=_bbe (_cbed ,_eefd );
return _cdddf ,_ccab ;};func (_efd *convertContext )makePdfBlockFromTxBody (_acda *_gg .CT_TextBody ,_acae *_gg .CT_TextBodyProperties ,_bac *_gg .CT_TextListStyle ,_cdgf ,_eccg float64 ,_bfb _ee .Color ,_eaee ,_ggd bool )(*_ee .Block ,error ){var _gfg *_gg .CT_TextParagraphProperties ;
if _aba :=_acda .LstStyle ;_aba !=nil {var _gaf *_gg .CT_TextParagraphProperties ;if _aba .Lvl1pPr !=nil {_gaf =_aba .Lvl1pPr ;};_gfg =_cacd (_gaf ,_aba .DefPPr );};var _eag *_gg .CT_TextParagraphProperties ;if _gfg !=nil {if _eaee {_eag =_efd ._acdg [0];
}else if _ggd {_eag =_efd ._eabbf [0];}else {_eag =_efd ._cgef [0];};if _bac !=nil {_eag =_cacd (_cacd (_bac .Lvl1pPr ,_bac .DefPPr ),_eag );};_eag =_cacd (_gfg ,_eag );}else {if _eaee {_eag =_efd ._ddda ;}else if _ggd {_eag =_efd ._afea ;}else {_eag =_efd ._ggdf ;
};};_aebc ,_cffd :=_aged (2.5),_aged (2.5);_cacc ,_cbe :=_aged (1.3),_aged (1.3);_bbfc :=true ;_egcg :=_gg .ST_TextAnchoringTypeT ;if _acae !=nil {if _gag :=_acae .AnchorAttr ;_gag !=_gg .ST_TextAnchoringTypeUnset {_egcg =_gag ;};};if _cbb :=_acda .BodyPr ;
_cbb !=nil {if _ffddf :=_cbb .LInsAttr ;_ffddf !=nil {_aebc =_bd .FromEMU (_bc .FromSTCoordinate32 (*_ffddf ));};if _ddd :=_cbb .TInsAttr ;_ddd !=nil {_cacc =_bd .FromEMU (_bc .FromSTCoordinate32 (*_ddd ));};if _gad :=_cbb .RInsAttr ;_gad !=nil {_cffd =_bd .FromEMU (_bc .FromSTCoordinate32 (*_gad ));
};if _ccfg :=_cbb .BInsAttr ;_ccfg !=nil {_cbe =_bd .FromEMU (_bc .FromSTCoordinate32 (*_ccfg ));};_bbfc =_cbb .WrapAttr !=_gg .ST_TextWrappingTypeNone ;if _adb :=_cbb .AnchorAttr ;_adb !=_gg .ST_TextAnchoringTypeUnset {_egcg =_cbb .AnchorAttr ;};};_gbb :=_bc .MakeTempCreator (_cdgf ,_eccg );
_gbb .SetPageMargins (_aebc ,_cffd ,_cacc ,_cbe );_eggd :=&textboxContext {_cceb :_efd ,_dce :_bbfc ,_afgc :_cdgf -_aebc -_cffd ,_dgdf :_eccg -_cacc -_cbe ,_cagf :_gbb ,_bea :[]*paragraph {}};_egee :=1;for _ ,_deg :=range _acda .P {if _deg !=nil {_agd :=_deg .PPr ;
var _bfbb *prefixData ;if _agd !=nil &&_agd .TextBulletChoice .BuNone ==nil {var _bfg string ;var _ffege bool ;if _bfea :=_agd .TextBulletChoice .BuAutoNum ;_bfea !=nil {var _cgf string ;if _ffaf :=_bfea .StartAtAttr ;_ffaf !=nil {_egee =int (*_ffaf );
};var _aeeb string ;switch _bfea .TypeAttr {case _gg .ST_TextAutonumberSchemeAlphaUcParenBoth ,_gg .ST_TextAutonumberSchemeAlphaUcParenR ,_gg .ST_TextAutonumberSchemeAlphaUcPeriod :_aeeb =_geffd (_egee ,true );case _gg .ST_TextAutonumberSchemeAlphaLcParenBoth ,_gg .ST_TextAutonumberSchemeAlphaLcParenR ,_gg .ST_TextAutonumberSchemeAlphaLcPeriod :_aeeb =_geffd (_egee ,false );
case _gg .ST_TextAutonumberSchemeRomanUcParenBoth ,_gg .ST_TextAutonumberSchemeRomanUcParenR ,_gg .ST_TextAutonumberSchemeRomanUcPeriod :_aeeb =_dfed (_egee ,true );case _gg .ST_TextAutonumberSchemeRomanLcParenBoth ,_gg .ST_TextAutonumberSchemeRomanLcParenR ,_gg .ST_TextAutonumberSchemeRomanLcPeriod :_aeeb =_dfed (_egee ,false );
default:_aeeb =_d .Itoa (_egee );};switch _bfea .TypeAttr {case _gg .ST_TextAutonumberSchemeAlphaLcPeriod ,_gg .ST_TextAutonumberSchemeAlphaUcPeriod ,_gg .ST_TextAutonumberSchemeArabicPeriod ,_gg .ST_TextAutonumberSchemeRomanLcPeriod ,_gg .ST_TextAutonumberSchemeRomanUcPeriod ,_gg .ST_TextAutonumberSchemeArabicDbPeriod ,_gg .ST_TextAutonumberSchemeEa1ChsPeriod ,_gg .ST_TextAutonumberSchemeEa1ChtPeriod ,_gg .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_gg .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_gg .ST_TextAutonumberSchemeThaiAlphaPeriod ,_gg .ST_TextAutonumberSchemeThaiNumPeriod ,_gg .ST_TextAutonumberSchemeHindiAlphaPeriod ,_gg .ST_TextAutonumberSchemeHindiNumPeriod ,_gg .ST_TextAutonumberSchemeHindiAlpha1Period :_cgf ="\u002e";
case _gg .ST_TextAutonumberSchemeAlphaLcParenR ,_gg .ST_TextAutonumberSchemeAlphaUcParenR ,_gg .ST_TextAutonumberSchemeArabicParenR ,_gg .ST_TextAutonumberSchemeRomanLcParenR ,_gg .ST_TextAutonumberSchemeRomanUcParenR ,_gg .ST_TextAutonumberSchemeThaiAlphaParenR ,_gg .ST_TextAutonumberSchemeThaiNumParenR ,_gg .ST_TextAutonumberSchemeHindiNumParenR :_cgf ="\u0029";
};_bfg =_aeeb +_cgf ;_egee ++;}else if _abaa :=_agd .TextBulletChoice .BuChar ;_abaa !=nil {_cgb :=_abaa .CharAttr ;if _gebfd ,_fcb :=_ceag [_cgb ];_fcb {_cgb =string (rune (_gebfd ));}else {_cgb ="\u2022";};_bfg =_cgb ;_ffege =true ;};if _bfg !=""{var _gfdg ,_dgd float64 ;
if _agd .MarLAttr !=nil {_gfdg =_bd .FromEMU (int64 (*_agd .MarLAttr ));};if _agd .IndentAttr !=nil {_dgd =_bd .FromEMU (int64 (*_agd .IndentAttr ));};_bfbb =&prefixData {_dbdb :_bfg ,_fbba :_ffege ,_cbeb :_gfdg ,_dfg :_dgd };};};_agd =_cacd (_agd ,_eag );
_beeb :=_aded (_deg .EndParaRPr ,_agd .DefRPr );_eggd .newParagraph ();_eggd .assignPropsToCurrentParagraph (_agd );_eggd .newLine ();_eggd .newWord ();for _ffc ,_fedf :=range _deg .EG_TextRun {_eggd .addTextRun (_fedf ,_beeb ,_bfb ,_bfbb );if _ffc > 0{_bfbb =nil ;
};};_eggd .addCurrentWordToParagraph ();};_eggd .addCurrentParagraph ();};_eggd .alignVertically (_egcg );_eggd .drawParagraphs ();return _bc .MakeBlockFromCreator (_gbb );};func (_ceff *textboxContext )alignParagraph (){_eged :=_ceff ._bba ;if _eged ._adcc ==_gg .ST_TextAlignTypeL {return ;
};_gdff :=len (_eged ._dagf )-1;for _dbgd ,_gaba :=range _eged ._dagf {_gdfb :=true ;_fagb :=len (_gaba ._ddbg );_eebc :=0.0;for _feeb :=len (_gaba ._ddbg )-1;_feeb >=0;_feeb --{_egfb :=_gaba ._ddbg [_feeb ];if _gdfb &&_egfb ._cefg {_fagb =_feeb ;}else {_gdfb =false ;
for _ ,_babe :=range _egfb ._fabea {_eebc +=_babe ._cbde ;};};};_gaba ._ddbg =_gaba ._ddbg [:_fagb ];_fdfg :=_gaba ._bgbe -_gaba ._ced -_eebc ;switch _eged ._adcc {case _gg .ST_TextAlignTypeR :_gaba .moveRight (_fdfg );case _gg .ST_TextAlignTypeCtr :_gaba .moveRight (_fdfg /2);
case _gg .ST_TextAlignTypeJust :if _dbgd !=_gdff {_fgb :=[]*word {};for _ ,_adgb :=range _gaba ._ddbg {if _adgb ._cefg {_fgb =append (_fgb ,_adgb );};};_eabec :=_fdfg /float64 (len (_fgb ));for _ ,_dabd :=range _fgb {_dabd ._bcge +=_eabec ;};var _dfbc *word ;
for _ ,_caba :=range _gaba ._ddbg {if _dfbc !=nil {_caba ._bddb =_dfbc ._bddb +_dfbc ._bcge ;};_dfbc =_caba ;};};};};};func (_gcef *convertContext )getColorFromMatrixReference (_fcg *_gg .CT_StyleMatrixReference )_ee .Color {if _fcg ==nil {return nil ;
};var _ebfa _ee .Color ;var _befa string ;if _efcc :=_fcg .SrgbClr ;_efcc !=nil {_befa =_efcc .ValAttr ;}else if _abdc :=_fcg .SchemeClr ;_abdc !=nil {_befa =_bc .GetColorStringFromDmlColor (_gcef ._eadg .GetColorBySchemeColor (_abdc .ValAttr ));_befa =_bc .AdjustColor (_befa ,_abdc .EG_ColorTransform );
};if _befa !=""{_ebfa =_ee .ColorRGBFromHex ("\u0023"+_befa );};return _ebfa ;};type convertContext struct{_eec *_ee .Creator ;_dbec *_bc .Rectangle ;_eadg *_bf .Presentation ;_cbbc *_bf .Slide ;_bbbfd *_c .SldMaster ;_eeg *_c .SldLayout ;_feece float64 ;
_dbfd float64 ;_cdc []_ee .Drawable ;_gagd *background ;_ggdf *_gg .CT_TextParagraphProperties ;_eabba *_gg .CT_TextCharacterProperties ;_ddda *_gg .CT_TextParagraphProperties ;_cdcf *_gg .CT_TextCharacterProperties ;_afea *_gg .CT_TextParagraphProperties ;
_afd *_gg .CT_TextCharacterProperties ;_cgef []*_gg .CT_TextParagraphProperties ;_acdg []*_gg .CT_TextParagraphProperties ;_eabbf []*_gg .CT_TextParagraphProperties ;_gcb *_gg .Theme ;_gade *_gg .CT_ColorMappingOverride ;};func _cccb (_caag *_gg .CT_TableCellProperties ,_cgefb *_gg .CT_TableStyleCellStyle ,_fecg ,_gfcd ,_fdcb ,_eafg bool )*_gg .CT_TableCellProperties {_aagg :=_gg .NewCT_TableCellProperties ();
if _caag !=nil {*_aagg =*_caag ;};if _cgefb ==nil {return _aagg ;};if _edfd :=_cgefb .ThemeableFillStyleChoice .FillRef ;_edfd !=nil {_ebda :=_gg .NewCT_SolidColorFillProperties ();_ebda .ScrgbClr =_edfd .ScrgbClr ;_ebda .SrgbClr =_edfd .SrgbClr ;_ebda .HslClr =_edfd .HslClr ;
_ebda .SysClr =_edfd .SysClr ;_ebda .SchemeClr =_edfd .SchemeClr ;_ebda .PrstClr =_edfd .PrstClr ;_aagg .FillPropertiesChoice .SolidFill =_ebda ;};if _aagg .FillPropertiesChoice .NoFill ==nil &&_aagg .FillPropertiesChoice .SolidFill ==nil {if _cgcd :=_cgefb .ThemeableFillStyleChoice .Fill ;
_cgcd !=nil {if _aagg .FillPropertiesChoice .NoFill ==nil {_aagg .FillPropertiesChoice .NoFill =_cgcd .FillPropertiesChoice .NoFill ;};if _aagg .FillPropertiesChoice .SolidFill ==nil {_aagg .FillPropertiesChoice .SolidFill =_cgcd .FillPropertiesChoice .SolidFill ;
};};};if _afab :=_cgefb .TcBdr ;_afab !=nil {if _aagg .LnL ==nil {var _bdbf *_gg .CT_ThemeableLineStyle ;if _fdcb {_bdbf =_afab .Left ;}else {_bdbf =_afab .InsideV ;};if _bdbf !=nil {_aagg .LnL =_bdbf .ThemeableLineStyleChoice .Ln ;};};if _aagg .LnR ==nil {var _cageb *_gg .CT_ThemeableLineStyle ;
if _eafg {_cageb =_afab .Right ;}else {_cageb =_afab .InsideV ;};if _cageb !=nil {_aagg .LnR =_cageb .ThemeableLineStyleChoice .Ln ;};};if _aagg .LnT ==nil {var _aeae *_gg .CT_ThemeableLineStyle ;if _fecg {_aeae =_afab .Top ;}else {_aeae =_afab .InsideH ;
};if _aeae !=nil {_aagg .LnT =_aeae .ThemeableLineStyleChoice .Ln ;};};if _aagg .LnB ==nil {var _accd *_gg .CT_ThemeableLineStyle ;if _gfcd {_accd =_afab .Bottom ;}else {_accd =_afab .InsideH ;};if _accd !=nil {_aagg .LnB =_accd .ThemeableLineStyleChoice .Ln ;
};};};return _aagg ;};type prefixData struct{_dbdb string ;_fbba bool ;_cbeb float64 ;_dfg float64 ;};func (_cgda *convertContext )getShapeFromBlipFill (_dagac *_gg .CT_BlipFillProperties ,_afgb ,_gedb ,_gegf ,_febf float64 ,_cgeg bool )_ee .Drawable {_acdb ,_feabc ,_cfe :=_cgda .makePdfImageFromBlipFill (_dagac ,_cgeg );
if _cfe !=nil {_df .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_cfe );
return nil ;};if _acdb ==nil {return nil ;};if _gdcb :=_dagac .FillModePropertiesChoice .Tile ;_gdcb !=nil {_acdb =_cgda .tileImage (_acdb ,_dagac .FillModePropertiesChoice .Tile ,_gegf ,_febf );};if _geaf :=_dagac .FillModePropertiesChoice .Stretch ;_geaf !=nil {_acdb ,_afgb ,_gedb =_cgda .stretchImage (_acdb ,_dagac .FillModePropertiesChoice .Stretch ,_afgb ,_gedb ,_gegf ,_febf );
};if _acdb ==nil {return nil ;};if len (_feabc )==0{_acdb .SetPos (_afgb ,_gedb );return _acdb ;};_acdb =_cgda .applyBlipEffectsOnImg (_acdb ,_afgb ,_gedb ,_feabc );_acdb .SetPos (_afgb ,_gedb );return _acdb ;};func (_eeee *convertContext )makePdfDivisionFromTxBody (_bcbg *_gg .CT_TextBody ,_abe *_gg .CT_TableStyleTextStyle )*_ee .Division {_cacf :=_eeee ._eec .NewDivision ();
_agb :=_eeee ._ggdf ;_eab :=_gg .ST_TextAnchoringTypeT ;if _ddc :=_bcbg .BodyPr ;_ddc !=nil {if _bdd :=_ddc .AnchorAttr ;_bdd !=_gg .ST_TextAnchoringTypeUnset {_eab =_ddc .AnchorAttr ;};};if _gdd :=_bcbg .LstStyle ;_gdd !=nil {var _ebb *_gg .CT_TextParagraphProperties ;
if _gdd .Lvl1pPr !=nil {_ebb =_gdd .Lvl1pPr ;}else {_ebb =_eeee ._cgef [0];};_agb =_cacd (_ebb ,_cacd (_gdd .DefPPr ,_agb ));};for _ ,_cdgb :=range _bcbg .P {if _cdgb !=nil {_bbf :=_eeee ._eec .NewStyledParagraph ();_dgc :=_cacd (_cdgb .PPr ,_agb );_dec :=_aded (_cdgb .EndParaRPr ,_dgc .DefRPr );
switch _dgc .AlgnAttr {case _gg .ST_TextAlignTypeR :_bbf .SetTextAlignment (_ee .TextAlignmentRight );case _gg .ST_TextAlignTypeCtr :_bbf .SetTextAlignment (_ee .TextAlignmentCenter );case _gg .ST_TextAlignTypeJust :_bbf .SetTextAlignment (_ee .TextAlignmentJustify );
};if len (_cdgb .EG_TextRun )==0{_bbf .Append ("\u000a");_cacf .Add (_bbf );continue ;};for _ ,_bed :=range _cdgb .EG_TextRun {if _cca :=_bed .TextRunChoice .Br ;_cca !=nil {_bbf .Append ("\u000a");}else if _fbbd :=_bed .TextRunChoice .R ;_fbbd !=nil {_cab :=_acdga (_fbbd .RPr ,_abe );
_cab =_aded (_cab ,_dec );var _eggb _ee .Color ;if _cab .FillPropertiesChoice .SolidFill !=nil {_eggb ,_ =_eeee .getColorFromSolidFill (_cab .FillPropertiesChoice .SolidFill );}else {_eggb =_ee .ColorBlack ;};_dac ,_dbeb ,_aege ,_ :=_eeee .makeStyleFromRPr (_cab );
_dac .Color =_eggb ;if _dbeb {_dac .TextRise =0.5;}else if _aege {_dac .TextRise =-0.5;};_eaf :=_fbbd .T ;if _cab .CapAttr ==_gg .ST_TextCapsTypeAll {for _ ,_bbb :=range _eaf {_bbb =[]rune (_gc .ToUpper (string (_bbb )))[0];};};_bbbf :=_bbf .Append (_eaf );
_bbbf .Style =*_dac ;};};_ =_eab ;_cacf .Add (_bbf );};};return _cacf ;};func (_bgc *textboxContext )newParagraph (){_gfc :=&paragraph {};_gfc ._ffbb =_bgc ._fdbe ;_bgc ._bba =_gfc ;};func (_af *convertContext )drawSlide (){_af ._eec .NewPage ();for _ ,_ace :=range _af ._cdc {if _ace !=nil {_af ._eec .MoveTo (0,0);
_af ._eec .Draw (_ace );};};};func (_acfb *textboxContext )alignSymbolsVertically (){for _ ,_gadgd :=range _acfb ._bea {for _ ,_fcba :=range _gadgd ._dagf {_cdd :=0.0;for _ ,_ggfe :=range _fcba ._ddbg {for _ ,_addg :=range _ggfe ._fabea {if _addg ._fdbf > _cdd {_cdd =_addg ._fdbf ;
};};};for _ ,_cae :=range _fcba ._ddbg {for _ ,_bdab :=range _cae ._fabea {if _bdab ._fde < _cdd {_bdab ._cfade =_cdd -_bdab ._fde ;};};};};};};func _dbde (_ecfa *_gg .CT_AdjPoint2D )(float64 ,float64 ){var _acgf ,_fegef float64 ;_bcdd ,_gac :=_ecfa .XAttr ,_ecfa .YAttr ;
if _daga :=_bcdd .ST_Coordinate ;_daga !=nil {_acgf =_bd .FromEMU (_bc .FromSTCoordinate (*_daga ));};if _edbf :=_gac .ST_Coordinate ;_edbf !=nil {_fegef =_bd .FromEMU (_bc .FromSTCoordinate (*_edbf ));};return _acgf ,_fegef ;};func _dabc (_ggda *_c .CT_Shape )(_c .ST_PlaceholderType ,*uint32 ){if _eabd :=_ggda .NvSpPr ;
_eabd !=nil {if _ddag :=_eabd .NvPr ;_ddag !=nil {if _ecbgd :=_ddag .Ph ;_ecbgd !=nil {return _ecbgd .TypeAttr ,_ecbgd .IdxAttr ;};};};return _c .ST_PlaceholderTypeUnset ,nil ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;
FontStyle_BoldItalic FontStyle =3;);var _ceag =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};type textboxContext struct{_cceb *convertContext ;_afgc float64 ;_dgdf float64 ;_cagf *_ee .Creator ;_fdbe float64 ;_bea []*paragraph ;_bba *paragraph ;
_bbbd *line ;_cfde *word ;_dce bool ;};func (_gd *convertContext )getShapes (_ggaf *_c .CT_Shape ,_edc bool ,_efcg bool )[]_ee .Drawable {_fbaf :=[]_ee .Drawable {};_ffe :=_ggaf .SpPr ;if _ffe ==nil {return _fbaf ;};var _geda bool ;if _beg :=_ggaf .UseBgFillAttr ;
_beg !=nil {_geda =*_beg ;};_ccg ,_beb ,_fcaf ,_abg ,_cda ,_cag ,_bcgc :=_gd .getShapesFromSpPr (_ffe ,_ggaf .Style ,_geda ,0.0,0.0);if !_efcg {_fbaf =append (_fbaf ,_ccg ...);};if _dfdf :=_ggaf .TxBody ;_dfdf !=nil &&!_edc {_gee ,_cfg ,_fda ,_afb ,_ecf ,_dcga :=_gd .getPhData (_ggaf );
if _efcg &&!(_afb ||_ecf ){return _fbaf ;};if _gee !=nil &&!_bcgc {_beb ,_fcaf ,_abg ,_cda =_bc .GetDataFromXfrm (_gee );};_bab ,_cef :=_gd .makePdfBlockFromTxBody (_dfdf ,_cfg ,_fda ,_abg ,_cda ,_cag ,_afb ,_dcga );if _cef !=nil {_df .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_cef );
}else if _bab !=nil {_bab .SetPos (_beb ,_fcaf );_fbaf =append (_fbaf ,_bab );};};return _fbaf ;};func (_adef *convertContext )getPhData (_aebgg *_c .CT_Shape )(*_gg .CT_Transform2D ,*_gg .CT_TextBodyProperties ,*_gg .CT_TextListStyle ,bool ,bool ,bool ){_cbgd ,_cgdef :=_dabc (_aebgg );
_ageb ,_gdee ,_agbd ,_eea ,_cdgfb :=_ccc (_adef ._bbbfd .CSld ,_cbgd ,_cgdef );_cdge ,_cbf ,_dda ,_fffe ,_dggb :=_ccc (_adef ._eeg .CSld ,_cbgd ,_cgdef );if _cdge ==nil {_cdge =_ageb ;};_gabb ,_edcb :=_dbefc (_cbf ,_gdee );var _dga ,_gfa ,_ccea bool ;if _dda ==nil {if _agbd !=nil {_dga =*_agbd ;
};}else {_dga =*_dda ;};if _dggb ==nil {if _cdgfb !=nil {_ccea =*_cdgfb ;};}else {_ccea =*_dggb ;};if _fffe ==nil {if _eea !=nil {_gfa =*_eea ;};}else {_gfa =*_fffe ;};return _cdge ,_gabb ,_edcb ,_dga ,_gfa ,_ccea ;};func _acdga (_dagae *_gg .CT_TextCharacterProperties ,_fcgf *_gg .CT_TableStyleTextStyle )*_gg .CT_TextCharacterProperties {_ggb :=_gg .NewCT_TextCharacterProperties ();
if _dagae !=nil {*_ggb =*_dagae ;};if _fcgf ==nil {return _ggb ;};if _ggb .BAttr ==nil &&_fcgf .BAttr !=_gg .ST_OnOffStyleTypeUnset {_fgga :=_fcgf .BAttr ==_gg .ST_OnOffStyleTypeOn ;_ggb .BAttr =&_fgga ;};if _ggb .IAttr ==nil &&_fcgf .IAttr !=_gg .ST_OnOffStyleTypeUnset {_gcdc :=_fcgf .IAttr ==_gg .ST_OnOffStyleTypeOn ;
_ggb .IAttr =&_gcdc ;};if _ggb .FillPropertiesChoice .NoFill ==nil &&_ggb .FillPropertiesChoice .SolidFill ==nil {_ggb .FillPropertiesChoice .SolidFill =_gg .NewCT_SolidColorFillProperties ();_ggb .FillPropertiesChoice .SolidFill .ScrgbClr =_fcgf .ScrgbClr ;
_ggb .FillPropertiesChoice .SolidFill .SrgbClr =_fcgf .SrgbClr ;_ggb .FillPropertiesChoice .SolidFill .HslClr =_fcgf .HslClr ;_ggb .FillPropertiesChoice .SolidFill .SysClr =_fcgf .SysClr ;_ggb .FillPropertiesChoice .SolidFill .SchemeClr =_fcgf .SchemeClr ;
_ggb .FillPropertiesChoice .SolidFill .PrstClr =_fcgf .PrstClr ;};if _gagg :=_fcgf .ThemeableFontStylesChoice .Font ;_gagg !=nil &&_ggb .Latin ==nil &&_ggb .Ea ==nil &&_ggb .Cs ==nil {_ggb .Latin =_gagg .Latin ;_ggb .Ea =_gagg .Ea ;_ggb .Cs =_gagg .Cs ;
};return _ggb ;};func (_fdfb *convertContext )renderCurrentStateToGoImage ()(_g .Image ,error ){_egdb :=_bc .MakeTempCreator (_fdfb ._dbfd ,_fdfb ._feece );_egdb .NewPage ();for _ ,_afdg :=range _fdfb ._cdc {if _afdg !=nil {_egdb .MoveTo (0,0);_egdb .Draw (_afdg );
};};_fced ,_afcg :=_bc .GetPageFromCreator (_egdb );if _afcg !=nil {return nil ,_afcg ;};return _ec .NewImageDevice ().Render (_fced );};type word struct{_fabea []*symbol ;_bddb float64 ;_bcge float64 ;_cefg bool ;};func (_aed *textboxContext )addTextSymbol (_gadf *symbol ){_aadb :=_ee .New ();
_bef :=_aadb .NewStyledParagraph ();_bef .SetMargins (0,0,0,0);_acba :=_bef .Append (_gadf ._gba );_cafe :=0.0;if _gadf ._fcac !=nil {_acba .Style =*_gadf ._fcac ;if _gadf ._fcac .CharSpacing !=0{_cafe =_gadf ._fcac .CharSpacing ;};};_gadf ._fde =_bef .Height ();
_gadf ._fdbf =_bef .Height ()*1.2;if _gadf ._cbde ==0{_gadf ._cbde =_bef .Width ()+_cafe ;};if len (_aed ._cfde ._fabea )> 0{_dadfa :=_aed ._cfde ._fabea [len (_aed ._cfde ._fabea )-1]._gba ;if _aed ._bba ._ffcf ||_bc .IsNoSpaceLanguage (_dadfa )||(_dadfa =="\u0020")!=(_gadf ._gba =="\u0020"){_aed .addCurrentWordToParagraph ();
_aed .newWord ();};};_aed ._cfde ._fabea =append (_aed ._cfde ._fabea ,_gadf );_gadf ._ggcg =_aed ._cfde ._bcge ;_aed ._cfde ._bcge +=_gadf ._cbde ;if _gadf ._gba !="\u0020"{_aed ._cfde ._cefg =false ;};if _aed ._cfde ._bcge >=_aed ._bba ._fgeb -_aed ._bba ._eef {_aed .addCurrentWordToParagraph ();
_aed .newLine ();_aed .newWord ();};};func (_ecb *convertContext )extractDefaultProperties (){_edf :=_ecb ._eadg .X ();_geb :=_edf .DefaultTextStyle ;var _gec ,_da ,_ad ,_fac ,_bg ,_bdc ,_eb ,_eca ,_fed ,_gce *_gg .CT_TextParagraphProperties ;if _geb !=nil {_gec =_geb .DefPPr ;
_da =_cacd (_geb .Lvl1pPr ,_gec );_ad =_cacd (_geb .Lvl2pPr ,_gec );_fac =_cacd (_geb .Lvl3pPr ,_gec );_bg =_cacd (_geb .Lvl4pPr ,_gec );_bdc =_cacd (_geb .Lvl5pPr ,_gec );_eb =_cacd (_geb .Lvl6pPr ,_gec );_eca =_cacd (_geb .Lvl7pPr ,_gec );_fed =_cacd (_geb .Lvl8pPr ,_gec );
_gce =_cacd (_geb .Lvl9pPr ,_gec );_ecb ._ggdf =_gec ;_ecb ._eabba =_gec .DefRPr ;};_ecb ._cgef =make ([]*_gg .CT_TextParagraphProperties ,9);_ecb ._cgef [0]=_da ;_ecb ._cgef [1]=_ad ;_ecb ._cgef [2]=_fac ;_ecb ._cgef [3]=_bg ;_ecb ._cgef [4]=_bdc ;_ecb ._cgef [5]=_eb ;
_ecb ._cgef [6]=_eca ;_ecb ._cgef [7]=_fed ;_ecb ._cgef [8]=_gce ;_cd :=_ecb ._eadg .SlideMasters ()[0].X ();_ae :=_cd .TxStyles ;_aeb :=_ae .TitleStyle ;_ecb ._ddda =_cacd (_aeb .DefPPr ,_gec );_ecb ._cdcf =_ecb ._ddda .DefRPr ;_ecb ._acdg =make ([]*_gg .CT_TextParagraphProperties ,9);
_ecb ._acdg [0]=_cacd (_aeb .Lvl1pPr ,_da );_ecb ._acdg [1]=_cacd (_aeb .Lvl2pPr ,_ad );_ecb ._acdg [2]=_cacd (_aeb .Lvl3pPr ,_fac );_ecb ._acdg [3]=_cacd (_aeb .Lvl4pPr ,_bg );_ecb ._acdg [4]=_cacd (_aeb .Lvl5pPr ,_bdc );_ecb ._acdg [5]=_cacd (_aeb .Lvl6pPr ,_eb );
_ecb ._acdg [6]=_cacd (_aeb .Lvl7pPr ,_eca );_ecb ._acdg [7]=_cacd (_aeb .Lvl8pPr ,_fed );_ecb ._acdg [8]=_cacd (_aeb .Lvl9pPr ,_gce );_bcg :=_ae .BodyStyle ;_ecb ._afea =_cacd (_bcg .DefPPr ,_gec );_ecb ._afd =_ecb ._afea .DefRPr ;_ecb ._eabbf =make ([]*_gg .CT_TextParagraphProperties ,9);
_ecb ._eabbf [0]=_cacd (_bcg .Lvl1pPr ,_da );_ecb ._eabbf [1]=_cacd (_bcg .Lvl2pPr ,_ad );_ecb ._eabbf [2]=_cacd (_bcg .Lvl3pPr ,_fac );_ecb ._eabbf [3]=_cacd (_bcg .Lvl4pPr ,_bg );_ecb ._eabbf [4]=_cacd (_bcg .Lvl5pPr ,_bdc );_ecb ._eabbf [5]=_cacd (_bcg .Lvl6pPr ,_eb );
_ecb ._eabbf [6]=_cacd (_bcg .Lvl7pPr ,_eca );_ecb ._eabbf [7]=_cacd (_bcg .Lvl8pPr ,_fed );_ecb ._eabbf [8]=_cacd (_bcg .Lvl9pPr ,_gce );};func (_cced *convertContext )makeSlide (){_ddb :=_cced ._cbbc .GetSlideLayout ().CSld ;_cced .addShapes (_ddb ,true );
_ddb =_cced ._cbbc .X ().CSld ;_cced .addShapes (_ddb ,false );};func (_ege *convertContext )getGroupConnectors (_begb *_c .CT_Connector ,_dbeg float64 ,_fgc float64 )[]_ee .Drawable {_bdcc ,_ ,_ ,_ ,_ ,_ ,_ :=_ege .getShapesFromSpPr (_begb .SpPr ,_begb .Style ,false ,_dbeg ,_fgc );
return _bdcc ;};func _cbbd (_cffa ,_fbf *_gg .CT_TableStyleTextStyle )*_gg .CT_TableStyleTextStyle {_aagf :=_gg .NewCT_TableStyleTextStyle ();if _cffa !=nil {*_aagf =*_cffa ;};if _fbf ==nil {return _aagf ;};if _aagf .BAttr ==_gg .ST_OnOffStyleTypeUnset {_aagf .BAttr =_fbf .BAttr ;
};if _aagf .IAttr ==_gg .ST_OnOffStyleTypeUnset {_aagf .IAttr =_fbf .IAttr ;};if _aagf .ThemeableFontStylesChoice .Font ==nil {_aagf .ThemeableFontStylesChoice .Font =_fbf .ThemeableFontStylesChoice .Font ;};if _aagf .ThemeableFontStylesChoice .FontRef ==nil {_aagf .ThemeableFontStylesChoice .FontRef =_fbf .ThemeableFontStylesChoice .FontRef ;
};if _aagf .ScrgbClr ==nil {_aagf .ScrgbClr =_fbf .ScrgbClr ;};if _aagf .SrgbClr ==nil {_aagf .SrgbClr =_fbf .SrgbClr ;};if _aagf .HslClr ==nil {_aagf .HslClr =_fbf .HslClr ;};if _aagf .SysClr ==nil {_aagf .SysClr =_fbf .SysClr ;};if _aagf .SchemeClr ==nil {_aagf .SchemeClr =_fbf .SchemeClr ;
};if _aagf .PrstClr ==nil {_aagf .PrstClr =_fbf .PrstClr ;};return _aagf ;};func (_afeac *textboxContext )assignPropsToCurrentParagraph (_cga *_gg .CT_TextParagraphProperties ){_gafb :=12.4;if _cga ==nil {_afeac ._bba ._beebe =_gafb ;return ;};if _eadd :=_cga .DefRPr ;
_eadd !=nil {_agbe :=_eadd .SzAttr ;if _agbe !=nil {_cad :=float64 (*_agbe )/1200;if _gafb <=_cad {_gafb =_cad ;};};};if _feab :=_cga .MarLAttr ;_feab !=nil {_afeac ._bba ._eef =_bd .FromEMU (int64 (*_feab ));};_afeac ._bba ._fgeb =_afeac ._afgc ;if _aadf :=_cga .MarRAttr ;
_aadf !=nil {_afeac ._bba ._fgeb -=_bd .FromEMU (int64 (*_aadf ));};if _ccad :=_cga .IndentAttr ;_ccad !=nil {_afeac ._bba ._gggg =_bd .FromEMU (int64 (*_ccad ));};if _cegg :=_cga .LatinLnBrkAttr ;_cegg !=nil {_afeac ._bba ._ffcf =*_cegg ;};if _bgd :=_cga .LnSpc ;
_bgd !=nil &&_bgd .TextSpacingChoice !=nil {if _facb :=_bgd .TextSpacingChoice .SpcPct ;_facb !=nil {if _fdf :=_facb .ValAttr .ST_TextSpacingPercent ;_fdf !=nil {_gafb =float64 (*_fdf )/5000;};};};var _dbfg float64 ;if _cfag :=_cga .SpcBef ;_cfag !=nil &&_cfag .TextSpacingChoice !=nil {if _gbcd :=_cfag .TextSpacingChoice .SpcPts ;
_gbcd !=nil {_dbfg =float64 (_gbcd .ValAttr )/100;};};_ade :=_afeac ._bea ;if len (_ade )> 0{_dbfg -=_ade [len (_ade )-1]._ecfb ;if _dbfg < 0{_dbfg =0;};};_afeac ._bba ._cffe =_dbfg ;if _acgg :=_cga .SpcAft ;_acgg !=nil &&_acgg .TextSpacingChoice !=nil {if _bcga :=_acgg .TextSpacingChoice .SpcPts ;
_bcga !=nil {_afeac ._bba ._ecfb =float64 (_bcga .ValAttr )/100;};};_afeac ._bba ._beebe =_gafb ;_afeac ._bba ._adcc =_cga .AlgnAttr ;};func _aded (_bcag ,_agec *_gg .CT_TextCharacterProperties )*_gg .CT_TextCharacterProperties {_cggg :=_gg .NewCT_TextCharacterProperties ();
if _bcag !=nil {*_cggg =*_bcag ;};if _agec ==nil {return _cggg ;};if _cggg .KumimojiAttr ==nil {_cggg .KumimojiAttr =_agec .KumimojiAttr ;};if _cggg .LangAttr ==nil {_cggg .LangAttr =_agec .LangAttr ;};if _cggg .AltLangAttr ==nil {_cggg .AltLangAttr =_agec .AltLangAttr ;
};if _cggg .SzAttr ==nil {_cggg .SzAttr =_agec .SzAttr ;};if _cggg .BAttr ==nil {_cggg .BAttr =_agec .BAttr ;};if _cggg .IAttr ==nil {_cggg .IAttr =_agec .IAttr ;};if _cggg .UAttr ==_gg .ST_TextUnderlineTypeUnset {_cggg .UAttr =_agec .UAttr ;};if _cggg .StrikeAttr ==_gg .ST_TextStrikeTypeUnset {_cggg .StrikeAttr =_agec .StrikeAttr ;
};if _cggg .KernAttr ==nil {_cggg .KernAttr =_agec .KernAttr ;};if _cggg .CapAttr ==_gg .ST_TextCapsTypeUnset {_cggg .CapAttr =_agec .CapAttr ;};if _cggg .SpcAttr ==nil {_cggg .SpcAttr =_agec .SpcAttr ;};if _cggg .NormalizeHAttr ==nil {_cggg .NormalizeHAttr =_agec .NormalizeHAttr ;
};if _cggg .BaselineAttr ==nil {_cggg .BaselineAttr =_agec .BaselineAttr ;};if _cggg .NoProofAttr ==nil {_cggg .NoProofAttr =_agec .NoProofAttr ;};if _cggg .DirtyAttr ==nil {_cggg .DirtyAttr =_agec .DirtyAttr ;};if _cggg .ErrAttr ==nil {_cggg .ErrAttr =_agec .ErrAttr ;
};if _cggg .SmtCleanAttr ==nil {_cggg .SmtCleanAttr =_agec .SmtCleanAttr ;};if _cggg .SmtIdAttr ==nil {_cggg .SmtIdAttr =_agec .SmtIdAttr ;};if _cggg .BmkAttr ==nil {_cggg .BmkAttr =_agec .BmkAttr ;};if _cggg .Ln ==nil {_cggg .Ln =_agec .Ln ;};if _cggg .FillPropertiesChoice .NoFill ==nil {_cggg .FillPropertiesChoice .NoFill =_agec .FillPropertiesChoice .NoFill ;
};if _cggg .FillPropertiesChoice .SolidFill ==nil {_cggg .FillPropertiesChoice .SolidFill =_agec .FillPropertiesChoice .SolidFill ;};if _cggg .FillPropertiesChoice .BlipFill ==nil {_cggg .FillPropertiesChoice .BlipFill =_agec .FillPropertiesChoice .BlipFill ;
};if _cggg .EffectPropertiesChoice .EffectLst ==nil {_cggg .EffectPropertiesChoice .EffectLst =_agec .EffectPropertiesChoice .EffectLst ;};if _cggg .EffectPropertiesChoice .EffectDag ==nil {_cggg .EffectPropertiesChoice .EffectDag =_agec .EffectPropertiesChoice .EffectDag ;
};if _cggg .Highlight ==nil {_cggg .Highlight =_agec .Highlight ;};if _cggg .TextUnderlineLineChoice .ULnTx ==nil {_cggg .TextUnderlineLineChoice .ULnTx =_agec .TextUnderlineLineChoice .ULnTx ;};if _cggg .TextUnderlineLineChoice .ULn ==nil {_cggg .TextUnderlineLineChoice .ULn =_agec .TextUnderlineLineChoice .ULn ;
};if _cggg .TextUnderlineFillChoice .UFillTx ==nil {_cggg .TextUnderlineFillChoice .UFillTx =_agec .TextUnderlineFillChoice .UFillTx ;};if _cggg .TextUnderlineFillChoice .UFill ==nil {_cggg .TextUnderlineFillChoice .UFill =_agec .TextUnderlineFillChoice .UFill ;
};if _cggg .Latin ==nil {_cggg .Latin =_agec .Latin ;};if _cggg .Ea ==nil {_cggg .Ea =_agec .Ea ;};if _cggg .Cs ==nil {_cggg .Cs =_agec .Cs ;};if _cggg .Sym ==nil {_cggg .Sym =_agec .Sym ;};if _cggg .Rtl ==nil {_cggg .Rtl =_agec .Rtl ;};return _cggg ;};


// ConvertToPdfWithOptions convert a presentation to PDF with given options.
func ConvertToPdfWithOptions (pr *_bf .Presentation ,opts *Options )*_ee .Creator {_eg :=pr .X ().SldSz ;_fba :=_bd .FromEMU (int64 (_eg .CxAttr ));_ggg :=_bd .FromEMU (int64 (_eg .CyAttr ));_ccf :=_ee .PageSize {_fba ,_ggg };if (_ccf ==_ee .PageSize {}){_ccf =_bc .GetDefaultPageSize ();
if opts !=nil &&opts .DefaultPageSize !=_bc .DefaultPageSize {_ccf =_bc .GetPageDimensions (opts .DefaultPageSize );};};_dc :=_ee .New ();_dc .SetPageSize (_ccf );var _egc *_gg .Theme ;if len (pr .Themes ())> 0{_egc =pr .Themes ()[0];};for _ ,_ged :=range pr .Slides (){if _ged .X ()==nil {continue ;
};_dd :=&convertContext {_eec :_dc ,_cbbc :&_ged ,_eeg :_ged .GetSlideLayout (),_bbbfd :pr .SlideMasters ()[0].X (),_eadg :pr ,_gcb :_egc ,_gade :_ged .X ().ClrMapOvr ,_feece :_ccf [1],_dbfd :_ccf [0]};_dd .extractDefaultProperties ();_dd .makeSlide ();
_dd .drawSlide ();};return _dc ;};func _cacd (_aab ,_degc *_gg .CT_TextParagraphProperties )*_gg .CT_TextParagraphProperties {_afca :=_gg .NewCT_TextParagraphProperties ();if _aab !=nil {*_afca =*_aab ;};if _degc ==nil {return _afca ;};if _afca .MarLAttr ==nil {_afca .MarLAttr =_degc .MarLAttr ;
};if _afca .MarRAttr ==nil {_afca .MarRAttr =_degc .MarRAttr ;};if _afca .LvlAttr ==nil {_afca .LvlAttr =_degc .LvlAttr ;};if _afca .IndentAttr ==nil {_afca .IndentAttr =_degc .IndentAttr ;};if _afca .AlgnAttr ==_gg .ST_TextAlignTypeUnset {_afca .AlgnAttr =_degc .AlgnAttr ;
};if _afca .DefTabSzAttr ==nil {_afca .DefTabSzAttr =_degc .DefTabSzAttr ;};if _afca .RtlAttr ==nil {_afca .RtlAttr =_degc .RtlAttr ;};if _afca .EaLnBrkAttr ==nil {_afca .EaLnBrkAttr =_degc .EaLnBrkAttr ;};if _afca .FontAlgnAttr ==_gg .ST_TextFontAlignTypeUnset {_afca .FontAlgnAttr =_degc .FontAlgnAttr ;
};if _afca .LatinLnBrkAttr ==nil {_afca .LatinLnBrkAttr =_degc .LatinLnBrkAttr ;};if _afca .HangingPunctAttr ==nil {_afca .HangingPunctAttr =_degc .HangingPunctAttr ;};if _afca .LnSpc ==nil {_afca .LnSpc =_degc .LnSpc ;};if _afca .SpcBef ==nil {_afca .SpcBef =_degc .SpcBef ;
};if _afca .SpcAft ==nil {_afca .SpcAft =_degc .SpcAft ;};if _afca .TextBulletColorChoice .BuClrTx ==nil {_afca .TextBulletColorChoice .BuClrTx =_degc .TextBulletColorChoice .BuClrTx ;};if _afca .TextBulletColorChoice .BuClr ==nil {_afca .TextBulletColorChoice .BuClr =_degc .TextBulletColorChoice .BuClr ;
};if _afca .TextBulletSizeChoice .BuSzTx ==nil {_afca .TextBulletSizeChoice .BuSzTx =_degc .TextBulletSizeChoice .BuSzTx ;};if _afca .TextBulletSizeChoice .BuSzPct ==nil {_afca .TextBulletSizeChoice .BuSzPct =_degc .TextBulletSizeChoice .BuSzPct ;};if _afca .TextBulletSizeChoice .BuSzPts ==nil {_afca .TextBulletSizeChoice .BuSzPts =_degc .TextBulletSizeChoice .BuSzPts ;
};if _afca .TextBulletTypefaceChoice .BuFontTx ==nil {_afca .TextBulletTypefaceChoice .BuFontTx =_degc .TextBulletTypefaceChoice .BuFontTx ;};if _afca .TextBulletTypefaceChoice .BuFont ==nil {_afca .TextBulletTypefaceChoice .BuFont =_degc .TextBulletTypefaceChoice .BuFont ;
};if _afca .TextBulletChoice .BuNone ==nil {_afca .TextBulletChoice .BuNone =_degc .TextBulletChoice .BuNone ;};if _afca .TextBulletChoice .BuAutoNum ==nil {_afca .TextBulletChoice .BuAutoNum =_degc .TextBulletChoice .BuAutoNum ;};if _afca .TextBulletChoice .BuChar ==nil {_afca .TextBulletChoice .BuChar =_degc .TextBulletChoice .BuChar ;
};if _afca .TextBulletChoice .BuBlip ==nil {_afca .TextBulletChoice .BuBlip =_degc .TextBulletChoice .BuBlip ;};if _afca .TabLst ==nil {_afca .TabLst =_degc .TabLst ;};if _afca .ExtLst ==nil {_afca .ExtLst =_degc .ExtLst ;};_afca .DefRPr =_aded (_afca .DefRPr ,_degc .DefRPr );
return _afca ;};func (_bdb *textboxContext )alignParagraphsVertically (_aefe _gg .ST_TextAnchoringType ){if _aefe ==_gg .ST_TextAnchoringTypeT {return ;};_fddf :=0.0;for _ ,_efcb :=range _bdb ._bea {_fddf +=_efcb ._cffe +_efcb ._cgbb +_efcb ._ecfb ;};var _cffcg float64 ;
switch _aefe {case _gg .ST_TextAnchoringTypeCtr :_cffcg =(_bdb ._dgdf -_fddf )/2;case _gg .ST_TextAnchoringTypeB :_cffcg =_bdb ._dgdf -_fddf ;};for _ ,_aedc :=range _bdb ._bea {_aedc ._ffbb +=_cffcg ;};};func (_adcf *textboxContext )addPrefix (_bcgb *prefixData ,_agdb *_ee .TextStyle ){_acee :=_dfb (_bcgb ._dbdb );
_acf :=*_agdb ;if _bcgb ._fbba {_acf .Font =_bc .AssignStdFontByName (_acf ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_gddc :=range _acee {_gddc ._fcac =&_acf ;_adcf .addTextSymbol (_gddc );};_cdaa :=-(_bcgb ._dfg +_adcf ._cfde ._bcge );if _cdaa < 0{_cdaa =0;
};_eabe :=&symbol {_gba :"\u0020",_cbde :_cdaa };_adcf .addTextSymbol (_eabe );_adcf ._cfde ._bddb +=(_bcgb ._dfg +_bcgb ._cbeb );};var _efg =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
func (_gbdf *textboxContext )alignVertically (_bece _gg .ST_TextAnchoringType ){_gbdf .alignParagraphsVertically (_bece );_gbdf .alignSymbolsVertically ();};func (_cdb *convertContext )addShapes (_cg *_c .CT_CommonSlideData ,_cac bool ){if _cg ==nil {return ;
};_bcgd :=&background {};if _caa :=_cg .Bg ;_caa !=nil {if _ac :=_caa .BackgroundChoice .BgPr ;_ac !=nil {if _ac .FillPropertiesChoice .NoFill ==nil {if _dfe :=_ac .FillPropertiesChoice .SolidFill ;_dfe !=nil {_gge ,_gebb :=_cdb .getColorFromSolidFill (_dfe );
if _gge !=nil {_bcgd ._bbdd =_gge ;_bcgd ._ffee =_gebb ;};}else if _fae :=_ac .FillPropertiesChoice .BlipFill ;_fae !=nil {_bcgd ._dcee =_fae ;};};};};_cdb ._gagd =_bcgd ;if _bfa :=_cg .SpTree ;_bfa !=nil {for _ ,_aef :=range _bfa .GroupShapeChoice {if _aef !=nil {if _aef .Sp !=nil {_adf :=_cdb .getShapes (_aef .Sp ,_cac ,false );
_cdb ._cdc =append (_cdb ._cdc ,_adf ...);};if _aef .GraphicFrame !=nil {var _fab ,_faa ,_ggf ,_edd float64 ;if _edg :=_aef .GraphicFrame .Xfrm ;_edg !=nil {_fab ,_faa ,_ggf ,_edd =_bc .GetDataFromXfrm (_edg );};if _ggf ==0&&_edd ==0{_ggf =_cdb ._dbfd ;
_edd =_cdb ._feece ;};if _fbc :=_aef .GraphicFrame .Graphic ;_fbc !=nil {if _bfc :=_fbc .GraphicData ;_bfc !=nil {for _ ,_aa :=range _bfc .Any {if _gefe ,_aeba :=_aa .(*_a .Chart );_aeba {_gcc ,_gae :=_cdb .makePdfBlockFromChart (_gefe ,_ggf ,_edd );if _gae !=nil {_df .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_gae );
};if _gcc !=nil {_gcc .SetPos (_fab ,_faa );_cdb ._cdc =append (_cdb ._cdc ,_gcc );};}else if _de ,_acg :=_aa .(*_gg .Tbl );_acg {_aad :=_cdb .makePdfBlockFromTable (_de );if _aad !=nil {_ddf :=_ee .NewBlock (_ggf ,_edd );_ddf .SetPos (_fab ,_faa );_ecc :=_ddf .Draw (_aad );
if _ecc !=nil {_df .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0064r\u0061\u0077\u0020\u0074\u0061b\u006c\u0065\u003a\u0020\u0025\u0073",_ecc );if _ecc ==_ee .ErrContentNotFit {_ddf =_ee .NewBlock (_cdb ._dbfd -1.5*_fab ,_cdb ._feece -1.5*_faa );_ddf .SetPos (_fab ,_faa );
_ecc =_ddf .Draw (_aad );};};if _ecc ==nil {_cdb ._cdc =append (_cdb ._cdc ,_ddf );};};};};};};};if _aef .CxnSp !=nil {_fca :=_cdb .getConnectors (_aef .CxnSp );_cdb ._cdc =append (_cdb ._cdc ,_fca ...);};if _aef .GrpSp !=nil {_dcg :=0.0;_cf :=0.0;if _fg :=_aef .GrpSp .GrpSpPr .Xfrm ;
_fg !=nil {_dcg ,_cf =_bc .GetGroupOffsetFromXfrm (_fg );};for _ ,_cgd :=range _aef .GrpSp .GroupShapeChoice {if _cgd .CxnSp !=nil {_cgdf :=_cdb .getGroupConnectors (_cgd .CxnSp ,_dcg ,_cf );_cdb ._cdc =append (_cdb ._cdc ,_cgdf ...);};};};if _aef .Pic !=nil {_fbg :=false ;
var _ded ,_fbcg ,_def ,_dcc float64 ;if _fabd :=_aef .Pic .SpPr ;_fabd !=nil {if _ea :=_fabd .Xfrm ;_ea !=nil {_ded ,_fbcg ,_def ,_dcc =_bc .GetDataFromXfrm (_ea );_fbg =true ;};};var _fd _c .ST_PlaceholderType ;var _ce *uint32 ;if _cfc :=_aef .Pic .NvPicPr ;
_cfc !=nil {if _ffa :=_cfc .NvPr ;_ffa !=nil {if _cec :=_ffa .Ph ;_cec !=nil {_fd =_cec .TypeAttr ;_ce =_cec .IdxAttr ;};};};_geg ,_ ,_ ,_ ,_ :=_ccc (_cdb ._bbbfd .CSld ,_fd ,_ce );_ab ,_ ,_ ,_ ,_ :=_ccc (_cdb ._eeg .CSld ,_fd ,_ce );if _ab ==nil {_ab =_geg ;
};if _ab !=nil &&!_fbg {_ded ,_fbcg ,_def ,_dcc =_bc .GetDataFromXfrm (_ab );};if _cgdc :=_aef .Pic .BlipFill ;_cgdc !=nil {_acd :=_cdb .getShapeFromBlipFill (_cgdc ,_ded ,_fbcg ,_def ,_dcc ,_cac );_cdb ._cdc =append (_cdb ._cdc ,_acd );};};};};};};func _dfb (_fee string )[]*symbol {_efed :=[]*symbol {};
for _ ,_acab :=range _fee {_efed =append (_efed ,&symbol {_gba :string (_acab )});};return _efed ;};func (_efae *convertContext )makePdfImageFromBlipFill (_eccbe *_gg .CT_BlipFillProperties ,_ffge bool )(*_ee .Image ,[]*_gg .CT_BlipChoice ,error ){if _fdeg :=_eccbe .Blip ;
_fdeg !=nil {if _eedg :=_fdeg .EmbedAttr ;_eedg !=nil {var _efaeb _fa .ImageRef ;var _bfec bool ;if _ffge {_efaeb ,_bfec =_efae ._cbbc .GetLayoutImageByRelID (*_eedg );}else {_efaeb ,_bfec =_efae ._cbbc .GetImageByRelID (*_eedg );};if _bfec {_bdf ,_gfgg :=_ed .Open (_efaeb .Path ());
if _gfgg !=nil {_df .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_gfgg );return nil ,nil ,_gfgg ;};defer _bdf .Close ();_dbc ,_ ,_gfgg :=_g .Decode (_bdf );if _gfgg !=nil {_df .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_gfgg );
return nil ,nil ,_gfgg ;};if _addb :=_eccbe .SrcRect ;_addb !=nil {_eacd :=_dbc .Bounds ().Size ();_affg :=_eacd .X ;_dacc :=_eacd .Y ;var _ecbc ,_gcgg ,_egac ,_facf int ;var _dbbf bool ;if _bcgf :=_addb .LAttr ;_bcgf !=nil {_ecbc =int (float64 (_affg )*_bc .FromSTPercentage (_bcgf ));
_dbbf =true ;}else {_ecbc =0;};if _gecb :=_addb .TAttr ;_gecb !=nil {_egac =int (float64 (_dacc )*_bc .FromSTPercentage (_gecb ));_dbbf =true ;}else {_egac =0;};if _fecc :=_addb .RAttr ;_fecc !=nil {_gcgg =int (float64 (_affg )*(1-_bc .FromSTPercentage (_fecc )));
_dbbf =true ;}else {_gcgg =_affg ;};if _ddfd :=_addb .BAttr ;_ddfd !=nil {_facf =int (float64 (_dacc )*(1-_bc .FromSTPercentage (_ddfd )));_dbbf =true ;}else {_facf =_dacc ;};if _dbbf {_dbc =_bc .CropImageByRect (_dbc ,_g .Rect (_ecbc ,_egac ,_gcgg +1,_facf +1));
};};_acbe ,_gfgg :=_efae ._eec .NewImageFromGoImage (_dbc );_acbe .SetEncoder (_fcd .NewFlateEncoder ());if _gc .ToLower (_efaeb .Format ())=="\u006a\u0070\u0067"||_gc .ToLower (_efaeb .Format ())=="\u006a\u0070\u0065\u0067"{_acbe .SetEncoder (_fcd .NewDCTEncoder ());
};if _gfgg !=nil {_df .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_gfgg );
return nil ,nil ,_gfgg ;};return _acbe ,_fdeg .BlipChoice ,nil ;};};};return nil ,nil ,nil ;};func (_fgfc *textboxContext )addCurrentParagraph (){_fgfc ._fdbe =_fgfc ._bba ._ffbb +_fgfc ._bba ._cffe +_fgfc ._bba ._cgbb +_fgfc ._bba ._ecfb ;_fgfc ._bea =append (_fgfc ._bea ,_fgfc ._bba );
_fgfc .alignParagraph ();};func _ecge (_febd ,_gaag *_gg .CT_TextBodyProperties )*_gg .CT_TextBodyProperties {_aebg :=_gg .NewCT_TextBodyProperties ();if _febd !=nil {*_aebg =*_febd ;};if _gaag ==nil {return _aebg ;};if _aebg .RotAttr ==nil {_aebg .RotAttr =_gaag .RotAttr ;
};if _aebg .SpcFirstLastParaAttr ==nil {_aebg .SpcFirstLastParaAttr =_gaag .SpcFirstLastParaAttr ;};if _aebg .VertOverflowAttr ==_gg .ST_TextVertOverflowTypeUnset {_aebg .VertOverflowAttr =_gaag .VertOverflowAttr ;};if _aebg .HorzOverflowAttr ==_gg .ST_TextHorzOverflowTypeUnset {_aebg .HorzOverflowAttr =_gaag .HorzOverflowAttr ;
};if _aebg .VertAttr ==_gg .ST_TextVerticalTypeUnset {_aebg .VertAttr =_gaag .VertAttr ;};if _aebg .WrapAttr ==_gg .ST_TextWrappingTypeUnset {_aebg .WrapAttr =_gaag .WrapAttr ;};if _aebg .LInsAttr ==nil {_aebg .LInsAttr =_gaag .LInsAttr ;};if _aebg .TInsAttr ==nil {_aebg .TInsAttr =_gaag .TInsAttr ;
};if _aebg .RInsAttr ==nil {_aebg .RInsAttr =_gaag .RInsAttr ;};if _aebg .BInsAttr ==nil {_aebg .BInsAttr =_gaag .BInsAttr ;};if _aebg .NumColAttr ==nil {_aebg .NumColAttr =_gaag .NumColAttr ;};if _aebg .SpcColAttr ==nil {_aebg .SpcColAttr =_gaag .SpcColAttr ;
};if _aebg .RtlColAttr ==nil {_aebg .RtlColAttr =_gaag .RtlColAttr ;};if _aebg .AnchorAttr ==_gg .ST_TextAnchoringTypeUnset {_aebg .AnchorAttr =_gaag .AnchorAttr ;};if _aebg .AnchorCtrAttr ==nil {_aebg .AnchorCtrAttr =_gaag .AnchorCtrAttr ;};if _aebg .ForceAAAttr ==nil {_aebg .ForceAAAttr =_gaag .ForceAAAttr ;
};if _aebg .UprightAttr ==nil {_aebg .UprightAttr =_gaag .UprightAttr ;};if _aebg .CompatLnSpcAttr ==nil {_aebg .CompatLnSpcAttr =_gaag .CompatLnSpcAttr ;};if _aebg .PrstTxWarp ==nil {_aebg .PrstTxWarp =_gaag .PrstTxWarp ;};if _aebg .TextAutofitChoice .NoAutofit ==nil {_aebg .TextAutofitChoice .NoAutofit =_gaag .TextAutofitChoice .NoAutofit ;
};if _aebg .TextAutofitChoice .NormAutofit ==nil {_aebg .TextAutofitChoice .NormAutofit =_gaag .TextAutofitChoice .NormAutofit ;};if _aebg .TextAutofitChoice .SpAutoFit ==nil {_aebg .TextAutofitChoice .SpAutoFit =_gaag .TextAutofitChoice .SpAutoFit ;};
if _aebg .Scene3d ==nil {_aebg .Scene3d =_gaag .Scene3d ;};if _aebg .Text3DChoice .Sp3d ==nil {_aebg .Text3DChoice .Sp3d =_gaag .Text3DChoice .Sp3d ;};if _aebg .Text3DChoice .FlatTx ==nil {_aebg .Text3DChoice .FlatTx =_gaag .Text3DChoice .FlatTx ;};if _aebg .ExtLst ==nil {_aebg .ExtLst =_gaag .ExtLst ;
};return _aebg ;};