//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_cc "bytes";_g "errors";_a "github.com/unidoc/unioffice/common";_d "github.com/unidoc/unioffice/common/logger";_bf "github.com/unidoc/unioffice/common/tempstorage";_e "github.com/unidoc/unioffice/internal/convertutils";_bab "github.com/unidoc/unioffice/measurement";
_ff "github.com/unidoc/unioffice/presentation";_fg "github.com/unidoc/unioffice/schema/soo/dml";_gg "github.com/unidoc/unioffice/schema/soo/dml/chart";_baf "github.com/unidoc/unioffice/schema/soo/pml";_bcc "github.com/unidoc/unipdf/v3/contentstream/draw";
_bc "github.com/unidoc/unipdf/v3/core";_df "github.com/unidoc/unipdf/v3/creator";_ge "github.com/unidoc/unipdf/v3/model";_ga "github.com/unidoc/unipdf/v3/render";_c "image";_f "image/color";_bg "image/draw";_ba "strconv";_fd "strings";);

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_ff .Presentation )*_df .Creator {_ca :=pr .X ().SldSz ;_da :=_bab .FromEMU (int64 (_ca .CxAttr ));_dfa :=_bab .FromEMU (int64 (_ca .CyAttr ));_fcg :=_df .PageSize {_da ,_dfa };_ce :=_df .New ();_ce .SetPageSize (_fcg );var _fff *_fg .Theme ;
if len (pr .Themes ())> 0{_fff =pr .Themes ()[0];};for _ ,_gge :=range pr .Slides (){if _gge .X ()==nil {continue ;};_gb :=&convertContext {_afec :_ce ,_cbda :&_gge ,_ddgfc :_gge .GetSlideLayout (),_gfbg :pr .SlideMasters ()[0].X (),_cdea :pr ,_cbdc :_fff ,_caf :_gge .X ().ClrMapOvr ,_bgce :_fcg [1],_dcfc :_fcg [0]};
_gb .extractDefaultProperties ();_gb .makeSlide ();_gb .drawSlide ();};return _ce ;};func (_bdac *convertContext )addCellToTable (_agec *_df .Table ,_cgc *_fg .CT_TableCell ,_afd *_fg .CT_TablePartStyle ,_aaab float64 ,_gfeb ,_ggae ,_ddfb ,_ggga bool )float64 {var _deb *_df .TableCell ;
_gbf :=1;if _cgc .GridSpanAttr !=nil {_gbf =int (*_cgc .GridSpanAttr );};_deb =_agec .MultiColCell (_gbf );_ega :=_cgc .TcPr ;var _bdbd *_fg .CT_TableStyleTextStyle ;if _afd !=nil {_ega =_fbgb (_ega ,_afd .TcStyle ,_gfeb ,_ggae ,_ddfb ,_ggga );_bdbd =_afd .TcTxStyle ;
};_cce :=_ccd ;_aga :=_df .CellVerticalAlignmentMiddle ;_abdc :=_dfgb (0.05);_caga :=_dfgb (0.05);if _ega !=nil {if _befg :=_ega .LnL ;_befg !=nil {_fgdd ,_gade ,_agffd :=_bdac .getBorderStyle (_befg );_deb .SetBorder (_df .CellBorderSideLeft ,_fgdd ,_agffd );
if _gade !=nil &&*_gade !=nil {_deb .SetSideBorderColor (_df .CellBorderSideLeft ,*_gade );};};if _agffg :=_ega .LnT ;_agffg !=nil {_efbg ,_abdf ,_ccga :=_bdac .getBorderStyle (_agffg );_deb .SetBorder (_df .CellBorderSideTop ,_efbg ,_ccga );if _abdf !=nil &&*_abdf !=nil {_deb .SetSideBorderColor (_df .CellBorderSideTop ,*_abdf );
};};if _caec :=_ega .LnR ;_caec !=nil {_ece ,_aba ,_gce :=_bdac .getBorderStyle (_caec );_deb .SetBorder (_df .CellBorderSideRight ,_ece ,_gce );if _aba !=nil &&*_aba !=nil {_deb .SetSideBorderColor (_df .CellBorderSideRight ,*_aba );};};if _agb :=_ega .LnB ;
_agb !=nil {_cabb ,_cgfg ,_fegg :=_bdac .getBorderStyle (_agb );_deb .SetBorder (_df .CellBorderSideBottom ,_cabb ,_fegg );if _cgfg !=nil &&*_cgfg !=nil {_deb .SetSideBorderColor (_df .CellBorderSideBottom ,*_cgfg );};};if _dffd :=_ega .MarLAttr ;_dffd !=nil {_cce =float64 (_e .FromSTCoordinate32 (*_dffd ));
};switch _ega .AnchorAttr {case _fg .ST_TextAnchoringTypeT :_aga =_df .CellVerticalAlignmentTop ;case _fg .ST_TextAnchoringTypeB :_aga =_df .CellVerticalAlignmentBottom ;};if _ega .NoFill ==nil {if _edab :=_ega .SolidFill ;_edab !=nil {_baad ,_ :=_bdac .getColorFromSolidFill (_edab );
_deb .SetBackgroundColor (_baad );};};if _fefc :=_ega .MarBAttr ;_fefc !=nil {_abdc =float64 (_e .FromSTCoordinate32 (*_fefc ));};if _bfce :=_ega .MarTAttr ;_bfce !=nil {_caga =float64 (_e .FromSTCoordinate32 (*_bfce ));};};_deb .SetVerticalAlignment (_aga );
_deb .SetIndent (_cce );var _gfa float64 ;if _dbef :=_cgc .TxBody ;_dbef !=nil {_aff :=_bdac .makePdfDivisionFromTxBody (_dbef ,_bdbd );_gfa =_aff .Height ()+_caga +_abdc ;_deb .SetContent (_aff );};return _gfa ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _e .RegisterFontsFromDirectory (dirName )};func (_ebbfa *textboxContext )alignParagraph (){_cbbe :=_ebbfa ._eea ;if _cbbe ._fbdf ==_fg .ST_TextAlignTypeL {return ;};_dceeb :=len (_cbbe ._dbcad )-1;
for _aeab ,_egda :=range _cbbe ._dbcad {_dabg :=true ;_cbba :=len (_egda ._cgcd );_caag :=0.0;for _afce :=len (_egda ._cgcd )-1;_afce >=0;_afce --{_gafe :=_egda ._cgcd [_afce ];if _dabg &&_gafe ._bge {_cbba =_afce ;}else {_dabg =false ;for _ ,_ffdb :=range _gafe ._eaab {_caag +=_ffdb ._ffae ;
};};};_egda ._cgcd =_egda ._cgcd [:_cbba ];_feff :=_egda ._bced -_egda ._cca -_caag ;switch _cbbe ._fbdf {case _fg .ST_TextAlignTypeR :_egda .moveRight (_feff );case _fg .ST_TextAlignTypeCtr :_egda .moveRight (_feff /2);case _fg .ST_TextAlignTypeJust :if _aeab !=_dceeb {_fbe :=[]*word {};
for _ ,_agdb :=range _egda ._cgcd {if _agdb ._bge {_fbe =append (_fbe ,_agdb );};};_cgge :=_feff /float64 (len (_fbe ));for _ ,_edae :=range _fbe {_edae ._fcfg +=_cgge ;};var _gffe *word ;for _ ,_efcf :=range _egda ._cgcd {if _gffe !=nil {_efcf ._eceb =_gffe ._eceb +_gffe ._fcfg ;
};_gffe =_efcf ;};};};};};func (_aca *textboxContext )newParagraph (){_cdcd :=&paragraph {};_cdcd ._bdee =_aca ._dbde ;_aca ._eea =_cdcd ;};func (_fbg *convertContext )makeSlide (){_eed :=_fbg ._cbda .GetSlideLayout ().CSld ;if _eed !=nil {if _ec :=_eed .SpTree ;
_ec !=nil {for _ ,_fce :=range _ec .Choice {if _fce !=nil {for _ ,_fab :=range _fce .Pic {if _fab !=nil {var _geb ,_cb ,_dd ,_egc float64 ;if _bff :=_fab .SpPr ;_bff !=nil {if _fe :=_bff .Xfrm ;_fe !=nil {_geb ,_cb ,_dd ,_egc =_e .GetDataFromXfrm (_fe );
};};if _ede :=_fab .BlipFill ;_ede !=nil {_dba :=_fbg .getShapeFromBlipFill (_ede ,_geb ,_cb ,_dd ,_egc ,true );_fbg ._baaf =append (_fbg ._baaf ,_dba );};};};};};};};_eed =_fbg ._cbda .X ().CSld ;if _eed ==nil {return ;};_bba :=&background {};if _bfc :=_eed .Bg ;
_bfc !=nil {if _aa :=_bfc .BgPr ;_aa !=nil {if _aa .NoFill ==nil {if _ad :=_aa .SolidFill ;_ad !=nil {_aef ,_gaf :=_fbg .getColorFromSolidFill (_ad );if _aef !=nil {_bba ._dgg =_aef ;_bba ._dbgf =_gaf ;};}else if _bfcg :=_aa .BlipFill ;_bfcg !=nil {_bba ._gda =_bfcg ;
};};};};_fbg ._gdd =_bba ;if _fed :=_eed .SpTree ;_fed !=nil {for _ ,_ddg :=range _fed .Choice {if _ddg !=nil {for _ ,_aaa :=range _ddg .Sp {if _aaa !=nil {_ggg :=_fbg .getShapes (_aaa );_fbg ._baaf =append (_fbg ._baaf ,_ggg ...);};};for _ ,_ade :=range _ddg .GraphicFrame {if _ade !=nil {var _gff ,_age ,_bbf ,_agf float64 ;
if _dae :=_ade .Xfrm ;_dae !=nil {_gff ,_age ,_bbf ,_agf =_e .GetDataFromXfrm (_dae );};if _bbf ==0&&_agf ==0{_bbf =_fbg ._dcfc ;_agf =_fbg ._bgce ;};if _gga :=_ade .Graphic ;_gga !=nil {if _dbg :=_gga .GraphicData ;_dbg !=nil {for _ ,_gdb :=range _dbg .Any {if _gc ,_bgg :=_gdb .(*_gg .Chart );
_bgg {_babb ,_dbae :=_fbg .makePdfBlockFromChart (_gc ,_bbf ,_agf );if _dbae !=nil {_d .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_dbae );};if _babb !=nil {_babb .SetPos (_gff ,_age );
_fbg ._baaf =append (_fbg ._baaf ,_babb );};}else if _ecd ,_ffe :=_gdb .(*_fg .Tbl );_ffe {_bae :=_fbg .makePdfBlockFromTable (_ecd ,_bbf );if _bae !=nil {_cf :=_df .NewBlock (_bbf ,_agf );_cf .SetPos (_gff ,_age );_cf .Draw (_bae );_fbg ._baaf =append (_fbg ._baaf ,_cf );
};};};};};};};for _ ,_ccb :=range _ddg .CxnSp {if _ccb !=nil {_dg :=_fbg .getConnectors (_ccb );_fbg ._baaf =append (_fbg ._baaf ,_dg ...);};};for _ ,_eebc :=range _ddg .GrpSp {_ffef :=0.0;_ea :=0.0;if _ggf :=_eebc .GrpSpPr .Xfrm ;_ggf !=nil {_ffef ,_ea =_e .GetGroupOffsetFromXfrm (_ggf );
};for _ ,_aac :=range _eebc .Choice {for _ ,_gcc :=range _aac .CxnSp {if _gcc !=nil {_gbg :=_fbg .getGroupConnectors (_gcc ,_ffef ,_ea );_fbg ._baaf =append (_fbg ._baaf ,_gbg ...);};};};};for _ ,_dge :=range _ddg .Pic {if _dge !=nil {var _daeb ,_gdc ,_cab ,_fea float64 ;
if _babg :=_dge .SpPr ;_babg !=nil {if _ddf :=_babg .Xfrm ;_ddf !=nil {_daeb ,_gdc ,_cab ,_fea =_e .GetDataFromXfrm (_ddf );};};if _fge :=_dge .BlipFill ;_fge !=nil {_fag :=_fbg .getShapeFromBlipFill (_fge ,_daeb ,_gdc ,_cab ,_fea ,false );_fbg ._baaf =append (_fbg ._baaf ,_fag );
};};};};};};};func (_dce *convertContext )makePdfDivisionFromTxBody (_ebbf *_fg .CT_TextBody ,_bfe *_fg .CT_TableStyleTextStyle )*_df .Division {_ffc :=_dce ._afec .NewDivision ();_fcf :=_dce ._dbdfg ;_daf :=_fg .ST_TextAnchoringTypeT ;if _ffda :=_ebbf .BodyPr ;
_ffda !=nil {if _bcfab :=_ffda .AnchorAttr ;_bcfab !=_fg .ST_TextAnchoringTypeUnset {_daf =_ffda .AnchorAttr ;};};if _edaa :=_ebbf .LstStyle ;_edaa !=nil {var _afb *_fg .CT_TextParagraphProperties ;if _edaa .Lvl1pPr !=nil {_afb =_edaa .Lvl1pPr ;}else {_afb =_dce ._fede [0];
};_fcf =_ecg (_afb ,_ecg (_edaa .DefPPr ,_fcf ));};for _ ,_bbae :=range _ebbf .P {if _bbae !=nil {_cbcc :=_dce ._afec .NewStyledParagraph ();_ffg :=_ecg (_bbae .PPr ,_fcf );_dga :=_gadd (_bbae .EndParaRPr ,_ffg .DefRPr );if len (_bbae .EG_TextRun )==0{_cbcc .Append ("\u000a");
_ffc .Add (_cbcc );continue ;};for _ ,_ebf :=range _bbae .EG_TextRun {if _fdf :=_ebf .Br ;_fdf !=nil {_cbcc .Append ("\u000a");}else if _bag :=_ebf .R ;_bag !=nil {_aacef :=_ccfb (_bag .RPr ,_bfe );_aacef =_gadd (_aacef ,_dga );var _ecc _df .Color ;if _aacef .SolidFill !=nil {_ecc ,_ =_dce .getColorFromSolidFill (_aacef .SolidFill );
}else {_ecc =_df .ColorBlack ;};_fedf ,_bddg ,_ccg ,_ :=_dce .makeStyleFromRPr (_aacef );_fedf .Color =_ecc ;if _bddg {_fedf .TextRise =0.5;}else if _ccg {_fedf .TextRise =-0.5;};_ffb :=_bag .T ;if _aacef .CapAttr ==_fg .ST_TextCapsTypeAll {for _ ,_dbe :=range _ffb {_dbe =[]rune (_fd .ToUpper (string (_dbe )))[0];
};};_dfgg :=_cbcc .Append (_ffb );_dfgg .Style =*_fedf ;};};_ =_daf ;_ffc .Add (_cbcc );};};return _ffc ;};func (_dbad *textboxContext )addPrefix (_gebg *prefixData ,_ffdg *_df .TextStyle ){_cefd :=_cdeg (_gebg ._abda );_eaaa :=*_ffdg ;if _gebg ._dfd {_eaaa .Font =_e .AssignStdFontByName (_eaaa ,"\u0053\u0079\u006d\u0062\u006f\u006c");
};for _ ,_gffca :=range _cefd {_gffca ._bgcb =&_eaaa ;_dbad .addTextSymbol (_gffca );};_cddg :=-(_gebg ._aaccc +_dbad ._ffgf ._fcfg );if _cddg < 0{_cddg =0;};_fbcd :=&symbol {_gcaf :"\u0020",_ffae :_cddg };_dbad .addTextSymbol (_fbcd );_dbad ._ffgf ._eceb +=(_gebg ._aaccc +_gebg ._aefd );
};type textboxContext struct{_ddfe *convertContext ;_bbde float64 ;_abfg float64 ;_caea *_df .Creator ;_dbde float64 ;_adg []*paragraph ;_eea *paragraph ;_fdd *line ;_ffgf *word ;_degf bool ;};func (_fbdfd *line )moveRight (_ddga float64 ){for _ ,_dffe :=range _fbdfd ._cgcd {_dffe ._eceb +=_ddga ;
};};func (_egb *convertContext )makeStyleFromRPr (_gef *_fg .CT_TextCharacterProperties )(*_df .TextStyle ,bool ,bool ,bool ){var _efc ,_agfa ,_dgb bool ;_bcfd :=_egb ._afec .NewTextStyle ();if _gef !=nil {_afe :=_e .FontStyle_Regular ;_ggb :=_gbcd (_gef .BAttr );
_bbd :=_gbcd (_gef .IAttr );if _ggb &&_bbd {_afe =_e .FontStyle_BoldItalic ;}else if _ggb {_afe =_e .FontStyle_Bold ;}else if _bbd {_afe =_e .FontStyle_Italic ;};_dgb =_gef .UAttr !=_fg .ST_TextUnderlineTypeUnset &&_gef .UAttr !=_fg .ST_TextUnderlineTypeNone ;
_ccbg :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _cfc :=_gef .Latin ;_cfc !=nil {_ccbg =_cfc .TypefaceAttr ;}else if _aaf :=_gef .Ea ;_aaf !=nil {_ccbg =_aaf .TypefaceAttr ;}else if _eedg :=_gef .Cs ;_eedg !=nil {_ccbg =_eedg .TypefaceAttr ;}else if _ddbbe :=_gef .Sym ;
_ddbbe !=nil {_ccbg =_ddbbe .TypefaceAttr ;};if _bbad ,_deeg :=_e .StdFontsMap [_ccbg ];_deeg {_bcfd .Font =_e .AssignStdFontByName (_bcfd ,_bbad [_afe ]);}else if _gfbbg :=_e .GetRegisteredFont (_ccbg ,_afe );_gfbbg !=nil {_bcfd .Font =_gfbbg ;}else {_d .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_ccbg ,_afe );
_bcfd .Font =_e .AssignStdFontByName (_bcfd ,_e .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_afe ]);};var _gee float64 ;if _ddbc :=_gef .SzAttr ;_ddbc !=nil {_gee =float64 (*_ddbc )/100;}else {_gee =_e .DefaultFontSize ;};if _accd :=_gef .BaselineAttr ;
_accd !=nil {if _daac :=_accd .ST_PercentageDecimal ;_daac !=nil {if *_daac > 0{_efc =true ;}else if *_daac < 0{_agfa =true ;};};};if _efc ||_agfa {_gee *=0.64;};_bcfd .FontSize =_gee ;_gae :=0.0;if _feaf :=_gef .SpcAttr ;_feaf !=nil {if _bgab :=_feaf .ST_TextPointUnqualified ;
_bgab !=nil {_gae =float64 (*_bgab )/100;};};_bcfd .CharSpacing =_gae ;};return &_bcfd ,_efc ,_agfa ,_dgb ;};func _aeac (_cdeaa ,_cfec *_fg .CT_TablePartStyle )*_fg .CT_TablePartStyle {_fgcd :=_fg .NewCT_TablePartStyle ();if _cdeaa !=nil {*_fgcd =*_cdeaa ;
};if _cfec ==nil {return _fgcd ;};if _fgcd .TcTxStyle ==nil {_fgcd .TcTxStyle =_cfec .TcTxStyle ;}else {_fgcd .TcTxStyle =_ddadc (_fgcd .TcTxStyle ,_cfec .TcTxStyle );};if _fgcd .TcStyle ==nil {_fgcd .TcStyle =_cfec .TcStyle ;}else {_fgcd .TcStyle =_eggc (_fgcd .TcStyle ,_cfec .TcStyle );
};return _fgcd ;};func (_gbe *convertContext )getConnectors (_ada *_baf .CT_Connector )[]_df .Drawable {_bbfd ,_ ,_ ,_ ,_ ,_ ,_ :=_gbe .getShapesFromSpPr (_ada .SpPr ,_ada .Style ,false ,0.0,0.0);return _bbfd ;};func _eggc (_fde ,_cdcc *_fg .CT_TableStyleCellStyle )*_fg .CT_TableStyleCellStyle {_adfcb :=_fg .NewCT_TableStyleCellStyle ();
if _fde !=nil {*_adfcb =*_fde ;};if _cdcc ==nil {return _adfcb ;};if _adfcb .TcBdr ==nil {_adfcb .TcBdr =_cdcc .TcBdr ;};if _adfcb .Fill ==nil {_adfcb .Fill =_cdcc .Fill ;};if _adfcb .FillRef ==nil {_adfcb .FillRef =_cdcc .FillRef ;};return _adfcb ;};func _ecg (_efge ,_aeae *_fg .CT_TextParagraphProperties )*_fg .CT_TextParagraphProperties {_adae :=_fg .NewCT_TextParagraphProperties ();
if _efge !=nil {*_adae =*_efge ;};if _aeae ==nil {return _adae ;};if _adae .MarLAttr ==nil {_adae .MarLAttr =_aeae .MarLAttr ;};if _adae .MarRAttr ==nil {_adae .MarRAttr =_aeae .MarRAttr ;};if _adae .LvlAttr ==nil {_adae .LvlAttr =_aeae .LvlAttr ;};if _adae .IndentAttr ==nil {_adae .IndentAttr =_aeae .IndentAttr ;
};if _adae .AlgnAttr ==_fg .ST_TextAlignTypeUnset {_adae .AlgnAttr =_aeae .AlgnAttr ;};if _adae .DefTabSzAttr ==nil {_adae .DefTabSzAttr =_aeae .DefTabSzAttr ;};if _adae .RtlAttr ==nil {_adae .RtlAttr =_aeae .RtlAttr ;};if _adae .EaLnBrkAttr ==nil {_adae .EaLnBrkAttr =_aeae .EaLnBrkAttr ;
};if _adae .FontAlgnAttr ==_fg .ST_TextFontAlignTypeUnset {_adae .FontAlgnAttr =_aeae .FontAlgnAttr ;};if _adae .LatinLnBrkAttr ==nil {_adae .LatinLnBrkAttr =_aeae .LatinLnBrkAttr ;};if _adae .HangingPunctAttr ==nil {_adae .HangingPunctAttr =_aeae .HangingPunctAttr ;
};if _adae .LnSpc ==nil {_adae .LnSpc =_aeae .LnSpc ;};if _adae .SpcBef ==nil {_adae .SpcBef =_aeae .SpcBef ;};if _adae .SpcAft ==nil {_adae .SpcAft =_aeae .SpcAft ;};if _adae .BuClrTx ==nil {_adae .BuClrTx =_aeae .BuClrTx ;};if _adae .BuClr ==nil {_adae .BuClr =_aeae .BuClr ;
};if _adae .BuSzTx ==nil {_adae .BuSzTx =_aeae .BuSzTx ;};if _adae .BuSzPct ==nil {_adae .BuSzPct =_aeae .BuSzPct ;};if _adae .BuSzPts ==nil {_adae .BuSzPts =_aeae .BuSzPts ;};if _adae .BuFontTx ==nil {_adae .BuFontTx =_aeae .BuFontTx ;};if _adae .BuFont ==nil {_adae .BuFont =_aeae .BuFont ;
};if _adae .BuNone ==nil {_adae .BuNone =_aeae .BuNone ;};if _adae .BuAutoNum ==nil {_adae .BuAutoNum =_aeae .BuAutoNum ;};if _adae .BuChar ==nil {_adae .BuChar =_aeae .BuChar ;};if _adae .BuBlip ==nil {_adae .BuBlip =_aeae .BuBlip ;};if _adae .TabLst ==nil {_adae .TabLst =_aeae .TabLst ;
};if _adae .ExtLst ==nil {_adae .ExtLst =_aeae .ExtLst ;};_adae .DefRPr =_gadd (_adae .DefRPr ,_aeae .DefRPr );return _adae ;};func (_adfb *convertContext )makePdfBlockFromTable (_dbdf *_fg .Tbl ,_faa float64 )*_df .Table {_ffa :=_dbdf .TblGrid ;if _ffa ==nil {return nil ;
};_eacb :=len (_ffa .GridCol );if _eacb ==0{return nil ;};_cbeg :=[]float64 {};_agg :=0.0;for _ ,_fagd :=range _ffa .GridCol {_bcbg :=_bab .FromEMU (_e .FromSTCoordinate (_fagd .WAttr ));_cbeg =append (_cbeg ,_bcbg );_agg +=_bcbg ;};_bdfg :=[]float64 {};
for _bda :=0;_bda < _eacb ;_bda ++{_bdfg =append (_bdfg ,_cbeg [_bda ]/_agg );};_gag :=_adfb ._afec .NewTable (_eacb );_gag .SetColumnWidths (_bdfg ...);_edgd :=_dbdf .TblPr ;var _ebd *_fg .CT_TableStyle ;if _ddad :=_edgd .Choice ;_ddad !=nil {if _ddad .TableStyle !=nil {_ebd =_ddad .TableStyle ;
}else if _ddad .TableStyleId !=nil {_ebd =_adfb ._cdea .GetTableStyleById (*_ddad .TableStyleId );};};_bee :=_fg .NewCT_TablePartStyle ();_bee .TcStyle =_fg .NewCT_TableStyleCellStyle ();_bee .TcTxStyle =_fg .NewCT_TableStyleTextStyle ();if _ebd !=nil {if _ebd .WholeTbl !=nil {*_bee =*_ebd .WholeTbl ;
};if _ebd .TblBg !=nil {if _bee .TcStyle .Fill ==nil {_bee .TcStyle .Fill =_ebd .TblBg .Fill ;};};};if _bee .TcStyle .Fill ==nil {_bee .TcStyle .Fill =_fg .NewCT_FillProperties ();_bee .TcStyle .Fill .NoFill =_edgd .NoFill ;_bee .TcStyle .Fill .SolidFill =_edgd .SolidFill ;
};_edc :=len (_dbdf .Tr );for _dgd ,_cag :=range _dbdf .Tr {_ecf :=_dgd ==0;_gacd :=_dgd ==_edc -1;_gabgg :=_dgd %2==0;_decc :=len (_cag .Tc );var _gbda *_fg .CT_TablePartStyle ;if _ecf {_gbda =_ebd .FirstRow ;}else if _gabgg {_gbda =_ebd .Band2H ;}else {_gbda =_ebd .Band1H ;
};var _cea float64 ;for _ddfd ,_dcb :=range _cag .Tc {_fccf :=_ddfd ==0;_bdeg :=_ddfd ==_decc -1;_gaed :=_ddfd %2==0;var _abf *_fg .CT_TablePartStyle ;if _fccf {_abf =_ebd .FirstCol ;}else if _gaed {_abf =_ebd .Band2V ;}else {_abf =_ebd .Band1V ;};_eacbg :=_aeac (_aeac (_abf ,_gbda ),_bee );
_cadg :=_adfb .addCellToTable (_gag ,_dcb ,_eacbg ,_faa *_bdfg [_ddfd ],_ecf ,_gacd ,_fccf ,_bdeg );if _cadg > _cea {_cea =_cadg ;};};_fbbg :=_bab .FromEMU (_e .FromSTCoordinate (_cag .HAttr ));if _fbbg < _cea {_fbbg =_cea ;};if _fbbg < _eacgb (4){_fbbg =_eacgb (4);
};_gag .SetRowHeight (_gag .CurRow (),_fbbg );};return _gag ;};type symbolStyle struct{_acd *string ;_ecff *float64 ;_ccaf *string ;_cdd *bool ;_cbfg *bool ;_bbc *bool ;_fgf *bool ;_gbdg *bool ;};func (_bbff *convertContext )getShapesFromSpPr (_adc *_fg .CT_ShapeProperties ,_cbcd *_fg .CT_ShapeStyle ,_fabe bool ,_bef float64 ,_ddbb float64 )([]_df .Drawable ,float64 ,float64 ,float64 ,float64 ,_df .Color ,bool ){_efdg :=[]_df .Drawable {};
var _fabb ,_agc ,_fcc ,_cfd ,_gfbb float64 ;var _bce ,_bcg ,_baac ,_baff _df .Color ;var _bgfc *_fg .CT_BlipFillProperties ;_gca ,_bdc :=1.0,1.0;if _cbcd !=nil {_bce ,_bcg ,_baff =_bbff .getStyleColors (_cbcd );};if _eba :=_adc .Ln ;_eba !=nil {if _eba .NoFill !=nil {_baac ,_gfbb =nil ,0;
}else {_baac ,_gfbb ,_gca =_bbff .getInfoFromLn (_eba );if _baac ==nil {_baac =_baff ;};};};if _adc .NoFill !=nil {_bcg ,_bdc =nil ,0;}else if _fabe {_bcg =_bbff ._gdd ._dgg ;_bdc =_bbff ._gdd ._dbgf ;_bgfc =_bbff ._gdd ._gda ;}else if _aeg :=_adc .SolidFill ;
_aeg !=nil {_bcg ,_bdc =_bbff .getColorFromSolidFill (_aeg );};var _dfaa bool ;if _fbd :=_adc .Xfrm ;_fbd !=nil {_fabb ,_agc ,_fcc ,_cfd =_e .GetDataFromXfrm (_fbd );_fabb +=_bef ;_agc +=_ddbb ;_dfaa =true ;};if _dcf :=_adc .CustGeom ;_dcf !=nil {_dbb :=[]_bcc .Point {};
_bdd ,_dbba :=1.0,1.0;if _degg :=_dcf .PathLst ;_degg !=nil {for _ ,_gcd :=range _degg .Path {if _gcd !=nil {if _feg :=_gcd .WAttr ;_feg !=nil {_bdd =_fcc /_bab .FromEMU (*_feg );};if _ebe :=_gcd .HAttr ;_ebe !=nil {_dbba =_cfd /_bab .FromEMU (*_ebe );
};for _ ,_cbcg :=range _gcd .Close {if _cbcg !=nil {};};for _ ,_ccc :=range _gcd .MoveTo {if _ccc !=nil &&_ccc .Pt !=nil {_gec ,_acf :=_cdb (_ccc .Pt );_dbb =append (_dbb ,_bcc .Point {X :_gec *_bdd +_fabb ,Y :_acf *_dbba +_agc });};};for _ ,_fecf :=range _gcd .LnTo {if _fecf !=nil &&_fecf .Pt !=nil {_dcg ,_ebeb :=_cdb (_fecf .Pt );
_dbb =append (_dbb ,_bcc .Point {X :_dcg *_bdd +_fabb ,Y :_ebeb *_dbba +_agc });};};_bcfa :=_bbff ._afec .NewPolygon ([][]_bcc .Point {_dbb });_bcfa .SetFillColor (_bcg );_bcfa .SetFillOpacity (_bdc );_bcfa .SetBorderWidth (_gfbb );if _baac !=nil {_bcfa .SetBorderColor (_baac );
_bcfa .SetBorderOpacity (_gca );};_efdg =append (_efdg ,_bcfa );};};};};if _dbag :=_adc .PrstGeom ;_dbag !=nil {switch _dbag .PrstAttr {case _fg .ST_ShapeTypeRect :if _bgfc !=nil {_gacb :=_bbff .getShapeFromBlipFill (_bgfc ,_fabb ,_agc ,_fcc ,_cfd ,false );
_efdg =append (_efdg ,_gacb );}else {_eeba :=_bbff ._afec .NewRectangle (_fabb ,_agc ,_fcc ,_cfd );_eacg :=_bcg !=nil &&_bdc > 0;if _eacg {_eeba .SetFillColor (_bcg );_eeba .SetFillOpacity (_bdc );};_cbe :=_baac !=nil &&_gca > 0&&_gfbb > 0;if _cbe {_eeba .SetBorderWidth (_gfbb );
_eeba .SetBorderColor (_baac );_eeba .SetBorderOpacity (_gca );};if _eacg ||_cbe {_efdg =append (_efdg ,_eeba );};};case _fg .ST_ShapeTypeLine :_degb :=_bbff ._afec .NewLine (_fabb ,_agc ,_fabb +_fcc ,_agc +_cfd );_degb .SetLineWidth (_gfbb );if _baac !=nil {_degb .SetColor (_baac );
};_efdg =append (_efdg ,_degb );};};return _efdg ,_fabb ,_agc ,_fcc ,_cfd ,_bce ,_dfaa ;};func (_ceg *convertContext )renderCurrentStateToGoImage ()(_c .Image ,error ){_dace :=_e .MakeTempCreator (_ceg ._dcfc ,_ceg ._bgce );_dace .NewPage ();for _ ,_fece :=range _ceg ._baaf {if _fece !=nil {_dace .MoveTo (0,0);
_dace .Draw (_fece );};};_agbf ,_ddaf :=_e .GetPageFromCreator (_dace );if _ddaf !=nil {return nil ,_ddaf ;};return _ga .NewImageDevice ().Render (_agbf );};func (_cgb *convertContext )getShapes (_cbc *_baf .CT_Shape )[]_df .Drawable {_dbd :=[]_df .Drawable {};
_cabf :=_cbc .SpPr ;if _cabf ==nil {return _dbd ;};var _gbd bool ;if _bgc :=_cbc .UseBgFillAttr ;_bgc !=nil {_gbd =*_bgc ;};_ab ,_bd ,_efdb ,_gbde ,_acb ,_dbdg ,_abg :=_cgb .getShapesFromSpPr (_cabf ,_cbc .Style ,_gbd ,0.0,0.0);_dbd =append (_dbd ,_ab ...);
if _addg :=_cbc .TxBody ;_addg !=nil {_dda ,_aace ,_dfba ,_abd ,_bbbe :=_cgb .getPhData (_cbc );if _dda !=nil &&!_abg {_bd ,_efdb ,_gbde ,_acb =_e .GetDataFromXfrm (_dda );};_cbcb ,_fbb :=_cgb .makePdfBlockFromTxBody (_addg ,_aace ,_dfba ,_gbde ,_acb ,_dbdg ,_abd ,_bbbe );
if _fbb !=nil {_d .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_fbb );
}else if _cbcb !=nil {_cbcb .SetPos (_bd ,_efdb );_dbd =append (_dbd ,_cbcb );};};return _dbd ;};func _ddadc (_adgg ,_gacc *_fg .CT_TableStyleTextStyle )*_fg .CT_TableStyleTextStyle {_bcec :=_fg .NewCT_TableStyleTextStyle ();if _adgg !=nil {*_bcec =*_adgg ;
};if _gacc ==nil {return _bcec ;};if _bcec .BAttr ==_fg .ST_OnOffStyleTypeUnset {_bcec .BAttr =_gacc .BAttr ;};if _bcec .IAttr ==_fg .ST_OnOffStyleTypeUnset {_bcec .IAttr =_gacc .IAttr ;};if _bcec .Font ==nil {_bcec .Font =_gacc .Font ;};if _bcec .FontRef ==nil {_bcec .FontRef =_gacc .FontRef ;
};if _bcec .ScrgbClr ==nil {_bcec .ScrgbClr =_gacc .ScrgbClr ;};if _bcec .SrgbClr ==nil {_bcec .SrgbClr =_gacc .SrgbClr ;};if _bcec .HslClr ==nil {_bcec .HslClr =_gacc .HslClr ;};if _bcec .SysClr ==nil {_bcec .SysClr =_gacc .SysClr ;};if _bcec .SchemeClr ==nil {_bcec .SchemeClr =_gacc .SchemeClr ;
};if _bcec .PrstClr ==nil {_bcec .PrstClr =_gacc .PrstClr ;};return _bcec ;};func (_daaa *textboxContext )addTextSymbol (_gabd *symbol ){_baba :=_df .New ();_ecac :=_baba .NewStyledParagraph ();_ecac .SetMargins (0,0,0,0);_cbdd :=_ecac .Append (_gabd ._gcaf );
_eag :=0.0;if _gabd ._bgcb !=nil {_cbdd .Style =*_gabd ._bgcb ;if _gabd ._bgcb .CharSpacing !=0{_eag =_gabd ._bgcb .CharSpacing ;};};_gabd ._ffee =_ecac .Height ();_gabd ._fffd =_ecac .Height ()*1.2;if _gabd ._fffd < _daaa ._eea ._dfbf {_gabd ._fffd =_daaa ._eea ._dfbf ;
};if _gabd ._ffae ==0{_gabd ._ffae =_ecac .Width ()+_eag ;};if len (_daaa ._ffgf ._eaab )> 0{_eef :=_daaa ._ffgf ._eaab [len (_daaa ._ffgf ._eaab )-1]._gcaf ;if _daaa ._eea ._cdga ||_e .IsNoSpaceLanguage (_eef )||(_eef =="\u0020")!=(_gabd ._gcaf =="\u0020"){_daaa .addCurrentWordToParagraph ();
_daaa .newWord ();};};_daaa ._ffgf ._eaab =append (_daaa ._ffgf ._eaab ,_gabd );_gabd ._facg =_daaa ._ffgf ._fcfg ;_daaa ._ffgf ._fcfg +=_gabd ._ffae ;if _gabd ._gcaf !="\u0020"{_daaa ._ffgf ._bge =false ;};};func (_gfea *convertContext )renderPageWithDrawableToGoImage (_cdgaa _df .Drawable )(_c .Image ,error ){_fdeg :=_e .MakeTempCreator (_gfea ._dcfc ,_gfea ._bgce );
_fdeg .NewPage ();_fdeg .Draw (_cdgaa );_gfg ,_gdeb :=_e .GetPageFromCreator (_fdeg );if _gdeb !=nil {return nil ,_gdeb ;};return _ga .NewImageDevice ().Render (_gfg );};func (_ggd *convertContext )getColorFromSolidFill (_gfebg *_fg .CT_SolidColorFillProperties )(_df .Color ,float64 ){if _gfebg ==nil {return nil ,1;
};var _agcf string ;_ffff :=1.0;if _aeb :=_gfebg .SrgbClr ;_aeb !=nil {_agcf =_aeb .ValAttr ;_ffff =_e .GetOpacityFromColorTransform (_aeb .EG_ColorTransform );}else if _edef :=_gfebg .SchemeClr ;_edef !=nil {_agcf =_e .GetColorStringFromDmlColor (_ggd ._cbda .GetColorBySchemeColor (_edef .ValAttr ));
_agcf =_e .AdjustColor (_agcf ,_edef .EG_ColorTransform );_ffff =_e .GetOpacityFromColorTransform (_edef .EG_ColorTransform );};if _agcf !=""{_abfge :=_df .ColorRGBFromHex ("\u0023"+_agcf );return _abfge ,_ffff ;};return nil ,1;};func (_aaae *textboxContext )alignSymbolsVertically (){for _ ,_agae :=range _aaae ._adg {for _ ,_bdbb :=range _agae ._dbcad {_addb :=0.0;
for _ ,_ebac :=range _bdbb ._cgcd {for _ ,_aege :=range _ebac ._eaab {if _aege ._fffd > _addb {_addb =_aege ._fffd ;};};};for _ ,_ffdge :=range _bdbb ._cgcd {for _ ,_beeg :=range _ffdge ._eaab {if _beeg ._ffee < _addb {_beeg ._cbeb =_addb -_beeg ._ffee ;
};};};};};};func (_dgdb *convertContext )applyBlipEffectsOnImg (_edeac *_df .Image ,_bdae ,_dbdb float64 ,_cgcc []*_fg .CT_BlipChoice )*_df .Image {if len (_cgcc )==0{return _edeac ;};_edeac .SetPos (_bdae ,_dbdb );_cec ,_dgcc :=_dgdb .renderPageWithDrawableToGoImage (_edeac );
if _dgcc !=nil {_d .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_dgcc );
return _edeac ;};_gaea ,_dgcc :=_dgdb .renderCurrentStateToGoImage ();if _dgcc !=nil {_d .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_dgcc );
return _edeac ;};_cggf :=_cec .Bounds ();_ccgag :=_c .NewRGBA (_cggf );_ceb ,_bcbb :=_edeac .Width (),_edeac .Height ();for _ ,_beda :=range _cgcc {for _ ,_fagg :=range _beda .AlphaModFix {if _daae :=_fagg .AmtAttr ;_daae !=nil {if _ggea :=_daae .ST_PositivePercentageDecimal ;
_ggea !=nil {_ggad :=uint8 (255*(*_ggea )/100000);_bceb :=_c .NewUniform (_f .Alpha {_ggad });_bg .Draw (_ccgag ,_cggf ,_gaea ,_c .Point {0,0},_bg .Src );_bg .DrawMask (_ccgag ,_cggf ,_cec ,_c .Point {0,0},_bceb ,_c .Point {0,0},_bg .Over );};};};};_egdaa :=_c .Rect (int (_bdae ),int (_dbdb ),int (_bdae +_ceb )+1,int (_dbdb +_bcbb )+1);
_bcgf :=_e .CropImageByRect (_ccgag ,_egdaa );_cbgf ,_dgcc :=_dgdb ._afec .NewImageFromGoImage (_bcgf );if _dgcc !=nil {_d .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_dgcc );
return _edeac ;};return _cbgf ;};type background struct{_dgg _df .Color ;_dbgf float64 ;_gda *_fg .CT_BlipFillProperties ;};func _bace (_cabg int ,_edf bool )string {_geda :=(_cabg -1)/26+1;_gecf :=byte ((_cabg -1)%26);if _edf {_gecf +=byte (65);}else {_gecf +=byte (97);
};_eee :=_cc .NewBuffer ([]byte {});for _fdg :=0;_fdg < _geda ;_fdg ++{_eee .Write ([]byte {_gecf });};return _eee .String ();};func (_dfcb *textboxContext )drawParagraphs (){_dfcb ._caea .NewPage ();for _ ,_afed :=range _dfcb ._adg {for _ ,_fcb :=range _afed ._dbcad {for _ ,_cda :=range _fcb ._cgcd {for _ ,_badb :=range _cda ._eaab {_dfbc :=_dfcb ._caea .NewStyledParagraph ();
if _badb ._agad {_badb ._cbeb =0;}else if _badb ._cac {_badb ._cbeb =1.2*_fcb ._aafb -_badb ._ffee ;};_aagg :=_cda ._eceb +_badb ._facg ;_dfdd :=_afed ._bdee +_fcb ._ebfb +_badb ._cbeb ;_dfbc .SetPos (_aagg ,_dfdd );_bec :=_dfbc .Append (_badb ._gcaf );
if _badb ._bgcb !=nil {_bec .Style =*_badb ._bgcb ;};_dfcb ._caea .Draw (_dfbc );if _badb ._beb {_dcee :=_dfdd +_badb ._ffee +2;_e .DrawLine (_dfcb ._caea ,_aagg ,_dcee ,_aagg +_badb ._ffae ,_dcee ,1,_badb ._bgcb .Color );};};};};};};func _dfgb (_ffaf float64 )float64 {return _ffaf *_bab .Inch };
func (_bbb *convertContext )tileImage (_efe *_df .Image ,_bccg *_fg .CT_TileInfoProperties ,_cbd ,_aab float64 )*_df .Image {_gde ,_dbc :=1.0,1.0;if _eded :=_bccg .SxAttr ;_eded !=nil {_gde =_e .FromSTPercentage (_eded );};if _af :=_bccg .SyAttr ;_af !=nil {_dbc =_e .FromSTPercentage (_af );
};_adf :=_e .MakeTempCreator (_cbd ,_aab );_efe .Scale (_gde ,_dbc );_geg ,_efd :=_efe .Width (),_efe .Height ();var _eaa ,_fec float64 ;if _dgef :=_bccg .TxAttr ;_dgef !=nil {_eaa =_bab .FromEMU (_e .FromSTCoordinate (*_dgef ));};if _fac :=_bccg .TyAttr ;
_fac !=nil {_fec =_bab .FromEMU (_e .FromSTCoordinate (*_fac ));};if _eaa > 0{_eaa -=_geg ;};if _fec > 0{_fec -=_efd ;};_ged :=_bbb ._dcfc /_geg +1;_gdf :=_bbb ._bgce /_efd +1;for _agd :=0.0;_agd <=_ged ;_agd ++{_bccb :=_agd *_geg ;for _gdg :=0.0;_gdg <=_gdf ;
_gdg ++{_ffd :=_gdg *_efd ;_efe .SetPos (_bccb +_eaa ,_ffd +_fec );_adf .Draw (_efe );};};_gac ,_egf :=_e .GetPageFromCreator (_adf );if _egf !=nil {_d .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_egf );
return nil ;};_ccf ,_egf :=_ga .NewImageDevice ().Render (_gac );if _egf !=nil {_d .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_egf );return nil ;};_dfad ,_egf :=_bbb ._afec .NewImageFromGoImage (_ccf );
if _egf !=nil {_d .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_egf );return nil ;};return _dfad ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_e .FontStyle ;type prefixData struct{_abda string ;_dfd bool ;_aefd float64 ;_aaccc float64 ;};func _gdadg (_cdbc *_baf .CT_CommonSlideData ,_efce _baf .ST_PlaceholderType ,_bddb *uint32 ,_bgb bool )(*_fg .CT_Transform2D ,*_fg .CT_TextBody ,*bool ,*bool ){if _cdbc !=nil &&(_efce !=_baf .ST_PlaceholderTypeUnset ||!_bgb ){if _agfbb :=_cdbc .SpTree ;
_agfbb !=nil {for _ ,_fgbe :=range _agfbb .Choice {if _fgbe !=nil {for _ ,_ccef :=range _fgbe .Sp {if _ccef !=nil {_bgeb ,_ebc :=_efga (_ccef );if _efce ==_bgeb {if (_bgb &&_ebc ==nil )||(!_bgb &&_ebc !=nil &&*_ebc ==*_bddb ){var _cdfa *_fg .CT_Transform2D ;
if _ccef .SpPr !=nil {_cdfa =_ccef .SpPr .Xfrm ;};_ege :=_efce ==_baf .ST_PlaceholderTypeTitle ||_efce ==_baf .ST_PlaceholderTypeCtrTitle ;_dfe :=!_ege &&_efce !=_baf .ST_PlaceholderTypeUnset ;return _cdfa ,_ccef .TxBody ,&_ege ,&_dfe ;};};};};};};};};
return nil ,nil ,nil ,nil ;};func _cdb (_bcdg *_fg .CT_AdjPoint2D )(float64 ,float64 ){var _gega ,_ebg float64 ;_gcea ,_gfbe :=_bcdg .XAttr ,_bcdg .YAttr ;if _cdf :=_gcea .ST_Coordinate ;_cdf !=nil {_gega =_bab .FromEMU (_e .FromSTCoordinate (*_cdf ));
};if _ggc :=_gfbe .ST_Coordinate ;_ggc !=nil {_ebg =_bab .FromEMU (_e .FromSTCoordinate (*_ggc ));};return _gega ,_ebg ;};func _dedc (_bdfdg ,_bdaf *_fg .CT_TextBodyProperties )*_fg .CT_TextBodyProperties {_dffa :=_fg .NewCT_TextBodyProperties ();if _bdfdg !=nil {*_dffa =*_bdfdg ;
};if _bdaf ==nil {return _dffa ;};if _dffa .RotAttr ==nil {_dffa .RotAttr =_bdaf .RotAttr ;};if _dffa .SpcFirstLastParaAttr ==nil {_dffa .SpcFirstLastParaAttr =_bdaf .SpcFirstLastParaAttr ;};if _dffa .VertOverflowAttr ==_fg .ST_TextVertOverflowTypeUnset {_dffa .VertOverflowAttr =_bdaf .VertOverflowAttr ;
};if _dffa .HorzOverflowAttr ==_fg .ST_TextHorzOverflowTypeUnset {_dffa .HorzOverflowAttr =_bdaf .HorzOverflowAttr ;};if _dffa .VertAttr ==_fg .ST_TextVerticalTypeUnset {_dffa .VertAttr =_bdaf .VertAttr ;};if _dffa .WrapAttr ==_fg .ST_TextWrappingTypeUnset {_dffa .WrapAttr =_bdaf .WrapAttr ;
};if _dffa .LInsAttr ==nil {_dffa .LInsAttr =_bdaf .LInsAttr ;};if _dffa .TInsAttr ==nil {_dffa .TInsAttr =_bdaf .TInsAttr ;};if _dffa .RInsAttr ==nil {_dffa .RInsAttr =_bdaf .RInsAttr ;};if _dffa .BInsAttr ==nil {_dffa .BInsAttr =_bdaf .BInsAttr ;};if _dffa .NumColAttr ==nil {_dffa .NumColAttr =_bdaf .NumColAttr ;
};if _dffa .SpcColAttr ==nil {_dffa .SpcColAttr =_bdaf .SpcColAttr ;};if _dffa .RtlColAttr ==nil {_dffa .RtlColAttr =_bdaf .RtlColAttr ;};if _dffa .AnchorAttr ==_fg .ST_TextAnchoringTypeUnset {_dffa .AnchorAttr =_bdaf .AnchorAttr ;};if _dffa .AnchorCtrAttr ==nil {_dffa .AnchorCtrAttr =_bdaf .AnchorCtrAttr ;
};if _dffa .ForceAAAttr ==nil {_dffa .ForceAAAttr =_bdaf .ForceAAAttr ;};if _dffa .UprightAttr ==nil {_dffa .UprightAttr =_bdaf .UprightAttr ;};if _dffa .CompatLnSpcAttr ==nil {_dffa .CompatLnSpcAttr =_bdaf .CompatLnSpcAttr ;};if _dffa .PrstTxWarp ==nil {_dffa .PrstTxWarp =_bdaf .PrstTxWarp ;
};if _dffa .NoAutofit ==nil {_dffa .NoAutofit =_bdaf .NoAutofit ;};if _dffa .NormAutofit ==nil {_dffa .NormAutofit =_bdaf .NormAutofit ;};if _dffa .SpAutoFit ==nil {_dffa .SpAutoFit =_bdaf .SpAutoFit ;};if _dffa .Scene3d ==nil {_dffa .Scene3d =_bdaf .Scene3d ;
};if _dffa .Sp3d ==nil {_dffa .Sp3d =_bdaf .Sp3d ;};if _dffa .FlatTx ==nil {_dffa .FlatTx =_bdaf .FlatTx ;};if _dffa .ExtLst ==nil {_dffa .ExtLst =_bdaf .ExtLst ;};return _dffa ;};func (_ffaab *textboxContext )addCurrentParagraph (){_ffaab ._dbde =_ffaab ._eea ._bdee +_ffaab ._eea ._cgg +_ffaab ._eea ._bfg +_ffaab ._eea ._aag ;
_ffaab ._adg =append (_ffaab ._adg ,_ffaab ._eea );_ffaab .alignParagraph ();};func _eacgb (_cddgg float64 )float64 {return _cddgg *_bab .Millimeter };func (_dggd *textboxContext )addTextRun (_gbbb *_fg .EG_TextRun ,_eaaag *_fg .CT_TextCharacterProperties ,_aedbe _df .Color ,_bcfb *prefixData ){if _bfd :=_gbbb .Br ;
_bfd !=nil {_dggd .addCurrentWordToParagraph ();_dggd .newLine ();_dggd .newWord ();}else if _gecb :=_gbbb .R ;_gecb !=nil {var _gdgg _df .Color ;if _gecb .RPr !=nil &&_gecb .RPr .SolidFill !=nil {_gdgg ,_ =_dggd ._ddfe .getColorFromSolidFill (_gecb .RPr .SolidFill );
}else if _aedbe !=nil {_gdgg =_aedbe ;}else if _eaaag .SolidFill !=nil {_gdgg ,_ =_dggd ._ddfe .getColorFromSolidFill (_eaaag .SolidFill );}else {_gdgg =_df .ColorBlack ;};_dcgd :=_gadd (_gecb .RPr ,_eaaag );_cgag ,_dbaea ,_fbcf ,_dab :=_dggd ._ddfe .makeStyleFromRPr (_dcgd );
_cgag .Color =_gdgg ;if _bcfb !=nil {_dggd .addPrefix (_bcfb ,_cgag );};_afc :=_cdeg (_gecb .T );for _ ,_dafe :=range _afc {_dafe ._bgcb =_cgag ;_dafe ._agad =_dbaea ;_dafe ._cac =_fbcf ;_dafe ._beb =_dab ;if _dcgd .CapAttr ==_fg .ST_TextCapsTypeAll {_dafe ._gcaf =_fd .ToUpper (_dafe ._gcaf );
};_dggd .addTextSymbol (_dafe );};};};var _daff =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func (_bdfdb *textboxContext )addCurrentWordToParagraph (){if _bdfdb ._degf &&_bdfdb ._fdd ._bada +_bdfdb ._ffgf ._fcfg > _bdfdb ._fdd ._bced {_bdfdb .newLine ();
};if !_bdfdb ._ffgf ._bge ||len (_bdfdb ._fdd ._cgcd )> 0{_bdfdb ._ffgf ._eceb =_bdfdb ._fdd ._bada ;_bdfdb ._fdd ._cgcd =append (_bdfdb ._fdd ._cgcd ,_bdfdb ._ffgf );_bdfdb ._fdd ._bada +=_bdfdb ._ffgf ._fcfg ;for _ ,_ggec :=range _bdfdb ._ffgf ._eaab {_bdfdb .adjustHeights (_ggec ._fffd );
};};};func (_eca *convertContext )makePdfBlockFromTxBody (_gged *_fg .CT_TextBody ,_gggd *_fg .CT_TextBodyProperties ,_ebaa *_fg .CT_TextListStyle ,_dfgga ,_ffefc float64 ,_bgaa _df .Color ,_gabg ,_gdbf bool )(*_df .Block ,error ){var _ebbg *_fg .CT_TextParagraphProperties ;
if _ddff :=_gged .LstStyle ;_ddff !=nil {var _ddgf *_fg .CT_TextParagraphProperties ;if _ddff .Lvl1pPr !=nil {_ddgf =_ddff .Lvl1pPr ;};_ebbg =_ecg (_ddgf ,_ddff .DefPPr );};var _cabde *_fg .CT_TextParagraphProperties ;if _ebbg !=nil {if _gabg {_cabde =_eca ._abdb [0];
}else if _gdbf {_cabde =_eca ._dbab [0];}else {_cabde =_eca ._fede [0];};if _ebaa !=nil {_cabde =_ecg (_ecg (_ebaa .Lvl1pPr ,_ebaa .DefPPr ),_cabde );};_cabde =_ecg (_ebbg ,_cabde );}else {if _gabg {_cabde =_eca ._abae ;}else if _gdbf {_cabde =_eca ._efea ;
}else {_cabde =_eca ._dbdfg ;};};_bac ,_fgeb :=_eacgb (2.5),_eacgb (2.5);_eeg ,_abe :=_eacgb (1.3),_eacgb (1.3);_gccf :=true ;_fae :=_fg .ST_TextAnchoringTypeT ;if _gggd !=nil {if _cfda :=_gggd .AnchorAttr ;_cfda !=_fg .ST_TextAnchoringTypeUnset {_fae =_cfda ;
};};if _cabfe :=_gged .BodyPr ;_cabfe !=nil {if _fccc :=_cabfe .LInsAttr ;_fccc !=nil {_bac =_bab .FromEMU (_e .FromSTCoordinate32 (*_fccc ));};if _aacc :=_cabfe .TInsAttr ;_aacc !=nil {_eeg =_bab .FromEMU (_e .FromSTCoordinate32 (*_aacc ));};if _gcb :=_cabfe .RInsAttr ;
_gcb !=nil {_fgeb =_bab .FromEMU (_e .FromSTCoordinate32 (*_gcb ));};if _aedb :=_cabfe .BInsAttr ;_aedb !=nil {_abe =_bab .FromEMU (_e .FromSTCoordinate32 (*_aedb ));};_gccf =_cabfe .WrapAttr !=_fg .ST_TextWrappingTypeNone ;if _febf :=_cabfe .AnchorAttr ;
_febf !=_fg .ST_TextAnchoringTypeUnset {_fae =_cabfe .AnchorAttr ;};};_abeg :=_e .MakeTempCreator (_dfgga ,_ffefc );_abeg .SetPageMargins (_bac ,_fgeb ,_eeg ,_abe );_bdb :=&textboxContext {_ddfe :_eca ,_degf :_gccf ,_bbde :_dfgga -_bac -_fgeb ,_abfg :_ffefc -_eeg -_abe ,_caea :_abeg ,_adg :[]*paragraph {}};
_fdfe :=1;for _ ,_cbb :=range _gged .P {if _cbb !=nil {_daa :=_cbb .PPr ;var _dbca *prefixData ;if _daa !=nil &&_daa .BuNone ==nil {var _gdcd string ;var _cfg bool ;if _fgc :=_daa .BuAutoNum ;_fgc !=nil {var _fgb string ;if _efb :=_fgc .StartAtAttr ;_efb !=nil {_fdfe =int (*_efb );
};var _bdcd string ;switch _fgc .TypeAttr {case _fg .ST_TextAutonumberSchemeAlphaUcParenBoth ,_fg .ST_TextAutonumberSchemeAlphaUcParenR ,_fg .ST_TextAutonumberSchemeAlphaUcPeriod :_bdcd =_bace (_fdfe ,true );case _fg .ST_TextAutonumberSchemeAlphaLcParenBoth ,_fg .ST_TextAutonumberSchemeAlphaLcParenR ,_fg .ST_TextAutonumberSchemeAlphaLcPeriod :_bdcd =_bace (_fdfe ,false );
case _fg .ST_TextAutonumberSchemeRomanUcParenBoth ,_fg .ST_TextAutonumberSchemeRomanUcParenR ,_fg .ST_TextAutonumberSchemeRomanUcPeriod :_bdcd =_dcbe (_fdfe ,true );case _fg .ST_TextAutonumberSchemeRomanLcParenBoth ,_fg .ST_TextAutonumberSchemeRomanLcParenR ,_fg .ST_TextAutonumberSchemeRomanLcPeriod :_bdcd =_dcbe (_fdfe ,false );
default:_bdcd =_ba .Itoa (_fdfe );};switch _fgc .TypeAttr {case _fg .ST_TextAutonumberSchemeAlphaLcPeriod ,_fg .ST_TextAutonumberSchemeAlphaUcPeriod ,_fg .ST_TextAutonumberSchemeArabicPeriod ,_fg .ST_TextAutonumberSchemeRomanLcPeriod ,_fg .ST_TextAutonumberSchemeRomanUcPeriod ,_fg .ST_TextAutonumberSchemeArabicDbPeriod ,_fg .ST_TextAutonumberSchemeEa1ChsPeriod ,_fg .ST_TextAutonumberSchemeEa1ChtPeriod ,_fg .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_fg .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_fg .ST_TextAutonumberSchemeThaiAlphaPeriod ,_fg .ST_TextAutonumberSchemeThaiNumPeriod ,_fg .ST_TextAutonumberSchemeHindiAlphaPeriod ,_fg .ST_TextAutonumberSchemeHindiNumPeriod ,_fg .ST_TextAutonumberSchemeHindiAlpha1Period :_fgb ="\u002e";
case _fg .ST_TextAutonumberSchemeAlphaLcParenR ,_fg .ST_TextAutonumberSchemeAlphaUcParenR ,_fg .ST_TextAutonumberSchemeArabicParenR ,_fg .ST_TextAutonumberSchemeRomanLcParenR ,_fg .ST_TextAutonumberSchemeRomanUcParenR ,_fg .ST_TextAutonumberSchemeThaiAlphaParenR ,_fg .ST_TextAutonumberSchemeThaiNumParenR ,_fg .ST_TextAutonumberSchemeHindiNumParenR :_fgb ="\u0029";
};_gdcd =_bdcd +_fgb ;_fdfe ++;}else if _bccf :=_daa .BuChar ;_bccf !=nil {_aea :=_bccf .CharAttr ;if _faf ,_bdcde :=_daff [_aea ];_bdcde {_aea =string (rune (_faf ));}else {_aea ="\u2022";};_gdcd =_aea ;_cfg =true ;};if _gdcd !=""{var _efgc ,_eaef float64 ;
if _daa .MarLAttr !=nil {_efgc =_bab .FromEMU (int64 (*_daa .MarLAttr ));};if _daa .IndentAttr !=nil {_eaef =_bab .FromEMU (int64 (*_daa .IndentAttr ));};_dbca =&prefixData {_abda :_gdcd ,_dfd :_cfg ,_aefd :_efgc ,_aaccc :_eaef };};};_daa =_ecg (_daa ,_cabde );
_dffb :=_gadd (_cbb .EndParaRPr ,_daa .DefRPr );_bdb .newParagraph ();_bdb .assignPropsToCurrentParagraph (_daa );_bdb .newLine ();_bdb .newWord ();for _bde ,_gcde :=range _cbb .EG_TextRun {_bdb .addTextRun (_gcde ,_dffb ,_bgaa ,_dbca );if _bde > 0{_dbca =nil ;
};};_bdb .addCurrentWordToParagraph ();};_bdb .addCurrentParagraph ();};_bdb .alignVertically (_fae );_bdb .drawParagraphs ();return _e .MakeBlockFromCreator (_abeg );};func (_gcba *textboxContext )newWord (){_gcba ._ffgf =&word {_bge :true ,_eceb :_gcba ._fdd ._bada }};
func (_agde *convertContext )getColorFromMatrixReference (_bfb *_fg .CT_StyleMatrixReference )_df .Color {if _bfb ==nil {return nil ;};var _cfca _df .Color ;var _ccdg string ;if _dggb :=_bfb .SrgbClr ;_dggb !=nil {_ccdg =_dggb .ValAttr ;}else if _fdfc :=_bfb .SchemeClr ;
_fdfc !=nil {_ccdg =_e .GetColorStringFromDmlColor (_agde ._cdea .GetColorBySchemeColor (_fdfc .ValAttr ));_ccdg =_e .AdjustColor (_ccdg ,_fdfc .EG_ColorTransform );};if _ccdg !=""{_cfca =_df .ColorRGBFromHex ("\u0023"+_ccdg );};return _cfca ;};func _dcbe (_aae int ,_gdad bool )string {_ffga :=_cc .NewBuffer ([]byte {});
for _ ,_dggc :=range _feda {for {if _aae < _dggc ._fecc {break ;};_ffga .WriteString (_dggc ._ffaa );_aae -=_dggc ._fecc ;};};_fcd :=_ffga .String ();if _gdad {_fcd =_fd .ToUpper (_fcd );};return _fcd ;};func _efga (_bcff *_baf .CT_Shape )(_baf .ST_PlaceholderType ,*uint32 ){if _fca :=_bcff .NvSpPr ;
_fca !=nil {if _eaaae :=_fca .NvPr ;_eaaae !=nil {if _adb :=_eaaae .Ph ;_adb !=nil {return _adb .TypeAttr ,_adb .IdxAttr ;};};};return _baf .ST_PlaceholderTypeUnset ,nil ;};func _cdeg (_fbbc string )[]*symbol {_edg :=[]*symbol {};for _ ,_bcd :=range _fbbc {_edg =append (_edg ,&symbol {_gcaf :string (_bcd )});
};return _edg ;};type convertContext struct{_afec *_df .Creator ;_cgfd *_e .Rectangle ;_cdea *_ff .Presentation ;_cbda *_ff .Slide ;_gfbg *_baf .SldMaster ;_ddgfc *_baf .SldLayout ;_bgce float64 ;_dcfc float64 ;_baaf []_df .Drawable ;_gdd *background ;
_dbdfg *_fg .CT_TextParagraphProperties ;_ggaa *_fg .CT_TextCharacterProperties ;_abae *_fg .CT_TextParagraphProperties ;_gcf *_fg .CT_TextCharacterProperties ;_efea *_fg .CT_TextParagraphProperties ;_ebbc *_fg .CT_TextCharacterProperties ;_fede []*_fg .CT_TextParagraphProperties ;
_abdb []*_fg .CT_TextParagraphProperties ;_dbab []*_fg .CT_TextParagraphProperties ;_cbdc *_fg .Theme ;_caf *_fg .CT_ColorMappingOverride ;};func (_eg *convertContext )extractDefaultProperties (){_eb :=_eg ._cdea .X ();_dfb :=_eb .DefaultTextStyle ;var _bb ,_bbg ,_ed ,_ded ,_fdc ,_ee ,_egd ,_fa ,_eda ,_ag *_fg .CT_TextParagraphProperties ;
if _dfb !=nil {_bb =_dfb .DefPPr ;_bbg =_ecg (_dfb .Lvl1pPr ,_bb );_ed =_ecg (_dfb .Lvl2pPr ,_bb );_ded =_ecg (_dfb .Lvl3pPr ,_bb );_fdc =_ecg (_dfb .Lvl4pPr ,_bb );_ee =_ecg (_dfb .Lvl5pPr ,_bb );_egd =_ecg (_dfb .Lvl6pPr ,_bb );_fa =_ecg (_dfb .Lvl7pPr ,_bb );
_eda =_ecg (_dfb .Lvl8pPr ,_bb );_ag =_ecg (_dfb .Lvl9pPr ,_bb );_eg ._dbdfg =_bb ;_eg ._ggaa =_bb .DefRPr ;};_eg ._fede =make ([]*_fg .CT_TextParagraphProperties ,9);_eg ._fede [0]=_bbg ;_eg ._fede [1]=_ed ;_eg ._fede [2]=_ded ;_eg ._fede [3]=_fdc ;_eg ._fede [4]=_ee ;
_eg ._fede [5]=_egd ;_eg ._fede [6]=_fa ;_eg ._fede [7]=_eda ;_eg ._fede [8]=_ag ;_dc :=_eg ._cdea .SlideMasters ()[0].X ();_eeb :=_dc .TxStyles ;_bgf :=_eeb .TitleStyle ;_eg ._abae =_ecg (_bgf .DefPPr ,_bb );_eg ._gcf =_eg ._abae .DefRPr ;_eg ._abdb =make ([]*_fg .CT_TextParagraphProperties ,9);
_eg ._abdb [0]=_ecg (_bgf .Lvl1pPr ,_bbg );_eg ._abdb [1]=_ecg (_bgf .Lvl2pPr ,_ed );_eg ._abdb [2]=_ecg (_bgf .Lvl3pPr ,_ded );_eg ._abdb [3]=_ecg (_bgf .Lvl4pPr ,_fdc );_eg ._abdb [4]=_ecg (_bgf .Lvl5pPr ,_ee );_eg ._abdb [5]=_ecg (_bgf .Lvl6pPr ,_egd );
_eg ._abdb [6]=_ecg (_bgf .Lvl7pPr ,_fa );_eg ._abdb [7]=_ecg (_bgf .Lvl8pPr ,_eda );_eg ._abdb [8]=_ecg (_bgf .Lvl9pPr ,_ag );_gd :=_eeb .BodyStyle ;_eg ._efea =_ecg (_gd .DefPPr ,_bb );_eg ._ebbc =_eg ._efea .DefRPr ;_eg ._dbab =make ([]*_fg .CT_TextParagraphProperties ,9);
_eg ._dbab [0]=_ecg (_gd .Lvl1pPr ,_bbg );_eg ._dbab [1]=_ecg (_gd .Lvl2pPr ,_ed );_eg ._dbab [2]=_ecg (_gd .Lvl3pPr ,_ded );_eg ._dbab [3]=_ecg (_gd .Lvl4pPr ,_fdc );_eg ._dbab [4]=_ecg (_gd .Lvl5pPr ,_ee );_eg ._dbab [5]=_ecg (_gd .Lvl6pPr ,_egd );_eg ._dbab [6]=_ecg (_gd .Lvl7pPr ,_fa );
_eg ._dbab [7]=_ecg (_gd .Lvl8pPr ,_eda );_eg ._dbab [8]=_ecg (_gd .Lvl9pPr ,_ag );};type paragraph struct{_gbc float64 ;_cgg float64 ;_aag float64 ;_agga float64 ;_afecb float64 ;_cgee float64 ;_bdee float64 ;_bfg float64 ;_fbdf _fg .ST_TextAlignType ;
_dfbf float64 ;_cdga bool ;_dbcad []*line ;};func (_cbf *convertContext )getGroupConnectors (_fef *_baf .CT_Connector ,_cef float64 ,_gfb float64 )[]_df .Drawable {_aed ,_ ,_ ,_ ,_ ,_ ,_ :=_cbf .getShapesFromSpPr (_fef .SpPr ,_fef .Style ,false ,_cef ,_gfb );
return _aed ;};func (_fgfc *textboxContext )alignVertically (_eadc _fg .ST_TextAnchoringType ){_fgfc .alignParagraphsVertically (_eadc );_fgfc .alignSymbolsVertically ();};func (_egff *convertContext )getInfoFromLn (_aaaac *_fg .CT_LineProperties )(_df .Color ,float64 ,float64 ){if _aaaac ==nil ||_aaaac .NoFill !=nil {return nil ,0,0;
};var _dac float64 ;_ffgca ,_cba :=_egff .getColorFromSolidFill (_aaaac .SolidFill );if _caeb :=_aaaac .WAttr ;_caeb !=nil {_dac =_bab .FromEMU (int64 (*_caeb ));}else {_dac =1;};return _ffgca ,_dac ,_cba ;};func (_dgaf *textboxContext )alignParagraphsVertically (_bdec _fg .ST_TextAnchoringType ){if _bdec ==_fg .ST_TextAnchoringTypeT {return ;
};_gbdf :=0.0;for _ ,_fbba :=range _dgaf ._adg {_gbdf +=_fbba ._cgg +_fbba ._bfg +_fbba ._aag ;};var _dfaf float64 ;switch _bdec {case _fg .ST_TextAnchoringTypeCtr :_dfaf =(_dgaf ._abfg -_gbdf )/2;case _fg .ST_TextAnchoringTypeB :_dfaf =_dgaf ._abfg -_gbdf ;
};for _ ,_edeb :=range _dgaf ._adg {_edeb ._bdee +=_dfaf ;};};func _becd (_fbbd ,_ecfg *_fg .CT_TextBody )(*_fg .CT_TextBodyProperties ,*_fg .CT_TextListStyle ){if _fbbd ==nil &&_ecfg ==nil {return nil ,nil ;};if _fbbd ==nil {return _ecfg .BodyPr ,_ecfg .LstStyle ;
};if _ecfg ==nil {return _fbbd .BodyPr ,_fbbd .LstStyle ;};_gbga ,_gbbag :=_fbbd .BodyPr ,_fbbd .LstStyle ;_ggecda ,_abaf :=_ecfg .BodyPr ,_ecfg .LstStyle ;_caae :=_dedc (_gbga ,_ggecda );_geeb :=_bbfb (_gbbag ,_abaf );return _caae ,_geeb ;};func (_bbca *textboxContext )adjustHeights (_cabbb float64 ){if _bbca ._fdd ._aafb < _cabbb {_bbca ._eea ._bfg +=(_cabbb -_bbca ._fdd ._aafb );
_bbca ._fdd ._aafb =_cabbb ;};};func (_edac *textboxContext )newLine (){if _edac ._eea ==nil {_edac .newParagraph ();};_edea :=_edac ._eea ._bfg +_edac ._eea ._cgg ;_fgff :=&line {};_fgff ._cca =_edac ._eea ._afecb ;if len (_edac ._eea ._dbcad )==0{_fgff ._cca +=_edac ._eea ._agga ;
};_fgff ._bced =_edac ._eea ._cgee ;_fgff ._bada =_fgff ._cca ;_fgff ._ebfb =_edea ;_edac ._eea ._dbcad =append (_edac ._eea ._dbcad ,_fgff );_edac ._fdd =_fgff ;};func (_dbbd *convertContext )getStyleColors (_aggf *_fg .CT_ShapeStyle )(_df .Color ,_df .Color ,_df .Color ){var _dedgc ,_cfed ,_gfbd _df .Color ;
if _geec :=_aggf .LnRef ;_geec !=nil {_cfed =_dbbd .getColorFromMatrixReference (_geec );};if _ccbd :=_aggf .FillRef ;_ccbd !=nil {_gfbd =_dbbd .getColorFromMatrixReference (_ccbd );};if _efbd :=_aggf .FontRef ;_efbd !=nil {_dedgc =_dbbd .getColorFromFontReference (_efbd );
};return _dedgc ,_gfbd ,_cfed ;};func _gbcd (_bed *bool )bool {return _bed !=nil &&*_bed };func (_ffgc *convertContext )getBorderStyle (_gbff *_fg .CT_LineProperties )(_df .CellBorderStyle ,*_df .Color ,float64 ){if _gbff ==nil ||_gbff .NoFill !=nil {return _df .CellBorderStyleNone ,nil ,0;
};var _cdg _df .Color ;if _bad :=_gbff .SolidFill ;_bad !=nil {_cdg ,_ =_ffgc .getColorFromSolidFill (_bad );};_dedg :=0.0;if _adef :=_gbff .WAttr ;_adef !=nil {_dedg =_bab .FromEMU (int64 (*_adef ));};return _df .CellBorderStyleSingle ,&_cdg ,_dedg ;};
var _ccd =_eacgb (1.9);func _bbfb (_decg ,_cbac *_fg .CT_TextListStyle )*_fg .CT_TextListStyle {_bca :=_fg .NewCT_TextListStyle ();if _decg !=nil {*_bca =*_decg ;};if _cbac ==nil {return _bca ;};_bca .DefPPr =_ecg (_bca .DefPPr ,_cbac .DefPPr );_bca .Lvl1pPr =_ecg (_bca .Lvl1pPr ,_cbac .Lvl1pPr );
_bca .Lvl2pPr =_ecg (_bca .Lvl2pPr ,_cbac .Lvl2pPr );_bca .Lvl3pPr =_ecg (_bca .Lvl3pPr ,_cbac .Lvl3pPr );_bca .Lvl4pPr =_ecg (_bca .Lvl4pPr ,_cbac .Lvl4pPr );_bca .Lvl5pPr =_ecg (_bca .Lvl5pPr ,_cbac .Lvl5pPr );_bca .Lvl6pPr =_ecg (_bca .Lvl6pPr ,_cbac .Lvl6pPr );
_bca .Lvl7pPr =_ecg (_bca .Lvl7pPr ,_cbac .Lvl7pPr );_bca .Lvl8pPr =_ecg (_bca .Lvl8pPr ,_cbac .Lvl8pPr );_bca .Lvl9pPr =_ecg (_bca .Lvl9pPr ,_cbac .Lvl9pPr );return _bca ;};func _ccfb (_agea *_fg .CT_TextCharacterProperties ,_bfa *_fg .CT_TableStyleTextStyle )*_fg .CT_TextCharacterProperties {_abafa :=_fg .NewCT_TextCharacterProperties ();
if _agea !=nil {*_abafa =*_agea ;};if _bfa ==nil {return _abafa ;};if _abafa .BAttr ==nil &&_bfa .BAttr !=_fg .ST_OnOffStyleTypeUnset {_aec :=_bfa .BAttr ==_fg .ST_OnOffStyleTypeOn ;_abafa .BAttr =&_aec ;};if _abafa .IAttr ==nil &&_bfa .IAttr !=_fg .ST_OnOffStyleTypeUnset {_cbg :=_bfa .IAttr ==_fg .ST_OnOffStyleTypeOn ;
_abafa .IAttr =&_cbg ;};if _abafa .NoFill ==nil &&_abafa .SolidFill ==nil {_abafa .SolidFill =_fg .NewCT_SolidColorFillProperties ();_abafa .SolidFill .ScrgbClr =_bfa .ScrgbClr ;_abafa .SolidFill .SrgbClr =_bfa .SrgbClr ;_abafa .SolidFill .HslClr =_bfa .HslClr ;
_abafa .SolidFill .SysClr =_bfa .SysClr ;_abafa .SolidFill .SchemeClr =_bfa .SchemeClr ;_abafa .SolidFill .PrstClr =_bfa .PrstClr ;};if _eccf :=_bfa .Font ;_eccf !=nil &&_abafa .Latin ==nil &&_abafa .Ea ==nil &&_abafa .Cs ==nil {_abafa .Latin =_eccf .Latin ;
_abafa .Ea =_eccf .Ea ;_abafa .Cs =_eccf .Cs ;};return _abafa ;};func (_cdbf *convertContext )makePdfImageFromBlipFill (_aegg *_fg .CT_BlipFillProperties ,_geee bool )(*_df .Image ,[]*_fg .CT_BlipChoice ,error ){if _efa :=_aegg .Blip ;_efa !=nil {if _bbga :=_efa .EmbedAttr ;
_bbga !=nil {var _dea _a .ImageRef ;var _abfb bool ;if _geee {_dea ,_abfb =_cdbf ._cbda .GetLayoutImageByRelID (*_bbga );}else {_dea ,_abfb =_cdbf ._cbda .GetImageByRelID (*_bbga );};if _abfb {_ffcg ,_bdfgg :=_bf .Open (_dea .Path ());if _bdfgg !=nil {_d .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_bdfgg );
return nil ,nil ,_bdfgg ;};defer _ffcg .Close ();_cfdd ,_ ,_bdfgg :=_c .Decode (_ffcg );if _bdfgg !=nil {_d .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_bdfgg );return nil ,nil ,_bdfgg ;
};if _ffbe :=_aegg .SrcRect ;_ffbe !=nil {_aagf :=_cfdd .Bounds ().Size ();_afg :=_aagf .X ;_cacd :=_aagf .Y ;var _eebd ,_efed ,_befe ,_fcbf int ;var _gace bool ;if _bffe :=_ffbe .LAttr ;_bffe !=nil {_eebd =int (float64 (_afg )*_e .FromSTPercentage (_bffe ));
_gace =true ;}else {_eebd =0;};if _dfdb :=_ffbe .TAttr ;_dfdb !=nil {_befe =int (float64 (_cacd )*_e .FromSTPercentage (_dfdb ));_gace =true ;}else {_befe =0;};if _ggecd :=_ffbe .RAttr ;_ggecd !=nil {_efed =int (float64 (_afg )*(1-_e .FromSTPercentage (_ggecd )));
_gace =true ;}else {_efed =_afg ;};if _egg :=_ffbe .BAttr ;_egg !=nil {_fcbf =int (float64 (_cacd )*(1-_e .FromSTPercentage (_egg )));_gace =true ;}else {_fcbf =_cacd ;};if _gace {_cfdd =_e .CropImageByRect (_cfdd ,_c .Rect (_eebd ,_befe ,_efed +1,_fcbf +1));
};};_caba ,_bdfgg :=_cdbf ._afec .NewImageFromGoImage (_cfdd );_caba .SetEncoder (_bc .NewFlateEncoder ());if _bdfgg !=nil {_d .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_bdfgg );
return nil ,nil ,_bdfgg ;};return _caba ,_efa .Choice ,nil ;};};};return nil ,nil ,nil ;};type romanMatch struct{_fecc int ;_ffaa string ;};func (_fc *convertContext )makePdfBlockFromChart (_de *_gg .Chart ,_fb ,_db float64 )(*_df .Block ,error ){_ac :=_de .CT_RelId .IdAttr ;
_ef :=_fc ._cbda .GetChartSpaceByRelId (_ac );if _ef ==nil {return nil ,_g .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _ae *_fg .Theme ;_bcb :=_fc ._cdea .Themes ();if len (_bcb )> 0{_ae =_bcb [0];};return _e .MakeBlockFromChartSpace (_ef ,_fb ,_db ,_ae );
};func _gadd (_ace ,_dgbca *_fg .CT_TextCharacterProperties )*_fg .CT_TextCharacterProperties {_edeaf :=_fg .NewCT_TextCharacterProperties ();if _ace !=nil {*_edeaf =*_ace ;};if _dgbca ==nil {return _edeaf ;};if _edeaf .KumimojiAttr ==nil {_edeaf .KumimojiAttr =_dgbca .KumimojiAttr ;
};if _edeaf .LangAttr ==nil {_edeaf .LangAttr =_dgbca .LangAttr ;};if _edeaf .AltLangAttr ==nil {_edeaf .AltLangAttr =_dgbca .AltLangAttr ;};if _edeaf .SzAttr ==nil {_edeaf .SzAttr =_dgbca .SzAttr ;};if _edeaf .BAttr ==nil {_edeaf .BAttr =_dgbca .BAttr ;
};if _edeaf .IAttr ==nil {_edeaf .IAttr =_dgbca .IAttr ;};if _edeaf .UAttr ==_fg .ST_TextUnderlineTypeUnset {_edeaf .UAttr =_dgbca .UAttr ;};if _edeaf .StrikeAttr ==_fg .ST_TextStrikeTypeUnset {_edeaf .StrikeAttr =_dgbca .StrikeAttr ;};if _edeaf .KernAttr ==nil {_edeaf .KernAttr =_dgbca .KernAttr ;
};if _edeaf .CapAttr ==_fg .ST_TextCapsTypeUnset {_edeaf .CapAttr =_dgbca .CapAttr ;};if _edeaf .SpcAttr ==nil {_edeaf .SpcAttr =_dgbca .SpcAttr ;};if _edeaf .NormalizeHAttr ==nil {_edeaf .NormalizeHAttr =_dgbca .NormalizeHAttr ;};if _edeaf .BaselineAttr ==nil {_edeaf .BaselineAttr =_dgbca .BaselineAttr ;
};if _edeaf .NoProofAttr ==nil {_edeaf .NoProofAttr =_dgbca .NoProofAttr ;};if _edeaf .DirtyAttr ==nil {_edeaf .DirtyAttr =_dgbca .DirtyAttr ;};if _edeaf .ErrAttr ==nil {_edeaf .ErrAttr =_dgbca .ErrAttr ;};if _edeaf .SmtCleanAttr ==nil {_edeaf .SmtCleanAttr =_dgbca .SmtCleanAttr ;
};if _edeaf .SmtIdAttr ==nil {_edeaf .SmtIdAttr =_dgbca .SmtIdAttr ;};if _edeaf .BmkAttr ==nil {_edeaf .BmkAttr =_dgbca .BmkAttr ;};if _edeaf .Ln ==nil {_edeaf .Ln =_dgbca .Ln ;};if _edeaf .NoFill ==nil {_edeaf .NoFill =_dgbca .NoFill ;};if _edeaf .SolidFill ==nil {_edeaf .SolidFill =_dgbca .SolidFill ;
};if _edeaf .BlipFill ==nil {_edeaf .BlipFill =_dgbca .BlipFill ;};if _edeaf .EffectLst ==nil {_edeaf .EffectLst =_dgbca .EffectLst ;};if _edeaf .EffectDag ==nil {_edeaf .EffectDag =_dgbca .EffectDag ;};if _edeaf .Highlight ==nil {_edeaf .Highlight =_dgbca .Highlight ;
};if _edeaf .ULnTx ==nil {_edeaf .ULnTx =_dgbca .ULnTx ;};if _edeaf .ULn ==nil {_edeaf .ULn =_dgbca .ULn ;};if _edeaf .UFillTx ==nil {_edeaf .UFillTx =_dgbca .UFillTx ;};if _edeaf .UFill ==nil {_edeaf .UFill =_dgbca .UFill ;};if _edeaf .Latin ==nil {_edeaf .Latin =_dgbca .Latin ;
};if _edeaf .Ea ==nil {_edeaf .Ea =_dgbca .Ea ;};if _edeaf .Cs ==nil {_edeaf .Cs =_dgbca .Cs ;};if _edeaf .Sym ==nil {_edeaf .Sym =_dgbca .Sym ;};if _edeaf .Rtl ==nil {_edeaf .Rtl =_dgbca .Rtl ;};return _edeaf ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;
FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_ge .PdfFont ){_e .RegisterFont (name ,style ,font );};type symbol struct{_gcaf string ;_facg float64 ;_fffd float64 ;_ffee float64 ;_cbeb float64 ;_ffae float64 ;_bgcb *_df .TextStyle ;_gedd string ;
_agad bool ;_cac bool ;_beb bool ;};func (_bdff *convertContext )getShapeFromBlipFill (_fgec *_fg .CT_BlipFillProperties ,_afda ,_dgc ,_cdgf ,_ddd float64 ,_ceab bool )_df .Drawable {_deag ,_fcbfa ,_egcc :=_bdff .makePdfImageFromBlipFill (_fgec ,_ceab );
if _egcc !=nil {_d .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_egcc );
return nil ;};if _deag ==nil {return nil ;};if _fbf :=_fgec .Tile ;_fbf !=nil {_deag =_bdff .tileImage (_deag ,_fgec .Tile ,_cdgf ,_ddd );};if _gagd :=_fgec .Stretch ;_gagd !=nil {_deag ,_afda ,_dgc =_bdff .stretchImage (_deag ,_fgec .Stretch ,_afda ,_dgc ,_cdgf ,_ddd );
};if len (_fcbfa )==0{_deag .SetPos (_afda ,_dgc );return _deag ;};_deag =_bdff .applyBlipEffectsOnImg (_deag ,_afda ,_dgc ,_fcbfa );_deag .SetPos (_afda ,_dgc );return _deag ;};type line struct{_ebfb float64 ;_cca float64 ;_bced float64 ;_bada float64 ;
_aafb float64 ;_cgcd []*word ;};func (_cgef *textboxContext )assignPropsToCurrentParagraph (_cfcc *_fg .CT_TextParagraphProperties ){_gaa :=12.4;if _cfcc ==nil {_cgef ._eea ._dfbf =_gaa ;return ;};if _cfdf :=_cfcc .DefRPr ;_cfdf !=nil {_gfaa :=_cfdf .SzAttr ;
if _gfaa !=nil {_dgbc :=float64 (*_gfaa )/1200;if _gaa <=_dgbc {_gaa =_dgbc ;};};};if _bdfd :=_cfcc .MarLAttr ;_bdfd !=nil {_cgef ._eea ._afecb =_bab .FromEMU (int64 (*_bdfd ));};_cgef ._eea ._cgee =_cgef ._bbde ;if _face :=_cfcc .MarRAttr ;_face !=nil {_cgef ._eea ._cgee -=_bab .FromEMU (int64 (*_face ));
};if _adcf :=_cfcc .IndentAttr ;_adcf !=nil {_cgef ._eea ._agga =_bab .FromEMU (int64 (*_adcf ));};if _egbf :=_cfcc .LatinLnBrkAttr ;_egbf !=nil {_cgef ._eea ._cdga =*_egbf ;};if _adgd :=_cfcc .LnSpc ;_adgd !=nil {if _febb :=_adgd .SpcPct ;_febb !=nil {if _ffeee :=_febb .ValAttr .ST_TextSpacingPercent ;
_ffeee !=nil {_gaa =float64 (*_ffeee )/5000;};};};var _gcag float64 ;if _gedf :=_cfcc .SpcBef ;_gedf !=nil {if _afa :=_gedf .SpcPts ;_afa !=nil {_gcag =float64 (_afa .ValAttr )/100;};};_dced :=_cgef ._adg ;if len (_dced )> 0{_gcag -=_dced [len (_dced )-1]._aag ;
if _gcag < 0{_gcag =0;};};_cgef ._eea ._cgg =_gcag ;if _gffc :=_cfcc .SpcAft ;_gffc !=nil {if _eccb :=_gffc .SpcPts ;_eccb !=nil {_cgef ._eea ._aag =float64 (_eccb .ValAttr )/100;};};_cgef ._eea ._dfbf =_gaa ;_cgef ._eea ._fbdf =_cfcc .AlgnAttr ;};func _fbgb (_eaae *_fg .CT_TableCellProperties ,_bbdef *_fg .CT_TableStyleCellStyle ,_gece ,_dcea ,_aad ,_eegc bool )*_fg .CT_TableCellProperties {_edd :=_fg .NewCT_TableCellProperties ();
if _eaae !=nil {*_edd =*_eaae ;};if _bbdef ==nil {return _edd ;};if _ffbc :=_bbdef .FillRef ;_ffbc !=nil {_edgdb :=_fg .NewCT_SolidColorFillProperties ();_edgdb .ScrgbClr =_ffbc .ScrgbClr ;_edgdb .SrgbClr =_ffbc .SrgbClr ;_edgdb .HslClr =_ffbc .HslClr ;
_edgdb .SysClr =_ffbc .SysClr ;_edgdb .SchemeClr =_ffbc .SchemeClr ;_edgdb .PrstClr =_ffbc .PrstClr ;_edd .SolidFill =_edgdb ;};if _edd .NoFill ==nil &&_edd .SolidFill ==nil {if _cfae :=_bbdef .Fill ;_cfae !=nil {if _edd .NoFill ==nil {_edd .NoFill =_cfae .NoFill ;
};if _edd .SolidFill ==nil {_edd .SolidFill =_cfae .SolidFill ;};};};if _fegc :=_bbdef .TcBdr ;_fegc !=nil {if _edd .LnL ==nil {var _efcb *_fg .CT_ThemeableLineStyle ;if _aad {_efcb =_fegc .Left ;}else {_efcb =_fegc .InsideV ;};if _efcb !=nil {_edd .LnL =_efcb .Ln ;
};};if _edd .LnR ==nil {var _gdge *_fg .CT_ThemeableLineStyle ;if _eegc {_gdge =_fegc .Right ;}else {_gdge =_fegc .InsideV ;};if _gdge !=nil {_edd .LnR =_gdge .Ln ;};};if _edd .LnT ==nil {var _aceb *_fg .CT_ThemeableLineStyle ;if _gece {_aceb =_fegc .Top ;
}else {_aceb =_fegc .InsideH ;};if _aceb !=nil {_edd .LnT =_aceb .Ln ;};};if _edd .LnB ==nil {var _befc *_fg .CT_ThemeableLineStyle ;if _dcea {_befc =_fegc .Bottom ;}else {_befc =_fegc .InsideH ;};if _befc !=nil {_edd .LnB =_befc .Ln ;};};};return _edd ;
};func (_gccc *convertContext )getColorFromFontReference (_addc *_fg .CT_FontReference )_df .Color {var _fad _df .Color ;var _bcbe string ;if _gbba :=_addc .SrgbClr ;_gbba !=nil {_bcbe =_gbba .ValAttr ;}else if _aabf :=_addc .SchemeClr ;_aabf !=nil {_bcbe =_e .GetColorStringFromDmlColor (_gccc ._cdea .GetColorBySchemeColor (_aabf .ValAttr ));
_bcbe =_e .AdjustColor (_bcbe ,_aabf .EG_ColorTransform );};if _bcbe !=""{_fad =_df .ColorRGBFromHex ("\u0023"+_bcbe );};return _fad ;};func (_bagf *convertContext )getPhData (_dag *_baf .CT_Shape )(*_fg .CT_Transform2D ,*_fg .CT_TextBodyProperties ,*_fg .CT_TextListStyle ,bool ,bool ){_agfb ,_afde :=_efga (_dag );
_dfff :=_afde ==nil ;_bfcc ,_bgcec ,_accf ,_ced :=_gdadg (_bagf ._gfbg .CSld ,_agfb ,_afde ,_dfff );_efec ,_cbdg ,_bggc ,_daec :=_gdadg (_bagf ._ddgfc .CSld ,_agfb ,_afde ,_dfff );if _efec ==nil {_efec =_bfcc ;};_cfaf ,_bcee :=_becd (_cbdg ,_bgcec );var _eagd ,_fee bool ;
if _bggc ==nil {if _accf !=nil {_eagd =*_accf ;};}else {_eagd =*_bggc ;};if _daec ==nil {if _ced !=nil {_fee =*_ced ;};}else {_fee =*_daec ;};return _efec ,_cfaf ,_bcee ,_eagd ,_fee ;};type word struct{_eaab []*symbol ;_eceb float64 ;_fcfg float64 ;_bge bool ;
};var _feda =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
func (_add *convertContext )drawSlide (){_add ._afec .NewPage ();for _ ,_gebb :=range _add ._baaf {if _gebb !=nil {_add ._afec .MoveTo (0,0);_add ._afec .Draw (_gebb );};};};func (_eebca *convertContext )stretchImage (_dedd *_df .Image ,_cgf *_fg .CT_StretchInfoProperties ,_cfe ,_cde ,_ddb ,_gad float64 )(*_df .Image ,float64 ,float64 ){_dff :=_cgf .FillRect ;
if _dff ==nil {_cfa :=_dedd .Width ()/_dedd .Height ();_agff :=_ddb /_gad ;var _effd ,_acc float64 ;if _cfa > _agff {_acc =_gad ;_effd =_gad *_cfa ;}else {_effd =_ddb ;_acc =_ddb /_cfa ;};_dedd .Scale (_effd /_dedd .Width (),_acc /_dedd .Height ());return _dedd ,_cfe ,_cde ;
};var _gfe ,_cgfe ,_deg ,_be float64 ;if _feb :=_dff .LAttr ;_feb !=nil {_deg =_e .FromSTPercentage (_feb );};if _cga :=_dff .TAttr ;_cga !=nil {_gfe =_e .FromSTPercentage (_cga );};if _bga :=_dff .RAttr ;_bga !=nil {_be =_e .FromSTPercentage (_bga );};
if _ead :=_dff .BAttr ;_ead !=nil {_cgfe =_e .FromSTPercentage (_ead );};_ffefa :=_ddb *(1-_deg -_be );_eae :=_gad *(1-_gfe -_cgfe );_dedd .Scale (_ffefa /_dedd .Width (),_eae /_dedd .Height ());return _dedd ,_cfe +_deg *_ddb ,_cde +_gfe *_gad ;};