//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_fa "bytes";_c "errors";_cdc "github.com/unidoc/unioffice/common";_aa "github.com/unidoc/unioffice/common/logger";_fc "github.com/unidoc/unioffice/common/tempstorage";_b "github.com/unidoc/unioffice/internal/convertutils";_gc "github.com/unidoc/unioffice/measurement";
_ba "github.com/unidoc/unioffice/presentation";_cf "github.com/unidoc/unioffice/schema/soo/dml";_gd "github.com/unidoc/unioffice/schema/soo/dml/chart";_bc "github.com/unidoc/unioffice/schema/soo/pml";_ae "github.com/unidoc/unipdf/v3/contentstream/draw";
_gcf "github.com/unidoc/unipdf/v3/core";_ag "github.com/unidoc/unipdf/v3/creator";_bb "github.com/unidoc/unipdf/v3/model";_aaf "github.com/unidoc/unipdf/v3/render";_cd "image";_f "image/color";_g "image/draw";_db "math";_a "strconv";_fd "strings";);func (_dcgf *textboxContext )addTextRun (_dggg *_cf .EG_TextRun ,_eagg *_cf .CT_TextCharacterProperties ,_aefc _ag .Color ,_cdgg *prefixData ){if _dbef :=_dggg .Br ;
_dbef !=nil {_dcgf .addCurrentWordToParagraph ();_dcgf .newLine ();_dcgf .newWord ();}else if _eebeb :=_dggg .R ;_eebeb !=nil {var _fcdcd _ag .Color ;if _eebeb .RPr !=nil &&_eebeb .RPr .SolidFill !=nil {_fcdcd ,_ =_dcgf ._dcde .getColorFromSolidFill (_eebeb .RPr .SolidFill );
}else if _aefc !=nil {_fcdcd =_aefc ;}else if _eagg .SolidFill !=nil {_fcdcd ,_ =_dcgf ._dcde .getColorFromSolidFill (_eagg .SolidFill );}else {_fcdcd =_ag .ColorBlack ;};_fbee :=_efg (_eebeb .RPr ,_eagg );_cdbf ,_aebe ,_gaag ,_caaf :=_dcgf ._dcde .makeStyleFromRPr (_fbee );
_cdbf .Color =_fcdcd ;if _cdgg !=nil {_dcgf .addPrefix (_cdgg ,_cdbf );};_gbcg :=_aedf (_eebeb .T );for _ ,_gffg :=range _gbcg {_gffg ._eee =_cdbf ;_gffg ._ceb =_aebe ;_gffg ._cacb =_gaag ;_gffg ._dcg =_caaf ;if _fbee .CapAttr ==_cf .ST_TextCapsTypeAll {_gffg ._dbdc =_fd .ToUpper (_gffg ._dbdc );
};_dcgf .addTextSymbol (_gffg );};};};func (_ageg *convertContext )makePdfDivisionFromTxBody (_bbe *_cf .CT_TextBody ,_edd *_cf .CT_TableStyleTextStyle )*_ag .Division {_gbca :=_ageg ._gdfc .NewDivision ();_fed :=_ageg ._deg ;_cbff :=_cf .ST_TextAnchoringTypeT ;
if _gcad :=_bbe .BodyPr ;_gcad !=nil {if _def :=_gcad .AnchorAttr ;_def !=_cf .ST_TextAnchoringTypeUnset {_cbff =_gcad .AnchorAttr ;};};if _ged :=_bbe .LstStyle ;_ged !=nil {var _aacc *_cf .CT_TextParagraphProperties ;if _ged .Lvl1pPr !=nil {_aacc =_ged .Lvl1pPr ;
}else {_aacc =_ageg ._eec [0];};_fed =_ebfcd (_aacc ,_ebfcd (_ged .DefPPr ,_fed ));};for _ ,_aeg :=range _bbe .P {if _aeg !=nil {_aafef :=_ageg ._gdfc .NewStyledParagraph ();_cbg :=_ebfcd (_aeg .PPr ,_fed );_fec :=_efg (_aeg .EndParaRPr ,_cbg .DefRPr );
switch _cbg .AlgnAttr {case _cf .ST_TextAlignTypeR :_aafef .SetTextAlignment (_ag .TextAlignmentRight );case _cf .ST_TextAlignTypeCtr :_aafef .SetTextAlignment (_ag .TextAlignmentCenter );case _cf .ST_TextAlignTypeJust :_aafef .SetTextAlignment (_ag .TextAlignmentJustify );
};if len (_aeg .EG_TextRun )==0{_aafef .Append ("\u000a");_gbca .Add (_aafef );continue ;};for _ ,_cdb :=range _aeg .EG_TextRun {if _dce :=_cdb .Br ;_dce !=nil {_aafef .Append ("\u000a");}else if _cgc :=_cdb .R ;_cgc !=nil {_bbd :=_cbgb (_cgc .RPr ,_edd );
_bbd =_efg (_bbd ,_fec );var _bef _ag .Color ;if _bbd .SolidFill !=nil {_bef ,_ =_ageg .getColorFromSolidFill (_bbd .SolidFill );}else {_bef =_ag .ColorBlack ;};_ec ,_dbegf ,_aef ,_ :=_ageg .makeStyleFromRPr (_bbd );_ec .Color =_bef ;if _dbegf {_ec .TextRise =0.5;
}else if _aef {_ec .TextRise =-0.5;};_dfgc :=_cgc .T ;if _bbd .CapAttr ==_cf .ST_TextCapsTypeAll {for _ ,_gcef :=range _dfgc {_gcef =[]rune (_fd .ToUpper (string (_gcef )))[0];};};_agfg :=_aafef .Append (_dfgc );_agfg .Style =*_ec ;};};_ =_cbff ;_gbca .Add (_aafef );
};};return _gbca ;};func (_gecc *convertContext )getColorFromFontReference (_ggb *_cf .CT_FontReference )_ag .Color {var _fedc _ag .Color ;var _fdab string ;if _gga :=_ggb .SrgbClr ;_gga !=nil {_fdab =_gga .ValAttr ;}else if _acec :=_ggb .SchemeClr ;_acec !=nil {_fdab =_b .GetColorStringFromDmlColor (_gecc ._bdbg .GetColorBySchemeColor (_acec .ValAttr ));
_fdab =_b .AdjustColor (_fdab ,_acec .EG_ColorTransform );};if _fdab !=""{_fedc =_ag .ColorRGBFromHex ("\u0023"+_fdab );};return _fedc ;};func (_dacc *convertContext )makePdfBlockFromTable (_cfb *_cf .Tbl ,_gage float64 )*_ag .Table {_bdce :=_cfb .TblGrid ;
if _bdce ==nil {return nil ;};_eaac :=len (_bdce .GridCol );if _eaac ==0{return nil ;};_aede :=[]float64 {};_gfd :=0.0;for _ ,_acf :=range _bdce .GridCol {_fecae :=_gc .FromEMU (_b .FromSTCoordinate (_acf .WAttr ));_aede =append (_aede ,_fecae );_gfd +=_fecae ;
};_gabd :=[]float64 {};for _bdb :=0;_bdb < _eaac ;_bdb ++{_gabd =append (_gabd ,_aede [_bdb ]/_gfd );};_bedb :=_dacc ._gdfc .NewTable (_eaac );_bedb .SetColumnWidths (_gabd ...);_bcce :=_cfb .TblPr ;var _cegb *_cf .CT_TableStyle ;if _adbg :=_bcce .Choice ;
_adbg !=nil {if _adbg .TableStyle !=nil {_cegb =_adbg .TableStyle ;}else if _adbg .TableStyleId !=nil {_cegb =_dacc ._bdbg .GetTableStyleById (*_adbg .TableStyleId );};};_gge :=_cf .NewCT_TablePartStyle ();_gge .TcStyle =_cf .NewCT_TableStyleCellStyle ();
_gge .TcTxStyle =_cf .NewCT_TableStyleTextStyle ();if _cegb !=nil {if _cegb .WholeTbl !=nil {*_gge =*_cegb .WholeTbl ;};if _cegb .TblBg !=nil {if _gge .TcStyle .Fill ==nil {_gge .TcStyle .Fill =_cegb .TblBg .Fill ;};};};if _gge .TcStyle .Fill ==nil {_gge .TcStyle .Fill =_cf .NewCT_FillProperties ();
_gge .TcStyle .Fill .NoFill =_bcce .NoFill ;_gge .TcStyle .Fill .SolidFill =_bcce .SolidFill ;};_bgeg :=len (_cfb .Tr );for _affe ,_bfgg :=range _cfb .Tr {_dffd :=_affe ==0;_eaf :=_affe ==_bgeg -1;_dfcf :=_affe %2==0;_dcc :=len (_bfgg .Tc );var _gdbf *_cf .CT_TablePartStyle ;
if _cegb !=nil {if _dffd {_gdbf =_cegb .FirstRow ;}else if _dfcf {_gdbf =_cegb .Band2H ;}else {_gdbf =_cegb .Band1H ;};};var _cca float64 ;for _dfdc ,_caf :=range _bfgg .Tc {_cfbf :=_dfdc ==0;_gfab :=_dfdc ==_dcc -1;_bgea :=_dfdc %2==0;var _befe *_cf .CT_TablePartStyle ;
if _cegb !=nil {if _cfbf {_befe =_cegb .FirstCol ;}else if _bgea {_befe =_cegb .Band2V ;}else {_befe =_cegb .Band1V ;};};_edb :=_cbcd (_cbcd (_befe ,_gdbf ),_gge );_cec :=_dacc .addCellToTable (_bedb ,_caf ,_edb ,_gage *_gabd [_dfdc ],_dffd ,_eaf ,_cfbf ,_gfab );
if _cec > _cca {_cca =_cec ;};};_ebba :=_gc .FromEMU (_b .FromSTCoordinate (_bfgg .HAttr ));if _ebba < _cca {_ebba =_cca ;};if _ebba < _afad (4){_ebba =_afad (4);};_bedb .SetRowHeight (_bedb .CurRow (),_ebba );};return _bedb ;};func (_dggf *textboxContext )newLine (){if _dggf ._fgcd ==nil {_dggf .newParagraph ();
};_gae :=_dggf ._fgcd ._ccf +_dggf ._fgcd ._ccc ;_adg :=&line {};_adg ._ebef =_dggf ._fgcd ._dccd ;if len (_dggf ._fgcd ._cdeb )==0{_adg ._ebef +=_dggf ._fgcd ._dcfe ;};_adg ._dgfb =_dggf ._fgcd ._fabc ;_adg ._adbgb =_adg ._ebef ;_adg ._bfeg =_gae ;_dggf ._fgcd ._cdeb =append (_dggf ._fgcd ._cdeb ,_adg );
_dggf ._egd =_adg ;};func (_eggb *convertContext )getColorFromSolidFill (_bfc *_cf .CT_SolidColorFillProperties )(_ag .Color ,float64 ){if _bfc ==nil {return nil ,1;};var _gffb string ;_eeab :=1.0;if _fcbe :=_bfc .SrgbClr ;_fcbe !=nil {_gffb =_fcbe .ValAttr ;
_eeab =_b .GetOpacityFromColorTransform (_fcbe .EG_ColorTransform );}else if _fafc :=_bfc .SchemeClr ;_fafc !=nil {_gffb =_b .GetColorStringFromDmlColor (_eggb ._aaee .GetColorBySchemeColor (_fafc .ValAttr ));_gffb =_b .AdjustColor (_gffb ,_fafc .EG_ColorTransform );
_eeab =_b .GetOpacityFromColorTransform (_fafc .EG_ColorTransform );};if _gffb !=""{_aaff :=_ag .ColorRGBFromHex ("\u0023"+_gffb );return _aaff ,_eeab ;};return nil ,1;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;
FontStyle_BoldItalic FontStyle =3;);func _aedf (_dfaa string )[]*symbol {_acbc :=[]*symbol {};for _ ,_cegf :=range _dfaa {_acbc =append (_acbc ,&symbol {_dbdc :string (_cegf )});};return _acbc ;};func _afad (_fgdf float64 )float64 {return _fgdf *_gc .Millimeter };


// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _b .RegisterFontsFromDirectory (dirName )};func (_ccef *textboxContext )addCurrentParagraph (){_ccef ._bbad =_ccef ._fgcd ._bdcb +_ccef ._fgcd ._ccc +_ccef ._fgcd ._ccf +_ccef ._fgcd ._ebg ;
_ccef ._bbag =append (_ccef ._bbag ,_ccef ._fgcd );_ccef .alignParagraph ();};func (_fgf *convertContext )makeStyleFromRPr (_afed *_cf .CT_TextCharacterProperties )(*_ag .TextStyle ,bool ,bool ,bool ){var _gcb ,_gafe ,_ffdc bool ;_cdda :=_fgf ._gdfc .NewTextStyle ();
if _afed !=nil {_bgd :=_b .FontStyle_Regular ;_fba :=_dada (_afed .BAttr );_fdda :=_dada (_afed .IAttr );if _fba &&_fdda {_bgd =_b .FontStyle_BoldItalic ;}else if _fba {_bgd =_b .FontStyle_Bold ;}else if _fdda {_bgd =_b .FontStyle_Italic ;};_ffdc =_afed .UAttr !=_cf .ST_TextUnderlineTypeUnset &&_afed .UAttr !=_cf .ST_TextUnderlineTypeNone ;
_ccb :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _cggf :=_afed .Latin ;_cggf !=nil {_ccb =_cggf .TypefaceAttr ;}else if _ecc :=_afed .Ea ;_ecc !=nil {_ccb =_ecc .TypefaceAttr ;}else if _dgf :=_afed .Cs ;_dgf !=nil {_ccb =_dgf .TypefaceAttr ;}else if _dga :=_afed .Sym ;
_dga !=nil {_ccb =_dga .TypefaceAttr ;};if _gea ,_eag :=_b .StdFontsMap [_ccb ];_eag {_cdda .Font =_b .AssignStdFontByName (_cdda ,_gea [_bgd ]);}else if _edc :=_b .GetRegisteredFont (_ccb ,_bgd );_edc !=nil {_cdda .Font =_edc ;}else {_aa .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_ccb ,_bgd );
_cdda .Font =_b .AssignStdFontByName (_cdda ,_b .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_bgd ]);};var _afac float64 ;if _aafgb :=_afed .SzAttr ;_aafgb !=nil {_afac =_db .Round (float64 (*_aafgb )/100)-0.5;}else {_afac =_b .DefaultFontSize ;
};if _abeg :=_afed .BaselineAttr ;_abeg !=nil {if _bccg :=_abeg .ST_PercentageDecimal ;_bccg !=nil {if *_bccg > 0{_gcb =true ;}else if *_bccg < 0{_gafe =true ;};};};if _gcb ||_gafe {_afac =_db .Round (_afac *0.64);};_cdda .FontSize =_afac ;_bacc :=0.0;
if _agab :=_afed .SpcAttr ;_agab !=nil {if _gbf :=_agab .ST_TextPointUnqualified ;_gbf !=nil &&*_gbf > 0{_bacc =float64 (*_gbf )/100;};};_cdda .CharSpacing =_bacc ;};return &_cdda ,_gcb ,_gafe ,_ffdc ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_ba .Presentation )*_ag .Creator {_cfg :=pr .X ().SldSz ;_aad :=_gc .FromEMU (int64 (_cfg .CxAttr ));_fag :=_gc .FromEMU (int64 (_cfg .CyAttr ));_bd :=_ag .PageSize {_aad ,_fag };_gff :=_ag .New ();_gff .SetPageSize (_bd );var _ce *_cf .Theme ;
if len (pr .Themes ())> 0{_ce =pr .Themes ()[0];};for _ ,_aea :=range pr .Slides (){if _aea .X ()==nil {continue ;};_add :=&convertContext {_gdfc :_gff ,_aaee :&_aea ,_gadd :_aea .GetSlideLayout (),_aegf :pr .SlideMasters ()[0].X (),_bdbg :pr ,_fbbg :_ce ,_cfba :_aea .X ().ClrMapOvr ,_eff :_bd [1],_bgc :_bd [0]};
_add .extractDefaultProperties ();_add .makeSlide ();_add .drawSlide ();};return _gff ;};var _dffa =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func _bfda (_cbbc *_bc .CT_Shape )(_bc .ST_PlaceholderType ,*uint32 ){if _eggf :=_cbbc .NvSpPr ;
_eggf !=nil {if _befd :=_eggf .NvPr ;_befd !=nil {if _bgda :=_befd .Ph ;_bgda !=nil {return _bgda .TypeAttr ,_bgda .IdxAttr ;};};};return _bc .ST_PlaceholderTypeUnset ,nil ;};func (_abee *textboxContext )alignParagraph (){_afg :=_abee ._fgcd ;if _afg ._eebab ==_cf .ST_TextAlignTypeL {return ;
};_becg :=len (_afg ._cdeb )-1;for _ccaa ,_cadd :=range _afg ._cdeb {_ddba :=true ;_aaebf :=len (_cadd ._gdgc );_gada :=0.0;for _cded :=len (_cadd ._gdgc )-1;_cded >=0;_cded --{_efc :=_cadd ._gdgc [_cded ];if _ddba &&_efc ._fcbd {_aaebf =_cded ;}else {_ddba =false ;
for _ ,_bafb :=range _efc ._eecg {_gada +=_bafb ._dea ;};};};_cadd ._gdgc =_cadd ._gdgc [:_aaebf ];_ggdgf :=_cadd ._dgfb -_cadd ._ebef -_gada ;switch _afg ._eebab {case _cf .ST_TextAlignTypeR :_cadd .moveRight (_ggdgf );case _cf .ST_TextAlignTypeCtr :_cadd .moveRight (_ggdgf /2);
case _cf .ST_TextAlignTypeJust :if _ccaa !=_becg {_begee :=[]*word {};for _ ,_afgc :=range _cadd ._gdgc {if _afgc ._fcbd {_begee =append (_begee ,_afgc );};};_bfed :=_ggdgf /float64 (len (_begee ));for _ ,_bbga :=range _begee {_bbga ._gcaf +=_bfed ;};var _efad *word ;
for _ ,_badg :=range _cadd ._gdgc {if _efad !=nil {_badg ._eccg =_efad ._eccg +_efad ._gcaf ;};_efad =_badg ;};};};};};func _efg (_badgc ,_dcfc *_cf .CT_TextCharacterProperties )*_cf .CT_TextCharacterProperties {_efcg :=_cf .NewCT_TextCharacterProperties ();
if _badgc !=nil {*_efcg =*_badgc ;};if _dcfc ==nil {return _efcg ;};if _efcg .KumimojiAttr ==nil {_efcg .KumimojiAttr =_dcfc .KumimojiAttr ;};if _efcg .LangAttr ==nil {_efcg .LangAttr =_dcfc .LangAttr ;};if _efcg .AltLangAttr ==nil {_efcg .AltLangAttr =_dcfc .AltLangAttr ;
};if _efcg .SzAttr ==nil {_efcg .SzAttr =_dcfc .SzAttr ;};if _efcg .BAttr ==nil {_efcg .BAttr =_dcfc .BAttr ;};if _efcg .IAttr ==nil {_efcg .IAttr =_dcfc .IAttr ;};if _efcg .UAttr ==_cf .ST_TextUnderlineTypeUnset {_efcg .UAttr =_dcfc .UAttr ;};if _efcg .StrikeAttr ==_cf .ST_TextStrikeTypeUnset {_efcg .StrikeAttr =_dcfc .StrikeAttr ;
};if _efcg .KernAttr ==nil {_efcg .KernAttr =_dcfc .KernAttr ;};if _efcg .CapAttr ==_cf .ST_TextCapsTypeUnset {_efcg .CapAttr =_dcfc .CapAttr ;};if _efcg .SpcAttr ==nil {_efcg .SpcAttr =_dcfc .SpcAttr ;};if _efcg .NormalizeHAttr ==nil {_efcg .NormalizeHAttr =_dcfc .NormalizeHAttr ;
};if _efcg .BaselineAttr ==nil {_efcg .BaselineAttr =_dcfc .BaselineAttr ;};if _efcg .NoProofAttr ==nil {_efcg .NoProofAttr =_dcfc .NoProofAttr ;};if _efcg .DirtyAttr ==nil {_efcg .DirtyAttr =_dcfc .DirtyAttr ;};if _efcg .ErrAttr ==nil {_efcg .ErrAttr =_dcfc .ErrAttr ;
};if _efcg .SmtCleanAttr ==nil {_efcg .SmtCleanAttr =_dcfc .SmtCleanAttr ;};if _efcg .SmtIdAttr ==nil {_efcg .SmtIdAttr =_dcfc .SmtIdAttr ;};if _efcg .BmkAttr ==nil {_efcg .BmkAttr =_dcfc .BmkAttr ;};if _efcg .Ln ==nil {_efcg .Ln =_dcfc .Ln ;};if _efcg .NoFill ==nil {_efcg .NoFill =_dcfc .NoFill ;
};if _efcg .SolidFill ==nil {_efcg .SolidFill =_dcfc .SolidFill ;};if _efcg .BlipFill ==nil {_efcg .BlipFill =_dcfc .BlipFill ;};if _efcg .EffectLst ==nil {_efcg .EffectLst =_dcfc .EffectLst ;};if _efcg .EffectDag ==nil {_efcg .EffectDag =_dcfc .EffectDag ;
};if _efcg .Highlight ==nil {_efcg .Highlight =_dcfc .Highlight ;};if _efcg .ULnTx ==nil {_efcg .ULnTx =_dcfc .ULnTx ;};if _efcg .ULn ==nil {_efcg .ULn =_dcfc .ULn ;};if _efcg .UFillTx ==nil {_efcg .UFillTx =_dcfc .UFillTx ;};if _efcg .UFill ==nil {_efcg .UFill =_dcfc .UFill ;
};if _efcg .Latin ==nil {_efcg .Latin =_dcfc .Latin ;};if _efcg .Ea ==nil {_efcg .Ea =_dcfc .Ea ;};if _efcg .Cs ==nil {_efcg .Cs =_dcfc .Cs ;};if _efcg .Sym ==nil {_efcg .Sym =_dcfc .Sym ;};if _efcg .Rtl ==nil {_efcg .Rtl =_dcfc .Rtl ;};return _efcg ;};
func (_cda *convertContext )makeSlide (){_cad :=_cda ._aaee .GetSlideLayout ().CSld ;if _cad !=nil {if _fdg :=_cad .SpTree ;_fdg !=nil {for _ ,_bcb :=range _fdg .Choice {if _bcb !=nil {for _ ,_ceg :=range _bcb .Pic {if _ceg !=nil {var _ed ,_gb ,_aafg ,_ff float64 ;
if _dff :=_ceg .SpPr ;_dff !=nil {if _acdc :=_dff .Xfrm ;_acdc !=nil {_ed ,_gb ,_aafg ,_ff =_b .GetDataFromXfrm (_acdc );};};if _dfcc :=_ceg .BlipFill ;_dfcc !=nil {_bbg :=_cda .getShapeFromBlipFill (_dfcc ,_ed ,_gb ,_aafg ,_ff ,true );_cda ._acdef =append (_cda ._acdef ,_bbg );
};};};};};};};_cad =_cda ._aaee .X ().CSld ;if _cad ==nil {return ;};_cc :=&background {};if _bbf :=_cad .Bg ;_bbf !=nil {if _ge :=_bbf .BgPr ;_ge !=nil {if _ge .NoFill ==nil {if _bed :=_ge .SolidFill ;_bed !=nil {_ddg ,_ada :=_cda .getColorFromSolidFill (_bed );
if _ddg !=nil {_cc ._cebg =_ddg ;_cc ._fgdg =_ada ;};}else if _fdd :=_ge .BlipFill ;_fdd !=nil {_cc ._afaa =_fdd ;};};};};_cda ._dbbc =_cc ;if _bf :=_cad .SpTree ;_bf !=nil {for _ ,_aab :=range _bf .Choice {if _aab !=nil {for _ ,_ddeb :=range _aab .Sp {if _ddeb !=nil {_aed :=_cda .getShapes (_ddeb );
_cda ._acdef =append (_cda ._acdef ,_aed ...);};};for _ ,_bfd :=range _aab .GraphicFrame {if _bfd !=nil {var _gca ,_dc ,_faga ,_dbd float64 ;if _af :=_bfd .Xfrm ;_af !=nil {_gca ,_dc ,_faga ,_dbd =_b .GetDataFromXfrm (_af );};if _faga ==0&&_dbd ==0{_faga =_cda ._bgc ;
_dbd =_cda ._eff ;};if _bag :=_bfd .Graphic ;_bag !=nil {if _adb :=_bag .GraphicData ;_adb !=nil {for _ ,_aabg :=range _adb .Any {if _fda ,_bcd :=_aabg .(*_gd .Chart );_bcd {_fac ,_caa :=_cda .makePdfBlockFromChart (_fda ,_faga ,_dbd );if _caa !=nil {_aa .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_caa );
};if _fac !=nil {_fac .SetPos (_gca ,_dc );_cda ._acdef =append (_cda ._acdef ,_fac );};}else if _bcc ,_fagaa :=_aabg .(*_cf .Tbl );_fagaa {_fdf :=_cda .makePdfBlockFromTable (_bcc ,_faga );if _fdf !=nil {_agd :=_ag .NewBlock (_faga ,_dbd );_agd .SetPos (_gca ,_dc );
_agd .Draw (_fdf );_cda ._acdef =append (_cda ._acdef ,_agd );};};};};};};};for _ ,_fe :=range _aab .CxnSp {if _fe !=nil {_bfdb :=_cda .getConnectors (_fe );_cda ._acdef =append (_cda ._acdef ,_bfdb ...);};};for _ ,_fff :=range _aab .GrpSp {_acde :=0.0;
_ef :=0.0;if _dg :=_fff .GrpSpPr .Xfrm ;_dg !=nil {_acde ,_ef =_b .GetGroupOffsetFromXfrm (_dg );};for _ ,_gec :=range _fff .Choice {for _ ,_dgd :=range _gec .CxnSp {if _dgd !=nil {_gddf :=_cda .getGroupConnectors (_dgd ,_acde ,_ef );_cda ._acdef =append (_cda ._acdef ,_gddf ...);
};};};};for _ ,_bfe :=range _aab .Pic {if _bfe !=nil {var _cfc ,_gdg ,_bdeb ,_afe float64 ;if _ddgb :=_bfe .SpPr ;_ddgb !=nil {if _dac :=_ddgb .Xfrm ;_dac !=nil {_cfc ,_gdg ,_bdeb ,_afe =_b .GetDataFromXfrm (_dac );};};if _bbb :=_bfe .BlipFill ;_bbb !=nil {_ga :=_cda .getShapeFromBlipFill (_bbb ,_cfc ,_gdg ,_bdeb ,_afe ,false );
_cda ._acdef =append (_cda ._acdef ,_ga );};};};};};};};func _dfed (_eadfd ,_fecf *_cf .CT_TableStyleTextStyle )*_cf .CT_TableStyleTextStyle {_ccfa :=_cf .NewCT_TableStyleTextStyle ();if _eadfd !=nil {*_ccfa =*_eadfd ;};if _fecf ==nil {return _ccfa ;};
if _ccfa .BAttr ==_cf .ST_OnOffStyleTypeUnset {_ccfa .BAttr =_fecf .BAttr ;};if _ccfa .IAttr ==_cf .ST_OnOffStyleTypeUnset {_ccfa .IAttr =_fecf .IAttr ;};if _ccfa .Font ==nil {_ccfa .Font =_fecf .Font ;};if _ccfa .FontRef ==nil {_ccfa .FontRef =_fecf .FontRef ;
};if _ccfa .ScrgbClr ==nil {_ccfa .ScrgbClr =_fecf .ScrgbClr ;};if _ccfa .SrgbClr ==nil {_ccfa .SrgbClr =_fecf .SrgbClr ;};if _ccfa .HslClr ==nil {_ccfa .HslClr =_fecf .HslClr ;};if _ccfa .SysClr ==nil {_ccfa .SysClr =_fecf .SysClr ;};if _ccfa .SchemeClr ==nil {_ccfa .SchemeClr =_fecf .SchemeClr ;
};if _ccfa .PrstClr ==nil {_ccfa .PrstClr =_fecf .PrstClr ;};return _ccfa ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_b .FontStyle ;func (_ceca *textboxContext )drawParagraphs (){_ceca ._eafg .NewPage ();for _ ,_cbgd :=range _ceca ._bbag {for _ ,_aaef :=range _cbgd ._cdeb {for _ ,_fbc :=range _aaef ._gdgc {for _ ,_edfb :=range _fbc ._eecg {_bdef :=_ceca ._eafg .NewStyledParagraph ();
if _edfb ._ceb {_edfb ._gdcb =0;}else if _edfb ._cacb {_edfb ._gdcb =1.2*_aaef ._effa -_edfb ._geaa ;};_eedc :=_fbc ._eccg +_edfb ._fbdc ;_gbcaf :=_cbgd ._bdcb +_aaef ._bfeg +_edfb ._gdcb ;_bdef .SetPos (_eedc ,_gbcaf );_gfff :=_bdef .Append (_edfb ._dbdc );
if _edfb ._eee !=nil {_gfff .Style =*_edfb ._eee ;};_ceca ._eafg .Draw (_bdef );if _edfb ._dcg {_gaac :=_gbcaf +_edfb ._geaa +2;_b .DrawLine (_ceca ._eafg ,_eedc ,_gaac ,_eedc +_edfb ._dea ,_gaac ,1,_edfb ._eee .Color );};};};};};};func (_facb *textboxContext )newWord (){_facb ._bgb =&word {_fcbd :true ,_eccg :_facb ._egd ._adbgb }};
func (_bdee *convertContext )getBorderStyle (_dbbe *_cf .CT_LineProperties )(_ag .CellBorderStyle ,*_ag .Color ,float64 ){if _dbbe ==nil ||_dbbe .NoFill !=nil {return _ag .CellBorderStyleNone ,nil ,0;};var _egge _ag .Color ;if _gbg :=_dbbe .SolidFill ;
_gbg !=nil {_egge ,_ =_bdee .getColorFromSolidFill (_gbg );};_gfgg :=0.0;if _faa :=_dbbe .WAttr ;_faa !=nil {_gfgg =_gc .FromEMU (int64 (*_faa ));};return _ag .CellBorderStyleSingle ,&_egge ,_gfgg ;};func (_agedc *convertContext )getInfoFromLn (_fcfa *_cf .CT_LineProperties )(_ag .Color ,float64 ,float64 ){if _fcfa ==nil ||_fcfa .NoFill !=nil {return nil ,0,0;
};var _gbgf float64 ;_gafeb ,_gbgb :=_agedc .getColorFromSolidFill (_fcfa .SolidFill );if _afff :=_fcfa .WAttr ;_afff !=nil {_gbgf =_gc .FromEMU (int64 (*_afff ));}else {_gbgf =1;};return _gafeb ,_gbgf ,_gbgb ;};var _gdd =_afad (1.9);func (_fad *textboxContext )adjustHeights (_adgb float64 ){if _fad ._egd ._effa < _adgb {_fad ._fgcd ._ccf +=(_adgb -_fad ._egd ._effa );
_fad ._egd ._effa =_adgb ;};};func (_gf *convertContext )makePdfBlockFromChart (_dd *_gd .Chart ,_fcg ,_ad float64 )(*_ag .Block ,error ){_e :=_dd .CT_RelId .IdAttr ;_df :=_gf ._aaee .GetChartSpaceByRelId (_e );if _df ==nil {return nil ,_c .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");
};var _ac *_cf .Theme ;_be :=_gf ._bdbg .Themes ();if len (_be )> 0{_ac =_be [0];};return _b .MakeBlockFromChartSpace (_df ,_fcg ,_ad ,_ac );};func (_gfba *textboxContext )alignParagraphsVertically (_gfbae _cf .ST_TextAnchoringType ){if _gfbae ==_cf .ST_TextAnchoringTypeT {return ;
};_dgfe :=0.0;for _ ,_cbbg :=range _gfba ._bbag {_dgfe +=_cbbg ._ccc +_cbbg ._ccf +_cbbg ._ebg ;};var _afb float64 ;switch _gfbae {case _cf .ST_TextAnchoringTypeCtr :_afb =(_gfba ._bgcb -_dgfe )/2;case _cf .ST_TextAnchoringTypeB :_afb =_gfba ._bgcb -_dgfe ;
};for _ ,_dfb :=range _gfba ._bbag {_dfb ._bdcb +=_afb ;};};func (_edaa *line )moveRight (_dbefc float64 ){for _ ,_agb :=range _edaa ._gdgc {_agb ._eccg +=_dbefc ;};};func _cebb (_bfce ,_edba *_cf .CT_TextListStyle )*_cf .CT_TextListStyle {_faaa :=_cf .NewCT_TextListStyle ();
if _bfce !=nil {*_faaa =*_bfce ;};if _edba ==nil {return _faaa ;};_faaa .DefPPr =_ebfcd (_faaa .DefPPr ,_edba .DefPPr );_faaa .Lvl1pPr =_ebfcd (_faaa .Lvl1pPr ,_edba .Lvl1pPr );_faaa .Lvl2pPr =_ebfcd (_faaa .Lvl2pPr ,_edba .Lvl2pPr );_faaa .Lvl3pPr =_ebfcd (_faaa .Lvl3pPr ,_edba .Lvl3pPr );
_faaa .Lvl4pPr =_ebfcd (_faaa .Lvl4pPr ,_edba .Lvl4pPr );_faaa .Lvl5pPr =_ebfcd (_faaa .Lvl5pPr ,_edba .Lvl5pPr );_faaa .Lvl6pPr =_ebfcd (_faaa .Lvl6pPr ,_edba .Lvl6pPr );_faaa .Lvl7pPr =_ebfcd (_faaa .Lvl7pPr ,_edba .Lvl7pPr );_faaa .Lvl8pPr =_ebfcd (_faaa .Lvl8pPr ,_edba .Lvl8pPr );
_faaa .Lvl9pPr =_ebfcd (_faaa .Lvl9pPr ,_edba .Lvl9pPr );return _faaa ;};func (_deac *textboxContext )alignVertically (_abce _cf .ST_TextAnchoringType ){_deac .alignParagraphsVertically (_abce );_deac .alignSymbolsVertically ();};type background struct{_cebg _ag .Color ;
_fgdg float64 ;_afaa *_cf .CT_BlipFillProperties ;};func _eaad (_afc *_bc .CT_CommonSlideData ,_befb _bc .ST_PlaceholderType ,_cbd *uint32 ,_ebcf bool )(*_cf .CT_Transform2D ,*_cf .CT_TextBody ,*bool ,*bool ){if _afc !=nil &&(_befb !=_bc .ST_PlaceholderTypeUnset ||!_ebcf ){if _bfa :=_afc .SpTree ;
_bfa !=nil {for _ ,_gbeb :=range _bfa .Choice {if _gbeb !=nil {for _ ,_gcd :=range _gbeb .Sp {if _gcd !=nil {_badc ,_gaca :=_bfda (_gcd );if _befb ==_badc {if (_ebcf &&_gaca ==nil )||(!_ebcf &&_gaca !=nil &&*_gaca ==*_cbd ){var _bcddb *_cf .CT_Transform2D ;
if _gcd .SpPr !=nil {_bcddb =_gcd .SpPr .Xfrm ;};_dccg :=_befb ==_bc .ST_PlaceholderTypeTitle ||_befb ==_bc .ST_PlaceholderTypeCtrTitle ;_fada :=!_dccg &&_befb !=_bc .ST_PlaceholderTypeUnset ;return _bcddb ,_gcd .TxBody ,&_dccg ,&_fada ;};};};};};};};};
return nil ,nil ,nil ,nil ;};func (_aggcd *convertContext )renderPageWithDrawableToGoImage (_ccfg _ag .Drawable )(_cd .Image ,error ){_fgcb :=_b .MakeTempCreator (_aggcd ._bgc ,_aggcd ._eff );_fgcb .NewPage ();_fgcb .Draw (_ccfg );_ffbd ,_eadd :=_b .GetPageFromCreator (_fgcb );
if _eadd !=nil {return nil ,_eadd ;};return _aaf .NewImageDevice ().Render (_ffbd );};type symbolStyle struct{_ebbg *string ;_gbgg *float64 ;_fdaf *string ;_cbb *bool ;_bdf *bool ;_gdde *bool ;_gggf *bool ;_feg *bool ;};func (_cbc *textboxContext )addCurrentWordToParagraph (){if _cbc ._gfabd &&_cbc ._egd ._adbgb +_cbc ._bgb ._gcaf > _cbc ._egd ._dgfb {_cbc .newLine ();
};if !_cbc ._bgb ._fcbd ||len (_cbc ._egd ._gdgc )> 0{_cbc ._bgb ._eccg =_cbc ._egd ._adbgb ;_cbc ._egd ._gdgc =append (_cbc ._egd ._gdgc ,_cbc ._bgb );_cbc ._egd ._adbgb +=_cbc ._bgb ._gcaf ;for _ ,_fecaa :=range _cbc ._bgb ._eecg {_cbc .adjustHeights (_fecaa ._aggc );
};};};func _bcbb (_cbgc *_cf .CT_AdjPoint2D )(float64 ,float64 ){var _cdce ,_eeda float64 ;_aged ,_facff :=_cbgc .XAttr ,_cbgc .YAttr ;if _gdff :=_aged .ST_Coordinate ;_gdff !=nil {_cdce =_gc .FromEMU (_b .FromSTCoordinate (*_gdff ));};if _edbe :=_facff .ST_Coordinate ;
_edbe !=nil {_eeda =_gc .FromEMU (_b .FromSTCoordinate (*_edbe ));};return _cdce ,_eeda ;};func (_ggg *convertContext )addCellToTable (_cafe *_ag .Table ,_bda *_cf .CT_TableCell ,_bbgc *_cf .CT_TablePartStyle ,_bdceg float64 ,_aegd ,_edg ,_bfdf ,_eebe bool )float64 {var _abgg *_ag .TableCell ;
_fbg :=1;if _bda .GridSpanAttr !=nil {_fbg =int (*_bda .GridSpanAttr );};_abgg =_cafe .MultiColCell (_fbg );_gfabe :=_bda .TcPr ;var _cfbfb *_cf .CT_TableStyleTextStyle ;if _bbgc !=nil {_gfabe =_gaec (_gfabe ,_bbgc .TcStyle ,_aegd ,_edg ,_bfdf ,_eebe );
_cfbfb =_bbgc .TcTxStyle ;};_fcf :=_gdd ;_fddf :=_ag .CellVerticalAlignmentMiddle ;_eggd :=_ebeb (0.05);_adag :=_ebeb (0.05);if _gfabe !=nil {if _egbg :=_gfabe .LnL ;_egbg !=nil {_ggef ,_fdc ,_cfe :=_ggg .getBorderStyle (_egbg );_abgg .SetBorder (_ag .CellBorderSideLeft ,_ggef ,_cfe );
if _fdc !=nil &&*_fdc !=nil {_abgg .SetSideBorderColor (_ag .CellBorderSideLeft ,*_fdc );};};if _dad :=_gfabe .LnT ;_dad !=nil {_acac ,_gfb ,_gade :=_ggg .getBorderStyle (_dad );_abgg .SetBorder (_ag .CellBorderSideTop ,_acac ,_gade );if _gfb !=nil &&*_gfb !=nil {_abgg .SetSideBorderColor (_ag .CellBorderSideTop ,*_gfb );
};};if _eea :=_gfabe .LnR ;_eea !=nil {_gac ,_aae ,_fgd :=_ggg .getBorderStyle (_eea );_abgg .SetBorder (_ag .CellBorderSideRight ,_gac ,_fgd );if _aae !=nil &&*_aae !=nil {_abgg .SetSideBorderColor (_ag .CellBorderSideRight ,*_aae );};};if _ega :=_gfabe .LnB ;
_ega !=nil {_cade ,_aee ,_ecb :=_ggg .getBorderStyle (_ega );_abgg .SetBorder (_ag .CellBorderSideBottom ,_cade ,_ecb );if _aee !=nil &&*_aee !=nil {_abgg .SetSideBorderColor (_ag .CellBorderSideBottom ,*_aee );};};if _cgf :=_gfabe .MarLAttr ;_cgf !=nil {_fcf =float64 (_b .FromSTCoordinate32 (*_cgf ));
};switch _gfabe .AnchorAttr {case _cf .ST_TextAnchoringTypeT :_fddf =_ag .CellVerticalAlignmentTop ;case _cf .ST_TextAnchoringTypeB :_fddf =_ag .CellVerticalAlignmentBottom ;};if _gfabe .NoFill ==nil {if _bacca :=_gfabe .SolidFill ;_bacca !=nil {_bcag ,_ :=_ggg .getColorFromSolidFill (_bacca );
_abgg .SetBackgroundColor (_bcag );};};if _acgf :=_gfabe .MarBAttr ;_acgf !=nil {_eggd =float64 (_b .FromSTCoordinate32 (*_acgf ));};if _dgba :=_gfabe .MarTAttr ;_dgba !=nil {_adag =float64 (_b .FromSTCoordinate32 (*_dgba ));};};_abgg .SetVerticalAlignment (_fddf );
_abgg .SetIndent (_fcf );var _gacg float64 ;if _cde :=_bda .TxBody ;_cde !=nil {_fcdd :=_ggg .makePdfDivisionFromTxBody (_cde ,_cfbfb );_gacg =_fcdd .Height ()+_adag +_eggd ;_abgg .SetContent (_fcdd );};return _gacg ;};func (_bagb *textboxContext )addPrefix (_gaa *prefixData ,_bfdd *_ag .TextStyle ){_ebd :=_aedf (_gaa ._beeb );
_cgfc :=*_bfdd ;if _gaa ._gacc {_cgfc .Font =_b .AssignStdFontByName (_cgfc ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_fafb :=range _ebd {_fafb ._eee =&_cgfc ;_bagb .addTextSymbol (_fafb );};_geeb :=-(_gaa ._dgbb +_bagb ._bgb ._gcaf );if _geeb < 0{_geeb =0;
};_ffg :=&symbol {_dbdc :"\u0020",_dea :_geeb };_bagb .addTextSymbol (_ffg );_bagb ._bgb ._eccg +=(_gaa ._dgbb +_gaa ._facf );};func _efe (_gafb ,_agbc *_cf .CT_TextBody )(*_cf .CT_TextBodyProperties ,*_cf .CT_TextListStyle ){if _gafb ==nil &&_agbc ==nil {return nil ,nil ;
};if _gafb ==nil {return _agbc .BodyPr ,_agbc .LstStyle ;};if _agbc ==nil {return _gafb .BodyPr ,_gafb .LstStyle ;};_acag ,_dbaf :=_gafb .BodyPr ,_gafb .LstStyle ;_cacd ,_dcga :=_agbc .BodyPr ,_agbc .LstStyle ;_caac :=_cdecd (_acag ,_cacd );_gcc :=_cebb (_dbaf ,_dcga );
return _caac ,_gcc ;};type textboxContext struct{_dcde *convertContext ;_dcaac float64 ;_bgcb float64 ;_eafg *_ag .Creator ;_bbad float64 ;_bbag []*paragraph ;_fgcd *paragraph ;_egd *line ;_bgb *word ;_gfabd bool ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_bb .PdfFont ){_b .RegisterFont (name ,style ,font );};func (_ade *convertContext )drawSlide (){_ade ._gdfc .NewPage ();for _ ,_cae :=range _ade ._acdef {if _cae !=nil {_ade ._gdfc .MoveTo (0,0);_ade ._gdfc .Draw (_cae );
};};};func _ebeb (_eba float64 )float64 {return _eba *_gc .Inch };func (_gfga *convertContext )getStyleColors (_aedc *_cf .CT_ShapeStyle )(_ag .Color ,_ag .Color ,_ag .Color ){var _aebg ,_cbed ,_fae _ag .Color ;if _cgeb :=_aedc .LnRef ;_cgeb !=nil {_cbed =_gfga .getColorFromMatrixReference (_cgeb );
};if _bbcdg :=_aedc .FillRef ;_bbcdg !=nil {_fae =_gfga .getColorFromMatrixReference (_bbcdg );};if _ccff :=_aedc .FontRef ;_ccff !=nil {_aebg =_gfga .getColorFromFontReference (_ccff );};return _aebg ,_fae ,_cbed ;};type paragraph struct{_agcf float64 ;
_ccc float64 ;_ebg float64 ;_dcfe float64 ;_dccd float64 ;_fabc float64 ;_bdcb float64 ;_ccf float64 ;_eebab _cf .ST_TextAlignType ;_cfee float64 ;_eccb bool ;_cdeb []*line ;};type convertContext struct{_gdfc *_ag .Creator ;_bgdg *_b .Rectangle ;_bdbg *_ba .Presentation ;
_aaee *_ba .Slide ;_aegf *_bc .SldMaster ;_gadd *_bc .SldLayout ;_eff float64 ;_bgc float64 ;_acdef []_ag .Drawable ;_dbbc *background ;_deg *_cf .CT_TextParagraphProperties ;_fge *_cf .CT_TextCharacterProperties ;_cadg *_cf .CT_TextParagraphProperties ;
_fdcd *_cf .CT_TextCharacterProperties ;_dbfb *_cf .CT_TextParagraphProperties ;_ffbe *_cf .CT_TextCharacterProperties ;_eec []*_cf .CT_TextParagraphProperties ;_baa []*_cf .CT_TextParagraphProperties ;_dag []*_cf .CT_TextParagraphProperties ;_fbbg *_cf .Theme ;
_cfba *_cf .CT_ColorMappingOverride ;};func (_dec *textboxContext )newParagraph (){_ffbc :=&paragraph {};_ffbc ._bdcb =_dec ._bbad ;_dec ._fgcd =_ffbc ;};func (_eade *convertContext )getShapeFromBlipFill (_bade *_cf .CT_BlipFillProperties ,_fgge ,_dbdb ,_cggc ,_gbge float64 ,_geef bool )_ag .Drawable {_aabcb ,_gdfb ,_dba :=_eade .makePdfImageFromBlipFill (_bade ,_geef );
if _dba !=nil {_aa .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_dba );
return nil ;};if _aabcb ==nil {return nil ;};if _fde :=_bade .Tile ;_fde !=nil {_aabcb =_eade .tileImage (_aabcb ,_bade .Tile ,_cggc ,_gbge );};if _dcced :=_bade .Stretch ;_dcced !=nil {_aabcb ,_fgge ,_dbdb =_eade .stretchImage (_aabcb ,_bade .Stretch ,_fgge ,_dbdb ,_cggc ,_gbge );
};if _aabcb ==nil {return nil ;};if len (_gdfb )==0{_aabcb .SetPos (_fgge ,_dbdb );return _aabcb ;};_aabcb =_eade .applyBlipEffectsOnImg (_aabcb ,_fgge ,_dbdb ,_gdfb );_aabcb .SetPos (_fgge ,_dbdb );return _aabcb ;};func (_ageda *convertContext )applyBlipEffectsOnImg (_cfdf *_ag .Image ,_ffbg ,_egc float64 ,_ffcb []*_cf .CT_BlipChoice )*_ag .Image {if len (_ffcb )==0{return _cfdf ;
};_cfdf .SetPos (_ffbg ,_egc );_cag ,_dgfeb :=_ageda .renderPageWithDrawableToGoImage (_cfdf );if _dgfeb !=nil {_aa .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_dgfeb );
return _cfdf ;};_ebgb ,_dgfeb :=_ageda .renderCurrentStateToGoImage ();if _dgfeb !=nil {_aa .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_dgfeb );
return _cfdf ;};_beba :=_cag .Bounds ();_cdag :=_cd .NewRGBA (_beba );_deb ,_eca :=_cfdf .Width (),_cfdf .Height ();for _ ,_bbafc :=range _ffcb {for _ ,_afga :=range _bbafc .AlphaModFix {if _eacg :=_afga .AmtAttr ;_eacg !=nil {if _bffg :=_eacg .ST_PositivePercentageDecimal ;
_bffg !=nil {_dfge :=uint8 (255*(*_bffg )/100000);_fbcf :=_cd .NewUniform (_f .Alpha {_dfge });_g .Draw (_cdag ,_beba ,_ebgb ,_cd .Point {0,0},_g .Src );_g .DrawMask (_cdag ,_beba ,_cag ,_cd .Point {0,0},_fbcf ,_cd .Point {0,0},_g .Over );};};};};_ecaf :=_cd .Rect (int (_ffbg ),int (_egc ),int (_ffbg +_deb )+1,int (_egc +_eca )+1);
_fbab :=_b .CropImageByRect (_cdag ,_ecaf );_gfee ,_dgfeb :=_ageda ._gdfc .NewImageFromGoImage (_fbab );if _dgfeb !=nil {_aa .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_dgfeb );
return _cfdf ;};return _gfee ;};func (_dgde *convertContext )stretchImage (_gdb *_ag .Image ,_bcf *_cf .CT_StretchInfoProperties ,_ebcb ,_efb ,_de ,_bdc float64 )(*_ag .Image ,float64 ,float64 ){_dfe :=_bcf .FillRect ;if _dfe ==nil {_eeb :=_gdb .Width ()/_gdb .Height ();
_begc :=_de /_bdc ;var _acg ,_ea float64 ;if _eeb > _begc {_ea =_bdc ;_acg =_bdc *_eeb ;}else {_acg =_de ;_ea =_de /_eeb ;};_gdb .Scale (_acg /_gdb .Width (),_ea /_gdb .Height ());return _gdb ,_ebcb ,_efb ;};var _acb ,_ead ,_cfd ,_gdf float64 ;if _cfae :=_dfe .LAttr ;
_cfae !=nil {_cfd =_b .FromSTPercentage (_cfae );};if _aff :=_dfe .TAttr ;_aff !=nil {_acb =_b .FromSTPercentage (_aff );};if _gba :=_dfe .RAttr ;_gba !=nil {_gdf =_b .FromSTPercentage (_gba );};if _afa :=_dfe .BAttr ;_afa !=nil {_ead =_b .FromSTPercentage (_afa );
};_bba :=_de *(1-_cfd -_gdf );_agg :=_bdc *(1-_acb -_ead );_gdb .Scale (_bba /_gdb .Width (),_agg /_gdb .Height ());return _gdb ,_ebcb +_cfd *_de ,_efb +_acb *_bdc ;};func (_ggf *textboxContext )addTextSymbol (_edag *symbol ){_cef :=_ag .New ();_dgff :=_cef .NewStyledParagraph ();
_dgff .SetMargins (0,0,0,0);_gbef :=_dgff .Append (_edag ._dbdc );_dggb :=0.0;if _edag ._eee !=nil {_gbef .Style =*_edag ._eee ;if _edag ._eee .CharSpacing !=0{_dggb =_edag ._eee .CharSpacing ;};};_edag ._geaa =_dgff .Height ();_edag ._aggc =_dgff .Height ()*1.2;
if _edag ._dea ==0{_edag ._dea =_dgff .Width ()+_dggb ;};if len (_ggf ._bgb ._eecg )> 0{_eadf :=_ggf ._bgb ._eecg [len (_ggf ._bgb ._eecg )-1]._dbdc ;if _ggf ._fgcd ._eccb ||_b .IsNoSpaceLanguage (_eadf )||(_eadf =="\u0020")!=(_edag ._dbdc =="\u0020"){_ggf .addCurrentWordToParagraph ();
_ggf .newWord ();};};_ggf ._bgb ._eecg =append (_ggf ._bgb ._eecg ,_edag );_edag ._fbdc =_ggf ._bgb ._gcaf ;_ggf ._bgb ._gcaf +=_edag ._dea ;if _edag ._dbdc !="\u0020"{_ggf ._bgb ._fcbd =false ;};if _ggf ._bgb ._gcaf >=_ggf ._fgcd ._fabc -_ggf ._fgcd ._dccd {_ggf .addCurrentWordToParagraph ();
_ggf .newLine ();_ggf .newWord ();};};func (_edcc *textboxContext )assignPropsToCurrentParagraph (_aaeb *_cf .CT_TextParagraphProperties ){_ggdg :=12.4;if _aaeb ==nil {_edcc ._fgcd ._cfee =_ggdg ;return ;};if _cgb :=_aaeb .DefRPr ;_cgb !=nil {_caeb :=_cgb .SzAttr ;
if _caeb !=nil {_eddf :=float64 (*_caeb )/1200;if _ggdg <=_eddf {_ggdg =_eddf ;};};};if _ffdf :=_aaeb .MarLAttr ;_ffdf !=nil {_edcc ._fgcd ._dccd =_gc .FromEMU (int64 (*_ffdf ));};_edcc ._fgcd ._fabc =_edcc ._dcaac ;if _bcbc :=_aaeb .MarRAttr ;_bcbc !=nil {_edcc ._fgcd ._fabc -=_gc .FromEMU (int64 (*_bcbc ));
};if _dacd :=_aaeb .IndentAttr ;_dacd !=nil {_edcc ._fgcd ._dcfe =_gc .FromEMU (int64 (*_dacd ));};if _eccbc :=_aaeb .LatinLnBrkAttr ;_eccbc !=nil {_edcc ._fgcd ._eccb =*_eccbc ;};if _fcfd :=_aaeb .LnSpc ;_fcfd !=nil {if _gdga :=_fcfd .SpcPct ;_gdga !=nil {if _efbb :=_gdga .ValAttr .ST_TextSpacingPercent ;
_efbb !=nil {_ggdg =float64 (*_efbb )/5000;};};};var _bfec float64 ;if _adfe :=_aaeb .SpcBef ;_adfe !=nil {if _cgcc :=_adfe .SpcPts ;_cgcc !=nil {_bfec =float64 (_cgcc .ValAttr )/100;};};_bce :=_edcc ._bbag ;if len (_bce )> 0{_bfec -=_bce [len (_bce )-1]._ebg ;
if _bfec < 0{_bfec =0;};};_edcc ._fgcd ._ccc =_bfec ;if _fgebc :=_aaeb .SpcAft ;_fgebc !=nil {if _cecd :=_fgebc .SpcPts ;_cecd !=nil {_edcc ._fgcd ._ebg =float64 (_cecd .ValAttr )/100;};};_edcc ._fgcd ._cfee =_ggdg ;_edcc ._fgcd ._eebab =_aaeb .AlgnAttr ;
};type prefixData struct{_beeb string ;_gacc bool ;_facf float64 ;_dgbb float64 ;};func (_dbeg *convertContext )getShapesFromSpPr (_acgc *_cf .CT_ShapeProperties ,_fbe *_cf .CT_ShapeStyle ,_cgg bool ,_dcf float64 ,_eab float64 )([]_ag .Drawable ,float64 ,float64 ,float64 ,float64 ,_ag .Color ,bool ){_gbe :=[]_ag .Drawable {};
var _gaf ,_bgf ,_ggd ,_gfg ,_fagd float64 ;var _gcge ,_ebb ,_eegf ,_aded _ag .Color ;var _fgca *_cf .CT_BlipFillProperties ;_geed ,_dbc :=1.0,1.0;if _fbe !=nil {_gcge ,_ebb ,_aded =_dbeg .getStyleColors (_fbe );};if _feef :=_acgc .Ln ;_feef !=nil {if _feef .NoFill !=nil {_eegf ,_fagd =nil ,0;
}else {_eegf ,_fagd ,_geed =_dbeg .getInfoFromLn (_feef );if _eegf ==nil {_eegf =_aded ;};};};if _acgc .NoFill !=nil {_ebb ,_dbc =nil ,0;}else if _cgg {_ebb =_dbeg ._dbbc ._cebg ;_dbc =_dbeg ._dbbc ._fgdg ;_fgca =_dbeg ._dbbc ._afaa ;}else if _bdgd :=_acgc .SolidFill ;
_bdgd !=nil {_ebb ,_dbc =_dbeg .getColorFromSolidFill (_bdgd );};var _ebf bool ;if _ggcc :=_acgc .Xfrm ;_ggcc !=nil {_gaf ,_bgf ,_ggd ,_gfg =_b .GetDataFromXfrm (_ggcc );_gaf +=_dcf ;_bgf +=_eab ;_ebf =true ;};if _gbc :=_acgc .CustGeom ;_gbc !=nil {_gcgdd :=[]_ae .Point {};
_cbf ,_faf :=1.0,1.0;if _dcaa :=_gbc .PathLst ;_dcaa !=nil {for _ ,_bgag :=range _dcaa .Path {if _bgag !=nil {if _geg :=_bgag .WAttr ;_geg !=nil {_cbf =_ggd /_gc .FromEMU (*_geg );};if _bcfa :=_bgag .HAttr ;_bcfa !=nil {_faf =_gfg /_gc .FromEMU (*_bcfa );
};for _ ,_egb :=range _bgag .Close {if _egb !=nil {};};for _ ,_efba :=range _bgag .MoveTo {if _efba !=nil &&_efba .Pt !=nil {_aafd ,_cdd :=_bcbb (_efba .Pt );_gcgdd =append (_gcgdd ,_ae .Point {X :_aafd *_cbf +_gaf ,Y :_cdd *_faf +_bgf });};};for _ ,_dfg :=range _bgag .LnTo {if _dfg !=nil &&_dfg .Pt !=nil {_dcd ,_bec :=_bcbb (_dfg .Pt );
_gcgdd =append (_gcgdd ,_ae .Point {X :_dcd *_cbf +_gaf ,Y :_bec *_faf +_bgf });};};_fbed :=_dbeg ._gdfc .NewPolygon ([][]_ae .Point {_gcgdd });_fbed .SetFillColor (_ebb );_fbed .SetFillOpacity (_dbc );_fbed .SetBorderWidth (_fagd );if _eegf !=nil {_fbed .SetBorderColor (_eegf );
_fbed .SetBorderOpacity (_geed );};_gbe =append (_gbe ,_fbed );};};};};if _gcag :=_acgc .PrstGeom ;_gcag !=nil {switch _gcag .PrstAttr {case _cf .ST_ShapeTypeRect :if _fgca !=nil {_gdeg :=_dbeg .getShapeFromBlipFill (_fgca ,_gaf ,_bgf ,_ggd ,_gfg ,false );
_gbe =append (_gbe ,_gdeg );}else {_eaa :=_dbeg ._gdfc .NewRectangle (_gaf ,_bgf ,_ggd ,_gfg );_ebe :=_ebb !=nil &&_dbc > 0;if _ebe {_eaa .SetFillColor (_ebb );_eaa .SetFillOpacity (_dbc );};_cgga :=_eegf !=nil &&_geed > 0&&_fagd > 0;if _cgga {_eaa .SetBorderWidth (_fagd );
_eaa .SetBorderColor (_eegf );_eaa .SetBorderOpacity (_geed );};if _ebe ||_cgga {_gbe =append (_gbe ,_eaa );};};case _cf .ST_ShapeTypeLine :_gbce :=_dbeg ._gdfc .NewLine (_gaf ,_bgf ,_gaf +_ggd ,_bgf +_gfg );_gbce .SetLineWidth (_fagd );if _eegf !=nil {_gbce .SetColor (_eegf );
};_gbe =append (_gbe ,_gbce );};};return _gbe ,_gaf ,_bgf ,_ggd ,_gfg ,_gcge ,_ebf ;};func (_eebf *convertContext )makePdfImageFromBlipFill (_dfbg *_cf .CT_BlipFillProperties ,_deed bool )(*_ag .Image ,[]*_cf .CT_BlipChoice ,error ){if _bfga :=_dfbg .Blip ;
_bfga !=nil {if _aeec :=_bfga .EmbedAttr ;_aeec !=nil {var _eceg _cdc .ImageRef ;var _cdgc bool ;if _deed {_eceg ,_cdgc =_eebf ._aaee .GetLayoutImageByRelID (*_aeec );}else {_eceg ,_cdgc =_eebf ._aaee .GetImageByRelID (*_aeec );};if _cdgc {_cfgb ,_deea :=_fc .Open (_eceg .Path ());
if _deea !=nil {_aa .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_deea );return nil ,nil ,_deea ;};defer _cfgb .Close ();_fecb ,_ ,_deea :=_cd .Decode (_cfgb );if _deea !=nil {_aa .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_deea );
return nil ,nil ,_deea ;};if _cgdb :=_dfbg .SrcRect ;_cgdb !=nil {_defd :=_fecb .Bounds ().Size ();_cfeec :=_defd .X ;_ccg :=_defd .Y ;var _gdgaa ,_efbd ,_cdcg ,_ddd int ;var _dcb bool ;if _baab :=_cgdb .LAttr ;_baab !=nil {_gdgaa =int (float64 (_cfeec )*_b .FromSTPercentage (_baab ));
_dcb =true ;}else {_gdgaa =0;};if _ffe :=_cgdb .TAttr ;_ffe !=nil {_cdcg =int (float64 (_ccg )*_b .FromSTPercentage (_ffe ));_dcb =true ;}else {_cdcg =0;};if _gaad :=_cgdb .RAttr ;_gaad !=nil {_efbd =int (float64 (_cfeec )*(1-_b .FromSTPercentage (_gaad )));
_dcb =true ;}else {_efbd =_cfeec ;};if _aeff :=_cgdb .BAttr ;_aeff !=nil {_ddd =int (float64 (_ccg )*(1-_b .FromSTPercentage (_aeff )));_dcb =true ;}else {_ddd =_ccg ;};if _dcb {_fecb =_b .CropImageByRect (_fecb ,_cd .Rect (_gdgaa ,_cdcg ,_efbd +1,_ddd +1));
};};_eeed ,_deea :=_eebf ._gdfc .NewImageFromGoImage (_fecb );_eeed .SetEncoder (_gcf .NewFlateEncoder ());if _deea !=nil {_aa .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_deea );
return nil ,nil ,_deea ;};return _eeed ,_bfga .Choice ,nil ;};};};return nil ,nil ,nil ;};func _cbcd (_bfcd ,_eaadd *_cf .CT_TablePartStyle )*_cf .CT_TablePartStyle {_dfcb :=_cf .NewCT_TablePartStyle ();if _bfcd !=nil {*_dfcb =*_bfcd ;};if _eaadd ==nil {return _dfcb ;
};if _dfcb .TcTxStyle ==nil {_dfcb .TcTxStyle =_eaadd .TcTxStyle ;}else {_dfcb .TcTxStyle =_dfed (_dfcb .TcTxStyle ,_eaadd .TcTxStyle );};if _dfcb .TcStyle ==nil {_dfcb .TcStyle =_eaadd .TcStyle ;}else {_dfcb .TcStyle =_eadfc (_dfcb .TcStyle ,_eaadd .TcStyle );
};return _dfcb ;};func (_cge *convertContext )getGroupConnectors (_aeag *_bc .CT_Connector ,_fcb float64 ,_eef float64 )[]_ag .Drawable {_aac ,_ ,_ ,_ ,_ ,_ ,_ :=_cge .getShapesFromSpPr (_aeag .SpPr ,_aeag .Style ,false ,_fcb ,_eef );return _aac ;};func _ebfc (_bdd int ,_edbd bool )string {_dbbaa :=_fa .NewBuffer ([]byte {});
for _ ,_abf :=range _adf {for {if _bdd < _abf ._eggg {break ;};_dbbaa .WriteString (_abf ._abea );_bdd -=_abf ._eggg ;};};_cdcb :=_dbbaa .String ();if _edbd {_cdcb =_fd .ToUpper (_cdcb );};return _cdcb ;};func (_abbb *convertContext )getColorFromMatrixReference (_cdaf *_cf .CT_StyleMatrixReference )_ag .Color {if _cdaf ==nil {return nil ;
};var _gfed _ag .Color ;var _egac string ;if _deab :=_cdaf .SrgbClr ;_deab !=nil {_egac =_deab .ValAttr ;}else if _abcb :=_cdaf .SchemeClr ;_abcb !=nil {_egac =_b .GetColorStringFromDmlColor (_abbb ._bdbg .GetColorBySchemeColor (_abcb .ValAttr ));_egac =_b .AdjustColor (_egac ,_abcb .EG_ColorTransform );
};if _egac !=""{_gfed =_ag .ColorRGBFromHex ("\u0023"+_egac );};return _gfed ;};func _eadfc (_fca ,_ebee *_cf .CT_TableStyleCellStyle )*_cf .CT_TableStyleCellStyle {_gcae :=_cf .NewCT_TableStyleCellStyle ();if _fca !=nil {*_gcae =*_fca ;};if _ebee ==nil {return _gcae ;
};if _gcae .TcBdr ==nil {_gcae .TcBdr =_ebee .TcBdr ;};if _gcae .Fill ==nil {_gcae .Fill =_ebee .Fill ;};if _gcae .FillRef ==nil {_gcae .FillRef =_ebee .FillRef ;};return _gcae ;};var _adf =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
func _cbgb (_bced *_cf .CT_TextCharacterProperties ,_egda *_cf .CT_TableStyleTextStyle )*_cf .CT_TextCharacterProperties {_cccd :=_cf .NewCT_TextCharacterProperties ();if _bced !=nil {*_cccd =*_bced ;};if _egda ==nil {return _cccd ;};if _cccd .BAttr ==nil &&_egda .BAttr !=_cf .ST_OnOffStyleTypeUnset {_ebff :=_egda .BAttr ==_cf .ST_OnOffStyleTypeOn ;
_cccd .BAttr =&_ebff ;};if _cccd .IAttr ==nil &&_egda .IAttr !=_cf .ST_OnOffStyleTypeUnset {_cegbc :=_egda .IAttr ==_cf .ST_OnOffStyleTypeOn ;_cccd .IAttr =&_cegbc ;};if _cccd .NoFill ==nil &&_cccd .SolidFill ==nil {_cccd .SolidFill =_cf .NewCT_SolidColorFillProperties ();
_cccd .SolidFill .ScrgbClr =_egda .ScrgbClr ;_cccd .SolidFill .SrgbClr =_egda .SrgbClr ;_cccd .SolidFill .HslClr =_egda .HslClr ;_cccd .SolidFill .SysClr =_egda .SysClr ;_cccd .SolidFill .SchemeClr =_egda .SchemeClr ;_cccd .SolidFill .PrstClr =_egda .PrstClr ;
};if _bagc :=_egda .Font ;_bagc !=nil &&_cccd .Latin ==nil &&_cccd .Ea ==nil &&_cccd .Cs ==nil {_cccd .Latin =_bagc .Latin ;_cccd .Ea =_bagc .Ea ;_cccd .Cs =_bagc .Cs ;};return _cccd ;};func (_fcdc *convertContext )makePdfBlockFromTxBody (_befa *_cf .CT_TextBody ,_ggdb *_cf .CT_TextBodyProperties ,_baf *_cf .CT_TextListStyle ,_fbff ,_gdbb float64 ,_dbg _ag .Color ,_gag ,_cacg bool )(*_ag .Block ,error ){var _aabc *_cf .CT_TextParagraphProperties ;
if _bad :=_befa .LstStyle ;_bad !=nil {var _aga *_cf .CT_TextParagraphProperties ;if _bad .Lvl1pPr !=nil {_aga =_bad .Lvl1pPr ;};_aabc =_ebfcd (_aga ,_bad .DefPPr );};var _cgcd *_cf .CT_TextParagraphProperties ;if _aabc !=nil {if _gag {_cgcd =_fcdc ._baa [0];
}else if _cacg {_cgcd =_fcdc ._dag [0];}else {_cgcd =_fcdc ._eec [0];};if _baf !=nil {_cgcd =_ebfcd (_ebfcd (_baf .Lvl1pPr ,_baf .DefPPr ),_cgcd );};_cgcd =_ebfcd (_aabc ,_cgcd );}else {if _gag {_cgcd =_fcdc ._cadg ;}else if _cacg {_cgcd =_fcdc ._dbfb ;
}else {_cgcd =_fcdc ._deg ;};};_fafg ,_cege :=_afad (2.5),_afad (2.5);_cfga ,_gfgc :=_afad (1.3),_afad (1.3);_dbf :=true ;_abc :=_cf .ST_TextAnchoringTypeT ;if _ggdb !=nil {if _facgb :=_ggdb .AnchorAttr ;_facgb !=_cf .ST_TextAnchoringTypeUnset {_abc =_facgb ;
};};if _fgg :=_befa .BodyPr ;_fgg !=nil {if _gab :=_fgg .LInsAttr ;_gab !=nil {_fafg =_gc .FromEMU (_b .FromSTCoordinate32 (*_gab ));};if _bbdf :=_fgg .TInsAttr ;_bbdf !=nil {_cfga =_gc .FromEMU (_b .FromSTCoordinate32 (*_bbdf ));};if _eadc :=_fgg .RInsAttr ;
_eadc !=nil {_cege =_gc .FromEMU (_b .FromSTCoordinate32 (*_eadc ));};if _dfa :=_fgg .BInsAttr ;_dfa !=nil {_gfgc =_gc .FromEMU (_b .FromSTCoordinate32 (*_dfa ));};_dbf =_fgg .WrapAttr !=_cf .ST_TextWrappingTypeNone ;if _dgb :=_fgg .AnchorAttr ;_dgb !=_cf .ST_TextAnchoringTypeUnset {_abc =_fgg .AnchorAttr ;
};};_bbaf :=_b .MakeTempCreator (_fbff ,_gdbb );_bbaf .SetPageMargins (_fafg ,_cege ,_cfga ,_gfgc );_dgbg :=&textboxContext {_dcde :_fcdc ,_gfabd :_dbf ,_dcaac :_fbff -_fafg -_cege ,_bgcb :_gdbb -_cfga -_gfgc ,_eafg :_bbaf ,_bbag :[]*paragraph {}};_gfa :=1;
for _ ,_eed :=range _befa .P {if _eed !=nil {_eae :=_eed .PPr ;var _ced *prefixData ;if _eae !=nil &&_eae .BuNone ==nil {var _ecf string ;var _gbd bool ;if _fece :=_eae .BuAutoNum ;_fece !=nil {var _dgbf string ;if _dee :=_fece .StartAtAttr ;_dee !=nil {_gfa =int (*_dee );
};var _cdg string ;switch _fece .TypeAttr {case _cf .ST_TextAutonumberSchemeAlphaUcParenBoth ,_cf .ST_TextAutonumberSchemeAlphaUcParenR ,_cf .ST_TextAutonumberSchemeAlphaUcPeriod :_cdg =_fagc (_gfa ,true );case _cf .ST_TextAutonumberSchemeAlphaLcParenBoth ,_cf .ST_TextAutonumberSchemeAlphaLcParenR ,_cf .ST_TextAutonumberSchemeAlphaLcPeriod :_cdg =_fagc (_gfa ,false );
case _cf .ST_TextAutonumberSchemeRomanUcParenBoth ,_cf .ST_TextAutonumberSchemeRomanUcParenR ,_cf .ST_TextAutonumberSchemeRomanUcPeriod :_cdg =_ebfc (_gfa ,true );case _cf .ST_TextAutonumberSchemeRomanLcParenBoth ,_cf .ST_TextAutonumberSchemeRomanLcParenR ,_cf .ST_TextAutonumberSchemeRomanLcPeriod :_cdg =_ebfc (_gfa ,false );
default:_cdg =_a .Itoa (_gfa );};switch _fece .TypeAttr {case _cf .ST_TextAutonumberSchemeAlphaLcPeriod ,_cf .ST_TextAutonumberSchemeAlphaUcPeriod ,_cf .ST_TextAutonumberSchemeArabicPeriod ,_cf .ST_TextAutonumberSchemeRomanLcPeriod ,_cf .ST_TextAutonumberSchemeRomanUcPeriod ,_cf .ST_TextAutonumberSchemeArabicDbPeriod ,_cf .ST_TextAutonumberSchemeEa1ChsPeriod ,_cf .ST_TextAutonumberSchemeEa1ChtPeriod ,_cf .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_cf .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_cf .ST_TextAutonumberSchemeThaiAlphaPeriod ,_cf .ST_TextAutonumberSchemeThaiNumPeriod ,_cf .ST_TextAutonumberSchemeHindiAlphaPeriod ,_cf .ST_TextAutonumberSchemeHindiNumPeriod ,_cf .ST_TextAutonumberSchemeHindiAlpha1Period :_dgbf ="\u002e";
case _cf .ST_TextAutonumberSchemeAlphaLcParenR ,_cf .ST_TextAutonumberSchemeAlphaUcParenR ,_cf .ST_TextAutonumberSchemeArabicParenR ,_cf .ST_TextAutonumberSchemeRomanLcParenR ,_cf .ST_TextAutonumberSchemeRomanUcParenR ,_cf .ST_TextAutonumberSchemeThaiAlphaParenR ,_cf .ST_TextAutonumberSchemeThaiNumParenR ,_cf .ST_TextAutonumberSchemeHindiNumParenR :_dgbf ="\u0029";
};_ecf =_cdg +_dgbf ;_gfa ++;}else if _dgg :=_eae .BuChar ;_dgg !=nil {_feca :=_dgg .CharAttr ;if _bac ,_bca :=_dffa [_feca ];_bca {_feca =string (rune (_bac ));}else {_feca ="\u2022";};_ecf =_feca ;_gbd =true ;};if _ecf !=""{var _gef ,_afeg float64 ;if _eae .MarLAttr !=nil {_gef =_gc .FromEMU (int64 (*_eae .MarLAttr ));
};if _eae .IndentAttr !=nil {_afeg =_gc .FromEMU (int64 (*_eae .IndentAttr ));};_ced =&prefixData {_beeb :_ecf ,_gacc :_gbd ,_facf :_gef ,_dgbb :_afeg };};};_eae =_ebfcd (_eae ,_cgcd );_eeba :=_efg (_eed .EndParaRPr ,_eae .DefRPr );_dgbg .newParagraph ();
_dgbg .assignPropsToCurrentParagraph (_eae );_dgbg .newLine ();_dgbg .newWord ();for _ece ,_fbb :=range _eed .EG_TextRun {_dgbg .addTextRun (_fbb ,_eeba ,_dbg ,_ced );if _ece > 0{_ced =nil ;};};_dgbg .addCurrentWordToParagraph ();};_dgbg .addCurrentParagraph ();
};_dgbg .alignVertically (_abc );_dgbg .drawParagraphs ();return _b .MakeBlockFromCreator (_bbaf );};func _gaec (_bcea *_cf .CT_TableCellProperties ,_eecf *_cf .CT_TableStyleCellStyle ,_edfg ,_cdeg ,_ffda ,_gceg bool )*_cf .CT_TableCellProperties {_daa :=_cf .NewCT_TableCellProperties ();
if _bcea !=nil {*_daa =*_bcea ;};if _eecf ==nil {return _daa ;};if _fdae :=_eecf .FillRef ;_fdae !=nil {_bgcgb :=_cf .NewCT_SolidColorFillProperties ();_bgcgb .ScrgbClr =_fdae .ScrgbClr ;_bgcgb .SrgbClr =_fdae .SrgbClr ;_bgcgb .HslClr =_fdae .HslClr ;_bgcgb .SysClr =_fdae .SysClr ;
_bgcgb .SchemeClr =_fdae .SchemeClr ;_bgcgb .PrstClr =_fdae .PrstClr ;_daa .SolidFill =_bgcgb ;};if _daa .NoFill ==nil &&_daa .SolidFill ==nil {if _dbfbb :=_eecf .Fill ;_dbfbb !=nil {if _daa .NoFill ==nil {_daa .NoFill =_dbfbb .NoFill ;};if _daa .SolidFill ==nil {_daa .SolidFill =_dbfbb .SolidFill ;
};};};if _ffc :=_eecf .TcBdr ;_ffc !=nil {if _daa .LnL ==nil {var _accg *_cf .CT_ThemeableLineStyle ;if _ffda {_accg =_ffc .Left ;}else {_accg =_ffc .InsideV ;};if _accg !=nil {_daa .LnL =_accg .Ln ;};};if _daa .LnR ==nil {var _bcbf *_cf .CT_ThemeableLineStyle ;
if _gceg {_bcbf =_ffc .Right ;}else {_bcbf =_ffc .InsideV ;};if _bcbf !=nil {_daa .LnR =_bcbf .Ln ;};};if _daa .LnT ==nil {var _dagg *_cf .CT_ThemeableLineStyle ;if _edfg {_dagg =_ffc .Top ;}else {_dagg =_ffc .InsideH ;};if _dagg !=nil {_daa .LnT =_dagg .Ln ;
};};if _daa .LnB ==nil {var _cdcea *_cf .CT_ThemeableLineStyle ;if _cdeg {_cdcea =_ffc .Bottom ;}else {_cdcea =_ffc .InsideH ;};if _cdcea !=nil {_daa .LnB =_cdcea .Ln ;};};};return _daa ;};func (_geec *convertContext )getPhData (_acbd *_bc .CT_Shape )(*_cf .CT_Transform2D ,*_cf .CT_TextBodyProperties ,*_cf .CT_TextListStyle ,bool ,bool ){_bbbe ,_efd :=_bfda (_acbd );
_edfa :=_efd ==nil ;_cggg ,_cbcf ,_fadf ,_gaff :=_eaad (_geec ._aegf .CSld ,_bbbe ,_efd ,_edfa );_bbefd ,_cee ,_faae ,_eddfg :=_eaad (_geec ._gadd .CSld ,_bbbe ,_efd ,_edfa );if _bbefd ==nil {_bbefd =_cggg ;};_ffde ,_dgfc :=_efe (_cee ,_cbcf );var _feeg ,_effe bool ;
if _faae ==nil {if _fadf !=nil {_feeg =*_fadf ;};}else {_feeg =*_faae ;};if _eddfg ==nil {if _gaff !=nil {_effe =*_gaff ;};}else {_effe =*_eddfg ;};return _bbefd ,_ffde ,_dgfc ,_feeg ,_effe ;};func _ebfcd (_cbba ,_bdcg *_cf .CT_TextParagraphProperties )*_cf .CT_TextParagraphProperties {_gfedf :=_cf .NewCT_TextParagraphProperties ();
if _cbba !=nil {*_gfedf =*_cbba ;};if _bdcg ==nil {return _gfedf ;};if _gfedf .MarLAttr ==nil {_gfedf .MarLAttr =_bdcg .MarLAttr ;};if _gfedf .MarRAttr ==nil {_gfedf .MarRAttr =_bdcg .MarRAttr ;};if _gfedf .LvlAttr ==nil {_gfedf .LvlAttr =_bdcg .LvlAttr ;
};if _gfedf .IndentAttr ==nil {_gfedf .IndentAttr =_bdcg .IndentAttr ;};if _gfedf .AlgnAttr ==_cf .ST_TextAlignTypeUnset {_gfedf .AlgnAttr =_bdcg .AlgnAttr ;};if _gfedf .DefTabSzAttr ==nil {_gfedf .DefTabSzAttr =_bdcg .DefTabSzAttr ;};if _gfedf .RtlAttr ==nil {_gfedf .RtlAttr =_bdcg .RtlAttr ;
};if _gfedf .EaLnBrkAttr ==nil {_gfedf .EaLnBrkAttr =_bdcg .EaLnBrkAttr ;};if _gfedf .FontAlgnAttr ==_cf .ST_TextFontAlignTypeUnset {_gfedf .FontAlgnAttr =_bdcg .FontAlgnAttr ;};if _gfedf .LatinLnBrkAttr ==nil {_gfedf .LatinLnBrkAttr =_bdcg .LatinLnBrkAttr ;
};if _gfedf .HangingPunctAttr ==nil {_gfedf .HangingPunctAttr =_bdcg .HangingPunctAttr ;};if _gfedf .LnSpc ==nil {_gfedf .LnSpc =_bdcg .LnSpc ;};if _gfedf .SpcBef ==nil {_gfedf .SpcBef =_bdcg .SpcBef ;};if _gfedf .SpcAft ==nil {_gfedf .SpcAft =_bdcg .SpcAft ;
};if _gfedf .BuClrTx ==nil {_gfedf .BuClrTx =_bdcg .BuClrTx ;};if _gfedf .BuClr ==nil {_gfedf .BuClr =_bdcg .BuClr ;};if _gfedf .BuSzTx ==nil {_gfedf .BuSzTx =_bdcg .BuSzTx ;};if _gfedf .BuSzPct ==nil {_gfedf .BuSzPct =_bdcg .BuSzPct ;};if _gfedf .BuSzPts ==nil {_gfedf .BuSzPts =_bdcg .BuSzPts ;
};if _gfedf .BuFontTx ==nil {_gfedf .BuFontTx =_bdcg .BuFontTx ;};if _gfedf .BuFont ==nil {_gfedf .BuFont =_bdcg .BuFont ;};if _gfedf .BuNone ==nil {_gfedf .BuNone =_bdcg .BuNone ;};if _gfedf .BuAutoNum ==nil {_gfedf .BuAutoNum =_bdcg .BuAutoNum ;};if _gfedf .BuChar ==nil {_gfedf .BuChar =_bdcg .BuChar ;
};if _gfedf .BuBlip ==nil {_gfedf .BuBlip =_bdcg .BuBlip ;};if _gfedf .TabLst ==nil {_gfedf .TabLst =_bdcg .TabLst ;};if _gfedf .ExtLst ==nil {_gfedf .ExtLst =_bdcg .ExtLst ;};_gfedf .DefRPr =_efg (_gfedf .DefRPr ,_bdcg .DefRPr );return _gfedf ;};func _dada (_bbaff *bool )bool {return _bbaff !=nil &&*_bbaff };
func (_aega *textboxContext )alignSymbolsVertically (){for _ ,_fdfa :=range _aega ._bbag {for _ ,_acfc :=range _fdfa ._cdeb {_ebga :=0.0;for _ ,_bbcd :=range _acfc ._gdgc {for _ ,_bgcg :=range _bbcd ._eecg {if _bgcg ._aggc > _ebga {_ebga =_bgcg ._aggc ;
};};};for _ ,_ffa :=range _acfc ._gdgc {for _ ,_adgc :=range _ffa ._eecg {if _adgc ._geaa < _ebga {_adgc ._gdcb =_ebga -_adgc ._geaa ;};};};};};};type romanMatch struct{_eggg int ;_abea string ;};type symbol struct{_dbdc string ;_fbdc float64 ;_aggc float64 ;
_geaa float64 ;_gdcb float64 ;_dea float64 ;_eee *_ag .TextStyle ;_cbea string ;_ceb bool ;_cacb bool ;_dcg bool ;};func _cdecd (_gccd ,_deec *_cf .CT_TextBodyProperties )*_cf .CT_TextBodyProperties {_eeeg :=_cf .NewCT_TextBodyProperties ();if _gccd !=nil {*_eeeg =*_gccd ;
};if _deec ==nil {return _eeeg ;};if _eeeg .RotAttr ==nil {_eeeg .RotAttr =_deec .RotAttr ;};if _eeeg .SpcFirstLastParaAttr ==nil {_eeeg .SpcFirstLastParaAttr =_deec .SpcFirstLastParaAttr ;};if _eeeg .VertOverflowAttr ==_cf .ST_TextVertOverflowTypeUnset {_eeeg .VertOverflowAttr =_deec .VertOverflowAttr ;
};if _eeeg .HorzOverflowAttr ==_cf .ST_TextHorzOverflowTypeUnset {_eeeg .HorzOverflowAttr =_deec .HorzOverflowAttr ;};if _eeeg .VertAttr ==_cf .ST_TextVerticalTypeUnset {_eeeg .VertAttr =_deec .VertAttr ;};if _eeeg .WrapAttr ==_cf .ST_TextWrappingTypeUnset {_eeeg .WrapAttr =_deec .WrapAttr ;
};if _eeeg .LInsAttr ==nil {_eeeg .LInsAttr =_deec .LInsAttr ;};if _eeeg .TInsAttr ==nil {_eeeg .TInsAttr =_deec .TInsAttr ;};if _eeeg .RInsAttr ==nil {_eeeg .RInsAttr =_deec .RInsAttr ;};if _eeeg .BInsAttr ==nil {_eeeg .BInsAttr =_deec .BInsAttr ;};if _eeeg .NumColAttr ==nil {_eeeg .NumColAttr =_deec .NumColAttr ;
};if _eeeg .SpcColAttr ==nil {_eeeg .SpcColAttr =_deec .SpcColAttr ;};if _eeeg .RtlColAttr ==nil {_eeeg .RtlColAttr =_deec .RtlColAttr ;};if _eeeg .AnchorAttr ==_cf .ST_TextAnchoringTypeUnset {_eeeg .AnchorAttr =_deec .AnchorAttr ;};if _eeeg .AnchorCtrAttr ==nil {_eeeg .AnchorCtrAttr =_deec .AnchorCtrAttr ;
};if _eeeg .ForceAAAttr ==nil {_eeeg .ForceAAAttr =_deec .ForceAAAttr ;};if _eeeg .UprightAttr ==nil {_eeeg .UprightAttr =_deec .UprightAttr ;};if _eeeg .CompatLnSpcAttr ==nil {_eeeg .CompatLnSpcAttr =_deec .CompatLnSpcAttr ;};if _eeeg .PrstTxWarp ==nil {_eeeg .PrstTxWarp =_deec .PrstTxWarp ;
};if _eeeg .NoAutofit ==nil {_eeeg .NoAutofit =_deec .NoAutofit ;};if _eeeg .NormAutofit ==nil {_eeeg .NormAutofit =_deec .NormAutofit ;};if _eeeg .SpAutoFit ==nil {_eeeg .SpAutoFit =_deec .SpAutoFit ;};if _eeeg .Scene3d ==nil {_eeeg .Scene3d =_deec .Scene3d ;
};if _eeeg .Sp3d ==nil {_eeeg .Sp3d =_deec .Sp3d ;};if _eeeg .FlatTx ==nil {_eeeg .FlatTx =_deec .FlatTx ;};if _eeeg .ExtLst ==nil {_eeeg .ExtLst =_deec .ExtLst ;};return _eeeg ;};type line struct{_bfeg float64 ;_ebef float64 ;_dgfb float64 ;_adbgb float64 ;
_effa float64 ;_gdgc []*word ;};type word struct{_eecg []*symbol ;_eccg float64 ;_gcaf float64 ;_fcbd bool ;};func (_ggcd *convertContext )getShapes (_cac *_bc .CT_Shape )[]_ag .Drawable {_cacc :=[]_ag .Drawable {};_ggcdb :=_cac .SpPr ;if _ggcdb ==nil {return _cacc ;
};var _eeg bool ;if _gfc :=_cac .UseBgFillAttr ;_gfc !=nil {_eeg =*_gfc ;};_facg ,_egg ,_febd ,_aca ,_fbd ,_fffc ,_ffb :=_ggcd .getShapesFromSpPr (_ggcdb ,_cac .Style ,_eeg ,0.0,0.0);_cacc =append (_cacc ,_facg ...);if _gcgd :=_cac .TxBody ;_gcgd !=nil {_dfce ,_bga ,_eac ,_cfda ,_bcbe :=_ggcd .getPhData (_cac );
if _dfce !=nil &&!_ffb {_egg ,_febd ,_aca ,_fbd =_b .GetDataFromXfrm (_dfce );};_adc ,_dca :=_ggcd .makePdfBlockFromTxBody (_gcgd ,_bga ,_eac ,_aca ,_fbd ,_fffc ,_cfda ,_bcbe );if _dca !=nil {_aa .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_dca );
}else if _adc !=nil {_adc .SetPos (_egg ,_febd );_cacc =append (_cacc ,_adc );};};return _cacc ;};func (_cba *convertContext )renderCurrentStateToGoImage ()(_cd .Image ,error ){_aba :=_b .MakeTempCreator (_cba ._bgc ,_cba ._eff );_aba .NewPage ();for _ ,_bae :=range _cba ._acdef {if _bae !=nil {_aba .MoveTo (0,0);
_aba .Draw (_bae );};};_ebgc ,_cgbg :=_b .GetPageFromCreator (_aba );if _cgbg !=nil {return nil ,_cgbg ;};return _aaf .NewImageDevice ().Render (_ebgc );};func _fagc (_cdec int ,_bebd bool )string {_aag :=(_cdec -1)/26+1;_beea :=byte ((_cdec -1)%26);if _bebd {_beea +=byte (65);
}else {_beea +=byte (97);};_fgeb :=_fa .NewBuffer ([]byte {});for _bcdd :=0;_bcdd < _aag ;_bcdd ++{_fgeb .Write ([]byte {_beea });};return _fgeb .String ();};func (_abb *convertContext )getConnectors (_gad *_bc .CT_Connector )[]_ag .Drawable {_fgb ,_ ,_ ,_ ,_ ,_ ,_ :=_abb .getShapesFromSpPr (_gad .SpPr ,_gad .Style ,false ,0.0,0.0);
return _fgb ;};func (_cg *convertContext )extractDefaultProperties (){_bg :=_cg ._bdbg .X ();_dbe :=_bg .DefaultTextStyle ;var _fb ,_ab ,_dbb ,_gce ,_da ,_ee ,_dfc ,_abe ,_acd ,_beg *_cf .CT_TextParagraphProperties ;if _dbe !=nil {_fb =_dbe .DefPPr ;_ab =_ebfcd (_dbe .Lvl1pPr ,_fb );
_dbb =_ebfcd (_dbe .Lvl2pPr ,_fb );_gce =_ebfcd (_dbe .Lvl3pPr ,_fb );_da =_ebfcd (_dbe .Lvl4pPr ,_fb );_ee =_ebfcd (_dbe .Lvl5pPr ,_fb );_dfc =_ebfcd (_dbe .Lvl6pPr ,_fb );_abe =_ebfcd (_dbe .Lvl7pPr ,_fb );_acd =_ebfcd (_dbe .Lvl8pPr ,_fb );_beg =_ebfcd (_dbe .Lvl9pPr ,_fb );
_cg ._deg =_fb ;_cg ._fge =_fb .DefRPr ;};_cg ._eec =make ([]*_cf .CT_TextParagraphProperties ,9);_cg ._eec [0]=_ab ;_cg ._eec [1]=_dbb ;_cg ._eec [2]=_gce ;_cg ._eec [3]=_da ;_cg ._eec [4]=_ee ;_cg ._eec [5]=_dfc ;_cg ._eec [6]=_abe ;_cg ._eec [7]=_acd ;
_cg ._eec [8]=_beg ;_aafe :=_cg ._bdbg .SlideMasters ()[0].X ();_bde :=_aafe .TxStyles ;_ca :=_bde .TitleStyle ;_cg ._cadg =_ebfcd (_ca .DefPPr ,_fb );_cg ._fdcd =_cg ._cadg .DefRPr ;_cg ._baa =make ([]*_cf .CT_TextParagraphProperties ,9);_cg ._baa [0]=_ebfcd (_ca .Lvl1pPr ,_ab );
_cg ._baa [1]=_ebfcd (_ca .Lvl2pPr ,_dbb );_cg ._baa [2]=_ebfcd (_ca .Lvl3pPr ,_gce );_cg ._baa [3]=_ebfcd (_ca .Lvl4pPr ,_da );_cg ._baa [4]=_ebfcd (_ca .Lvl5pPr ,_ee );_cg ._baa [5]=_ebfcd (_ca .Lvl6pPr ,_dfc );_cg ._baa [6]=_ebfcd (_ca .Lvl7pPr ,_abe );
_cg ._baa [7]=_ebfcd (_ca .Lvl8pPr ,_acd );_cg ._baa [8]=_ebfcd (_ca .Lvl9pPr ,_beg );_dde :=_bde .BodyStyle ;_cg ._dbfb =_ebfcd (_dde .DefPPr ,_fb );_cg ._ffbe =_cg ._dbfb .DefRPr ;_cg ._dag =make ([]*_cf .CT_TextParagraphProperties ,9);_cg ._dag [0]=_ebfcd (_dde .Lvl1pPr ,_ab );
_cg ._dag [1]=_ebfcd (_dde .Lvl2pPr ,_dbb );_cg ._dag [2]=_ebfcd (_dde .Lvl3pPr ,_gce );_cg ._dag [3]=_ebfcd (_dde .Lvl4pPr ,_da );_cg ._dag [4]=_ebfcd (_dde .Lvl5pPr ,_ee );_cg ._dag [5]=_ebfcd (_dde .Lvl6pPr ,_dfc );_cg ._dag [6]=_ebfcd (_dde .Lvl7pPr ,_abe );
_cg ._dag [7]=_ebfcd (_dde .Lvl8pPr ,_acd );_cg ._dag [8]=_ebfcd (_dde .Lvl9pPr ,_beg );};func (_eda *convertContext )tileImage (_bbc *_ag .Image ,_fg *_cf .CT_TileInfoProperties ,_facc ,_bfg float64 )*_ag .Image {_eb ,_cab :=1.0,1.0;if _bee :=_fg .SxAttr ;
_bee !=nil {_eb =_b .FromSTPercentage (_bee );};if _eg :=_fg .SyAttr ;_eg !=nil {_cab =_b .FromSTPercentage (_eg );};_ebc :=_b .MakeTempCreator (_facc ,_bfg );_bbc .Scale (_eb ,_cab );_bfb ,_feb :=_bbc .Width (),_bbc .Height ();var _ddf ,_fab float64 ;
if _cfa :=_fg .TxAttr ;_cfa !=nil {_ddf =_gc .FromEMU (_b .FromSTCoordinate (*_cfa ));};if _ggc :=_fg .TyAttr ;_ggc !=nil {_fab =_gc .FromEMU (_b .FromSTCoordinate (*_ggc ));};if _ddf > 0{_ddf -=_bfb ;};if _fab > 0{_fab -=_feb ;};_age :=_eda ._bgc /_bfb +1;
_fgc :=_eda ._eff /_feb +1;for _gde :=0.0;_gde <=_age ;_gde ++{_fcd :=_gde *_bfb ;for _agc :=0.0;_agc <=_fgc ;_agc ++{_bea :=_agc *_feb ;_bbc .SetPos (_fcd +_ddf ,_bea +_fab );_ebc .Draw (_bbc );};};_dfd ,_beb :=_b .GetPageFromCreator (_ebc );if _beb !=nil {_aa .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_beb );
return nil ;};_efa ,_beb :=_aaf .NewImageDevice ().Render (_dfd );if _beb !=nil {_aa .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_beb );return nil ;};_bge ,_beb :=_eda ._gdfc .NewImageFromGoImage (_efa );
if _beb !=nil {_aa .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_beb );return nil ;};return _bge ;};