//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_c "bytes";_b "errors";_ee "github.com/unidoc/unioffice/v2/common";_ce "github.com/unidoc/unioffice/v2/common/logger";_ad "github.com/unidoc/unioffice/v2/common/tempstorage";_ac "github.com/unidoc/unioffice/v2/internal/convertutils";
_f "github.com/unidoc/unioffice/v2/measurement";_eg "github.com/unidoc/unioffice/v2/presentation";_cea "github.com/unidoc/unioffice/v2/schema/soo/dml";_ecb "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_gb "github.com/unidoc/unioffice/v2/schema/soo/pml";
_cg "github.com/unidoc/unipdf/v4/contentstream/draw";_be "github.com/unidoc/unipdf/v4/core";_g "github.com/unidoc/unipdf/v4/creator";_db "github.com/unidoc/unipdf/v4/model";_fb "github.com/unidoc/unipdf/v4/render";_aa "image";_e "image/color";_a "image/draw";
_ec "math";_eb "strconv";_dd "strings";);func (_ecfb *convertContext )addCellToTable (_dcce *_g .Table ,_gddc *_cea .CT_TableCell ,_febf *_cea .CT_TablePartStyle ,_aedb ,_acg ,_badg ,_eeea bool )float64 {var _fbea *_g .TableCell ;_dbb :=1;if _gddc .GridSpanAttr !=nil {_dbb =int (*_gddc .GridSpanAttr );
};_fbea =_dcce .MultiColCell (_dbb );_fffa :=_gddc .TcPr ;var _febb *_cea .CT_TableStyleTextStyle ;if _febf !=nil {_fffa =_agce (_fffa ,_febf .TcStyle ,_aedb ,_acg ,_badg ,_eeea );_febb =_febf .TcTxStyle ;};_egag :=_fa ;_feg :=_g .CellVerticalAlignmentMiddle ;
_ddcd :=_cgba (0.05);_cged :=_cgba (0.05);if _fffa !=nil {if _aeb :=_fffa .LnL ;_aeb !=nil {_eagd ,_age ,_aebe :=_ecfb .getBorderStyle (_aeb );_fbea .SetBorder (_g .CellBorderSideLeft ,_eagd ,_aebe );if _age !=nil &&*_age !=nil {_fbea .SetSideBorderColor (_g .CellBorderSideLeft ,*_age );
};};if _bffa :=_fffa .LnT ;_bffa !=nil {_ageg ,_ace ,_fbd :=_ecfb .getBorderStyle (_bffa );_fbea .SetBorder (_g .CellBorderSideTop ,_ageg ,_fbd );if _ace !=nil &&*_ace !=nil {_fbea .SetSideBorderColor (_g .CellBorderSideTop ,*_ace );};};if _cfde :=_fffa .LnR ;
_cfde !=nil {_dbff ,_aee ,_bbec :=_ecfb .getBorderStyle (_cfde );_fbea .SetBorder (_g .CellBorderSideRight ,_dbff ,_bbec );if _aee !=nil &&*_aee !=nil {_fbea .SetSideBorderColor (_g .CellBorderSideRight ,*_aee );};};if _caec :=_fffa .LnB ;_caec !=nil {_gdg ,_bgd ,_dbcc :=_ecfb .getBorderStyle (_caec );
_fbea .SetBorder (_g .CellBorderSideBottom ,_gdg ,_dbcc );if _bgd !=nil &&*_bgd !=nil {_fbea .SetSideBorderColor (_g .CellBorderSideBottom ,*_bgd );};};if _ddce :=_fffa .MarLAttr ;_ddce !=nil {_egag =float64 (_ac .FromSTCoordinate32 (*_ddce ));};switch _fffa .AnchorAttr {case _cea .ST_TextAnchoringTypeT :_feg =_g .CellVerticalAlignmentTop ;
case _cea .ST_TextAnchoringTypeB :_feg =_g .CellVerticalAlignmentBottom ;};if _fffa .FillPropertiesChoice .NoFill ==nil {if _ggf :=_fffa .FillPropertiesChoice .SolidFill ;_ggf !=nil {_fgf ,_ddec :=_ecfb .getColorFromSolidFill (_ggf );_fbea .SetOpacity (_ddec );
_fbea .SetBackgroundColor (_fgf );};};if _dacb :=_fffa .MarBAttr ;_dacb !=nil {_ddcd =float64 (_ac .FromSTCoordinate32 (*_dacb ));};if _gfd :=_fffa .MarTAttr ;_gfd !=nil {_cged =float64 (_ac .FromSTCoordinate32 (*_gfd ));};};_fbea .SetVerticalAlignment (_feg );
_fbea .SetIndent (_egag );var _aac float64 ;if _fagc :=_gddc .TxBody ;_fagc !=nil {_aff :=_ecfb .makePdfDivisionFromTxBody (_fagc ,_febb );_aac =_aff .Height ()+_cged +_ddcd ;_fbea .SetContent (_aff );};return _aac ;};func (_ccdf *textboxContext )assignPropsToCurrentParagraph (_eedf *_cea .CT_TextParagraphProperties ){_dabc :=12.4;
if _eedf ==nil {_ccdf ._gcaa ._fccc =_dabc ;return ;};if _aaeb :=_eedf .DefRPr ;_aaeb !=nil {_cfbc :=_aaeb .SzAttr ;if _cfbc !=nil {_dfb :=float64 (*_cfbc )/1200;if _dabc <=_dfb {_dabc =_dfb ;};};};if _acc :=_eedf .MarLAttr ;_acc !=nil {_ccdf ._gcaa ._cef =_f .FromEMU (int64 (*_acc ));
};_ccdf ._gcaa ._dbee =_ccdf ._ecbb ;if _dgab :=_eedf .MarRAttr ;_dgab !=nil {_ccdf ._gcaa ._dbee -=_f .FromEMU (int64 (*_dgab ));};if _cggd :=_eedf .IndentAttr ;_cggd !=nil {_ccdf ._gcaa ._cceb =_f .FromEMU (int64 (*_cggd ));};if _cbbb :=_eedf .LatinLnBrkAttr ;
_cbbb !=nil {_ccdf ._gcaa ._ffa =*_cbbb ;};if _cfg :=_eedf .LnSpc ;_cfg !=nil &&_cfg .TextSpacingChoice !=nil {if _bgg :=_cfg .TextSpacingChoice .SpcPct ;_bgg !=nil {if _bagb :=_bgg .ValAttr .ST_TextSpacingPercent ;_bagb !=nil {_dabc =float64 (*_bagb )/5000;
};};};var _gcfa float64 ;if _cefg :=_eedf .SpcBef ;_cefg !=nil &&_cefg .TextSpacingChoice !=nil {if _dcf :=_cefg .TextSpacingChoice .SpcPts ;_dcf !=nil {_gcfa =float64 (_dcf .ValAttr )/100;};};_eaaf :=_ccdf ._cege ;if len (_eaaf )> 0{_gcfa -=_eaaf [len (_eaaf )-1]._gfcb ;
if _gcfa < 0{_gcfa =0;};};_ccdf ._gcaa ._gbgc =_gcfa ;if _bbea :=_eedf .SpcAft ;_bbea !=nil &&_bbea .TextSpacingChoice !=nil {if _dda :=_bbea .TextSpacingChoice .SpcPts ;_dda !=nil {_ccdf ._gcaa ._gfcb =float64 (_dda .ValAttr )/100;};};_ccdf ._gcaa ._fccc =_dabc ;
_ccdf ._gcaa ._fbdf =_eedf .AlgnAttr ;};func _agdb (_aeeg ,_gcddc *_cea .CT_TextBodyProperties )*_cea .CT_TextBodyProperties {_gbef :=_cea .NewCT_TextBodyProperties ();if _aeeg !=nil {*_gbef =*_aeeg ;};if _gcddc ==nil {return _gbef ;};if _gbef .RotAttr ==nil {_gbef .RotAttr =_gcddc .RotAttr ;
};if _gbef .SpcFirstLastParaAttr ==nil {_gbef .SpcFirstLastParaAttr =_gcddc .SpcFirstLastParaAttr ;};if _gbef .VertOverflowAttr ==_cea .ST_TextVertOverflowTypeUnset {_gbef .VertOverflowAttr =_gcddc .VertOverflowAttr ;};if _gbef .HorzOverflowAttr ==_cea .ST_TextHorzOverflowTypeUnset {_gbef .HorzOverflowAttr =_gcddc .HorzOverflowAttr ;
};if _gbef .VertAttr ==_cea .ST_TextVerticalTypeUnset {_gbef .VertAttr =_gcddc .VertAttr ;};if _gbef .WrapAttr ==_cea .ST_TextWrappingTypeUnset {_gbef .WrapAttr =_gcddc .WrapAttr ;};if _gbef .LInsAttr ==nil {_gbef .LInsAttr =_gcddc .LInsAttr ;};if _gbef .TInsAttr ==nil {_gbef .TInsAttr =_gcddc .TInsAttr ;
};if _gbef .RInsAttr ==nil {_gbef .RInsAttr =_gcddc .RInsAttr ;};if _gbef .BInsAttr ==nil {_gbef .BInsAttr =_gcddc .BInsAttr ;};if _gbef .NumColAttr ==nil {_gbef .NumColAttr =_gcddc .NumColAttr ;};if _gbef .SpcColAttr ==nil {_gbef .SpcColAttr =_gcddc .SpcColAttr ;
};if _gbef .RtlColAttr ==nil {_gbef .RtlColAttr =_gcddc .RtlColAttr ;};if _gbef .AnchorAttr ==_cea .ST_TextAnchoringTypeUnset {_gbef .AnchorAttr =_gcddc .AnchorAttr ;};if _gbef .AnchorCtrAttr ==nil {_gbef .AnchorCtrAttr =_gcddc .AnchorCtrAttr ;};if _gbef .ForceAAAttr ==nil {_gbef .ForceAAAttr =_gcddc .ForceAAAttr ;
};if _gbef .UprightAttr ==nil {_gbef .UprightAttr =_gcddc .UprightAttr ;};if _gbef .CompatLnSpcAttr ==nil {_gbef .CompatLnSpcAttr =_gcddc .CompatLnSpcAttr ;};if _gbef .PrstTxWarp ==nil {_gbef .PrstTxWarp =_gcddc .PrstTxWarp ;};if _gbef .TextAutofitChoice .NoAutofit ==nil {_gbef .TextAutofitChoice .NoAutofit =_gcddc .TextAutofitChoice .NoAutofit ;
};if _gbef .TextAutofitChoice .NormAutofit ==nil {_gbef .TextAutofitChoice .NormAutofit =_gcddc .TextAutofitChoice .NormAutofit ;};if _gbef .TextAutofitChoice .SpAutoFit ==nil {_gbef .TextAutofitChoice .SpAutoFit =_gcddc .TextAutofitChoice .SpAutoFit ;
};if _gbef .Scene3d ==nil {_gbef .Scene3d =_gcddc .Scene3d ;};if _gbef .Text3DChoice .Sp3d ==nil {_gbef .Text3DChoice .Sp3d =_gcddc .Text3DChoice .Sp3d ;};if _gbef .Text3DChoice .FlatTx ==nil {_gbef .Text3DChoice .FlatTx =_gcddc .Text3DChoice .FlatTx ;
};if _gbef .ExtLst ==nil {_gbef .ExtLst =_gcddc .ExtLst ;};return _gbef ;};func (_cbdd *convertContext )renderCurrentStateToGoImage ()(_aa .Image ,error ){_dcadf :=_ac .MakeTempCreator (_cbdd ._bag ,_cbdd ._dgf );_dcadf .NewPage ();for _ ,_abcdg :=range _cbdd ._egcf {if _abcdg !=nil {_dcadf .MoveTo (0,0);
_dcadf .Draw (_abcdg );};};_bbcd ,_bbcf :=_ac .GetPageFromCreator (_dcadf );if _bbcf !=nil {return nil ,_bbcf ;};return _fb .NewImageDevice ().Render (_bbcd );};func _gedf (_eeag int ,_cbaa bool )string {_gaab :=(_eeag -1)/26+1;_bbgd :=byte ((_eeag -1)%26);
if _cbaa {_bbgd +=byte (65);}else {_bbgd +=byte (97);};_gge :=_c .NewBuffer ([]byte {});for _bbgg :=0;_bbgg < _gaab ;_bbgg ++{_gge .Write ([]byte {_bbgd });};return _gge .String ();};func _ccfa (_bbeaad ,_fgcg *_cea .CT_TextCharacterProperties )*_cea .CT_TextCharacterProperties {_abbe :=_cea .NewCT_TextCharacterProperties ();
if _bbeaad !=nil {*_abbe =*_bbeaad ;};if _fgcg ==nil {return _abbe ;};if _abbe .KumimojiAttr ==nil {_abbe .KumimojiAttr =_fgcg .KumimojiAttr ;};if _abbe .LangAttr ==nil {_abbe .LangAttr =_fgcg .LangAttr ;};if _abbe .AltLangAttr ==nil {_abbe .AltLangAttr =_fgcg .AltLangAttr ;
};if _abbe .SzAttr ==nil {_abbe .SzAttr =_fgcg .SzAttr ;};if _abbe .BAttr ==nil {_abbe .BAttr =_fgcg .BAttr ;};if _abbe .IAttr ==nil {_abbe .IAttr =_fgcg .IAttr ;};if _abbe .UAttr ==_cea .ST_TextUnderlineTypeUnset {_abbe .UAttr =_fgcg .UAttr ;};if _abbe .StrikeAttr ==_cea .ST_TextStrikeTypeUnset {_abbe .StrikeAttr =_fgcg .StrikeAttr ;
};if _abbe .KernAttr ==nil {_abbe .KernAttr =_fgcg .KernAttr ;};if _abbe .CapAttr ==_cea .ST_TextCapsTypeUnset {_abbe .CapAttr =_fgcg .CapAttr ;};if _abbe .SpcAttr ==nil {_abbe .SpcAttr =_fgcg .SpcAttr ;};if _abbe .NormalizeHAttr ==nil {_abbe .NormalizeHAttr =_fgcg .NormalizeHAttr ;
};if _abbe .BaselineAttr ==nil {_abbe .BaselineAttr =_fgcg .BaselineAttr ;};if _abbe .NoProofAttr ==nil {_abbe .NoProofAttr =_fgcg .NoProofAttr ;};if _abbe .DirtyAttr ==nil {_abbe .DirtyAttr =_fgcg .DirtyAttr ;};if _abbe .ErrAttr ==nil {_abbe .ErrAttr =_fgcg .ErrAttr ;
};if _abbe .SmtCleanAttr ==nil {_abbe .SmtCleanAttr =_fgcg .SmtCleanAttr ;};if _abbe .SmtIdAttr ==nil {_abbe .SmtIdAttr =_fgcg .SmtIdAttr ;};if _abbe .BmkAttr ==nil {_abbe .BmkAttr =_fgcg .BmkAttr ;};if _abbe .Ln ==nil {_abbe .Ln =_fgcg .Ln ;};if _abbe .FillPropertiesChoice .NoFill ==nil {_abbe .FillPropertiesChoice .NoFill =_fgcg .FillPropertiesChoice .NoFill ;
};if _abbe .FillPropertiesChoice .SolidFill ==nil {_abbe .FillPropertiesChoice .SolidFill =_fgcg .FillPropertiesChoice .SolidFill ;};if _abbe .FillPropertiesChoice .BlipFill ==nil {_abbe .FillPropertiesChoice .BlipFill =_fgcg .FillPropertiesChoice .BlipFill ;
};if _abbe .EffectPropertiesChoice .EffectLst ==nil {_abbe .EffectPropertiesChoice .EffectLst =_fgcg .EffectPropertiesChoice .EffectLst ;};if _abbe .EffectPropertiesChoice .EffectDag ==nil {_abbe .EffectPropertiesChoice .EffectDag =_fgcg .EffectPropertiesChoice .EffectDag ;
};if _abbe .Highlight ==nil {_abbe .Highlight =_fgcg .Highlight ;};if _abbe .TextUnderlineLineChoice .ULnTx ==nil {_abbe .TextUnderlineLineChoice .ULnTx =_fgcg .TextUnderlineLineChoice .ULnTx ;};if _abbe .TextUnderlineLineChoice .ULn ==nil {_abbe .TextUnderlineLineChoice .ULn =_fgcg .TextUnderlineLineChoice .ULn ;
};if _abbe .TextUnderlineFillChoice .UFillTx ==nil {_abbe .TextUnderlineFillChoice .UFillTx =_fgcg .TextUnderlineFillChoice .UFillTx ;};if _abbe .TextUnderlineFillChoice .UFill ==nil {_abbe .TextUnderlineFillChoice .UFill =_fgcg .TextUnderlineFillChoice .UFill ;
};if _abbe .Latin ==nil {_abbe .Latin =_fgcg .Latin ;};if _abbe .Ea ==nil {_abbe .Ea =_fgcg .Ea ;};if _abbe .Cs ==nil {_abbe .Cs =_fgcg .Cs ;};if _abbe .Sym ==nil {_abbe .Sym =_fgcg .Sym ;};if _abbe .Rtl ==nil {_abbe .Rtl =_fgcg .Rtl ;};return _abbe ;};
func _bebaf (_ebeef *_gb .CT_Shape )(_gb .ST_PlaceholderType ,*uint32 ){if _dfge :=_ebeef .NvSpPr ;_dfge !=nil {if _gae :=_dfge .NvPr ;_gae !=nil {if _cacf :=_gae .Ph ;_cacf !=nil {return _cacf .TypeAttr ,_cacf .IdxAttr ;};};};return _gb .ST_PlaceholderTypeUnset ,nil ;
};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_db .PdfFont ){_ac .RegisterFont (name ,style ,font );};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _ac .RegisterFontsFromDirectory (dirName )};func (_bbbf *convertContext )getColorFromMatrixReference (_bgf *_cea .CT_StyleMatrixReference )_g .Color {if _bgf ==nil {return nil ;};var _bcbe _g .Color ;
var _fffc string ;if _egf :=_bgf .SrgbClr ;_egf !=nil {_fffc =_egf .ValAttr ;}else if _dgbg :=_bgf .SchemeClr ;_dgbg !=nil {_fffc =_ac .GetColorStringFromDmlColor (_bbbf ._cadg .GetColorBySchemeColor (_dgbg .ValAttr ));_fffc =_ac .AdjustColor (_fffc ,_dgbg .EG_ColorTransform );
};if _fffc !=""{_bcbe =_g .ColorRGBFromHex ("\u0023"+_fffc );};return _bcbe ;};func (_fege *textboxContext )newWord (){_fege ._eacff =&word {_baf :true ,_ecdd :_fege ._bfeb ._afdc }};func (_geeg *convertContext )getInfoFromLn (_daaa *_cea .CT_LineProperties )(_g .Color ,float64 ,float64 ){if _daaa ==nil ||_daaa .LineFillPropertiesChoice .NoFill !=nil {return nil ,0,0;
};var _aaa float64 ;_gdfdc ,_ecg :=_geeg .getColorFromSolidFill (_daaa .LineFillPropertiesChoice .SolidFill );if _deeb :=_daaa .WAttr ;_deeb !=nil {_aaa =_f .FromEMU (int64 (*_deeb ));}else {_aaa =1;};return _gdfdc ,_aaa ,_ecg ;};type symbol struct{_dfee string ;
_cgdc float64 ;_ggcg float64 ;_abb float64 ;_daddf float64 ;_fbaa float64 ;_ggbg *_g .TextStyle ;_gede string ;_ded bool ;_cedb bool ;_gef bool ;};func _gfcf (_bdcb float64 )float64 {return _bdcb *_f .Millimeter };func _baef (_bdgg ,_ebeg *_cea .CT_TableStyleCellStyle )*_cea .CT_TableStyleCellStyle {_babd :=_cea .NewCT_TableStyleCellStyle ();
if _bdgg !=nil {*_babd =*_bdgg ;};if _ebeg ==nil {return _babd ;};if _babd .TcBdr ==nil {_babd .TcBdr =_ebeg .TcBdr ;}else {if _babd .TcBdr .Left ==nil {_babd .TcBdr .Left =_ebeg .TcBdr .Left ;};if _babd .TcBdr .Right ==nil {_babd .TcBdr .Right =_ebeg .TcBdr .Right ;
};if _babd .TcBdr .Top ==nil {_babd .TcBdr .Top =_ebeg .TcBdr .Top ;};if _babd .TcBdr .Bottom ==nil {_babd .TcBdr .Bottom =_ebeg .TcBdr .Bottom ;};if _babd .TcBdr .InsideH ==nil {_babd .TcBdr .InsideH =_ebeg .TcBdr .InsideH ;};if _babd .TcBdr .InsideV ==nil {_babd .TcBdr .InsideV =_ebeg .TcBdr .InsideV ;
};};if _babd .ThemeableFillStyleChoice .Fill ==nil {_babd .ThemeableFillStyleChoice .Fill =_ebeg .ThemeableFillStyleChoice .Fill ;};if _babd .ThemeableFillStyleChoice .FillRef ==nil {_babd .ThemeableFillStyleChoice .FillRef =_ebeg .ThemeableFillStyleChoice .FillRef ;
};return _babd ;};func _gdf (_facgc string )[]*symbol {_bbeg :=[]*symbol {};for _ ,_effdc :=range _facgc {_bbeg =append (_bbeg ,&symbol {_dfee :string (_effdc )});};return _bbeg ;};func (_eca *convertContext )extractDefaultProperties (){_gf :=_eca ._cadg .X ();
_acd :=_gf .DefaultTextStyle ;var _gce ,_aea ,_aef ,_ecba ,_gd ,_bd ,_bc ,_abg ,_dc ,_gdd *_cea .CT_TextParagraphProperties ;if _acd !=nil {_gce =_acd .DefPPr ;_aea =_fbbc (_acd .Lvl1pPr ,_gce );_aef =_fbbc (_acd .Lvl2pPr ,_gce );_ecba =_fbbc (_acd .Lvl3pPr ,_gce );
_gd =_fbbc (_acd .Lvl4pPr ,_gce );_bd =_fbbc (_acd .Lvl5pPr ,_gce );_bc =_fbbc (_acd .Lvl6pPr ,_gce );_abg =_fbbc (_acd .Lvl7pPr ,_gce );_dc =_fbbc (_acd .Lvl8pPr ,_gce );_gdd =_fbbc (_acd .Lvl9pPr ,_gce );_eca ._cegcc =_gce ;_eca ._fdae =_gce .DefRPr ;
};_eca ._eec =make ([]*_cea .CT_TextParagraphProperties ,9);_eca ._eec [0]=_aea ;_eca ._eec [1]=_aef ;_eca ._eec [2]=_ecba ;_eca ._eec [3]=_gd ;_eca ._eec [4]=_bd ;_eca ._eec [5]=_bc ;_eca ._eec [6]=_abg ;_eca ._eec [7]=_dc ;_eca ._eec [8]=_gdd ;_cbc :=_eca ._cadg .SlideMasters ()[0].X ();
_ba :=_cbc .TxStyles ;_bfcg :=_ba .TitleStyle ;_eca ._beaf =_fbbc (_bfcg .DefPPr ,_gce );_eca ._ccc =_eca ._beaf .DefRPr ;_eca ._dded =make ([]*_cea .CT_TextParagraphProperties ,9);_eca ._dded [0]=_fbbc (_bfcg .Lvl1pPr ,_aea );_eca ._dded [1]=_fbbc (_bfcg .Lvl2pPr ,_aef );
_eca ._dded [2]=_fbbc (_bfcg .Lvl3pPr ,_ecba );_eca ._dded [3]=_fbbc (_bfcg .Lvl4pPr ,_gd );_eca ._dded [4]=_fbbc (_bfcg .Lvl5pPr ,_bd );_eca ._dded [5]=_fbbc (_bfcg .Lvl6pPr ,_bc );_eca ._dded [6]=_fbbc (_bfcg .Lvl7pPr ,_abg );_eca ._dded [7]=_fbbc (_bfcg .Lvl8pPr ,_dc );
_eca ._dded [8]=_fbbc (_bfcg .Lvl9pPr ,_gdd );_fc :=_ba .BodyStyle ;_eca ._dba =_fbbc (_fc .DefPPr ,_gce );_eca ._ceag =_eca ._dba .DefRPr ;_eca ._bebg =make ([]*_cea .CT_TextParagraphProperties ,9);_eca ._bebg [0]=_fbbc (_fc .Lvl1pPr ,_aea );_eca ._bebg [1]=_fbbc (_fc .Lvl2pPr ,_aef );
_eca ._bebg [2]=_fbbc (_fc .Lvl3pPr ,_ecba );_eca ._bebg [3]=_fbbc (_fc .Lvl4pPr ,_gd );_eca ._bebg [4]=_fbbc (_fc .Lvl5pPr ,_bd );_eca ._bebg [5]=_fbbc (_fc .Lvl6pPr ,_bc );_eca ._bebg [6]=_fbbc (_fc .Lvl7pPr ,_abg );_eca ._bebg [7]=_fbbc (_fc .Lvl8pPr ,_dc );
_eca ._bebg [8]=_fbbc (_fc .Lvl9pPr ,_gdd );};func (_adff *textboxContext )adjustHeights (_faae float64 ){if _adff ._bfeb ._dcab < _faae {_adff ._gcaa ._gcaac +=(_faae -_adff ._bfeb ._dcab );_adff ._bfeb ._dcab =_faae ;};};var _fa =_gfcf (1.9);var _aedd =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
func _ddb (_bbdg *_cea .CT_TextCharacterProperties ,_agbb *_cea .CT_TableStyleTextStyle )*_cea .CT_TextCharacterProperties {_fgea :=_cea .NewCT_TextCharacterProperties ();if _bbdg !=nil {*_fgea =*_bbdg ;};if _agbb ==nil {return _fgea ;};if _fgea .BAttr ==nil &&_agbb .BAttr !=_cea .ST_OnOffStyleTypeUnset {_agcc :=_agbb .BAttr ==_cea .ST_OnOffStyleTypeOn ;
_fgea .BAttr =&_agcc ;};if _fgea .IAttr ==nil &&_agbb .IAttr !=_cea .ST_OnOffStyleTypeUnset {_bbddf :=_agbb .IAttr ==_cea .ST_OnOffStyleTypeOn ;_fgea .IAttr =&_bbddf ;};if _fgea .FillPropertiesChoice .NoFill ==nil &&_fgea .FillPropertiesChoice .SolidFill ==nil {_fgea .FillPropertiesChoice .SolidFill =_cea .NewCT_SolidColorFillProperties ();
_fgea .FillPropertiesChoice .SolidFill .ScrgbClr =_agbb .ScrgbClr ;_fgea .FillPropertiesChoice .SolidFill .SrgbClr =_agbb .SrgbClr ;_fgea .FillPropertiesChoice .SolidFill .HslClr =_agbb .HslClr ;_fgea .FillPropertiesChoice .SolidFill .SysClr =_agbb .SysClr ;
_fgea .FillPropertiesChoice .SolidFill .SchemeClr =_agbb .SchemeClr ;_fgea .FillPropertiesChoice .SolidFill .PrstClr =_agbb .PrstClr ;};if _dfbd :=_agbb .ThemeableFontStylesChoice .Font ;_dfbd !=nil &&_fgea .Latin ==nil &&_fgea .Ea ==nil &&_fgea .Cs ==nil {_fgea .Latin =_dfbd .Latin ;
_fgea .Ea =_dfbd .Ea ;_fgea .Cs =_dfbd .Cs ;};return _fgea ;};func (_dgb *convertContext )addShapes (_bb *_gb .CT_CommonSlideData ,_ga bool ){if _bb ==nil {return ;};_eed :=&background {};if _eedd :=_bb .Bg ;_eedd !=nil {if _ea :=_eedd .BackgroundChoice .BgPr ;
_ea !=nil {if _ea .FillPropertiesChoice .NoFill ==nil {if _dbc :=_ea .FillPropertiesChoice .SolidFill ;_dbc !=nil {_fcd ,_adgb :=_dgb .getColorFromSolidFill (_dbc );if _fcd !=nil {_eed ._dgfc =_fcd ;_eed ._dffd =_adgb ;};}else if _cgc :=_ea .FillPropertiesChoice .BlipFill ;
_cgc !=nil {_eed ._dgae =_cgc ;};};};};_dgb ._afbb =_eed ;if _dbe :=_bb .SpTree ;_dbe !=nil {for _ ,_gddg :=range _dbe .GroupShapeChoice {if _gddg !=nil {if _gddg .Sp !=nil {_gdda :=_dgb .getShapes (_gddg .Sp ,_ga ,false );_dgb ._egcf =append (_dgb ._egcf ,_gdda ...);
};if _gddg .GraphicFrame !=nil {var _gbf ,_gbg ,_abd ,_bbf float64 ;if _ag :=_gddg .GraphicFrame .Xfrm ;_ag !=nil {_gbf ,_gbg ,_abd ,_bbf =_ac .GetDataFromXfrm (_ag );};if _abd ==0&&_bbf ==0{_abd =_dgb ._bag ;_bbf =_dgb ._dgf ;};if _dfg :=_gddg .GraphicFrame .Graphic ;
_dfg !=nil {if _ff :=_dfg .GraphicData ;_ff !=nil {for _ ,_ggg :=range _ff .Any {if _eae ,_fbg :=_ggg .(*_ecb .Chart );_fbg {_dab ,_fga :=_dgb .makePdfBlockFromChart (_eae ,_abd ,_bbf );if _fga !=nil {_ce .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_fga );
};if _dab !=nil {_dab .SetPos (_gbf ,_gbg );_dgb ._egcf =append (_dgb ._egcf ,_dab );};}else if _ffg ,_ggge :=_ggg .(*_cea .Tbl );_ggge {_fbgf :=_dgb .makePdfBlockFromTable (_ffg );if _fbgf !=nil {_dga :=_g .NewBlock (_abd ,_bbf );_dga .SetPos (_gbf ,_gbg );
_eac :=_dga .Draw (_fbgf );if _eac !=nil {_ce .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0064r\u0061\u0077\u0020\u0074\u0061b\u006c\u0065\u003a\u0020\u0025\u0073",_eac );if _eac ==_g .ErrContentNotFit {_dga =_g .NewBlock (_dgb ._bag -1.5*_gbf ,_dgb ._dgf -1.5*_gbg );
_dga .SetPos (_gbf ,_gbg );_eac =_dga .Draw (_fbgf );};};if _eac ==nil {_dgb ._egcf =append (_dgb ._egcf ,_dga );};};};};};};};if _gddg .CxnSp !=nil {_ef :=_dgb .getConnectors (_gddg .CxnSp );_dgb ._egcf =append (_dgb ._egcf ,_ef ...);};if _gddg .GrpSp !=nil {_ggc :=0.0;
_dde :=0.0;if _de :=_gddg .GrpSp .GrpSpPr .Xfrm ;_de !=nil {_ggc ,_dde =_ac .GetGroupOffsetFromXfrm (_de );};for _ ,_aaga :=range _gddg .GrpSp .GroupShapeChoice {if _aaga .CxnSp !=nil {_ged :=_dgb .getGroupConnectors (_aaga .CxnSp ,_ggc ,_dde );_dgb ._egcf =append (_dgb ._egcf ,_ged ...);
};};};if _gddg .Pic !=nil {_eee :=false ;var _dfe ,_dcc ,_bbe ,_cd float64 ;if _cge :=_gddg .Pic .SpPr ;_cge !=nil {if _dbf :=_cge .Xfrm ;_dbf !=nil {_dfe ,_dcc ,_bbe ,_cd =_ac .GetDataFromXfrm (_dbf );_eee =true ;};};var _ega _gb .ST_PlaceholderType ;
var _af *uint32 ;if _dabd :=_gddg .Pic .NvPicPr ;_dabd !=nil {if _dag :=_dabd .NvPr ;_dag !=nil {if _eff :=_dag .Ph ;_eff !=nil {_ega =_eff .TypeAttr ;_af =_eff .IdxAttr ;};};};_ca ,_ ,_ ,_ ,_ :=_gfage (_dgb ._bgb .CSld ,_ega ,_af );_ed ,_ ,_ ,_ ,_ :=_gfage (_dgb ._eagg .CSld ,_ega ,_af );
if _ed ==nil {_ed =_ca ;};if _ed !=nil &&!_eee {_dfe ,_dcc ,_bbe ,_cd =_ac .GetDataFromXfrm (_ed );};if _cfa :=_gddg .Pic .BlipFill ;_cfa !=nil {_gbc :=_dgb .getShapeFromBlipFill (_cfa ,_dfe ,_dcc ,_bbe ,_cd ,_ga );_dgb ._egcf =append (_dgb ._egcf ,_gbc );
};};};};};};func (_cddc *convertContext )getGroupConnectors (_daa *_gb .CT_Connector ,_gedg float64 ,_dbg float64 )[]_g .Drawable {_eaef ,_ ,_ ,_ ,_ ,_ ,_ :=_cddc .getShapesFromSpPr (_daa .SpPr ,_daa .Style ,false ,_gedg ,_dbg );return _eaef ;};func (_cbfb *line )moveRight (_edfb float64 ){for _ ,_egccg :=range _cbfb ._baeb {_egccg ._ecdd +=_edfb ;
};};func (_bfa *convertContext )getPhData (_feaf *_gb .CT_Shape )(*_cea .CT_Transform2D ,*_cea .CT_TextBodyProperties ,*_cea .CT_TextListStyle ,bool ,bool ,bool ){_ddgb ,_ggea :=_bebaf (_feaf );_eafbd ,_bgca ,_gaca ,_dgbd ,_fbgee :=_gfage (_bfa ._bgb .CSld ,_ddgb ,_ggea );
_dada ,_eddb ,_bagc ,_cfef ,_eaae :=_gfage (_bfa ._eagg .CSld ,_ddgb ,_ggea );if _dada ==nil {_dada =_eafbd ;};_bgac ,_gbfc :=_edfc (_eddb ,_bgca );var _dega ,_afe ,_fddcd bool ;if _bagc ==nil {if _gaca !=nil {_dega =*_gaca ;};}else {_dega =*_bagc ;};if _eaae ==nil {if _fbgee !=nil {_fddcd =*_fbgee ;
};}else {_fddcd =*_eaae ;};if _cfef ==nil {if _dgbd !=nil {_afe =*_dgbd ;};}else {_afe =*_cfef ;};return _dada ,_bgac ,_gbfc ,_dega ,_afe ,_fddcd ;};func (_fgc *convertContext )getShapesFromSpPr (_bddf *_cea .CT_ShapeProperties ,_egd *_cea .CT_ShapeStyle ,_bba bool ,_fcdg float64 ,_cgcf float64 )([]_g .Drawable ,float64 ,float64 ,float64 ,float64 ,_g .Color ,bool ){_ecad :=[]_g .Drawable {};
var _dgg ,_bbd ,_eabe ,_fee ,_gfg float64 ;var _bge ,_fad ,_cgd ,_cfe _g .Color ;var _faca *_cea .CT_BlipFillProperties ;_ffe ,_feb :=1.0,1.0;if _egd !=nil {_bge ,_fad ,_cfe =_fgc .getStyleColors (_egd );};if _abgc :=_bddf .Ln ;_abgc !=nil {if _abgc .LineFillPropertiesChoice .NoFill !=nil {_cgd ,_gfg =nil ,0;
}else {_cgd ,_gfg ,_ffe =_fgc .getInfoFromLn (_abgc );if _cgd ==nil {_cgd =_cfe ;};};};if _bddf .FillPropertiesChoice .NoFill !=nil {_fad ,_feb =nil ,0;}else if _bba {_fad =_fgc ._afbb ._dgfc ;_feb =_fgc ._afbb ._dffd ;_faca =_fgc ._afbb ._dgae ;}else if _cgdg :=_bddf .FillPropertiesChoice .SolidFill ;
_cgdg !=nil {_fad ,_feb =_fgc .getColorFromSolidFill (_cgdg );};var _gaaf bool ;if _bfe :=_bddf .Xfrm ;_bfe !=nil {_dgg ,_bbd ,_eabe ,_fee =_ac .GetDataFromXfrm (_bfe );_dgg +=_fcdg ;_bbd +=_cgcf ;_gaaf =true ;};if _ece :=_bddf .GeometryChoice .CustGeom ;
_ece !=nil {_abc :=[]_cg .Point {};_bdgf ,_edf :=1.0,1.0;if _cac :=_ece .PathLst ;_cac !=nil {for _ ,_bga :=range _cac .Path {if _bga !=nil {if _cfad :=_bga .WAttr ;_cfad !=nil {_bdgf =_eabe /_f .FromEMU (*_cfad );};if _effd :=_bga .HAttr ;_effd !=nil {_edf =_fee /_f .FromEMU (*_effd );
};for _ ,_aed :=range _bga .Path2DChoice {if _aed .Close !=nil {};if _ggaf :=_aed .MoveTo ;_aed .MoveTo !=nil {if _ggaf !=nil &&_ggaf .Pt !=nil {_abca ,_fdg :=_eafg (_ggaf .Pt );_abc =append (_abc ,_cg .Point {X :_abca *_bdgf +_dgg ,Y :_fdg *_edf +_bbd });
};};if _cbe :=_aed .LnTo ;_cbe !=nil &&_cbe .Pt !=nil {_aad ,_bfff :=_eafg (_cbe .Pt );_abc =append (_abc ,_cg .Point {X :_aad *_bdgf +_dgg ,Y :_bfff *_edf +_bbd });};};_fgd :=_fgc ._eeec .NewPolygon ([][]_cg .Point {_abc });_fgd .SetFillColor (_fad );
_fgd .SetFillOpacity (_feb );_fgd .SetBorderWidth (_gfg );if _cgd !=nil {_fgd .SetBorderColor (_cgd );_fgd .SetBorderOpacity (_ffe );};_ecad =append (_ecad ,_fgd );};};};};if _abaa :=_bddf .GeometryChoice .PrstGeom ;_abaa !=nil {switch _abaa .PrstAttr {case _cea .ST_ShapeTypeRect :if _faca !=nil {_eaf :=_fgc .getShapeFromBlipFill (_faca ,_dgg ,_bbd ,_eabe ,_fee ,false );
_ecad =append (_ecad ,_eaf );}else {_fef :=_fgc ._eeec .NewRectangle (_dgg ,_bbd ,_eabe ,_fee );_cae :=_fad !=nil &&_feb > 0;if _cae {_fef .SetFillColor (_fad );_fef .SetFillOpacity (_feb );};_bbb :=_cgd !=nil &&_ffe > 0&&_gfg > 0;if _bbb {_fef .SetBorderWidth (_gfg );
_fef .SetBorderColor (_cgd );_fef .SetBorderOpacity (_ffe );};if _cae ||_bbb {_ecad =append (_ecad ,_fef );};};case _cea .ST_ShapeTypeLine :_cee :=_fgc ._eeec .NewLine (_dgg ,_bbd ,_dgg +_eabe ,_bbd +_fee );_cee .SetLineWidth (_gfg );if _cgd !=nil {_cee .SetColor (_cgd );
};_ecad =append (_ecad ,_cee );};};return _ecad ,_dgg ,_bbd ,_eabe ,_fee ,_bge ,_gaaf ;};type romanMatch struct{_aada int ;_ccd string ;};type line struct{_fbgg float64 ;_bbcc float64 ;_fca float64 ;_afdc float64 ;_dcab float64 ;_baeb []*word ;};func _fbgff (_cbcdc ,_fadg *_cea .CT_TableStyleTextStyle )*_cea .CT_TableStyleTextStyle {_cgcd :=_cea .NewCT_TableStyleTextStyle ();
if _cbcdc !=nil {*_cgcd =*_cbcdc ;};if _fadg ==nil {return _cgcd ;};if _cgcd .BAttr ==_cea .ST_OnOffStyleTypeUnset {_cgcd .BAttr =_fadg .BAttr ;};if _cgcd .IAttr ==_cea .ST_OnOffStyleTypeUnset {_cgcd .IAttr =_fadg .IAttr ;};if _cgcd .ThemeableFontStylesChoice .Font ==nil {_cgcd .ThemeableFontStylesChoice .Font =_fadg .ThemeableFontStylesChoice .Font ;
};if _cgcd .ThemeableFontStylesChoice .FontRef ==nil {_cgcd .ThemeableFontStylesChoice .FontRef =_fadg .ThemeableFontStylesChoice .FontRef ;};if _cgcd .ScrgbClr ==nil {_cgcd .ScrgbClr =_fadg .ScrgbClr ;};if _cgcd .SrgbClr ==nil {_cgcd .SrgbClr =_fadg .SrgbClr ;
};if _cgcd .HslClr ==nil {_cgcd .HslClr =_fadg .HslClr ;};if _cgcd .SysClr ==nil {_cgcd .SysClr =_fadg .SysClr ;};if _cgcd .SchemeClr ==nil {_cgcd .SchemeClr =_fadg .SchemeClr ;};if _cgcd .PrstClr ==nil {_cgcd .PrstClr =_fadg .PrstClr ;};return _cgcd ;
};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_affc *convertContext )renderPageWithDrawableToGoImage (_ecdbe _g .Drawable )(_aa .Image ,error ){_geb :=_ac .MakeTempCreator (_affc ._bag ,_affc ._dgf );
_geb .NewPage ();_geb .Draw (_ecdbe );_cfba ,_cade :=_ac .GetPageFromCreator (_geb );if _cade !=nil {return nil ,_cade ;};return _fb .NewImageDevice ().Render (_cfba );};func _edda (_eddc ,_ddeb *_cea .CT_TextListStyle )*_cea .CT_TextListStyle {_afab :=_cea .NewCT_TextListStyle ();
if _eddc !=nil {*_afab =*_eddc ;};if _ddeb ==nil {return _afab ;};_afab .DefPPr =_fbbc (_afab .DefPPr ,_ddeb .DefPPr );_afab .Lvl1pPr =_fbbc (_afab .Lvl1pPr ,_ddeb .Lvl1pPr );_afab .Lvl2pPr =_fbbc (_afab .Lvl2pPr ,_ddeb .Lvl2pPr );_afab .Lvl3pPr =_fbbc (_afab .Lvl3pPr ,_ddeb .Lvl3pPr );
_afab .Lvl4pPr =_fbbc (_afab .Lvl4pPr ,_ddeb .Lvl4pPr );_afab .Lvl5pPr =_fbbc (_afab .Lvl5pPr ,_ddeb .Lvl5pPr );_afab .Lvl6pPr =_fbbc (_afab .Lvl6pPr ,_ddeb .Lvl6pPr );_afab .Lvl7pPr =_fbbc (_afab .Lvl7pPr ,_ddeb .Lvl7pPr );_afab .Lvl8pPr =_fbbc (_afab .Lvl8pPr ,_ddeb .Lvl8pPr );
_afab .Lvl9pPr =_fbbc (_afab .Lvl9pPr ,_ddeb .Lvl9pPr );return _afab ;};func (_ffc *textboxContext )newParagraph (){_gecb :=&paragraph {};_gecb ._ffged =_ffc ._gba ;_ffc ._gcaa =_gecb ;};func (_cgfd *textboxContext )addTextSymbol (_dgfe *symbol ){_befa :=_g .New ();
_bbdd :=_befa .NewStyledParagraph ();_bbdd .SetMargins (0,0,0,0);_afa :=_bbdd .Append (_dgfe ._dfee );_cbf :=0.0;if _dgfe ._ggbg !=nil {_afa .Style =*_dgfe ._ggbg ;if _dgfe ._ggbg .CharSpacing !=0{_cbf =_dgfe ._ggbg .CharSpacing ;};};_dgfe ._abb =_bbdd .Height ();
_dgfe ._ggcg =_bbdd .Height ()*1.2;if _dgfe ._fbaa ==0{_dgfe ._fbaa =_bbdd .Width ()+_cbf ;};if len (_cgfd ._eacff ._gcef )> 0{_dea :=_cgfd ._eacff ._gcef [len (_cgfd ._eacff ._gcef )-1]._dfee ;if _cgfd ._gcaa ._ffa ||_ac .IsNoSpaceLanguage (_dea )||(_dea =="\u0020")!=(_dgfe ._dfee =="\u0020"){_cgfd .addCurrentWordToParagraph ();
_cgfd .newWord ();};};_cgfd ._eacff ._gcef =append (_cgfd ._eacff ._gcef ,_dgfe );_dgfe ._cgdc =_cgfd ._eacff ._bddb ;_cgfd ._eacff ._bddb +=_dgfe ._fbaa ;if _dgfe ._dfee !="\u0020"{_cgfd ._eacff ._baf =false ;};if _cgfd ._eacff ._bddb >=_cgfd ._gcaa ._dbee -_cgfd ._gcaa ._cef {_cgfd .addCurrentWordToParagraph ();
_cgfd .newLine ();_cgfd .newWord ();};};func (_gfe *convertContext )getConnectors (_baec *_gb .CT_Connector )[]_g .Drawable {_agg ,_ ,_ ,_ ,_ ,_ ,_ :=_gfe .getShapesFromSpPr (_baec .SpPr ,_baec .Style ,false ,0.0,0.0);return _agg ;};func (_addf *textboxContext )addPrefix (_dfbg *prefixData ,_dbae *_g .TextStyle ){_ccdg :=_gdf (_dfbg ._gfdd );
_ebed :=*_dbae ;if _dfbg ._egga {_ebed .Font =_ac .AssignStdFontByName (_ebed ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_gded :=range _ccdg {_gded ._ggbg =&_ebed ;_addf .addTextSymbol (_gded );};_adbf :=-(_dfbg ._gbdd +_addf ._eacff ._bddb );if _adbf < 0{_adbf =0;
};_begc :=&symbol {_dfee :"\u0020",_fbaa :_adbf };_addf .addTextSymbol (_begc );_addf ._eacff ._ecdd +=(_dfbg ._gbdd +_dfbg ._aebb );};func (_decc *convertContext )makeStyleFromRPr (_egb *_cea .CT_TextCharacterProperties )(*_g .TextStyle ,bool ,bool ,bool ){var _abf ,_aec ,_geee bool ;
_afb :=_decc ._eeec .NewTextStyle ();if _egb !=nil {_edff :=_ac .FontStyle_Regular ;_eggb :=_acce (_egb .BAttr );_addd :=_acce (_egb .IAttr );if _eggb &&_addd {_edff =_ac .FontStyle_BoldItalic ;}else if _eggb {_edff =_ac .FontStyle_Bold ;}else if _addd {_edff =_ac .FontStyle_Italic ;
};_geee =_egb .UAttr !=_cea .ST_TextUnderlineTypeUnset &&_egb .UAttr !=_cea .ST_TextUnderlineTypeNone ;_gfag :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _gbcg :=_egb .Latin ;_gbcg !=nil {_gfag =_gbcg .TypefaceAttr ;}else if _ddc :=_egb .Ea ;_ddc !=nil {_gfag =_ddc .TypefaceAttr ;
}else if _gced :=_egb .Cs ;_gced !=nil {_gfag =_gced .TypefaceAttr ;}else if _cbcgc :=_egb .Sym ;_cbcgc !=nil {_gfag =_cbcgc .TypefaceAttr ;};if _dge ,_dfc :=_ac .StdFontsMap [_gfag ];_dfc {_afb .Font =_ac .AssignStdFontByName (_afb ,_dge [_edff ]);}else if _ege :=_ac .GetRegisteredFont (_gfag ,_edff );
_ege !=nil {_afb .Font =_ege ;}else {_ce .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_gfag ,_edff );
_afb .Font =_ac .AssignStdFontByName (_afb ,_ac .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_edff ]);};var _efbf float64 ;if _beab :=_egb .SzAttr ;_beab !=nil {_efbf =_ec .Round (float64 (*_beab )/100)-0.5;}else {_efbf =_ac .DefaultFontSize ;
};if _dadc :=_egb .BaselineAttr ;_dadc !=nil {if _gfbde :=_dadc .ST_PercentageDecimal ;_gfbde !=nil {if *_gfbde > 0{_abf =true ;}else if *_gfbde < 0{_aec =true ;};};};if _abf ||_aec {_efbf =_ec .Round (_efbf *0.64);};_afb .FontSize =_efbf ;_eacg :=0.0;
if _cfb :=_egb .SpcAttr ;_cfb !=nil {if _bbbe :=_cfb .ST_TextPointUnqualified ;_bbbe !=nil &&*_bbbe > 0{_eacg =float64 (*_bbbe )/100;};};_afb .CharSpacing =_eacg ;};return &_afb ,_abf ,_aec ,_geee ;};func (_ead *convertContext )tileImage (_edb *_g .Image ,_fba *_cea .CT_TileInfoProperties ,_gaa ,_afc float64 )*_g .Image {_dbce ,_aba :=1.0,1.0;
if _fcf :=_fba .SxAttr ;_fcf !=nil {_dbce =_ac .FromSTPercentage (_fcf );};if _fbc :=_fba .SyAttr ;_fbc !=nil {_aba =_ac .FromSTPercentage (_fbc );};_bdc :=_ac .MakeTempCreator (_gaa ,_afc );_edb .Scale (_dbce ,_aba );_cdf ,_cfd :=_edb .Width (),_edb .Height ();
var _bdg ,_aga float64 ;if _efc :=_fba .TxAttr ;_efc !=nil {_bdg =_f .FromEMU (_ac .FromSTCoordinate (*_efc ));};if _cc :=_fba .TyAttr ;_cc !=nil {_aga =_f .FromEMU (_ac .FromSTCoordinate (*_cc ));};if _bdg > 0{_bdg -=_cdf ;};if _aga > 0{_aga -=_cfd ;};
_gcd :=_ead ._bag /_cdf +1;_beb :=_ead ._dgf /_cfd +1;for _egc :=0.0;_egc <=_gcd ;_egc ++{_aeab :=_egc *_cdf ;for _fbad :=0.0;_fbad <=_beb ;_fbad ++{_bda :=_fbad *_cfd ;_edb .SetPos (_aeab +_bdg ,_bda +_aga );_bdc .Draw (_edb );};};_adga ,_egca :=_ac .GetPageFromCreator (_bdc );
if _egca !=nil {_ce .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_egca );return nil ;};_eda ,_egca :=_fb .NewImageDevice ().Render (_adga );
if _egca !=nil {_ce .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_egca );return nil ;};_cba ,_egca :=_ead ._eeec .NewImageFromGoImage (_eda );if _egca !=nil {_ce .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_egca );
return nil ;};return _cba ;};type convertContext struct{_eeec *_g .Creator ;_gfac *_ac .Rectangle ;_cadg *_eg .Presentation ;_cdba *_eg .Slide ;_bgb *_gb .SldMaster ;_eagg *_gb .SldLayout ;_dgf float64 ;_bag float64 ;_egcf []_g .Drawable ;_afbb *background ;
_cegcc *_cea .CT_TextParagraphProperties ;_fdae *_cea .CT_TextCharacterProperties ;_beaf *_cea .CT_TextParagraphProperties ;_ccc *_cea .CT_TextCharacterProperties ;_dba *_cea .CT_TextParagraphProperties ;_ceag *_cea .CT_TextCharacterProperties ;_eec []*_cea .CT_TextParagraphProperties ;
_dded []*_cea .CT_TextParagraphProperties ;_bebg []*_cea .CT_TextParagraphProperties ;_dffa *_cea .Theme ;_dgc *_cea .CT_ColorMappingOverride ;};func _eba (_dfd int ,_edcg bool )string {_fcff :=_c .NewBuffer ([]byte {});for _ ,_agd :=range _aedd {for {if _dfd < _agd ._aada {break ;
};_fcff .WriteString (_agd ._ccd );_dfd -=_agd ._aada ;};};_gage :=_fcff .String ();if _edcg {_gage =_dd .ToUpper (_gage );};return _gage ;};func (_afag *textboxContext )alignParagraph (){_gefg :=_afag ._gcaa ;if _gefg ._fbdf ==_cea .ST_TextAlignTypeL {return ;
};_afde :=len (_gefg ._ade )-1;for _cfae ,_eeff :=range _gefg ._ade {_ggeb :=true ;_cfeg :=len (_eeff ._baeb );_agb :=0.0;for _aaed :=len (_eeff ._baeb )-1;_aaed >=0;_aaed --{_bccf :=_eeff ._baeb [_aaed ];if _ggeb &&_bccf ._baf {_cfeg =_aaed ;}else {_ggeb =false ;
for _ ,_aefa :=range _bccf ._gcef {_agb +=_aefa ._fbaa ;};};};_eeff ._baeb =_eeff ._baeb [:_cfeg ];_ggbc :=_eeff ._fca -_eeff ._bbcc -_agb ;switch _gefg ._fbdf {case _cea .ST_TextAlignTypeR :_eeff .moveRight (_ggbc );case _cea .ST_TextAlignTypeCtr :_eeff .moveRight (_ggbc /2);
case _cea .ST_TextAlignTypeJust :if _cfae !=_afde {_gbgf :=[]*word {};for _ ,_afg :=range _eeff ._baeb {if _afg ._baf {_gbgf =append (_gbgf ,_afg );};};_bcb :=_ggbc /float64 (len (_gbgf ));for _ ,_gdccc :=range _gbgf {_gdccc ._bddb +=_bcb ;};var _dcceb *word ;
for _ ,_afgg :=range _eeff ._baeb {if _dcceb !=nil {_afgg ._ecdd =_dcceb ._ecdd +_dcceb ._bddb ;};_dcceb =_afgg ;};};};};};func _edfc (_gedcg ,_ddad *_cea .CT_TextBody )(*_cea .CT_TextBodyProperties ,*_cea .CT_TextListStyle ){if _gedcg ==nil &&_ddad ==nil {return nil ,nil ;
};if _gedcg ==nil {return _ddad .BodyPr ,_ddad .LstStyle ;};if _ddad ==nil {return _gedcg .BodyPr ,_gedcg .LstStyle ;};_fbaaa ,_dccf :=_gedcg .BodyPr ,_gedcg .LstStyle ;_fbcf ,_ceea :=_ddad .BodyPr ,_ddad .LstStyle ;_adde :=_agdb (_fbaaa ,_fbcf );_ebec :=_edda (_dccf ,_ceea );
return _adde ,_ebec ;};func _gfage (_dbd *_gb .CT_CommonSlideData ,_begg _gb .ST_PlaceholderType ,_daaad *uint32 )(*_cea .CT_Transform2D ,*_cea .CT_TextBody ,*bool ,*bool ,*bool ){_fcda :=_daaad ==nil ;if _dbd !=nil &&(_begg !=_gb .ST_PlaceholderTypeUnset ||!_fcda ){if _fge :=_dbd .SpTree ;
_fge !=nil {for _ ,_abge :=range _fge .GroupShapeChoice {if _abge !=nil {if _abge .Sp !=nil {_ggd ,_efg :=_bebaf (_abge .Sp );if _begg ==_ggd {if (_fcda &&_efg ==nil )||(!_fcda &&_efg !=nil &&*_efg ==*_daaad ){var _eeacd *_cea .CT_Transform2D ;if _abge .Sp .SpPr !=nil {_eeacd =_abge .Sp .SpPr .Xfrm ;
};_deb :=_begg ==_gb .ST_PlaceholderTypeTitle ||_begg ==_gb .ST_PlaceholderTypeCtrTitle ;_ecgf :=_begg ==_gb .ST_PlaceholderTypeSubTitle ;_dedd :=!_deb &&_begg !=_gb .ST_PlaceholderTypeUnset ;return _eeacd ,_abge .Sp .TxBody ,&_deb ,&_ecgf ,&_dedd ;};};
};};};};};return nil ,nil ,nil ,nil ,nil ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_eg .Presentation )*_g .Creator {return ConvertToPdfWithOptions (pr ,nil )};var _gcaag =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func (_gfgd *convertContext )getStyleColors (_dcd *_cea .CT_ShapeStyle )(_g .Color ,_g .Color ,_g .Color ){var _bdag ,_fffd ,_cbcf _g .Color ;
if _bbgf :=_dcd .LnRef ;_bbgf !=nil {_fffd =_gfgd .getColorFromMatrixReference (_bbgf );};if _dgcb :=_dcd .FillRef ;_dgcb !=nil {_cbcf =_gfgd .getColorFromMatrixReference (_dgcb );};if _dcb :=_dcd .FontRef ;_dcb !=nil {_bdag =_gfgd .getColorFromFontReference (_dcb );
};return _bdag ,_cbcf ,_fffd ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_ac .FontStyle ;func (_cdab *convertContext )getColorFromSolidFill (_fcaf *_cea .CT_SolidColorFillProperties )(_g .Color ,float64 ){if _fcaf ==nil {return nil ,1;};var _egbe string ;_gafa :=1.0;if _dbcbd :=_fcaf .SrgbClr ;_dbcbd !=nil {_egbe =_dbcbd .ValAttr ;
_gafa =_ac .GetOpacityFromColorTransform (_dbcbd .EG_ColorTransform );}else if _bfeff :=_fcaf .SchemeClr ;_bfeff !=nil {_egbe =_ac .GetColorStringFromDmlColor (_cdab ._cdba .GetColorBySchemeColor (_bfeff .ValAttr ));_egbe =_ac .AdjustColor (_egbe ,_bfeff .EG_ColorTransform );
_gafa =_ac .GetOpacityFromColorTransform (_bfeff .EG_ColorTransform );};if _egbe !=""{_fegc :=_g .ColorRGBFromHex ("\u0023"+_egbe );return _fegc ,_gafa ;};return nil ,1;};func (_fea *convertContext )getColorFromFontReference (_fgfg *_cea .CT_FontReference )_g .Color {var _gdag _g .Color ;
var _bebe string ;if _dafa :=_fgfg .SrgbClr ;_dafa !=nil {_bebe =_dafa .ValAttr ;}else if _cgdeg :=_fgfg .SchemeClr ;_cgdeg !=nil {_bebe =_ac .GetColorStringFromDmlColor (_fea ._cadg .GetColorBySchemeColor (_cgdeg .ValAttr ));_bebe =_ac .AdjustColor (_bebe ,_cgdeg .EG_ColorTransform );
};if _bebe !=""{_gdag =_g .ColorRGBFromHex ("\u0023"+_bebe );};return _gdag ;};func (_dae *textboxContext )addCurrentParagraph (){_dae ._gba =_dae ._gcaa ._ffged +_dae ._gcaa ._gbgc +_dae ._gcaa ._gcaac +_dae ._gcaa ._gfcb ;_dae ._cege =append (_dae ._cege ,_dae ._gcaa );
_dae .alignParagraph ();};func (_gee *convertContext )makePdfDivisionFromTxBody (_ccgd *_cea .CT_TextBody ,_aca *_cea .CT_TableStyleTextStyle )*_g .Division {_egg :=_gee ._eeec .NewDivision ();_fbf :=_gee ._cegcc ;_bcfd :=_cea .ST_TextAnchoringTypeT ;if _bdbd :=_ccgd .BodyPr ;
_bdbd !=nil {if _dac :=_bdbd .AnchorAttr ;_dac !=_cea .ST_TextAnchoringTypeUnset {_bcfd =_bdbd .AnchorAttr ;};};if _eafb :=_ccgd .LstStyle ;_eafb !=nil {var _cde *_cea .CT_TextParagraphProperties ;if _eafb .Lvl1pPr !=nil {_cde =_eafb .Lvl1pPr ;}else {_cde =_gee ._eec [0];
};_fbf =_fbbc (_cde ,_fbbc (_eafb .DefPPr ,_fbf ));};for _ ,_bea :=range _ccgd .P {if _bea !=nil {_ebb :=_gee ._eeec .NewStyledParagraph ();_cabb :=_fbbc (_bea .PPr ,_fbf );_dce :=_ccfa (_bea .EndParaRPr ,_cabb .DefRPr );switch _cabb .AlgnAttr {case _cea .ST_TextAlignTypeR :_ebb .SetTextAlignment (_g .TextAlignmentRight );
case _cea .ST_TextAlignTypeCtr :_ebb .SetTextAlignment (_g .TextAlignmentCenter );case _cea .ST_TextAlignTypeJust :_ebb .SetTextAlignment (_g .TextAlignmentJustify );};if len (_bea .EG_TextRun )==0{_ebb .Append ("\u000a");_egg .Add (_ebb );continue ;};
for _ ,_dgbc :=range _bea .EG_TextRun {if _bcg :=_dgbc .TextRunChoice .Br ;_bcg !=nil {_ebb .Append ("\u000a");}else if _fbge :=_dgbc .TextRunChoice .R ;_fbge !=nil {_dbed :=_ddb (_fbge .RPr ,_aca );_dbed =_ccfa (_dbed ,_dce );var _dced _g .Color ;if _dbed .FillPropertiesChoice .SolidFill !=nil {_dced ,_ =_gee .getColorFromSolidFill (_dbed .FillPropertiesChoice .SolidFill );
}else {_dced =_g .ColorBlack ;};_fae ,_eeg ,_bcd ,_ :=_gee .makeStyleFromRPr (_dbed );_fae .Color =_dced ;if _eeg {_fae .TextRise =0.5;}else if _bcd {_fae .TextRise =-0.5;};_cbb :=_fbge .T ;if _dbed .CapAttr ==_cea .ST_TextCapsTypeAll {for _ ,_acag :=range _cbb {_acag =[]rune (_dd .ToUpper (string (_acag )))[0];
};};_efba :=_ebb .Append (_cbb );_efba .Style =*_fae ;};};_ =_bcfd ;_egg .Add (_ebb );};};return _egg ;};type word struct{_gcef []*symbol ;_ecdd float64 ;_bddb float64 ;_baf bool ;};type textboxContext struct{_gea *convertContext ;_ecbb float64 ;_babg float64 ;
_gbd *_g .Creator ;_gba float64 ;_cege []*paragraph ;_gcaa *paragraph ;_bfeb *line ;_eacff *word ;_fcfc bool ;};func (_eegf *textboxContext )drawParagraphs (){_eegf ._gbd .NewPage ();for _ ,_cdeg :=range _eegf ._cege {for _ ,_gegb :=range _cdeg ._ade {for _ ,_fbdfg :=range _gegb ._baeb {for _ ,_feeg :=range _fbdfg ._gcef {_cfbg :=_eegf ._gbd .NewStyledParagraph ();
if _feeg ._ded {_feeg ._daddf =0;}else if _feeg ._cedb {_feeg ._daddf =1.2*_gegb ._dcab -_feeg ._abb ;};_bbeaa :=_fbdfg ._ecdd +_feeg ._cgdc ;_ebc :=_cdeg ._ffged +_gegb ._fbgg +_feeg ._daddf ;_cfbg .SetPos (_bbeaa ,_ebc );_gcga :=_cfbg .Append (_feeg ._dfee );
if _feeg ._ggbg !=nil {_gcga .Style =*_feeg ._ggbg ;};_eegf ._gbd .Draw (_cfbg );if _feeg ._gef {_abea :=_ebc +_feeg ._abb +2;_ac .DrawLine (_eegf ._gbd ,_bbeaa ,_abea ,_bbeaa +_feeg ._fbaa ,_abea ,1,_feeg ._ggbg .Color );};};};};};};func _acce (_cffe *bool )bool {return _cffe !=nil &&*_cffe };
func (_cgeg *textboxContext )alignVertically (_eeac _cea .ST_TextAnchoringType ){_cgeg .alignParagraphsVertically (_eeac );_cgeg .alignSymbolsVertically ();};func _cgba (_gdeg float64 )float64 {return _gdeg *_f .Inch };func (_ffge *convertContext )getShapes (_efe *_gb .CT_Shape ,_cbg bool ,_dcad bool )[]_g .Drawable {_ccg :=[]_g .Drawable {};
_bbfg :=_efe .SpPr ;if _bbfg ==nil {return _ccg ;};var _bcf bool ;if _ddg :=_efe .UseBgFillAttr ;_ddg !=nil {_bcf =*_ddg ;};_bed ,_cdd ,_ecf ,_cec ,_cgg ,_fac ,_gff :=_ffge .getShapesFromSpPr (_bbfg ,_efe .Style ,_bcf ,0.0,0.0);if !_dcad {_ccg =append (_ccg ,_bed ...);
};if _eefd :=_efe .TxBody ;_eefd !=nil &&!_cbg {_abe ,_bbc ,_bfb ,_aae ,_bae ,_ebe :=_ffge .getPhData (_efe );if _dcad &&!(_aae ||_bae ){return _ccg ;};if _abe !=nil &&!_gff {_cdd ,_ecf ,_cec ,_cgg =_ac .GetDataFromXfrm (_abe );};_facg ,_eab :=_ffge .makePdfBlockFromTxBody (_eefd ,_bbc ,_bfb ,_cec ,_cgg ,_fac ,_aae ,_ebe );
if _eab !=nil {_ce .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_eab );
}else if _facg !=nil {_facg .SetPos (_cdd ,_ecf );_ccg =append (_ccg ,_facg );};};return _ccg ;};func (_gbcc *convertContext )getShapeFromBlipFill (_dbgec *_cea .CT_BlipFillProperties ,_gcefd ,_gdagc ,_ceagc ,_acfd float64 ,_gbac bool )_g .Drawable {_bec ,_fcfce ,_ebee :=_gbcc .makePdfImageFromBlipFill (_dbgec ,_gbac );
if _ebee !=nil {_ce .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_ebee );
return nil ;};if _bec ==nil {return nil ;};if _eeca :=_dbgec .FillModePropertiesChoice .Tile ;_eeca !=nil {_bec =_gbcc .tileImage (_bec ,_dbgec .FillModePropertiesChoice .Tile ,_ceagc ,_acfd );};if _abbg :=_dbgec .FillModePropertiesChoice .Stretch ;_abbg !=nil {_bec ,_gcefd ,_gdagc =_gbcc .stretchImage (_bec ,_dbgec .FillModePropertiesChoice .Stretch ,_gcefd ,_gdagc ,_ceagc ,_acfd );
};if _bec ==nil {return nil ;};if len (_fcfce )==0{_bec .SetPos (_gcefd ,_gdagc );return _bec ;};_bec =_gbcc .applyBlipEffectsOnImg (_bec ,_gcefd ,_gdagc ,_fcfce );_bec .SetPos (_gcefd ,_gdagc );return _bec ;};

// ConvertToPdfWithOptions convert a presentation to PDF with given options.
func ConvertToPdfWithOptions (pr *_eg .Presentation ,opts *Options )*_g .Creator {_dg :=pr .X ().SldSz ;_ge :=_f .FromEMU (int64 (_dg .CxAttr ));_bfc :=_f .FromEMU (int64 (_dg .CyAttr ));_adg :=_g .PageSize {_ge ,_bfc };if (_adg ==_g .PageSize {}){_adg =_ac .GetDefaultPageSize ();
if opts !=nil &&opts .DefaultPageSize !=_ac .DefaultPageSize {_adg =_ac .GetPageDimensions (opts .DefaultPageSize );};};_add :=_g .New ();_add .SetPageSize (_adg );var _da *_cea .Theme ;if len (pr .Themes ())> 0{_da =pr .Themes ()[0];};for _ ,_dad :=range pr .Slides (){if _dad .X ()==nil {continue ;
};_fg :=&convertContext {_eeec :_add ,_cdba :&_dad ,_eagg :_dad .GetSlideLayout (),_bgb :pr .SlideMasters ()[0].X (),_cadg :pr ,_dffa :_da ,_dgc :_dad .X ().ClrMapOvr ,_dgf :_adg [1],_bag :_adg [0]};_fg .extractDefaultProperties ();_fg .makeSlide ();_fg .drawSlide ();
};return _add ;};

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _ac .PageSize ;};func (_bedf *textboxContext )addCurrentWordToParagraph (){if _bedf ._fcfc &&_bedf ._bfeb ._afdc +_bedf ._eacff ._bddb > _bedf ._bfeb ._fca {_bedf .newLine ();};if !_bedf ._eacff ._baf ||len (_bedf ._bfeb ._baeb )> 0{_bedf ._eacff ._ecdd =_bedf ._bfeb ._afdc ;
_bedf ._bfeb ._baeb =append (_bedf ._bfeb ._baeb ,_bedf ._eacff );_bedf ._bfeb ._afdc +=_bedf ._eacff ._bddb ;for _ ,_fec :=range _bedf ._eacff ._gcef {_bedf .adjustHeights (_fec ._ggcg );};};};func _fbbc (_edef ,_beba *_cea .CT_TextParagraphProperties )*_cea .CT_TextParagraphProperties {_ffbf :=_cea .NewCT_TextParagraphProperties ();
if _edef !=nil {*_ffbf =*_edef ;};if _beba ==nil {return _ffbf ;};if _ffbf .MarLAttr ==nil {_ffbf .MarLAttr =_beba .MarLAttr ;};if _ffbf .MarRAttr ==nil {_ffbf .MarRAttr =_beba .MarRAttr ;};if _ffbf .LvlAttr ==nil {_ffbf .LvlAttr =_beba .LvlAttr ;};if _ffbf .IndentAttr ==nil {_ffbf .IndentAttr =_beba .IndentAttr ;
};if _ffbf .AlgnAttr ==_cea .ST_TextAlignTypeUnset {_ffbf .AlgnAttr =_beba .AlgnAttr ;};if _ffbf .DefTabSzAttr ==nil {_ffbf .DefTabSzAttr =_beba .DefTabSzAttr ;};if _ffbf .RtlAttr ==nil {_ffbf .RtlAttr =_beba .RtlAttr ;};if _ffbf .EaLnBrkAttr ==nil {_ffbf .EaLnBrkAttr =_beba .EaLnBrkAttr ;
};if _ffbf .FontAlgnAttr ==_cea .ST_TextFontAlignTypeUnset {_ffbf .FontAlgnAttr =_beba .FontAlgnAttr ;};if _ffbf .LatinLnBrkAttr ==nil {_ffbf .LatinLnBrkAttr =_beba .LatinLnBrkAttr ;};if _ffbf .HangingPunctAttr ==nil {_ffbf .HangingPunctAttr =_beba .HangingPunctAttr ;
};if _ffbf .LnSpc ==nil {_ffbf .LnSpc =_beba .LnSpc ;};if _ffbf .SpcBef ==nil {_ffbf .SpcBef =_beba .SpcBef ;};if _ffbf .SpcAft ==nil {_ffbf .SpcAft =_beba .SpcAft ;};if _ffbf .TextBulletColorChoice .BuClrTx ==nil {_ffbf .TextBulletColorChoice .BuClrTx =_beba .TextBulletColorChoice .BuClrTx ;
};if _ffbf .TextBulletColorChoice .BuClr ==nil {_ffbf .TextBulletColorChoice .BuClr =_beba .TextBulletColorChoice .BuClr ;};if _ffbf .TextBulletSizeChoice .BuSzTx ==nil {_ffbf .TextBulletSizeChoice .BuSzTx =_beba .TextBulletSizeChoice .BuSzTx ;};if _ffbf .TextBulletSizeChoice .BuSzPct ==nil {_ffbf .TextBulletSizeChoice .BuSzPct =_beba .TextBulletSizeChoice .BuSzPct ;
};if _ffbf .TextBulletSizeChoice .BuSzPts ==nil {_ffbf .TextBulletSizeChoice .BuSzPts =_beba .TextBulletSizeChoice .BuSzPts ;};if _ffbf .TextBulletTypefaceChoice .BuFontTx ==nil {_ffbf .TextBulletTypefaceChoice .BuFontTx =_beba .TextBulletTypefaceChoice .BuFontTx ;
};if _ffbf .TextBulletTypefaceChoice .BuFont ==nil {_ffbf .TextBulletTypefaceChoice .BuFont =_beba .TextBulletTypefaceChoice .BuFont ;};if _ffbf .TextBulletChoice .BuNone ==nil {_ffbf .TextBulletChoice .BuNone =_beba .TextBulletChoice .BuNone ;};if _ffbf .TextBulletChoice .BuAutoNum ==nil {_ffbf .TextBulletChoice .BuAutoNum =_beba .TextBulletChoice .BuAutoNum ;
};if _ffbf .TextBulletChoice .BuChar ==nil {_ffbf .TextBulletChoice .BuChar =_beba .TextBulletChoice .BuChar ;};if _ffbf .TextBulletChoice .BuBlip ==nil {_ffbf .TextBulletChoice .BuBlip =_beba .TextBulletChoice .BuBlip ;};if _ffbf .TabLst ==nil {_ffbf .TabLst =_beba .TabLst ;
};if _ffbf .ExtLst ==nil {_ffbf .ExtLst =_beba .ExtLst ;};_ffbf .DefRPr =_ccfa (_ffbf .DefRPr ,_beba .DefRPr );return _ffbf ;};func _agce (_bce *_cea .CT_TableCellProperties ,_cbgc *_cea .CT_TableStyleCellStyle ,_gecc ,_aeec ,_gdac ,_cdbag bool )*_cea .CT_TableCellProperties {_gbbe :=_cea .NewCT_TableCellProperties ();
if _bce !=nil {*_gbbe =*_bce ;};if _cbgc ==nil {return _gbbe ;};if _cggc :=_cbgc .ThemeableFillStyleChoice .FillRef ;_cggc !=nil {_acfa :=_cea .NewCT_SolidColorFillProperties ();_acfa .ScrgbClr =_cggc .ScrgbClr ;_acfa .SrgbClr =_cggc .SrgbClr ;_acfa .HslClr =_cggc .HslClr ;
_acfa .SysClr =_cggc .SysClr ;_acfa .SchemeClr =_cggc .SchemeClr ;_acfa .PrstClr =_cggc .PrstClr ;_gbbe .FillPropertiesChoice .SolidFill =_acfa ;};if _gbbe .FillPropertiesChoice .NoFill ==nil &&_gbbe .FillPropertiesChoice .SolidFill ==nil {if _fgcgd :=_cbgc .ThemeableFillStyleChoice .Fill ;
_fgcgd !=nil {if _gbbe .FillPropertiesChoice .NoFill ==nil {_gbbe .FillPropertiesChoice .NoFill =_fgcgd .FillPropertiesChoice .NoFill ;};if _gbbe .FillPropertiesChoice .SolidFill ==nil {_gbbe .FillPropertiesChoice .SolidFill =_fgcgd .FillPropertiesChoice .SolidFill ;
};};};if _fed :=_cbgc .TcBdr ;_fed !=nil {if _gbbe .LnL ==nil {var _gaef *_cea .CT_ThemeableLineStyle ;if _gdac {_gaef =_fed .Left ;}else {_gaef =_fed .InsideV ;};if _gaef !=nil {_gbbe .LnL =_gaef .ThemeableLineStyleChoice .Ln ;};};if _gbbe .LnR ==nil {var _fffac *_cea .CT_ThemeableLineStyle ;
if _cdbag {_fffac =_fed .Right ;}else {_fffac =_fed .InsideV ;};if _fffac !=nil {_gbbe .LnR =_fffac .ThemeableLineStyleChoice .Ln ;};};if _gbbe .LnT ==nil {var _faad *_cea .CT_ThemeableLineStyle ;if _gecc {_faad =_fed .Top ;}else {_faad =_fed .InsideH ;
};if _faad !=nil {_gbbe .LnT =_faad .ThemeableLineStyleChoice .Ln ;};};if _gbbe .LnB ==nil {var _abcd *_cea .CT_ThemeableLineStyle ;if _aeec {_abcd =_fed .Bottom ;}else {_abcd =_fed .InsideH ;};if _abcd !=nil {_gbbe .LnB =_abcd .ThemeableLineStyleChoice .Ln ;
};};};return _gbbe ;};func (_ab *convertContext )makePdfBlockFromChart (_ae *_ecb .Chart ,_bf ,_gc float64 )(*_g .Block ,error ){_gg :=_ae .CT_RelId .IdAttr ;_cb :=_ab ._cdba .GetChartSpaceByRelId (_gg );if _cb ==nil {return nil ,_b .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");
};var _aag *_cea .Theme ;_df :=_ab ._cadg .Themes ();if len (_df )> 0{_aag =_df [0];};return _ac .MakeBlockFromChartSpace (_cb ,_bf ,_gc ,_aag );};func (_aeac *convertContext )applyBlipEffectsOnImg (_ebcg *_g .Image ,_ggff ,_afee float64 ,_eagc []*_cea .CT_BlipChoice )*_g .Image {if len (_eagc )==0{return _ebcg ;
};_ebcg .SetPos (_ggff ,_afee );_fbdd ,_fccbc :=_aeac .renderPageWithDrawableToGoImage (_ebcg );if _fccbc !=nil {_ce .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_fccbc );
return _ebcg ;};_gdfe ,_fccbc :=_aeac .renderCurrentStateToGoImage ();if _fccbc !=nil {_ce .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_fccbc );
return _ebcg ;};_aeg :=_fbdd .Bounds ();_gfgc :=_aa .NewRGBA (_aeg );_eaab ,_eeeec :=_ebcg .Width (),_ebcg .Height ();for _ ,_ggfc :=range _eagc {if _deed :=_ggfc .AlphaModFix ;_deed ==nil {continue ;};if _dbgf :=_ggfc .AlphaModFix .AmtAttr ;_dbgf !=nil {if _cgee :=_dbgf .ST_PositivePercentageDecimal ;
_cgee !=nil {_eacc :=uint8 (255*(*_cgee )/100000);_bgcd :=_aa .NewUniform (_e .Alpha {_eacc });_a .Draw (_gfgc ,_aeg ,_gdfe ,_aa .Point {0,0},_a .Src );_a .DrawMask (_gfgc ,_aeg ,_fbdd ,_aa .Point {0,0},_bgcd ,_aa .Point {0,0},_a .Over );};};};_cag :=_aa .Rect (int (_ggff ),int (_afee ),int (_ggff +_eaab )+1,int (_afee +_eeeec )+1);
_bdec :=_ac .CropImageByRect (_gfgc ,_cag );_agaa ,_fccbc :=_aeac ._eeec .NewImageFromGoImage (_bdec );if _fccbc !=nil {_ce .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_fccbc );
return _ebcg ;};return _agaa ;};func (_abaf *convertContext )getBorderStyle (_cda *_cea .CT_LineProperties )(_g .CellBorderStyle ,*_g .Color ,float64 ){if _cda ==nil ||_cda .LineFillPropertiesChoice .NoFill !=nil {return _g .CellBorderStyleNone ,nil ,0;
};var _deg _g .Color ;if _gec :=_cda .LineFillPropertiesChoice .SolidFill ;_gec !=nil {_deg ,_ =_abaf .getColorFromSolidFill (_gec );};_gecd :=0.0;if _cgde :=_cda .WAttr ;_cgde !=nil {_gecd =_f .FromEMU (int64 (*_cgde ));};return _g .CellBorderStyleSingle ,&_deg ,_gecd ;
};func (_cefc *textboxContext )addTextRun (_ada *_cea .EG_TextRun ,_egda *_cea .CT_TextCharacterProperties ,_dfbc _g .Color ,_ceb *prefixData ){if _fgbc :=_ada .TextRunChoice .Br ;_fgbc !=nil {_cefc .addCurrentWordToParagraph ();_cefc .newLine ();_cefc .newWord ();
}else if _fafd :=_ada .TextRunChoice .R ;_fafd !=nil {var _ffaa _g .Color ;if _fafd .RPr !=nil &&_fafd .RPr .FillPropertiesChoice .SolidFill !=nil {_ffaa ,_ =_cefc ._gea .getColorFromSolidFill (_fafd .RPr .FillPropertiesChoice .SolidFill );}else if _dfbc !=nil {_ffaa =_dfbc ;
}else if _egda .FillPropertiesChoice .SolidFill !=nil {_ffaa ,_ =_cefc ._gea .getColorFromSolidFill (_egda .FillPropertiesChoice .SolidFill );}else {_ffaa =_g .ColorBlack ;};_fccb :=_ccfa (_fafd .RPr ,_egda );_agef ,_dbac ,_gffb ,_geeb :=_cefc ._gea .makeStyleFromRPr (_fccb );
_agef .Color =_ffaa ;if _ceb !=nil {_cefc .addPrefix (_ceb ,_agef );};_eabef :=_gdf (_fafd .T );for _ ,_febe :=range _eabef {_febe ._ggbg =_agef ;_febe ._ded =_dbac ;_febe ._cedb =_gffb ;_febe ._gef =_geeb ;if _fccb .CapAttr ==_cea .ST_TextCapsTypeAll {_febe ._dfee =_dd .ToUpper (_febe ._dfee );
};_cefc .addTextSymbol (_febe );};};};type prefixData struct{_gfdd string ;_egga bool ;_aebb float64 ;_gbdd float64 ;};func (_gfb *convertContext )drawSlide (){_gfb ._eeec .NewPage ();for _ ,_aefd :=range _gfb ._egcf {if _aefd !=nil {_gfb ._eeec .MoveTo (0,0);
_gfb ._eeec .Draw (_aefd );};};};func (_eaeg *textboxContext )alignSymbolsVertically (){for _ ,_ddgf :=range _eaeg ._cege {for _ ,_affd :=range _ddgf ._ade {_bagd :=0.0;for _ ,_edbg :=range _affd ._baeb {for _ ,_gdef :=range _edbg ._gcef {if _gdef ._ggcg > _bagd {_bagd =_gdef ._ggcg ;
};};};for _ ,_beeg :=range _affd ._baeb {for _ ,_fcca :=range _beeg ._gcef {if _fcca ._abb < _bagd {_fcca ._daddf =_bagd -_fcca ._abb ;};};};};};};func _gdfc (_eege ,_dggc *_cea .CT_TablePartStyle )*_cea .CT_TablePartStyle {_ecee :=_cea .NewCT_TablePartStyle ();
if _eege !=nil {*_ecee =*_eege ;};if _dggc ==nil {return _ecee ;};if _ecee .TcTxStyle ==nil {_ecee .TcTxStyle =_dggc .TcTxStyle ;}else {_ecee .TcTxStyle =_fbgff (_ecee .TcTxStyle ,_dggc .TcTxStyle );};if _ecee .TcStyle ==nil {_ecee .TcStyle =_dggc .TcStyle ;
}else {_ecee .TcStyle =_baef (_ecee .TcStyle ,_dggc .TcStyle );};return _ecee ;};func (_cebg *textboxContext )alignParagraphsVertically (_aecb _cea .ST_TextAnchoringType ){if _aecb ==_cea .ST_TextAnchoringTypeT {return ;};_fddc :=0.0;for _ ,_ggef :=range _cebg ._cege {_fddc +=_ggef ._gbgc +_ggef ._gcaac +_ggef ._gfcb ;
};var _adcf float64 ;switch _aecb {case _cea .ST_TextAnchoringTypeCtr :_adcf =(_cebg ._babg -_fddc )/2;case _cea .ST_TextAnchoringTypeB :_adcf =_cebg ._babg -_fddc ;};for _ ,_aecbf :=range _cebg ._cege {_aecbf ._ffged +=_adcf ;};};func (_gggg *convertContext )makeSlide (){_cab :=_gggg ._cdba .GetSlideLayout ().CSld ;
_gggg .addShapes (_cab ,true );_cab =_gggg ._cdba .X ().CSld ;_gggg .addShapes (_cab ,false );};type symbolStyle struct{_bbg *string ;_baca *float64 ;_gcdg *string ;_cbcba *bool ;_affa *bool ;_ggcd *bool ;_eeee *bool ;_cbacd *bool ;};func (_beae *textboxContext )newLine (){if _beae ._gcaa ==nil {_beae .newParagraph ();
};_daac :=_beae ._gcaa ._gcaac +_beae ._gcaa ._gbgc ;_abbb :=&line {};_abbb ._bbcc =_beae ._gcaa ._cef ;if len (_beae ._gcaa ._ade )==0{_abbb ._bbcc +=_beae ._gcaa ._cceb ;};_abbb ._fca =_beae ._gcaa ._dbee ;_abbb ._afdc =_abbb ._bbcc ;_abbb ._fbgg =_daac ;
_beae ._gcaa ._ade =append (_beae ._gcaa ._ade ,_abbb );_beae ._bfeb =_abbb ;};func _eafg (_cbd *_cea .CT_AdjPoint2D )(float64 ,float64 ){var _eafbg ,_accc float64 ;_ffb ,_baeca :=_cbd .XAttr ,_cbd .YAttr ;if _egfb :=_ffb .ST_Coordinate ;_egfb !=nil {_eafbg =_f .FromEMU (_ac .FromSTCoordinate (*_egfb ));
};if _eeda :=_baeca .ST_Coordinate ;_eeda !=nil {_accc =_f .FromEMU (_ac .FromSTCoordinate (*_eeda ));};return _eafbg ,_accc ;};type paragraph struct{_gagg float64 ;_gbgc float64 ;_gfcb float64 ;_cceb float64 ;_cef float64 ;_dbee float64 ;_ffged float64 ;
_gcaac float64 ;_fbdf _cea .ST_TextAlignType ;_fccc float64 ;_ffa bool ;_ade []*line ;};type background struct{_dgfc _g .Color ;_dffd float64 ;_dgae *_cea .CT_BlipFillProperties ;};func (_bac *convertContext )makePdfBlockFromTable (_bee *_cea .Tbl )*_g .Table {_dbge :=_bee .TblGrid ;
if _dbge ==nil {return nil ;};_agf :=len (_dbge .GridCol );if _agf ==0{return nil ;};_adb :=[]float64 {};_effb :=0.0;for _ ,_fbec :=range _dbge .GridCol {_gcdd :=_f .FromEMU (_ac .FromSTCoordinate (_fbec .WAttr ));_adb =append (_adb ,_gcdd );_effb +=_gcdd ;
};_fda :=[]float64 {};for _cad :=0;_cad < _agf ;_cad ++{_fda =append (_fda ,_adb [_cad ]/_effb );};_bde :=_bac ._eeec .NewTable (_agf );_bde .SetColumnWidths (_fda ...);_efd :=_bee .TblPr ;var _bbbb *_cea .CT_TableStyle ;if _edc :=_efd .TablePropertiesChoice ;
_edc !=nil {if _edc .TableStyle !=nil {_bbbb =_edc .TableStyle ;}else if _edc .TableStyleId !=nil {_bbbb =_bac ._cadg .GetTableStyleById (*_edc .TableStyleId );};};_bef :=_cea .NewCT_TablePartStyle ();_bef .TcStyle =_cea .NewCT_TableStyleCellStyle ();_bef .TcTxStyle =_cea .NewCT_TableStyleTextStyle ();
if _bbbb !=nil {if _bbbb .WholeTbl !=nil {*_bef =*_bbbb .WholeTbl ;};if _bbbb .TblBg !=nil {if _bef .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_bef .TcStyle .ThemeableFillStyleChoice .Fill =_bbbb .TblBg .ThemeableFillStyleChoice .Fill ;};};};if _bef .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_bef .TcStyle .ThemeableFillStyleChoice .Fill =_cea .NewCT_FillProperties ();
_bef .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .NoFill =_efd .FillPropertiesChoice .NoFill ;_bef .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .SolidFill =_efd .FillPropertiesChoice .SolidFill ;};_ceed :=len (_bee .Tr );
_fag :=_bee .TblPr .BandRowAttr !=nil &&*_bee .TblPr .BandRowAttr ;_fdd :=_bee .TblPr .FirstRowAttr !=nil &&*_bee .TblPr .FirstRowAttr ;_fgb :=_bee .TblPr .LastRowAttr !=nil &&*_bee .TblPr .LastRowAttr ;_egcc :=_bee .TblPr .BandColAttr !=nil &&*_bee .TblPr .BandColAttr ;
_cegc :=_bee .TblPr .FirstColAttr !=nil &&*_bee .TblPr .FirstColAttr ;_eddd :=_bee .TblPr .LastColAttr !=nil &&*_bee .TblPr .LastColAttr ;for _bfgc ,_bcfc :=range _bee .Tr {_cadd :=_bfgc ==0;_ede :=_bfgc ==_ceed -1;_gbe :=_bfgc %2==0;_ecdbd :=len (_bcfc .Tc );
var _addc *_cea .CT_TablePartStyle ;if _bbbb !=nil {if _cadd &&_fdd {_addc =_bbbb .FirstRow ;}else if _ede &&_fgb {_addc =_bbbb .LastRow ;}else if _gbe &&_fag {_addc =_bbbb .Band2H ;}else if _fag {_addc =_bbbb .Band1H ;};};var _bcc float64 ;for _bedc ,_cdb :=range _bcfc .Tc {_gddf :=_bedc ==0;
_effbf :=_bedc ==_ecdbd -1;_agag :=_bedc %2==0;var _gcf *_cea .CT_TablePartStyle ;if _bbbb !=nil {if _gddf &&_cegc {_gcf =_bbbb .FirstCol ;}else if _effbf &&_eddd {_gcf =_bbbb .LastCol ;}else if _agag &&_egcc {_gcf =_bbbb .Band2V ;}else if _egcc {_gcf =_bbbb .Band1V ;
};};_fbb :=_gdfc (_gdfc (_gcf ,_addc ),_bef );_adc :=_bac .addCellToTable (_bde ,_cdb ,_fbb ,_cadd ,_ede ,_gddf ,_effbf );if _adc > _bcc {_bcc =_adc ;};};_agc :=_f .FromEMU (_ac .FromSTCoordinate (_bcfc .HAttr ));if _agc < _bcc {_agc =_bcc ;};if _agc < _gfcf (4){_agc =_gfcf (4);
};_bde .SetRowHeight (_bde .CurRow (),_agc );};return _bde ;};func (_cce *convertContext )stretchImage (_gfbb *_g .Image ,_fbe *_cea .CT_StretchInfoProperties ,_acf ,_dadd ,_gga ,_gcg float64 )(*_g .Image ,float64 ,float64 ){_dff :=_fbe .FillRect ;if _dff ==nil {_edd :=_gfbb .Width ()/_gfbb .Height ();
_bdd :=_gga /_gcg ;var _efb ,_eaa float64 ;if _edd > _bdd {_eaa =_gcg ;_efb =_gcg *_edd ;}else {_efb =_gga ;_eaa =_gga /_edd ;};_gfbb .Scale (_efb /_gfbb .Width (),_eaa /_gfbb .Height ());return _gfbb ,_acf ,_dadd ;};var _fff ,_aaf ,_eea ,_gde float64 ;
if _cbac :=_dff .LAttr ;_cbac !=nil {_eea =_ac .FromSTPercentage (_cbac );};if _gfbd :=_dff .TAttr ;_gfbd !=nil {_fff =_ac .FromSTPercentage (_gfbd );};if _dee :=_dff .RAttr ;_dee !=nil {_gde =_ac .FromSTPercentage (_dee );};if _bfcc :=_dff .BAttr ;_bfcc !=nil {_aaf =_ac .FromSTPercentage (_bfcc );
};_faa :=_gga *(1-_eea -_gde );_bfg :=_gcg *(1-_fff -_aaf );_gfbb .Scale (_faa /_gfbb .Width (),_bfg /_gfbb .Height ());return _gfbb ,_acf +_eea *_gga ,_dadd +_fff *_gcg ;};func (_geg *convertContext )makePdfBlockFromTxBody (_cgb *_cea .CT_TextBody ,_bdcc *_cea .CT_TextBodyProperties ,_gac *_cea .CT_TextListStyle ,_ced ,_ccf float64 ,_dec _g .Color ,_gfa ,_gaba bool )(*_g .Block ,error ){var _eag *_cea .CT_TextParagraphProperties ;
if _dcae :=_cgb .LstStyle ;_dcae !=nil {var _aagd *_cea .CT_TextParagraphProperties ;if _dcae .Lvl1pPr !=nil {_aagd =_dcae .Lvl1pPr ;};_eag =_fbbc (_aagd ,_dcae .DefPPr );};var _decb *_cea .CT_TextParagraphProperties ;if _eag !=nil {if _gfa {_decb =_geg ._dded [0];
}else if _gaba {_decb =_geg ._bebg [0];}else {_decb =_geg ._eec [0];};if _gac !=nil {_decb =_fbbc (_fbbc (_gac .Lvl1pPr ,_gac .DefPPr ),_decb );};_decb =_fbbc (_eag ,_decb );}else {if _gfa {_decb =_geg ._beaf ;}else if _gaba {_decb =_geg ._dba ;}else {_decb =_geg ._cegcc ;
};};_cbcd ,_bgc :=_gfcf (2.5),_gfcf (2.5);_dcac ,_afd :=_gfcf (1.3),_gfcf (1.3);_dcg :=true ;_acff :=_cea .ST_TextAnchoringTypeT ;if _bdcc !=nil {if _dace :=_bdcc .AnchorAttr ;_dace !=_cea .ST_TextAnchoringTypeUnset {_acff =_dace ;};};if _faea :=_cgb .BodyPr ;
_faea !=nil {if _beg :=_faea .LInsAttr ;_beg !=nil {_cbcd =_f .FromEMU (_ac .FromSTCoordinate32 (*_beg ));};if _aedf :=_faea .TInsAttr ;_aedf !=nil {_dcac =_f .FromEMU (_ac .FromSTCoordinate32 (*_aedf ));};if _cdg :=_faea .RInsAttr ;_cdg !=nil {_bgc =_f .FromEMU (_ac .FromSTCoordinate32 (*_cdg ));
};if _dbceb :=_faea .BInsAttr ;_dbceb !=nil {_afd =_f .FromEMU (_ac .FromSTCoordinate32 (*_dbceb ));};_dcg =_faea .WrapAttr !=_cea .ST_TextWrappingTypeNone ;if _cff :=_faea .AnchorAttr ;_cff !=_cea .ST_TextAnchoringTypeUnset {_acff =_faea .AnchorAttr ;
};};_ecfe :=_ac .MakeTempCreator (_ced ,_ccf );_ecfe .SetPageMargins (_cbcd ,_bgc ,_dcac ,_afd );_ffd :=&textboxContext {_gea :_geg ,_fcfc :_dcg ,_ecbb :_ced -_cbcd -_bgc ,_babg :_ccf -_dcac -_afd ,_gbd :_ecfe ,_cege :[]*paragraph {}};_cbcb :=1;for _ ,_gfee :=range _cgb .P {if _gfee !=nil {_fcc :=_gfee .PPr ;
var _ffeg *prefixData ;if _fcc !=nil &&_fcc .TextBulletChoice .BuNone ==nil {var _dfgg string ;var _gedc bool ;if _bab :=_fcc .TextBulletChoice .BuAutoNum ;_bab !=nil {var _gdc string ;if _daf :=_bab .StartAtAttr ;_daf !=nil {_cbcb =int (*_daf );};var _bad string ;
switch _bab .TypeAttr {case _cea .ST_TextAutonumberSchemeAlphaUcParenBoth ,_cea .ST_TextAutonumberSchemeAlphaUcParenR ,_cea .ST_TextAutonumberSchemeAlphaUcPeriod :_bad =_gedf (_cbcb ,true );case _cea .ST_TextAutonumberSchemeAlphaLcParenBoth ,_cea .ST_TextAutonumberSchemeAlphaLcParenR ,_cea .ST_TextAutonumberSchemeAlphaLcPeriod :_bad =_gedf (_cbcb ,false );
case _cea .ST_TextAutonumberSchemeRomanUcParenBoth ,_cea .ST_TextAutonumberSchemeRomanUcParenR ,_cea .ST_TextAutonumberSchemeRomanUcPeriod :_bad =_eba (_cbcb ,true );case _cea .ST_TextAutonumberSchemeRomanLcParenBoth ,_cea .ST_TextAutonumberSchemeRomanLcParenR ,_cea .ST_TextAutonumberSchemeRomanLcPeriod :_bad =_eba (_cbcb ,false );
default:_bad =_eb .Itoa (_cbcb );};switch _bab .TypeAttr {case _cea .ST_TextAutonumberSchemeAlphaLcPeriod ,_cea .ST_TextAutonumberSchemeAlphaUcPeriod ,_cea .ST_TextAutonumberSchemeArabicPeriod ,_cea .ST_TextAutonumberSchemeRomanLcPeriod ,_cea .ST_TextAutonumberSchemeRomanUcPeriod ,_cea .ST_TextAutonumberSchemeArabicDbPeriod ,_cea .ST_TextAutonumberSchemeEa1ChsPeriod ,_cea .ST_TextAutonumberSchemeEa1ChtPeriod ,_cea .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_cea .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_cea .ST_TextAutonumberSchemeThaiAlphaPeriod ,_cea .ST_TextAutonumberSchemeThaiNumPeriod ,_cea .ST_TextAutonumberSchemeHindiAlphaPeriod ,_cea .ST_TextAutonumberSchemeHindiNumPeriod ,_cea .ST_TextAutonumberSchemeHindiAlpha1Period :_gdc ="\u002e";
case _cea .ST_TextAutonumberSchemeAlphaLcParenR ,_cea .ST_TextAutonumberSchemeAlphaUcParenR ,_cea .ST_TextAutonumberSchemeArabicParenR ,_cea .ST_TextAutonumberSchemeRomanLcParenR ,_cea .ST_TextAutonumberSchemeRomanUcParenR ,_cea .ST_TextAutonumberSchemeThaiAlphaParenR ,_cea .ST_TextAutonumberSchemeThaiNumParenR ,_cea .ST_TextAutonumberSchemeHindiNumParenR :_gdc ="\u0029";
};_dfgg =_bad +_gdc ;_cbcb ++;}else if _cfec :=_fcc .TextBulletChoice .BuChar ;_cfec !=nil {_cgf :=_cfec .CharAttr ;if _gbb ,_gca :=_gcaag [_cgf ];_gca {_cgf =string (rune (_gbb ));}else {_cgf ="\u2022";};_dfgg =_cgf ;_gedc =true ;};if _dfgg !=""{var _cddb ,_cbcg float64 ;
if _fcc .MarLAttr !=nil {_cddb =_f .FromEMU (int64 (*_fcc .MarLAttr ));};if _fcc .IndentAttr !=nil {_cbcg =_f .FromEMU (int64 (*_fcc .IndentAttr ));};_ffeg =&prefixData {_gfdd :_dfgg ,_egga :_gedc ,_aebb :_cddb ,_gbdd :_cbcg };};};_fcc =_fbbc (_fcc ,_decb );
_bbce :=_ccfa (_gfee .EndParaRPr ,_fcc .DefRPr );_ffd .newParagraph ();_ffd .assignPropsToCurrentParagraph (_fcc );_ffd .newLine ();_ffd .newWord ();for _acac ,_ecdb :=range _gfee .EG_TextRun {_ffd .addTextRun (_ecdb ,_bbce ,_dec ,_ffeg );if _acac > 0{_ffeg =nil ;
};};_ffd .addCurrentWordToParagraph ();};_ffd .addCurrentParagraph ();};_ffd .alignVertically (_acff );_ffd .drawParagraphs ();return _ac .MakeBlockFromCreator (_ecfe );};func (_cbba *convertContext )makePdfImageFromBlipFill (_caf *_cea .CT_BlipFillProperties ,_ggbd bool )(*_g .Image ,[]*_cea .CT_BlipChoice ,error ){if _cdfe :=_caf .Blip ;
_cdfe !=nil {if _aaea :=_cdfe .EmbedAttr ;_aaea !=nil {var _dcfc _ee .ImageRef ;var _aaec bool ;if _ggbd {_dcfc ,_aaec =_cbba ._cdba .GetLayoutImageByRelID (*_aaea );}else {_dcfc ,_aaec =_cbba ._cdba .GetImageByRelID (*_aaea );};if _aaec {_gbfg ,_gegf :=_ad .Open (_dcfc .Path ());
if _gegf !=nil {_ce .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_gegf );return nil ,nil ,_gegf ;};defer _gbfg .Close ();_fddcf ,_ ,_gegf :=_aa .Decode (_gbfg );if _gegf !=nil {_ce .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_gegf );
return nil ,nil ,_gegf ;};if _fdeb :=_caf .SrcRect ;_fdeb !=nil {_befe :=_fddcf .Bounds ().Size ();_agde :=_befe .X ;_gada :=_befe .Y ;var _cbae ,_fgde ,_egaa ,_bfgg int ;var _bfd bool ;if _cecb :=_fdeb .LAttr ;_cecb !=nil {_cbae =int (float64 (_agde )*_ac .FromSTPercentage (_cecb ));
_bfd =true ;}else {_cbae =0;};if _cccg :=_fdeb .TAttr ;_cccg !=nil {_egaa =int (float64 (_gada )*_ac .FromSTPercentage (_cccg ));_bfd =true ;}else {_egaa =0;};if _daea :=_fdeb .RAttr ;_daea !=nil {_fgde =int (float64 (_agde )*(1-_ac .FromSTPercentage (_daea )));
_bfd =true ;}else {_fgde =_agde ;};if _ggcc :=_fdeb .BAttr ;_ggcc !=nil {_bfgg =int (float64 (_gada )*(1-_ac .FromSTPercentage (_ggcc )));_bfd =true ;}else {_bfgg =_gada ;};if _bfd {_fddcf =_ac .CropImageByRect (_fddcf ,_aa .Rect (_cbae ,_egaa ,_fgde +1,_bfgg +1));
};};_ceff ,_gegf :=_cbba ._eeec .NewImageFromGoImage (_fddcf );_ceff .SetEncoder (_be .NewFlateEncoder ());if _dd .ToLower (_dcfc .Format ())=="\u006a\u0070\u0067"||_dd .ToLower (_dcfc .Format ())=="\u006a\u0070\u0065\u0067"{_ceff .SetEncoder (_be .NewDCTEncoder ());
};if _gegf !=nil {_ce .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_gegf );
return nil ,nil ,_gegf ;};return _ceff ,_cdfe .BlipChoice ,nil ;};};};return nil ,nil ,nil ;};