//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_f "bytes";_g "errors";_d "github.com/unidoc/unioffice/common";_ed "github.com/unidoc/unioffice/common/logger";_b "github.com/unidoc/unioffice/common/tempstorage";_ef "github.com/unidoc/unioffice/internal/convertutils";_efc "github.com/unidoc/unioffice/measurement";
_ag "github.com/unidoc/unioffice/presentation";_aab "github.com/unidoc/unioffice/schema/soo/dml";_cg "github.com/unidoc/unioffice/schema/soo/dml/chart";_ab "github.com/unidoc/unioffice/schema/soo/pml";_ad "github.com/unidoc/unipdf/v3/contentstream/draw";
_fg "github.com/unidoc/unipdf/v3/core";_dg "github.com/unidoc/unipdf/v3/creator";_eg "github.com/unidoc/unipdf/v3/model";_cd "github.com/unidoc/unipdf/v3/render";_a "image";_ge "image/color";_e "image/draw";_ae "strconv";_aa "strings";);func (_fgec *convertContext )getStyleColors (_egbf *_aab .CT_ShapeStyle )(_dg .Color ,_dg .Color ,_dg .Color ){var _fdgga ,_eecfe ,_cbdb _dg .Color ;
if _fdee :=_egbf .LnRef ;_fdee !=nil {_eecfe =_fgec .getColorFromMatrixReference (_fdee );};if _ddggc :=_egbf .FillRef ;_ddggc !=nil {_cbdb =_fgec .getColorFromMatrixReference (_ddggc );};if _fadd :=_egbf .FontRef ;_fadd !=nil {_fdgga =_fgec .getColorFromFontReference (_fadd );
};return _fdgga ,_cbdb ,_eecfe ;};func (_aggcb *convertContext )getColorFromMatrixReference (_ggee *_aab .CT_StyleMatrixReference )_dg .Color {if _ggee ==nil {return nil ;};var _bbga _dg .Color ;var _afg string ;if _cdff :=_ggee .SrgbClr ;_cdff !=nil {_afg =_cdff .ValAttr ;
}else if _dedf :=_ggee .SchemeClr ;_dedf !=nil {_afg =_ef .GetColorStringFromDmlColor (_aggcb ._ece .GetColorBySchemeColor (_dedf .ValAttr ));_afg =_ef .AdjustColor (_afg ,_dedf .EG_ColorTransform );};if _afg !=""{_bbga =_dg .ColorRGBFromHex ("\u0023"+_afg );
};return _bbga ;};func (_cbbf *convertContext )getColorFromFontReference (_adde *_aab .CT_FontReference )_dg .Color {var _ggfg _dg .Color ;var _bcad string ;if _ggag :=_adde .SrgbClr ;_ggag !=nil {_bcad =_ggag .ValAttr ;}else if _fafef :=_adde .SchemeClr ;
_fafef !=nil {_bcad =_ef .GetColorStringFromDmlColor (_cbbf ._ece .GetColorBySchemeColor (_fafef .ValAttr ));_bcad =_ef .AdjustColor (_bcad ,_fafef .EG_ColorTransform );};if _bcad !=""{_ggfg =_dg .ColorRGBFromHex ("\u0023"+_bcad );};return _ggfg ;};type word struct{_dfge []*symbol ;
_bgaa float64 ;_bdcbe float64 ;_fbcf bool ;};func _ddbf (_fdaa ,_bbfc *_aab .CT_TableStyleTextStyle )*_aab .CT_TableStyleTextStyle {_addee :=_aab .NewCT_TableStyleTextStyle ();if _fdaa !=nil {*_addee =*_fdaa ;};if _bbfc ==nil {return _addee ;};if _addee .BAttr ==_aab .ST_OnOffStyleTypeUnset {_addee .BAttr =_bbfc .BAttr ;
};if _addee .IAttr ==_aab .ST_OnOffStyleTypeUnset {_addee .IAttr =_bbfc .IAttr ;};if _addee .Font ==nil {_addee .Font =_bbfc .Font ;};if _addee .FontRef ==nil {_addee .FontRef =_bbfc .FontRef ;};if _addee .ScrgbClr ==nil {_addee .ScrgbClr =_bbfc .ScrgbClr ;
};if _addee .SrgbClr ==nil {_addee .SrgbClr =_bbfc .SrgbClr ;};if _addee .HslClr ==nil {_addee .HslClr =_bbfc .HslClr ;};if _addee .SysClr ==nil {_addee .SysClr =_bbfc .SysClr ;};if _addee .SchemeClr ==nil {_addee .SchemeClr =_bbfc .SchemeClr ;};if _addee .PrstClr ==nil {_addee .PrstClr =_bbfc .PrstClr ;
};return _addee ;};type prefixData struct{_dffa string ;_edag bool ;_gga float64 ;_gcfb float64 ;};func _efdd (_ddgaeb *_aab .CT_TableCellProperties ,_bfcd *_aab .CT_TableStyleCellStyle ,_fbdd ,_aeeb ,_agcd ,_efad bool )*_aab .CT_TableCellProperties {_adca :=_aab .NewCT_TableCellProperties ();
if _ddgaeb !=nil {*_adca =*_ddgaeb ;};if _bfcd ==nil {return _adca ;};if _bafg :=_bfcd .FillRef ;_bafg !=nil {_cabe :=_aab .NewCT_SolidColorFillProperties ();_cabe .ScrgbClr =_bafg .ScrgbClr ;_cabe .SrgbClr =_bafg .SrgbClr ;_cabe .HslClr =_bafg .HslClr ;
_cabe .SysClr =_bafg .SysClr ;_cabe .SchemeClr =_bafg .SchemeClr ;_cabe .PrstClr =_bafg .PrstClr ;_adca .SolidFill =_cabe ;};if _adca .NoFill ==nil &&_adca .SolidFill ==nil {if _dffba :=_bfcd .Fill ;_dffba !=nil {if _adca .NoFill ==nil {_adca .NoFill =_dffba .NoFill ;
};if _adca .SolidFill ==nil {_adca .SolidFill =_dffba .SolidFill ;};};};if _caed :=_bfcd .TcBdr ;_caed !=nil {if _adca .LnL ==nil {var _gdeb *_aab .CT_ThemeableLineStyle ;if _agcd {_gdeb =_caed .Left ;}else {_gdeb =_caed .InsideV ;};if _gdeb !=nil {_adca .LnL =_gdeb .Ln ;
};};if _adca .LnR ==nil {var _dfgeg *_aab .CT_ThemeableLineStyle ;if _efad {_dfgeg =_caed .Right ;}else {_dfgeg =_caed .InsideV ;};if _dfgeg !=nil {_adca .LnR =_dfgeg .Ln ;};};if _adca .LnT ==nil {var _eede *_aab .CT_ThemeableLineStyle ;if _fbdd {_eede =_caed .Top ;
}else {_eede =_caed .InsideH ;};if _eede !=nil {_adca .LnT =_eede .Ln ;};};if _adca .LnB ==nil {var _cfbe *_aab .CT_ThemeableLineStyle ;if _aeeb {_cfbe =_caed .Bottom ;}else {_cfbe =_caed .InsideH ;};if _cfbe !=nil {_adca .LnB =_cfbe .Ln ;};};};return _adca ;
};type textboxContext struct{_dcaa *convertContext ;_cdba float64 ;_dec float64 ;_bbaf *_dg .Creator ;_cfb float64 ;_abgb []*paragraph ;_aeaa *paragraph ;_bgdd *line ;_deea *word ;_ecdd bool ;};func _fcab (_aegf float64 )float64 {return _aegf *_efc .Inch };
const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_dab *convertContext )extractDefaultProperties (){_cdf :=_dab ._ece .X ();_bg :=_cdf .DefaultTextStyle ;var _fd ,_fa ,_cgc ,_df ,_ac ,_cec ,_dbe ,_bfb ,_cc ,_efg *_aab .CT_TextParagraphProperties ;
if _bg !=nil {_fd =_bg .DefPPr ;_fa =_ffc (_bg .Lvl1pPr ,_fd );_cgc =_ffc (_bg .Lvl2pPr ,_fd );_df =_ffc (_bg .Lvl3pPr ,_fd );_ac =_ffc (_bg .Lvl4pPr ,_fd );_cec =_ffc (_bg .Lvl5pPr ,_fd );_dbe =_ffc (_bg .Lvl6pPr ,_fd );_bfb =_ffc (_bg .Lvl7pPr ,_fd );
_cc =_ffc (_bg .Lvl8pPr ,_fd );_efg =_ffc (_bg .Lvl9pPr ,_fd );_dab ._geg =_fd ;_dab ._bbfe =_fd .DefRPr ;};_dab ._gddb =make ([]*_aab .CT_TextParagraphProperties ,9);_dab ._gddb [0]=_fa ;_dab ._gddb [1]=_cgc ;_dab ._gddb [2]=_df ;_dab ._gddb [3]=_ac ;
_dab ._gddb [4]=_cec ;_dab ._gddb [5]=_dbe ;_dab ._gddb [6]=_bfb ;_dab ._gddb [7]=_cc ;_dab ._gddb [8]=_efg ;_aac :=_dab ._ece .SlideMasters ()[0].X ();_cbf :=_aac .TxStyles ;_dfa :=_cbf .TitleStyle ;_dab ._fecb =_ffc (_dfa .DefPPr ,_fd );_dab ._cfec =_dab ._fecb .DefRPr ;
_dab ._ded =make ([]*_aab .CT_TextParagraphProperties ,9);_dab ._ded [0]=_ffc (_dfa .Lvl1pPr ,_fa );_dab ._ded [1]=_ffc (_dfa .Lvl2pPr ,_cgc );_dab ._ded [2]=_ffc (_dfa .Lvl3pPr ,_df );_dab ._ded [3]=_ffc (_dfa .Lvl4pPr ,_ac );_dab ._ded [4]=_ffc (_dfa .Lvl5pPr ,_cec );
_dab ._ded [5]=_ffc (_dfa .Lvl6pPr ,_dbe );_dab ._ded [6]=_ffc (_dfa .Lvl7pPr ,_bfb );_dab ._ded [7]=_ffc (_dfa .Lvl8pPr ,_cc );_dab ._ded [8]=_ffc (_dfa .Lvl9pPr ,_efg );_faf :=_cbf .BodyStyle ;_dab ._gggc =_ffc (_faf .DefPPr ,_fd );_dab ._aeac =_dab ._gggc .DefRPr ;
_dab ._gafe =make ([]*_aab .CT_TextParagraphProperties ,9);_dab ._gafe [0]=_ffc (_faf .Lvl1pPr ,_fa );_dab ._gafe [1]=_ffc (_faf .Lvl2pPr ,_cgc );_dab ._gafe [2]=_ffc (_faf .Lvl3pPr ,_df );_dab ._gafe [3]=_ffc (_faf .Lvl4pPr ,_ac );_dab ._gafe [4]=_ffc (_faf .Lvl5pPr ,_cec );
_dab ._gafe [5]=_ffc (_faf .Lvl6pPr ,_dbe );_dab ._gafe [6]=_ffc (_faf .Lvl7pPr ,_bfb );_dab ._gafe [7]=_ffc (_faf .Lvl8pPr ,_cc );_dab ._gafe [8]=_ffc (_faf .Lvl9pPr ,_efg );};func (_bdg *convertContext )makePdfDivisionFromTxBody (_bddb *_aab .CT_TextBody ,_bdc *_aab .CT_TableStyleTextStyle )*_dg .Division {_afbg :=_bdg ._gbad .NewDivision ();
_gfdd :=_bdg ._geg ;_bcd :=_aab .ST_TextAnchoringTypeT ;if _gggf :=_bddb .BodyPr ;_gggf !=nil {if _gab :=_gggf .AnchorAttr ;_gab !=_aab .ST_TextAnchoringTypeUnset {_bcd =_gggf .AnchorAttr ;};};if _eeg :=_bddb .LstStyle ;_eeg !=nil {var _feg *_aab .CT_TextParagraphProperties ;
if _eeg .Lvl1pPr !=nil {_feg =_eeg .Lvl1pPr ;}else {_feg =_bdg ._gddb [0];};_gfdd =_ffc (_feg ,_ffc (_eeg .DefPPr ,_gfdd ));};for _ ,_ggf :=range _bddb .P {if _ggf !=nil {_dfc :=_bdg ._gbad .NewStyledParagraph ();_gcae :=_ffc (_ggf .PPr ,_gfdd );_fcg :=_bgfa (_ggf .EndParaRPr ,_gcae .DefRPr );
if len (_ggf .EG_TextRun )==0{_dfc .Append ("\u000a");_afbg .Add (_dfc );continue ;};for _ ,_ebe :=range _ggf .EG_TextRun {if _ffa :=_ebe .Br ;_ffa !=nil {_dfc .Append ("\u000a");}else if _eae :=_ebe .R ;_eae !=nil {_ddd :=_edbc (_eae .RPr ,_bdc );_ddd =_bgfa (_ddd ,_fcg );
var _ffg _dg .Color ;if _ddd .SolidFill !=nil {_ffg ,_ =_bdg .getColorFromSolidFill (_ddd .SolidFill );}else {_ffg =_dg .ColorBlack ;};_abgc ,_ggda ,_ddg ,_ :=_bdg .makeStyleFromRPr (_ddd );_abgc .Color =_ffg ;if _ggda {_abgc .TextRise =0.5;}else if _ddg {_abgc .TextRise =-0.5;
};_aacc :=_eae .T ;if _ddd .CapAttr ==_aab .ST_TextCapsTypeAll {for _ ,_ecc :=range _aacc {_ecc =[]rune (_aa .ToUpper (string (_ecc )))[0];};};_ccg :=_dfc .Append (_aacc );_ccg .Style =*_abgc ;};};_ =_bcd ;_afbg .Add (_dfc );};};return _afbg ;};func (_gbd *convertContext )makePdfBlockFromTxBody (_bcdb *_aab .CT_TextBody ,_egff *_aab .CT_TextBodyProperties ,_bgg *_aab .CT_TextListStyle ,_fcga ,_bgga float64 ,_bag _dg .Color ,_fceg ,_beec bool )(*_dg .Block ,error ){var _abdd *_aab .CT_TextParagraphProperties ;
if _fef :=_bcdb .LstStyle ;_fef !=nil {var _ecbc *_aab .CT_TextParagraphProperties ;if _fef .Lvl1pPr !=nil {_ecbc =_fef .Lvl1pPr ;};_abdd =_ffc (_ecbc ,_fef .DefPPr );};var _dddf *_aab .CT_TextParagraphProperties ;if _abdd !=nil {if _fceg {_dddf =_gbd ._ded [0];
}else if _beec {_dddf =_gbd ._gafe [0];}else {_dddf =_gbd ._gddb [0];};if _bgg !=nil {_dddf =_ffc (_ffc (_bgg .Lvl1pPr ,_bgg .DefPPr ),_dddf );};_dddf =_ffc (_abdd ,_dddf );}else {if _fceg {_dddf =_gbd ._fecb ;}else if _beec {_dddf =_gbd ._gggc ;}else {_dddf =_gbd ._geg ;
};};_bddf ,_gfda :=_ebfd (2.5),_ebfd (2.5);_dgcc ,_cfdg :=_ebfd (1.3),_ebfd (1.3);_adg :=true ;_fgcg :=_aab .ST_TextAnchoringTypeT ;if _egff !=nil {if _cda :=_egff .AnchorAttr ;_cda !=_aab .ST_TextAnchoringTypeUnset {_fgcg =_cda ;};};if _gba :=_bcdb .BodyPr ;
_gba !=nil {if _bdgc :=_gba .LInsAttr ;_bdgc !=nil {_bddf =_efc .FromEMU (_ef .FromSTCoordinate32 (*_bdgc ));};if _agg :=_gba .TInsAttr ;_agg !=nil {_dgcc =_efc .FromEMU (_ef .FromSTCoordinate32 (*_agg ));};if _cgfg :=_gba .RInsAttr ;_cgfg !=nil {_gfda =_efc .FromEMU (_ef .FromSTCoordinate32 (*_cgfg ));
};if _cddb :=_gba .BInsAttr ;_cddb !=nil {_cfdg =_efc .FromEMU (_ef .FromSTCoordinate32 (*_cddb ));};_adg =_gba .WrapAttr !=_aab .ST_TextWrappingTypeNone ;if _cde :=_gba .AnchorAttr ;_cde !=_aab .ST_TextAnchoringTypeUnset {_fgcg =_gba .AnchorAttr ;};};
_fdb :=_ef .MakeTempCreator (_fcga ,_bgga );_fdb .SetPageMargins (_bddf ,_gfda ,_dgcc ,_cfdg );_efaf :=&textboxContext {_dcaa :_gbd ,_ecdd :_adg ,_cdba :_fcga -_bddf -_gfda ,_dec :_bgga -_dgcc -_cfdg ,_bbaf :_fdb ,_abgb :[]*paragraph {}};_acbe :=1;for _ ,_bcb :=range _bcdb .P {if _bcb !=nil {_bae :=_bcb .PPr ;
var _bdcb *prefixData ;if _bae !=nil &&_bae .BuNone ==nil {var _dcb string ;var _ecd bool ;if _gbe :=_bae .BuAutoNum ;_gbe !=nil {var _gdd string ;if _ageb :=_gbe .StartAtAttr ;_ageb !=nil {_acbe =int (*_ageb );};var _gdeeb string ;switch _gbe .TypeAttr {case _aab .ST_TextAutonumberSchemeAlphaUcParenBoth ,_aab .ST_TextAutonumberSchemeAlphaUcParenR ,_aab .ST_TextAutonumberSchemeAlphaUcPeriod :_gdeeb =_fbf (_acbe ,true );
case _aab .ST_TextAutonumberSchemeAlphaLcParenBoth ,_aab .ST_TextAutonumberSchemeAlphaLcParenR ,_aab .ST_TextAutonumberSchemeAlphaLcPeriod :_gdeeb =_fbf (_acbe ,false );case _aab .ST_TextAutonumberSchemeRomanUcParenBoth ,_aab .ST_TextAutonumberSchemeRomanUcParenR ,_aab .ST_TextAutonumberSchemeRomanUcPeriod :_gdeeb =_gea (_acbe ,true );
case _aab .ST_TextAutonumberSchemeRomanLcParenBoth ,_aab .ST_TextAutonumberSchemeRomanLcParenR ,_aab .ST_TextAutonumberSchemeRomanLcPeriod :_gdeeb =_gea (_acbe ,false );default:_gdeeb =_ae .Itoa (_acbe );};switch _gbe .TypeAttr {case _aab .ST_TextAutonumberSchemeAlphaLcPeriod ,_aab .ST_TextAutonumberSchemeAlphaUcPeriod ,_aab .ST_TextAutonumberSchemeArabicPeriod ,_aab .ST_TextAutonumberSchemeRomanLcPeriod ,_aab .ST_TextAutonumberSchemeRomanUcPeriod ,_aab .ST_TextAutonumberSchemeArabicDbPeriod ,_aab .ST_TextAutonumberSchemeEa1ChsPeriod ,_aab .ST_TextAutonumberSchemeEa1ChtPeriod ,_aab .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_aab .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_aab .ST_TextAutonumberSchemeThaiAlphaPeriod ,_aab .ST_TextAutonumberSchemeThaiNumPeriod ,_aab .ST_TextAutonumberSchemeHindiAlphaPeriod ,_aab .ST_TextAutonumberSchemeHindiNumPeriod ,_aab .ST_TextAutonumberSchemeHindiAlpha1Period :_gdd ="\u002e";
case _aab .ST_TextAutonumberSchemeAlphaLcParenR ,_aab .ST_TextAutonumberSchemeAlphaUcParenR ,_aab .ST_TextAutonumberSchemeArabicParenR ,_aab .ST_TextAutonumberSchemeRomanLcParenR ,_aab .ST_TextAutonumberSchemeRomanUcParenR ,_aab .ST_TextAutonumberSchemeThaiAlphaParenR ,_aab .ST_TextAutonumberSchemeThaiNumParenR ,_aab .ST_TextAutonumberSchemeHindiNumParenR :_gdd ="\u0029";
};_dcb =_gdeeb +_gdd ;_acbe ++;}else if _feb :=_bae .BuChar ;_feb !=nil {_acbc :=_feb .CharAttr ;if _gcge ,_geff :=_ggbe [_acbc ];_geff {_acbc =string (rune (_gcge ));}else {_acbc ="\u2022";};_dcb =_acbc ;_ecd =true ;};if _dcb !=""{var _ccgd ,_aed float64 ;
if _bae .MarLAttr !=nil {_ccgd =_efc .FromEMU (int64 (*_bae .MarLAttr ));};if _bae .IndentAttr !=nil {_aed =_efc .FromEMU (int64 (*_bae .IndentAttr ));};_bdcb =&prefixData {_dffa :_dcb ,_edag :_ecd ,_gga :_ccgd ,_gcfb :_aed };};};_bae =_ffc (_bae ,_dddf );
_dgccc :=_bgfa (_bcb .EndParaRPr ,_bae .DefRPr );_efaf .newParagraph ();_efaf .assignPropsToCurrentParagraph (_bae );_efaf .newLine ();_efaf .newWord ();for _cfcg ,_bcg :=range _bcb .EG_TextRun {_efaf .addTextRun (_bcg ,_dgccc ,_bag ,_bdcb );if _cfcg > 0{_bdcb =nil ;
};};_efaf .addCurrentWordToParagraph ();};_efaf .addCurrentParagraph ();};_efaf .alignVertically (_fgcg );_efaf .drawParagraphs ();return _ef .MakeBlockFromCreator (_fdb );};func _bce (_cbfa string )[]*symbol {_ebfa :=[]*symbol {};for _ ,_bdga :=range _cbfa {_ebfa =append (_ebfa ,&symbol {_bdb :string (_bdga )});
};return _ebfa ;};func (_dfe *textboxContext )drawParagraphs (){_dfe ._bbaf .NewPage ();for _ ,_eggg :=range _dfe ._abgb {for _ ,_cbbd :=range _eggg ._dbgc {for _ ,_bdcf :=range _cbbd ._dbc {for _ ,_cdbae :=range _bdcf ._dfge {_fefe :=_dfe ._bbaf .NewStyledParagraph ();
if _cdbae ._ggdf {_cdbae ._cfee =0;}else if _cdbae ._aagb {_cdbae ._cfee =1.2*_cbbd ._aaed -_cdbae ._bab ;};_fddd :=_bdcf ._bgaa +_cdbae ._dcbf ;_eebe :=_eggg ._aeec +_cbbd ._eedb +_cdbae ._cfee ;_fefe .SetPos (_fddd ,_eebe );_edce :=_fefe .Append (_cdbae ._bdb );
if _cdbae ._eagf !=nil {_edce .Style =*_cdbae ._eagf ;};_dfe ._bbaf .Draw (_fefe );if _cdbae ._edcb {_dgce :=_eebe +_cdbae ._bab +2;_ef .DrawLine (_dfe ._bbaf ,_fddd ,_dgce ,_fddd +_cdbae ._dfcf ,_dgce ,1,_cdbae ._eagf .Color );};};};};};};func (_fdg *convertContext )drawSlide (){_fdg ._gbad .NewPage ();
for _ ,_dgd :=range _fdg ._geed {if _dgd !=nil {_fdg ._gbad .MoveTo (0,0);_fdg ._gbad .Draw (_dgd );};};};func _dbgg (_dgaa ,_adba *_aab .CT_TextListStyle )*_aab .CT_TextListStyle {_bccaa :=_aab .NewCT_TextListStyle ();if _dgaa !=nil {*_bccaa =*_dgaa ;
};if _adba ==nil {return _bccaa ;};_bccaa .DefPPr =_ffc (_bccaa .DefPPr ,_adba .DefPPr );_bccaa .Lvl1pPr =_ffc (_bccaa .Lvl1pPr ,_adba .Lvl1pPr );_bccaa .Lvl2pPr =_ffc (_bccaa .Lvl2pPr ,_adba .Lvl2pPr );_bccaa .Lvl3pPr =_ffc (_bccaa .Lvl3pPr ,_adba .Lvl3pPr );
_bccaa .Lvl4pPr =_ffc (_bccaa .Lvl4pPr ,_adba .Lvl4pPr );_bccaa .Lvl5pPr =_ffc (_bccaa .Lvl5pPr ,_adba .Lvl5pPr );_bccaa .Lvl6pPr =_ffc (_bccaa .Lvl6pPr ,_adba .Lvl6pPr );_bccaa .Lvl7pPr =_ffc (_bccaa .Lvl7pPr ,_adba .Lvl7pPr );_bccaa .Lvl8pPr =_ffc (_bccaa .Lvl8pPr ,_adba .Lvl8pPr );
_bccaa .Lvl9pPr =_ffc (_bccaa .Lvl9pPr ,_adba .Lvl9pPr );return _bccaa ;};func (_fffad *textboxContext )alignParagraph (){_fgddd :=_fffad ._aeaa ;if _fgddd ._efaa ==_aab .ST_TextAlignTypeL {return ;};_edcba :=len (_fgddd ._dbgc )-1;for _fgff ,_fdgg :=range _fgddd ._dbgc {_bdfa :=true ;
_cecb :=len (_fdgg ._dbc );_gcd :=0.0;for _aeg :=len (_fdgg ._dbc )-1;_aeg >=0;_aeg --{_cdgf :=_fdgg ._dbc [_aeg ];if _bdfa &&_cdgf ._fbcf {_cecb =_aeg ;}else {_bdfa =false ;for _ ,_fged :=range _cdgf ._dfge {_gcd +=_fged ._dfcf ;};};};_fdgg ._dbc =_fdgg ._dbc [:_cecb ];
_ggae :=_fdgg ._edbe -_fdgg ._ggfb -_gcd ;switch _fgddd ._efaa {case _aab .ST_TextAlignTypeR :_fdgg .moveRight (_ggae );case _aab .ST_TextAlignTypeCtr :_fdgg .moveRight (_ggae /2);case _aab .ST_TextAlignTypeJust :if _fgff !=_edcba {_bcca :=[]*word {};for _ ,_bbbc :=range _fdgg ._dbc {if _bbbc ._fbcf {_bcca =append (_bcca ,_bbbc );
};};_fed :=_ggae /float64 (len (_bcca ));for _ ,_fegee :=range _bcca {_fegee ._bdcbe +=_fed ;};var _egfc *word ;for _ ,_cbaad :=range _fdgg ._dbc {if _egfc !=nil {_cbaad ._bgaa =_egfc ._bgaa +_egfc ._bdcbe ;};_egfc =_cbaad ;};};};};};func (_fcea *textboxContext )assignPropsToCurrentParagraph (_cccf *_aab .CT_TextParagraphProperties ){_adcee :=12.4;
if _cccf ==nil {_fcea ._aeaa ._agecc =_adcee ;return ;};if _dbbe :=_cccf .DefRPr ;_dbbe !=nil {_fgfa :=_dbbe .SzAttr ;if _fgfa !=nil {_ffdg :=float64 (*_fgfa )/1200;if _adcee <=_ffdg {_adcee =_ffdg ;};};};if _gcbe :=_cccf .MarLAttr ;_gcbe !=nil {_fcea ._aeaa ._egbb =_efc .FromEMU (int64 (*_gcbe ));
};_fcea ._aeaa ._efda =_fcea ._cdba ;if _cgdf :=_cccf .MarRAttr ;_cgdf !=nil {_fcea ._aeaa ._efda -=_efc .FromEMU (int64 (*_cgdf ));};if _cfgf :=_cccf .IndentAttr ;_cfgf !=nil {_fcea ._aeaa ._aca =_efc .FromEMU (int64 (*_cfgf ));};if _ace :=_cccf .LatinLnBrkAttr ;
_ace !=nil {_fcea ._aeaa ._dbb =*_ace ;};if _bec :=_cccf .LnSpc ;_bec !=nil {if _agcc :=_bec .SpcPct ;_agcc !=nil {if _bagb :=_agcc .ValAttr .ST_TextSpacingPercent ;_bagb !=nil {_adcee =float64 (*_bagb )/5000;};};};var _bafc float64 ;if _ccgg :=_cccf .SpcBef ;
_ccgg !=nil {if _efgb :=_ccgg .SpcPts ;_efgb !=nil {_bafc =float64 (_efgb .ValAttr )/100;};};_aeee :=_fcea ._abgb ;if len (_aeee )> 0{_bafc -=_aeee [len (_aeee )-1]._eaa ;if _bafc < 0{_bafc =0;};};_fcea ._aeaa ._dcagf =_bafc ;if _cff :=_cccf .SpcAft ;_cff !=nil {if _gaab :=_cff .SpcPts ;
_gaab !=nil {_fcea ._aeaa ._eaa =float64 (_gaab .ValAttr )/100;};};_fcea ._aeaa ._agecc =_adcee ;_fcea ._aeaa ._efaa =_cccf .AlgnAttr ;};func (_cfg *convertContext )getConnectors (_dcc *_ab .CT_Connector )[]_dg .Drawable {_fbe ,_ ,_ ,_ ,_ ,_ ,_ :=_cfg .getShapesFromSpPr (_dcc .SpPr ,_dcc .Style ,false ,0.0,0.0);
return _fbe ;};func _bgfa (_bcbbf ,_gdcd *_aab .CT_TextCharacterProperties )*_aab .CT_TextCharacterProperties {_eddf :=_aab .NewCT_TextCharacterProperties ();if _bcbbf !=nil {*_eddf =*_bcbbf ;};if _gdcd ==nil {return _eddf ;};if _eddf .KumimojiAttr ==nil {_eddf .KumimojiAttr =_gdcd .KumimojiAttr ;
};if _eddf .LangAttr ==nil {_eddf .LangAttr =_gdcd .LangAttr ;};if _eddf .AltLangAttr ==nil {_eddf .AltLangAttr =_gdcd .AltLangAttr ;};if _eddf .SzAttr ==nil {_eddf .SzAttr =_gdcd .SzAttr ;};if _eddf .BAttr ==nil {_eddf .BAttr =_gdcd .BAttr ;};if _eddf .IAttr ==nil {_eddf .IAttr =_gdcd .IAttr ;
};if _eddf .UAttr ==_aab .ST_TextUnderlineTypeUnset {_eddf .UAttr =_gdcd .UAttr ;};if _eddf .StrikeAttr ==_aab .ST_TextStrikeTypeUnset {_eddf .StrikeAttr =_gdcd .StrikeAttr ;};if _eddf .KernAttr ==nil {_eddf .KernAttr =_gdcd .KernAttr ;};if _eddf .CapAttr ==_aab .ST_TextCapsTypeUnset {_eddf .CapAttr =_gdcd .CapAttr ;
};if _eddf .SpcAttr ==nil {_eddf .SpcAttr =_gdcd .SpcAttr ;};if _eddf .NormalizeHAttr ==nil {_eddf .NormalizeHAttr =_gdcd .NormalizeHAttr ;};if _eddf .BaselineAttr ==nil {_eddf .BaselineAttr =_gdcd .BaselineAttr ;};if _eddf .NoProofAttr ==nil {_eddf .NoProofAttr =_gdcd .NoProofAttr ;
};if _eddf .DirtyAttr ==nil {_eddf .DirtyAttr =_gdcd .DirtyAttr ;};if _eddf .ErrAttr ==nil {_eddf .ErrAttr =_gdcd .ErrAttr ;};if _eddf .SmtCleanAttr ==nil {_eddf .SmtCleanAttr =_gdcd .SmtCleanAttr ;};if _eddf .SmtIdAttr ==nil {_eddf .SmtIdAttr =_gdcd .SmtIdAttr ;
};if _eddf .BmkAttr ==nil {_eddf .BmkAttr =_gdcd .BmkAttr ;};if _eddf .Ln ==nil {_eddf .Ln =_gdcd .Ln ;};if _eddf .NoFill ==nil {_eddf .NoFill =_gdcd .NoFill ;};if _eddf .SolidFill ==nil {_eddf .SolidFill =_gdcd .SolidFill ;};if _eddf .BlipFill ==nil {_eddf .BlipFill =_gdcd .BlipFill ;
};if _eddf .EffectLst ==nil {_eddf .EffectLst =_gdcd .EffectLst ;};if _eddf .EffectDag ==nil {_eddf .EffectDag =_gdcd .EffectDag ;};if _eddf .Highlight ==nil {_eddf .Highlight =_gdcd .Highlight ;};if _eddf .ULnTx ==nil {_eddf .ULnTx =_gdcd .ULnTx ;};if _eddf .ULn ==nil {_eddf .ULn =_gdcd .ULn ;
};if _eddf .UFillTx ==nil {_eddf .UFillTx =_gdcd .UFillTx ;};if _eddf .UFill ==nil {_eddf .UFill =_gdcd .UFill ;};if _eddf .Latin ==nil {_eddf .Latin =_gdcd .Latin ;};if _eddf .Ea ==nil {_eddf .Ea =_gdcd .Ea ;};if _eddf .Cs ==nil {_eddf .Cs =_gdcd .Cs ;
};if _eddf .Sym ==nil {_eddf .Sym =_gdcd .Sym ;};if _eddf .Rtl ==nil {_eddf .Rtl =_gdcd .Rtl ;};return _eddf ;};func (_gde *convertContext )tileImage (_gb *_dg .Image ,_ebf *_aab .CT_TileInfoProperties ,_cgcg ,_bbf float64 )*_dg .Image {_ff ,_adc :=1.0,1.0;
if _ggcc :=_ebf .SxAttr ;_ggcc !=nil {_ff =_ef .FromSTPercentage (_ggcc );};if _bfdf :=_ebf .SyAttr ;_bfdf !=nil {_adc =_ef .FromSTPercentage (_bfdf );};_ede :=_ef .MakeTempCreator (_cgcg ,_bbf );_gb .Scale (_ff ,_adc );_egae ,_ccb :=_gb .Width (),_gb .Height ();
var _age ,_bbb float64 ;if _dd :=_ebf .TxAttr ;_dd !=nil {_age =_efc .FromEMU (_ef .FromSTCoordinate (*_dd ));};if _cbd :=_ebf .TyAttr ;_cbd !=nil {_bbb =_efc .FromEMU (_ef .FromSTCoordinate (*_cbd ));};if _age > 0{_age -=_egae ;};if _bbb > 0{_bbb -=_ccb ;
};_gcg :=_gde ._ccaa /_egae +1;_cdb :=_gde ._caf /_ccb +1;for _abe :=0.0;_abe <=_gcg ;_abe ++{_adb :=_abe *_egae ;for _egd :=0.0;_egd <=_cdb ;_egd ++{_bad :=_egd *_ccb ;_gb .SetPos (_adb +_age ,_bad +_bbb );_ede .Draw (_gb );};};_dea ,_fb :=_ef .GetPageFromCreator (_ede );
if _fb !=nil {_ed .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_fb );return nil ;};_ebd ,_fb :=_cd .NewImageDevice ().Render (_dea );
if _fb !=nil {_ed .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_fb );return nil ;};_edf ,_fb :=_gde ._gbad .NewImageFromGoImage (_ebd );if _fb !=nil {_ed .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_fb );
return nil ;};return _edf ;};func (_gbgd *convertContext )makeStyleFromRPr (_bcag *_aab .CT_TextCharacterProperties )(*_dg .TextStyle ,bool ,bool ,bool ){var _fbg ,_fba ,_bgf bool ;_dgdd :=_gbgd ._gbad .NewTextStyle ();if _bcag !=nil {_agc :=_ef .FontStyle_Regular ;
_cef :=_accf (_bcag .BAttr );_ccdg :=_accf (_bcag .IAttr );if _cef &&_ccdg {_agc =_ef .FontStyle_BoldItalic ;}else if _cef {_agc =_ef .FontStyle_Bold ;}else if _ccdg {_agc =_ef .FontStyle_Italic ;};_bgf =_bcag .UAttr !=_aab .ST_TextUnderlineTypeUnset &&_bcag .UAttr !=_aab .ST_TextUnderlineTypeNone ;
_eff :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _gbgda :=_bcag .Latin ;_gbgda !=nil {_eff =_gbgda .TypefaceAttr ;}else if _dgac :=_bcag .Ea ;_dgac !=nil {_eff =_dgac .TypefaceAttr ;}else if _abbe :=_bcag .Cs ;_abbe !=nil {_eff =_abbe .TypefaceAttr ;}else if _adad :=_bcag .Sym ;
_adad !=nil {_eff =_adad .TypefaceAttr ;};if _cfga ,_faae :=_ef .StdFontsMap [_eff ];_faae {_dgdd .Font =_ef .AssignStdFontByName (_dgdd ,_cfga [_agc ]);}else if _dffb :=_ef .GetRegisteredFont (_eff ,_agc );_dffb !=nil {_dgdd .Font =_dffb ;}else {_ed .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_eff ,_agc );
_dgdd .Font =_ef .AssignStdFontByName (_dgdd ,_ef .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_agc ]);};var _cdca float64 ;if _fbb :=_bcag .SzAttr ;_fbb !=nil {_cdca =float64 (*_fbb )/100;}else {_cdca =_ef .DefaultFontSize ;};if _dfg :=_bcag .BaselineAttr ;
_dfg !=nil {if _gaba :=_dfg .ST_PercentageDecimal ;_gaba !=nil {if *_gaba > 0{_fbg =true ;}else if *_gaba < 0{_fba =true ;};};};if _fbg ||_fba {_cdca *=0.64;};_dgdd .FontSize =_cdca ;_eed :=0.0;if _aadb :=_bcag .SpcAttr ;_aadb !=nil {if _fdd :=_aadb .ST_TextPointUnqualified ;
_fdd !=nil {_eed =float64 (*_fdd )/100;};};_dgdd .CharSpacing =_eed ;};return &_dgdd ,_fbg ,_fba ,_bgf ;};func _ebfd (_fac float64 )float64 {return _fac *_efc .Millimeter };func (_egaed *textboxContext )newLine (){if _egaed ._aeaa ==nil {_egaed .newParagraph ();
};_dcae :=_egaed ._aeaa ._acga +_egaed ._aeaa ._dcagf ;_dcg :=&line {};_dcg ._ggfb =_egaed ._aeaa ._egbb ;if len (_egaed ._aeaa ._dbgc )==0{_dcg ._ggfb +=_egaed ._aeaa ._aca ;};_dcg ._edbe =_egaed ._aeaa ._efda ;_dcg ._eef =_dcg ._ggfb ;_dcg ._eedb =_dcae ;
_egaed ._aeaa ._dbgc =append (_egaed ._aeaa ._dbgc ,_dcg );_egaed ._bgdd =_dcg ;};func _ffbc (_aage *_ab .CT_Shape )(_ab .ST_PlaceholderType ,*uint32 ){if _becd :=_aage .NvSpPr ;_becd !=nil {if _cab :=_becd .NvPr ;_cab !=nil {if _cbad :=_cab .Ph ;_cbad !=nil {return _cbad .TypeAttr ,_cbad .IdxAttr ;
};};};return _ab .ST_PlaceholderTypeUnset ,nil ;};func (_acd *textboxContext )addPrefix (_gfdb *prefixData ,_gbcd *_dg .TextStyle ){_bgc :=_bce (_gfdb ._dffa );_dbad :=*_gbcd ;if _gfdb ._edag {_dbad .Font =_ef .AssignStdFontByName (_dbad ,"\u0053\u0079\u006d\u0062\u006f\u006c");
};for _ ,_cgab :=range _bgc {_cgab ._eagf =&_dbad ;_acd .addTextSymbol (_cgab );};_fege :=-(_gfdb ._gcfb +_acd ._deea ._bdcbe );if _fege < 0{_fege =0;};_gbgf :=&symbol {_bdb :"\u0020",_dfcf :_fege };_acd .addTextSymbol (_gbgf );_acd ._deea ._bgaa +=(_gfdb ._gcfb +_gfdb ._gga );
};type convertContext struct{_gbad *_dg .Creator ;_daeg *_ef .Rectangle ;_ece *_ag .Presentation ;_fff *_ag .Slide ;_cbfe *_ab .SldMaster ;_dbag *_ab .SldLayout ;_caf float64 ;_ccaa float64 ;_geed []_dg .Drawable ;_ecbce *background ;_geg *_aab .CT_TextParagraphProperties ;
_bbfe *_aab .CT_TextCharacterProperties ;_fecb *_aab .CT_TextParagraphProperties ;_cfec *_aab .CT_TextCharacterProperties ;_gggc *_aab .CT_TextParagraphProperties ;_aeac *_aab .CT_TextCharacterProperties ;_gddb []*_aab .CT_TextParagraphProperties ;_ded []*_aab .CT_TextParagraphProperties ;
_gafe []*_aab .CT_TextParagraphProperties ;_fdc *_aab .Theme ;_feae *_aab .CT_ColorMappingOverride ;};func _gbead (_gfba ,_bccg *_aab .CT_TableStyleCellStyle )*_aab .CT_TableStyleCellStyle {_fbff :=_aab .NewCT_TableStyleCellStyle ();if _gfba !=nil {*_fbff =*_gfba ;
};if _bccg ==nil {return _fbff ;};if _fbff .TcBdr ==nil {_fbff .TcBdr =_bccg .TcBdr ;};if _fbff .Fill ==nil {_fbff .Fill =_bccg .Fill ;};if _fbff .FillRef ==nil {_fbff .FillRef =_bccg .FillRef ;};return _fbff ;};type symbolStyle struct{_edd *string ;_ecg *float64 ;
_bccc *string ;_bgbe *bool ;_bgee *bool ;_eddb *bool ;_cga *bool ;_ddga *bool ;};func (_gfg *convertContext )getGroupConnectors (_aae *_ab .CT_Connector ,_ggg float64 ,_fda float64 )[]_dg .Drawable {_badb ,_ ,_ ,_ ,_ ,_ ,_ :=_gfg .getShapesFromSpPr (_aae .SpPr ,_aae .Style ,false ,_ggg ,_fda );
return _badb ;};var _ggbe =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func (_aeaad *textboxContext )addTextSymbol (_cdbf *symbol ){_gcba :=_dg .New ();_adafg :=_gcba .NewStyledParagraph ();_adafg .SetMargins (0,0,0,0);_befe :=_adafg .Append (_cdbf ._bdb );
_geeb :=0.0;if _cdbf ._eagf !=nil {_befe .Style =*_cdbf ._eagf ;if _cdbf ._eagf .CharSpacing !=0{_geeb =_cdbf ._eagf .CharSpacing ;};};_cdbf ._bab =_adafg .Height ();_cdbf ._fabd =_adafg .Height ()*1.2;if _cdbf ._fabd < _aeaad ._aeaa ._agecc {_cdbf ._fabd =_aeaad ._aeaa ._agecc ;
};if _cdbf ._dfcf ==0{_cdbf ._dfcf =_adafg .Width ()+_geeb ;};if len (_aeaad ._deea ._dfge )> 0{_gbcb :=_aeaad ._deea ._dfge [len (_aeaad ._deea ._dfge )-1]._bdb ;if _aeaad ._aeaa ._dbb ||_ef .IsNoSpaceLanguage (_gbcb )||(_gbcb =="\u0020")!=(_cdbf ._bdb =="\u0020"){_aeaad .addCurrentWordToParagraph ();
_aeaad .newWord ();};};_aeaad ._deea ._dfge =append (_aeaad ._deea ._dfge ,_cdbf );_cdbf ._dcbf =_aeaad ._deea ._bdcbe ;_aeaad ._deea ._bdcbe +=_cdbf ._dfcf ;if _cdbf ._bdb !="\u0020"{_aeaad ._deea ._fbcf =false ;};};func (_eeb *convertContext )stretchImage (_fgf *_dg .Image ,_ced *_aab .CT_StretchInfoProperties ,_gbg ,_cbaa ,_efd ,_agf float64 )(*_dg .Image ,float64 ,float64 ){_bed :=_ced .FillRect ;
if _bed ==nil {_bcc :=_fgf .Width ()/_fgf .Height ();_ccf :=_efd /_agf ;var _bee ,_ddb float64 ;if _bcc > _ccf {_ddb =_agf ;_bee =_agf *_bcc ;}else {_bee =_efd ;_ddb =_efd /_bcc ;};_fgf .Scale (_bee /_fgf .Width (),_ddb /_fgf .Height ());return _fgf ,_gbg ,_cbaa ;
};var _afaag ,_fce ,_bea ,_beb float64 ;if _cfef :=_bed .LAttr ;_cfef !=nil {_bea =_ef .FromSTPercentage (_cfef );};if _baa :=_bed .TAttr ;_baa !=nil {_afaag =_ef .FromSTPercentage (_baa );};if _faa :=_bed .RAttr ;_faa !=nil {_beb =_ef .FromSTPercentage (_faa );
};if _gcf :=_bed .BAttr ;_gcf !=nil {_fce =_ef .FromSTPercentage (_gcf );};_fgd :=_efd *(1-_bea -_beb );_gefa :=_agf *(1-_afaag -_fce );_fgf .Scale (_fgd /_fgf .Width (),_gefa /_fgf .Height ());return _fgf ,_gbg +_bea *_efd ,_cbaa +_afaag *_agf ;};func (_bcbb *textboxContext )addCurrentWordToParagraph (){if _bcbb ._ecdd &&_bcbb ._bgdd ._eef +_bcbb ._deea ._bdcbe > _bcbb ._bgdd ._edbe {_bcbb .newLine ();
};if !_bcbb ._deea ._fbcf ||len (_bcbb ._bgdd ._dbc )> 0{_bcbb ._deea ._bgaa =_bcbb ._bgdd ._eef ;_bcbb ._bgdd ._dbc =append (_bcbb ._bgdd ._dbc ,_bcbb ._deea );_bcbb ._bgdd ._eef +=_bcbb ._deea ._bdcbe ;for _ ,_dbed :=range _bcbb ._deea ._dfge {_bcbb .adjustHeights (_dbed ._fabd );
};};};func (_deec *convertContext )addCellToTable (_bgfc *_dg .Table ,_gcb *_aab .CT_TableCell ,_ceag *_aab .CT_TablePartStyle ,_agec float64 ,_gefd ,_ddf ,_dbee ,_ggeg bool )float64 {var _deef *_dg .TableCell ;_agdd :=1;if _gcb .GridSpanAttr !=nil {_agdd =int (*_gcb .GridSpanAttr );
};_deef =_bgfc .MultiColCell (_agdd );_dfae :=_gcb .TcPr ;var _gcaee *_aab .CT_TableStyleTextStyle ;if _ceag !=nil {_dfae =_efdd (_dfae ,_ceag .TcStyle ,_gefd ,_ddf ,_dbee ,_ggeg );_gcaee =_ceag .TcTxStyle ;};_fddc :=_edc ;_eebc :=_dg .CellVerticalAlignmentMiddle ;
_caa :=_fcab (0.05);_cfge :=_fcab (0.05);if _dfae !=nil {if _adag :=_dfae .LnL ;_adag !=nil {_aea ,_aeb ,_bgec :=_deec .getBorderStyle (_adag );_deef .SetBorder (_dg .CellBorderSideLeft ,_aea ,_bgec );if _aeb !=nil &&*_aeb !=nil {_deef .SetSideBorderColor (_dg .CellBorderSideLeft ,*_aeb );
};};if _fafc :=_dfae .LnT ;_fafc !=nil {_cefe ,_fbeb ,_afda :=_deec .getBorderStyle (_fafc );_deef .SetBorder (_dg .CellBorderSideTop ,_cefe ,_afda );if _fbeb !=nil &&*_fbeb !=nil {_deef .SetSideBorderColor (_dg .CellBorderSideTop ,*_fbeb );};};if _daba :=_dfae .LnR ;
_daba !=nil {_beg ,_adab ,_acgd :=_deec .getBorderStyle (_daba );_deef .SetBorder (_dg .CellBorderSideRight ,_beg ,_acgd );if _adab !=nil &&*_adab !=nil {_deef .SetSideBorderColor (_dg .CellBorderSideRight ,*_adab );};};if _fbc :=_dfae .LnB ;_fbc !=nil {_ecbg ,_fbed ,_bbag :=_deec .getBorderStyle (_fbc );
_deef .SetBorder (_dg .CellBorderSideBottom ,_ecbg ,_bbag );if _fbed !=nil &&*_fbed !=nil {_deef .SetSideBorderColor (_dg .CellBorderSideBottom ,*_fbed );};};if _bebd :=_dfae .MarLAttr ;_bebd !=nil {_fddc =float64 (_ef .FromSTCoordinate32 (*_bebd ));};
switch _dfae .AnchorAttr {case _aab .ST_TextAnchoringTypeT :_eebc =_dg .CellVerticalAlignmentTop ;case _aab .ST_TextAnchoringTypeB :_eebc =_dg .CellVerticalAlignmentBottom ;};if _dfae .NoFill ==nil {if _fgdd :=_dfae .SolidFill ;_fgdd !=nil {_ccbe ,_ :=_deec .getColorFromSolidFill (_fgdd );
_deef .SetBackgroundColor (_ccbe );};};if _gefg :=_dfae .MarBAttr ;_gefg !=nil {_caa =float64 (_ef .FromSTCoordinate32 (*_gefg ));};if _cae :=_dfae .MarTAttr ;_cae !=nil {_cfge =float64 (_ef .FromSTCoordinate32 (*_cae ));};};_deef .SetVerticalAlignment (_eebc );
_deef .SetIndent (_fddc );var _gcfc float64 ;if _gfga :=_gcb .TxBody ;_gfga !=nil {_bbff :=_deec .makePdfDivisionFromTxBody (_gfga ,_gcaee );_gcfc =_bbff .Height ()+_cfge +_caa ;_deef .SetContent (_bbff );};return _gcfc ;};func (_bcbg *convertContext )makePdfImageFromBlipFill (_ccgf *_aab .CT_BlipFillProperties ,_cfdf bool )(*_dg .Image ,[]*_aab .CT_BlipChoice ,error ){if _gbac :=_ccgf .Blip ;
_gbac !=nil {if _ebce :=_gbac .EmbedAttr ;_ebce !=nil {var _gdc _d .ImageRef ;var _ecee bool ;if _cfdf {_gdc ,_ecee =_bcbg ._fff .GetLayoutImageByRelID (*_ebce );}else {_gdc ,_ecee =_bcbg ._fff .GetImageByRelID (*_ebce );};if _ecee {_cfedb ,_ddaa :=_b .Open (_gdc .Path ());
if _ddaa !=nil {_ed .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_ddaa );return nil ,nil ,_ddaa ;};defer _cfedb .Close ();_gfcg ,_ ,_ddaa :=_a .Decode (_cfedb );if _ddaa !=nil {_ed .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_ddaa );
return nil ,nil ,_ddaa ;};if _baff :=_ccgf .SrcRect ;_baff !=nil {_affae :=_gfcg .Bounds ().Size ();_ecce :=_affae .X ;_efag :=_affae .Y ;var _ffad ,_abgbf ,_gcaa ,_daec int ;var _fbef bool ;if _gefe :=_baff .LAttr ;_gefe !=nil {_ffad =int (float64 (_ecce )*_ef .FromSTPercentage (_gefe ));
_fbef =true ;}else {_ffad =0;};if _bcbf :=_baff .TAttr ;_bcbf !=nil {_gcaa =int (float64 (_efag )*_ef .FromSTPercentage (_bcbf ));_fbef =true ;}else {_gcaa =0;};if _bcbd :=_baff .RAttr ;_bcbd !=nil {_abgbf =int (float64 (_ecce )*(1-_ef .FromSTPercentage (_bcbd )));
_fbef =true ;}else {_abgbf =_ecce ;};if _bedg :=_baff .BAttr ;_bedg !=nil {_daec =int (float64 (_efag )*(1-_ef .FromSTPercentage (_bedg )));_fbef =true ;}else {_daec =_efag ;};if _fbef {_gfcg =_ef .CropImageByRect (_gfcg ,_a .Rect (_ffad ,_gcaa ,_abgbf +1,_daec +1));
};};_ecgd ,_ddaa :=_bcbg ._gbad .NewImageFromGoImage (_gfcg );_ecgd .SetEncoder (_fg .NewFlateEncoder ());if _ddaa !=nil {_ed .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_ddaa );
return nil ,nil ,_ddaa ;};return _ecgd ,_gbac .Choice ,nil ;};};};return nil ,nil ,nil ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_ef .FontStyle ;func _aaec (_ebb *_ab .CT_CommonSlideData ,_dgdb _ab .ST_PlaceholderType ,_gagc *uint32 ,_ffgd bool )(*_aab .CT_Transform2D ,*_aab .CT_TextBody ,*bool ,*bool ){if _ebb !=nil &&(_dgdb !=_ab .ST_PlaceholderTypeUnset ||!_ffgd ){if _fgde :=_ebb .SpTree ;
_fgde !=nil {for _ ,_dgab :=range _fgde .Choice {if _dgab !=nil {for _ ,_dfaa :=range _dgab .Sp {if _dfaa !=nil {_eddc ,_bfg :=_ffbc (_dfaa );if _dgdb ==_eddc {if (_ffgd &&_bfg ==nil )||(!_ffgd &&_bfg !=nil &&*_bfg ==*_gagc ){var _fbgc *_aab .CT_Transform2D ;
if _dfaa .SpPr !=nil {_fbgc =_dfaa .SpPr .Xfrm ;};_eaf :=_dgdb ==_ab .ST_PlaceholderTypeTitle ||_dgdb ==_ab .ST_PlaceholderTypeCtrTitle ;_aace :=!_eaf &&_dgdb !=_ab .ST_PlaceholderTypeUnset ;return _fbgc ,_dfaa .TxBody ,&_eaf ,&_aace ;};};};};};};};};return nil ,nil ,nil ,nil ;
};func (_eeca *convertContext )getShapeFromBlipFill (_ggaf *_aab .CT_BlipFillProperties ,_ged ,_edaa ,_eba ,_cge float64 ,_acee bool )_dg .Drawable {_fffg ,_fbbf ,_dbaa :=_eeca .makePdfImageFromBlipFill (_ggaf ,_acee );if _dbaa !=nil {_ed .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_dbaa );
return nil ;};if _fffg ==nil {return nil ;};if _gfb :=_ggaf .Tile ;_gfb !=nil {_fffg =_eeca .tileImage (_fffg ,_ggaf .Tile ,_eba ,_cge );};if _ggfgg :=_ggaf .Stretch ;_ggfgg !=nil {_fffg ,_ged ,_edaa =_eeca .stretchImage (_fffg ,_ggaf .Stretch ,_ged ,_edaa ,_eba ,_cge );
};if len (_fbbf )==0{_fffg .SetPos (_ged ,_edaa );return _fffg ;};_fffg =_eeca .applyBlipEffectsOnImg (_fffg ,_ged ,_edaa ,_fbbf );_fffg .SetPos (_ged ,_edaa );return _fffg ;};func (_bcce *line )moveRight (_gfc float64 ){for _ ,_fbge :=range _bcce ._dbc {_fbge ._bgaa +=_gfc ;
};};func (_fbcb *textboxContext )adjustHeights (_ccbg float64 ){if _fbcb ._bgdd ._aaed < _ccbg {_fbcb ._aeaa ._acga +=(_ccbg -_fbcb ._bgdd ._aaed );_fbcb ._bgdd ._aaed =_ccbg ;};};type line struct{_eedb float64 ;_ggfb float64 ;_edbe float64 ;_eef float64 ;
_aaed float64 ;_dbc []*word ;};func (_ebfc *convertContext )getBorderStyle (_dffbf *_aab .CT_LineProperties )(_dg .CellBorderStyle ,*_dg .Color ,float64 ){if _dffbf ==nil ||_dffbf .NoFill !=nil {return _dg .CellBorderStyleNone ,nil ,0;};var _gefdd _dg .Color ;
if _adce :=_dffbf .SolidFill ;_adce !=nil {_gefdd ,_ =_ebfc .getColorFromSolidFill (_adce );};_cggf :=0.0;if _gfgd :=_dffbf .WAttr ;_gfgd !=nil {_cggf =_efc .FromEMU (int64 (*_gfgd ));};return _dg .CellBorderStyleSingle ,&_gefdd ,_cggf ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_ag .Presentation )*_dg .Creator {_cdc :=pr .X ().SldSz ;_abb :=_efc .FromEMU (int64 (_cdc .CxAttr ));_db :=_efc .FromEMU (int64 (_cdc .CyAttr ));_ee :=_dg .PageSize {_abb ,_db };_be :=_dg .New ();_be .SetPageSize (_ee );var _ce *_aab .Theme ;
if len (pr .Themes ())> 0{_ce =pr .Themes ()[0];};for _ ,_bf :=range pr .Slides (){if _bf .X ()==nil {continue ;};_abd :=&convertContext {_gbad :_be ,_fff :&_bf ,_dbag :_bf .GetSlideLayout (),_cbfe :pr .SlideMasters ()[0].X (),_ece :pr ,_fdc :_ce ,_feae :_bf .X ().ClrMapOvr ,_caf :_ee [1],_ccaa :_ee [0]};
_abd .extractDefaultProperties ();_abd .makeSlide ();_abd .drawSlide ();};return _be ;};func (_fee *textboxContext )alignVertically (_cegb _aab .ST_TextAnchoringType ){_fee .alignParagraphsVertically (_cegb );_fee .alignSymbolsVertically ();};func _bfac (_cafc *_aab .CT_AdjPoint2D )(float64 ,float64 ){var _dcace ,_bcec float64 ;
_gbgg ,_dbf :=_cafc .XAttr ,_cafc .YAttr ;if _daed :=_gbgg .ST_Coordinate ;_daed !=nil {_dcace =_efc .FromEMU (_ef .FromSTCoordinate (*_daed ));};if _ceda :=_dbf .ST_Coordinate ;_ceda !=nil {_bcec =_efc .FromEMU (_ef .FromSTCoordinate (*_ceda ));};return _dcace ,_bcec ;
};func _ffc (_gec ,_ecbgf *_aab .CT_TextParagraphProperties )*_aab .CT_TextParagraphProperties {_cbcb :=_aab .NewCT_TextParagraphProperties ();if _gec !=nil {*_cbcb =*_gec ;};if _ecbgf ==nil {return _cbcb ;};if _cbcb .MarLAttr ==nil {_cbcb .MarLAttr =_ecbgf .MarLAttr ;
};if _cbcb .MarRAttr ==nil {_cbcb .MarRAttr =_ecbgf .MarRAttr ;};if _cbcb .LvlAttr ==nil {_cbcb .LvlAttr =_ecbgf .LvlAttr ;};if _cbcb .IndentAttr ==nil {_cbcb .IndentAttr =_ecbgf .IndentAttr ;};if _cbcb .AlgnAttr ==_aab .ST_TextAlignTypeUnset {_cbcb .AlgnAttr =_ecbgf .AlgnAttr ;
};if _cbcb .DefTabSzAttr ==nil {_cbcb .DefTabSzAttr =_ecbgf .DefTabSzAttr ;};if _cbcb .RtlAttr ==nil {_cbcb .RtlAttr =_ecbgf .RtlAttr ;};if _cbcb .EaLnBrkAttr ==nil {_cbcb .EaLnBrkAttr =_ecbgf .EaLnBrkAttr ;};if _cbcb .FontAlgnAttr ==_aab .ST_TextFontAlignTypeUnset {_cbcb .FontAlgnAttr =_ecbgf .FontAlgnAttr ;
};if _cbcb .LatinLnBrkAttr ==nil {_cbcb .LatinLnBrkAttr =_ecbgf .LatinLnBrkAttr ;};if _cbcb .HangingPunctAttr ==nil {_cbcb .HangingPunctAttr =_ecbgf .HangingPunctAttr ;};if _cbcb .LnSpc ==nil {_cbcb .LnSpc =_ecbgf .LnSpc ;};if _cbcb .SpcBef ==nil {_cbcb .SpcBef =_ecbgf .SpcBef ;
};if _cbcb .SpcAft ==nil {_cbcb .SpcAft =_ecbgf .SpcAft ;};if _cbcb .BuClrTx ==nil {_cbcb .BuClrTx =_ecbgf .BuClrTx ;};if _cbcb .BuClr ==nil {_cbcb .BuClr =_ecbgf .BuClr ;};if _cbcb .BuSzTx ==nil {_cbcb .BuSzTx =_ecbgf .BuSzTx ;};if _cbcb .BuSzPct ==nil {_cbcb .BuSzPct =_ecbgf .BuSzPct ;
};if _cbcb .BuSzPts ==nil {_cbcb .BuSzPts =_ecbgf .BuSzPts ;};if _cbcb .BuFontTx ==nil {_cbcb .BuFontTx =_ecbgf .BuFontTx ;};if _cbcb .BuFont ==nil {_cbcb .BuFont =_ecbgf .BuFont ;};if _cbcb .BuNone ==nil {_cbcb .BuNone =_ecbgf .BuNone ;};if _cbcb .BuAutoNum ==nil {_cbcb .BuAutoNum =_ecbgf .BuAutoNum ;
};if _cbcb .BuChar ==nil {_cbcb .BuChar =_ecbgf .BuChar ;};if _cbcb .BuBlip ==nil {_cbcb .BuBlip =_ecbgf .BuBlip ;};if _cbcb .TabLst ==nil {_cbcb .TabLst =_ecbgf .TabLst ;};if _cbcb .ExtLst ==nil {_cbcb .ExtLst =_ecbgf .ExtLst ;};_cbcb .DefRPr =_bgfa (_cbcb .DefRPr ,_ecbgf .DefRPr );
return _cbcb ;};func (_ddc *convertContext )makePdfBlockFromTable (_aag *_aab .Tbl ,_fbd float64 )*_dg .Table {_bcbc :=_aag .TblGrid ;if _bcbc ==nil {return nil ;};_afea :=len (_bcbc .GridCol );if _afea ==0{return nil ;};_bdgae :=[]float64 {};_efb :=0.0;
for _ ,_egdf :=range _bcbc .GridCol {_afc :=_efc .FromEMU (_ef .FromSTCoordinate (_egdf .WAttr ));_bdgae =append (_bdgae ,_afc );_efb +=_afc ;};_fdf :=[]float64 {};for _cgg :=0;_cgg < _afea ;_cgg ++{_fdf =append (_fdf ,_bdgae [_cgg ]/_efb );};_dgcd :=_ddc ._gbad .NewTable (_afea );
_dgcd .SetColumnWidths (_fdf ...);_agbb :=_aag .TblPr ;var _agff *_aab .CT_TableStyle ;if _ceff :=_agbb .Choice ;_ceff !=nil {if _ceff .TableStyle !=nil {_agff =_ceff .TableStyle ;}else if _ceff .TableStyleId !=nil {_agff =_ddc ._ece .GetTableStyleById (*_ceff .TableStyleId );
};};_cedf :=_aab .NewCT_TablePartStyle ();_cedf .TcStyle =_aab .NewCT_TableStyleCellStyle ();_cedf .TcTxStyle =_aab .NewCT_TableStyleTextStyle ();if _agff !=nil {if _agff .WholeTbl !=nil {*_cedf =*_agff .WholeTbl ;};if _agff .TblBg !=nil {if _cedf .TcStyle .Fill ==nil {_cedf .TcStyle .Fill =_agff .TblBg .Fill ;
};};};if _cedf .TcStyle .Fill ==nil {_cedf .TcStyle .Fill =_aab .NewCT_FillProperties ();_cedf .TcStyle .Fill .NoFill =_agbb .NoFill ;_cedf .TcStyle .Fill .SolidFill =_agbb .SolidFill ;};_egad :=len (_aag .Tr );for _dcag ,_dfbe :=range _aag .Tr {_dbg :=_dcag ==0;
_gag :=_dcag ==_egad -1;_cadd :=_dcag %2==0;_gbb :=len (_dfbe .Tc );var _gcgc *_aab .CT_TablePartStyle ;if _dbg {_gcgc =_agff .FirstRow ;}else if _cadd {_gcgc =_agff .Band2H ;}else {_gcgc =_agff .Band1H ;};var _fbaf float64 ;for _bddc ,_acca :=range _dfbe .Tc {_adgd :=_bddc ==0;
_geea :=_bddc ==_gbb -1;_baeb :=_bddc %2==0;var _ddbd *_aab .CT_TablePartStyle ;if _adgd {_ddbd =_agff .FirstCol ;}else if _baeb {_ddbd =_agff .Band2V ;}else {_ddbd =_agff .Band1V ;};_bef :=_agab (_agab (_ddbd ,_gcgc ),_cedf );_abbb :=_ddc .addCellToTable (_dgcd ,_acca ,_bef ,_fbd *_fdf [_bddc ],_dbg ,_gag ,_adgd ,_geea );
if _abbb > _fbaf {_fbaf =_abbb ;};};_aecf :=_efc .FromEMU (_ef .FromSTCoordinate (_dfbe .HAttr ));if _aecf < _fbaf {_aecf =_fbaf ;};if _aecf < _ebfd (4){_aecf =_ebfd (4);};_dgcd .SetRowHeight (_dgcd .CurRow (),_aecf );};return _dgcd ;};func _agab (_cgb ,_baef *_aab .CT_TablePartStyle )*_aab .CT_TablePartStyle {_gbda :=_aab .NewCT_TablePartStyle ();
if _cgb !=nil {*_gbda =*_cgb ;};if _baef ==nil {return _gbda ;};if _gbda .TcTxStyle ==nil {_gbda .TcTxStyle =_baef .TcTxStyle ;}else {_gbda .TcTxStyle =_ddbf (_gbda .TcTxStyle ,_baef .TcTxStyle );};if _gbda .TcStyle ==nil {_gbda .TcStyle =_baef .TcStyle ;
}else {_gbda .TcStyle =_gbead (_gbda .TcStyle ,_baef .TcStyle );};return _gbda ;};func (_bfcb *convertContext )renderCurrentStateToGoImage ()(_a .Image ,error ){_acf :=_ef .MakeTempCreator (_bfcb ._ccaa ,_bfcb ._caf );_acf .NewPage ();for _ ,_geda :=range _bfcb ._geed {if _geda !=nil {_acf .MoveTo (0,0);
_acf .Draw (_geda );};};_cabd ,_cfca :=_ef .GetPageFromCreator (_acf );if _cfca !=nil {return nil ,_cfca ;};return _cd .NewImageDevice ().Render (_cabd );};type paragraph struct{_cefeg float64 ;_dcagf float64 ;_eaa float64 ;_aca float64 ;_egbb float64 ;
_efda float64 ;_aeec float64 ;_acga float64 ;_efaa _aab .ST_TextAlignType ;_agecc float64 ;_dbb bool ;_dbgc []*line ;};func (_cege *convertContext )getShapes (_aga *_ab .CT_Shape )[]_dg .Drawable {_ccfe :=[]_dg .Drawable {};_acb :=_aga .SpPr ;if _acb ==nil {return _ccfe ;
};var _ccc bool ;if _gfe :=_aga .UseBgFillAttr ;_gfe !=nil {_ccc =*_gfe ;};_gaa ,_bda ,_gca ,_egac ,_cad ,_cdcg ,_fea :=_cege .getShapesFromSpPr (_acb ,_aga .Style ,_ccc ,0.0,0.0);_ccfe =append (_ccfe ,_gaa ...);if _dff :=_aga .TxBody ;_dff !=nil {_agea ,_cfa ,_aacg ,_gdb ,_agdc :=_cege .getPhData (_aga );
if _agea !=nil &&!_fea {_bda ,_gca ,_egac ,_cad =_ef .GetDataFromXfrm (_agea );};_bfbc ,_dda :=_cege .makePdfBlockFromTxBody (_dff ,_cfa ,_aacg ,_egac ,_cad ,_cdcg ,_gdb ,_agdc );if _dda !=nil {_ed .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_dda );
}else if _bfbc !=nil {_bfbc .SetPos (_bda ,_gca );_ccfe =append (_ccfe ,_bfbc );};};return _ccfe ;};func (_eca *textboxContext )addCurrentParagraph (){_eca ._cfb =_eca ._aeaa ._aeec +_eca ._aeaa ._dcagf +_eca ._aeaa ._acga +_eca ._aeaa ._eaa ;_eca ._abgb =append (_eca ._abgb ,_eca ._aeaa );
_eca .alignParagraph ();};func (_fece *convertContext )getColorFromSolidFill (_cfbd *_aab .CT_SolidColorFillProperties )(_dg .Color ,float64 ){if _cfbd ==nil {return nil ,1;};var _dbce string ;_becg :=1.0;if _fdba :=_cfbd .SrgbClr ;_fdba !=nil {_dbce =_fdba .ValAttr ;
_becg =_ef .GetOpacityFromColorTransform (_fdba .EG_ColorTransform );}else if _ccff :=_cfbd .SchemeClr ;_ccff !=nil {_dbce =_ef .GetColorStringFromDmlColor (_fece ._fff .GetColorBySchemeColor (_ccff .ValAttr ));_dbce =_ef .AdjustColor (_dbce ,_ccff .EG_ColorTransform );
_becg =_ef .GetOpacityFromColorTransform (_ccff .EG_ColorTransform );};if _dbce !=""{_dfdd :=_dg .ColorRGBFromHex ("\u0023"+_dbce );return _dfdd ,_becg ;};return nil ,1;};func _edbc (_eccf *_aab .CT_TextCharacterProperties ,_bbgf *_aab .CT_TableStyleTextStyle )*_aab .CT_TextCharacterProperties {_baeg :=_aab .NewCT_TextCharacterProperties ();
if _eccf !=nil {*_baeg =*_eccf ;};if _bbgf ==nil {return _baeg ;};if _baeg .BAttr ==nil &&_bbgf .BAttr !=_aab .ST_OnOffStyleTypeUnset {_cadf :=_bbgf .BAttr ==_aab .ST_OnOffStyleTypeOn ;_baeg .BAttr =&_cadf ;};if _baeg .IAttr ==nil &&_bbgf .IAttr !=_aab .ST_OnOffStyleTypeUnset {_cbba :=_bbgf .IAttr ==_aab .ST_OnOffStyleTypeOn ;
_baeg .IAttr =&_cbba ;};if _baeg .NoFill ==nil &&_baeg .SolidFill ==nil {_baeg .SolidFill =_aab .NewCT_SolidColorFillProperties ();_baeg .SolidFill .ScrgbClr =_bbgf .ScrgbClr ;_baeg .SolidFill .SrgbClr =_bbgf .SrgbClr ;_baeg .SolidFill .HslClr =_bbgf .HslClr ;
_baeg .SolidFill .SysClr =_bbgf .SysClr ;_baeg .SolidFill .SchemeClr =_bbgf .SchemeClr ;_baeg .SolidFill .PrstClr =_bbgf .PrstClr ;};if _bbe :=_bbgf .Font ;_bbe !=nil &&_baeg .Latin ==nil &&_baeg .Ea ==nil &&_baeg .Cs ==nil {_baeg .Latin =_bbe .Latin ;
_baeg .Ea =_bbe .Ea ;_baeg .Cs =_bbe .Cs ;};return _baeg ;};var _edc =_ebfd (1.9);func (_eafg *convertContext )applyBlipEffectsOnImg (_faaee *_dg .Image ,_dcba ,_cdae float64 ,_eceg []*_aab .CT_BlipChoice )*_dg .Image {if len (_eceg )==0{return _faaee ;
};_faaee .SetPos (_dcba ,_cdae );_egggg ,_fga :=_eafg .renderPageWithDrawableToGoImage (_faaee );if _fga !=nil {_ed .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_fga );
return _faaee ;};_geec ,_fga :=_eafg .renderCurrentStateToGoImage ();if _fga !=nil {_ed .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_fga );
return _faaee ;};_dgfa :=_egggg .Bounds ();_aaceb :=_a .NewRGBA (_dgfa );_cdbc ,_edaf :=_faaee .Width (),_faaee .Height ();for _ ,_afdac :=range _eceg {for _ ,_geb :=range _afdac .AlphaModFix {if _dbge :=_geb .AmtAttr ;_dbge !=nil {if _cfbdc :=_dbge .ST_PositivePercentageDecimal ;
_cfbdc !=nil {_bgbd :=uint8 (255*(*_cfbdc )/100000);_bbagb :=_a .NewUniform (_ge .Alpha {_bgbd });_e .Draw (_aaceb ,_dgfa ,_geec ,_a .Point {0,0},_e .Src );_e .DrawMask (_aaceb ,_dgfa ,_egggg ,_a .Point {0,0},_bbagb ,_a .Point {0,0},_e .Over );};};};};
_faaf :=_a .Rect (int (_dcba ),int (_cdae ),int (_dcba +_cdbc )+1,int (_cdae +_edaf )+1);_bedd :=_ef .CropImageByRect (_aaceb ,_faaf );_bbaga ,_fga :=_eafg ._gbad .NewImageFromGoImage (_bedd );if _fga !=nil {_ed .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_fga );
return _faaee ;};return _bbaga ;};func (_ec *convertContext )makePdfBlockFromChart (_aad *_cg .Chart ,_da ,_cb float64 )(*_dg .Block ,error ){_gg :=_aad .CT_RelId .IdAttr ;_abf :=_ec ._fff .GetChartSpaceByRelId (_gg );if _abf ==nil {return nil ,_g .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");
};var _dae *_aab .Theme ;_efe :=_ec ._ece .Themes ();if len (_efe )> 0{_dae =_efe [0];};return _ef .MakeBlockFromChartSpace (_abf ,_da ,_cb ,_dae );};func (_dag *textboxContext )alignParagraphsVertically (_fad _aab .ST_TextAnchoringType ){if _fad ==_aab .ST_TextAnchoringTypeT {return ;
};_dgb :=0.0;for _ ,_cfed :=range _dag ._abgb {_dgb +=_cfed ._dcagf +_cfed ._acga +_cfed ._eaa ;};var _bgbg float64 ;switch _fad {case _aab .ST_TextAnchoringTypeCtr :_bgbg =(_dag ._dec -_dgb )/2;case _aab .ST_TextAnchoringTypeB :_bgbg =_dag ._dec -_dgb ;
};for _ ,_fgg :=range _dag ._abgb {_fgg ._aeec +=_bgbg ;};};func _fgfaf (_ceb ,_dfafd *_aab .CT_TextBodyProperties )*_aab .CT_TextBodyProperties {_fgcbd :=_aab .NewCT_TextBodyProperties ();if _ceb !=nil {*_fgcbd =*_ceb ;};if _dfafd ==nil {return _fgcbd ;
};if _fgcbd .RotAttr ==nil {_fgcbd .RotAttr =_dfafd .RotAttr ;};if _fgcbd .SpcFirstLastParaAttr ==nil {_fgcbd .SpcFirstLastParaAttr =_dfafd .SpcFirstLastParaAttr ;};if _fgcbd .VertOverflowAttr ==_aab .ST_TextVertOverflowTypeUnset {_fgcbd .VertOverflowAttr =_dfafd .VertOverflowAttr ;
};if _fgcbd .HorzOverflowAttr ==_aab .ST_TextHorzOverflowTypeUnset {_fgcbd .HorzOverflowAttr =_dfafd .HorzOverflowAttr ;};if _fgcbd .VertAttr ==_aab .ST_TextVerticalTypeUnset {_fgcbd .VertAttr =_dfafd .VertAttr ;};if _fgcbd .WrapAttr ==_aab .ST_TextWrappingTypeUnset {_fgcbd .WrapAttr =_dfafd .WrapAttr ;
};if _fgcbd .LInsAttr ==nil {_fgcbd .LInsAttr =_dfafd .LInsAttr ;};if _fgcbd .TInsAttr ==nil {_fgcbd .TInsAttr =_dfafd .TInsAttr ;};if _fgcbd .RInsAttr ==nil {_fgcbd .RInsAttr =_dfafd .RInsAttr ;};if _fgcbd .BInsAttr ==nil {_fgcbd .BInsAttr =_dfafd .BInsAttr ;
};if _fgcbd .NumColAttr ==nil {_fgcbd .NumColAttr =_dfafd .NumColAttr ;};if _fgcbd .SpcColAttr ==nil {_fgcbd .SpcColAttr =_dfafd .SpcColAttr ;};if _fgcbd .RtlColAttr ==nil {_fgcbd .RtlColAttr =_dfafd .RtlColAttr ;};if _fgcbd .AnchorAttr ==_aab .ST_TextAnchoringTypeUnset {_fgcbd .AnchorAttr =_dfafd .AnchorAttr ;
};if _fgcbd .AnchorCtrAttr ==nil {_fgcbd .AnchorCtrAttr =_dfafd .AnchorCtrAttr ;};if _fgcbd .ForceAAAttr ==nil {_fgcbd .ForceAAAttr =_dfafd .ForceAAAttr ;};if _fgcbd .UprightAttr ==nil {_fgcbd .UprightAttr =_dfafd .UprightAttr ;};if _fgcbd .CompatLnSpcAttr ==nil {_fgcbd .CompatLnSpcAttr =_dfafd .CompatLnSpcAttr ;
};if _fgcbd .PrstTxWarp ==nil {_fgcbd .PrstTxWarp =_dfafd .PrstTxWarp ;};if _fgcbd .NoAutofit ==nil {_fgcbd .NoAutofit =_dfafd .NoAutofit ;};if _fgcbd .NormAutofit ==nil {_fgcbd .NormAutofit =_dfafd .NormAutofit ;};if _fgcbd .SpAutoFit ==nil {_fgcbd .SpAutoFit =_dfafd .SpAutoFit ;
};if _fgcbd .Scene3d ==nil {_fgcbd .Scene3d =_dfafd .Scene3d ;};if _fgcbd .Sp3d ==nil {_fgcbd .Sp3d =_dfafd .Sp3d ;};if _fgcbd .FlatTx ==nil {_fgcbd .FlatTx =_dfafd .FlatTx ;};if _fgcbd .ExtLst ==nil {_fgcbd .ExtLst =_dfafd .ExtLst ;};return _fgcbd ;};
func _accf (_fecf *bool )bool {return _fecf !=nil &&*_fecf };func (_aead *convertContext )getInfoFromLn (_edac *_aab .CT_LineProperties )(_dg .Color ,float64 ,float64 ){if _edac ==nil ||_edac .NoFill !=nil {return nil ,0,0;};var _afdc float64 ;_fdfd ,_gabg :=_aead .getColorFromSolidFill (_edac .SolidFill );
if _gabf :=_edac .WAttr ;_gabf !=nil {_afdc =_efc .FromEMU (int64 (*_gabf ));}else {_afdc =1;};return _fdfd ,_afdc ,_gabg ;};func (_bde *textboxContext )newWord (){_bde ._deea =&word {_fbcf :true ,_bgaa :_bde ._bgdd ._eef }};var _gbec =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
type background struct{_gbc _dg .Color ;_ecdb float64 ;_ceac *_aab .CT_BlipFillProperties ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_eg .PdfFont ){_ef .RegisterFont (name ,style ,font );};type symbol struct{_bdb string ;_dcbf float64 ;_fabd float64 ;_bab float64 ;_cfee float64 ;_dfcf float64 ;_eagf *_dg .TextStyle ;_bggg string ;
_ggdf bool ;_aagb bool ;_edcb bool ;};func (_efea *convertContext )getShapesFromSpPr (_bbg *_aab .CT_ShapeProperties ,_fafd *_aab .CT_ShapeStyle ,_fgcb bool ,_dcf float64 ,_egf float64 )([]_dg .Drawable ,float64 ,float64 ,float64 ,float64 ,_dg .Color ,bool ){_acc :=[]_dg .Drawable {};
var _ecb ,_abfb ,_edcc ,_cag ,_abde float64 ;var _cgd ,_dgc ,_aef ,_affa _dg .Color ;var _aaf *_aab .CT_BlipFillProperties ;_cgf ,_aefa :=1.0,1.0;if _fafd !=nil {_cgd ,_dgc ,_affa =_efea .getStyleColors (_fafd );};if _dga :=_bbg .Ln ;_dga !=nil {if _dga .NoFill !=nil {_aef ,_abde =nil ,0;
}else {_aef ,_abde ,_cgf =_efea .getInfoFromLn (_dga );if _aef ==nil {_aef =_affa ;};};};if _bbg .NoFill !=nil {_dgc ,_aefa =nil ,0;}else if _fgcb {_dgc =_efea ._ecbce ._gbc ;_aefa =_efea ._ecbce ._ecdb ;_aaf =_efea ._ecbce ._ceac ;}else if _aaa :=_bbg .SolidFill ;
_aaa !=nil {_dgc ,_aefa =_efea .getColorFromSolidFill (_aaa );};var _aba bool ;if _gad :=_bbg .Xfrm ;_gad !=nil {_ecb ,_abfb ,_edcc ,_cag =_ef .GetDataFromXfrm (_gad );_ecb +=_dcf ;_abfb +=_egf ;_aba =true ;};if _fcd :=_bbg .CustGeom ;_fcd !=nil {_dfaf :=[]_ad .Point {};
_dccc ,_ccbf :=1.0,1.0;if _dba :=_fcd .PathLst ;_dba !=nil {for _ ,_ebc :=range _dba .Path {if _ebc !=nil {if _ccd :=_ebc .WAttr ;_ccd !=nil {_dccc =_edcc /_efc .FromEMU (*_ccd );};if _daf :=_ebc .HAttr ;_daf !=nil {_ccbf =_cag /_efc .FromEMU (*_daf );
};for _ ,_gdee :=range _ebc .Close {if _gdee !=nil {};};for _ ,_bgd :=range _ebc .MoveTo {if _bgd !=nil &&_bgd .Pt !=nil {_bcf ,_fgcf :=_bfac (_bgd .Pt );_dfaf =append (_dfaf ,_ad .Point {X :_bcf *_dccc +_ecb ,Y :_fgcf *_ccbf +_abfb });};};for _ ,_abba :=range _ebc .LnTo {if _abba !=nil &&_abba .Pt !=nil {_ccdd ,_agb :=_bfac (_abba .Pt );
_dfaf =append (_dfaf ,_ad .Point {X :_ccdd *_dccc +_ecb ,Y :_agb *_ccbf +_abfb });};};_bba :=_efea ._gbad .NewPolygon ([][]_ad .Point {_dfaf });_bba .SetFillColor (_dgc );_bba .SetFillOpacity (_aefa );_bba .SetBorderWidth (_abde );if _aef !=nil {_bba .SetBorderColor (_aef );
_bba .SetBorderOpacity (_cgf );};_acc =append (_acc ,_bba );};};};};if _abfe :=_bbg .PrstGeom ;_abfe !=nil {switch _abfe .PrstAttr {case _aab .ST_ShapeTypeRect :if _aaf !=nil {_dca :=_efea .getShapeFromBlipFill (_aaf ,_ecb ,_abfb ,_edcc ,_cag ,false );
_acc =append (_acc ,_dca );}else {_edbg :=_efea ._gbad .NewRectangle (_ecb ,_abfb ,_edcc ,_cag );_baf :=_dgc !=nil &&_aefa > 0;if _baf {_edbg .SetFillColor (_dgc );_edbg .SetFillOpacity (_aefa );};_bgb :=_aef !=nil &&_cgf > 0&&_abde > 0;if _bgb {_edbg .SetBorderWidth (_abde );
_edbg .SetBorderColor (_aef );_edbg .SetBorderOpacity (_cgf );};if _baf ||_bgb {_acc =append (_acc ,_edbg );};};case _aab .ST_ShapeTypeLine :_aabc :=_efea ._gbad .NewLine (_ecb ,_abfb ,_ecb +_edcc ,_abfb +_cag );_aabc .SetLineWidth (_abde );if _aef !=nil {_aabc .SetColor (_aef );
};_acc =append (_acc ,_aabc );};};return _acc ,_ecb ,_abfb ,_edcc ,_cag ,_cgd ,_aba ;};type romanMatch struct{_cfeb int ;_gbbf string ;};func _gagd (_cbaadg ,_ggfa *_aab .CT_TextBody )(*_aab .CT_TextBodyProperties ,*_aab .CT_TextListStyle ){if _cbaadg ==nil &&_ggfa ==nil {return nil ,nil ;
};if _cbaadg ==nil {return _ggfa .BodyPr ,_ggfa .LstStyle ;};if _ggfa ==nil {return _cbaadg .BodyPr ,_cbaadg .LstStyle ;};_cac ,_caec :=_cbaadg .BodyPr ,_cbaadg .LstStyle ;_cgfb ,_dfcb :=_ggfa .BodyPr ,_ggfa .LstStyle ;_ebea :=_fgfaf (_cac ,_cgfb );_aeeg :=_dbgg (_caec ,_dfcb );
return _ebea ,_aeeg ;};func (_bd *convertContext )makeSlide (){_cba :=_bd ._fff .GetSlideLayout ().CSld ;if _cba !=nil {if _gef :=_cba .SpTree ;_gef !=nil {for _ ,_gd :=range _gef .Choice {if _gd !=nil {for _ ,_daee :=range _gd .Pic {if _daee !=nil {var _ga ,_ggc ,_bc ,_cf float64 ;
if _ceg :=_daee .SpPr ;_ceg !=nil {if _af :=_ceg .Xfrm ;_af !=nil {_ga ,_ggc ,_bc ,_cf =_ef .GetDataFromXfrm (_af );};};if _bb :=_daee .BlipFill ;_bb !=nil {_dgf :=_bd .getShapeFromBlipFill (_bb ,_ga ,_ggc ,_bc ,_cf ,true );_bd ._geed =append (_bd ._geed ,_dgf );
};};};};};};};_cba =_bd ._fff .X ().CSld ;if _cba ==nil {return ;};_ba :=&background {};if _fgc :=_cba .Bg ;_fgc !=nil {if _cbb :=_fgc .BgPr ;_cbb !=nil {if _cbb .NoFill ==nil {if _abda :=_cbb .SolidFill ;_abda !=nil {_egb ,_gc :=_bd .getColorFromSolidFill (_abda );
if _egb !=nil {_ba ._gbc =_egb ;_ba ._ecdb =_gc ;};}else if _bdd :=_cbb .BlipFill ;_bdd !=nil {_ba ._ceac =_bdd ;};};};};_bd ._ecbce =_ba ;if _dfb :=_cba .SpTree ;_dfb !=nil {for _ ,_eda :=range _dfb .Choice {if _eda !=nil {for _ ,_ada :=range _eda .Sp {if _ada !=nil {_fe :=_bd .getShapes (_ada );
_bd ._geed =append (_bd ._geed ,_fe ...);};};for _ ,_gaf :=range _eda .GraphicFrame {if _gaf !=nil {var _acg ,_fge ,_dc ,_aee float64 ;if _aec :=_gaf .Xfrm ;_aec !=nil {_acg ,_fge ,_dc ,_aee =_ef .GetDataFromXfrm (_aec );};if _dc ==0&&_aee ==0{_dc =_bd ._ccaa ;
_aee =_bd ._caf ;};if _bfd :=_gaf .Graphic ;_bfd !=nil {if _de :=_bfd .GraphicData ;_de !=nil {for _ ,_cfd :=range _de .Any {if _adaf ,_cea :=_cfd .(*_cg .Chart );_cea {_eag ,_ggb :=_bd .makePdfBlockFromChart (_adaf ,_dc ,_aee );if _ggb !=nil {_ed .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_ggb );
};if _eag !=nil {_eag .SetPos (_acg ,_fge );_bd ._geed =append (_bd ._geed ,_eag );};}else if _edb ,_fcb :=_cfd .(*_aab .Tbl );_fcb {_cfc :=_bd .makePdfBlockFromTable (_edb ,_dc );if _cfc !=nil {_bgae :=_dg .NewBlock (_dc ,_aee );_bgae .SetPos (_acg ,_fge );
_bgae .Draw (_cfc );_bd ._geed =append (_bd ._geed ,_bgae );};};};};};};};for _ ,_fcc :=range _eda .CxnSp {if _fcc !=nil {_eb :=_bd .getConnectors (_fcc );_bd ._geed =append (_bd ._geed ,_eb ...);};};for _ ,_cdg :=range _eda .GrpSp {_gf :=0.0;_afb :=0.0;
if _cdd :=_cdg .GrpSpPr .Xfrm ;_cdd !=nil {_gf ,_afb =_ef .GetGroupOffsetFromXfrm (_cdd );};for _ ,_edg :=range _cdg .Choice {for _ ,_ega :=range _edg .CxnSp {if _ega !=nil {_add :=_bd .getGroupConnectors (_ega ,_gf ,_afb );_bd ._geed =append (_bd ._geed ,_add ...);
};};};};for _ ,_agd :=range _eda .Pic {if _agd !=nil {var _afe ,_bfe ,_bge ,_ggd float64 ;if _efec :=_agd .SpPr ;_efec !=nil {if _cce :=_efec .Xfrm ;_cce !=nil {_afe ,_bfe ,_bge ,_ggd =_ef .GetDataFromXfrm (_cce );};};if _fec :=_agd .BlipFill ;_fec !=nil {_ca :=_bd .getShapeFromBlipFill (_fec ,_afe ,_bfe ,_bge ,_ggd ,false );
_bd ._geed =append (_bd ._geed ,_ca );};};};};};};};func _fbf (_dgcdf int ,_gbab bool )string {_aadbb :=(_dgcdf -1)/26+1;_ccba :=byte ((_dgcdf -1)%26);if _gbab {_ccba +=byte (65);}else {_ccba +=byte (97);};_fca :=_f .NewBuffer ([]byte {});for _aggf :=0;
_aggf < _aadbb ;_aggf ++{_fca .Write ([]byte {_ccba });};return _fca .String ();};func (_abc *textboxContext )addTextRun (_cee *_aab .EG_TextRun ,_ffb *_aab .CT_TextCharacterProperties ,_febc _dg .Color ,_fcad *prefixData ){if _befb :=_cee .Br ;_befb !=nil {_abc .addCurrentWordToParagraph ();
_abc .newLine ();_abc .newWord ();}else if _egc :=_cee .R ;_egc !=nil {var _cfba _dg .Color ;if _egc .RPr !=nil &&_egc .RPr .SolidFill !=nil {_cfba ,_ =_abc ._dcaa .getColorFromSolidFill (_egc .RPr .SolidFill );}else if _febc !=nil {_cfba =_febc ;}else if _ffb .SolidFill !=nil {_cfba ,_ =_abc ._dcaa .getColorFromSolidFill (_ffb .SolidFill );
}else {_cfba =_dg .ColorBlack ;};_eddg :=_bgfa (_egc .RPr ,_ffb );_fccd ,_dgg ,_fcdg ,_cdaf :=_abc ._dcaa .makeStyleFromRPr (_eddg );_fccd .Color =_cfba ;if _fcad !=nil {_abc .addPrefix (_fcad ,_fccd );};_fgeb :=_bce (_egc .T );for _ ,_ccdgg :=range _fgeb {_ccdgg ._eagf =_fccd ;
_ccdgg ._ggdf =_dgg ;_ccdgg ._aagb =_fcdg ;_ccdgg ._edcb =_cdaf ;if _eddg .CapAttr ==_aab .ST_TextCapsTypeAll {_ccdgg ._bdb =_aa .ToUpper (_ccdgg ._bdb );};_abc .addTextSymbol (_ccdgg );};};};func (_bgdc *convertContext )renderPageWithDrawableToGoImage (_gff _dg .Drawable )(_a .Image ,error ){_edgb :=_ef .MakeTempCreator (_bgdc ._ccaa ,_bgdc ._caf );
_edgb .NewPage ();_edgb .Draw (_gff );_ffda ,_gddf :=_ef .GetPageFromCreator (_edgb );if _gddf !=nil {return nil ,_gddf ;};return _cd .NewImageDevice ().Render (_ffda );};func _gea (_cdfd int ,_dbab bool )string {_gbce :=_f .NewBuffer ([]byte {});for _ ,_dgad :=range _gbec {for {if _cdfd < _dgad ._cfeb {break ;
};_gbce .WriteString (_dgad ._gbbf );_cdfd -=_dgad ._cfeb ;};};_febg :=_gbce .String ();if _dbab {_febg =_aa .ToUpper (_febg );};return _febg ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _ef .RegisterFontsFromDirectory (dirName )};func (_gfcc *convertContext )getPhData (_cdbd *_ab .CT_Shape )(*_aab .CT_Transform2D ,*_aab .CT_TextBodyProperties ,*_aab .CT_TextListStyle ,bool ,bool ){_eecaa ,_dfda :=_ffbc (_cdbd );
_bcfd :=_dfda ==nil ;_cecg ,_gbcc ,_bbc ,_gade :=_aaec (_gfcc ._cbfe .CSld ,_eecaa ,_dfda ,_bcfd );_fae ,_cggc ,_gaeg ,_ccde :=_aaec (_gfcc ._dbag .CSld ,_eecaa ,_dfda ,_bcfd );if _fae ==nil {_fae =_cecg ;};_dcfd ,_fgecc :=_gagd (_cggc ,_gbcc );var _faca ,_agad bool ;
if _gaeg ==nil {if _bbc !=nil {_faca =*_bbc ;};}else {_faca =*_gaeg ;};if _ccde ==nil {if _gade !=nil {_agad =*_gade ;};}else {_agad =*_ccde ;};return _fae ,_dcfd ,_fgecc ,_faca ,_agad ;};func (_ggegc *textboxContext )alignSymbolsVertically (){for _ ,_aebe :=range _ggegc ._abgb {for _ ,_gceg :=range _aebe ._dbgc {_ggec :=0.0;
for _ ,_fffa :=range _gceg ._dbc {for _ ,_ddgg :=range _fffa ._dfge {if _ddgg ._fabd > _ggec {_ggec =_ddgg ._fabd ;};};};for _ ,_efdc :=range _gceg ._dbc {for _ ,_dbbc :=range _efdc ._dfge {if _dbbc ._bab < _ggec {_dbbc ._cfee =_ggec -_dbbc ._bab ;};};
};};};};func (_ffdb *textboxContext )newParagraph (){_fdaf :=&paragraph {};_fdaf ._aeec =_ffdb ._cfb ;_ffdb ._aeaa =_fdaf ;};