//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_bb "bytes";_e "errors";_fa "github.com/unidoc/unioffice/v2/common";_ea "github.com/unidoc/unioffice/v2/common/logger";_bc "github.com/unidoc/unioffice/v2/common/tempstorage";_a "github.com/unidoc/unioffice/v2/internal/convertutils";
_eb "github.com/unidoc/unioffice/v2/measurement";_bbb "github.com/unidoc/unioffice/v2/presentation";_fb "github.com/unidoc/unioffice/v2/schema/soo/dml";_dea "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_eeg "github.com/unidoc/unioffice/v2/schema/soo/pml";
_da "github.com/unidoc/unipdf/v3/contentstream/draw";_g "github.com/unidoc/unipdf/v3/core";_edf "github.com/unidoc/unipdf/v3/creator";_de "github.com/unidoc/unipdf/v3/model";_cf "github.com/unidoc/unipdf/v3/render";_ee "image";_b "image/color";_ed "image/draw";
_cg "math";_c "strconv";_d "strings";);func (_fca *convertContext )stretchImage (_ggf *_edf .Image ,_gdae *_fb .CT_StretchInfoProperties ,_eaa ,_cec ,_gff ,_adbg float64 )(*_edf .Image ,float64 ,float64 ){_dfb :=_gdae .FillRect ;if _dfb ==nil {_ga :=_ggf .Width ()/_ggf .Height ();
_bag :=_gff /_adbg ;var _gaa ,_feb float64 ;if _ga > _bag {_feb =_adbg ;_gaa =_adbg *_ga ;}else {_gaa =_gff ;_feb =_gff /_ga ;};_ggf .Scale (_gaa /_ggf .Width (),_feb /_ggf .Height ());return _ggf ,_eaa ,_cec ;};var _badc ,_gab ,_aacf ,_bgf float64 ;if _gaae :=_dfb .LAttr ;
_gaae !=nil {_aacf =_a .FromSTPercentage (_gaae );};if _beee :=_dfb .TAttr ;_beee !=nil {_badc =_a .FromSTPercentage (_beee );};if _dcd :=_dfb .RAttr ;_dcd !=nil {_bgf =_a .FromSTPercentage (_dcd );};if _gad :=_dfb .BAttr ;_gad !=nil {_gab =_a .FromSTPercentage (_gad );
};_dcb :=_gff *(1-_aacf -_bgf );_ecf :=_adbg *(1-_badc -_gab );_ggf .Scale (_dcb /_ggf .Width (),_ecf /_ggf .Height ());return _ggf ,_eaa +_aacf *_gff ,_cec +_badc *_adbg ;};type prefixData struct{_gedc string ;_cacd bool ;_fdafe float64 ;_fgf float64 ;
};func (_dbgb *convertContext )makePdfBlockFromTxBody (_ffaa *_fb .CT_TextBody ,_afaf *_fb .CT_TextBodyProperties ,_fce *_fb .CT_TextListStyle ,_dfg ,_gca float64 ,_gaf _edf .Color ,_ebb ,_geg bool )(*_edf .Block ,error ){var _cfea *_fb .CT_TextParagraphProperties ;
if _eegb :=_ffaa .LstStyle ;_eegb !=nil {var _badg *_fb .CT_TextParagraphProperties ;if _eegb .Lvl1pPr !=nil {_badg =_eegb .Lvl1pPr ;};_cfea =_caad (_badg ,_eegb .DefPPr );};var _aee *_fb .CT_TextParagraphProperties ;if _cfea !=nil {if _ebb {_aee =_dbgb ._ebfb [0];
}else if _geg {_aee =_dbgb ._edfd [0];}else {_aee =_dbgb ._bea [0];};if _fce !=nil {_aee =_caad (_caad (_fce .Lvl1pPr ,_fce .DefPPr ),_aee );};_aee =_caad (_cfea ,_aee );}else {if _ebb {_aee =_dbgb ._gadc ;}else if _geg {_aee =_dbgb ._fbgb ;}else {_aee =_dbgb ._baa ;
};};_dfac ,_aef :=_ffg (2.5),_ffg (2.5);_cbab ,_feg :=_ffg (1.3),_ffg (1.3);_eed :=true ;_becd :=_fb .ST_TextAnchoringTypeT ;if _afaf !=nil {if _fef :=_afaf .AnchorAttr ;_fef !=_fb .ST_TextAnchoringTypeUnset {_becd =_fef ;};};if _adf :=_ffaa .BodyPr ;_adf !=nil {if _cbdd :=_adf .LInsAttr ;
_cbdd !=nil {_dfac =_eb .FromEMU (_a .FromSTCoordinate32 (*_cbdd ));};if _bcfc :=_adf .TInsAttr ;_bcfc !=nil {_cbab =_eb .FromEMU (_a .FromSTCoordinate32 (*_bcfc ));};if _geee :=_adf .RInsAttr ;_geee !=nil {_aef =_eb .FromEMU (_a .FromSTCoordinate32 (*_geee ));
};if _ecef :=_adf .BInsAttr ;_ecef !=nil {_feg =_eb .FromEMU (_a .FromSTCoordinate32 (*_ecef ));};_eed =_adf .WrapAttr !=_fb .ST_TextWrappingTypeNone ;if _fbed :=_adf .AnchorAttr ;_fbed !=_fb .ST_TextAnchoringTypeUnset {_becd =_adf .AnchorAttr ;};};_bgfb :=_a .MakeTempCreator (_dfg ,_gca );
_bgfb .SetPageMargins (_dfac ,_aef ,_cbab ,_feg );_egad :=&textboxContext {_fgd :_dbgb ,_gce :_eed ,_fddc :_dfg -_dfac -_aef ,_cae :_gca -_cbab -_feg ,_bcg :_bgfb ,_baf :[]*paragraph {}};_fcc :=1;for _ ,_bff :=range _ffaa .P {if _bff !=nil {_dacf :=_bff .PPr ;
var _agg *prefixData ;if _dacf !=nil &&_dacf .TextBulletChoice .BuNone ==nil {var _bfdf string ;var _cfbf bool ;if _fda :=_dacf .TextBulletChoice .BuAutoNum ;_fda !=nil {var _acg string ;if _efg :=_fda .StartAtAttr ;_efg !=nil {_fcc =int (*_efg );};var _ccf string ;
switch _fda .TypeAttr {case _fb .ST_TextAutonumberSchemeAlphaUcParenBoth ,_fb .ST_TextAutonumberSchemeAlphaUcParenR ,_fb .ST_TextAutonumberSchemeAlphaUcPeriod :_ccf =_bffg (_fcc ,true );case _fb .ST_TextAutonumberSchemeAlphaLcParenBoth ,_fb .ST_TextAutonumberSchemeAlphaLcParenR ,_fb .ST_TextAutonumberSchemeAlphaLcPeriod :_ccf =_bffg (_fcc ,false );
case _fb .ST_TextAutonumberSchemeRomanUcParenBoth ,_fb .ST_TextAutonumberSchemeRomanUcParenR ,_fb .ST_TextAutonumberSchemeRomanUcPeriod :_ccf =_dffa (_fcc ,true );case _fb .ST_TextAutonumberSchemeRomanLcParenBoth ,_fb .ST_TextAutonumberSchemeRomanLcParenR ,_fb .ST_TextAutonumberSchemeRomanLcPeriod :_ccf =_dffa (_fcc ,false );
default:_ccf =_c .Itoa (_fcc );};switch _fda .TypeAttr {case _fb .ST_TextAutonumberSchemeAlphaLcPeriod ,_fb .ST_TextAutonumberSchemeAlphaUcPeriod ,_fb .ST_TextAutonumberSchemeArabicPeriod ,_fb .ST_TextAutonumberSchemeRomanLcPeriod ,_fb .ST_TextAutonumberSchemeRomanUcPeriod ,_fb .ST_TextAutonumberSchemeArabicDbPeriod ,_fb .ST_TextAutonumberSchemeEa1ChsPeriod ,_fb .ST_TextAutonumberSchemeEa1ChtPeriod ,_fb .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_fb .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_fb .ST_TextAutonumberSchemeThaiAlphaPeriod ,_fb .ST_TextAutonumberSchemeThaiNumPeriod ,_fb .ST_TextAutonumberSchemeHindiAlphaPeriod ,_fb .ST_TextAutonumberSchemeHindiNumPeriod ,_fb .ST_TextAutonumberSchemeHindiAlpha1Period :_acg ="\u002e";
case _fb .ST_TextAutonumberSchemeAlphaLcParenR ,_fb .ST_TextAutonumberSchemeAlphaUcParenR ,_fb .ST_TextAutonumberSchemeArabicParenR ,_fb .ST_TextAutonumberSchemeRomanLcParenR ,_fb .ST_TextAutonumberSchemeRomanUcParenR ,_fb .ST_TextAutonumberSchemeThaiAlphaParenR ,_fb .ST_TextAutonumberSchemeThaiNumParenR ,_fb .ST_TextAutonumberSchemeHindiNumParenR :_acg ="\u0029";
};_bfdf =_ccf +_acg ;_fcc ++;}else if _cbga :=_dacf .TextBulletChoice .BuChar ;_cbga !=nil {_fcgg :=_cbga .CharAttr ;if _cbbe ,_geab :=_fbgf [_fcgg ];_geab {_fcgg =string (rune (_cbbe ));}else {_fcgg ="\u2022";};_bfdf =_fcgg ;_cfbf =true ;};if _bfdf !=""{var _ccg ,_ddae float64 ;
if _dacf .MarLAttr !=nil {_ccg =_eb .FromEMU (int64 (*_dacf .MarLAttr ));};if _dacf .IndentAttr !=nil {_ddae =_eb .FromEMU (int64 (*_dacf .IndentAttr ));};_agg =&prefixData {_gedc :_bfdf ,_cacd :_cfbf ,_fdafe :_ccg ,_fgf :_ddae };};};_dacf =_caad (_dacf ,_aee );
_egab :=_aab (_bff .EndParaRPr ,_dacf .DefRPr );_egad .newParagraph ();_egad .assignPropsToCurrentParagraph (_dacf );_egad .newLine ();_egad .newWord ();for _adcb ,_aagb :=range _bff .EG_TextRun {_egad .addTextRun (_aagb ,_egab ,_gaf ,_agg );if _adcb > 0{_agg =nil ;
};};_egad .addCurrentWordToParagraph ();};_egad .addCurrentParagraph ();};_egad .alignVertically (_becd );_egad .drawParagraphs ();return _a .MakeBlockFromCreator (_bgfb );};type line struct{_fga float64 ;_bbgf float64 ;_fbeg float64 ;_eadc float64 ;_aacb float64 ;
_cccb []*word ;};type background struct{_gcd _edf .Color ;_cgfg float64 ;_ceb *_fb .CT_BlipFillProperties ;};func _adec (_acgda ,_bffe *_fb .CT_TableStyleCellStyle )*_fb .CT_TableStyleCellStyle {_edfb :=_fb .NewCT_TableStyleCellStyle ();if _acgda !=nil {*_edfb =*_acgda ;
};if _bffe ==nil {return _edfb ;};if _edfb .TcBdr ==nil {_edfb .TcBdr =_bffe .TcBdr ;}else {if _edfb .TcBdr .Left ==nil {_edfb .TcBdr .Left =_bffe .TcBdr .Left ;};if _edfb .TcBdr .Right ==nil {_edfb .TcBdr .Right =_bffe .TcBdr .Right ;};if _edfb .TcBdr .Top ==nil {_edfb .TcBdr .Top =_bffe .TcBdr .Top ;
};if _edfb .TcBdr .Bottom ==nil {_edfb .TcBdr .Bottom =_bffe .TcBdr .Bottom ;};if _edfb .TcBdr .InsideH ==nil {_edfb .TcBdr .InsideH =_bffe .TcBdr .InsideH ;};if _edfb .TcBdr .InsideV ==nil {_edfb .TcBdr .InsideV =_bffe .TcBdr .InsideV ;};};if _edfb .ThemeableFillStyleChoice .Fill ==nil {_edfb .ThemeableFillStyleChoice .Fill =_bffe .ThemeableFillStyleChoice .Fill ;
};if _edfb .ThemeableFillStyleChoice .FillRef ==nil {_edfb .ThemeableFillStyleChoice .FillRef =_bffe .ThemeableFillStyleChoice .FillRef ;};return _edfb ;};func (_eadba *convertContext )drawSlide (){_eadba ._fab .NewPage ();for _ ,_ace :=range _eadba ._efgd {if _ace !=nil {_eadba ._fab .MoveTo (0,0);
_eadba ._fab .Draw (_ace );};};};func (_ba *convertContext )extractDefaultProperties (){_ead :=_ba ._ege .X ();_gc :=_ead .DefaultTextStyle ;var _fee ,_fg ,_acc ,_dbf ,_ebd ,_ff ,_fec ,_be ,_fd ,_ged *_fb .CT_TextParagraphProperties ;if _gc !=nil {_fee =_gc .DefPPr ;
_fg =_caad (_gc .Lvl1pPr ,_fee );_acc =_caad (_gc .Lvl2pPr ,_fee );_dbf =_caad (_gc .Lvl3pPr ,_fee );_ebd =_caad (_gc .Lvl4pPr ,_fee );_ff =_caad (_gc .Lvl5pPr ,_fee );_fec =_caad (_gc .Lvl6pPr ,_fee );_be =_caad (_gc .Lvl7pPr ,_fee );_fd =_caad (_gc .Lvl8pPr ,_fee );
_ged =_caad (_gc .Lvl9pPr ,_fee );_ba ._baa =_fee ;_ba ._eegbc =_fee .DefRPr ;};_ba ._bea =make ([]*_fb .CT_TextParagraphProperties ,9);_ba ._bea [0]=_fg ;_ba ._bea [1]=_acc ;_ba ._bea [2]=_dbf ;_ba ._bea [3]=_ebd ;_ba ._bea [4]=_ff ;_ba ._bea [5]=_fec ;
_ba ._bea [6]=_be ;_ba ._bea [7]=_fd ;_ba ._bea [8]=_ged ;_bd :=_ba ._ege .SlideMasters ()[0].X ();_fadc :=_bd .TxStyles ;_ef :=_fadc .TitleStyle ;_ba ._gadc =_caad (_ef .DefPPr ,_fee );_ba ._efde =_ba ._gadc .DefRPr ;_ba ._ebfb =make ([]*_fb .CT_TextParagraphProperties ,9);
_ba ._ebfb [0]=_caad (_ef .Lvl1pPr ,_fg );_ba ._ebfb [1]=_caad (_ef .Lvl2pPr ,_acc );_ba ._ebfb [2]=_caad (_ef .Lvl3pPr ,_dbf );_ba ._ebfb [3]=_caad (_ef .Lvl4pPr ,_ebd );_ba ._ebfb [4]=_caad (_ef .Lvl5pPr ,_ff );_ba ._ebfb [5]=_caad (_ef .Lvl6pPr ,_fec );
_ba ._ebfb [6]=_caad (_ef .Lvl7pPr ,_be );_ba ._ebfb [7]=_caad (_ef .Lvl8pPr ,_fd );_ba ._ebfb [8]=_caad (_ef .Lvl9pPr ,_ged );_bcc :=_fadc .BodyStyle ;_ba ._fbgb =_caad (_bcc .DefPPr ,_fee );_ba ._facb =_ba ._fbgb .DefRPr ;_ba ._edfd =make ([]*_fb .CT_TextParagraphProperties ,9);
_ba ._edfd [0]=_caad (_bcc .Lvl1pPr ,_fg );_ba ._edfd [1]=_caad (_bcc .Lvl2pPr ,_acc );_ba ._edfd [2]=_caad (_bcc .Lvl3pPr ,_dbf );_ba ._edfd [3]=_caad (_bcc .Lvl4pPr ,_ebd );_ba ._edfd [4]=_caad (_bcc .Lvl5pPr ,_ff );_ba ._edfd [5]=_caad (_bcc .Lvl6pPr ,_fec );
_ba ._edfd [6]=_caad (_bcc .Lvl7pPr ,_be );_ba ._edfd [7]=_caad (_bcc .Lvl8pPr ,_fd );_ba ._edfd [8]=_caad (_bcc .Lvl9pPr ,_ged );};func (_ecbf *textboxContext )newParagraph (){_gdgd :=&paragraph {};_gdgd ._baeb =_ecbf ._cfgd ;_ecbf ._aebg =_gdgd ;};func (_ac *convertContext )makePdfBlockFromChart (_gd *_dea .Chart ,_cfb ,_dae float64 )(*_edf .Block ,error ){_db :=_gd .CT_RelId .IdAttr ;
_fad :=_ac ._deda .GetChartSpaceByRelId (_db );if _fad ==nil {return nil ,_e .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _gf *_fb .Theme ;_df :=_ac ._ege .Themes ();if len (_df )> 0{_gf =_df [0];};return _a .MakeBlockFromChartSpace (_fad ,_cfb ,_dae ,_gf );
};func (_gga *convertContext )makeSlide (){_adb :=_gga ._deda .GetSlideLayout ().CSld ;_gga .addShapes (_adb ,true );_adb =_gga ._deda .X ().CSld ;_gga .addShapes (_adb ,false );};func _fefg (_cfed *_fb .CT_AdjPoint2D )(float64 ,float64 ){var _gcc ,_fcbd float64 ;
_aaacg ,_gggc :=_cfed .XAttr ,_cfed .YAttr ;if _fafd :=_aaacg .ST_Coordinate ;_fafd !=nil {_gcc =_eb .FromEMU (_a .FromSTCoordinate (*_fafd ));};if _dcbg :=_gggc .ST_Coordinate ;_dcbg !=nil {_fcbd =_eb .FromEMU (_a .FromSTCoordinate (*_dcbg ));};return _gcc ,_fcbd ;
};func (_ecbac *convertContext )makePdfBlockFromTable (_gebg *_fb .Tbl )*_edf .Table {_fdaf :=_gebg .TblGrid ;if _fdaf ==nil {return nil ;};_eeb :=len (_fdaf .GridCol );if _eeb ==0{return nil ;};_dcc :=[]float64 {};_eecg :=0.0;for _ ,_cbc :=range _fdaf .GridCol {_bbg :=_eb .FromEMU (_a .FromSTCoordinate (_cbc .WAttr ));
_dcc =append (_dcc ,_bbg );_eecg +=_bbg ;};_agdc :=[]float64 {};for _bdcd :=0;_bdcd < _eeb ;_bdcd ++{_agdc =append (_agdc ,_dcc [_bdcd ]/_eecg );};_ced :=_ecbac ._fab .NewTable (_eeb );_ced .SetColumnWidths (_agdc ...);_ddcd :=_gebg .TblPr ;var _begc *_fb .CT_TableStyle ;
if _cag :=_ddcd .TablePropertiesChoice ;_cag !=nil {if _cag .TableStyle !=nil {_begc =_cag .TableStyle ;}else if _cag .TableStyleId !=nil {_begc =_ecbac ._ege .GetTableStyleById (*_cag .TableStyleId );};};_ebdbf :=_fb .NewCT_TablePartStyle ();_ebdbf .TcStyle =_fb .NewCT_TableStyleCellStyle ();
_ebdbf .TcTxStyle =_fb .NewCT_TableStyleTextStyle ();if _begc !=nil {if _begc .WholeTbl !=nil {*_ebdbf =*_begc .WholeTbl ;};if _begc .TblBg !=nil {if _ebdbf .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_ebdbf .TcStyle .ThemeableFillStyleChoice .Fill =_begc .TblBg .ThemeableFillStyleChoice .Fill ;
};};};if _ebdbf .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_ebdbf .TcStyle .ThemeableFillStyleChoice .Fill =_fb .NewCT_FillProperties ();_ebdbf .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .NoFill =_ddcd .FillPropertiesChoice .NoFill ;
_ebdbf .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .SolidFill =_ddcd .FillPropertiesChoice .SolidFill ;};_efef :=len (_gebg .Tr );_aeb :=_gebg .TblPr .BandRowAttr !=nil &&*_gebg .TblPr .BandRowAttr ;_bfg :=_gebg .TblPr .FirstRowAttr !=nil &&*_gebg .TblPr .FirstRowAttr ;
_egc :=_gebg .TblPr .LastRowAttr !=nil &&*_gebg .TblPr .LastRowAttr ;_aad :=_gebg .TblPr .BandColAttr !=nil &&*_gebg .TblPr .BandColAttr ;_dgec :=_gebg .TblPr .FirstColAttr !=nil &&*_gebg .TblPr .FirstColAttr ;_eecgb :=_gebg .TblPr .LastColAttr !=nil &&*_gebg .TblPr .LastColAttr ;
for _abe ,_dbc :=range _gebg .Tr {_cbdc :=_abe ==0;_ccbf :=_abe ==_efef -1;_fddf :=_abe %2==0;_gba :=len (_dbc .Tc );var _dccg *_fb .CT_TablePartStyle ;if _begc !=nil {if _cbdc &&_bfg {_dccg =_begc .FirstRow ;}else if _ccbf &&_egc {_dccg =_begc .LastRow ;
}else if _fddf &&_aeb {_dccg =_begc .Band2H ;}else if _aeb {_dccg =_begc .Band1H ;};};var _cea float64 ;for _bddg ,_efgb :=range _dbc .Tc {_gac :=_bddg ==0;_ebf :=_bddg ==_gba -1;_gcb :=_bddg %2==0;var _cfg *_fb .CT_TablePartStyle ;if _begc !=nil {if _gac &&_dgec {_cfg =_begc .FirstCol ;
}else if _ebf &&_eecgb {_cfg =_begc .LastCol ;}else if _gcb &&_aad {_cfg =_begc .Band2V ;}else if _aad {_cfg =_begc .Band1V ;};};_fcgf :=_egccc (_egccc (_cfg ,_dccg ),_ebdbf );_dgea :=_ecbac .addCellToTable (_ced ,_efgb ,_fcgf ,_cbdc ,_ccbf ,_gac ,_ebf );
if _dgea > _cea {_cea =_dgea ;};};_cbaa :=_eb .FromEMU (_a .FromSTCoordinate (_dbc .HAttr ));if _cbaa < _cea {_cbaa =_cea ;};if _cbaa < _ffg (4){_cbaa =_ffg (4);};_ced .SetRowHeight (_ced .CurRow (),_cbaa );};return _ced ;};type romanMatch struct{_abdb int ;
_egdfe string ;};func _bgbd (_ddaa string )[]*symbol {_eecb :=[]*symbol {};for _ ,_fge :=range _ddaa {_eecb =append (_eecb ,&symbol {_faea :string (_fge )});};return _eecb ;};func (_ceag *textboxContext )alignSymbolsVertically (){for _ ,_bgdbc :=range _ceag ._baf {for _ ,_gcde :=range _bgdbc ._fede {_gfga :=0.0;
for _ ,_aeee :=range _gcde ._cccb {for _ ,_dbfa :=range _aeee ._bgdb {if _dbfa ._cbegb > _gfga {_gfga =_dbfa ._cbegb ;};};};for _ ,_dag :=range _gcde ._cccb {for _ ,_fcca :=range _dag ._bgdb {if _fcca ._bdad < _gfga {_fcca ._ecbd =_gfga -_fcca ._bdad ;
};};};};};};func _bggc (_abab *_eeg .CT_CommonSlideData ,_bcde _eeg .ST_PlaceholderType ,_gaag *uint32 )(*_fb .CT_Transform2D ,*_fb .CT_TextBody ,*bool ,*bool ,*bool ){_baabb :=_gaag ==nil ;if _abab !=nil &&(_bcde !=_eeg .ST_PlaceholderTypeUnset ||!_baabb ){if _fgec :=_abab .SpTree ;
_fgec !=nil {for _ ,_bdcc :=range _fgec .GroupShapeChoice {if _bdcc !=nil {if _bdcc .Sp !=nil {_dfe ,_bcfd :=_dccd (_bdcc .Sp );if _bcde ==_dfe {if (_baabb &&_bcfd ==nil )||(!_baabb &&_bcfd !=nil &&*_bcfd ==*_gaag ){var _cddc *_fb .CT_Transform2D ;if _bdcc .Sp .SpPr !=nil {_cddc =_bdcc .Sp .SpPr .Xfrm ;
};_cee :=_bcde ==_eeg .ST_PlaceholderTypeTitle ||_bcde ==_eeg .ST_PlaceholderTypeCtrTitle ;_ffcd :=_bcde ==_eeg .ST_PlaceholderTypeSubTitle ;_bfbc :=!_cee &&_bcde !=_eeg .ST_PlaceholderTypeUnset ;return _cddc ,_bdcc .Sp .TxBody ,&_cee ,&_ffcd ,&_bfbc ;
};};};};};};};return nil ,nil ,nil ,nil ,nil ;};func _bffg (_ccad int ,_abda bool )string {_bbf :=(_ccad -1)/26+1;_cbfb :=byte ((_ccad -1)%26);if _abda {_cbfb +=byte (65);}else {_cbfb +=byte (97);};_egcb :=_bb .NewBuffer ([]byte {});for _egdf :=0;_egdf < _bbf ;
_egdf ++{_egcb .Write ([]byte {_cbfb });};return _egcb .String ();};func (_caca *line )moveRight (_cbeb float64 ){for _ ,_dgge :=range _caca ._cccb {_dgge ._gegb +=_cbeb ;};};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;
FontStyle_BoldItalic FontStyle =3;);func _ffg (_ddf float64 )float64 {return _ddf *_eb .Millimeter };type symbol struct{_faea string ;_aebd float64 ;_cbegb float64 ;_bdad float64 ;_ecbd float64 ;_addd float64 ;_bab *_edf .TextStyle ;_cafg string ;_gcef bool ;
_edg bool ;_eaaa bool ;};func (_dedc *textboxContext )alignVertically (_fffa _fb .ST_TextAnchoringType ){_dedc .alignParagraphsVertically (_fffa );_dedc .alignSymbolsVertically ();};func (_bdgf *textboxContext )addCurrentWordToParagraph (){if _bdgf ._gce &&_bdgf ._cddb ._eadc +_bdgf ._ggad ._cdfe > _bdgf ._cddb ._fbeg {_bdgf .newLine ();
};if !_bdgf ._ggad ._ccba ||len (_bdgf ._cddb ._cccb )> 0{_bdgf ._ggad ._gegb =_bdgf ._cddb ._eadc ;_bdgf ._cddb ._cccb =append (_bdgf ._cddb ._cccb ,_bdgf ._ggad );_bdgf ._cddb ._eadc +=_bdgf ._ggad ._cdfe ;for _ ,_acdg :=range _bdgf ._ggad ._bgdb {_bdgf .adjustHeights (_acdg ._cbegb );
};};};func (_gffb *convertContext )getStyleColors (_aae *_fb .CT_ShapeStyle )(_edf .Color ,_edf .Color ,_edf .Color ){var _bdbb ,_dfd ,_fccf _edf .Color ;if _ffca :=_aae .LnRef ;_ffca !=nil {_dfd =_gffb .getColorFromMatrixReference (_ffca );};if _agff :=_aae .FillRef ;
_agff !=nil {_fccf =_gffb .getColorFromMatrixReference (_agff );};if _aaf :=_aae .FontRef ;_aaf !=nil {_bdbb =_gffb .getColorFromFontReference (_aaf );};return _bdbb ,_fccf ,_dfd ;};type symbolStyle struct{_dbe *string ;_aea *float64 ;_aeda *string ;_deddd *bool ;
_gbdg *bool ;_acfe *bool ;_bfbf *bool ;_bacg *bool ;};func (_abfa *textboxContext )addTextRun (_bbgc *_fb .EG_TextRun ,_gfc *_fb .CT_TextCharacterProperties ,_becdf _edf .Color ,_beag *prefixData ){if _cafe :=_bbgc .TextRunChoice .Br ;_cafe !=nil {_abfa .addCurrentWordToParagraph ();
_abfa .newLine ();_abfa .newWord ();}else if _gdc :=_bbgc .TextRunChoice .R ;_gdc !=nil {var _bcge _edf .Color ;if _gdc .RPr !=nil &&_gdc .RPr .FillPropertiesChoice .SolidFill !=nil {_bcge ,_ =_abfa ._fgd .getColorFromSolidFill (_gdc .RPr .FillPropertiesChoice .SolidFill );
}else if _becdf !=nil {_bcge =_becdf ;}else if _gfc .FillPropertiesChoice .SolidFill !=nil {_bcge ,_ =_abfa ._fgd .getColorFromSolidFill (_gfc .FillPropertiesChoice .SolidFill );}else {_bcge =_edf .ColorBlack ;};_eebg :=_aab (_gdc .RPr ,_gfc );_bceb ,_ccae ,_gdd ,_gfe :=_abfa ._fgd .makeStyleFromRPr (_eebg );
_bceb .Color =_bcge ;if _beag !=nil {_abfa .addPrefix (_beag ,_bceb );};_ggfc :=_bgbd (_gdc .T );for _ ,_ccce :=range _ggfc {_ccce ._bab =_bceb ;_ccce ._gcef =_ccae ;_ccce ._edg =_gdd ;_ccce ._eaaa =_gfe ;if _eebg .CapAttr ==_fb .ST_TextCapsTypeAll {_ccce ._faea =_d .ToUpper (_ccce ._faea );
};_abfa .addTextSymbol (_ccce );};};};func _gggb (_deaf *bool )bool {return _deaf !=nil &&*_deaf };func (_ecbaa *textboxContext )adjustHeights (_gddc float64 ){if _ecbaa ._cddb ._aacb < _gddc {_ecbaa ._aebg ._cga +=(_gddc -_ecbaa ._cddb ._aacb );_ecbaa ._cddb ._aacb =_gddc ;
};};func _egccc (_dcbc ,_gge *_fb .CT_TablePartStyle )*_fb .CT_TablePartStyle {_egg :=_fb .NewCT_TablePartStyle ();if _dcbc !=nil {*_egg =*_dcbc ;};if _gge ==nil {return _egg ;};if _egg .TcTxStyle ==nil {_egg .TcTxStyle =_gge .TcTxStyle ;}else {_egg .TcTxStyle =_ecda (_egg .TcTxStyle ,_gge .TcTxStyle );
};if _egg .TcStyle ==nil {_egg .TcStyle =_gge .TcStyle ;}else {_egg .TcStyle =_adec (_egg .TcStyle ,_gge .TcStyle );};return _egg ;};func (_cdbc *textboxContext )drawParagraphs (){_cdbc ._bcg .NewPage ();for _ ,_gfea :=range _cdbc ._baf {for _ ,_cabe :=range _gfea ._fede {for _ ,_gaaa :=range _cabe ._cccb {for _ ,_abdbd :=range _gaaa ._bgdb {_eebb :=_cdbc ._bcg .NewStyledParagraph ();
if _abdbd ._gcef {_abdbd ._ecbd =0;}else if _abdbd ._edg {_abdbd ._ecbd =1.2*_cabe ._aacb -_abdbd ._bdad ;};_fdca :=_gaaa ._gegb +_abdbd ._aebd ;_bba :=_gfea ._baeb +_cabe ._fga +_abdbd ._ecbd ;_eebb .SetPos (_fdca ,_bba );_bbfa :=_eebb .Append (_abdbd ._faea );
if _abdbd ._bab !=nil {_bbfa .Style =*_abdbd ._bab ;};_cdbc ._bcg .Draw (_eebb );if _abdbd ._eaaa {_ggaae :=_bba +_abdbd ._bdad +2;_a .DrawLine (_cdbc ._bcg ,_fdca ,_ggaae ,_fdca +_abdbd ._addd ,_ggaae ,1,_abdbd ._bab .Color );};};};};};};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _a .RegisterFontsFromDirectory (dirName )};func (_cfd *textboxContext )addTextSymbol (_fcdeb *symbol ){_aace :=_edf .New ();_cgb :=_aace .NewStyledParagraph ();_cgb .SetMargins (0,0,0,0);_abba :=_cgb .Append (_fcdeb ._faea );
_eadf :=0.0;if _fcdeb ._bab !=nil {_abba .Style =*_fcdeb ._bab ;if _fcdeb ._bab .CharSpacing !=0{_eadf =_fcdeb ._bab .CharSpacing ;};};_fcdeb ._bdad =_cgb .Height ();_fcdeb ._cbegb =_cgb .Height ()*1.2;if _fcdeb ._addd ==0{_fcdeb ._addd =_cgb .Width ()+_eadf ;
};if len (_cfd ._ggad ._bgdb )> 0{_efee :=_cfd ._ggad ._bgdb [len (_cfd ._ggad ._bgdb )-1]._faea ;if _cfd ._aebg ._fgbe ||_a .IsNoSpaceLanguage (_efee )||(_efee =="\u0020")!=(_fcdeb ._faea =="\u0020"){_cfd .addCurrentWordToParagraph ();_cfd .newWord ();
};};_cfd ._ggad ._bgdb =append (_cfd ._ggad ._bgdb ,_fcdeb );_fcdeb ._aebd =_cfd ._ggad ._cdfe ;_cfd ._ggad ._cdfe +=_fcdeb ._addd ;if _fcdeb ._faea !="\u0020"{_cfd ._ggad ._ccba =false ;};if _cfd ._ggad ._cdfe >=_cfd ._aebg ._acbg -_cfd ._aebg ._fdc {_cfd .addCurrentWordToParagraph ();
_cfd .newLine ();_cfd .newWord ();};};func (_eadcg *textboxContext )assignPropsToCurrentParagraph (_aagf *_fb .CT_TextParagraphProperties ){_dbd :=12.4;if _aagf ==nil {_eadcg ._aebg ._ebbe =_dbd ;return ;};if _afae :=_aagf .DefRPr ;_afae !=nil {_bfba :=_afae .SzAttr ;
if _bfba !=nil {_eagf :=float64 (*_bfba )/1200;if _dbd <=_eagf {_dbd =_eagf ;};};};if _bef :=_aagf .MarLAttr ;_bef !=nil {_eadcg ._aebg ._fdc =_eb .FromEMU (int64 (*_bef ));};_eadcg ._aebg ._acbg =_eadcg ._fddc ;if _aada :=_aagf .MarRAttr ;_aada !=nil {_eadcg ._aebg ._acbg -=_eb .FromEMU (int64 (*_aada ));
};if _fbee :=_aagf .IndentAttr ;_fbee !=nil {_eadcg ._aebg ._gfgg =_eb .FromEMU (int64 (*_fbee ));};if _gebgb :=_aagf .LatinLnBrkAttr ;_gebgb !=nil {_eadcg ._aebg ._fgbe =*_gebgb ;};if _gbe :=_aagf .LnSpc ;_gbe !=nil &&_gbe .TextSpacingChoice !=nil {if _decg :=_gbe .TextSpacingChoice .SpcPct ;
_decg !=nil {if _eab :=_decg .ValAttr .ST_TextSpacingPercent ;_eab !=nil {_dbd =float64 (*_eab )/5000;};};};var _baga float64 ;if _ffcg :=_aagf .SpcBef ;_ffcg !=nil &&_ffcg .TextSpacingChoice !=nil {if _faf :=_ffcg .TextSpacingChoice .SpcPts ;_faf !=nil {_baga =float64 (_faf .ValAttr )/100;
};};_gadb :=_eadcg ._baf ;if len (_gadb )> 0{_baga -=_gadb [len (_gadb )-1]._aacfd ;if _baga < 0{_baga =0;};};_eadcg ._aebg ._ffce =_baga ;if _eeca :=_aagf .SpcAft ;_eeca !=nil &&_eeca .TextSpacingChoice !=nil {if _ccbb :=_eeca .TextSpacingChoice .SpcPts ;
_ccbb !=nil {_eadcg ._aebg ._aacfd =float64 (_ccbb .ValAttr )/100;};};_eadcg ._aebg ._ebbe =_dbd ;_eadcg ._aebg ._efba =_aagf .AlgnAttr ;};func _efcc (_feee float64 )float64 {return _feee *_eb .Inch };func (_acba *textboxContext )alignParagraphsVertically (_fdaa _fb .ST_TextAnchoringType ){if _fdaa ==_fb .ST_TextAnchoringTypeT {return ;
};_eedf :=0.0;for _ ,_ebed :=range _acba ._baf {_eedf +=_ebed ._ffce +_ebed ._cga +_ebed ._aacfd ;};var _fgde float64 ;switch _fdaa {case _fb .ST_TextAnchoringTypeCtr :_fgde =(_acba ._cae -_eedf )/2;case _fb .ST_TextAnchoringTypeB :_fgde =_acba ._cae -_eedf ;
};for _ ,_afdc :=range _acba ._baf {_afdc ._baeb +=_fgde ;};};func _fbgc (_cbgde ,_bebe *_fb .CT_TextBodyProperties )*_fb .CT_TextBodyProperties {_bde :=_fb .NewCT_TextBodyProperties ();if _cbgde !=nil {*_bde =*_cbgde ;};if _bebe ==nil {return _bde ;};
if _bde .RotAttr ==nil {_bde .RotAttr =_bebe .RotAttr ;};if _bde .SpcFirstLastParaAttr ==nil {_bde .SpcFirstLastParaAttr =_bebe .SpcFirstLastParaAttr ;};if _bde .VertOverflowAttr ==_fb .ST_TextVertOverflowTypeUnset {_bde .VertOverflowAttr =_bebe .VertOverflowAttr ;
};if _bde .HorzOverflowAttr ==_fb .ST_TextHorzOverflowTypeUnset {_bde .HorzOverflowAttr =_bebe .HorzOverflowAttr ;};if _bde .VertAttr ==_fb .ST_TextVerticalTypeUnset {_bde .VertAttr =_bebe .VertAttr ;};if _bde .WrapAttr ==_fb .ST_TextWrappingTypeUnset {_bde .WrapAttr =_bebe .WrapAttr ;
};if _bde .LInsAttr ==nil {_bde .LInsAttr =_bebe .LInsAttr ;};if _bde .TInsAttr ==nil {_bde .TInsAttr =_bebe .TInsAttr ;};if _bde .RInsAttr ==nil {_bde .RInsAttr =_bebe .RInsAttr ;};if _bde .BInsAttr ==nil {_bde .BInsAttr =_bebe .BInsAttr ;};if _bde .NumColAttr ==nil {_bde .NumColAttr =_bebe .NumColAttr ;
};if _bde .SpcColAttr ==nil {_bde .SpcColAttr =_bebe .SpcColAttr ;};if _bde .RtlColAttr ==nil {_bde .RtlColAttr =_bebe .RtlColAttr ;};if _bde .AnchorAttr ==_fb .ST_TextAnchoringTypeUnset {_bde .AnchorAttr =_bebe .AnchorAttr ;};if _bde .AnchorCtrAttr ==nil {_bde .AnchorCtrAttr =_bebe .AnchorCtrAttr ;
};if _bde .ForceAAAttr ==nil {_bde .ForceAAAttr =_bebe .ForceAAAttr ;};if _bde .UprightAttr ==nil {_bde .UprightAttr =_bebe .UprightAttr ;};if _bde .CompatLnSpcAttr ==nil {_bde .CompatLnSpcAttr =_bebe .CompatLnSpcAttr ;};if _bde .PrstTxWarp ==nil {_bde .PrstTxWarp =_bebe .PrstTxWarp ;
};if _bde .TextAutofitChoice .NoAutofit ==nil {_bde .TextAutofitChoice .NoAutofit =_bebe .TextAutofitChoice .NoAutofit ;};if _bde .TextAutofitChoice .NormAutofit ==nil {_bde .TextAutofitChoice .NormAutofit =_bebe .TextAutofitChoice .NormAutofit ;};if _bde .TextAutofitChoice .SpAutoFit ==nil {_bde .TextAutofitChoice .SpAutoFit =_bebe .TextAutofitChoice .SpAutoFit ;
};if _bde .Scene3d ==nil {_bde .Scene3d =_bebe .Scene3d ;};if _bde .Text3DChoice .Sp3d ==nil {_bde .Text3DChoice .Sp3d =_bebe .Text3DChoice .Sp3d ;};if _bde .Text3DChoice .FlatTx ==nil {_bde .Text3DChoice .FlatTx =_bebe .Text3DChoice .FlatTx ;};if _bde .ExtLst ==nil {_bde .ExtLst =_bebe .ExtLst ;
};return _bde ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_de .PdfFont ){_a .RegisterFont (name ,style ,font );};var _fbgf =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};var _fcbb =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
func (_gfbb *textboxContext )newLine (){if _gfbb ._aebg ==nil {_gfbb .newParagraph ();};_fefb :=_gfbb ._aebg ._cga +_gfbb ._aebg ._ffce ;_dedddd :=&line {};_dedddd ._bbgf =_gfbb ._aebg ._fdc ;if len (_gfbb ._aebg ._fede )==0{_dedddd ._bbgf +=_gfbb ._aebg ._gfgg ;
};_dedddd ._fbeg =_gfbb ._aebg ._acbg ;_dedddd ._eadc =_dedddd ._bbgf ;_dedddd ._fga =_fefb ;_gfbb ._aebg ._fede =append (_gfbb ._aebg ._fede ,_dedddd );_gfbb ._cddb =_dedddd ;};func _caad (_acbb ,_afdb *_fb .CT_TextParagraphProperties )*_fb .CT_TextParagraphProperties {_dedf :=_fb .NewCT_TextParagraphProperties ();
if _acbb !=nil {*_dedf =*_acbb ;};if _afdb ==nil {return _dedf ;};if _dedf .MarLAttr ==nil {_dedf .MarLAttr =_afdb .MarLAttr ;};if _dedf .MarRAttr ==nil {_dedf .MarRAttr =_afdb .MarRAttr ;};if _dedf .LvlAttr ==nil {_dedf .LvlAttr =_afdb .LvlAttr ;};if _dedf .IndentAttr ==nil {_dedf .IndentAttr =_afdb .IndentAttr ;
};if _dedf .AlgnAttr ==_fb .ST_TextAlignTypeUnset {_dedf .AlgnAttr =_afdb .AlgnAttr ;};if _dedf .DefTabSzAttr ==nil {_dedf .DefTabSzAttr =_afdb .DefTabSzAttr ;};if _dedf .RtlAttr ==nil {_dedf .RtlAttr =_afdb .RtlAttr ;};if _dedf .EaLnBrkAttr ==nil {_dedf .EaLnBrkAttr =_afdb .EaLnBrkAttr ;
};if _dedf .FontAlgnAttr ==_fb .ST_TextFontAlignTypeUnset {_dedf .FontAlgnAttr =_afdb .FontAlgnAttr ;};if _dedf .LatinLnBrkAttr ==nil {_dedf .LatinLnBrkAttr =_afdb .LatinLnBrkAttr ;};if _dedf .HangingPunctAttr ==nil {_dedf .HangingPunctAttr =_afdb .HangingPunctAttr ;
};if _dedf .LnSpc ==nil {_dedf .LnSpc =_afdb .LnSpc ;};if _dedf .SpcBef ==nil {_dedf .SpcBef =_afdb .SpcBef ;};if _dedf .SpcAft ==nil {_dedf .SpcAft =_afdb .SpcAft ;};if _dedf .TextBulletColorChoice .BuClrTx ==nil {_dedf .TextBulletColorChoice .BuClrTx =_afdb .TextBulletColorChoice .BuClrTx ;
};if _dedf .TextBulletColorChoice .BuClr ==nil {_dedf .TextBulletColorChoice .BuClr =_afdb .TextBulletColorChoice .BuClr ;};if _dedf .TextBulletSizeChoice .BuSzTx ==nil {_dedf .TextBulletSizeChoice .BuSzTx =_afdb .TextBulletSizeChoice .BuSzTx ;};if _dedf .TextBulletSizeChoice .BuSzPct ==nil {_dedf .TextBulletSizeChoice .BuSzPct =_afdb .TextBulletSizeChoice .BuSzPct ;
};if _dedf .TextBulletSizeChoice .BuSzPts ==nil {_dedf .TextBulletSizeChoice .BuSzPts =_afdb .TextBulletSizeChoice .BuSzPts ;};if _dedf .TextBulletTypefaceChoice .BuFontTx ==nil {_dedf .TextBulletTypefaceChoice .BuFontTx =_afdb .TextBulletTypefaceChoice .BuFontTx ;
};if _dedf .TextBulletTypefaceChoice .BuFont ==nil {_dedf .TextBulletTypefaceChoice .BuFont =_afdb .TextBulletTypefaceChoice .BuFont ;};if _dedf .TextBulletChoice .BuNone ==nil {_dedf .TextBulletChoice .BuNone =_afdb .TextBulletChoice .BuNone ;};if _dedf .TextBulletChoice .BuAutoNum ==nil {_dedf .TextBulletChoice .BuAutoNum =_afdb .TextBulletChoice .BuAutoNum ;
};if _dedf .TextBulletChoice .BuChar ==nil {_dedf .TextBulletChoice .BuChar =_afdb .TextBulletChoice .BuChar ;};if _dedf .TextBulletChoice .BuBlip ==nil {_dedf .TextBulletChoice .BuBlip =_afdb .TextBulletChoice .BuBlip ;};if _dedf .TabLst ==nil {_dedf .TabLst =_afdb .TabLst ;
};if _dedf .ExtLst ==nil {_dedf .ExtLst =_afdb .ExtLst ;};_dedf .DefRPr =_aab (_dedf .DefRPr ,_afdb .DefRPr );return _dedf ;};

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _a .PageSize ;};func (_cca *convertContext )getBorderStyle (_egca *_fb .CT_LineProperties )(_edf .CellBorderStyle ,*_edf .Color ,float64 ){if _egca ==nil ||_egca .LineFillPropertiesChoice .NoFill !=nil {return _edf .CellBorderStyleNone ,nil ,0;
};var _cbfg _edf .Color ;if _dga :=_egca .LineFillPropertiesChoice .SolidFill ;_dga !=nil {_cbfg ,_ =_cca .getColorFromSolidFill (_dga );};_eafc :=0.0;if _gbcg :=_egca .WAttr ;_gbcg !=nil {_eafc =_eb .FromEMU (int64 (*_gbcg ));};return _edf .CellBorderStyleSingle ,&_cbfg ,_eafc ;
};func (_dfcb *convertContext )getShapeFromBlipFill (_febf *_fb .CT_BlipFillProperties ,_bdbe ,_fefgb ,_bcebb ,_defdc float64 ,_deba bool )_edf .Drawable {_fffd ,_bgc ,_ecac :=_dfcb .makePdfImageFromBlipFill (_febf ,_deba );if _ecac !=nil {_ea .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_ecac );
return nil ;};if _fffd ==nil {return nil ;};if _fbca :=_febf .FillModePropertiesChoice .Tile ;_fbca !=nil {_fffd =_dfcb .tileImage (_fffd ,_febf .FillModePropertiesChoice .Tile ,_bcebb ,_defdc );};if _deae :=_febf .FillModePropertiesChoice .Stretch ;_deae !=nil {_fffd ,_bdbe ,_fefgb =_dfcb .stretchImage (_fffd ,_febf .FillModePropertiesChoice .Stretch ,_bdbe ,_fefgb ,_bcebb ,_defdc );
};if _fffd ==nil {return nil ;};if len (_bgc )==0{_fffd .SetPos (_bdbe ,_fefgb );return _fffd ;};_fffd =_dfcb .applyBlipEffectsOnImg (_fffd ,_bdbe ,_fefgb ,_bgc );_fffd .SetPos (_bdbe ,_fefgb );return _fffd ;};

// ConvertToPdfWithOptions convert a presentation to PDF with given options.
func ConvertToPdfWithOptions (pr *_bbb .Presentation ,opts *Options )*_edf .Creator {_ge :=pr .X ().SldSz ;_bf :=_eb .FromEMU (int64 (_ge .CxAttr ));_fe :=_eb .FromEMU (int64 (_ge .CyAttr ));_cb :=_edf .PageSize {_bf ,_fe };if (_cb ==_edf .PageSize {}){_cb =_a .GetDefaultPageSize ();
if opts !=nil &&opts .DefaultPageSize !=_a .DefaultPageSize {_cb =_a .GetPageDimensions (opts .DefaultPageSize );};};_cbb :=_edf .New ();_cbb .SetPageSize (_cb );var _cd *_fb .Theme ;if len (pr .Themes ())> 0{_cd =pr .Themes ()[0];};for _ ,_ec :=range pr .Slides (){if _ec .X ()==nil {continue ;
};_ce :=&convertContext {_fab :_cbb ,_deda :&_ec ,_cgfc :_ec .GetSlideLayout (),_fefd :pr .SlideMasters ()[0].X (),_ege :pr ,_fbbb :_cd ,_cdd :_ec .X ().ClrMapOvr ,_eceg :_cb [1],_cfgc :_cb [0]};_ce .extractDefaultProperties ();_ce .makeSlide ();_ce .drawSlide ();
};return _cbb ;};func _gaba (_bgdba *_fb .CT_TextCharacterProperties ,_bfea *_fb .CT_TableStyleTextStyle )*_fb .CT_TextCharacterProperties {_dcbcc :=_fb .NewCT_TextCharacterProperties ();if _bgdba !=nil {*_dcbcc =*_bgdba ;};if _bfea ==nil {return _dcbcc ;
};if _dcbcc .BAttr ==nil &&_bfea .BAttr !=_fb .ST_OnOffStyleTypeUnset {_dfcc :=_bfea .BAttr ==_fb .ST_OnOffStyleTypeOn ;_dcbcc .BAttr =&_dfcc ;};if _dcbcc .IAttr ==nil &&_bfea .IAttr !=_fb .ST_OnOffStyleTypeUnset {_cbdg :=_bfea .IAttr ==_fb .ST_OnOffStyleTypeOn ;
_dcbcc .IAttr =&_cbdg ;};if _dcbcc .FillPropertiesChoice .NoFill ==nil &&_dcbcc .FillPropertiesChoice .SolidFill ==nil {_dcbcc .FillPropertiesChoice .SolidFill =_fb .NewCT_SolidColorFillProperties ();_dcbcc .FillPropertiesChoice .SolidFill .ScrgbClr =_bfea .ScrgbClr ;
_dcbcc .FillPropertiesChoice .SolidFill .SrgbClr =_bfea .SrgbClr ;_dcbcc .FillPropertiesChoice .SolidFill .HslClr =_bfea .HslClr ;_dcbcc .FillPropertiesChoice .SolidFill .SysClr =_bfea .SysClr ;_dcbcc .FillPropertiesChoice .SolidFill .SchemeClr =_bfea .SchemeClr ;
_dcbcc .FillPropertiesChoice .SolidFill .PrstClr =_bfea .PrstClr ;};if _dccf :=_bfea .ThemeableFontStylesChoice .Font ;_dccf !=nil &&_dcbcc .Latin ==nil &&_dcbcc .Ea ==nil &&_dcbcc .Cs ==nil {_dcbcc .Latin =_dccf .Latin ;_dcbcc .Ea =_dccf .Ea ;_dcbcc .Cs =_dccf .Cs ;
};return _dcbcc ;};func (_aag *convertContext )getShapesFromSpPr (_dde *_fb .CT_ShapeProperties ,_fbg *_fb .CT_ShapeStyle ,_aaac bool ,_abc float64 ,_gdee float64 )([]_edf .Drawable ,float64 ,float64 ,float64 ,float64 ,_edf .Color ,bool ){_ggc :=[]_edf .Drawable {};
var _gcg ,_cfc ,_cac ,_dee ,_gbg float64 ;var _cbgd ,_acca ,_bce ,_ccc _edf .Color ;var _agd *_fb .CT_BlipFillProperties ;_ddce ,_af :=1.0,1.0;if _fbg !=nil {_cbgd ,_acca ,_ccc =_aag .getStyleColors (_fbg );};if _ddeg :=_dde .Ln ;_ddeg !=nil {if _ddeg .LineFillPropertiesChoice .NoFill !=nil {_bce ,_gbg =nil ,0;
}else {_bce ,_gbg ,_ddce =_aag .getInfoFromLn (_ddeg );if _bce ==nil {_bce =_ccc ;};};};if _dde .FillPropertiesChoice .NoFill !=nil {_acca ,_af =nil ,0;}else if _aaac {_acca =_aag ._fgbc ._gcd ;_af =_aag ._fgbc ._cgfg ;_agd =_aag ._fgbc ._ceb ;}else if _fbe :=_dde .FillPropertiesChoice .SolidFill ;
_fbe !=nil {_acca ,_af =_aag .getColorFromSolidFill (_fbe );};var _acee bool ;if _feca :=_dde .Xfrm ;_feca !=nil {_gcg ,_cfc ,_cac ,_dee =_a .GetDataFromXfrm (_feca );_gcg +=_abc ;_cfc +=_gdee ;_acee =true ;};if _bbcf :=_dde .GeometryChoice .CustGeom ;
_bbcf !=nil {_gbd :=[]_da .Point {};_fcg ,_gdeg :=1.0,1.0;if _fea :=_bbcf .PathLst ;_fea !=nil {for _ ,_fde :=range _fea .Path {if _fde !=nil {if _ddga :=_fde .WAttr ;_ddga !=nil {_fcg =_cac /_eb .FromEMU (*_ddga );};if _cbfed :=_fde .HAttr ;_cbfed !=nil {_gdeg =_dee /_eb .FromEMU (*_cbfed );
};for _ ,_adgd :=range _fde .Path2DChoice {if _adgd .Close !=nil {};if _abf :=_adgd .MoveTo ;_adgd .MoveTo !=nil {if _abf !=nil &&_abf .Pt !=nil {_bdce ,_gffg :=_fefg (_abf .Pt );_gbd =append (_gbd ,_da .Point {X :_bdce *_fcg +_gcg ,Y :_gffg *_gdeg +_cfc });
};};if _fbd :=_adgd .LnTo ;_fbd !=nil &&_fbd .Pt !=nil {_feeg ,_cbbf :=_fefg (_fbd .Pt );_gbd =append (_gbd ,_da .Point {X :_feeg *_fcg +_gcg ,Y :_cbbf *_gdeg +_cfc });};};_ggcb :=_aag ._fab .NewPolygon ([][]_da .Point {_gbd });_ggcb .SetFillColor (_acca );
_ggcb .SetFillOpacity (_af );_ggcb .SetBorderWidth (_gbg );if _bce !=nil {_ggcb .SetBorderColor (_bce );_ggcb .SetBorderOpacity (_ddce );};_ggc =append (_ggc ,_ggcb );};};};};if _ebg :=_dde .GeometryChoice .PrstGeom ;_ebg !=nil {switch _ebg .PrstAttr {case _fb .ST_ShapeTypeRect :if _agd !=nil {_efd :=_aag .getShapeFromBlipFill (_agd ,_gcg ,_cfc ,_cac ,_dee ,false );
_ggc =append (_ggc ,_efd );}else {_bdgb :=_aag ._fab .NewRectangle (_gcg ,_cfc ,_cac ,_dee );_adc :=_acca !=nil &&_af > 0;if _adc {_bdgb .SetFillColor (_acca );_bdgb .SetFillOpacity (_af );};_gabb :=_bce !=nil &&_ddce > 0&&_gbg > 0;if _gabb {_bdgb .SetBorderWidth (_gbg );
_bdgb .SetBorderColor (_bce );_bdgb .SetBorderOpacity (_ddce );};if _adc ||_gabb {_ggc =append (_ggc ,_bdgb );};};case _fb .ST_ShapeTypeLine :_egb :=_aag ._fab .NewLine (_gcg ,_cfc ,_gcg +_cac ,_cfc +_dee );_egb .SetLineWidth (_gbg );if _bce !=nil {_egb .SetColor (_bce );
};_ggc =append (_ggc ,_egb );};};return _ggc ,_gcg ,_cfc ,_cac ,_dee ,_cbgd ,_acee ;};func (_adbge *textboxContext )addCurrentParagraph (){_adbge ._cfgd =_adbge ._aebg ._baeb +_adbge ._aebg ._ffce +_adbge ._aebg ._cga +_adbge ._aebg ._aacfd ;_adbge ._baf =append (_adbge ._baf ,_adbge ._aebg );
_adbge .alignParagraph ();};func _dccd (_dgcdc *_eeg .CT_Shape )(_eeg .ST_PlaceholderType ,*uint32 ){if _dede :=_dgcdc .NvSpPr ;_dede !=nil {if _bacgb :=_dede .NvPr ;_bacgb !=nil {if _ecdg :=_bacgb .Ph ;_ecdg !=nil {return _ecdg .TypeAttr ,_ecdg .IdxAttr ;
};};};return _eeg .ST_PlaceholderTypeUnset ,nil ;};var _gdg =_ffg (1.9);func (_dcde *convertContext )renderPageWithDrawableToGoImage (_bcgd _edf .Drawable )(_ee .Image ,error ){_fgeb :=_a .MakeTempCreator (_dcde ._cfgc ,_dcde ._eceg );_fgeb .NewPage ();
_fgeb .Draw (_bcgd );_ggfe ,_daf :=_a .GetPageFromCreator (_fgeb );if _daf !=nil {return nil ,_daf ;};return _cf .NewImageDevice ().Render (_ggfe );};func (_dad *convertContext )makePdfImageFromBlipFill (_afde *_fb .CT_BlipFillProperties ,_gcad bool )(*_edf .Image ,[]*_fb .CT_BlipChoice ,error ){if _eae :=_afde .Blip ;
_eae !=nil {if _fdeg :=_eae .EmbedAttr ;_fdeg !=nil {var _fdee _fa .ImageRef ;var _eaga bool ;if _gcad {_fdee ,_eaga =_dad ._deda .GetLayoutImageByRelID (*_fdeg );}else {_fdee ,_eaga =_dad ._deda .GetImageByRelID (*_fdeg );};if _eaga {_dabc ,_gbdf :=_bc .Open (_fdee .Path ());
if _gbdf !=nil {_ea .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_gbdf );return nil ,nil ,_gbdf ;};defer _dabc .Close ();_dcgf ,_ ,_gbdf :=_ee .Decode (_dabc );if _gbdf !=nil {_ea .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_gbdf );
return nil ,nil ,_gbdf ;};if _bgg :=_afde .SrcRect ;_bgg !=nil {_daae :=_dcgf .Bounds ().Size ();_deb :=_daae .X ;_efgf :=_daae .Y ;var _ceaf ,_dbb ,_dgegd ,_agfc int ;var _ddca bool ;if _ecdf :=_bgg .LAttr ;_ecdf !=nil {_ceaf =int (float64 (_deb )*_a .FromSTPercentage (_ecdf ));
_ddca =true ;}else {_ceaf =0;};if _bgab :=_bgg .TAttr ;_bgab !=nil {_dgegd =int (float64 (_efgf )*_a .FromSTPercentage (_bgab ));_ddca =true ;}else {_dgegd =0;};if _geff :=_bgg .RAttr ;_geff !=nil {_dbb =int (float64 (_deb )*(1-_a .FromSTPercentage (_geff )));
_ddca =true ;}else {_dbb =_deb ;};if _bgbc :=_bgg .BAttr ;_bgbc !=nil {_agfc =int (float64 (_efgf )*(1-_a .FromSTPercentage (_bgbc )));_ddca =true ;}else {_agfc =_efgf ;};if _ddca {_dcgf =_a .CropImageByRect (_dcgf ,_ee .Rect (_ceaf ,_dgegd ,_dbb +1,_agfc +1));
};};_gcgf ,_gbdf :=_dad ._fab .NewImageFromGoImage (_dcgf );_gcgf .SetEncoder (_g .NewFlateEncoder ());if _d .ToLower (_fdee .Format ())=="\u006a\u0070\u0067"||_d .ToLower (_fdee .Format ())=="\u006a\u0070\u0065\u0067"{_gcgf .SetEncoder (_g .NewDCTEncoder ());
};if _gbdf !=nil {_ea .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_gbdf );
return nil ,nil ,_gbdf ;};return _gcgf ,_eae .BlipChoice ,nil ;};};};return nil ,nil ,nil ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_a .FontStyle ;func _cecf (_dagg ,_fbgbb *_fb .CT_TextListStyle )*_fb .CT_TextListStyle {_baaf :=_fb .NewCT_TextListStyle ();if _dagg !=nil {*_baaf =*_dagg ;};if _fbgbb ==nil {return _baaf ;};_baaf .DefPPr =_caad (_baaf .DefPPr ,_fbgbb .DefPPr );
_baaf .Lvl1pPr =_caad (_baaf .Lvl1pPr ,_fbgbb .Lvl1pPr );_baaf .Lvl2pPr =_caad (_baaf .Lvl2pPr ,_fbgbb .Lvl2pPr );_baaf .Lvl3pPr =_caad (_baaf .Lvl3pPr ,_fbgbb .Lvl3pPr );_baaf .Lvl4pPr =_caad (_baaf .Lvl4pPr ,_fbgbb .Lvl4pPr );_baaf .Lvl5pPr =_caad (_baaf .Lvl5pPr ,_fbgbb .Lvl5pPr );
_baaf .Lvl6pPr =_caad (_baaf .Lvl6pPr ,_fbgbb .Lvl6pPr );_baaf .Lvl7pPr =_caad (_baaf .Lvl7pPr ,_fbgbb .Lvl7pPr );_baaf .Lvl8pPr =_caad (_baaf .Lvl8pPr ,_fbgbb .Lvl8pPr );_baaf .Lvl9pPr =_caad (_baaf .Lvl9pPr ,_fbgbb .Lvl9pPr );return _baaf ;};func (_dg *convertContext )addShapes (_bfe *_eeg .CT_CommonSlideData ,_ae bool ){if _bfe ==nil {return ;
};_fc :=&background {};if _bbc :=_bfe .Bg ;_bbc !=nil {if _gfb :=_bbc .BackgroundChoice .BgPr ;_gfb !=nil {if _gfb .FillPropertiesChoice .NoFill ==nil {if _dgc :=_gfb .FillPropertiesChoice .SolidFill ;_dgc !=nil {_aed ,_fgg :=_dg .getColorFromSolidFill (_dgc );
if _aed !=nil {_fc ._gcd =_aed ;_fc ._cgfg =_fgg ;};}else if _cgf :=_gfb .FillPropertiesChoice .BlipFill ;_cgf !=nil {_fc ._ceb =_cgf ;};};};};_dg ._fgbc =_fc ;if _dc :=_bfe .SpTree ;_dc !=nil {for _ ,_dec :=range _dc .GroupShapeChoice {if _dec !=nil {if _dec .Sp !=nil {_fcf :=_dg .getShapes (_dec .Sp ,_ae ,false );
_dg ._efgd =append (_dg ._efgd ,_fcf ...);};if _dec .GraphicFrame !=nil {var _fdg ,_ag ,_gef ,_bad float64 ;if _gdb :=_dec .GraphicFrame .Xfrm ;_gdb !=nil {_fdg ,_ag ,_gef ,_bad =_a .GetDataFromXfrm (_gdb );};if _gef ==0&&_bad ==0{_gef =_dg ._cfgc ;_bad =_dg ._eceg ;
};if _bee :=_dec .GraphicFrame .Graphic ;_bee !=nil {if _eda :=_bee .GraphicData ;_eda !=nil {for _ ,_bcd :=range _eda .Any {if _acd ,_ad :=_bcd .(*_dea .Chart );_ad {_dgca ,_aga :=_dg .makePdfBlockFromChart (_acd ,_gef ,_bad );if _aga !=nil {_ea .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_aga );
};if _dgca !=nil {_dgca .SetPos (_fdg ,_ag );_dg ._efgd =append (_dg ._efgd ,_dgca );};}else if _eg ,_bdf :=_bcd .(*_fb .Tbl );_bdf {_ffd :=_dg .makePdfBlockFromTable (_eg );if _ffd !=nil {_geb :=_edf .NewBlock (_gef ,_bad );_geb .SetPos (_fdg ,_ag );_dbg :=_geb .Draw (_ffd );
if _dbg !=nil {_ea .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0064r\u0061\u0077\u0020\u0074\u0061b\u006c\u0065\u003a\u0020\u0025\u0073",_dbg );if _dbg ==_edf .ErrContentNotFit {_geb =_edf .NewBlock (_dg ._cfgc -1.5*_fdg ,_dg ._eceg -1.5*_ag );_geb .SetPos (_fdg ,_ag );
_dbg =_geb .Draw (_ffd );};};if _dbg ==nil {_dg ._efgd =append (_dg ._efgd ,_geb );};};};};};};};if _dec .CxnSp !=nil {_dcg :=_dg .getConnectors (_dec .CxnSp );_dg ._efgd =append (_dg ._efgd ,_dcg ...);};if _dec .GrpSp !=nil {_dgb :=0.0;_bdc :=0.0;if _aeg :=_dec .GrpSp .GrpSpPr .Xfrm ;
_aeg !=nil {_dgb ,_bdc =_a .GetGroupOffsetFromXfrm (_aeg );};for _ ,_aa :=range _dec .GrpSp .GroupShapeChoice {if _aa .CxnSp !=nil {_adg :=_dg .getGroupConnectors (_aa .CxnSp ,_dgb ,_bdc );_dg ._efgd =append (_dg ._efgd ,_adg ...);};};};if _dec .Pic !=nil {_ada :=false ;
var _cc ,_cbe ,_eadb ,_dd float64 ;if _cce :=_dec .Pic .SpPr ;_cce !=nil {if _ecb :=_cce .Xfrm ;_ecb !=nil {_cc ,_cbe ,_eadb ,_dd =_a .GetDataFromXfrm (_ecb );_ada =true ;};};var _efc _eeg .ST_PlaceholderType ;var _dgf *uint32 ;if _ca :=_dec .Pic .NvPicPr ;
_ca !=nil {if _aegc :=_ca .NvPr ;_aegc !=nil {if _fcd :=_aegc .Ph ;_fcd !=nil {_efc =_fcd .TypeAttr ;_dgf =_fcd .IdxAttr ;};};};_eaf ,_ ,_ ,_ ,_ :=_bggc (_dg ._fefd .CSld ,_efc ,_dgf );_fcb ,_ ,_ ,_ ,_ :=_bggc (_dg ._cgfc .CSld ,_efc ,_dgf );if _fcb ==nil {_fcb =_eaf ;
};if _fcb !=nil &&!_ada {_cc ,_cbe ,_eadb ,_dd =_a .GetDataFromXfrm (_fcb );};if _agac :=_dec .Pic .BlipFill ;_agac !=nil {_eafe :=_dg .getShapeFromBlipFill (_agac ,_cc ,_cbe ,_eadb ,_dd ,_ae );_dg ._efgd =append (_dg ._efgd ,_eafe );};};};};};};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_bbb .Presentation )*_edf .Creator {return ConvertToPdfWithOptions (pr ,nil )};func (_fcfe *convertContext )getColorFromMatrixReference (_dbce *_fb .CT_StyleMatrixReference )_edf .Color {if _dbce ==nil {return nil ;};var _fabd _edf .Color ;
var _efec string ;if _badge :=_dbce .SrgbClr ;_badge !=nil {_efec =_badge .ValAttr ;}else if _fbda :=_dbce .SchemeClr ;_fbda !=nil {_efec =_a .GetColorStringFromDmlColor (_fcfe ._ege .GetColorBySchemeColor (_fbda .ValAttr ));_efec =_a .AdjustColor (_efec ,_fbda .EG_ColorTransform );
};if _efec !=""{_fabd =_edf .ColorRGBFromHex ("\u0023"+_efec );};return _fabd ;};func (_adef *convertContext )applyBlipEffectsOnImg (_ecaa *_edf .Image ,_acdf ,_gadcc float64 ,_accad []*_fb .CT_BlipChoice )*_edf .Image {if len (_accad )==0{return _ecaa ;
};_ecaa .SetPos (_acdf ,_gadcc );_cfae ,_gedb :=_adef .renderPageWithDrawableToGoImage (_ecaa );if _gedb !=nil {_ea .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_gedb );
return _ecaa ;};_faba ,_gedb :=_adef .renderCurrentStateToGoImage ();if _gedb !=nil {_ea .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_gedb );
return _ecaa ;};_cdac :=_cfae .Bounds ();_cgg :=_ee .NewRGBA (_cdac );_aeea ,_badgg :=_ecaa .Width (),_ecaa .Height ();for _ ,_gedf :=range _accad {if _gaff :=_gedf .AlphaModFix ;_gaff ==nil {continue ;};if _cede :=_gedf .AlphaModFix .AmtAttr ;_cede !=nil {if _bacf :=_cede .ST_PositivePercentageDecimal ;
_bacf !=nil {_gbgf :=uint8 (255*(*_bacf )/100000);_cgc :=_ee .NewUniform (_b .Alpha {_gbgf });_ed .Draw (_cgg ,_cdac ,_faba ,_ee .Point {0,0},_ed .Src );_ed .DrawMask (_cgg ,_cdac ,_cfae ,_ee .Point {0,0},_cgc ,_ee .Point {0,0},_ed .Over );};};};_gabg :=_ee .Rect (int (_acdf ),int (_gadcc ),int (_acdf +_aeea )+1,int (_gadcc +_badgg )+1);
_bfgb :=_a .CropImageByRect (_cgg ,_gabg );_abcbc ,_gedb :=_adef ._fab .NewImageFromGoImage (_bfgb );if _gedb !=nil {_ea .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_gedb );
return _ecaa ;};return _abcbc ;};func _ecda (_ggef ,_cfeda *_fb .CT_TableStyleTextStyle )*_fb .CT_TableStyleTextStyle {_gbfe :=_fb .NewCT_TableStyleTextStyle ();if _ggef !=nil {*_gbfe =*_ggef ;};if _cfeda ==nil {return _gbfe ;};if _gbfe .BAttr ==_fb .ST_OnOffStyleTypeUnset {_gbfe .BAttr =_cfeda .BAttr ;
};if _gbfe .IAttr ==_fb .ST_OnOffStyleTypeUnset {_gbfe .IAttr =_cfeda .IAttr ;};if _gbfe .ThemeableFontStylesChoice .Font ==nil {_gbfe .ThemeableFontStylesChoice .Font =_cfeda .ThemeableFontStylesChoice .Font ;};if _gbfe .ThemeableFontStylesChoice .FontRef ==nil {_gbfe .ThemeableFontStylesChoice .FontRef =_cfeda .ThemeableFontStylesChoice .FontRef ;
};if _gbfe .ScrgbClr ==nil {_gbfe .ScrgbClr =_cfeda .ScrgbClr ;};if _gbfe .SrgbClr ==nil {_gbfe .SrgbClr =_cfeda .SrgbClr ;};if _gbfe .HslClr ==nil {_gbfe .HslClr =_cfeda .HslClr ;};if _gbfe .SysClr ==nil {_gbfe .SysClr =_cfeda .SysClr ;};if _gbfe .SchemeClr ==nil {_gbfe .SchemeClr =_cfeda .SchemeClr ;
};if _gbfe .PrstClr ==nil {_gbfe .PrstClr =_cfeda .PrstClr ;};return _gbfe ;};func _aab (_adcbb ,_cbee *_fb .CT_TextCharacterProperties )*_fb .CT_TextCharacterProperties {_dagb :=_fb .NewCT_TextCharacterProperties ();if _adcbb !=nil {*_dagb =*_adcbb ;};
if _cbee ==nil {return _dagb ;};if _dagb .KumimojiAttr ==nil {_dagb .KumimojiAttr =_cbee .KumimojiAttr ;};if _dagb .LangAttr ==nil {_dagb .LangAttr =_cbee .LangAttr ;};if _dagb .AltLangAttr ==nil {_dagb .AltLangAttr =_cbee .AltLangAttr ;};if _dagb .SzAttr ==nil {_dagb .SzAttr =_cbee .SzAttr ;
};if _dagb .BAttr ==nil {_dagb .BAttr =_cbee .BAttr ;};if _dagb .IAttr ==nil {_dagb .IAttr =_cbee .IAttr ;};if _dagb .UAttr ==_fb .ST_TextUnderlineTypeUnset {_dagb .UAttr =_cbee .UAttr ;};if _dagb .StrikeAttr ==_fb .ST_TextStrikeTypeUnset {_dagb .StrikeAttr =_cbee .StrikeAttr ;
};if _dagb .KernAttr ==nil {_dagb .KernAttr =_cbee .KernAttr ;};if _dagb .CapAttr ==_fb .ST_TextCapsTypeUnset {_dagb .CapAttr =_cbee .CapAttr ;};if _dagb .SpcAttr ==nil {_dagb .SpcAttr =_cbee .SpcAttr ;};if _dagb .NormalizeHAttr ==nil {_dagb .NormalizeHAttr =_cbee .NormalizeHAttr ;
};if _dagb .BaselineAttr ==nil {_dagb .BaselineAttr =_cbee .BaselineAttr ;};if _dagb .NoProofAttr ==nil {_dagb .NoProofAttr =_cbee .NoProofAttr ;};if _dagb .DirtyAttr ==nil {_dagb .DirtyAttr =_cbee .DirtyAttr ;};if _dagb .ErrAttr ==nil {_dagb .ErrAttr =_cbee .ErrAttr ;
};if _dagb .SmtCleanAttr ==nil {_dagb .SmtCleanAttr =_cbee .SmtCleanAttr ;};if _dagb .SmtIdAttr ==nil {_dagb .SmtIdAttr =_cbee .SmtIdAttr ;};if _dagb .BmkAttr ==nil {_dagb .BmkAttr =_cbee .BmkAttr ;};if _dagb .Ln ==nil {_dagb .Ln =_cbee .Ln ;};if _dagb .FillPropertiesChoice .NoFill ==nil {_dagb .FillPropertiesChoice .NoFill =_cbee .FillPropertiesChoice .NoFill ;
};if _dagb .FillPropertiesChoice .SolidFill ==nil {_dagb .FillPropertiesChoice .SolidFill =_cbee .FillPropertiesChoice .SolidFill ;};if _dagb .FillPropertiesChoice .BlipFill ==nil {_dagb .FillPropertiesChoice .BlipFill =_cbee .FillPropertiesChoice .BlipFill ;
};if _dagb .EffectPropertiesChoice .EffectLst ==nil {_dagb .EffectPropertiesChoice .EffectLst =_cbee .EffectPropertiesChoice .EffectLst ;};if _dagb .EffectPropertiesChoice .EffectDag ==nil {_dagb .EffectPropertiesChoice .EffectDag =_cbee .EffectPropertiesChoice .EffectDag ;
};if _dagb .Highlight ==nil {_dagb .Highlight =_cbee .Highlight ;};if _dagb .TextUnderlineLineChoice .ULnTx ==nil {_dagb .TextUnderlineLineChoice .ULnTx =_cbee .TextUnderlineLineChoice .ULnTx ;};if _dagb .TextUnderlineLineChoice .ULn ==nil {_dagb .TextUnderlineLineChoice .ULn =_cbee .TextUnderlineLineChoice .ULn ;
};if _dagb .TextUnderlineFillChoice .UFillTx ==nil {_dagb .TextUnderlineFillChoice .UFillTx =_cbee .TextUnderlineFillChoice .UFillTx ;};if _dagb .TextUnderlineFillChoice .UFill ==nil {_dagb .TextUnderlineFillChoice .UFill =_cbee .TextUnderlineFillChoice .UFill ;
};if _dagb .Latin ==nil {_dagb .Latin =_cbee .Latin ;};if _dagb .Ea ==nil {_dagb .Ea =_cbee .Ea ;};if _dagb .Cs ==nil {_dagb .Cs =_cbee .Cs ;};if _dagb .Sym ==nil {_dagb .Sym =_cbee .Sym ;};if _dagb .Rtl ==nil {_dagb .Rtl =_cbee .Rtl ;};return _dagb ;};
func (_fecf *convertContext )addCellToTable (_fed *_edf .Table ,_caf *_fb .CT_TableCell ,_cab *_fb .CT_TablePartStyle ,_bbbe ,_fgee ,_acgd ,_aba bool )float64 {var _gffa *_edf .TableCell ;_addf :=1;if _caf .GridSpanAttr !=nil {_addf =int (*_caf .GridSpanAttr );
};_gffa =_fed .MultiColCell (_addf );_cbgac :=_caf .TcPr ;var _egda *_fb .CT_TableStyleTextStyle ;if _cab !=nil {_cbgac =_egabg (_cbgac ,_cab .TcStyle ,_bbbe ,_fgee ,_acgd ,_aba );_egda =_cab .TcTxStyle ;};_bcbc :=_gdg ;_aca :=_edf .CellVerticalAlignmentMiddle ;
_aebc :=_efcc (0.05);_egae :=_efcc (0.05);if _cbgac !=nil {if _abdd :=_cbgac .LnL ;_abdd !=nil {_bfcb ,_dgfa ,_adfd :=_fecf .getBorderStyle (_abdd );_gffa .SetBorder (_edf .CellBorderSideLeft ,_bfcb ,_adfd );if _dgfa !=nil &&*_dgfa !=nil {_gffa .SetSideBorderColor (_edf .CellBorderSideLeft ,*_dgfa );
};};if _bfaa :=_cbgac .LnT ;_bfaa !=nil {_fff ,_cecg ,_accfe :=_fecf .getBorderStyle (_bfaa );_gffa .SetBorder (_edf .CellBorderSideTop ,_fff ,_accfe );if _cecg !=nil &&*_cecg !=nil {_gffa .SetSideBorderColor (_edf .CellBorderSideTop ,*_cecg );};};if _bddga :=_cbgac .LnR ;
_bddga !=nil {_ffaf ,_cece ,_fbf :=_fecf .getBorderStyle (_bddga );_gffa .SetBorder (_edf .CellBorderSideRight ,_ffaf ,_fbf );if _cece !=nil &&*_cece !=nil {_gffa .SetSideBorderColor (_edf .CellBorderSideRight ,*_cece );};};if _adab :=_cbgac .LnB ;_adab !=nil {_bfbd ,_gacf ,_bcbb :=_fecf .getBorderStyle (_adab );
_gffa .SetBorder (_edf .CellBorderSideBottom ,_bfbd ,_bcbb );if _gacf !=nil &&*_gacf !=nil {_gffa .SetSideBorderColor (_edf .CellBorderSideBottom ,*_gacf );};};if _cccf :=_cbgac .MarLAttr ;_cccf !=nil {_bcbc =float64 (_a .FromSTCoordinate32 (*_cccf ));
};switch _cbgac .AnchorAttr {case _fb .ST_TextAnchoringTypeT :_aca =_edf .CellVerticalAlignmentTop ;case _fb .ST_TextAnchoringTypeB :_aca =_edf .CellVerticalAlignmentBottom ;};if _cbgac .FillPropertiesChoice .NoFill ==nil {if _bdcb :=_cbgac .FillPropertiesChoice .SolidFill ;
_bdcb !=nil {_fggc ,_cgd :=_fecf .getColorFromSolidFill (_bdcb );_gffa .SetOpacity (_cgd );_gffa .SetBackgroundColor (_fggc );};};if _bbeb :=_cbgac .MarBAttr ;_bbeb !=nil {_aebc =float64 (_a .FromSTCoordinate32 (*_bbeb ));};if _aefg :=_cbgac .MarTAttr ;
_aefg !=nil {_egae =float64 (_a .FromSTCoordinate32 (*_aefg ));};};_gffa .SetVerticalAlignment (_aca );_gffa .SetIndent (_bcbc );var _cgea float64 ;if _gcag :=_caf .TxBody ;_gcag !=nil {_gdaee :=_fecf .makePdfDivisionFromTxBody (_gcag ,_egda );_cgea =_gdaee .Height ()+_egae +_aebc ;
_gffa .SetContent (_gdaee );};return _cgea ;};func _bace (_gfgde ,_bffd *_fb .CT_TextBody )(*_fb .CT_TextBodyProperties ,*_fb .CT_TextListStyle ){if _gfgde ==nil &&_bffd ==nil {return nil ,nil ;};if _gfgde ==nil {return _bffd .BodyPr ,_bffd .LstStyle ;
};if _bffd ==nil {return _gfgde .BodyPr ,_gfgde .LstStyle ;};_beaa ,_bafa :=_gfgde .BodyPr ,_gfgde .LstStyle ;_ccbc ,_gedcb :=_bffd .BodyPr ,_bffd .LstStyle ;_efgdg :=_fbgc (_beaa ,_ccbc );_eedc :=_cecf (_bafa ,_gedcb );return _efgdg ,_eedc ;};func (_cfa *convertContext )getPhData (_dabcb *_eeg .CT_Shape )(*_fb .CT_Transform2D ,*_fb .CT_TextBodyProperties ,*_fb .CT_TextListStyle ,bool ,bool ,bool ){_fedc ,_gace :=_dccd (_dabcb );
_cceg ,_decf ,_bfec ,_bgfg ,_cgbf :=_bggc (_cfa ._fefd .CSld ,_fedc ,_gace );_gag ,_feag ,_cafef ,_fbfb ,_cccbf :=_bggc (_cfa ._cgfc .CSld ,_fedc ,_gace );if _gag ==nil {_gag =_cceg ;};_dbfcd ,_afg :=_bace (_feag ,_decf );var _decb ,_bbaa ,_ebgc bool ;
if _cafef ==nil {if _bfec !=nil {_decb =*_bfec ;};}else {_decb =*_cafef ;};if _cccbf ==nil {if _cgbf !=nil {_ebgc =*_cgbf ;};}else {_ebgc =*_cccbf ;};if _fbfb ==nil {if _bgfg !=nil {_bbaa =*_bgfg ;};}else {_bbaa =*_fbfb ;};return _gag ,_dbfcd ,_afg ,_decb ,_bbaa ,_ebgc ;
};func (_ffc *convertContext )tileImage (_def *_edf .Image ,_cba *_fb .CT_TileInfoProperties ,_fac ,_fcfg float64 )*_edf .Image {_gda ,_bae :=1.0,1.0;if _gfgd :=_cba .SxAttr ;_gfgd !=nil {_gda =_a .FromSTPercentage (_gfgd );};if _ddc :=_cba .SyAttr ;_ddc !=nil {_bae =_a .FromSTPercentage (_ddc );
};_aaa :=_a .MakeTempCreator (_fac ,_fcfg );_def .Scale (_gda ,_bae );_agc ,_gde :=_def .Width (),_def .Height ();var _cdb ,_ab float64 ;if _ade :=_cba .TxAttr ;_ade !=nil {_cdb =_eb .FromEMU (_a .FromSTCoordinate (*_ade ));};if _bcf :=_cba .TyAttr ;_bcf !=nil {_ab =_eb .FromEMU (_a .FromSTCoordinate (*_bcf ));
};if _cdb > 0{_cdb -=_agc ;};if _ab > 0{_ab -=_gde ;};_ecc :=_ffc ._cfgc /_agc +1;_dgfc :=_ffc ._eceg /_gde +1;for _caa :=0.0;_caa <=_ecc ;_caa ++{_ffa :=_caa *_agc ;for _eca :=0.0;_eca <=_dgfc ;_eca ++{_ecba :=_eca *_gde ;_def .SetPos (_ffa +_cdb ,_ecba +_ab );
_aaa .Draw (_def );};};_dff ,_eege :=_a .GetPageFromCreator (_aaa );if _eege !=nil {_ea .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_eege );
return nil ;};_aac ,_eege :=_cf .NewImageDevice ().Render (_dff );if _eege !=nil {_ea .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_eege );return nil ;};
_ebdb ,_eege :=_ffc ._fab .NewImageFromGoImage (_aac );if _eege !=nil {_ea .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_eege );
return nil ;};return _ebdb ;};func (_begb *convertContext )makePdfDivisionFromTxBody (_bfc *_fb .CT_TextBody ,_aec *_fb .CT_TableStyleTextStyle )*_edf .Division {_acf :=_begb ._fab .NewDivision ();_bcdc :=_begb ._baa ;_cbd :=_fb .ST_TextAnchoringTypeT ;
if _deg :=_bfc .BodyPr ;_deg !=nil {if _ded :=_deg .AnchorAttr ;_ded !=_fb .ST_TextAnchoringTypeUnset {_cbd =_deg .AnchorAttr ;};};if _abcb :=_bfc .LstStyle ;_abcb !=nil {var _ebag *_fb .CT_TextParagraphProperties ;if _abcb .Lvl1pPr !=nil {_ebag =_abcb .Lvl1pPr ;
}else {_ebag =_begb ._bea [0];};_bcdc =_caad (_ebag ,_caad (_abcb .DefPPr ,_bcdc ));};for _ ,_eccf :=range _bfc .P {if _eccf !=nil {_ebe :=_begb ._fab .NewStyledParagraph ();_bda :=_caad (_eccf .PPr ,_bcdc );_egdd :=_aab (_eccf .EndParaRPr ,_bda .DefRPr );
switch _bda .AlgnAttr {case _fb .ST_TextAlignTypeR :_ebe .SetTextAlignment (_edf .TextAlignmentRight );case _fb .ST_TextAlignTypeCtr :_ebe .SetTextAlignment (_edf .TextAlignmentCenter );case _fb .ST_TextAlignTypeJust :_ebe .SetTextAlignment (_edf .TextAlignmentJustify );
};if len (_eccf .EG_TextRun )==0{_ebe .Append ("\u000a");_acf .Add (_ebe );continue ;};for _ ,_dda :=range _eccf .EG_TextRun {if _efb :=_dda .TextRunChoice .Br ;_efb !=nil {_ebe .Append ("\u000a");}else if _dfa :=_dda .TextRunChoice .R ;_dfa !=nil {_bec :=_gaba (_dfa .RPr ,_aec );
_bec =_aab (_bec ,_egdd );var _cef _edf .Color ;if _bec .FillPropertiesChoice .SolidFill !=nil {_cef ,_ =_begb .getColorFromSolidFill (_bec .FillPropertiesChoice .SolidFill );}else {_cef =_edf .ColorBlack ;};_eec ,_ccb ,_afa ,_ :=_begb .makeStyleFromRPr (_bec );
_eec .Color =_cef ;if _ccb {_eec .TextRise =0.5;}else if _afa {_eec .TextRise =-0.5;};_fbcc :=_dfa .T ;if _bec .CapAttr ==_fb .ST_TextCapsTypeAll {for _ ,_ega :=range _fbcc {_ega =[]rune (_d .ToUpper (string (_ega )))[0];};};_add :=_ebe .Append (_fbcc );
_add .Style =*_eec ;};};_ =_cbd ;_acf .Add (_ebe );};};return _acf ;};func (_cbeg *convertContext )getShapes (_cbf *_eeg .CT_Shape ,_ddb bool ,_abb bool )[]_edf .Drawable {_dgg :=[]_edf .Drawable {};_egd :=_cbf .SpPr ;if _egd ==nil {return _dgg ;};var _bga bool ;
if _ddg :=_cbf .UseBgFillAttr ;_ddg !=nil {_bga =*_ddg ;};_bfd ,_fgc ,_bbcb ,_fae ,_cbfa ,_gb ,_fbb :=_cbeg .getShapesFromSpPr (_egd ,_cbf .Style ,_bga ,0.0,0.0);if !_abb {_dgg =append (_dgg ,_bfd ...);};if _eba :=_cbf .TxBody ;_eba !=nil &&!_ddb {_ebc ,_ece ,_ggb ,_gefb ,_fbc ,_dbfc :=_cbeg .getPhData (_cbf );
if _abb &&!(_gefb ||_fbc ){return _dgg ;};if _ebc !=nil &&!_fbb {_fgc ,_bbcb ,_fae ,_cbfa =_a .GetDataFromXfrm (_ebc );};_bgd ,_beg :=_cbeg .makePdfBlockFromTxBody (_eba ,_ece ,_ggb ,_fae ,_cbfa ,_gb ,_gefb ,_dbfc );if _beg !=nil {_ea .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_beg );
}else if _bgd !=nil {_bgd .SetPos (_fgc ,_bbcb );_dgg =append (_dgg ,_bgd );};};return _dgg ;};func (_gcae *convertContext )getInfoFromLn (_agaf *_fb .CT_LineProperties )(_edf .Color ,float64 ,float64 ){if _agaf ==nil ||_agaf .LineFillPropertiesChoice .NoFill !=nil {return nil ,0,0;
};var _dgcd float64 ;_aece ,_abcc :=_gcae .getColorFromSolidFill (_agaf .LineFillPropertiesChoice .SolidFill );if _fgfe :=_agaf .WAttr ;_fgfe !=nil {_dgcd =_eb .FromEMU (int64 (*_fgfe ));}else {_dgcd =1;};return _aece ,_dgcd ,_abcc ;};func _dffa (_aecg int ,_adgg bool )string {_ggff :=_bb .NewBuffer ([]byte {});
for _ ,_caag :=range _fcbb {for {if _aecg < _caag ._abdb {break ;};_ggff .WriteString (_caag ._egdfe );_aecg -=_caag ._abdb ;};};_gecg :=_ggff .String ();if _adgg {_gecg =_d .ToUpper (_gecg );};return _gecg ;};func (_bgcf *convertContext )renderCurrentStateToGoImage ()(_ee .Image ,error ){_gdad :=_a .MakeTempCreator (_bgcf ._cfgc ,_bgcf ._eceg );
_gdad .NewPage ();for _ ,_bggd :=range _bgcf ._efgd {if _bggd !=nil {_gdad .MoveTo (0,0);_gdad .Draw (_bggd );};};_abae ,_bbebf :=_a .GetPageFromCreator (_gdad );if _bbebf !=nil {return nil ,_bbebf ;};return _cf .NewImageDevice ().Render (_abae );};type paragraph struct{_fadd float64 ;
_ffce float64 ;_aacfd float64 ;_gfgg float64 ;_fdc float64 ;_acbg float64 ;_baeb float64 ;_cga float64 ;_efba _fb .ST_TextAlignType ;_ebbe float64 ;_fgbe bool ;_fede []*line ;};func (_cagg *textboxContext )alignParagraph (){_bccb :=_cagg ._aebg ;if _bccb ._efba ==_fb .ST_TextAlignTypeL {return ;
};_agf :=len (_bccb ._fede )-1;for _dfgc ,_dcgg :=range _bccb ._fede {_bccf :=true ;_dfc :=len (_dcgg ._cccb );_acaa :=0.0;for _cbdb :=len (_dcgg ._cccb )-1;_cbdb >=0;_cbdb --{_fdf :=_dcgg ._cccb [_cbdb ];if _bccf &&_fdf ._ccba {_dfc =_cbdb ;}else {_bccf =false ;
for _ ,_bgbb :=range _fdf ._bgdb {_acaa +=_bgbb ._addd ;};};};_dcgg ._cccb =_dcgg ._cccb [:_dfc ];_cfba :=_dcgg ._fbeg -_dcgg ._bbgf -_acaa ;switch _bccb ._efba {case _fb .ST_TextAlignTypeR :_dcgg .moveRight (_cfba );case _fb .ST_TextAlignTypeCtr :_dcgg .moveRight (_cfba /2);
case _fb .ST_TextAlignTypeJust :if _dfgc !=_agf {_defb :=[]*word {};for _ ,_eagc :=range _dcgg ._cccb {if _eagc ._ccba {_defb =append (_defb ,_eagc );};};_adba :=_cfba /float64 (len (_defb ));for _ ,_gded :=range _defb {_gded ._cdfe +=_adba ;};var _egcg *word ;
for _ ,_bdfa :=range _dcgg ._cccb {if _egcg !=nil {_bdfa ._gegb =_egcg ._gegb +_egcg ._cdfe ;};_egcg =_bdfa ;};};};};};func (_cbeba *convertContext )getColorFromFontReference (_gafc *_fb .CT_FontReference )_edf .Color {var _bdb _edf .Color ;var _abdg string ;
if _adeg :=_gafc .SrgbClr ;_adeg !=nil {_abdg =_adeg .ValAttr ;}else if _cdga :=_gafc .SchemeClr ;_cdga !=nil {_abdg =_a .GetColorStringFromDmlColor (_cbeba ._ege .GetColorBySchemeColor (_cdga .ValAttr ));_abdg =_a .AdjustColor (_abdg ,_cdga .EG_ColorTransform );
};if _abdg !=""{_bdb =_edf .ColorRGBFromHex ("\u0023"+_abdg );};return _bdb ;};func (_fccb *convertContext )getColorFromSolidFill (_cgde *_fb .CT_SolidColorFillProperties )(_edf .Color ,float64 ){if _cgde ==nil {return nil ,1;};var _ceg string ;_cdg :=1.0;
if _ebec :=_cgde .SrgbClr ;_ebec !=nil {_ceg =_ebec .ValAttr ;_cdg =_a .GetOpacityFromColorTransform (_ebec .EG_ColorTransform );}else if _ggac :=_cgde .SchemeClr ;_ggac !=nil {_ceg =_a .GetColorStringFromDmlColor (_fccb ._deda .GetColorBySchemeColor (_ggac .ValAttr ));
_ceg =_a .AdjustColor (_ceg ,_ggac .EG_ColorTransform );_cdg =_a .GetOpacityFromColorTransform (_ggac .EG_ColorTransform );};if _ceg !=""{_ffb :=_edf .ColorRGBFromHex ("\u0023"+_ceg );return _ffb ,_cdg ;};return nil ,1;};type textboxContext struct{_fgd *convertContext ;
_fddc float64 ;_cae float64 ;_bcg *_edf .Creator ;_cfgd float64 ;_baf []*paragraph ;_aebg *paragraph ;_cddb *line ;_ggad *word ;_gce bool ;};func (_cdf *convertContext )makeStyleFromRPr (_acb *_fb .CT_TextCharacterProperties )(*_edf .TextStyle ,bool ,bool ,bool ){var _bfb ,_gadd ,_dfff bool ;
_fced :=_cdf ._fab .NewTextStyle ();if _acb !=nil {_cde :=_a .FontStyle_Regular ;_fdd :=_gggb (_acb .BAttr );_dgeg :=_gggb (_acb .IAttr );if _fdd &&_dgeg {_cde =_a .FontStyle_BoldItalic ;}else if _fdd {_cde =_a .FontStyle_Bold ;}else if _dgeg {_cde =_a .FontStyle_Italic ;
};_dfff =_acb .UAttr !=_fb .ST_TextUnderlineTypeUnset &&_acb .UAttr !=_fb .ST_TextUnderlineTypeNone ;_efcg :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _abd :=_acb .Latin ;_abd !=nil {_efcg =_abd .TypefaceAttr ;}else if _dabe :=_acb .Ea ;_dabe !=nil {_efcg =_dabe .TypefaceAttr ;
}else if _gfd :=_acb .Cs ;_gfd !=nil {_efcg =_gfd .TypefaceAttr ;}else if _fcde :=_acb .Sym ;_fcde !=nil {_efcg =_fcde .TypefaceAttr ;};if _defa ,_fba :=_a .StdFontsMap [_efcg ];_fba {_fced .Font =_a .AssignStdFontByName (_fced ,_defa [_cde ]);}else if _afd :=_a .GetRegisteredFont (_efcg ,_cde );
_afd !=nil {_fced .Font =_afd ;}else {_ea .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_efcg ,_cde );
_fced .Font =_a .AssignStdFontByName (_fced ,_a .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_cde ]);};var _bcca float64 ;if _bfce :=_acb .SzAttr ;_bfce !=nil {_bcca =_cg .Round (float64 (*_bfce )/100)-0.5;}else {_bcca =_a .DefaultFontSize ;};
if _fded :=_acb .BaselineAttr ;_fded !=nil {if _dedd :=_fded .ST_PercentageDecimal ;_dedd !=nil {if *_dedd > 0{_bfb =true ;}else if *_dedd < 0{_gadd =true ;};};};if _bfb ||_gadd {_bcca =_cg .Round (_bcca *0.64);};_fced .FontSize =_bcca ;_ceca :=0.0;if _efda :=_acb .SpcAttr ;
_efda !=nil {if _bcfg :=_efda .ST_TextPointUnqualified ;_bcfg !=nil &&*_bcfg > 0{_ceca =float64 (*_bcfg )/100;};};_fced .CharSpacing =_ceca ;};return &_fced ,_bfb ,_gadd ,_dfff ;};func (_fgcd *textboxContext )addPrefix (_ggaa *prefixData ,_gdeed *_edf .TextStyle ){_eef :=_bgbd (_ggaa ._gedc );
_afad :=*_gdeed ;if _ggaa ._cacd {_afad .Font =_a .AssignStdFontByName (_afad ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_dcf :=range _eef {_dcf ._bab =&_afad ;_fgcd .addTextSymbol (_dcf );};_eee :=-(_ggaa ._fgf +_fgcd ._ggad ._cdfe );if _eee < 0{_eee =0;
};_bca :=&symbol {_faea :"\u0020",_addd :_eee };_fgcd .addTextSymbol (_bca );_fgcd ._ggad ._gegb +=(_ggaa ._fgf +_ggaa ._fdafe );};func (_dge *convertContext )getConnectors (_efe *_eeg .CT_Connector )[]_edf .Drawable {_defd ,_ ,_ ,_ ,_ ,_ ,_ :=_dge .getShapesFromSpPr (_efe .SpPr ,_efe .Style ,false ,0.0,0.0);
return _defd ;};func _egabg (_decfa *_fb .CT_TableCellProperties ,_dfgg *_fb .CT_TableStyleCellStyle ,_gege ,_gcba ,_aabf ,_bbcc bool )*_fb .CT_TableCellProperties {_fafb :=_fb .NewCT_TableCellProperties ();if _decfa !=nil {*_fafb =*_decfa ;};if _dfgg ==nil {return _fafb ;
};if _bfed :=_dfgg .ThemeableFillStyleChoice .FillRef ;_bfed !=nil {_edfc :=_fb .NewCT_SolidColorFillProperties ();_edfc .ScrgbClr =_bfed .ScrgbClr ;_edfc .SrgbClr =_bfed .SrgbClr ;_edfc .HslClr =_bfed .HslClr ;_edfc .SysClr =_bfed .SysClr ;_edfc .SchemeClr =_bfed .SchemeClr ;
_edfc .PrstClr =_bfed .PrstClr ;_fafb .FillPropertiesChoice .SolidFill =_edfc ;};if _fafb .FillPropertiesChoice .NoFill ==nil &&_fafb .FillPropertiesChoice .SolidFill ==nil {if _eegd :=_dfgg .ThemeableFillStyleChoice .Fill ;_eegd !=nil {if _fafb .FillPropertiesChoice .NoFill ==nil {_fafb .FillPropertiesChoice .NoFill =_eegd .FillPropertiesChoice .NoFill ;
};if _fafb .FillPropertiesChoice .SolidFill ==nil {_fafb .FillPropertiesChoice .SolidFill =_eegd .FillPropertiesChoice .SolidFill ;};};};if _ffbe :=_dfgg .TcBdr ;_ffbe !=nil {if _fafb .LnL ==nil {var _cfbd *_fb .CT_ThemeableLineStyle ;if _aabf {_cfbd =_ffbe .Left ;
}else {_cfbd =_ffbe .InsideV ;};if _cfbd !=nil {_fafb .LnL =_cfbd .ThemeableLineStyleChoice .Ln ;};};if _fafb .LnR ==nil {var _debf *_fb .CT_ThemeableLineStyle ;if _bbcc {_debf =_ffbe .Right ;}else {_debf =_ffbe .InsideV ;};if _debf !=nil {_fafb .LnR =_debf .ThemeableLineStyleChoice .Ln ;
};};if _fafb .LnT ==nil {var _decd *_fb .CT_ThemeableLineStyle ;if _gege {_decd =_ffbe .Top ;}else {_decd =_ffbe .InsideH ;};if _decd !=nil {_fafb .LnT =_decd .ThemeableLineStyleChoice .Ln ;};};if _fafb .LnB ==nil {var _ccab *_fb .CT_ThemeableLineStyle ;
if _gcba {_ccab =_ffbe .Bottom ;}else {_ccab =_ffbe .InsideH ;};if _ccab !=nil {_fafb .LnB =_ccab .ThemeableLineStyleChoice .Ln ;};};};return _fafb ;};func (_egdb *convertContext )getGroupConnectors (_cbg *_eeg .CT_Connector ,_cda float64 ,_bcb float64 )[]_edf .Drawable {_agb ,_ ,_ ,_ ,_ ,_ ,_ :=_egdb .getShapesFromSpPr (_cbg .SpPr ,_cbg .Style ,false ,_cda ,_bcb );
return _agb ;};type convertContext struct{_fab *_edf .Creator ;_ebdg *_a .Rectangle ;_ege *_bbb .Presentation ;_deda *_bbb .Slide ;_fefd *_eeg .SldMaster ;_cgfc *_eeg .SldLayout ;_eceg float64 ;_cfgc float64 ;_efgd []_edf .Drawable ;_fgbc *background ;
_baa *_fb .CT_TextParagraphProperties ;_eegbc *_fb .CT_TextCharacterProperties ;_gadc *_fb .CT_TextParagraphProperties ;_efde *_fb .CT_TextCharacterProperties ;_fbgb *_fb .CT_TextParagraphProperties ;_facb *_fb .CT_TextCharacterProperties ;_bea []*_fb .CT_TextParagraphProperties ;
_ebfb []*_fb .CT_TextParagraphProperties ;_edfd []*_fb .CT_TextParagraphProperties ;_fbbb *_fb .Theme ;_cdd *_fb .CT_ColorMappingOverride ;};type word struct{_bgdb []*symbol ;_gegb float64 ;_cdfe float64 ;_ccba bool ;};func (_caee *textboxContext )newWord (){_caee ._ggad =&word {_ccba :true ,_gegb :_caee ._cddb ._eadc }};
