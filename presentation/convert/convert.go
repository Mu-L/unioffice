//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_cg "bytes";_d "errors";_e "github.com/unidoc/unioffice/common";_db "github.com/unidoc/unioffice/common/logger";_ae "github.com/unidoc/unioffice/common/tempstorage";_dgc "github.com/unidoc/unioffice/internal/convertutils";_fd "github.com/unidoc/unioffice/measurement";
_a "github.com/unidoc/unioffice/presentation";_ea "github.com/unidoc/unioffice/schema/soo/dml";_fc "github.com/unidoc/unioffice/schema/soo/dml/chart";_de "github.com/unidoc/unioffice/schema/soo/pml";_gc "github.com/unidoc/unipdf/v3/contentstream/draw";
_ba "github.com/unidoc/unipdf/v3/core";_gb "github.com/unidoc/unipdf/v3/creator";_bg "github.com/unidoc/unipdf/v3/model";_ac "github.com/unidoc/unipdf/v3/render";_b "image";_c "image/color";_g "image/draw";_dd "math";_dg "strconv";_gd "strings";);func (_dbdf *convertContext )stretchImage (_dea *_gb .Image ,_ecf *_ea .CT_StretchInfoProperties ,_gdgf ,_gdff ,_fec ,_fbee float64 )(*_gb .Image ,float64 ,float64 ){_fgbc :=_ecf .FillRect ;
if _fgbc ==nil {_ada :=_dea .Width ()/_dea .Height ();_eag :=_fec /_fbee ;var _bbc ,_cfe float64 ;if _ada > _eag {_cfe =_fbee ;_bbc =_fbee *_ada ;}else {_bbc =_fec ;_cfe =_fec /_ada ;};_dea .Scale (_bbc /_dea .Width (),_cfe /_dea .Height ());return _dea ,_gdgf ,_gdff ;
};var _ccg ,_gee ,_ebba ,_eg float64 ;if _dccd :=_fgbc .LAttr ;_dccd !=nil {_ebba =_dgc .FromSTPercentage (_dccd );};if _dad :=_fgbc .TAttr ;_dad !=nil {_ccg =_dgc .FromSTPercentage (_dad );};if _dbgc :=_fgbc .RAttr ;_dbgc !=nil {_eg =_dgc .FromSTPercentage (_dbgc );
};if _dddg :=_fgbc .BAttr ;_dddg !=nil {_gee =_dgc .FromSTPercentage (_dddg );};_cddf :=_fec *(1-_ebba -_eg );_dcf :=_fbee *(1-_ccg -_gee );_dea .Scale (_cddf /_dea .Width (),_dcf /_dea .Height ());return _dea ,_gdgf +_ebba *_fec ,_gdff +_ccg *_fbee ;};
func _daeb (_caee ,_ccec *_ea .CT_TextListStyle )*_ea .CT_TextListStyle {_cfga :=_ea .NewCT_TextListStyle ();if _caee !=nil {*_cfga =*_caee ;};if _ccec ==nil {return _cfga ;};_cfga .DefPPr =_eadc (_cfga .DefPPr ,_ccec .DefPPr );_cfga .Lvl1pPr =_eadc (_cfga .Lvl1pPr ,_ccec .Lvl1pPr );
_cfga .Lvl2pPr =_eadc (_cfga .Lvl2pPr ,_ccec .Lvl2pPr );_cfga .Lvl3pPr =_eadc (_cfga .Lvl3pPr ,_ccec .Lvl3pPr );_cfga .Lvl4pPr =_eadc (_cfga .Lvl4pPr ,_ccec .Lvl4pPr );_cfga .Lvl5pPr =_eadc (_cfga .Lvl5pPr ,_ccec .Lvl5pPr );_cfga .Lvl6pPr =_eadc (_cfga .Lvl6pPr ,_ccec .Lvl6pPr );
_cfga .Lvl7pPr =_eadc (_cfga .Lvl7pPr ,_ccec .Lvl7pPr );_cfga .Lvl8pPr =_eadc (_cfga .Lvl8pPr ,_ccec .Lvl8pPr );_cfga .Lvl9pPr =_eadc (_cfga .Lvl9pPr ,_ccec .Lvl9pPr );return _cfga ;};func (_cfb *convertContext )getGroupConnectors (_dgaa *_de .CT_Connector ,_cbe float64 ,_dfda float64 )[]_gb .Drawable {_ffcc ,_ ,_ ,_ ,_ ,_ ,_ :=_cfb .getShapesFromSpPr (_dgaa .SpPr ,_dgaa .Style ,false ,_cbe ,_dfda );
return _ffcc ;};func (_ab *convertContext )makePdfBlockFromChart (_af *_fc .Chart ,_bb ,_gg float64 )(*_gb .Block ,error ){_ad :=_af .CT_RelId .IdAttr ;_cc :=_ab ._gcgb .GetChartSpaceByRelId (_ad );if _cc ==nil {return nil ,_d .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");
};var _aa *_ea .Theme ;_bf :=_ab ._dda .Themes ();if len (_bf )> 0{_aa =_bf [0];};return _dgc .MakeBlockFromChartSpace (_cc ,_bb ,_gg ,_aa );};func _bdcbf (_dfegc string )[]*symbol {_gac :=[]*symbol {};for _ ,_aggdg :=range _dfegc {_gac =append (_gac ,&symbol {_efgb :string (_aggdg )});
};return _gac ;};func _eda (_gabc ,_cabc *_ea .CT_TablePartStyle )*_ea .CT_TablePartStyle {_dffe :=_ea .NewCT_TablePartStyle ();if _gabc !=nil {*_dffe =*_gabc ;};if _cabc ==nil {return _dffe ;};if _dffe .TcTxStyle ==nil {_dffe .TcTxStyle =_cabc .TcTxStyle ;
}else {_dffe .TcTxStyle =_dab (_dffe .TcTxStyle ,_cabc .TcTxStyle );};if _dffe .TcStyle ==nil {_dffe .TcStyle =_cabc .TcStyle ;}else {_dffe .TcStyle =_eecc (_dffe .TcStyle ,_cabc .TcStyle );};return _dffe ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_bg .PdfFont ){_dgc .RegisterFont (name ,style ,font );};func _gdfd (_ebag ,_eaga *_ea .CT_TextBody )(*_ea .CT_TextBodyProperties ,*_ea .CT_TextListStyle ){if _ebag ==nil &&_eaga ==nil {return nil ,nil ;
};if _ebag ==nil {return _eaga .BodyPr ,_eaga .LstStyle ;};if _eaga ==nil {return _ebag .BodyPr ,_ebag .LstStyle ;};_degf ,_gfebc :=_ebag .BodyPr ,_ebag .LstStyle ;_cebg ,_cacf :=_eaga .BodyPr ,_eaga .LstStyle ;_gfgb :=_cbeb (_degf ,_cebg );_edfbg :=_daeb (_gfebc ,_cacf );
return _gfgb ,_edfbg ;};type convertContext struct{_fcd *_gb .Creator ;_febd *_dgc .Rectangle ;_dda *_a .Presentation ;_gcgb *_a .Slide ;_eef *_de .SldMaster ;_afge *_de .SldLayout ;_gfff float64 ;_cffg float64 ;_bdg []_gb .Drawable ;_baaf *background ;
_acf *_ea .CT_TextParagraphProperties ;_bedf *_ea .CT_TextCharacterProperties ;_cfef *_ea .CT_TextParagraphProperties ;_gcda *_ea .CT_TextCharacterProperties ;_gdbf *_ea .CT_TextParagraphProperties ;_dcgf *_ea .CT_TextCharacterProperties ;_dfb []*_ea .CT_TextParagraphProperties ;
_fddc []*_ea .CT_TextParagraphProperties ;_adgbf []*_ea .CT_TextParagraphProperties ;_aece *_ea .Theme ;_cfee *_ea .CT_ColorMappingOverride ;};func (_egd *convertContext )makePdfDivisionFromTxBody (_bdbg *_ea .CT_TextBody ,_aee *_ea .CT_TableStyleTextStyle )*_gb .Division {_dcfg :=_egd ._fcd .NewDivision ();
_bcgd :=_egd ._acf ;_gdc :=_ea .ST_TextAnchoringTypeT ;if _bfc :=_bdbg .BodyPr ;_bfc !=nil {if _gccg :=_bfc .AnchorAttr ;_gccg !=_ea .ST_TextAnchoringTypeUnset {_gdc =_bfc .AnchorAttr ;};};if _eggb :=_bdbg .LstStyle ;_eggb !=nil {var _gfc *_ea .CT_TextParagraphProperties ;
if _eggb .Lvl1pPr !=nil {_gfc =_eggb .Lvl1pPr ;}else {_gfc =_egd ._dfb [0];};_bcgd =_eadc (_gfc ,_eadc (_eggb .DefPPr ,_bcgd ));};for _ ,_gad :=range _bdbg .P {if _gad !=nil {_abeg :=_egd ._fcd .NewStyledParagraph ();_daa :=_eadc (_gad .PPr ,_bcgd );_ggf :=_bedfg (_gad .EndParaRPr ,_daa .DefRPr );
switch _daa .AlgnAttr {case _ea .ST_TextAlignTypeR :_abeg .SetTextAlignment (_gb .TextAlignmentRight );case _ea .ST_TextAlignTypeCtr :_abeg .SetTextAlignment (_gb .TextAlignmentCenter );case _ea .ST_TextAlignTypeJust :_abeg .SetTextAlignment (_gb .TextAlignmentJustify );
};if len (_gad .EG_TextRun )==0{_abeg .Append ("\u000a");_dcfg .Add (_abeg );continue ;};for _ ,_fa :=range _gad .EG_TextRun {if _bgbf :=_fa .Br ;_bgbf !=nil {_abeg .Append ("\u000a");}else if _ddf :=_fa .R ;_ddf !=nil {_ecgf :=_ecgc (_ddf .RPr ,_aee );
_ecgf =_bedfg (_ecgf ,_ggf );var _fgbg _gb .Color ;if _ecgf .SolidFill !=nil {_fgbg ,_ =_egd .getColorFromSolidFill (_ecgf .SolidFill );}else {_fgbg =_gb .ColorBlack ;};_gbb ,_dcfc ,_daae ,_ :=_egd .makeStyleFromRPr (_ecgf );_gbb .Color =_fgbg ;if _dcfc {_gbb .TextRise =0.5;
}else if _daae {_gbb .TextRise =-0.5;};_feb :=_ddf .T ;if _ecgf .CapAttr ==_ea .ST_TextCapsTypeAll {for _ ,_gfb :=range _feb {_gfb =[]rune (_gd .ToUpper (string (_gfb )))[0];};};_gdfg :=_abeg .Append (_feb );_gdfg .Style =*_gbb ;};};_ =_gdc ;_dcfg .Add (_abeg );
};};return _dcfg ;};func _agaf (_adbg *_ea .CT_TableCellProperties ,_eceea *_ea .CT_TableStyleCellStyle ,_gbbb ,_decb ,_ddfe ,_cedg bool )*_ea .CT_TableCellProperties {_gbce :=_ea .NewCT_TableCellProperties ();if _adbg !=nil {*_gbce =*_adbg ;};if _eceea ==nil {return _gbce ;
};if _dggb :=_eceea .FillRef ;_dggb !=nil {_dgea :=_ea .NewCT_SolidColorFillProperties ();_dgea .ScrgbClr =_dggb .ScrgbClr ;_dgea .SrgbClr =_dggb .SrgbClr ;_dgea .HslClr =_dggb .HslClr ;_dgea .SysClr =_dggb .SysClr ;_dgea .SchemeClr =_dggb .SchemeClr ;
_dgea .PrstClr =_dggb .PrstClr ;_gbce .SolidFill =_dgea ;};if _gbce .NoFill ==nil &&_gbce .SolidFill ==nil {if _decac :=_eceea .Fill ;_decac !=nil {if _gbce .NoFill ==nil {_gbce .NoFill =_decac .NoFill ;};if _gbce .SolidFill ==nil {_gbce .SolidFill =_decac .SolidFill ;
};};};if _ffcf :=_eceea .TcBdr ;_ffcf !=nil {if _gbce .LnL ==nil {var _bcb *_ea .CT_ThemeableLineStyle ;if _ddfe {_bcb =_ffcf .Left ;}else {_bcb =_ffcf .InsideV ;};if _bcb !=nil {_gbce .LnL =_bcb .Ln ;};};if _gbce .LnR ==nil {var _cadf *_ea .CT_ThemeableLineStyle ;
if _cedg {_cadf =_ffcf .Right ;}else {_cadf =_ffcf .InsideV ;};if _cadf !=nil {_gbce .LnR =_cadf .Ln ;};};if _gbce .LnT ==nil {var _eebf *_ea .CT_ThemeableLineStyle ;if _gbbb {_eebf =_ffcf .Top ;}else {_eebf =_ffcf .InsideH ;};if _eebf !=nil {_gbce .LnT =_eebf .Ln ;
};};if _gbce .LnB ==nil {var _gae *_ea .CT_ThemeableLineStyle ;if _decb {_gae =_ffcf .Bottom ;}else {_gae =_ffcf .InsideH ;};if _gae !=nil {_gbce .LnB =_gae .Ln ;};};};return _gbce ;};func (_edbc *textboxContext )adjustHeights (_ebbae float64 ){if _edbc ._ecca ._dbdff < _ebbae {_edbc ._ecdg ._dagf +=(_ebbae -_edbc ._ecca ._dbdff );
_edbc ._ecca ._dbdff =_ebbae ;};};func _cad (_bbff int ,_dcca bool )string {_dfbc :=_cg .NewBuffer ([]byte {});for _ ,_eee :=range _fffa {for {if _bbff < _eee ._acea {break ;};_dfbc .WriteString (_eee ._efdd );_bbff -=_eee ._acea ;};};_ebbg :=_dfbc .String ();
if _dcca {_ebbg =_gd .ToUpper (_ebbg );};return _ebbg ;};func _eecc (_gbdg ,_cccae *_ea .CT_TableStyleCellStyle )*_ea .CT_TableStyleCellStyle {_cbce :=_ea .NewCT_TableStyleCellStyle ();if _gbdg !=nil {*_cbce =*_gbdg ;};if _cccae ==nil {return _cbce ;};
if _cbce .TcBdr ==nil {_cbce .TcBdr =_cccae .TcBdr ;};if _cbce .Fill ==nil {_cbce .Fill =_cccae .Fill ;};if _cbce .FillRef ==nil {_cbce .FillRef =_cccae .FillRef ;};return _cbce ;};type paragraph struct{_bgeg float64 ;_agc float64 ;_fdaf float64 ;_dbe float64 ;
_aggc float64 ;_ffae float64 ;_edbb float64 ;_dagf float64 ;_bede _ea .ST_TextAlignType ;_cgba float64 ;_dae bool ;_ega []*line ;};func (_agdf *convertContext )makePdfImageFromBlipFill (_cggg *_ea .CT_BlipFillProperties ,_geeg bool )(*_gb .Image ,[]*_ea .CT_BlipChoice ,error ){if _edee :=_cggg .Blip ;
_edee !=nil {if _fdef :=_edee .EmbedAttr ;_fdef !=nil {var _abab _e .ImageRef ;var _adae bool ;if _geeg {_abab ,_adae =_agdf ._gcgb .GetLayoutImageByRelID (*_fdef );}else {_abab ,_adae =_agdf ._gcgb .GetImageByRelID (*_fdef );};if _adae {_bfab ,_egac :=_ae .Open (_abab .Path ());
if _egac !=nil {_db .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_egac );return nil ,nil ,_egac ;};defer _bfab .Close ();_gggfb ,_ ,_egac :=_b .Decode (_bfab );if _egac !=nil {_db .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_egac );
return nil ,nil ,_egac ;};if _eeg :=_cggg .SrcRect ;_eeg !=nil {_aeca :=_gggfb .Bounds ().Size ();_egb :=_aeca .X ;_eeeg :=_aeca .Y ;var _bbgf ,_dcgfd ,_bfg ,_dbef int ;var _eageb bool ;if _egcfb :=_eeg .LAttr ;_egcfb !=nil {_bbgf =int (float64 (_egb )*_dgc .FromSTPercentage (_egcfb ));
_eageb =true ;}else {_bbgf =0;};if _bbfb :=_eeg .TAttr ;_bbfb !=nil {_bfg =int (float64 (_eeeg )*_dgc .FromSTPercentage (_bbfb ));_eageb =true ;}else {_bfg =0;};if _fbd :=_eeg .RAttr ;_fbd !=nil {_dcgfd =int (float64 (_egb )*(1-_dgc .FromSTPercentage (_fbd )));
_eageb =true ;}else {_dcgfd =_egb ;};if _fgee :=_eeg .BAttr ;_fgee !=nil {_dbef =int (float64 (_eeeg )*(1-_dgc .FromSTPercentage (_fgee )));_eageb =true ;}else {_dbef =_eeeg ;};if _eageb {_gggfb =_dgc .CropImageByRect (_gggfb ,_b .Rect (_bbgf ,_bfg ,_dcgfd +1,_dbef +1));
};};_aaaa ,_egac :=_agdf ._fcd .NewImageFromGoImage (_gggfb );_aaaa .SetEncoder (_ba .NewFlateEncoder ());if _gd .ToLower (_abab .Format ())=="\u006a\u0070\u0067"||_gd .ToLower (_abab .Format ())=="\u006a\u0070\u0065\u0067"{_aaaa .SetEncoder (_ba .NewDCTEncoder ());
};if _egac !=nil {_db .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_egac );
return nil ,nil ,_egac ;};return _aaaa ,_edee .Choice ,nil ;};};};return nil ,nil ,nil ;};func (_bgbg *convertContext )renderCurrentStateToGoImage ()(_b .Image ,error ){_dacf :=_dgc .MakeTempCreator (_bgbg ._cffg ,_bgbg ._gfff );_dacf .NewPage ();for _ ,_faag :=range _bgbg ._bdg {if _faag !=nil {_dacf .MoveTo (0,0);
_dacf .Draw (_faag );};};_cbcc ,_bcga :=_dgc .GetPageFromCreator (_dacf );if _bcga !=nil {return nil ,_bcga ;};return _ac .NewImageDevice ().Render (_cbcc );};func (_ggce *textboxContext )newLine (){if _ggce ._ecdg ==nil {_ggce .newParagraph ();};_cgbd :=_ggce ._ecdg ._dagf +_ggce ._ecdg ._agc ;
_fde :=&line {};_fde ._faa =_ggce ._ecdg ._aggc ;if len (_ggce ._ecdg ._ega )==0{_fde ._faa +=_ggce ._ecdg ._dbe ;};_fde ._fbbg =_ggce ._ecdg ._ffae ;_fde ._gbd =_fde ._faa ;_fde ._fege =_cgbd ;_ggce ._ecdg ._ega =append (_ggce ._ecdg ._ega ,_fde );_ggce ._ecca =_fde ;
};type symbol struct{_efgb string ;_ccb float64 ;_eec float64 ;_dcfcd float64 ;_gbge float64 ;_acfc float64 ;_ecgg *_gb .TextStyle ;_abc string ;_cfag bool ;_fcdd bool ;_dddgfd bool ;};func _aae (_aced float64 )float64 {return _aced *_fd .Millimeter };
func (_ccbg *textboxContext )addPrefix (_gdac *prefixData ,_cbfc *_gb .TextStyle ){_dace :=_bdcbf (_gdac ._feebf );_cbb :=*_cbfc ;if _gdac ._acc {_cbb .Font =_dgc .AssignStdFontByName (_cbb ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_ceca :=range _dace {_ceca ._ecgg =&_cbb ;
_ccbg .addTextSymbol (_ceca );};_ccdb :=-(_gdac ._edeg +_ccbg ._acff ._dbca );if _ccdb < 0{_ccdb =0;};_ccgg :=&symbol {_efgb :"\u0020",_acfc :_ccdb };_ccbg .addTextSymbol (_ccgg );_ccbg ._acff ._bgff +=(_gdac ._edeg +_gdac ._gfg );};func (_edcd *convertContext )getColorFromFontReference (_fgcb *_ea .CT_FontReference )_gb .Color {var _dfgba _gb .Color ;
var _eccdd string ;if _eade :=_fgcb .SrgbClr ;_eade !=nil {_eccdd =_eade .ValAttr ;}else if _cffac :=_fgcb .SchemeClr ;_cffac !=nil {_eccdd =_dgc .GetColorStringFromDmlColor (_edcd ._dda .GetColorBySchemeColor (_cffac .ValAttr ));_eccdd =_dgc .AdjustColor (_eccdd ,_cffac .EG_ColorTransform );
};if _eccdd !=""{_dfgba =_gb .ColorRGBFromHex ("\u0023"+_eccdd );};return _dfgba ;};type textboxContext struct{_dccce *convertContext ;_aegf float64 ;_fagb float64 ;_eed *_gb .Creator ;_gfeb float64 ;_afac []*paragraph ;_ecdg *paragraph ;_ecca *line ;_acff *word ;
_gbec bool ;};func (_bcdg *convertContext )addCellToTable (_aeab *_gb .Table ,_bba *_ea .CT_TableCell ,_dbdb *_ea .CT_TablePartStyle ,_gacb float64 ,_cegb ,_eccd ,_edcg ,_gafd bool )float64 {var _dddgf *_gb .TableCell ;_edec :=1;if _bba .GridSpanAttr !=nil {_edec =int (*_bba .GridSpanAttr );
};_dddgf =_aeab .MultiColCell (_edec );_abac :=_bba .TcPr ;var _fcee *_ea .CT_TableStyleTextStyle ;if _dbdb !=nil {_abac =_agaf (_abac ,_dbdb .TcStyle ,_cegb ,_eccd ,_edcg ,_gafd );_fcee =_dbdb .TcTxStyle ;};_abec :=_bc ;_efb :=_gb .CellVerticalAlignmentMiddle ;
_edca :=_bea (0.05);_ggd :=_bea (0.05);if _abac !=nil {if _cdga :=_abac .LnL ;_cdga !=nil {_bbdd ,_bddd ,_aadf :=_bcdg .getBorderStyle (_cdga );_dddgf .SetBorder (_gb .CellBorderSideLeft ,_bbdd ,_aadf );if _bddd !=nil &&*_bddd !=nil {_dddgf .SetSideBorderColor (_gb .CellBorderSideLeft ,*_bddd );
};};if _gbca :=_abac .LnT ;_gbca !=nil {_bda ,_cbca ,_gffg :=_bcdg .getBorderStyle (_gbca );_dddgf .SetBorder (_gb .CellBorderSideTop ,_bda ,_gffg );if _cbca !=nil &&*_cbca !=nil {_dddgf .SetSideBorderColor (_gb .CellBorderSideTop ,*_cbca );};};if _aac :=_abac .LnR ;
_aac !=nil {_fgf ,_egc ,_dfdf :=_bcdg .getBorderStyle (_aac );_dddgf .SetBorder (_gb .CellBorderSideRight ,_fgf ,_dfdf );if _egc !=nil &&*_egc !=nil {_dddgf .SetSideBorderColor (_gb .CellBorderSideRight ,*_egc );};};if _eaa :=_abac .LnB ;_eaa !=nil {_ceda ,_aabc ,_dgce :=_bcdg .getBorderStyle (_eaa );
_dddgf .SetBorder (_gb .CellBorderSideBottom ,_ceda ,_dgce );if _aabc !=nil &&*_aabc !=nil {_dddgf .SetSideBorderColor (_gb .CellBorderSideBottom ,*_aabc );};};if _caba :=_abac .MarLAttr ;_caba !=nil {_abec =float64 (_dgc .FromSTCoordinate32 (*_caba ));
};switch _abac .AnchorAttr {case _ea .ST_TextAnchoringTypeT :_efb =_gb .CellVerticalAlignmentTop ;case _ea .ST_TextAnchoringTypeB :_efb =_gb .CellVerticalAlignmentBottom ;};if _abac .NoFill ==nil {if _gcg :=_abac .SolidFill ;_gcg !=nil {_afdab ,_ :=_bcdg .getColorFromSolidFill (_gcg );
_dddgf .SetBackgroundColor (_afdab );};};if _bdfd :=_abac .MarBAttr ;_bdfd !=nil {_edca =float64 (_dgc .FromSTCoordinate32 (*_bdfd ));};if _dfdaf :=_abac .MarTAttr ;_dfdaf !=nil {_ggd =float64 (_dgc .FromSTCoordinate32 (*_dfdaf ));};};_dddgf .SetVerticalAlignment (_efb );
_dddgf .SetIndent (_abec );var _cffa float64 ;if _aaab :=_bba .TxBody ;_aaab !=nil {_gdb :=_bcdg .makePdfDivisionFromTxBody (_aaab ,_fcee );_cffa =_gdb .Height ()+_ggd +_edca ;_dddgf .SetContent (_gdb );};return _cffa ;};func (_ffce *convertContext )getShapes (_afda *_de .CT_Shape ,_aad bool ,_aea bool )[]_gb .Drawable {_gea :=[]_gb .Drawable {};
_fbb :=_afda .SpPr ;if _fbb ==nil {return _gea ;};var _gag bool ;if _bbf :=_afda .UseBgFillAttr ;_bbf !=nil {_gag =*_bbf ;};_bdc ,_eae ,_cde ,_cbgd ,_afa ,_cea ,_ceg :=_ffce .getShapesFromSpPr (_fbb ,_afda .Style ,_gag ,0.0,0.0);if !_aea {_gea =append (_gea ,_bdc ...);
};if _bgb :=_afda .TxBody ;_bgb !=nil &&!_aad {_gdfff ,_efd ,_ceb ,_ecfd ,_gagf ,_cgd :=_ffce .getPhData (_afda );if _aea &&!(_ecfd ||_gagf ){return _gea ;};if _gdfff !=nil &&!_ceg {_eae ,_cde ,_cbgd ,_afa =_dgc .GetDataFromXfrm (_gdfff );};_afca ,_ccc :=_ffce .makePdfBlockFromTxBody (_bgb ,_efd ,_ceb ,_cbgd ,_afa ,_cea ,_ecfd ,_cgd );
if _ccc !=nil {_db .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_ccc );
}else if _afca !=nil {_afca .SetPos (_eae ,_cde );_gea =append (_gea ,_afca );};};return _gea ;};func _eadc (_gfcg ,_fadc *_ea .CT_TextParagraphProperties )*_ea .CT_TextParagraphProperties {_geda :=_ea .NewCT_TextParagraphProperties ();if _gfcg !=nil {*_geda =*_gfcg ;
};if _fadc ==nil {return _geda ;};if _geda .MarLAttr ==nil {_geda .MarLAttr =_fadc .MarLAttr ;};if _geda .MarRAttr ==nil {_geda .MarRAttr =_fadc .MarRAttr ;};if _geda .LvlAttr ==nil {_geda .LvlAttr =_fadc .LvlAttr ;};if _geda .IndentAttr ==nil {_geda .IndentAttr =_fadc .IndentAttr ;
};if _geda .AlgnAttr ==_ea .ST_TextAlignTypeUnset {_geda .AlgnAttr =_fadc .AlgnAttr ;};if _geda .DefTabSzAttr ==nil {_geda .DefTabSzAttr =_fadc .DefTabSzAttr ;};if _geda .RtlAttr ==nil {_geda .RtlAttr =_fadc .RtlAttr ;};if _geda .EaLnBrkAttr ==nil {_geda .EaLnBrkAttr =_fadc .EaLnBrkAttr ;
};if _geda .FontAlgnAttr ==_ea .ST_TextFontAlignTypeUnset {_geda .FontAlgnAttr =_fadc .FontAlgnAttr ;};if _geda .LatinLnBrkAttr ==nil {_geda .LatinLnBrkAttr =_fadc .LatinLnBrkAttr ;};if _geda .HangingPunctAttr ==nil {_geda .HangingPunctAttr =_fadc .HangingPunctAttr ;
};if _geda .LnSpc ==nil {_geda .LnSpc =_fadc .LnSpc ;};if _geda .SpcBef ==nil {_geda .SpcBef =_fadc .SpcBef ;};if _geda .SpcAft ==nil {_geda .SpcAft =_fadc .SpcAft ;};if _geda .BuClrTx ==nil {_geda .BuClrTx =_fadc .BuClrTx ;};if _geda .BuClr ==nil {_geda .BuClr =_fadc .BuClr ;
};if _geda .BuSzTx ==nil {_geda .BuSzTx =_fadc .BuSzTx ;};if _geda .BuSzPct ==nil {_geda .BuSzPct =_fadc .BuSzPct ;};if _geda .BuSzPts ==nil {_geda .BuSzPts =_fadc .BuSzPts ;};if _geda .BuFontTx ==nil {_geda .BuFontTx =_fadc .BuFontTx ;};if _geda .BuFont ==nil {_geda .BuFont =_fadc .BuFont ;
};if _geda .BuNone ==nil {_geda .BuNone =_fadc .BuNone ;};if _geda .BuAutoNum ==nil {_geda .BuAutoNum =_fadc .BuAutoNum ;};if _geda .BuChar ==nil {_geda .BuChar =_fadc .BuChar ;};if _geda .BuBlip ==nil {_geda .BuBlip =_fadc .BuBlip ;};if _geda .TabLst ==nil {_geda .TabLst =_fadc .TabLst ;
};if _geda .ExtLst ==nil {_geda .ExtLst =_fadc .ExtLst ;};_geda .DefRPr =_bedfg (_geda .DefRPr ,_fadc .DefRPr );return _geda ;};func (_bdf *convertContext )addShapes (_ce *_de .CT_CommonSlideData ,_eac bool ){if _ce ==nil {return ;};_gcc :=&background {};
if _bfd :=_ce .Bg ;_bfd !=nil {if _fbe :=_bfd .BgPr ;_fbe !=nil {if _fbe .NoFill ==nil {if _df :=_fbe .SolidFill ;_df !=nil {_fe ,_dga :=_bdf .getColorFromSolidFill (_df );if _fe !=nil {_gcc ._eedc =_fe ;_gcc ._edfe =_dga ;};}else if _ecab :=_fbe .BlipFill ;
_ecab !=nil {_gcc ._ace =_ecab ;};};};};_bdf ._baaf =_gcc ;if _fg :=_ce .SpTree ;_fg !=nil {for _ ,_cee :=range _fg .Choice {if _cee !=nil {for _ ,_gcf :=range _cee .Sp {if _gcf !=nil {_dec :=_bdf .getShapes (_gcf ,_eac ,false );_bdf ._bdg =append (_bdf ._bdg ,_dec ...);
};};for _ ,_da :=range _cee .GraphicFrame {if _da !=nil {var _bae ,_fbed ,_ggb ,_aec float64 ;if _ccf :=_da .Xfrm ;_ccf !=nil {_bae ,_fbed ,_ggb ,_aec =_dgc .GetDataFromXfrm (_ccf );};if _ggb ==0&&_aec ==0{_ggb =_bdf ._cffg ;_aec =_bdf ._gfff ;};if _fgb :=_da .Graphic ;
_fgb !=nil {if _gf :=_fgb .GraphicData ;_gf !=nil {for _ ,_bfa :=range _gf .Any {if _abe ,_ecc :=_bfa .(*_fc .Chart );_ecc {_ggbg ,_cb :=_bdf .makePdfBlockFromChart (_abe ,_ggb ,_aec );if _cb !=nil {_db .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_cb );
};if _ggbg !=nil {_ggbg .SetPos (_bae ,_fbed );_bdf ._bdg =append (_bdf ._bdg ,_ggbg );};}else if _cbc ,_fdc :=_bfa .(*_ea .Tbl );_fdc {_gda :=_bdf .makePdfBlockFromTable (_cbc ,_ggb );if _gda !=nil {_bab :=_gb .NewBlock (_ggb ,_aec );_bab .SetPos (_bae ,_fbed );
_bab .Draw (_gda );_bdf ._bdg =append (_bdf ._bdg ,_bab );};};};};};};};for _ ,_cfg :=range _cee .CxnSp {if _cfg !=nil {_cgf :=_bdf .getConnectors (_cfg );_bdf ._bdg =append (_bdf ._bdg ,_cgf ...);};};for _ ,_fge :=range _cee .GrpSp {_baa :=0.0;_efg :=0.0;
if _cfgc :=_fge .GrpSpPr .Xfrm ;_cfgc !=nil {_baa ,_efg =_dgc .GetGroupOffsetFromXfrm (_cfgc );};for _ ,_cec :=range _fge .Choice {for _ ,_ee :=range _cec .CxnSp {if _ee !=nil {_bdb :=_bdf .getGroupConnectors (_ee ,_baa ,_efg );_bdf ._bdg =append (_bdf ._bdg ,_bdb ...);
};};};};for _ ,_cdd :=range _cee .Pic {if _cdd !=nil {_fbg :=false ;var _defg ,_gdg ,_ddd ,_ffa float64 ;if _bcf :=_cdd .SpPr ;_bcf !=nil {if _gff :=_bcf .Xfrm ;_gff !=nil {_defg ,_gdg ,_ddd ,_ffa =_dgc .GetDataFromXfrm (_gff );_fbg =true ;};};var _cbg _de .ST_PlaceholderType ;
var _fee *uint32 ;if _cfd :=_cdd .NvPicPr ;_cfd !=nil {if _bfe :=_cfd .NvPr ;_bfe !=nil {if _dbg :=_bfe .Ph ;_dbg !=nil {_cbg =_dbg .TypeAttr ;_fee =_dbg .IdxAttr ;};};};_aaa ,_ ,_ ,_ ,_ :=_fbfc (_bdf ._eef .CSld ,_cbg ,_fee );_dac ,_ ,_ ,_ ,_ :=_fbfc (_bdf ._afge .CSld ,_cbg ,_fee );
if _dac ==nil {_dac =_aaa ;};if _dac !=nil &&!_fbg {_defg ,_gdg ,_ddd ,_ffa =_dgc .GetDataFromXfrm (_dac );};if _cgfe :=_cdd .BlipFill ;_cgfe !=nil {_dfg :=_bdf .getShapeFromBlipFill (_cgfe ,_defg ,_gdg ,_ddd ,_ffa ,_eac );_bdf ._bdg =append (_bdf ._bdg ,_dfg );
};};};};};for _ ,_ced :=range _fg .Choice {if _ced !=nil {for _ ,_bgc :=range _ced .Sp {if _bgc !=nil {_bbe :=_bdf .getShapes (_bgc ,_eac ,true );_bdf ._bdg =append (_bdf ._bdg ,_bbe ...);};};};};};};func (_ecef *line )moveRight (_ggca float64 ){for _ ,_agbe :=range _ecef ._agb {_agbe ._bgff +=_ggca ;
};};type prefixData struct{_feebf string ;_acc bool ;_gfg float64 ;_edeg float64 ;};func (_fefa *convertContext )getInfoFromLn (_cecac *_ea .CT_LineProperties )(_gb .Color ,float64 ,float64 ){if _cecac ==nil ||_cecac .NoFill !=nil {return nil ,0,0;};var _aedg float64 ;
_efca ,_fbge :=_fefa .getColorFromSolidFill (_cecac .SolidFill );if _fegd :=_cecac .WAttr ;_fegd !=nil {_aedg =_fd .FromEMU (int64 (*_fegd ));}else {_aedg =1;};return _efca ,_aedg ,_fbge ;};func (_fcdf *convertContext )getShapeFromBlipFill (_aggcd *_ea .CT_BlipFillProperties ,_abb ,_geag ,_ffcgc ,_cdfd float64 ,_bbeb bool )_gb .Drawable {_fdae ,_beca ,_bbgc :=_fcdf .makePdfImageFromBlipFill (_aggcd ,_bbeb );
if _bbgc !=nil {_db .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_bbgc );
return nil ;};if _fdae ==nil {return nil ;};if _bfbf :=_aggcd .Tile ;_bfbf !=nil {_fdae =_fcdf .tileImage (_fdae ,_aggcd .Tile ,_ffcgc ,_cdfd );};if _dffc :=_aggcd .Stretch ;_dffc !=nil {_fdae ,_abb ,_geag =_fcdf .stretchImage (_fdae ,_aggcd .Stretch ,_abb ,_geag ,_ffcgc ,_cdfd );
};if _fdae ==nil {return nil ;};if len (_beca )==0{_fdae .SetPos (_abb ,_geag );return _fdae ;};_fdae =_fcdf .applyBlipEffectsOnImg (_fdae ,_abb ,_geag ,_beca );_fdae .SetPos (_abb ,_geag );return _fdae ;};func _bea (_ebc float64 )float64 {return _ebc *_fd .Inch };
type background struct{_eedc _gb .Color ;_edfe float64 ;_ace *_ea .CT_BlipFillProperties ;};func (_acgg *textboxContext )addTextRun (_fcg *_ea .EG_TextRun ,_abcc *_ea .CT_TextCharacterProperties ,_dccb _gb .Color ,_decg *prefixData ){if _daec :=_fcg .Br ;
_daec !=nil {_acgg .addCurrentWordToParagraph ();_acgg .newLine ();_acgg .newWord ();}else if _gbcc :=_fcg .R ;_gbcc !=nil {var _dbcf _gb .Color ;if _gbcc .RPr !=nil &&_gbcc .RPr .SolidFill !=nil {_dbcf ,_ =_acgg ._dccce .getColorFromSolidFill (_gbcc .RPr .SolidFill );
}else if _dccb !=nil {_dbcf =_dccb ;}else if _abcc .SolidFill !=nil {_dbcf ,_ =_acgg ._dccce .getColorFromSolidFill (_abcc .SolidFill );}else {_dbcf =_gb .ColorBlack ;};_gfgc :=_bedfg (_gbcc .RPr ,_abcc );_fbaf ,_dceg ,_eaf ,_cdf :=_acgg ._dccce .makeStyleFromRPr (_gfgc );
_fbaf .Color =_dbcf ;if _decg !=nil {_acgg .addPrefix (_decg ,_fbaf );};_bbg :=_bdcbf (_gbcc .T );for _ ,_gfa :=range _bbg {_gfa ._ecgg =_fbaf ;_gfa ._cfag =_dceg ;_gfa ._fcdd =_eaf ;_gfa ._dddgfd =_cdf ;if _gfgc .CapAttr ==_ea .ST_TextCapsTypeAll {_gfa ._efgb =_gd .ToUpper (_gfa ._efgb );
};_acgg .addTextSymbol (_gfa );};};};func (_eacg *convertContext )getShapesFromSpPr (_ggbgf *_ea .CT_ShapeProperties ,_adg *_ea .CT_ShapeStyle ,_efgc bool ,_geed float64 ,_adc float64 )([]_gb .Drawable ,float64 ,float64 ,float64 ,float64 ,_gb .Color ,bool ){_dfa :=[]_gb .Drawable {};
var _aab ,_bfaf ,_bbee ,_afcc ,_bdd float64 ;var _eab ,_dgg ,_ecg ,_ecdf _gb .Color ;var _agg *_ea .CT_BlipFillProperties ;_cdg ,_bbd :=1.0,1.0;if _adg !=nil {_eab ,_dgg ,_ecdf =_eacg .getStyleColors (_adg );};if _egg :=_ggbgf .Ln ;_egg !=nil {if _egg .NoFill !=nil {_ecg ,_bdd =nil ,0;
}else {_ecg ,_bdd ,_cdg =_eacg .getInfoFromLn (_egg );if _ecg ==nil {_ecg =_ecdf ;};};};if _ggbgf .NoFill !=nil {_dgg ,_bbd =nil ,0;}else if _efgc {_dgg =_eacg ._baaf ._eedc ;_bbd =_eacg ._baaf ._edfe ;_agg =_eacg ._baaf ._ace ;}else if _cabe :=_ggbgf .SolidFill ;
_cabe !=nil {_dgg ,_bbd =_eacg .getColorFromSolidFill (_cabe );};var _fbf bool ;if _bdff :=_ggbgf .Xfrm ;_bdff !=nil {_aab ,_bfaf ,_bbee ,_afcc =_dgc .GetDataFromXfrm (_bdff );_aab +=_geed ;_bfaf +=_adc ;_fbf =true ;};if _gbc :=_ggbgf .CustGeom ;_gbc !=nil {_dcg :=[]_gc .Point {};
_acg ,_gfe :=1.0,1.0;if _cce :=_gbc .PathLst ;_cce !=nil {for _ ,_fdb :=range _cce .Path {if _fdb !=nil {if _efa :=_fdb .WAttr ;_efa !=nil {_acg =_bbee /_fd .FromEMU (*_efa );};if _cfdc :=_fdb .HAttr ;_cfdc !=nil {_gfe =_afcc /_fd .FromEMU (*_cfdc );};
for _ ,_gaf :=range _fdb .Close {if _gaf !=nil {};};for _ ,_aga :=range _fdb .MoveTo {if _aga !=nil &&_aga .Pt !=nil {_gbf ,_bdfb :=_deb (_aga .Pt );_dcg =append (_dcg ,_gc .Point {X :_gbf *_acg +_aab ,Y :_bdfb *_gfe +_bfaf });};};for _ ,_dgab :=range _fdb .LnTo {if _dgab !=nil &&_dgab .Pt !=nil {_cecd ,_ddde :=_deb (_dgab .Pt );
_dcg =append (_dcg ,_gc .Point {X :_cecd *_acg +_aab ,Y :_ddde *_gfe +_bfaf });};};_fbga :=_eacg ._fcd .NewPolygon ([][]_gc .Point {_dcg });_fbga .SetFillColor (_dgg );_fbga .SetFillOpacity (_bbd );_fbga .SetBorderWidth (_bdd );if _ecg !=nil {_fbga .SetBorderColor (_ecg );
_fbga .SetBorderOpacity (_cdg );};_dfa =append (_dfa ,_fbga );};};};};if _fdag :=_ggbgf .PrstGeom ;_fdag !=nil {switch _fdag .PrstAttr {case _ea .ST_ShapeTypeRect :if _agg !=nil {_gbe :=_eacg .getShapeFromBlipFill (_agg ,_aab ,_bfaf ,_bbee ,_afcc ,false );
_dfa =append (_dfa ,_gbe );}else {_adbe :=_eacg ._fcd .NewRectangle (_aab ,_bfaf ,_bbee ,_afcc );_aafb :=_dgg !=nil &&_bbd > 0;if _aafb {_adbe .SetFillColor (_dgg );_adbe .SetFillOpacity (_bbd );};_baf :=_ecg !=nil &&_cdg > 0&&_bdd > 0;if _baf {_adbe .SetBorderWidth (_bdd );
_adbe .SetBorderColor (_ecg );_adbe .SetBorderOpacity (_cdg );};if _aafb ||_baf {_dfa =append (_dfa ,_adbe );};};case _ea .ST_ShapeTypeLine :_dgca :=_eacg ._fcd .NewLine (_aab ,_bfaf ,_aab +_bbee ,_bfaf +_afcc );_dgca .SetLineWidth (_bdd );if _ecg !=nil {_dgca .SetColor (_ecg );
};_dfa =append (_dfa ,_dgca );};};return _dfa ,_aab ,_bfaf ,_bbee ,_afcc ,_eab ,_fbf ;};func (_dfgf *convertContext )getPhData (_gdbb *_de .CT_Shape )(*_ea .CT_Transform2D ,*_ea .CT_TextBodyProperties ,*_ea .CT_TextListStyle ,bool ,bool ,bool ){_ecae ,_dded :=_adgf (_gdbb );
_fdbf ,_gaba ,_ebgf ,_ddag ,_eedcc :=_fbfc (_dfgf ._eef .CSld ,_ecae ,_dded );_cfed ,_bbgg ,_ebcg ,_cceb ,_fadee :=_fbfc (_dfgf ._afge .CSld ,_ecae ,_dded );if _cfed ==nil {_cfed =_fdbf ;};_ccad ,_aff :=_gdfd (_bbgg ,_gaba );var _fab ,_aada ,_dada bool ;
if _ebcg ==nil {if _ebgf !=nil {_fab =*_ebgf ;};}else {_fab =*_ebcg ;};if _fadee ==nil {if _eedcc !=nil {_dada =*_eedcc ;};}else {_dada =*_fadee ;};if _cceb ==nil {if _ddag !=nil {_aada =*_ddag ;};}else {_aada =*_cceb ;};return _cfed ,_ccad ,_aff ,_fab ,_aada ,_dada ;
};func _fbfc (_bbab *_de .CT_CommonSlideData ,_aeda _de .ST_PlaceholderType ,_ccff *uint32 )(*_ea .CT_Transform2D ,*_ea .CT_TextBody ,*bool ,*bool ,*bool ){_geef :=_ccff ==nil ;if _bbab !=nil &&(_aeda !=_de .ST_PlaceholderTypeUnset ||!_geef ){if _dddcc :=_bbab .SpTree ;
_dddcc !=nil {for _ ,_cccg :=range _dddcc .Choice {if _cccg !=nil {for _ ,_cgdg :=range _cccg .Sp {if _cgdg !=nil {_ggcec ,_bcff :=_adgf (_cgdg );if _aeda ==_ggcec {if (_geef &&_bcff ==nil )||(!_geef &&_bcff !=nil &&*_bcff ==*_ccff ){var _ccac *_ea .CT_Transform2D ;
if _cgdg .SpPr !=nil {_ccac =_cgdg .SpPr .Xfrm ;};_fbeb :=_aeda ==_de .ST_PlaceholderTypeTitle ||_aeda ==_de .ST_PlaceholderTypeCtrTitle ;_becf :=_aeda ==_de .ST_PlaceholderTypeSubTitle ;_ecfde :=!_fbeb &&_aeda !=_de .ST_PlaceholderTypeUnset ;return _ccac ,_cgdg .TxBody ,&_fbeb ,&_becf ,&_ecfde ;
};};};};};};};};return nil ,nil ,nil ,nil ,nil ;};type line struct{_fege float64 ;_faa float64 ;_fbbg float64 ;_gbd float64 ;_dbdff float64 ;_agb []*word ;};func (_gcfc *convertContext )renderPageWithDrawableToGoImage (_daebc _gb .Drawable )(_b .Image ,error ){_gbdd :=_dgc .MakeTempCreator (_gcfc ._cffg ,_gcfc ._gfff );
_gbdd .NewPage ();_gbdd .Draw (_daebc );_ebcge ,_fbcc :=_dgc .GetPageFromCreator (_gbdd );if _fbcc !=nil {return nil ,_fbcc ;};return _ac .NewImageDevice ().Render (_ebcge );};func (_feea *textboxContext )alignVertically (_fcf _ea .ST_TextAnchoringType ){_feea .alignParagraphsVertically (_fcf );
_feea .alignSymbolsVertically ();};func (_aagc *convertContext )getBorderStyle (_fadg *_ea .CT_LineProperties )(_gb .CellBorderStyle ,*_gb .Color ,float64 ){if _fadg ==nil ||_fadg .NoFill !=nil {return _gb .CellBorderStyleNone ,nil ,0;};var _geec _gb .Color ;
if _dfdafg :=_fadg .SolidFill ;_dfdafg !=nil {_geec ,_ =_aagc .getColorFromSolidFill (_dfdafg );};_agf :=0.0;if _aaba :=_fadg .WAttr ;_aaba !=nil {_agf =_fd .FromEMU (int64 (*_aaba ));};return _gb .CellBorderStyleSingle ,&_geec ,_agf ;};func (_gfef *textboxContext )alignParagraph (){_fffe :=_gfef ._ecdg ;
if _fffe ._bede ==_ea .ST_TextAlignTypeL {return ;};_bdef :=len (_fffe ._ega )-1;for _bbbc ,_bgcc :=range _fffe ._ega {_faf :=true ;_cgff :=len (_bgcc ._agb );_gba :=0.0;for _edeb :=len (_bgcc ._agb )-1;_edeb >=0;_edeb --{_aca :=_bgcc ._agb [_edeb ];if _faf &&_aca ._egad {_cgff =_edeb ;
}else {_faf =false ;for _ ,_becc :=range _aca ._egcf {_gba +=_becc ._acfc ;};};};_bgcc ._agb =_bgcc ._agb [:_cgff ];_gebb :=_bgcc ._fbbg -_bgcc ._faa -_gba ;switch _fffe ._bede {case _ea .ST_TextAlignTypeR :_bgcc .moveRight (_gebb );case _ea .ST_TextAlignTypeCtr :_bgcc .moveRight (_gebb /2);
case _ea .ST_TextAlignTypeJust :if _bbbc !=_bdef {_fafd :=[]*word {};for _ ,_ebdb :=range _bgcc ._agb {if _ebdb ._egad {_fafd =append (_fafd ,_ebdb );};};_adfd :=_gebb /float64 (len (_fafd ));for _ ,_dbac :=range _fafd {_dbac ._dbca +=_adfd ;};var _bdbd *word ;
for _ ,_ffd :=range _bgcc ._agb {if _bdbd !=nil {_ffd ._bgff =_bdbd ._bgff +_bdbd ._dbca ;};_bdbd =_ffd ;};};};};};func (_dfbca *textboxContext )addCurrentWordToParagraph (){if _dfbca ._gbec &&_dfbca ._ecca ._gbd +_dfbca ._acff ._dbca > _dfbca ._ecca ._fbbg {_dfbca .newLine ();
};if !_dfbca ._acff ._egad ||len (_dfbca ._ecca ._agb )> 0{_dfbca ._acff ._bgff =_dfbca ._ecca ._gbd ;_dfbca ._ecca ._agb =append (_dfbca ._ecca ._agb ,_dfbca ._acff );_dfbca ._ecca ._gbd +=_dfbca ._acff ._dbca ;for _ ,_dfae :=range _dfbca ._acff ._egcf {_dfbca .adjustHeights (_dfae ._eec );
};};};type romanMatch struct{_acea int ;_efdd string ;};func (_cffgd *textboxContext )alignParagraphsVertically (_bgfc _ea .ST_TextAnchoringType ){if _bgfc ==_ea .ST_TextAnchoringTypeT {return ;};_egee :=0.0;for _ ,_deeg :=range _cffgd ._afac {_egee +=_deeg ._agc +_deeg ._dagf +_deeg ._fdaf ;
};var _agfe float64 ;switch _bgfc {case _ea .ST_TextAnchoringTypeCtr :_agfe =(_cffgd ._fagb -_egee )/2;case _ea .ST_TextAnchoringTypeB :_agfe =_cffgd ._fagb -_egee ;};for _ ,_dfbfc :=range _cffgd ._afac {_dfbfc ._edbb +=_agfe ;};};func (_cge *textboxContext )alignSymbolsVertically (){for _ ,_eeec :=range _cge ._afac {for _ ,_fcda :=range _eeec ._ega {_fbc :=0.0;
for _ ,_afcd :=range _fcda ._agb {for _ ,_ece :=range _afcd ._egcf {if _ece ._eec > _fbc {_fbc =_ece ._eec ;};};};for _ ,_fage :=range _fcda ._agb {for _ ,_gdbde :=range _fage ._egcf {if _gdbde ._dcfcd < _fbc {_gdbde ._gbge =_fbc -_gdbde ._dcfcd ;};};};
};};};func (_dfbf *textboxContext )newParagraph (){_gab :=&paragraph {};_gab ._edbb =_dfbf ._gfeb ;_dfbf ._ecdg =_gab ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _dgc .RegisterFontsFromDirectory (dirName );};func _ecgc (_agec *_ea .CT_TextCharacterProperties ,_cga *_ea .CT_TableStyleTextStyle )*_ea .CT_TextCharacterProperties {_egdf :=_ea .NewCT_TextCharacterProperties ();
if _agec !=nil {*_egdf =*_agec ;};if _cga ==nil {return _egdf ;};if _egdf .BAttr ==nil &&_cga .BAttr !=_ea .ST_OnOffStyleTypeUnset {_cdcb :=_cga .BAttr ==_ea .ST_OnOffStyleTypeOn ;_egdf .BAttr =&_cdcb ;};if _egdf .IAttr ==nil &&_cga .IAttr !=_ea .ST_OnOffStyleTypeUnset {_dagb :=_cga .IAttr ==_ea .ST_OnOffStyleTypeOn ;
_egdf .IAttr =&_dagb ;};if _egdf .NoFill ==nil &&_egdf .SolidFill ==nil {_egdf .SolidFill =_ea .NewCT_SolidColorFillProperties ();_egdf .SolidFill .ScrgbClr =_cga .ScrgbClr ;_egdf .SolidFill .SrgbClr =_cga .SrgbClr ;_egdf .SolidFill .HslClr =_cga .HslClr ;
_egdf .SolidFill .SysClr =_cga .SysClr ;_egdf .SolidFill .SchemeClr =_cga .SchemeClr ;_egdf .SolidFill .PrstClr =_cga .PrstClr ;};if _cfcc :=_cga .Font ;_cfcc !=nil &&_egdf .Latin ==nil &&_egdf .Ea ==nil &&_egdf .Cs ==nil {_egdf .Latin =_cfcc .Latin ;_egdf .Ea =_cfcc .Ea ;
_egdf .Cs =_cfcc .Cs ;};return _egdf ;};var _fffa =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
func _deb (_fede *_ea .CT_AdjPoint2D )(float64 ,float64 ){var _cdfb ,_aaeb float64 ;_acae ,_bgcf :=_fede .XAttr ,_fede .YAttr ;if _gggc :=_acae .ST_Coordinate ;_gggc !=nil {_cdfb =_fd .FromEMU (_dgc .FromSTCoordinate (*_gggc ));};if _ffdg :=_bgcf .ST_Coordinate ;
_ffdg !=nil {_aaeb =_fd .FromEMU (_dgc .FromSTCoordinate (*_ffdg ));};return _cdfb ,_aaeb ;};func (_fbeeb *textboxContext )addTextSymbol (_adde *symbol ){_bdbf :=_gb .New ();_fbac :=_bdbf .NewStyledParagraph ();_fbac .SetMargins (0,0,0,0);_gdbd :=_fbac .Append (_adde ._efgb );
_fgg :=0.0;if _adde ._ecgg !=nil {_gdbd .Style =*_adde ._ecgg ;if _adde ._ecgg .CharSpacing !=0{_fgg =_adde ._ecgg .CharSpacing ;};};_adde ._dcfcd =_fbac .Height ();_adde ._eec =_fbac .Height ()*1.2;if _adde ._acfc ==0{_adde ._acfc =_fbac .Width ()+_fgg ;
};if len (_fbeeb ._acff ._egcf )> 0{_ceee :=_fbeeb ._acff ._egcf [len (_fbeeb ._acff ._egcf )-1]._efgb ;if _fbeeb ._ecdg ._dae ||_dgc .IsNoSpaceLanguage (_ceee )||(_ceee =="\u0020")!=(_adde ._efgb =="\u0020"){_fbeeb .addCurrentWordToParagraph ();_fbeeb .newWord ();
};};_fbeeb ._acff ._egcf =append (_fbeeb ._acff ._egcf ,_adde );_adde ._ccb =_fbeeb ._acff ._dbca ;_fbeeb ._acff ._dbca +=_adde ._acfc ;if _adde ._efgb !="\u0020"{_fbeeb ._acff ._egad =false ;};if _fbeeb ._acff ._dbca >=_fbeeb ._ecdg ._ffae -_fbeeb ._ecdg ._aggc {_fbeeb .addCurrentWordToParagraph ();
_fbeeb .newLine ();_fbeeb .newWord ();};};func (_cdfa *textboxContext )addCurrentParagraph (){_cdfa ._gfeb =_cdfa ._ecdg ._edbb +_cdfa ._ecdg ._agc +_cdfa ._ecdg ._dagf +_cdfa ._ecdg ._fdaf ;_cdfa ._afac =append (_cdfa ._afac ,_cdfa ._ecdg );_cdfa .alignParagraph ();
};func (_fdde *convertContext )applyBlipEffectsOnImg (_agaa *_gb .Image ,_bcgf ,_dcee float64 ,_bbgd []*_ea .CT_BlipChoice )*_gb .Image {if len (_bbgd )==0{return _agaa ;};_agaa .SetPos (_bcgf ,_dcee );_feff ,_eddg :=_fdde .renderPageWithDrawableToGoImage (_agaa );
if _eddg !=nil {_db .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_eddg );
return _agaa ;};_gdcc ,_eddg :=_fdde .renderCurrentStateToGoImage ();if _eddg !=nil {_db .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_eddg );
return _agaa ;};_aecac :=_feff .Bounds ();_ceag :=_b .NewRGBA (_aecac );_ebf ,_bfabc :=_agaa .Width (),_agaa .Height ();for _ ,_fadeg :=range _bbgd {for _ ,_egdbc :=range _fadeg .AlphaModFix {if _fega :=_egdbc .AmtAttr ;_fega !=nil {if _bgcef :=_fega .ST_PositivePercentageDecimal ;
_bgcef !=nil {_ggfc :=uint8 (255*(*_bgcef )/100000);_bfafe :=_b .NewUniform (_c .Alpha {_ggfc });_g .Draw (_ceag ,_aecac ,_gdcc ,_b .Point {0,0},_g .Src );_g .DrawMask (_ceag ,_aecac ,_feff ,_b .Point {0,0},_bfafe ,_b .Point {0,0},_g .Over );};};};};_ceac :=_b .Rect (int (_bcgf ),int (_dcee ),int (_bcgf +_ebf )+1,int (_dcee +_bfabc )+1);
_dfba :=_dgc .CropImageByRect (_ceag ,_ceac );_abf ,_eddg :=_fdde ._fcd .NewImageFromGoImage (_dfba );if _eddg !=nil {_db .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_eddg );
return _agaa ;};return _abf ;};type symbolStyle struct{_ffcg *string ;_bebc *float64 ;_gfbe *string ;_gec *bool ;_bec *bool ;_fbbc *bool ;_bgbe *bool ;_cfbb *bool ;};func (_ccca *textboxContext )newWord (){_ccca ._acff =&word {_egad :true ,_bgff :_ccca ._ecca ._gbd }};
func (_aafg *convertContext )makePdfBlockFromTxBody (_adab *_ea .CT_TextBody ,_bgce *_ea .CT_TextBodyProperties ,_bdcb *_ea .CT_TextListStyle ,_aag ,_cae float64 ,_gggf _gb .Color ,_cba ,_gaga bool )(*_gb .Block ,error ){var _adda *_ea .CT_TextParagraphProperties ;
if _fbeee :=_adab .LstStyle ;_fbeee !=nil {var _ggc *_ea .CT_TextParagraphProperties ;if _fbeee .Lvl1pPr !=nil {_ggc =_fbeee .Lvl1pPr ;};_adda =_eadc (_ggc ,_fbeee .DefPPr );};var _cfcf *_ea .CT_TextParagraphProperties ;if _adda !=nil {if _cba {_cfcf =_aafg ._fddc [0];
}else if _gaga {_cfcf =_aafg ._adgbf [0];}else {_cfcf =_aafg ._dfb [0];};if _bdcb !=nil {_cfcf =_eadc (_eadc (_bdcb .Lvl1pPr ,_bdcb .DefPPr ),_cfcf );};_cfcf =_eadc (_adda ,_cfcf );}else {if _cba {_cfcf =_aafg ._cfef ;}else if _gaga {_cfcf =_aafg ._gdbf ;
}else {_cfcf =_aafg ._acf ;};};_aggd ,_gcd :=_aae (2.5),_aae (2.5);_caec ,_ccd :=_aae (1.3),_aae (1.3);_degg :=true ;_aeb :=_ea .ST_TextAnchoringTypeT ;if _bgce !=nil {if _acb :=_bgce .AnchorAttr ;_acb !=_ea .ST_TextAnchoringTypeUnset {_aeb =_acb ;};};
if _daccb :=_adab .BodyPr ;_daccb !=nil {if _cddb :=_daccb .LInsAttr ;_cddb !=nil {_aggd =_fd .FromEMU (_dgc .FromSTCoordinate32 (*_cddb ));};if _dfgb :=_daccb .TInsAttr ;_dfgb !=nil {_caec =_fd .FromEMU (_dgc .FromSTCoordinate32 (*_dfgb ));};if _be :=_daccb .RInsAttr ;
_be !=nil {_gcd =_fd .FromEMU (_dgc .FromSTCoordinate32 (*_be ));};if _fag :=_daccb .BInsAttr ;_fag !=nil {_ccd =_fd .FromEMU (_dgc .FromSTCoordinate32 (*_fag ));};_degg =_daccb .WrapAttr !=_ea .ST_TextWrappingTypeNone ;if _fdd :=_daccb .AnchorAttr ;_fdd !=_ea .ST_TextAnchoringTypeUnset {_aeb =_daccb .AnchorAttr ;
};};_feeb :=_dgc .MakeTempCreator (_aag ,_cae );_feeb .SetPageMargins (_aggd ,_gcd ,_caec ,_ccd );_fdg :=&textboxContext {_dccce :_aafg ,_gbec :_degg ,_aegf :_aag -_aggd -_gcd ,_fagb :_cae -_caec -_ccd ,_eed :_feeb ,_afac :[]*paragraph {}};_geab :=1;for _ ,_efaf :=range _adab .P {if _efaf !=nil {_ffba :=_efaf .PPr ;
var _dfag *prefixData ;if _ffba !=nil &&_ffba .BuNone ==nil {var _bdfc string ;var _ggba bool ;if _cfa :=_ffba .BuAutoNum ;_cfa !=nil {var _cege string ;if _acbd :=_cfa .StartAtAttr ;_acbd !=nil {_geab =int (*_acbd );};var _ebaf string ;switch _cfa .TypeAttr {case _ea .ST_TextAutonumberSchemeAlphaUcParenBoth ,_ea .ST_TextAutonumberSchemeAlphaUcParenR ,_ea .ST_TextAutonumberSchemeAlphaUcPeriod :_ebaf =_dge (_geab ,true );
case _ea .ST_TextAutonumberSchemeAlphaLcParenBoth ,_ea .ST_TextAutonumberSchemeAlphaLcParenR ,_ea .ST_TextAutonumberSchemeAlphaLcPeriod :_ebaf =_dge (_geab ,false );case _ea .ST_TextAutonumberSchemeRomanUcParenBoth ,_ea .ST_TextAutonumberSchemeRomanUcParenR ,_ea .ST_TextAutonumberSchemeRomanUcPeriod :_ebaf =_cad (_geab ,true );
case _ea .ST_TextAutonumberSchemeRomanLcParenBoth ,_ea .ST_TextAutonumberSchemeRomanLcParenR ,_ea .ST_TextAutonumberSchemeRomanLcPeriod :_ebaf =_cad (_geab ,false );default:_ebaf =_dg .Itoa (_geab );};switch _cfa .TypeAttr {case _ea .ST_TextAutonumberSchemeAlphaLcPeriod ,_ea .ST_TextAutonumberSchemeAlphaUcPeriod ,_ea .ST_TextAutonumberSchemeArabicPeriod ,_ea .ST_TextAutonumberSchemeRomanLcPeriod ,_ea .ST_TextAutonumberSchemeRomanUcPeriod ,_ea .ST_TextAutonumberSchemeArabicDbPeriod ,_ea .ST_TextAutonumberSchemeEa1ChsPeriod ,_ea .ST_TextAutonumberSchemeEa1ChtPeriod ,_ea .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_ea .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_ea .ST_TextAutonumberSchemeThaiAlphaPeriod ,_ea .ST_TextAutonumberSchemeThaiNumPeriod ,_ea .ST_TextAutonumberSchemeHindiAlphaPeriod ,_ea .ST_TextAutonumberSchemeHindiNumPeriod ,_ea .ST_TextAutonumberSchemeHindiAlpha1Period :_cege ="\u002e";
case _ea .ST_TextAutonumberSchemeAlphaLcParenR ,_ea .ST_TextAutonumberSchemeAlphaUcParenR ,_ea .ST_TextAutonumberSchemeArabicParenR ,_ea .ST_TextAutonumberSchemeRomanLcParenR ,_ea .ST_TextAutonumberSchemeRomanUcParenR ,_ea .ST_TextAutonumberSchemeThaiAlphaParenR ,_ea .ST_TextAutonumberSchemeThaiNumParenR ,_ea .ST_TextAutonumberSchemeHindiNumParenR :_cege ="\u0029";
};_bdfc =_ebaf +_cege ;_geab ++;}else if _cebe :=_ffba .BuChar ;_cebe !=nil {_efgf :=_cebe .CharAttr ;if _fad ,_fgbe :=_bfbg [_efgf ];_fgbe {_efgf =string (rune (_fad ));}else {_efgf ="\u2022";};_bdfc =_efgf ;_ggba =true ;};if _bdfc !=""{var _cegeb ,_egeg float64 ;
if _ffba .MarLAttr !=nil {_cegeb =_fd .FromEMU (int64 (*_ffba .MarLAttr ));};if _ffba .IndentAttr !=nil {_egeg =_fd .FromEMU (int64 (*_ffba .IndentAttr ));};_dfag =&prefixData {_feebf :_bdfc ,_acc :_ggba ,_gfg :_cegeb ,_edeg :_egeg };};};_ffba =_eadc (_ffba ,_cfcf );
_fdgf :=_bedfg (_efaf .EndParaRPr ,_ffba .DefRPr );_fdg .newParagraph ();_fdg .assignPropsToCurrentParagraph (_ffba );_fdg .newLine ();_fdg .newWord ();for _adgb ,_aed :=range _efaf .EG_TextRun {_fdg .addTextRun (_aed ,_fdgf ,_gggf ,_dfag );if _adgb > 0{_dfag =nil ;
};};_fdg .addCurrentWordToParagraph ();};_fdg .addCurrentParagraph ();};_fdg .alignVertically (_aeb );_fdg .drawParagraphs ();return _dgc .MakeBlockFromCreator (_feeb );};func _bbaf (_bgca *bool )bool {return _bgca !=nil &&*_bgca };func _dab (_aggf ,_ceeb *_ea .CT_TableStyleTextStyle )*_ea .CT_TableStyleTextStyle {_gbecf :=_ea .NewCT_TableStyleTextStyle ();
if _aggf !=nil {*_gbecf =*_aggf ;};if _ceeb ==nil {return _gbecf ;};if _gbecf .BAttr ==_ea .ST_OnOffStyleTypeUnset {_gbecf .BAttr =_ceeb .BAttr ;};if _gbecf .IAttr ==_ea .ST_OnOffStyleTypeUnset {_gbecf .IAttr =_ceeb .IAttr ;};if _gbecf .Font ==nil {_gbecf .Font =_ceeb .Font ;
};if _gbecf .FontRef ==nil {_gbecf .FontRef =_ceeb .FontRef ;};if _gbecf .ScrgbClr ==nil {_gbecf .ScrgbClr =_ceeb .ScrgbClr ;};if _gbecf .SrgbClr ==nil {_gbecf .SrgbClr =_ceeb .SrgbClr ;};if _gbecf .HslClr ==nil {_gbecf .HslClr =_ceeb .HslClr ;};if _gbecf .SysClr ==nil {_gbecf .SysClr =_ceeb .SysClr ;
};if _gbecf .SchemeClr ==nil {_gbecf .SchemeClr =_ceeb .SchemeClr ;};if _gbecf .PrstClr ==nil {_gbecf .PrstClr =_ceeb .PrstClr ;};return _gbecf ;};func (_efe *convertContext )tileImage (_bgg *_gb .Image ,_afd *_ea .CT_TileInfoProperties ,_cfc ,_edb float64 )*_gb .Image {_dced ,_cab :=1.0,1.0;
if _cgc :=_afd .SxAttr ;_cgc !=nil {_dced =_dgc .FromSTPercentage (_cgc );};if _ged :=_afd .SyAttr ;_ged !=nil {_cab =_dgc .FromSTPercentage (_ged );};_edf :=_dgc .MakeTempCreator (_cfc ,_edb );_bgg .Scale (_dced ,_cab );_ebb ,_bfbc :=_bgg .Width (),_bgg .Height ();
var _bac ,_ga float64 ;if _fgd :=_afd .TxAttr ;_fgd !=nil {_bac =_fd .FromEMU (_dgc .FromSTCoordinate (*_fgd ));};if _dfd :=_afd .TyAttr ;_dfd !=nil {_ga =_fd .FromEMU (_dgc .FromSTCoordinate (*_dfd ));};if _bac > 0{_bac -=_ebb ;};if _ga > 0{_ga -=_bfbc ;
};_afdf :=_efe ._cffg /_ebb +1;_dcc :=_efe ._gfff /_bfbc +1;for _gcfd :=0.0;_gcfd <=_afdf ;_gcfd ++{_feg :=_gcfd *_ebb ;for _adb :=0.0;_adb <=_dcc ;_adb ++{_bde :=_adb *_bfbc ;_bgg .SetPos (_feg +_bac ,_bde +_ga );_edf .Draw (_bgg );};};_dfe ,_ade :=_dgc .GetPageFromCreator (_edf );
if _ade !=nil {_db .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_ade );return nil ;};_afg ,_ade :=_ac .NewImageDevice ().Render (_dfe );
if _ade !=nil {_db .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_ade );return nil ;};_dbde ,_ade :=_efe ._fcd .NewImageFromGoImage (_afg );if _ade !=nil {_db .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_ade );
return nil ;};return _dbde ;};func (_adfa *textboxContext )drawParagraphs (){_adfa ._eed .NewPage ();for _ ,_eceb :=range _adfa ._afac {for _ ,_daad :=range _eceb ._ega {for _ ,_bbb :=range _daad ._agb {for _ ,_agea :=range _bbb ._egcf {_ddb :=_adfa ._eed .NewStyledParagraph ();
if _agea ._cfag {_agea ._gbge =0;}else if _agea ._fcdd {_agea ._gbge =1.2*_daad ._dbdff -_agea ._dcfcd ;};_ded :=_bbb ._bgff +_agea ._ccb ;_eccg :=_eceb ._edbb +_daad ._fege +_agea ._gbge ;_ddb .SetPos (_ded ,_eccg );_daf :=_ddb .Append (_agea ._efgb );
if _agea ._ecgg !=nil {_daf .Style =*_agea ._ecgg ;};_adfa ._eed .Draw (_ddb );if _agea ._dddgfd {_ecee :=_eccg +_agea ._dcfcd +2;_dgc .DrawLine (_adfa ._eed ,_ded ,_ecee ,_ded +_agea ._acfc ,_ecee ,1,_agea ._ecgg .Color );};};};};};};func (_dddc *convertContext )getStyleColors (_aabcg *_ea .CT_ShapeStyle )(_gb .Color ,_gb .Color ,_gb .Color ){var _ceba ,_addd ,_fdbc _gb .Color ;
if _egcd :=_aabcg .LnRef ;_egcd !=nil {_addd =_dddc .getColorFromMatrixReference (_egcd );};if _fga :=_aabcg .FillRef ;_fga !=nil {_fdbc =_dddc .getColorFromMatrixReference (_fga );};if _bbac :=_aabcg .FontRef ;_bbac !=nil {_ceba =_dddc .getColorFromFontReference (_bbac );
};return _ceba ,_fdbc ,_addd ;};func (_defa *convertContext )extractDefaultProperties (){_cf :=_defa ._dda .X ();_bd :=_cf .DefaultTextStyle ;var _eca ,_dba ,_bfb ,_gdf ,_dc ,_eb ,_cd ,_bcg ,_deg ,_cff *_ea .CT_TextParagraphProperties ;if _bd !=nil {_eca =_bd .DefPPr ;
_dba =_eadc (_bd .Lvl1pPr ,_eca );_bfb =_eadc (_bd .Lvl2pPr ,_eca );_gdf =_eadc (_bd .Lvl3pPr ,_eca );_dc =_eadc (_bd .Lvl4pPr ,_eca );_eb =_eadc (_bd .Lvl5pPr ,_eca );_cd =_eadc (_bd .Lvl6pPr ,_eca );_bcg =_eadc (_bd .Lvl7pPr ,_eca );_deg =_eadc (_bd .Lvl8pPr ,_eca );
_cff =_eadc (_bd .Lvl9pPr ,_eca );_defa ._acf =_eca ;_defa ._bedf =_eca .DefRPr ;};_defa ._dfb =make ([]*_ea .CT_TextParagraphProperties ,9);_defa ._dfb [0]=_dba ;_defa ._dfb [1]=_bfb ;_defa ._dfb [2]=_gdf ;_defa ._dfb [3]=_dc ;_defa ._dfb [4]=_eb ;_defa ._dfb [5]=_cd ;
_defa ._dfb [6]=_bcg ;_defa ._dfb [7]=_deg ;_defa ._dfb [8]=_cff ;_ef :=_defa ._dda .SlideMasters ()[0].X ();_eba :=_ef .TxStyles ;_fb :=_eba .TitleStyle ;_defa ._cfef =_eadc (_fb .DefPPr ,_eca );_defa ._gcda =_defa ._cfef .DefRPr ;_defa ._fddc =make ([]*_ea .CT_TextParagraphProperties ,9);
_defa ._fddc [0]=_eadc (_fb .Lvl1pPr ,_dba );_defa ._fddc [1]=_eadc (_fb .Lvl2pPr ,_bfb );_defa ._fddc [2]=_eadc (_fb .Lvl3pPr ,_gdf );_defa ._fddc [3]=_eadc (_fb .Lvl4pPr ,_dc );_defa ._fddc [4]=_eadc (_fb .Lvl5pPr ,_eb );_defa ._fddc [5]=_eadc (_fb .Lvl6pPr ,_cd );
_defa ._fddc [6]=_eadc (_fb .Lvl7pPr ,_bcg );_defa ._fddc [7]=_eadc (_fb .Lvl8pPr ,_deg );_defa ._fddc [8]=_eadc (_fb .Lvl9pPr ,_cff );_ge :=_eba .BodyStyle ;_defa ._gdbf =_eadc (_ge .DefPPr ,_eca );_defa ._dcgf =_defa ._gdbf .DefRPr ;_defa ._adgbf =make ([]*_ea .CT_TextParagraphProperties ,9);
_defa ._adgbf [0]=_eadc (_ge .Lvl1pPr ,_dba );_defa ._adgbf [1]=_eadc (_ge .Lvl2pPr ,_bfb );_defa ._adgbf [2]=_eadc (_ge .Lvl3pPr ,_gdf );_defa ._adgbf [3]=_eadc (_ge .Lvl4pPr ,_dc );_defa ._adgbf [4]=_eadc (_ge .Lvl5pPr ,_eb );_defa ._adgbf [5]=_eadc (_ge .Lvl6pPr ,_cd );
_defa ._adgbf [6]=_eadc (_ge .Lvl7pPr ,_bcg );_defa ._adgbf [7]=_eadc (_ge .Lvl8pPr ,_deg );_defa ._adgbf [8]=_eadc (_ge .Lvl9pPr ,_cff );};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;
);

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_a .Presentation )*_gb .Creator {_ff :=pr .X ().SldSz ;_ec :=_fd .FromEMU (int64 (_ff .CxAttr ));_bca :=_fd .FromEMU (int64 (_ff .CyAttr ));_afc :=_gb .PageSize {_ec ,_bca };_afcb :=_gb .New ();_afcb .SetPageSize (_afc );var _fff *_ea .Theme ;
if len (pr .Themes ())> 0{_fff =pr .Themes ()[0];};for _ ,_def :=range pr .Slides (){if _def .X ()==nil {continue ;};_ddc :=&convertContext {_fcd :_afcb ,_gcgb :&_def ,_afge :_def .GetSlideLayout (),_eef :pr .SlideMasters ()[0].X (),_dda :pr ,_aece :_fff ,_cfee :_def .X ().ClrMapOvr ,_gfff :_afc [1],_cffg :_afc [0]};
_ddc .extractDefaultProperties ();_ddc .makeSlide ();_ddc .drawSlide ();};return _afcb ;};func _adgf (_baed *_de .CT_Shape )(_de .ST_PlaceholderType ,*uint32 ){if _dfac :=_baed .NvSpPr ;_dfac !=nil {if _ebcd :=_dfac .NvPr ;_ebcd !=nil {if _cedf :=_ebcd .Ph ;
_cedf !=nil {return _cedf .TypeAttr ,_cedf .IdxAttr ;};};};return _de .ST_PlaceholderTypeUnset ,nil ;};func _bedfg (_effg ,_efbc *_ea .CT_TextCharacterProperties )*_ea .CT_TextCharacterProperties {_fbbe :=_ea .NewCT_TextCharacterProperties ();if _effg !=nil {*_fbbe =*_effg ;
};if _efbc ==nil {return _fbbe ;};if _fbbe .KumimojiAttr ==nil {_fbbe .KumimojiAttr =_efbc .KumimojiAttr ;};if _fbbe .LangAttr ==nil {_fbbe .LangAttr =_efbc .LangAttr ;};if _fbbe .AltLangAttr ==nil {_fbbe .AltLangAttr =_efbc .AltLangAttr ;};if _fbbe .SzAttr ==nil {_fbbe .SzAttr =_efbc .SzAttr ;
};if _fbbe .BAttr ==nil {_fbbe .BAttr =_efbc .BAttr ;};if _fbbe .IAttr ==nil {_fbbe .IAttr =_efbc .IAttr ;};if _fbbe .UAttr ==_ea .ST_TextUnderlineTypeUnset {_fbbe .UAttr =_efbc .UAttr ;};if _fbbe .StrikeAttr ==_ea .ST_TextStrikeTypeUnset {_fbbe .StrikeAttr =_efbc .StrikeAttr ;
};if _fbbe .KernAttr ==nil {_fbbe .KernAttr =_efbc .KernAttr ;};if _fbbe .CapAttr ==_ea .ST_TextCapsTypeUnset {_fbbe .CapAttr =_efbc .CapAttr ;};if _fbbe .SpcAttr ==nil {_fbbe .SpcAttr =_efbc .SpcAttr ;};if _fbbe .NormalizeHAttr ==nil {_fbbe .NormalizeHAttr =_efbc .NormalizeHAttr ;
};if _fbbe .BaselineAttr ==nil {_fbbe .BaselineAttr =_efbc .BaselineAttr ;};if _fbbe .NoProofAttr ==nil {_fbbe .NoProofAttr =_efbc .NoProofAttr ;};if _fbbe .DirtyAttr ==nil {_fbbe .DirtyAttr =_efbc .DirtyAttr ;};if _fbbe .ErrAttr ==nil {_fbbe .ErrAttr =_efbc .ErrAttr ;
};if _fbbe .SmtCleanAttr ==nil {_fbbe .SmtCleanAttr =_efbc .SmtCleanAttr ;};if _fbbe .SmtIdAttr ==nil {_fbbe .SmtIdAttr =_efbc .SmtIdAttr ;};if _fbbe .BmkAttr ==nil {_fbbe .BmkAttr =_efbc .BmkAttr ;};if _fbbe .Ln ==nil {_fbbe .Ln =_efbc .Ln ;};if _fbbe .NoFill ==nil {_fbbe .NoFill =_efbc .NoFill ;
};if _fbbe .SolidFill ==nil {_fbbe .SolidFill =_efbc .SolidFill ;};if _fbbe .BlipFill ==nil {_fbbe .BlipFill =_efbc .BlipFill ;};if _fbbe .EffectLst ==nil {_fbbe .EffectLst =_efbc .EffectLst ;};if _fbbe .EffectDag ==nil {_fbbe .EffectDag =_efbc .EffectDag ;
};if _fbbe .Highlight ==nil {_fbbe .Highlight =_efbc .Highlight ;};if _fbbe .ULnTx ==nil {_fbbe .ULnTx =_efbc .ULnTx ;};if _fbbe .ULn ==nil {_fbbe .ULn =_efbc .ULn ;};if _fbbe .UFillTx ==nil {_fbbe .UFillTx =_efbc .UFillTx ;};if _fbbe .UFill ==nil {_fbbe .UFill =_efbc .UFill ;
};if _fbbe .Latin ==nil {_fbbe .Latin =_efbc .Latin ;};if _fbbe .Ea ==nil {_fbbe .Ea =_efbc .Ea ;};if _fbbe .Cs ==nil {_fbbe .Cs =_efbc .Cs ;};if _fbbe .Sym ==nil {_fbbe .Sym =_efbc .Sym ;};if _fbbe .Rtl ==nil {_fbbe .Rtl =_efbc .Rtl ;};return _fbbe ;};


// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_dgc .FontStyle ;func (_dccc *convertContext )getConnectors (_afgd *_de .CT_Connector )[]_gb .Drawable {_aaf ,_ ,_ ,_ ,_ ,_ ,_ :=_dccc .getShapesFromSpPr (_afgd .SpPr ,_afgd .Style ,false ,0.0,0.0);return _aaf ;};func (_cgg *convertContext )drawSlide (){_cgg ._fcd .NewPage ();
for _ ,_dacc :=range _cgg ._bdg {if _dacc !=nil {_cgg ._fcd .MoveTo (0,0);_cgg ._fcd .Draw (_dacc );};};};func _dge (_ead int ,_aaff bool )string {_efcb :=(_ead -1)/26+1;_adf :=byte ((_ead -1)%26);if _aaff {_adf +=byte (65);}else {_adf +=byte (97);};_ddce :=_cg .NewBuffer ([]byte {});
for _bbdf :=0;_bbdf < _efcb ;_bbdf ++{_ddce .Write ([]byte {_adf });};return _ddce .String ();};var _bc =_aae (1.9);func (_fce *convertContext )makeSlide (){_dgf :=_fce ._gcgb .GetSlideLayout ().CSld ;_fce .addShapes (_dgf ,true );_dgf =_fce ._gcgb .X ().CSld ;
_fce .addShapes (_dgf ,false );};func (_cgfd *convertContext )makeStyleFromRPr (_bcac *_ea .CT_TextCharacterProperties )(*_gb .TextStyle ,bool ,bool ,bool ){var _bed ,_fgdd ,_age bool ;_bacd :=_cgfd ._fcd .NewTextStyle ();if _bcac !=nil {_ecfe :=_dgc .FontStyle_Regular ;
_beb :=_bbaf (_bcac .BAttr );_dfdd :=_bbaf (_bcac .IAttr );if _beb &&_dfdd {_ecfe =_dgc .FontStyle_BoldItalic ;}else if _beb {_ecfe =_dgc .FontStyle_Bold ;}else if _dfdd {_ecfe =_dgc .FontStyle_Italic ;};_age =_bcac .UAttr !=_ea .ST_TextUnderlineTypeUnset &&_bcac .UAttr !=_ea .ST_TextUnderlineTypeNone ;
_bfca :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _ccfe :=_bcac .Latin ;_ccfe !=nil {_bfca =_ccfe .TypefaceAttr ;}else if _bbea :=_bcac .Ea ;_bbea !=nil {_bfca =_bbea .TypefaceAttr ;}else if _agd :=_bcac .Cs ;_agd !=nil {_bfca =_agd .TypefaceAttr ;}else if _ebg :=_bcac .Sym ;
_ebg !=nil {_bfca =_ebg .TypefaceAttr ;};if _edd ,_ede :=_dgc .StdFontsMap [_bfca ];_ede {_bacd .Font =_dgc .AssignStdFontByName (_bacd ,_edd [_ecfe ]);}else if _edcb :=_dgc .GetRegisteredFont (_bfca ,_ecfe );_edcb !=nil {_bacd .Font =_edcb ;}else {_db .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_bfca ,_ecfe );
_bacd .Font =_dgc .AssignStdFontByName (_bacd ,_dgc .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_ecfe ]);};var _daaf float64 ;if _dbc :=_bcac .SzAttr ;_dbc !=nil {_daaf =_dd .Round (float64 (*_dbc )/100)-0.5;}else {_daaf =_dgc .DefaultFontSize ;
};if _dag :=_bcac .BaselineAttr ;_dag !=nil {if _edfc :=_dag .ST_PercentageDecimal ;_edfc !=nil {if *_edfc > 0{_bed =true ;}else if *_edfc < 0{_fgdd =true ;};};};if _bed ||_fgdd {_daaf =_dd .Round (_daaf *0.64);};_bacd .FontSize =_daaf ;_cfff :=0.0;if _edbe :=_bcac .SpcAttr ;
_edbe !=nil {if _dgga :=_edbe .ST_TextPointUnqualified ;_dgga !=nil &&*_dgga > 0{_cfff =float64 (*_dgga )/100;};};_bacd .CharSpacing =_cfff ;};return &_bacd ,_bed ,_fgdd ,_age ;};func (_fbce *convertContext )getColorFromSolidFill (_agce *_ea .CT_SolidColorFillProperties )(_gb .Color ,float64 ){if _agce ==nil {return nil ,1;
};var _beea string ;_caaa :=1.0;if _dbdea :=_agce .SrgbClr ;_dbdea !=nil {_beea =_dbdea .ValAttr ;_caaa =_dgc .GetOpacityFromColorTransform (_dbdea .EG_ColorTransform );}else if _gccc :=_agce .SchemeClr ;_gccc !=nil {_beea =_dgc .GetColorStringFromDmlColor (_fbce ._gcgb .GetColorBySchemeColor (_gccc .ValAttr ));
_beea =_dgc .AdjustColor (_beea ,_gccc .EG_ColorTransform );_caaa =_dgc .GetOpacityFromColorTransform (_gccc .EG_ColorTransform );};if _beea !=""{_fbgb :=_gb .ColorRGBFromHex ("\u0023"+_beea );return _fbgb ,_caaa ;};return nil ,1;};func (_aef *convertContext )makePdfBlockFromTable (_cdeb *_ea .Tbl ,_acga float64 )*_gb .Table {_fdga :=_cdeb .TblGrid ;
if _fdga ==nil {return nil ;};_daaec :=len (_fdga .GridCol );if _daaec ==0{return nil ;};_bfcag :=[]float64 {};_gfda :=0.0;for _ ,_edfb :=range _fdga .GridCol {_gdcd :=_fd .FromEMU (_dgc .FromSTCoordinate (_edfb .WAttr ));_bfcag =append (_bfcag ,_gdcd );
_gfda +=_gdcd ;};_cac :=[]float64 {};for _aba :=0;_aba < _daaec ;_aba ++{_cac =append (_cac ,_bfcag [_aba ]/_gfda );};_addg :=_aef ._fcd .NewTable (_daaec );_addg .SetColumnWidths (_cac ...);_eage :=_cdeb .TblPr ;var _dgabe *_ea .CT_TableStyle ;if _gdd :=_eage .Choice ;
_gdd !=nil {if _gdd .TableStyle !=nil {_dgabe =_gdd .TableStyle ;}else if _gdd .TableStyleId !=nil {_dgabe =_aef ._dda .GetTableStyleById (*_gdd .TableStyleId );};};_gbg :=_ea .NewCT_TablePartStyle ();_gbg .TcStyle =_ea .NewCT_TableStyleCellStyle ();_gbg .TcTxStyle =_ea .NewCT_TableStyleTextStyle ();
if _dgabe !=nil {if _dgabe .WholeTbl !=nil {*_gbg =*_dgabe .WholeTbl ;};if _dgabe .TblBg !=nil {if _gbg .TcStyle .Fill ==nil {_gbg .TcStyle .Fill =_dgabe .TblBg .Fill ;};};};if _gbg .TcStyle .Fill ==nil {_gbg .TcStyle .Fill =_ea .NewCT_FillProperties ();
_gbg .TcStyle .Fill .NoFill =_eage .NoFill ;_gbg .TcStyle .Fill .SolidFill =_eage .SolidFill ;};_bcgc :=len (_cdeb .Tr );for _afe ,_ccgc :=range _cdeb .Tr {_ebd :=_afe ==0;_bge :=_afe ==_bcgc -1;_geb :=_afe %2==0;_baab :=len (_ccgc .Tc );var _fgbca *_ea .CT_TablePartStyle ;
if _dgabe !=nil {if _ebd {_fgbca =_dgabe .FirstRow ;}else if _geb {_fgbca =_dgabe .Band2H ;}else {_fgbca =_dgabe .Band1H ;};};var _cgb float64 ;for _bgf ,_bag :=range _ccgc .Tc {_fgbcg :=_bgf ==0;_fgc :=_bgf ==_baab -1;_fbfg :=_bgf %2==0;var _efc *_ea .CT_TablePartStyle ;
if _dgabe !=nil {if _fgbcg {_efc =_dgabe .FirstCol ;}else if _fbfg {_efc =_dgabe .Band2V ;}else {_efc =_dgabe .Band1V ;};};_bcd :=_eda (_eda (_efc ,_fgbca ),_gbg );_eeb :=_aef .addCellToTable (_addg ,_bag ,_bcd ,_acga *_cac [_bgf ],_ebd ,_bge ,_fgbcg ,_fgc );
if _eeb > _cgb {_cgb =_eeb ;};};_fagf :=_fd .FromEMU (_dgc .FromSTCoordinate (_ccgc .HAttr ));if _fagf < _cgb {_fagf =_cgb ;};if _fagf < _aae (4){_fagf =_aae (4);};_addg .SetRowHeight (_addg .CurRow (),_fagf );};return _addg ;};func _cbeb (_fcb ,_bebe *_ea .CT_TextBodyProperties )*_ea .CT_TextBodyProperties {_bcaf :=_ea .NewCT_TextBodyProperties ();
if _fcb !=nil {*_bcaf =*_fcb ;};if _bebe ==nil {return _bcaf ;};if _bcaf .RotAttr ==nil {_bcaf .RotAttr =_bebe .RotAttr ;};if _bcaf .SpcFirstLastParaAttr ==nil {_bcaf .SpcFirstLastParaAttr =_bebe .SpcFirstLastParaAttr ;};if _bcaf .VertOverflowAttr ==_ea .ST_TextVertOverflowTypeUnset {_bcaf .VertOverflowAttr =_bebe .VertOverflowAttr ;
};if _bcaf .HorzOverflowAttr ==_ea .ST_TextHorzOverflowTypeUnset {_bcaf .HorzOverflowAttr =_bebe .HorzOverflowAttr ;};if _bcaf .VertAttr ==_ea .ST_TextVerticalTypeUnset {_bcaf .VertAttr =_bebe .VertAttr ;};if _bcaf .WrapAttr ==_ea .ST_TextWrappingTypeUnset {_bcaf .WrapAttr =_bebe .WrapAttr ;
};if _bcaf .LInsAttr ==nil {_bcaf .LInsAttr =_bebe .LInsAttr ;};if _bcaf .TInsAttr ==nil {_bcaf .TInsAttr =_bebe .TInsAttr ;};if _bcaf .RInsAttr ==nil {_bcaf .RInsAttr =_bebe .RInsAttr ;};if _bcaf .BInsAttr ==nil {_bcaf .BInsAttr =_bebe .BInsAttr ;};if _bcaf .NumColAttr ==nil {_bcaf .NumColAttr =_bebe .NumColAttr ;
};if _bcaf .SpcColAttr ==nil {_bcaf .SpcColAttr =_bebe .SpcColAttr ;};if _bcaf .RtlColAttr ==nil {_bcaf .RtlColAttr =_bebe .RtlColAttr ;};if _bcaf .AnchorAttr ==_ea .ST_TextAnchoringTypeUnset {_bcaf .AnchorAttr =_bebe .AnchorAttr ;};if _bcaf .AnchorCtrAttr ==nil {_bcaf .AnchorCtrAttr =_bebe .AnchorCtrAttr ;
};if _bcaf .ForceAAAttr ==nil {_bcaf .ForceAAAttr =_bebe .ForceAAAttr ;};if _bcaf .UprightAttr ==nil {_bcaf .UprightAttr =_bebe .UprightAttr ;};if _bcaf .CompatLnSpcAttr ==nil {_bcaf .CompatLnSpcAttr =_bebe .CompatLnSpcAttr ;};if _bcaf .PrstTxWarp ==nil {_bcaf .PrstTxWarp =_bebe .PrstTxWarp ;
};if _bcaf .NoAutofit ==nil {_bcaf .NoAutofit =_bebe .NoAutofit ;};if _bcaf .NormAutofit ==nil {_bcaf .NormAutofit =_bebe .NormAutofit ;};if _bcaf .SpAutoFit ==nil {_bcaf .SpAutoFit =_bebe .SpAutoFit ;};if _bcaf .Scene3d ==nil {_bcaf .Scene3d =_bebe .Scene3d ;
};if _bcaf .Sp3d ==nil {_bcaf .Sp3d =_bebe .Sp3d ;};if _bcaf .FlatTx ==nil {_bcaf .FlatTx =_bebe .FlatTx ;};if _bcaf .ExtLst ==nil {_bcaf .ExtLst =_bebe .ExtLst ;};return _bcaf ;};var _bfbg =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};
func (_ebgd *convertContext )getColorFromMatrixReference (_eea *_ea .CT_StyleMatrixReference )_gb .Color {if _eea ==nil {return nil ;};var _efbb _gb .Color ;var _fgce string ;if _gca :=_eea .SrgbClr ;_gca !=nil {_fgce =_gca .ValAttr ;}else if _cfeg :=_eea .SchemeClr ;
_cfeg !=nil {_fgce =_dgc .GetColorStringFromDmlColor (_ebgd ._dda .GetColorBySchemeColor (_cfeg .ValAttr ));_fgce =_dgc .AdjustColor (_fgce ,_cfeg .EG_ColorTransform );};if _fgce !=""{_efbb =_gb .ColorRGBFromHex ("\u0023"+_fgce );};return _efbb ;};func (_ecfa *textboxContext )assignPropsToCurrentParagraph (_bef *_ea .CT_TextParagraphProperties ){_agad :=12.4;
if _bef ==nil {_ecfa ._ecdg ._cgba =_agad ;return ;};if _cacb :=_bef .DefRPr ;_cacb !=nil {_ddac :=_cacb .SzAttr ;if _ddac !=nil {_dfbff :=float64 (*_ddac )/1200;if _agad <=_dfbff {_agad =_dfbff ;};};};if _fdgc :=_bef .MarLAttr ;_fdgc !=nil {_ecfa ._ecdg ._aggc =_fd .FromEMU (int64 (*_fdgc ));
};_ecfa ._ecdg ._ffae =_ecfa ._aegf ;if _bee :=_bef .MarRAttr ;_bee !=nil {_ecfa ._ecdg ._ffae -=_fd .FromEMU (int64 (*_bee ));};if _fbea :=_bef .IndentAttr ;_fbea !=nil {_ecfa ._ecdg ._dbe =_fd .FromEMU (int64 (*_fbea ));};if _caa :=_bef .LatinLnBrkAttr ;
_caa !=nil {_ecfa ._ecdg ._dae =*_caa ;};if _gagg :=_bef .LnSpc ;_gagg !=nil {if _cdc :=_gagg .SpcPct ;_cdc !=nil {if _adef :=_cdc .ValAttr .ST_TextSpacingPercent ;_adef !=nil {_agad =float64 (*_adef )/5000;};};};var _accg float64 ;if _egdb :=_bef .SpcBef ;
_egdb !=nil {if _bbeae :=_egdb .SpcPts ;_bbeae !=nil {_accg =float64 (_bbeae .ValAttr )/100;};};_fgbcc :=_ecfa ._afac ;if len (_fgbcc )> 0{_accg -=_fgbcc [len (_fgbcc )-1]._fdaf ;if _accg < 0{_accg =0;};};_ecfa ._ecdg ._agc =_accg ;if _agadb :=_bef .SpcAft ;
_agadb !=nil {if _cdcd :=_agadb .SpcPts ;_cdcd !=nil {_ecfa ._ecdg ._fdaf =float64 (_cdcd .ValAttr )/100;};};_ecfa ._ecdg ._cgba =_agad ;_ecfa ._ecdg ._bede =_bef .AlgnAttr ;};type word struct{_egcf []*symbol ;_bgff float64 ;_dbca float64 ;_egad bool ;
};