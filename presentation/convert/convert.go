//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_de "bytes";_f "errors";_fcf "github.com/unidoc/unioffice/common";_ff "github.com/unidoc/unioffice/common/logger";_gf "github.com/unidoc/unioffice/common/tempstorage";_fb "github.com/unidoc/unioffice/internal/convertutils";_b "github.com/unidoc/unioffice/measurement";
_e "github.com/unidoc/unioffice/presentation";_ae "github.com/unidoc/unioffice/schema/soo/dml";_cc "github.com/unidoc/unioffice/schema/soo/dml/chart";_dg "github.com/unidoc/unioffice/schema/soo/pml";_ee "github.com/unidoc/unipdf/v3/contentstream/draw";
_ce "github.com/unidoc/unipdf/v3/core";_gfc "github.com/unidoc/unipdf/v3/creator";_da "github.com/unidoc/unipdf/v3/model";_ac "github.com/unidoc/unipdf/v3/render";_a "image";_d "image/color";_g "image/draw";_cg "math";_cd "strconv";_fc "strings";);func (_ccca *textboxContext )addCurrentParagraph (){_ccca ._dff =_ccca ._cgbe ._gefea +_ccca ._cgbe ._gdcdd +_ccca ._cgbe ._ecc +_ccca ._cgbe ._dbg ;
_ccca ._gbg =append (_ccca ._gbg ,_ccca ._cgbe );_ccca .alignParagraph ();};func (_cbc *convertContext )getShapesFromSpPr (_gae *_ae .CT_ShapeProperties ,_bcg *_ae .CT_ShapeStyle ,_abe bool ,_bee float64 ,_faa float64 )([]_gfc .Drawable ,float64 ,float64 ,float64 ,float64 ,_gfc .Color ,bool ){_efg :=[]_gfc .Drawable {};
var _adg ,_eafc ,_efbf ,_gefe ,_cbcd float64 ;var _efga ,_egg ,_aaa ,_gefd _gfc .Color ;var _bdg *_ae .CT_BlipFillProperties ;_afc ,_afa :=1.0,1.0;if _bcg !=nil {_efga ,_egg ,_gefd =_cbc .getStyleColors (_bcg );};if _eeed :=_gae .Ln ;_eeed !=nil {if _eeed .NoFill !=nil {_aaa ,_cbcd =nil ,0;
}else {_aaa ,_cbcd ,_afc =_cbc .getInfoFromLn (_eeed );if _aaa ==nil {_aaa =_gefd ;};};};if _gae .NoFill !=nil {_egg ,_afa =nil ,0;}else if _abe {_egg =_cbc ._eceb ._fcee ;_afa =_cbc ._eceb ._eecd ;_bdg =_cbc ._eceb ._eac ;}else if _dgdf :=_gae .SolidFill ;
_dgdf !=nil {_egg ,_afa =_cbc .getColorFromSolidFill (_dgdf );};var _bccb bool ;if _age :=_gae .Xfrm ;_age !=nil {_adg ,_eafc ,_efbf ,_gefe =_fb .GetDataFromXfrm (_age );_adg +=_bee ;_eafc +=_faa ;_bccb =true ;};if _afbf :=_gae .CustGeom ;_afbf !=nil {_bed :=[]_ee .Point {};
_gefc ,_ggbe :=1.0,1.0;if _ffb :=_afbf .PathLst ;_ffb !=nil {for _ ,_gcf :=range _ffb .Path {if _gcf !=nil {if _fef :=_gcf .WAttr ;_fef !=nil {_gefc =_efbf /_b .FromEMU (*_fef );};if _fdcf :=_gcf .HAttr ;_fdcf !=nil {_ggbe =_gefe /_b .FromEMU (*_fdcf );
};for _ ,_gbf :=range _gcf .Close {if _gbf !=nil {};};for _ ,_ccg :=range _gcf .MoveTo {if _ccg !=nil &&_ccg .Pt !=nil {_aefa ,_gea :=_eagb (_ccg .Pt );_bed =append (_bed ,_ee .Point {X :_aefa *_gefc +_adg ,Y :_gea *_ggbe +_eafc });};};for _ ,_fgfd :=range _gcf .LnTo {if _fgfd !=nil &&_fgfd .Pt !=nil {_eed ,_ddca :=_eagb (_fgfd .Pt );
_bed =append (_bed ,_ee .Point {X :_eed *_gefc +_adg ,Y :_ddca *_ggbe +_eafc });};};_fafe :=_cbc ._fffdc .NewPolygon ([][]_ee .Point {_bed });_fafe .SetFillColor (_egg );_fafe .SetFillOpacity (_afa );_fafe .SetBorderWidth (_cbcd );if _aaa !=nil {_fafe .SetBorderColor (_aaa );
_fafe .SetBorderOpacity (_afc );};_efg =append (_efg ,_fafe );};};};};if _ddda :=_gae .PrstGeom ;_ddda !=nil {switch _ddda .PrstAttr {case _ae .ST_ShapeTypeRect :if _bdg !=nil {_bcba :=_cbc .getShapeFromBlipFill (_bdg ,_adg ,_eafc ,_efbf ,_gefe ,false );
_efg =append (_efg ,_bcba );}else {_ggef :=_cbc ._fffdc .NewRectangle (_adg ,_eafc ,_efbf ,_gefe );_fagf :=_egg !=nil &&_afa > 0;if _fagf {_ggef .SetFillColor (_egg );_ggef .SetFillOpacity (_afa );};_gcc :=_aaa !=nil &&_afc > 0&&_cbcd > 0;if _gcc {_ggef .SetBorderWidth (_cbcd );
_ggef .SetBorderColor (_aaa );_ggef .SetBorderOpacity (_afc );};if _fagf ||_gcc {_efg =append (_efg ,_ggef );};};case _ae .ST_ShapeTypeLine :_dgdd :=_cbc ._fffdc .NewLine (_adg ,_eafc ,_adg +_efbf ,_eafc +_gefe );_dgdd .SetLineWidth (_cbcd );if _aaa !=nil {_dgdd .SetColor (_aaa );
};_efg =append (_efg ,_dgdd );};};return _efg ,_adg ,_eafc ,_efbf ,_gefe ,_efga ,_bccb ;};func (_cage *convertContext )makePdfImageFromBlipFill (_dace *_ae .CT_BlipFillProperties ,_cbdcf bool )(*_gfc .Image ,[]*_ae .CT_BlipChoice ,error ){if _ggfbe :=_dace .Blip ;
_ggfbe !=nil {if _badf :=_ggfbe .EmbedAttr ;_badf !=nil {var _dfeac _fcf .ImageRef ;var _daed bool ;if _cbdcf {_dfeac ,_daed =_cage ._bab .GetLayoutImageByRelID (*_badf );}else {_dfeac ,_daed =_cage ._bab .GetImageByRelID (*_badf );};if _daed {_fcbf ,_ebef :=_gf .Open (_dfeac .Path ());
if _ebef !=nil {_ff .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_ebef );return nil ,nil ,_ebef ;};defer _fcbf .Close ();_cdec ,_ ,_ebef :=_a .Decode (_fcbf );if _ebef !=nil {_ff .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_ebef );
return nil ,nil ,_ebef ;};if _ccgdg :=_dace .SrcRect ;_ccgdg !=nil {_daeda :=_cdec .Bounds ().Size ();_cfdb :=_daeda .X ;_gagb :=_daeda .Y ;var _cebd ,_dfced ,_cdgd ,_edfd int ;var _gecd bool ;if _ddgg :=_ccgdg .LAttr ;_ddgg !=nil {_cebd =int (float64 (_cfdb )*_fb .FromSTPercentage (_ddgg ));
_gecd =true ;}else {_cebd =0;};if _feac :=_ccgdg .TAttr ;_feac !=nil {_cdgd =int (float64 (_gagb )*_fb .FromSTPercentage (_feac ));_gecd =true ;}else {_cdgd =0;};if _dag :=_ccgdg .RAttr ;_dag !=nil {_dfced =int (float64 (_cfdb )*(1-_fb .FromSTPercentage (_dag )));
_gecd =true ;}else {_dfced =_cfdb ;};if _eega :=_ccgdg .BAttr ;_eega !=nil {_edfd =int (float64 (_gagb )*(1-_fb .FromSTPercentage (_eega )));_gecd =true ;}else {_edfd =_gagb ;};if _gecd {_cdec =_fb .CropImageByRect (_cdec ,_a .Rect (_cebd ,_cdgd ,_dfced +1,_edfd +1));
};};_bgag ,_ebef :=_cage ._fffdc .NewImageFromGoImage (_cdec );_bgag .SetEncoder (_ce .NewFlateEncoder ());if _fc .ToLower (_dfeac .Format ())=="\u006a\u0070\u0067"||_fc .ToLower (_dfeac .Format ())=="\u006a\u0070\u0065\u0067"{_bgag .SetEncoder (_ce .NewDCTEncoder ());
};if _ebef !=nil {_ff .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_ebef );
return nil ,nil ,_ebef ;};return _bgag ,_ggfbe .Choice ,nil ;};};};return nil ,nil ,nil ;};var _aace =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func (_daff *convertContext )applyBlipEffectsOnImg (_dfbg *_gfc .Image ,_cge ,_eedd float64 ,_adgc []*_ae .CT_BlipChoice )*_gfc .Image {if len (_adgc )==0{return _dfbg ;
};_dfbg .SetPos (_cge ,_eedd );_dffe ,_efdag :=_daff .renderPageWithDrawableToGoImage (_dfbg );if _efdag !=nil {_ff .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_efdag );
return _dfbg ;};_aabd ,_efdag :=_daff .renderCurrentStateToGoImage ();if _efdag !=nil {_ff .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_efdag );
return _dfbg ;};_eagg :=_dffe .Bounds ();_eaed :=_a .NewRGBA (_eagg );_dfgc ,_fefa :=_dfbg .Width (),_dfbg .Height ();for _ ,_faef :=range _adgc {for _ ,_fccg :=range _faef .AlphaModFix {if _edef :=_fccg .AmtAttr ;_edef !=nil {if _acfdf :=_edef .ST_PositivePercentageDecimal ;
_acfdf !=nil {_gagbe :=uint8 (255*(*_acfdf )/100000);_eaae :=_a .NewUniform (_d .Alpha {_gagbe });_g .Draw (_eaed ,_eagg ,_aabd ,_a .Point {0,0},_g .Src );_g .DrawMask (_eaed ,_eagg ,_dffe ,_a .Point {0,0},_eaae ,_a .Point {0,0},_g .Over );};};};};_gabf :=_a .Rect (int (_cge ),int (_eedd ),int (_cge +_dfgc )+1,int (_eedd +_fefa )+1);
_defa :=_fb .CropImageByRect (_eaed ,_gabf );_dbdd ,_efdag :=_daff ._fffdc .NewImageFromGoImage (_defa );if _efdag !=nil {_ff .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_efdag );
return _dfbg ;};return _dbdd ;};var _acb =_ecg (1.9);func (_dadf *textboxContext )alignVertically (_cbba _ae .ST_TextAnchoringType ){_dadf .alignParagraphsVertically (_cbba );_dadf .alignSymbolsVertically ();};func (_ge *convertContext )extractDefaultProperties (){_cec :=_ge ._cefa .X ();
_abd :=_cec .DefaultTextStyle ;var _be ,_fdg ,_bcc ,_cef ,_fcb ,_fa ,_cdef ,_bcd ,_dge ,_dga *_ae .CT_TextParagraphProperties ;if _abd !=nil {_be =_abd .DefPPr ;_fdg =_geec (_abd .Lvl1pPr ,_be );_bcc =_geec (_abd .Lvl2pPr ,_be );_cef =_geec (_abd .Lvl3pPr ,_be );
_fcb =_geec (_abd .Lvl4pPr ,_be );_fa =_geec (_abd .Lvl5pPr ,_be );_cdef =_geec (_abd .Lvl6pPr ,_be );_bcd =_geec (_abd .Lvl7pPr ,_be );_dge =_geec (_abd .Lvl8pPr ,_be );_dga =_geec (_abd .Lvl9pPr ,_be );_ge ._dgdg =_be ;_ge ._faee =_be .DefRPr ;};_ge ._bfcd =make ([]*_ae .CT_TextParagraphProperties ,9);
_ge ._bfcd [0]=_fdg ;_ge ._bfcd [1]=_bcc ;_ge ._bfcd [2]=_cef ;_ge ._bfcd [3]=_fcb ;_ge ._bfcd [4]=_fa ;_ge ._bfcd [5]=_cdef ;_ge ._bfcd [6]=_bcd ;_ge ._bfcd [7]=_dge ;_ge ._bfcd [8]=_dga ;_acbe :=_ge ._cefa .SlideMasters ()[0].X ();_bgf :=_acbe .TxStyles ;
_fbe :=_bgf .TitleStyle ;_ge ._dfa =_geec (_fbe .DefPPr ,_be );_ge ._egcc =_ge ._dfa .DefRPr ;_ge ._edbd =make ([]*_ae .CT_TextParagraphProperties ,9);_ge ._edbd [0]=_geec (_fbe .Lvl1pPr ,_fdg );_ge ._edbd [1]=_geec (_fbe .Lvl2pPr ,_bcc );_ge ._edbd [2]=_geec (_fbe .Lvl3pPr ,_cef );
_ge ._edbd [3]=_geec (_fbe .Lvl4pPr ,_fcb );_ge ._edbd [4]=_geec (_fbe .Lvl5pPr ,_fa );_ge ._edbd [5]=_geec (_fbe .Lvl6pPr ,_cdef );_ge ._edbd [6]=_geec (_fbe .Lvl7pPr ,_bcd );_ge ._edbd [7]=_geec (_fbe .Lvl8pPr ,_dge );_ge ._edbd [8]=_geec (_fbe .Lvl9pPr ,_dga );
_cbf :=_bgf .BodyStyle ;_ge ._acaa =_geec (_cbf .DefPPr ,_be );_ge ._afad =_ge ._acaa .DefRPr ;_ge ._afab =make ([]*_ae .CT_TextParagraphProperties ,9);_ge ._afab [0]=_geec (_cbf .Lvl1pPr ,_fdg );_ge ._afab [1]=_geec (_cbf .Lvl2pPr ,_bcc );_ge ._afab [2]=_geec (_cbf .Lvl3pPr ,_cef );
_ge ._afab [3]=_geec (_cbf .Lvl4pPr ,_fcb );_ge ._afab [4]=_geec (_cbf .Lvl5pPr ,_fa );_ge ._afab [5]=_geec (_cbf .Lvl6pPr ,_cdef );_ge ._afab [6]=_geec (_cbf .Lvl7pPr ,_bcd );_ge ._afab [7]=_geec (_cbf .Lvl8pPr ,_dge );_ge ._afab [8]=_geec (_cbf .Lvl9pPr ,_dga );
};func _gegd (_cbce int ,_egef bool )string {_dfce :=(_cbce -1)/26+1;_efcf :=byte ((_cbce -1)%26);if _egef {_efcf +=byte (65);}else {_efcf +=byte (97);};_ggcc :=_de .NewBuffer ([]byte {});for _fcga :=0;_fcga < _dfce ;_fcga ++{_ggcc .Write ([]byte {_efcf });
};return _ggcc .String ();};func (_caa *convertContext )getShapeFromBlipFill (_eda *_ae .CT_BlipFillProperties ,_abab ,_eebf ,_fcgbf ,_ecdg float64 ,_fgdc bool )_gfc .Drawable {_dfcb ,_dfde ,_egge :=_caa .makePdfImageFromBlipFill (_eda ,_fgdc );if _egge !=nil {_ff .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_egge );
return nil ;};if _dfcb ==nil {return nil ;};if _gcgc :=_eda .Tile ;_gcgc !=nil {_dfcb =_caa .tileImage (_dfcb ,_eda .Tile ,_fcgbf ,_ecdg );};if _ecfa :=_eda .Stretch ;_ecfa !=nil {_dfcb ,_abab ,_eebf =_caa .stretchImage (_dfcb ,_eda .Stretch ,_abab ,_eebf ,_fcgbf ,_ecdg );
};if _dfcb ==nil {return nil ;};if len (_dfde )==0{_dfcb .SetPos (_abab ,_eebf );return _dfcb ;};_dfcb =_caa .applyBlipEffectsOnImg (_dfcb ,_abab ,_eebf ,_dfde );_dfcb .SetPos (_abab ,_eebf );return _dfcb ;};func (_fca *convertContext )getGroupConnectors (_ddge *_dg .CT_Connector ,_fdgc float64 ,_cbg float64 )[]_gfc .Drawable {_fab ,_ ,_ ,_ ,_ ,_ ,_ :=_fca .getShapesFromSpPr (_ddge .SpPr ,_ddge .Style ,false ,_fdgc ,_cbg );
return _fab ;};func _aeag (_cdfa *bool )bool {return _cdfa !=nil &&*_cdfa };func _eaec (_bcce ,_abbb *_ae .CT_TextBodyProperties )*_ae .CT_TextBodyProperties {_gdfg :=_ae .NewCT_TextBodyProperties ();if _bcce !=nil {*_gdfg =*_bcce ;};if _abbb ==nil {return _gdfg ;
};if _gdfg .RotAttr ==nil {_gdfg .RotAttr =_abbb .RotAttr ;};if _gdfg .SpcFirstLastParaAttr ==nil {_gdfg .SpcFirstLastParaAttr =_abbb .SpcFirstLastParaAttr ;};if _gdfg .VertOverflowAttr ==_ae .ST_TextVertOverflowTypeUnset {_gdfg .VertOverflowAttr =_abbb .VertOverflowAttr ;
};if _gdfg .HorzOverflowAttr ==_ae .ST_TextHorzOverflowTypeUnset {_gdfg .HorzOverflowAttr =_abbb .HorzOverflowAttr ;};if _gdfg .VertAttr ==_ae .ST_TextVerticalTypeUnset {_gdfg .VertAttr =_abbb .VertAttr ;};if _gdfg .WrapAttr ==_ae .ST_TextWrappingTypeUnset {_gdfg .WrapAttr =_abbb .WrapAttr ;
};if _gdfg .LInsAttr ==nil {_gdfg .LInsAttr =_abbb .LInsAttr ;};if _gdfg .TInsAttr ==nil {_gdfg .TInsAttr =_abbb .TInsAttr ;};if _gdfg .RInsAttr ==nil {_gdfg .RInsAttr =_abbb .RInsAttr ;};if _gdfg .BInsAttr ==nil {_gdfg .BInsAttr =_abbb .BInsAttr ;};if _gdfg .NumColAttr ==nil {_gdfg .NumColAttr =_abbb .NumColAttr ;
};if _gdfg .SpcColAttr ==nil {_gdfg .SpcColAttr =_abbb .SpcColAttr ;};if _gdfg .RtlColAttr ==nil {_gdfg .RtlColAttr =_abbb .RtlColAttr ;};if _gdfg .AnchorAttr ==_ae .ST_TextAnchoringTypeUnset {_gdfg .AnchorAttr =_abbb .AnchorAttr ;};if _gdfg .AnchorCtrAttr ==nil {_gdfg .AnchorCtrAttr =_abbb .AnchorCtrAttr ;
};if _gdfg .ForceAAAttr ==nil {_gdfg .ForceAAAttr =_abbb .ForceAAAttr ;};if _gdfg .UprightAttr ==nil {_gdfg .UprightAttr =_abbb .UprightAttr ;};if _gdfg .CompatLnSpcAttr ==nil {_gdfg .CompatLnSpcAttr =_abbb .CompatLnSpcAttr ;};if _gdfg .PrstTxWarp ==nil {_gdfg .PrstTxWarp =_abbb .PrstTxWarp ;
};if _gdfg .NoAutofit ==nil {_gdfg .NoAutofit =_abbb .NoAutofit ;};if _gdfg .NormAutofit ==nil {_gdfg .NormAutofit =_abbb .NormAutofit ;};if _gdfg .SpAutoFit ==nil {_gdfg .SpAutoFit =_abbb .SpAutoFit ;};if _gdfg .Scene3d ==nil {_gdfg .Scene3d =_abbb .Scene3d ;
};if _gdfg .Sp3d ==nil {_gdfg .Sp3d =_abbb .Sp3d ;};if _gdfg .FlatTx ==nil {_gdfg .FlatTx =_abbb .FlatTx ;};if _gdfg .ExtLst ==nil {_gdfg .ExtLst =_abbb .ExtLst ;};return _gdfg ;};func (_fba *convertContext )makePdfDivisionFromTxBody (_gag *_ae .CT_TextBody ,_ddb *_ae .CT_TableStyleTextStyle )*_gfc .Division {_gba :=_fba ._fffdc .NewDivision ();
_ddef :=_fba ._dgdg ;_gfe :=_ae .ST_TextAnchoringTypeT ;if _efgd :=_gag .BodyPr ;_efgd !=nil {if _ddcg :=_efgd .AnchorAttr ;_ddcg !=_ae .ST_TextAnchoringTypeUnset {_gfe =_efgd .AnchorAttr ;};};if _cfe :=_gag .LstStyle ;_cfe !=nil {var _ebad *_ae .CT_TextParagraphProperties ;
if _cfe .Lvl1pPr !=nil {_ebad =_cfe .Lvl1pPr ;}else {_ebad =_fba ._bfcd [0];};_ddef =_geec (_ebad ,_geec (_cfe .DefPPr ,_ddef ));};for _ ,_cbd :=range _gag .P {if _cbd !=nil {_ggfd :=_fba ._fffdc .NewStyledParagraph ();_fefd :=_geec (_cbd .PPr ,_ddef );
_dcdd :=_dfdf (_cbd .EndParaRPr ,_fefd .DefRPr );switch _fefd .AlgnAttr {case _ae .ST_TextAlignTypeR :_ggfd .SetTextAlignment (_gfc .TextAlignmentRight );case _ae .ST_TextAlignTypeCtr :_ggfd .SetTextAlignment (_gfc .TextAlignmentCenter );case _ae .ST_TextAlignTypeJust :_ggfd .SetTextAlignment (_gfc .TextAlignmentJustify );
};if len (_cbd .EG_TextRun )==0{_ggfd .Append ("\u000a");_gba .Add (_ggfd );continue ;};for _ ,_gab :=range _cbd .EG_TextRun {if _agf :=_gab .Br ;_agf !=nil {_ggfd .Append ("\u000a");}else if _bacc :=_gab .R ;_bacc !=nil {_gdea :=_ega (_bacc .RPr ,_ddb );
_gdea =_dfdf (_gdea ,_dcdd );var _edd _gfc .Color ;if _gdea .SolidFill !=nil {_edd ,_ =_fba .getColorFromSolidFill (_gdea .SolidFill );}else {_edd =_gfc .ColorBlack ;};_gdcd ,_gbead ,_acfd ,_ :=_fba .makeStyleFromRPr (_gdea );_gdcd .Color =_edd ;if _gbead {_gdcd .TextRise =0.5;
}else if _acfd {_gdcd .TextRise =-0.5;};_dgad :=_bacc .T ;if _gdea .CapAttr ==_ae .ST_TextCapsTypeAll {for _ ,_dfb :=range _dgad {_dfb =[]rune (_fc .ToUpper (string (_dfb )))[0];};};_adee :=_ggfd .Append (_dgad );_adee .Style =*_gdcd ;};};_ =_gfe ;_gba .Add (_ggfd );
};};return _gba ;};func (_dgdb *textboxContext )addCurrentWordToParagraph (){if _dgdb ._bcag &&_dgdb ._dacg ._ccda +_dgdb ._gedd ._gaec > _dgdb ._dacg ._fbdd {_dgdb .newLine ();};if !_dgdb ._gedd ._agef ||len (_dgdb ._dacg ._dae )> 0{_dgdb ._gedd ._ded =_dgdb ._dacg ._ccda ;
_dgdb ._dacg ._dae =append (_dgdb ._dacg ._dae ,_dgdb ._gedd );_dgdb ._dacg ._ccda +=_dgdb ._gedd ._gaec ;for _ ,_cgae :=range _dgdb ._gedd ._fge {_dgdb .adjustHeights (_cgae ._dfbf );};};};func _eged (_aaed ,_afg *_ae .CT_TablePartStyle )*_ae .CT_TablePartStyle {_cfeg :=_ae .NewCT_TablePartStyle ();
if _aaed !=nil {*_cfeg =*_aaed ;};if _afg ==nil {return _cfeg ;};if _cfeg .TcTxStyle ==nil {_cfeg .TcTxStyle =_afg .TcTxStyle ;}else {_cfeg .TcTxStyle =_bbgec (_cfeg .TcTxStyle ,_afg .TcTxStyle );};if _cfeg .TcStyle ==nil {_cfeg .TcStyle =_afg .TcStyle ;
}else {_cfeg .TcStyle =_feb (_cfeg .TcStyle ,_afg .TcStyle );};return _cfeg ;};func (_bcdf *textboxContext )addTextSymbol (_gbgc *symbol ){_aebd :=_gfc .New ();_affb :=_aebd .NewStyledParagraph ();_affb .SetMargins (0,0,0,0);_gdd :=_affb .Append (_gbgc ._dgbg );
_gfcf :=0.0;if _gbgc ._ebcf !=nil {_gdd .Style =*_gbgc ._ebcf ;if _gbgc ._ebcf .CharSpacing !=0{_gfcf =_gbgc ._ebcf .CharSpacing ;};};_gbgc ._ccec =_affb .Height ();_gbgc ._dfbf =_affb .Height ()*1.2;if _gbgc ._gfcad ==0{_gbgc ._gfcad =_affb .Width ()+_gfcf ;
};if len (_bcdf ._gedd ._fge )> 0{_ggfa :=_bcdf ._gedd ._fge [len (_bcdf ._gedd ._fge )-1]._dgbg ;if _bcdf ._cgbe ._ebfb ||_fb .IsNoSpaceLanguage (_ggfa )||(_ggfa =="\u0020")!=(_gbgc ._dgbg =="\u0020"){_bcdf .addCurrentWordToParagraph ();_bcdf .newWord ();
};};_bcdf ._gedd ._fge =append (_bcdf ._gedd ._fge ,_gbgc );_gbgc ._ggge =_bcdf ._gedd ._gaec ;_bcdf ._gedd ._gaec +=_gbgc ._gfcad ;if _gbgc ._dgbg !="\u0020"{_bcdf ._gedd ._agef =false ;};if _bcdf ._gedd ._gaec >=_bcdf ._cgbe ._ggea -_bcdf ._cgbe ._efgf {_bcdf .addCurrentWordToParagraph ();
_bcdf .newLine ();_bcdf .newWord ();};};func (_gfgf *textboxContext )newParagraph (){_gcd :=&paragraph {};_gcd ._gefea =_gfgf ._dff ;_gfgf ._cgbe =_gcd ;};func (_bb *convertContext )drawSlide (){_bb ._fffdc .NewPage ();for _ ,_bcdb :=range _bb ._fafb {if _bcdb !=nil {_bb ._fffdc .MoveTo (0,0);
_bb ._fffdc .Draw (_bcdb );};};};func (_babg *textboxContext )alignParagraphsVertically (_bcde _ae .ST_TextAnchoringType ){if _bcde ==_ae .ST_TextAnchoringTypeT {return ;};_gefa :=0.0;for _ ,_cddc :=range _babg ._gbg {_gefa +=_cddc ._gdcdd +_cddc ._ecc +_cddc ._dbg ;
};var _gcba float64 ;switch _bcde {case _ae .ST_TextAnchoringTypeCtr :_gcba =(_babg ._fbgb -_gefa )/2;case _ae .ST_TextAnchoringTypeB :_gcba =_babg ._fbgb -_gefa ;};for _ ,_eacg :=range _babg ._gbg {_eacg ._gefea +=_gcba ;};};func (_ccaf *convertContext )getColorFromSolidFill (_cbbdd *_ae .CT_SolidColorFillProperties )(_gfc .Color ,float64 ){if _cbbdd ==nil {return nil ,1;
};var _baed string ;_bgbd :=1.0;if _def :=_cbbdd .SrgbClr ;_def !=nil {_baed =_def .ValAttr ;_bgbd =_fb .GetOpacityFromColorTransform (_def .EG_ColorTransform );}else if _cdde :=_cbbdd .SchemeClr ;_cdde !=nil {_baed =_fb .GetColorStringFromDmlColor (_ccaf ._bab .GetColorBySchemeColor (_cdde .ValAttr ));
_baed =_fb .AdjustColor (_baed ,_cdde .EG_ColorTransform );_bgbd =_fb .GetOpacityFromColorTransform (_cdde .EG_ColorTransform );};if _baed !=""{_dfca :=_gfc .ColorRGBFromHex ("\u0023"+_baed );return _dfca ,_bgbd ;};return nil ,1;};func (_ege *convertContext )makePdfBlockFromTxBody (_fdcd *_ae .CT_TextBody ,_gdf *_ae .CT_TextBodyProperties ,_ceeg *_ae .CT_TextListStyle ,_cbbd ,_gfef float64 ,_aega _gfc .Color ,_ceff ,_bbd bool )(*_gfc .Block ,error ){var _gfbg *_ae .CT_TextParagraphProperties ;
if _deg :=_fdcd .LstStyle ;_deg !=nil {var _bbg *_ae .CT_TextParagraphProperties ;if _deg .Lvl1pPr !=nil {_bbg =_deg .Lvl1pPr ;};_gfbg =_geec (_bbg ,_deg .DefPPr );};var _bbge *_ae .CT_TextParagraphProperties ;if _gfbg !=nil {if _ceff {_bbge =_ege ._edbd [0];
}else if _bbd {_bbge =_ege ._afab [0];}else {_bbge =_ege ._bfcd [0];};if _ceeg !=nil {_bbge =_geec (_geec (_ceeg .Lvl1pPr ,_ceeg .DefPPr ),_bbge );};_bbge =_geec (_gfbg ,_bbge );}else {if _ceff {_bbge =_ege ._dfa ;}else if _bbd {_bbge =_ege ._acaa ;}else {_bbge =_ege ._dgdg ;
};};_fgfb ,_ddgb :=_ecg (2.5),_ecg (2.5);_ced ,_fbg :=_ecg (1.3),_ecg (1.3);_fcbg :=true ;_aea :=_ae .ST_TextAnchoringTypeT ;if _gdf !=nil {if _fcfb :=_gdf .AnchorAttr ;_fcfb !=_ae .ST_TextAnchoringTypeUnset {_aea =_fcfb ;};};if _aag :=_fdcd .BodyPr ;_aag !=nil {if _afcd :=_aag .LInsAttr ;
_afcd !=nil {_fgfb =_b .FromEMU (_fb .FromSTCoordinate32 (*_afcd ));};if _cba :=_aag .TInsAttr ;_cba !=nil {_ced =_b .FromEMU (_fb .FromSTCoordinate32 (*_cba ));};if _gggf :=_aag .RInsAttr ;_gggf !=nil {_ddgb =_b .FromEMU (_fb .FromSTCoordinate32 (*_gggf ));
};if _fffd :=_aag .BInsAttr ;_fffd !=nil {_fbg =_b .FromEMU (_fb .FromSTCoordinate32 (*_fffd ));};_fcbg =_aag .WrapAttr !=_ae .ST_TextWrappingTypeNone ;if _cea :=_aag .AnchorAttr ;_cea !=_ae .ST_TextAnchoringTypeUnset {_aea =_aag .AnchorAttr ;};};_ggc :=_fb .MakeTempCreator (_cbbd ,_gfef );
_ggc .SetPageMargins (_fgfb ,_ddgb ,_ced ,_fbg );_fdb :=&textboxContext {_bead :_ege ,_bcag :_fcbg ,_edg :_cbbd -_fgfb -_ddgb ,_fbgb :_gfef -_ced -_fbg ,_efc :_ggc ,_gbg :[]*paragraph {}};_cda :=1;for _ ,_fbgf :=range _fdcd .P {if _fbgf !=nil {_gece :=_fbgf .PPr ;
var _gedc *prefixData ;if _gece !=nil &&_gece .BuNone ==nil {var _gfd string ;var _fec bool ;if _fcgd :=_gece .BuAutoNum ;_fcgd !=nil {var _bcca string ;if _dbc :=_fcgd .StartAtAttr ;_dbc !=nil {_cda =int (*_dbc );};var _dcb string ;switch _fcgd .TypeAttr {case _ae .ST_TextAutonumberSchemeAlphaUcParenBoth ,_ae .ST_TextAutonumberSchemeAlphaUcParenR ,_ae .ST_TextAutonumberSchemeAlphaUcPeriod :_dcb =_gegd (_cda ,true );
case _ae .ST_TextAutonumberSchemeAlphaLcParenBoth ,_ae .ST_TextAutonumberSchemeAlphaLcParenR ,_ae .ST_TextAutonumberSchemeAlphaLcPeriod :_dcb =_gegd (_cda ,false );case _ae .ST_TextAutonumberSchemeRomanUcParenBoth ,_ae .ST_TextAutonumberSchemeRomanUcParenR ,_ae .ST_TextAutonumberSchemeRomanUcPeriod :_dcb =_gce (_cda ,true );
case _ae .ST_TextAutonumberSchemeRomanLcParenBoth ,_ae .ST_TextAutonumberSchemeRomanLcParenR ,_ae .ST_TextAutonumberSchemeRomanLcPeriod :_dcb =_gce (_cda ,false );default:_dcb =_cd .Itoa (_cda );};switch _fcgd .TypeAttr {case _ae .ST_TextAutonumberSchemeAlphaLcPeriod ,_ae .ST_TextAutonumberSchemeAlphaUcPeriod ,_ae .ST_TextAutonumberSchemeArabicPeriod ,_ae .ST_TextAutonumberSchemeRomanLcPeriod ,_ae .ST_TextAutonumberSchemeRomanUcPeriod ,_ae .ST_TextAutonumberSchemeArabicDbPeriod ,_ae .ST_TextAutonumberSchemeEa1ChsPeriod ,_ae .ST_TextAutonumberSchemeEa1ChtPeriod ,_ae .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_ae .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_ae .ST_TextAutonumberSchemeThaiAlphaPeriod ,_ae .ST_TextAutonumberSchemeThaiNumPeriod ,_ae .ST_TextAutonumberSchemeHindiAlphaPeriod ,_ae .ST_TextAutonumberSchemeHindiNumPeriod ,_ae .ST_TextAutonumberSchemeHindiAlpha1Period :_bcca ="\u002e";
case _ae .ST_TextAutonumberSchemeAlphaLcParenR ,_ae .ST_TextAutonumberSchemeAlphaUcParenR ,_ae .ST_TextAutonumberSchemeArabicParenR ,_ae .ST_TextAutonumberSchemeRomanLcParenR ,_ae .ST_TextAutonumberSchemeRomanUcParenR ,_ae .ST_TextAutonumberSchemeThaiAlphaParenR ,_ae .ST_TextAutonumberSchemeThaiNumParenR ,_ae .ST_TextAutonumberSchemeHindiNumParenR :_bcca ="\u0029";
};_gfd =_dcb +_bcca ;_cda ++;}else if _dcfg :=_gece .BuChar ;_dcfg !=nil {_geba :=_dcfg .CharAttr ;if _fefg ,_ggce :=_aace [_geba ];_ggce {_geba =string (rune (_fefg ));}else {_geba ="\u2022";};_gfd =_geba ;_fec =true ;};if _gfd !=""{var _fcc ,_ebc float64 ;
if _gece .MarLAttr !=nil {_fcc =_b .FromEMU (int64 (*_gece .MarLAttr ));};if _gece .IndentAttr !=nil {_ebc =_b .FromEMU (int64 (*_gece .IndentAttr ));};_gedc =&prefixData {_dffa :_gfd ,_deb :_fec ,_bbe :_fcc ,_ffad :_ebc };};};_gece =_geec (_gece ,_bbge );
_eea :=_dfdf (_fbgf .EndParaRPr ,_gece .DefRPr );_fdb .newParagraph ();_fdb .assignPropsToCurrentParagraph (_gece );_fdb .newLine ();_fdb .newWord ();for _acee ,_aebc :=range _fbgf .EG_TextRun {_fdb .addTextRun (_aebc ,_eea ,_aega ,_gedc );if _acee > 0{_gedc =nil ;
};};_fdb .addCurrentWordToParagraph ();};_fdb .addCurrentParagraph ();};_fdb .alignVertically (_aea );_fdb .drawParagraphs ();return _fb .MakeBlockFromCreator (_ggc );};func _eagb (_deed *_ae .CT_AdjPoint2D )(float64 ,float64 ){var _gacg ,_afdd float64 ;
_cdc ,_ecf :=_deed .XAttr ,_deed .YAttr ;if _adcf :=_cdc .ST_Coordinate ;_adcf !=nil {_gacg =_b .FromEMU (_fb .FromSTCoordinate (*_adcf ));};if _bbeb :=_ecf .ST_Coordinate ;_bbeb !=nil {_afdd =_b .FromEMU (_fb .FromSTCoordinate (*_bbeb ));};return _gacg ,_afdd ;
};func (_fafda *textboxContext )assignPropsToCurrentParagraph (_gac *_ae .CT_TextParagraphProperties ){_gdced :=12.4;if _gac ==nil {_fafda ._cgbe ._bdd =_gdced ;return ;};if _dddf :=_gac .DefRPr ;_dddf !=nil {_bef :=_dddf .SzAttr ;if _bef !=nil {_fgea :=float64 (*_bef )/1200;
if _gdced <=_fgea {_gdced =_fgea ;};};};if _gbba :=_gac .MarLAttr ;_gbba !=nil {_fafda ._cgbe ._efgf =_b .FromEMU (int64 (*_gbba ));};_fafda ._cgbe ._ggea =_fafda ._edg ;if _cebg :=_gac .MarRAttr ;_cebg !=nil {_fafda ._cgbe ._ggea -=_b .FromEMU (int64 (*_cebg ));
};if _agba :=_gac .IndentAttr ;_agba !=nil {_fafda ._cgbe ._bfb =_b .FromEMU (int64 (*_agba ));};if _gbdb :=_gac .LatinLnBrkAttr ;_gbdb !=nil {_fafda ._cgbe ._ebfb =*_gbdb ;};if _efff :=_gac .LnSpc ;_efff !=nil {if _cfea :=_efff .SpcPct ;_cfea !=nil {if _acfe :=_cfea .ValAttr .ST_TextSpacingPercent ;
_acfe !=nil {_gdced =float64 (*_acfe )/5000;};};};var _ceac float64 ;if _gaa :=_gac .SpcBef ;_gaa !=nil {if _bfg :=_gaa .SpcPts ;_bfg !=nil {_ceac =float64 (_bfg .ValAttr )/100;};};_afdf :=_fafda ._gbg ;if len (_afdf )> 0{_ceac -=_afdf [len (_afdf )-1]._dbg ;
if _ceac < 0{_ceac =0;};};_fafda ._cgbe ._gdcdd =_ceac ;if _ebea :=_gac .SpcAft ;_ebea !=nil {if _bae :=_ebea .SpcPts ;_bae !=nil {_fafda ._cgbe ._dbg =float64 (_bae .ValAttr )/100;};};_fafda ._cgbe ._bdd =_gdced ;_fafda ._cgbe ._cgf =_gac .AlgnAttr ;};
func _afe (_dfe string )[]*symbol {_edcd :=[]*symbol {};for _ ,_gggfg :=range _dfe {_edcd =append (_edcd ,&symbol {_dgbg :string (_gggfg )});};return _edcd ;};func (_ggfb *convertContext )getConnectors (_fff *_dg .CT_Connector )[]_gfc .Drawable {_edb ,_ ,_ ,_ ,_ ,_ ,_ :=_ggfb .getShapesFromSpPr (_fff .SpPr ,_fff .Style ,false ,0.0,0.0);
return _edb ;};var _gegf =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
func (_cddd *convertContext )getShapes (_cfb *_dg .CT_Shape ,_bea bool ,_aeff bool )[]_gfc .Drawable {_facf :=[]_gfc .Drawable {};_acd :=_cfb .SpPr ;if _acd ==nil {return _facf ;};var _efda bool ;if _gdb :=_cfb .UseBgFillAttr ;_gdb !=nil {_efda =*_gdb ;
};_fe ,_acbg ,_bac ,_bgc ,_dgd ,_dcf ,_ebfe :=_cddd .getShapesFromSpPr (_acd ,_cfb .Style ,_efda ,0.0,0.0);if !_aeff {_facf =append (_facf ,_fe ...);};if _abcg :=_cfb .TxBody ;_abcg !=nil &&!_bea {_ede ,_egd ,_caec ,_gafe ,_cce ,_dcd :=_cddd .getPhData (_cfb );
if _aeff &&!(_gafe ||_cce ){return _facf ;};if _ede !=nil &&!_ebfe {_acbg ,_bac ,_bgc ,_dgd =_fb .GetDataFromXfrm (_ede );};_agbg ,_adf :=_cddd .makePdfBlockFromTxBody (_abcg ,_egd ,_caec ,_bgc ,_dgd ,_dcf ,_gafe ,_dcd );if _adf !=nil {_ff .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_adf );
}else if _agbg !=nil {_agbg .SetPos (_acbg ,_bac );_facf =append (_facf ,_agbg );};};return _facf ;};type word struct{_fge []*symbol ;_ded float64 ;_gaec float64 ;_agef bool ;};func _ega (_dfgg *_ae .CT_TextCharacterProperties ,_gdab *_ae .CT_TableStyleTextStyle )*_ae .CT_TextCharacterProperties {_acc :=_ae .NewCT_TextCharacterProperties ();
if _dfgg !=nil {*_acc =*_dfgg ;};if _gdab ==nil {return _acc ;};if _acc .BAttr ==nil &&_gdab .BAttr !=_ae .ST_OnOffStyleTypeUnset {_bgbc :=_gdab .BAttr ==_ae .ST_OnOffStyleTypeOn ;_acc .BAttr =&_bgbc ;};if _acc .IAttr ==nil &&_gdab .IAttr !=_ae .ST_OnOffStyleTypeUnset {_dabbd :=_gdab .IAttr ==_ae .ST_OnOffStyleTypeOn ;
_acc .IAttr =&_dabbd ;};if _acc .NoFill ==nil &&_acc .SolidFill ==nil {_acc .SolidFill =_ae .NewCT_SolidColorFillProperties ();_acc .SolidFill .ScrgbClr =_gdab .ScrgbClr ;_acc .SolidFill .SrgbClr =_gdab .SrgbClr ;_acc .SolidFill .HslClr =_gdab .HslClr ;
_acc .SolidFill .SysClr =_gdab .SysClr ;_acc .SolidFill .SchemeClr =_gdab .SchemeClr ;_acc .SolidFill .PrstClr =_gdab .PrstClr ;};if _cgaec :=_gdab .Font ;_cgaec !=nil &&_acc .Latin ==nil &&_acc .Ea ==nil &&_acc .Cs ==nil {_acc .Latin =_cgaec .Latin ;_acc .Ea =_cgaec .Ea ;
_acc .Cs =_cgaec .Cs ;};return _acc ;};func (_df *convertContext )makePdfBlockFromChart (_fd *_cc .Chart ,_aef ,_fcfe float64 )(*_gfc .Block ,error ){_bc :=_fd .CT_RelId .IdAttr ;_bg :=_df ._bab .GetChartSpaceByRelId (_bc );if _bg ==nil {return nil ,_f .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");
};var _dd *_ae .Theme ;_ea :=_df ._cefa .Themes ();if len (_ea )> 0{_dd =_ea [0];};return _fb .MakeBlockFromChartSpace (_bg ,_aef ,_fcfe ,_dd );};func (_ecbd *textboxContext )alignParagraph (){_cegc :=_ecbd ._cgbe ;if _cegc ._cgf ==_ae .ST_TextAlignTypeL {return ;
};_ccfe :=len (_cegc ._ffc )-1;for _abec ,_cbec :=range _cegc ._ffc {_gdeb :=true ;_ceea :=len (_cbec ._dae );_dfba :=0.0;for _abbg :=len (_cbec ._dae )-1;_abbg >=0;_abbg --{_edee :=_cbec ._dae [_abbg ];if _gdeb &&_edee ._agef {_ceea =_abbg ;}else {_gdeb =false ;
for _ ,_bedd :=range _edee ._fge {_dfba +=_bedd ._gfcad ;};};};_cbec ._dae =_cbec ._dae [:_ceea ];_edca :=_cbec ._fbdd -_cbec ._aad -_dfba ;switch _cegc ._cgf {case _ae .ST_TextAlignTypeR :_cbec .moveRight (_edca );case _ae .ST_TextAlignTypeCtr :_cbec .moveRight (_edca /2);
case _ae .ST_TextAlignTypeJust :if _abec !=_ccfe {_gfbf :=[]*word {};for _ ,_ffee :=range _cbec ._dae {if _ffee ._agef {_gfbf =append (_gfbf ,_ffee );};};_dfcg :=_edca /float64 (len (_gfbf ));for _ ,_ebgad :=range _gfbf {_ebgad ._gaec +=_dfcg ;};var _dgag *word ;
for _ ,_bafg :=range _cbec ._dae {if _dgag !=nil {_bafg ._ded =_dgag ._ded +_dgag ._gaec ;};_dgag =_bafg ;};};};};};func _dbce (_dgf *_dg .CT_Shape )(_dg .ST_PlaceholderType ,*uint32 ){if _bgd :=_dgf .NvSpPr ;_bgd !=nil {if _bacca :=_bgd .NvPr ;_bacca !=nil {if _cgd :=_bacca .Ph ;
_cgd !=nil {return _cgd .TypeAttr ,_cgd .IdxAttr ;};};};return _dg .ST_PlaceholderTypeUnset ,nil ;};type symbolStyle struct{_efgab *string ;_cbeg *float64 ;_gbbb *string ;_deec *bool ;_ggag *bool ;_adff *bool ;_gbce *bool ;_bgbe *bool ;};func _dcec (_ddgef ,_cbeaa *_ae .CT_TextBody )(*_ae .CT_TextBodyProperties ,*_ae .CT_TextListStyle ){if _ddgef ==nil &&_cbeaa ==nil {return nil ,nil ;
};if _ddgef ==nil {return _cbeaa .BodyPr ,_cbeaa .LstStyle ;};if _cbeaa ==nil {return _ddgef .BodyPr ,_ddgef .LstStyle ;};_fabb ,_dbfa :=_ddgef .BodyPr ,_ddgef .LstStyle ;_fggd ,_aagd :=_cbeaa .BodyPr ,_cbeaa .LstStyle ;_fgba :=_eaec (_fabb ,_fggd );_agfb :=_gfce (_dbfa ,_aagd );
return _fgba ,_agfb ;};type convertContext struct{_fffdc *_gfc .Creator ;_cecdg *_fb .Rectangle ;_cefa *_e .Presentation ;_bab *_e .Slide ;_fgac *_dg .SldMaster ;_ccc *_dg .SldLayout ;_aead float64 ;_dcdde float64 ;_fafb []_gfc .Drawable ;_eceb *background ;
_dgdg *_ae .CT_TextParagraphProperties ;_faee *_ae .CT_TextCharacterProperties ;_dfa *_ae .CT_TextParagraphProperties ;_egcc *_ae .CT_TextCharacterProperties ;_acaa *_ae .CT_TextParagraphProperties ;_afad *_ae .CT_TextCharacterProperties ;_bfcd []*_ae .CT_TextParagraphProperties ;
_edbd []*_ae .CT_TextParagraphProperties ;_afab []*_ae .CT_TextParagraphProperties ;_ecd *_ae .Theme ;_dce *_ae .CT_ColorMappingOverride ;};type symbol struct{_dgbg string ;_ggge float64 ;_dfbf float64 ;_ccec float64 ;_dgda float64 ;_gfcad float64 ;_ebcf *_gfc .TextStyle ;
_dbgc string ;_edfb bool ;_bbbea bool ;_gfeb bool ;};func _cead (_gcfa *_dg .CT_CommonSlideData ,_eafg _dg .ST_PlaceholderType ,_agabc *uint32 )(*_ae .CT_Transform2D ,*_ae .CT_TextBody ,*bool ,*bool ,*bool ){_dbcc :=_agabc ==nil ;if _gcfa !=nil &&(_eafg !=_dg .ST_PlaceholderTypeUnset ||!_dbcc ){if _dfdg :=_gcfa .SpTree ;
_dfdg !=nil {for _ ,_gddg :=range _dfdg .Choice {if _gddg !=nil {for _ ,_dabb :=range _gddg .Sp {if _dabb !=nil {_acae ,_ecdd :=_dbce (_dabb );if _eafg ==_acae {if (_dbcc &&_ecdd ==nil )||(!_dbcc &&_ecdd !=nil &&*_ecdd ==*_agabc ){var _gabc *_ae .CT_Transform2D ;
if _dabb .SpPr !=nil {_gabc =_dabb .SpPr .Xfrm ;};_bcga :=_eafg ==_dg .ST_PlaceholderTypeTitle ||_eafg ==_dg .ST_PlaceholderTypeCtrTitle ;_ffdg :=_eafg ==_dg .ST_PlaceholderTypeSubTitle ;_cadgg :=!_bcga &&_eafg !=_dg .ST_PlaceholderTypeUnset ;return _gabc ,_dabb .TxBody ,&_bcga ,&_ffdg ,&_cadgg ;
};};};};};};};};return nil ,nil ,nil ,nil ,nil ;};func _gfce (_gfed ,_afea *_ae .CT_TextListStyle )*_ae .CT_TextListStyle {_cdgf :=_ae .NewCT_TextListStyle ();if _gfed !=nil {*_cdgf =*_gfed ;};if _afea ==nil {return _cdgf ;};_cdgf .DefPPr =_geec (_cdgf .DefPPr ,_afea .DefPPr );
_cdgf .Lvl1pPr =_geec (_cdgf .Lvl1pPr ,_afea .Lvl1pPr );_cdgf .Lvl2pPr =_geec (_cdgf .Lvl2pPr ,_afea .Lvl2pPr );_cdgf .Lvl3pPr =_geec (_cdgf .Lvl3pPr ,_afea .Lvl3pPr );_cdgf .Lvl4pPr =_geec (_cdgf .Lvl4pPr ,_afea .Lvl4pPr );_cdgf .Lvl5pPr =_geec (_cdgf .Lvl5pPr ,_afea .Lvl5pPr );
_cdgf .Lvl6pPr =_geec (_cdgf .Lvl6pPr ,_afea .Lvl6pPr );_cdgf .Lvl7pPr =_geec (_cdgf .Lvl7pPr ,_afea .Lvl7pPr );_cdgf .Lvl8pPr =_geec (_cdgf .Lvl8pPr ,_afea .Lvl8pPr );_cdgf .Lvl9pPr =_geec (_cdgf .Lvl9pPr ,_afea .Lvl9pPr );return _cdgf ;};func _ecg (_ccgb float64 )float64 {return _ccgb *_b .Millimeter };
func (_cbff *convertContext )getStyleColors (_aeaf *_ae .CT_ShapeStyle )(_gfc .Color ,_gfc .Color ,_gfc .Color ){var _gbbe ,_cfcc ,_dede _gfc .Color ;if _eegd :=_aeaf .LnRef ;_eegd !=nil {_cfcc =_cbff .getColorFromMatrixReference (_eegd );};if _aedb :=_aeaf .FillRef ;
_aedb !=nil {_dede =_cbff .getColorFromMatrixReference (_aedb );};if _bbc :=_aeaf .FontRef ;_bbc !=nil {_gbbe =_cbff .getColorFromFontReference (_bbc );};return _gbbe ,_dede ,_cfcc ;};func (_geeda *textboxContext )addTextRun (_gbeb *_ae .EG_TextRun ,_aae *_ae .CT_TextCharacterProperties ,_gbbf _gfc .Color ,_decc *prefixData ){if _cfeae :=_gbeb .Br ;
_cfeae !=nil {_geeda .addCurrentWordToParagraph ();_geeda .newLine ();_geeda .newWord ();}else if _eacc :=_gbeb .R ;_eacc !=nil {var _ead _gfc .Color ;if _eacc .RPr !=nil &&_eacc .RPr .SolidFill !=nil {_ead ,_ =_geeda ._bead .getColorFromSolidFill (_eacc .RPr .SolidFill );
}else if _gbbf !=nil {_ead =_gbbf ;}else if _aae .SolidFill !=nil {_ead ,_ =_geeda ._bead .getColorFromSolidFill (_aae .SolidFill );}else {_ead =_gfc .ColorBlack ;};_fea :=_dfdf (_eacc .RPr ,_aae );_acaf ,_ebga ,_bgac ,_ddcd :=_geeda ._bead .makeStyleFromRPr (_fea );
_acaf .Color =_ead ;if _decc !=nil {_geeda .addPrefix (_decc ,_acaf );};_dffag :=_afe (_eacc .T );for _ ,_cgc :=range _dffag {_cgc ._ebcf =_acaf ;_cgc ._edfb =_ebga ;_cgc ._bbbea =_bgac ;_cgc ._gfeb =_ddcd ;if _fea .CapAttr ==_ae .ST_TextCapsTypeAll {_cgc ._dgbg =_fc .ToUpper (_cgc ._dgbg );
};_geeda .addTextSymbol (_cgc );};};};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_e .Presentation )*_gfc .Creator {_ad :=pr .X ().SldSz ;_eg :=_b .FromEMU (int64 (_ad .CxAttr ));_ab :=_b .FromEMU (int64 (_ad .CyAttr ));_cde :=_gfc .PageSize {_eg ,_ab };_gfb :=_gfc .New ();_gfb .SetPageSize (_cde );var _cb *_ae .Theme ;
if len (pr .Themes ())> 0{_cb =pr .Themes ()[0];};for _ ,_ddg :=range pr .Slides (){if _ddg .X ()==nil {continue ;};_ddd :=&convertContext {_fffdc :_gfb ,_bab :&_ddg ,_ccc :_ddg .GetSlideLayout (),_fgac :pr .SlideMasters ()[0].X (),_cefa :pr ,_ecd :_cb ,_dce :_ddg .X ().ClrMapOvr ,_aead :_cde [1],_dcdde :_cde [0]};
_ddd .extractDefaultProperties ();_ddd .makeSlide ();_ddd .drawSlide ();};return _gfb ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _fb .RegisterFontsFromDirectory (dirName )};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_da .PdfFont ){_fb .RegisterFont (name ,style ,font );};type romanMatch struct{_beg int ;_deeg string ;};type textboxContext struct{_bead *convertContext ;_edg float64 ;_fbgb float64 ;_efc *_gfc .Creator ;
_dff float64 ;_gbg []*paragraph ;_cgbe *paragraph ;_dacg *line ;_gedd *word ;_bcag bool ;};func (_cgbb *line )moveRight (_abaf float64 ){for _ ,_deab :=range _cgbb ._dae {_deab ._ded +=_abaf ;};};func (_dgaf *convertContext )getInfoFromLn (_ecdf *_ae .CT_LineProperties )(_gfc .Color ,float64 ,float64 ){if _ecdf ==nil ||_ecdf .NoFill !=nil {return nil ,0,0;
};var _dfad float64 ;_cbcb ,_eebc :=_dgaf .getColorFromSolidFill (_ecdf .SolidFill );if _ddff :=_ecdf .WAttr ;_ddff !=nil {_dfad =_b .FromEMU (int64 (*_ddff ));}else {_dfad =1;};return _cbcb ,_dfad ,_eebc ;};func (_ffba *textboxContext )alignSymbolsVertically (){for _ ,_fafdfb :=range _ffba ._gbg {for _ ,_gedb :=range _fafdfb ._ffc {_debe :=0.0;
for _ ,_gabb :=range _gedb ._dae {for _ ,_cced :=range _gabb ._fge {if _cced ._dfbf > _debe {_debe =_cced ._dfbf ;};};};for _ ,_dcfc :=range _gedb ._dae {for _ ,_fgd :=range _dcfc ._fge {if _fgd ._ccec < _debe {_fgd ._dgda =_debe -_fgd ._ccec ;};};};};
};};func (_bde *convertContext )stretchImage (_ffeg *_gfc .Image ,_cfc *_ae .CT_StretchInfoProperties ,_edf ,_cfg ,_gff ,_gffd float64 )(*_gfc .Image ,float64 ,float64 ){_bag :=_cfc .FillRect ;if _bag ==nil {_cdd :=_ffeg .Width ()/_ffeg .Height ();_gbc :=_gff /_gffd ;
var _bfc ,_ggb float64 ;if _cdd > _gbc {_ggb =_gffd ;_bfc =_gffd *_cdd ;}else {_bfc =_gff ;_ggb =_gff /_cdd ;};_ffeg .Scale (_bfc /_ffeg .Width (),_ggb /_ffeg .Height ());return _ffeg ,_edf ,_cfg ;};var _eba ,_dbf ,_ggg ,_adc float64 ;if _aa :=_bag .LAttr ;
_aa !=nil {_ggg =_fb .FromSTPercentage (_aa );};if _gbcc :=_bag .TAttr ;_gbcc !=nil {_eba =_fb .FromSTPercentage (_gbcc );};if _fae :=_bag .RAttr ;_fae !=nil {_adc =_fb .FromSTPercentage (_fae );};if _abc :=_bag .BAttr ;_abc !=nil {_dbf =_fb .FromSTPercentage (_abc );
};_abb :=_gff *(1-_ggg -_adc );_fgc :=_gffd *(1-_eba -_dbf );_ffeg .Scale (_abb /_ffeg .Width (),_fgc /_ffeg .Height ());return _ffeg ,_edf +_ggg *_gff ,_cfg +_eba *_gffd ;};func _cbdc (_gcag float64 )float64 {return _gcag *_b .Inch };func (_ceee *convertContext )tileImage (_fg *_gfc .Image ,_bbb *_ae .CT_TileInfoProperties ,_aff ,_gbea float64 )*_gfc .Image {_fgf ,_geb :=1.0,1.0;
if _fcfc :=_bbb .SxAttr ;_fcfc !=nil {_fgf =_fb .FromSTPercentage (_fcfc );};if _dda :=_bbb .SyAttr ;_dda !=nil {_geb =_fb .FromSTPercentage (_dda );};_cgb :=_fb .MakeTempCreator (_aff ,_gbea );_fg .Scale (_fgf ,_geb );_ec ,_gcg :=_fg .Width (),_fg .Height ();
var _gaf ,_cae float64 ;if _dca :=_bbb .TxAttr ;_dca !=nil {_gaf =_b .FromEMU (_fb .FromSTCoordinate (*_dca ));};if _fdc :=_bbb .TyAttr ;_fdc !=nil {_cae =_b .FromEMU (_fb .FromSTCoordinate (*_fdc ));};if _gaf > 0{_gaf -=_ec ;};if _cae > 0{_cae -=_gcg ;
};_aeb :=_ceee ._dcdde /_ec +1;_ceg :=_ceee ._aead /_gcg +1;for _bbbe :=0.0;_bbbe <=_aeb ;_bbbe ++{_bcb :=_bbbe *_ec ;for _fgb :=0.0;_fgb <=_ceg ;_fgb ++{_dddd :=_fgb *_gcg ;_fg .SetPos (_bcb +_gaf ,_dddd +_cae );_cgb .Draw (_fg );};};_cdf ,_cbb :=_fb .GetPageFromCreator (_cgb );
if _cbb !=nil {_ff .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_cbb );return nil ;};_ceb ,_cbb :=_ac .NewImageDevice ().Render (_cdf );
if _cbb !=nil {_ff .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_cbb );return nil ;};_afb ,_cbb :=_ceee ._fffdc .NewImageFromGoImage (_ceb );if _cbb !=nil {_ff .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_cbb );
return nil ;};return _afb ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_fb .FontStyle ;func (_ebfa *convertContext )renderCurrentStateToGoImage ()(_a .Image ,error ){_fgca :=_fb .MakeTempCreator (_ebfa ._dcdde ,_ebfa ._aead );_fgca .NewPage ();for _ ,_eface :=range _ebfa ._fafb {if _eface !=nil {_fgca .MoveTo (0,0);
_fgca .Draw (_eface );};};_ggee ,_addb :=_fb .GetPageFromCreator (_fgca );if _addb !=nil {return nil ,_addb ;};return _ac .NewImageDevice ().Render (_ggee );};type prefixData struct{_dffa string ;_deb bool ;_bbe float64 ;_ffad float64 ;};func _bbgec (_ada ,_ddab *_ae .CT_TableStyleTextStyle )*_ae .CT_TableStyleTextStyle {_aacf :=_ae .NewCT_TableStyleTextStyle ();
if _ada !=nil {*_aacf =*_ada ;};if _ddab ==nil {return _aacf ;};if _aacf .BAttr ==_ae .ST_OnOffStyleTypeUnset {_aacf .BAttr =_ddab .BAttr ;};if _aacf .IAttr ==_ae .ST_OnOffStyleTypeUnset {_aacf .IAttr =_ddab .IAttr ;};if _aacf .Font ==nil {_aacf .Font =_ddab .Font ;
};if _aacf .FontRef ==nil {_aacf .FontRef =_ddab .FontRef ;};if _aacf .ScrgbClr ==nil {_aacf .ScrgbClr =_ddab .ScrgbClr ;};if _aacf .SrgbClr ==nil {_aacf .SrgbClr =_ddab .SrgbClr ;};if _aacf .HslClr ==nil {_aacf .HslClr =_ddab .HslClr ;};if _aacf .SysClr ==nil {_aacf .SysClr =_ddab .SysClr ;
};if _aacf .SchemeClr ==nil {_aacf .SchemeClr =_ddab .SchemeClr ;};if _aacf .PrstClr ==nil {_aacf .PrstClr =_ddab .PrstClr ;};return _aacf ;};func _cbdf (_gggg *_ae .CT_TableCellProperties ,_addg *_ae .CT_TableStyleCellStyle ,_gegg ,_egca ,_gffc ,_eafe bool )*_ae .CT_TableCellProperties {_faca :=_ae .NewCT_TableCellProperties ();
if _gggg !=nil {*_faca =*_gggg ;};if _addg ==nil {return _faca ;};if _abedb :=_addg .FillRef ;_abedb !=nil {_dadfd :=_ae .NewCT_SolidColorFillProperties ();_dadfd .ScrgbClr =_abedb .ScrgbClr ;_dadfd .SrgbClr =_abedb .SrgbClr ;_dadfd .HslClr =_abedb .HslClr ;
_dadfd .SysClr =_abedb .SysClr ;_dadfd .SchemeClr =_abedb .SchemeClr ;_dadfd .PrstClr =_abedb .PrstClr ;_faca .SolidFill =_dadfd ;};if _faca .NoFill ==nil &&_faca .SolidFill ==nil {if _ccafd :=_addg .Fill ;_ccafd !=nil {if _faca .NoFill ==nil {_faca .NoFill =_ccafd .NoFill ;
};if _faca .SolidFill ==nil {_faca .SolidFill =_ccafd .SolidFill ;};};};if _fggg :=_addg .TcBdr ;_fggg !=nil {if _faca .LnL ==nil {var _fabc *_ae .CT_ThemeableLineStyle ;if _gffc {_fabc =_fggg .Left ;}else {_fabc =_fggg .InsideV ;};if _fabc !=nil {_faca .LnL =_fabc .Ln ;
};};if _faca .LnR ==nil {var _cadf *_ae .CT_ThemeableLineStyle ;if _eafe {_cadf =_fggg .Right ;}else {_cadf =_fggg .InsideV ;};if _cadf !=nil {_faca .LnR =_cadf .Ln ;};};if _faca .LnT ==nil {var _bgdb *_ae .CT_ThemeableLineStyle ;if _gegg {_bgdb =_fggg .Top ;
}else {_bgdb =_fggg .InsideH ;};if _bgdb !=nil {_faca .LnT =_bgdb .Ln ;};};if _faca .LnB ==nil {var _debec *_ae .CT_ThemeableLineStyle ;if _egca {_debec =_fggg .Bottom ;}else {_debec =_fggg .InsideH ;};if _debec !=nil {_faca .LnB =_debec .Ln ;};};};return _faca ;
};func (_dfd *textboxContext )addPrefix (_eaeg *prefixData ,_ccfb *_gfc .TextStyle ){_ecbb :=_afe (_eaeg ._dffa );_fbb :=*_ccfb ;if _eaeg ._deb {_fbb .Font =_fb .AssignStdFontByName (_fbb ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_beb :=range _ecbb {_beb ._ebcf =&_fbb ;
_dfd .addTextSymbol (_beb );};_abcf :=-(_eaeg ._ffad +_dfd ._gedd ._gaec );if _abcf < 0{_abcf =0;};_badb :=&symbol {_dgbg :"\u0020",_gfcad :_abcf };_dfd .addTextSymbol (_badb );_dfd ._gedd ._ded +=(_eaeg ._ffad +_eaeg ._bbe );};func (_dddg *convertContext )makeSlide (){_gbe :=_dddg ._bab .GetSlideLayout ().CSld ;
_dddg .addShapes (_gbe ,true );_gbe =_dddg ._bab .X ().CSld ;_dddg .addShapes (_gbe ,false );};func (_acea *convertContext )makeStyleFromRPr (_cga *_ae .CT_TextCharacterProperties )(*_gfc .TextStyle ,bool ,bool ,bool ){var _gagg ,_cfd ,_aaaa bool ;_ecbg :=_acea ._fffdc .NewTextStyle ();
if _cga !=nil {_acbeb :=_fb .FontStyle_Regular ;_fafdf :=_aeag (_cga .BAttr );_dgab :=_aeag (_cga .IAttr );if _fafdf &&_dgab {_acbeb =_fb .FontStyle_BoldItalic ;}else if _fafdf {_acbeb =_fb .FontStyle_Bold ;}else if _dgab {_acbeb =_fb .FontStyle_Italic ;
};_aaaa =_cga .UAttr !=_ae .ST_TextUnderlineTypeUnset &&_cga .UAttr !=_ae .ST_TextUnderlineTypeNone ;_dfc :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _abcd :=_cga .Latin ;_abcd !=nil {_dfc =_abcd .TypefaceAttr ;}else if _ebd :=_cga .Ea ;_ebd !=nil {_dfc =_ebd .TypefaceAttr ;
}else if _addf :=_cga .Cs ;_addf !=nil {_dfc =_addf .TypefaceAttr ;}else if _bcbae :=_cga .Sym ;_bcbae !=nil {_dfc =_bcbae .TypefaceAttr ;};if _gdad ,_cega :=_fb .StdFontsMap [_dfc ];_cega {_ecbg .Font =_fb .AssignStdFontByName (_ecbg ,_gdad [_acbeb ]);
}else if _aca :=_fb .GetRegisteredFont (_dfc ,_acbeb );_aca !=nil {_ecbg .Font =_aca ;}else {_ff .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_dfc ,_acbeb );
_ecbg .Font =_fb .AssignStdFontByName (_ecbg ,_fb .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_acbeb ]);};var _gdce float64 ;if _aed :=_cga .SzAttr ;_aed !=nil {_gdce =_cg .Round (float64 (*_aed )/100)-0.5;}else {_gdce =_fb .DefaultFontSize ;
};if _ffbb :=_cga .BaselineAttr ;_ffbb !=nil {if _bcbb :=_ffbb .ST_PercentageDecimal ;_bcbb !=nil {if *_bcbb > 0{_gagg =true ;}else if *_bcbb < 0{_cfd =true ;};};};if _gagg ||_cfd {_gdce =_cg .Round (_gdce *0.64);};_ecbg .FontSize =_gdce ;_fdbf :=0.0;if _gfeg :=_cga .SpcAttr ;
_gfeg !=nil {if _bgfa :=_gfeg .ST_TextPointUnqualified ;_bgfa !=nil &&*_bgfa > 0{_fdbf =float64 (*_bgfa )/100;};};_ecbg .CharSpacing =_fdbf ;};return &_ecbg ,_gagg ,_cfd ,_aaaa ;};func (_bagb *convertContext )getColorFromFontReference (_adfd *_ae .CT_FontReference )_gfc .Color {var _eafcf _gfc .Color ;
var _cebc string ;if _adb :=_adfd .SrgbClr ;_adb !=nil {_cebc =_adb .ValAttr ;}else if _fcgb :=_adfd .SchemeClr ;_fcgb !=nil {_cebc =_fb .GetColorStringFromDmlColor (_bagb ._cefa .GetColorBySchemeColor (_fcgb .ValAttr ));_cebc =_fb .AdjustColor (_cebc ,_fcgb .EG_ColorTransform );
};if _cebc !=""{_eafcf =_gfc .ColorRGBFromHex ("\u0023"+_cebc );};return _eafcf ;};func _geec (_eccc ,_dgdad *_ae .CT_TextParagraphProperties )*_ae .CT_TextParagraphProperties {_agab :=_ae .NewCT_TextParagraphProperties ();if _eccc !=nil {*_agab =*_eccc ;
};if _dgdad ==nil {return _agab ;};if _agab .MarLAttr ==nil {_agab .MarLAttr =_dgdad .MarLAttr ;};if _agab .MarRAttr ==nil {_agab .MarRAttr =_dgdad .MarRAttr ;};if _agab .LvlAttr ==nil {_agab .LvlAttr =_dgdad .LvlAttr ;};if _agab .IndentAttr ==nil {_agab .IndentAttr =_dgdad .IndentAttr ;
};if _agab .AlgnAttr ==_ae .ST_TextAlignTypeUnset {_agab .AlgnAttr =_dgdad .AlgnAttr ;};if _agab .DefTabSzAttr ==nil {_agab .DefTabSzAttr =_dgdad .DefTabSzAttr ;};if _agab .RtlAttr ==nil {_agab .RtlAttr =_dgdad .RtlAttr ;};if _agab .EaLnBrkAttr ==nil {_agab .EaLnBrkAttr =_dgdad .EaLnBrkAttr ;
};if _agab .FontAlgnAttr ==_ae .ST_TextFontAlignTypeUnset {_agab .FontAlgnAttr =_dgdad .FontAlgnAttr ;};if _agab .LatinLnBrkAttr ==nil {_agab .LatinLnBrkAttr =_dgdad .LatinLnBrkAttr ;};if _agab .HangingPunctAttr ==nil {_agab .HangingPunctAttr =_dgdad .HangingPunctAttr ;
};if _agab .LnSpc ==nil {_agab .LnSpc =_dgdad .LnSpc ;};if _agab .SpcBef ==nil {_agab .SpcBef =_dgdad .SpcBef ;};if _agab .SpcAft ==nil {_agab .SpcAft =_dgdad .SpcAft ;};if _agab .BuClrTx ==nil {_agab .BuClrTx =_dgdad .BuClrTx ;};if _agab .BuClr ==nil {_agab .BuClr =_dgdad .BuClr ;
};if _agab .BuSzTx ==nil {_agab .BuSzTx =_dgdad .BuSzTx ;};if _agab .BuSzPct ==nil {_agab .BuSzPct =_dgdad .BuSzPct ;};if _agab .BuSzPts ==nil {_agab .BuSzPts =_dgdad .BuSzPts ;};if _agab .BuFontTx ==nil {_agab .BuFontTx =_dgdad .BuFontTx ;};if _agab .BuFont ==nil {_agab .BuFont =_dgdad .BuFont ;
};if _agab .BuNone ==nil {_agab .BuNone =_dgdad .BuNone ;};if _agab .BuAutoNum ==nil {_agab .BuAutoNum =_dgdad .BuAutoNum ;};if _agab .BuChar ==nil {_agab .BuChar =_dgdad .BuChar ;};if _agab .BuBlip ==nil {_agab .BuBlip =_dgdad .BuBlip ;};if _agab .TabLst ==nil {_agab .TabLst =_dgdad .TabLst ;
};if _agab .ExtLst ==nil {_agab .ExtLst =_dgdad .ExtLst ;};_agab .DefRPr =_dfdf (_agab .DefRPr ,_dgdad .DefRPr );return _agab ;};func _gce (_ccgd int ,_agdb bool )string {_cbea :=_de .NewBuffer ([]byte {});for _ ,_cbbc :=range _gegf {for {if _ccgd < _cbbc ._beg {break ;
};_cbea .WriteString (_cbbc ._deeg );_ccgd -=_cbbc ._beg ;};};_dbb :=_cbea .String ();if _agdb {_dbb =_fc .ToUpper (_dbb );};return _dbb ;};func (_agc *convertContext )renderPageWithDrawableToGoImage (_dbbg _gfc .Drawable )(_a .Image ,error ){_ggaf :=_fb .MakeTempCreator (_agc ._dcdde ,_agc ._aead );
_ggaf .NewPage ();_ggaf .Draw (_dbbg );_bfbc ,_cfdg :=_fb .GetPageFromCreator (_ggaf );if _cfdg !=nil {return nil ,_cfdg ;};return _ac .NewImageDevice ().Render (_bfbc );};func (_gfcg *textboxContext )adjustHeights (_dabf float64 ){if _gfcg ._dacg ._gbdf < _dabf {_gfcg ._cgbe ._ecc +=(_dabf -_gfcg ._dacg ._gbdf );
_gfcg ._dacg ._gbdf =_dabf ;};};func _dfdf (_bfga ,_daec *_ae .CT_TextCharacterProperties )*_ae .CT_TextCharacterProperties {_cefe :=_ae .NewCT_TextCharacterProperties ();if _bfga !=nil {*_cefe =*_bfga ;};if _daec ==nil {return _cefe ;};if _cefe .KumimojiAttr ==nil {_cefe .KumimojiAttr =_daec .KumimojiAttr ;
};if _cefe .LangAttr ==nil {_cefe .LangAttr =_daec .LangAttr ;};if _cefe .AltLangAttr ==nil {_cefe .AltLangAttr =_daec .AltLangAttr ;};if _cefe .SzAttr ==nil {_cefe .SzAttr =_daec .SzAttr ;};if _cefe .BAttr ==nil {_cefe .BAttr =_daec .BAttr ;};if _cefe .IAttr ==nil {_cefe .IAttr =_daec .IAttr ;
};if _cefe .UAttr ==_ae .ST_TextUnderlineTypeUnset {_cefe .UAttr =_daec .UAttr ;};if _cefe .StrikeAttr ==_ae .ST_TextStrikeTypeUnset {_cefe .StrikeAttr =_daec .StrikeAttr ;};if _cefe .KernAttr ==nil {_cefe .KernAttr =_daec .KernAttr ;};if _cefe .CapAttr ==_ae .ST_TextCapsTypeUnset {_cefe .CapAttr =_daec .CapAttr ;
};if _cefe .SpcAttr ==nil {_cefe .SpcAttr =_daec .SpcAttr ;};if _cefe .NormalizeHAttr ==nil {_cefe .NormalizeHAttr =_daec .NormalizeHAttr ;};if _cefe .BaselineAttr ==nil {_cefe .BaselineAttr =_daec .BaselineAttr ;};if _cefe .NoProofAttr ==nil {_cefe .NoProofAttr =_daec .NoProofAttr ;
};if _cefe .DirtyAttr ==nil {_cefe .DirtyAttr =_daec .DirtyAttr ;};if _cefe .ErrAttr ==nil {_cefe .ErrAttr =_daec .ErrAttr ;};if _cefe .SmtCleanAttr ==nil {_cefe .SmtCleanAttr =_daec .SmtCleanAttr ;};if _cefe .SmtIdAttr ==nil {_cefe .SmtIdAttr =_daec .SmtIdAttr ;
};if _cefe .BmkAttr ==nil {_cefe .BmkAttr =_daec .BmkAttr ;};if _cefe .Ln ==nil {_cefe .Ln =_daec .Ln ;};if _cefe .NoFill ==nil {_cefe .NoFill =_daec .NoFill ;};if _cefe .SolidFill ==nil {_cefe .SolidFill =_daec .SolidFill ;};if _cefe .BlipFill ==nil {_cefe .BlipFill =_daec .BlipFill ;
};if _cefe .EffectLst ==nil {_cefe .EffectLst =_daec .EffectLst ;};if _cefe .EffectDag ==nil {_cefe .EffectDag =_daec .EffectDag ;};if _cefe .Highlight ==nil {_cefe .Highlight =_daec .Highlight ;};if _cefe .ULnTx ==nil {_cefe .ULnTx =_daec .ULnTx ;};if _cefe .ULn ==nil {_cefe .ULn =_daec .ULn ;
};if _cefe .UFillTx ==nil {_cefe .UFillTx =_daec .UFillTx ;};if _cefe .UFill ==nil {_cefe .UFill =_daec .UFill ;};if _cefe .Latin ==nil {_cefe .Latin =_daec .Latin ;};if _cefe .Ea ==nil {_cefe .Ea =_daec .Ea ;};if _cefe .Cs ==nil {_cefe .Cs =_daec .Cs ;
};if _cefe .Sym ==nil {_cefe .Sym =_daec .Sym ;};if _cefe .Rtl ==nil {_cefe .Rtl =_daec .Rtl ;};return _cefe ;};func (_baga *convertContext )getColorFromMatrixReference (_fgdf *_ae .CT_StyleMatrixReference )_gfc .Color {if _fgdf ==nil {return nil ;};var _efbfb _gfc .Color ;
var _cegaa string ;if _dfcae :=_fgdf .SrgbClr ;_dfcae !=nil {_cegaa =_dfcae .ValAttr ;}else if _gedcb :=_fgdf .SchemeClr ;_gedcb !=nil {_cegaa =_fb .GetColorStringFromDmlColor (_baga ._cefa .GetColorBySchemeColor (_gedcb .ValAttr ));_cegaa =_fb .AdjustColor (_cegaa ,_gedcb .EG_ColorTransform );
};if _cegaa !=""{_efbfb =_gfc .ColorRGBFromHex ("\u0023"+_cegaa );};return _efbfb ;};type background struct{_fcee _gfc .Color ;_eecd float64 ;_eac *_ae .CT_BlipFillProperties ;};func (_gefeab *textboxContext )drawParagraphs (){_gefeab ._efc .NewPage ();
for _ ,_cccg :=range _gefeab ._gbg {for _ ,_fcdd :=range _cccg ._ffc {for _ ,_fcaa :=range _fcdd ._dae {for _ ,_ffgb :=range _fcaa ._fge {_ggbf :=_gefeab ._efc .NewStyledParagraph ();if _ffgb ._edfb {_ffgb ._dgda =0;}else if _ffgb ._bbbea {_ffgb ._dgda =1.2*_fcdd ._gbdf -_ffgb ._ccec ;
};_gfdaa :=_fcaa ._ded +_ffgb ._ggge ;_fabd :=_cccg ._gefea +_fcdd ._eaa +_ffgb ._dgda ;_ggbf .SetPos (_gfdaa ,_fabd );_daef :=_ggbf .Append (_ffgb ._dgbg );if _ffgb ._ebcf !=nil {_daef .Style =*_ffgb ._ebcf ;};_gefeab ._efc .Draw (_ggbf );if _ffgb ._gfeb {_acfb :=_fabd +_ffgb ._ccec +2;
_fb .DrawLine (_gefeab ._efc ,_gfdaa ,_acfb ,_gfdaa +_ffgb ._gfcad ,_acfb ,1,_ffgb ._ebcf .Color );};};};};};};func (_fde *convertContext )addCellToTable (_efdg *_gfc .Table ,_aaag *_ae .CT_TableCell ,_efgg *_ae .CT_TablePartStyle ,_dec float64 ,_cdefb ,_cff ,_dfea ,_gdae bool )float64 {var _dfg *_gfc .TableCell ;
_agg :=1;if _aaag .GridSpanAttr !=nil {_agg =int (*_aaag .GridSpanAttr );};_dfg =_efdg .MultiColCell (_agg );_dcca :=_aaag .TcPr ;var _eeb *_ae .CT_TableStyleTextStyle ;if _efgg !=nil {_dcca =_cbdf (_dcca ,_efgg .TcStyle ,_cdefb ,_cff ,_dfea ,_gdae );_eeb =_efgg .TcTxStyle ;
};_geed :=_acb ;_becf :=_gfc .CellVerticalAlignmentMiddle ;_ebe :=_cbdc (0.05);_gffddb :=_cbdc (0.05);if _dcca !=nil {if _efe :=_dcca .LnL ;_efe !=nil {_dege ,_dcac ,_caf :=_fde .getBorderStyle (_efe );_dfg .SetBorder (_gfc .CellBorderSideLeft ,_dege ,_caf );
if _dcac !=nil &&*_dcac !=nil {_dfg .SetSideBorderColor (_gfc .CellBorderSideLeft ,*_dcac );};};if _eggd :=_dcca .LnT ;_eggd !=nil {_dba ,_eca ,_bgfb :=_fde .getBorderStyle (_eggd );_dfg .SetBorder (_gfc .CellBorderSideTop ,_dba ,_bgfb );if _eca !=nil &&*_eca !=nil {_dfg .SetSideBorderColor (_gfc .CellBorderSideTop ,*_eca );
};};if _cbe :=_dcca .LnR ;_cbe !=nil {_aac ,_ece ,_ggd :=_fde .getBorderStyle (_cbe );_dfg .SetBorder (_gfc .CellBorderSideRight ,_aac ,_ggd );if _ece !=nil &&*_ece !=nil {_dfg .SetSideBorderColor (_gfc .CellBorderSideRight ,*_ece );};};if _gdfd :=_dcca .LnB ;
_gdfd !=nil {_fbd ,_acac ,_ebb :=_fde .getBorderStyle (_gdfd );_dfg .SetBorder (_gfc .CellBorderSideBottom ,_fbd ,_ebb );if _acac !=nil &&*_acac !=nil {_dfg .SetSideBorderColor (_gfc .CellBorderSideBottom ,*_acac );};};if _fagb :=_dcca .MarLAttr ;_fagb !=nil {_geed =float64 (_fb .FromSTCoordinate32 (*_fagb ));
};switch _dcca .AnchorAttr {case _ae .ST_TextAnchoringTypeT :_becf =_gfc .CellVerticalAlignmentTop ;case _ae .ST_TextAnchoringTypeB :_becf =_gfc .CellVerticalAlignmentBottom ;};if _dcca .NoFill ==nil {if _eag :=_dcca .SolidFill ;_eag !=nil {_gfca ,_ :=_fde .getColorFromSolidFill (_eag );
_dfg .SetBackgroundColor (_gfca );};};if _aab :=_dcca .MarBAttr ;_aab !=nil {_ebe =float64 (_fb .FromSTCoordinate32 (*_aab ));};if _aacd :=_dcca .MarTAttr ;_aacd !=nil {_gffddb =float64 (_fb .FromSTCoordinate32 (*_aacd ));};};_dfg .SetVerticalAlignment (_becf );
_dfg .SetIndent (_geed );var _fed float64 ;if _faba :=_aaag .TxBody ;_faba !=nil {_fbf :=_fde .makePdfDivisionFromTxBody (_faba ,_eeb );_fed =_fbf .Height ()+_gffddb +_ebe ;_dfg .SetContent (_fbf );};return _fed ;};func (_ggda *convertContext )getPhData (_ceed *_dg .CT_Shape )(*_ae .CT_Transform2D ,*_ae .CT_TextBodyProperties ,*_ae .CT_TextListStyle ,bool ,bool ,bool ){_ccce ,_dbdc :=_dbce (_ceed );
_abg ,_ecgf ,_fabg ,_gedg ,_bgfbb :=_cead (_ggda ._fgac .CSld ,_ccce ,_dbdc );_cbae ,_aaee ,_cgfe ,_ebbc ,_gbdg :=_cead (_ggda ._ccc .CSld ,_ccce ,_dbdc );if _cbae ==nil {_cbae =_abg ;};_cfdf ,_agac :=_dcec (_aaee ,_ecgf );var _ddfcg ,_gfcd ,_cbbdf bool ;
if _cgfe ==nil {if _fabg !=nil {_ddfcg =*_fabg ;};}else {_ddfcg =*_cgfe ;};if _gbdg ==nil {if _bgfbb !=nil {_cbbdf =*_bgfbb ;};}else {_cbbdf =*_gbdg ;};if _ebbc ==nil {if _gedg !=nil {_gfcd =*_gedg ;};}else {_gfcd =*_ebbc ;};return _cbae ,_cfdf ,_agac ,_ddfcg ,_gfcd ,_cbbdf ;
};func (_dbe *convertContext )makePdfBlockFromTable (_baf *_ae .Tbl ,_abbf float64 )*_gfc .Table {_eegc :=_baf .TblGrid ;if _eegc ==nil {return nil ;};_agbd :=len (_eegc .GridCol );if _agbd ==0{return nil ;};_bcbg :=[]float64 {};_aec :=0.0;for _ ,_bgff :=range _eegc .GridCol {_abcc :=_b .FromEMU (_fb .FromSTCoordinate (_bgff .WAttr ));
_bcbg =append (_bcbg ,_abcc );_aec +=_abcc ;};_dcc :=[]float64 {};for _fgg :=0;_fgg < _agbd ;_fgg ++{_dcc =append (_dcc ,_bcbg [_fgg ]/_aec );};_ccfd :=_dbe ._fffdc .NewTable (_agbd );_ccfd .SetColumnWidths (_dcc ...);_cdg :=_baf .TblPr ;var _bgg *_ae .CT_TableStyle ;
if _gabd :=_cdg .Choice ;_gabd !=nil {if _gabd .TableStyle !=nil {_bgg =_gabd .TableStyle ;}else if _gabd .TableStyleId !=nil {_bgg =_dbe ._cefa .GetTableStyleById (*_gabd .TableStyleId );};};_cfef :=_ae .NewCT_TablePartStyle ();_cfef .TcStyle =_ae .NewCT_TableStyleCellStyle ();
_cfef .TcTxStyle =_ae .NewCT_TableStyleTextStyle ();if _bgg !=nil {if _bgg .WholeTbl !=nil {*_cfef =*_bgg .WholeTbl ;};if _bgg .TblBg !=nil {if _cfef .TcStyle .Fill ==nil {_cfef .TcStyle .Fill =_bgg .TblBg .Fill ;};};};if _cfef .TcStyle .Fill ==nil {_cfef .TcStyle .Fill =_ae .NewCT_FillProperties ();
_cfef .TcStyle .Fill .NoFill =_cdg .NoFill ;_cfef .TcStyle .Fill .SolidFill =_cdg .SolidFill ;};_baa :=len (_baf .Tr );for _dee ,_ffd :=range _baf .Tr {_faac :=_dee ==0;_gbcd :=_dee ==_baa -1;_gaed :=_dee %2==0;_agd :=len (_ffd .Tc );var _eef *_ae .CT_TablePartStyle ;
if _bgg !=nil {if _faac {_eef =_bgg .FirstRow ;}else if _gaed {_eef =_bgg .Band2H ;}else {_eef =_bgg .Band1H ;};};var _dac float64 ;for _dab ,_cdad :=range _ffd .Tc {_gfda :=_dab ==0;_cca :=_dab ==_agd -1;_aga :=_dab %2==0;var _aba *_ae .CT_TablePartStyle ;
if _bgg !=nil {if _gfda {_aba =_bgg .FirstCol ;}else if _aga {_aba =_bgg .Band2V ;}else {_aba =_bgg .Band1V ;};};_gcb :=_eged (_eged (_aba ,_eef ),_cfef );_ffa :=_dbe .addCellToTable (_ccfd ,_cdad ,_gcb ,_abbf *_dcc [_dab ],_faac ,_gbcd ,_gfda ,_cca );
if _ffa > _dac {_dac =_ffa ;};};_dbeb :=_b .FromEMU (_fb .FromSTCoordinate (_ffd .HAttr ));if _dbeb < _dac {_dbeb =_dac ;};if _dbeb < _ecg (4){_dbeb =_ecg (4);};_ccfd .SetRowHeight (_ccfd .CurRow (),_dbeb );};return _ccfd ;};func _feb (_ebeb ,_abdb *_ae .CT_TableStyleCellStyle )*_ae .CT_TableStyleCellStyle {_dffc :=_ae .NewCT_TableStyleCellStyle ();
if _ebeb !=nil {*_dffc =*_ebeb ;};if _abdb ==nil {return _dffc ;};if _dffc .TcBdr ==nil {_dffc .TcBdr =_abdb .TcBdr ;};if _dffc .Fill ==nil {_dffc .Fill =_abdb .Fill ;};if _dffc .FillRef ==nil {_dffc .FillRef =_abdb .FillRef ;};return _dffc ;};func (_abed *convertContext )getBorderStyle (_cad *_ae .CT_LineProperties )(_gfc .CellBorderStyle ,*_gfc .Color ,float64 ){if _cad ==nil ||_cad .NoFill !=nil {return _gfc .CellBorderStyleNone ,nil ,0;
};var _dbd _gfc .Color ;if _bdcd :=_cad .SolidFill ;_bdcd !=nil {_dbd ,_ =_abed .getColorFromSolidFill (_bdcd );};_fdge :=0.0;if _eff :=_cad .WAttr ;_eff !=nil {_fdge =_b .FromEMU (int64 (*_eff ));};return _gfc .CellBorderStyleSingle ,&_dbd ,_fdge ;};func (_gafb *textboxContext )newLine (){if _gafb ._cgbe ==nil {_gafb .newParagraph ();
};_fdga :=_gafb ._cgbe ._ecc +_gafb ._cgbe ._gdcdd ;_fcfa :=&line {};_fcfa ._aad =_gafb ._cgbe ._efgf ;if len (_gafb ._cgbe ._ffc )==0{_fcfa ._aad +=_gafb ._cgbe ._bfb ;};_fcfa ._fbdd =_gafb ._cgbe ._ggea ;_fcfa ._ccda =_fcfa ._aad ;_fcfa ._eaa =_fdga ;
_gafb ._cgbe ._ffc =append (_gafb ._cgbe ._ffc ,_fcfa );_gafb ._dacg =_fcfa ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);type paragraph struct{_abf float64 ;_gdcdd float64 ;
_dbg float64 ;_bfb float64 ;_efgf float64 ;_ggea float64 ;_gefea float64 ;_ecc float64 ;_cgf _ae .ST_TextAlignType ;_bdd float64 ;_ebfb bool ;_ffc []*line ;};func (_cagb *textboxContext )newWord (){_cagb ._gedd =&word {_agef :true ,_ded :_cagb ._dacg ._ccda }};
type line struct{_eaa float64 ;_aad float64 ;_fbdd float64 ;_ccda float64 ;_gbdf float64 ;_dae []*word ;};func (_fcg *convertContext )addShapes (_bf *_dg .CT_CommonSlideData ,_egc bool ){if _bf ==nil {return ;};_dde :=&background {};if _ddc :=_bf .Bg ;
_ddc !=nil {if _ace :=_ddc .BgPr ;_ace !=nil {if _ace .NoFill ==nil {if _af :=_ace .SolidFill ;_af !=nil {_eb ,_acg :=_fcg .getColorFromSolidFill (_af );if _eb !=nil {_dde ._fcee =_eb ;_dde ._eecd =_acg ;};}else if _faf :=_ace .BlipFill ;_faf !=nil {_dde ._eac =_faf ;
};};};};_fcg ._eceb =_dde ;if _ba :=_bf .SpTree ;_ba !=nil {for _ ,_ed :=range _ba .Choice {if _ed !=nil {for _ ,_gg :=range _ed .Sp {if _gg !=nil {_eee :=_fcg .getShapes (_gg ,_egc ,false );_fcg ._fafb =append (_fcg ._fafb ,_eee ...);};};for _ ,_eeg :=range _ed .GraphicFrame {if _eeg !=nil {var _ccd ,_dea ,_bccf ,_ef float64 ;
if _ca :=_eeg .Xfrm ;_ca !=nil {_ccd ,_dea ,_bccf ,_ef =_fb .GetDataFromXfrm (_ca );};if _bccf ==0&&_ef ==0{_bccf =_fcg ._dcdde ;_ef =_fcg ._aead ;};if _db :=_eeg .Graphic ;_db !=nil {if _ffe :=_db .GraphicData ;_ffe !=nil {for _ ,_gd :=range _ffe .Any {if _ga ,_afd :=_gd .(*_cc .Chart );
_afd {_acef ,_daa :=_fcg .makePdfBlockFromChart (_ga ,_bccf ,_ef );if _daa !=nil {_ff .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_daa );};if _acef !=nil {_acef .SetPos (_ccd ,_dea );
_fcg ._fafb =append (_fcg ._fafb ,_acef );};}else if _ged ,_eae :=_gd .(*_ae .Tbl );_eae {_ffg :=_fcg .makePdfBlockFromTable (_ged ,_bccf );if _ffg !=nil {_ebg :=_gfc .NewBlock (_bccf ,_ef );_ebg .SetPos (_ccd ,_dea );_ebg .Draw (_ffg );_fcg ._fafb =append (_fcg ._fafb ,_ebg );
};};};};};};};for _ ,_acf :=range _ed .CxnSp {if _acf !=nil {_gfg :=_fcg .getConnectors (_acf );_fcg ._fafb =append (_fcg ._fafb ,_gfg ...);};};for _ ,_fdd :=range _ed .GrpSp {_bcdc :=0.0;_eeeg :=0.0;if _ebf :=_fdd .GrpSpPr .Xfrm ;_ebf !=nil {_bcdc ,_eeeg =_fb .GetGroupOffsetFromXfrm (_ebf );
};for _ ,_efa :=range _fdd .Choice {for _ ,_edc :=range _efa .CxnSp {if _edc !=nil {_egf :=_fcg .getGroupConnectors (_edc ,_bcdc ,_eeeg );_fcg ._fafb =append (_fcg ._fafb ,_egf ...);};};};};for _ ,_dgg :=range _ed .Pic {if _dgg !=nil {_gc :=false ;var _cf ,_bcdg ,_gge ,_ddf float64 ;
if _dc :=_dgg .SpPr ;_dc !=nil {if _bdc :=_dc .Xfrm ;_bdc !=nil {_cf ,_bcdg ,_gge ,_ddf =_fb .GetDataFromXfrm (_bdc );_gc =true ;};};var _dgb _dg .ST_PlaceholderType ;var _eaf *uint32 ;if _dddb :=_dgg .NvPicPr ;_dddb !=nil {if _ag :=_dddb .NvPr ;_ag !=nil {if _cee :=_ag .Ph ;
_cee !=nil {_dgb =_cee .TypeAttr ;_eaf =_cee .IdxAttr ;};};};_fce ,_ ,_ ,_ ,_ :=_cead (_fcg ._fgac .CSld ,_dgb ,_eaf );_gee ,_ ,_ ,_ ,_ :=_cead (_fcg ._ccc .CSld ,_dgb ,_eaf );if _gee ==nil {_gee =_fce ;};if _gee !=nil &&!_gc {_cf ,_bcdg ,_gge ,_ddf =_fb .GetDataFromXfrm (_gee );
};if _ddfc :=_dgg .BlipFill ;_ddfc !=nil {_geg :=_fcg .getShapeFromBlipFill (_ddfc ,_cf ,_bcdg ,_gge ,_ddf ,_egc );_fcg ._fafb =append (_fcg ._fafb ,_geg );};};};};};for _ ,_cecd :=range _ba .Choice {if _cecd !=nil {for _ ,_bec :=range _cecd .Sp {if _bec !=nil {_fac :=_fcg .getShapes (_bec ,_egc ,true );
_fcg ._fafb =append (_fcg ._fafb ,_fac ...);};};};};};};