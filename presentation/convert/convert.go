//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_d "bytes";_g "errors";_dd "github.com/unidoc/unioffice/v2/common";_ed "github.com/unidoc/unioffice/v2/common/logger";_da "github.com/unidoc/unioffice/v2/common/tempstorage";_f "github.com/unidoc/unioffice/v2/internal/convertutils";
_fd "github.com/unidoc/unioffice/v2/measurement";_gg "github.com/unidoc/unioffice/v2/presentation";_ca "github.com/unidoc/unioffice/v2/schema/soo/dml";_ef "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_bf "github.com/unidoc/unioffice/v2/schema/soo/pml";
_ac "github.com/unidoc/unipdf/v3/contentstream/draw";_cd "github.com/unidoc/unipdf/v3/core";_bg "github.com/unidoc/unipdf/v3/creator";_ddb "github.com/unidoc/unipdf/v3/model";_bd "github.com/unidoc/unipdf/v3/render";_cg "image";_a "image/color";_c "image/draw";
_cc "math";_dg "strconv";_b "strings";);

// ConvertToPdfWithOptions convert a presentation to PDF with given options.
func ConvertToPdfWithOptions (pr *_gg .Presentation ,opts *Options )*_bg .Creator {_dgb :=pr .X ().SldSz ;_be :=_fd .FromEMU (int64 (_dgb .CxAttr ));_ggd :=_fd .FromEMU (int64 (_dgb .CyAttr ));_ced :=_bg .PageSize {_be ,_ggd };if (_ced ==_bg .PageSize {}){_ced =_f .GetDefaultPageSize ();
if opts !=nil &&opts .DefaultPageSize !=_f .DefaultPageSize {_ced =_f .GetPageDimensions (opts .DefaultPageSize );};};_ee :=_bg .New ();_ee .SetPageSize (_ced );var _db *_ca .Theme ;if len (pr .Themes ())> 0{_db =pr .Themes ()[0];};for _ ,_af :=range pr .Slides (){if _af .X ()==nil {continue ;
};_aff :=&convertContext {_gcaa :_ee ,_dgag :&_af ,_fgdf :_af .GetSlideLayout (),_eba :pr .SlideMasters ()[0].X (),_dfg :pr ,_facc :_db ,_fbb :_af .X ().ClrMapOvr ,_cgf :_ced [1],_ccc :_ced [0]};_aff .extractDefaultProperties ();_aff .makeSlide ();_aff .drawSlide ();
};return _ee ;};func _gdfe (_bbfac ,_dceg *_ca .CT_TableStyleCellStyle )*_ca .CT_TableStyleCellStyle {_dbfd :=_ca .NewCT_TableStyleCellStyle ();if _bbfac !=nil {*_dbfd =*_bbfac ;};if _dceg ==nil {return _dbfd ;};if _dbfd .TcBdr ==nil {_dbfd .TcBdr =_dceg .TcBdr ;
}else {if _dbfd .TcBdr .Left ==nil {_dbfd .TcBdr .Left =_dceg .TcBdr .Left ;};if _dbfd .TcBdr .Right ==nil {_dbfd .TcBdr .Right =_dceg .TcBdr .Right ;};if _dbfd .TcBdr .Top ==nil {_dbfd .TcBdr .Top =_dceg .TcBdr .Top ;};if _dbfd .TcBdr .Bottom ==nil {_dbfd .TcBdr .Bottom =_dceg .TcBdr .Bottom ;
};if _dbfd .TcBdr .InsideH ==nil {_dbfd .TcBdr .InsideH =_dceg .TcBdr .InsideH ;};if _dbfd .TcBdr .InsideV ==nil {_dbfd .TcBdr .InsideV =_dceg .TcBdr .InsideV ;};};if _dbfd .ThemeableFillStyleChoice .Fill ==nil {_dbfd .ThemeableFillStyleChoice .Fill =_dceg .ThemeableFillStyleChoice .Fill ;
};if _dbfd .ThemeableFillStyleChoice .FillRef ==nil {_dbfd .ThemeableFillStyleChoice .FillRef =_dceg .ThemeableFillStyleChoice .FillRef ;};return _dbfd ;};type symbol struct{_agdc string ;_afdg float64 ;_ffg float64 ;_bcf float64 ;_fbeg float64 ;_gdca float64 ;
_ccbg *_bg .TextStyle ;_fbg string ;_ffgg bool ;_eafc bool ;_eccc bool ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _f .RegisterFontsFromDirectory (dirName )};func (_fc *convertContext )makePdfBlockFromChart (_ce *_ef .Chart ,_cdd ,_ec float64 )(*_bg .Block ,error ){_ba :=_ce .CT_RelId .IdAttr ;_fcg :=_fc ._dgag .GetChartSpaceByRelId (_ba );
if _fcg ==nil {return nil ,_g .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _ceg *_ca .Theme ;_baa :=_fc ._dfg .Themes ();if len (_baa )> 0{_ceg =_baa [0];};return _f .MakeBlockFromChartSpace (_fcg ,_cdd ,_ec ,_ceg );
};type textboxContext struct{_gddaa *convertContext ;_edfa float64 ;_aceaf float64 ;_adg *_bg .Creator ;_gddf float64 ;_gaf []*paragraph ;_baab *paragraph ;_dfff *line ;_dgad *word ;_afea bool ;};func (_ge *convertContext )extractDefaultProperties (){_cea :=_ge ._dfg .X ();
_fg :=_cea .DefaultTextStyle ;var _gd ,_cce ,_fe ,_dfe ,_edf ,_ae ,_bdg ,_efc ,_dae ,_aa *_ca .CT_TextParagraphProperties ;if _fg !=nil {_gd =_fg .DefPPr ;_cce =_dede (_fg .Lvl1pPr ,_gd );_fe =_dede (_fg .Lvl2pPr ,_gd );_dfe =_dede (_fg .Lvl3pPr ,_gd );
_edf =_dede (_fg .Lvl4pPr ,_gd );_ae =_dede (_fg .Lvl5pPr ,_gd );_bdg =_dede (_fg .Lvl6pPr ,_gd );_efc =_dede (_fg .Lvl7pPr ,_gd );_dae =_dede (_fg .Lvl8pPr ,_gd );_aa =_dede (_fg .Lvl9pPr ,_gd );_ge ._bebfg =_gd ;_ge ._eggg =_gd .DefRPr ;};_ge ._bfea =make ([]*_ca .CT_TextParagraphProperties ,9);
_ge ._bfea [0]=_cce ;_ge ._bfea [1]=_fe ;_ge ._bfea [2]=_dfe ;_ge ._bfea [3]=_edf ;_ge ._bfea [4]=_ae ;_ge ._bfea [5]=_bdg ;_ge ._bfea [6]=_efc ;_ge ._bfea [7]=_dae ;_ge ._bfea [8]=_aa ;_dge :=_ge ._dfg .SlideMasters ()[0].X ();_ea :=_dge .TxStyles ;_dfec :=_ea .TitleStyle ;
_ge ._gfcd =_dede (_dfec .DefPPr ,_gd );_ge ._eecdd =_ge ._gfcd .DefRPr ;_ge ._deb =make ([]*_ca .CT_TextParagraphProperties ,9);_ge ._deb [0]=_dede (_dfec .Lvl1pPr ,_cce );_ge ._deb [1]=_dede (_dfec .Lvl2pPr ,_fe );_ge ._deb [2]=_dede (_dfec .Lvl3pPr ,_dfe );
_ge ._deb [3]=_dede (_dfec .Lvl4pPr ,_edf );_ge ._deb [4]=_dede (_dfec .Lvl5pPr ,_ae );_ge ._deb [5]=_dede (_dfec .Lvl6pPr ,_bdg );_ge ._deb [6]=_dede (_dfec .Lvl7pPr ,_efc );_ge ._deb [7]=_dede (_dfec .Lvl8pPr ,_dae );_ge ._deb [8]=_dede (_dfec .Lvl9pPr ,_aa );
_eef :=_ea .BodyStyle ;_ge ._eeee =_dede (_eef .DefPPr ,_gd );_ge ._fggf =_ge ._eeee .DefRPr ;_ge ._cfgd =make ([]*_ca .CT_TextParagraphProperties ,9);_ge ._cfgd [0]=_dede (_eef .Lvl1pPr ,_cce );_ge ._cfgd [1]=_dede (_eef .Lvl2pPr ,_fe );_ge ._cfgd [2]=_dede (_eef .Lvl3pPr ,_dfe );
_ge ._cfgd [3]=_dede (_eef .Lvl4pPr ,_edf );_ge ._cfgd [4]=_dede (_eef .Lvl5pPr ,_ae );_ge ._cfgd [5]=_dede (_eef .Lvl6pPr ,_bdg );_ge ._cfgd [6]=_dede (_eef .Lvl7pPr ,_efc );_ge ._cfgd [7]=_dede (_eef .Lvl8pPr ,_dae );_ge ._cfgd [8]=_dede (_eef .Lvl9pPr ,_aa );
};func _gce (_ecaa string )[]*symbol {_fdac :=[]*symbol {};for _ ,_egf :=range _ecaa {_fdac =append (_fdac ,&symbol {_agdc :string (_egf )});};return _fdac ;};func (_bbce *convertContext )getGroupConnectors (_aae *_bf .CT_Connector ,_caff float64 ,_dda float64 )[]_bg .Drawable {_geg ,_ ,_ ,_ ,_ ,_ ,_ :=_bbce .getShapesFromSpPr (_aae .SpPr ,_aae .Style ,false ,_caff ,_dda );
return _geg ;};func (_bbe *textboxContext )newWord (){_bbe ._dgad =&word {_aaed :true ,_aedb :_bbe ._dfff ._fdgd }};func (_eedf *convertContext )makeSlide (){_bad :=_eedf ._dgag .GetSlideLayout ().CSld ;_eedf .addShapes (_bad ,true );_bad =_eedf ._dgag .X ().CSld ;
_eedf .addShapes (_bad ,false );};func _dada (_cddd *_bf .CT_Shape )(_bf .ST_PlaceholderType ,*uint32 ){if _fcb :=_cddd .NvSpPr ;_fcb !=nil {if _bee :=_fcb .NvPr ;_bee !=nil {if _gaeb :=_bee .Ph ;_gaeb !=nil {return _gaeb .TypeAttr ,_gaeb .IdxAttr ;};};
};return _bf .ST_PlaceholderTypeUnset ,nil ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _f .PageSize ;};func _adff (_gdcb int ,_fcgb bool )string {_eecdb :=_d .NewBuffer ([]byte {});for _ ,_bfab :=range _adea {for {if _gdcb < _bfab ._dgd {break ;};_eecdb .WriteString (_bfab ._cdbd );_gdcb -=_bfab ._dgd ;};};_fccc :=_eecdb .String ();
if _fcgb {_fccc =_b .ToUpper (_fccc );};return _fccc ;};type word struct{_edef []*symbol ;_aedb float64 ;_dedf float64 ;_aaed bool ;};type romanMatch struct{_dgd int ;_cdbd string ;};func (_gba *convertContext )getConnectors (_ebf *_bf .CT_Connector )[]_bg .Drawable {_acab ,_ ,_ ,_ ,_ ,_ ,_ :=_gba .getShapesFromSpPr (_ebf .SpPr ,_ebf .Style ,false ,0.0,0.0);
return _acab ;};var _adea =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
func _ffc (_ggaea ,_ccd *_ca .CT_TextBodyProperties )*_ca .CT_TextBodyProperties {_daagc :=_ca .NewCT_TextBodyProperties ();if _ggaea !=nil {*_daagc =*_ggaea ;};if _ccd ==nil {return _daagc ;};if _daagc .RotAttr ==nil {_daagc .RotAttr =_ccd .RotAttr ;};
if _daagc .SpcFirstLastParaAttr ==nil {_daagc .SpcFirstLastParaAttr =_ccd .SpcFirstLastParaAttr ;};if _daagc .VertOverflowAttr ==_ca .ST_TextVertOverflowTypeUnset {_daagc .VertOverflowAttr =_ccd .VertOverflowAttr ;};if _daagc .HorzOverflowAttr ==_ca .ST_TextHorzOverflowTypeUnset {_daagc .HorzOverflowAttr =_ccd .HorzOverflowAttr ;
};if _daagc .VertAttr ==_ca .ST_TextVerticalTypeUnset {_daagc .VertAttr =_ccd .VertAttr ;};if _daagc .WrapAttr ==_ca .ST_TextWrappingTypeUnset {_daagc .WrapAttr =_ccd .WrapAttr ;};if _daagc .LInsAttr ==nil {_daagc .LInsAttr =_ccd .LInsAttr ;};if _daagc .TInsAttr ==nil {_daagc .TInsAttr =_ccd .TInsAttr ;
};if _daagc .RInsAttr ==nil {_daagc .RInsAttr =_ccd .RInsAttr ;};if _daagc .BInsAttr ==nil {_daagc .BInsAttr =_ccd .BInsAttr ;};if _daagc .NumColAttr ==nil {_daagc .NumColAttr =_ccd .NumColAttr ;};if _daagc .SpcColAttr ==nil {_daagc .SpcColAttr =_ccd .SpcColAttr ;
};if _daagc .RtlColAttr ==nil {_daagc .RtlColAttr =_ccd .RtlColAttr ;};if _daagc .AnchorAttr ==_ca .ST_TextAnchoringTypeUnset {_daagc .AnchorAttr =_ccd .AnchorAttr ;};if _daagc .AnchorCtrAttr ==nil {_daagc .AnchorCtrAttr =_ccd .AnchorCtrAttr ;};if _daagc .ForceAAAttr ==nil {_daagc .ForceAAAttr =_ccd .ForceAAAttr ;
};if _daagc .UprightAttr ==nil {_daagc .UprightAttr =_ccd .UprightAttr ;};if _daagc .CompatLnSpcAttr ==nil {_daagc .CompatLnSpcAttr =_ccd .CompatLnSpcAttr ;};if _daagc .PrstTxWarp ==nil {_daagc .PrstTxWarp =_ccd .PrstTxWarp ;};if _daagc .TextAutofitChoice .NoAutofit ==nil {_daagc .TextAutofitChoice .NoAutofit =_ccd .TextAutofitChoice .NoAutofit ;
};if _daagc .TextAutofitChoice .NormAutofit ==nil {_daagc .TextAutofitChoice .NormAutofit =_ccd .TextAutofitChoice .NormAutofit ;};if _daagc .TextAutofitChoice .SpAutoFit ==nil {_daagc .TextAutofitChoice .SpAutoFit =_ccd .TextAutofitChoice .SpAutoFit ;
};if _daagc .Scene3d ==nil {_daagc .Scene3d =_ccd .Scene3d ;};if _daagc .Text3DChoice .Sp3d ==nil {_daagc .Text3DChoice .Sp3d =_ccd .Text3DChoice .Sp3d ;};if _daagc .Text3DChoice .FlatTx ==nil {_daagc .Text3DChoice .FlatTx =_ccd .Text3DChoice .FlatTx ;
};if _daagc .ExtLst ==nil {_daagc .ExtLst =_ccd .ExtLst ;};return _daagc ;};func _fag (_eeef *_ca .CT_AdjPoint2D )(float64 ,float64 ){var _cbeg ,_ddacc float64 ;_aacg ,_dagc :=_eeef .XAttr ,_eeef .YAttr ;if _bdgcd :=_aacg .ST_Coordinate ;_bdgcd !=nil {_cbeg =_fd .FromEMU (_f .FromSTCoordinate (*_bdgcd ));
};if _bgbf :=_dagc .ST_Coordinate ;_bgbf !=nil {_ddacc =_fd .FromEMU (_f .FromSTCoordinate (*_bgbf ));};return _cbeg ,_ddacc ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_f .FontStyle ;func (_ccga *convertContext )addCellToTable (_gdg *_bg .Table ,_cddf *_ca .CT_TableCell ,_daf *_ca .CT_TablePartStyle ,_bdc float64 ,_fbfg ,_ffd ,_gfcce ,_adee bool )float64 {var _deab *_bg .TableCell ;_defe :=1;if _cddf .GridSpanAttr !=nil {_defe =int (*_cddf .GridSpanAttr );
};_deab =_gdg .MultiColCell (_defe );_fdge :=_cddf .TcPr ;var _gcf *_ca .CT_TableStyleTextStyle ;if _daf !=nil {_fdge =_ffee (_fdge ,_daf .TcStyle ,_fbfg ,_ffd ,_gfcce ,_adee );_gcf =_daf .TcTxStyle ;};_bedd :=_caf ;_cafd :=_bg .CellVerticalAlignmentMiddle ;
_ecebd :=_fffd (0.05);_eaf :=_fffd (0.05);if _fdge !=nil {if _abb :=_fdge .LnL ;_abb !=nil {_cde ,_fff ,_gdc :=_ccga .getBorderStyle (_abb );_deab .SetBorder (_bg .CellBorderSideLeft ,_cde ,_gdc );if _fff !=nil &&*_fff !=nil {_deab .SetSideBorderColor (_bg .CellBorderSideLeft ,*_fff );
};};if _agag :=_fdge .LnT ;_agag !=nil {_fcdbb ,_bfda ,_gega :=_ccga .getBorderStyle (_agag );_deab .SetBorder (_bg .CellBorderSideTop ,_fcdbb ,_gega );if _bfda !=nil &&*_bfda !=nil {_deab .SetSideBorderColor (_bg .CellBorderSideTop ,*_bfda );};};if _afec :=_fdge .LnR ;
_afec !=nil {_bddf ,_ffac ,_adbfc :=_ccga .getBorderStyle (_afec );_deab .SetBorder (_bg .CellBorderSideRight ,_bddf ,_adbfc );if _ffac !=nil &&*_ffac !=nil {_deab .SetSideBorderColor (_bg .CellBorderSideRight ,*_ffac );};};if _eee :=_fdge .LnB ;_eee !=nil {_fgaf ,_bbfg ,_bggb :=_ccga .getBorderStyle (_eee );
_deab .SetBorder (_bg .CellBorderSideBottom ,_fgaf ,_bggb );if _bbfg !=nil &&*_bbfg !=nil {_deab .SetSideBorderColor (_bg .CellBorderSideBottom ,*_bbfg );};};if _egag :=_fdge .MarLAttr ;_egag !=nil {_bedd =float64 (_f .FromSTCoordinate32 (*_egag ));};switch _fdge .AnchorAttr {case _ca .ST_TextAnchoringTypeT :_cafd =_bg .CellVerticalAlignmentTop ;
case _ca .ST_TextAnchoringTypeB :_cafd =_bg .CellVerticalAlignmentBottom ;};if _fdge .FillPropertiesChoice .NoFill ==nil {if _cebg :=_fdge .FillPropertiesChoice .SolidFill ;_cebg !=nil {_febc ,_ :=_ccga .getColorFromSolidFill (_cebg );_deab .SetBackgroundColor (_febc );
};};if _ebde :=_fdge .MarBAttr ;_ebde !=nil {_ecebd =float64 (_f .FromSTCoordinate32 (*_ebde ));};if _ggg :=_fdge .MarTAttr ;_ggg !=nil {_eaf =float64 (_f .FromSTCoordinate32 (*_ggg ));};};_deab .SetVerticalAlignment (_cafd );_deab .SetIndent (_bedd );
var _fgg float64 ;if _aeed :=_cddf .TxBody ;_aeed !=nil {_bef :=_ccga .makePdfDivisionFromTxBody (_aeed ,_gcf );_fgg =_bef .Height ()+_eaf +_ecebd ;_deab .SetContent (_bef );};return _fgg ;};type paragraph struct{_aceae float64 ;_efbe float64 ;_dbdg float64 ;
_dbg float64 ;_bde float64 ;_dca float64 ;_cfbee float64 ;_dfcc float64 ;_gcef _ca .ST_TextAlignType ;_aeab float64 ;_bfef bool ;_cbc []*line ;};func (_ad *convertContext )addShapes (_bc *_bf .CT_CommonSlideData ,_gb bool ){if _bc ==nil {return ;};_gga :=&background {};
if _acb :=_bc .Bg ;_acb !=nil {if _cdg :=_acb .BackgroundChoice .BgPr ;_cdg !=nil {if _cdg .FillPropertiesChoice .NoFill ==nil {if _cgg :=_cdg .FillPropertiesChoice .SolidFill ;_cgg !=nil {_gf ,_gfe :=_ad .getColorFromSolidFill (_cgg );if _gf !=nil {_gga ._dbf =_gf ;
_gga ._faec =_gfe ;};}else if _efd :=_cdg .FillPropertiesChoice .BlipFill ;_efd !=nil {_gga ._abga =_efd ;};};};};_ad ._bgfac =_gga ;if _ceag :=_bc .SpTree ;_ceag !=nil {for _ ,_fdg :=range _ceag .GroupShapeChoice {if _fdg !=nil {if _fdg .Sp !=nil {_eed :=_ad .getShapes (_fdg .Sp ,_gb ,false );
_ad ._bfe =append (_ad ._bfe ,_eed ...);};if _fdg .GraphicFrame !=nil {var _aca ,_bfc ,_eb ,_efdd float64 ;if _ag :=_fdg .GraphicFrame .Xfrm ;_ag !=nil {_aca ,_bfc ,_eb ,_efdd =_f .GetDataFromXfrm (_ag );};if _eb ==0&&_efdd ==0{_eb =_ad ._ccc ;_efdd =_ad ._cgf ;
};if _dgc :=_fdg .GraphicFrame .Graphic ;_dgc !=nil {if _ebg :=_dgc .GraphicData ;_ebg !=nil {for _ ,_dbb :=range _ebg .Any {if _fa ,_bb :=_dbb .(*_ef .Chart );_bb {_agf ,_fdb :=_ad .makePdfBlockFromChart (_fa ,_eb ,_efdd );if _fdb !=nil {_ed .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_fdb );
};if _agf !=nil {_agf .SetPos (_aca ,_bfc );_ad ._bfe =append (_ad ._bfe ,_agf );};}else if _fab ,_gfef :=_dbb .(*_ca .Tbl );_gfef {_bae :=_ad .makePdfBlockFromTable (_fab ,_eb );if _bae !=nil {_aab :=_bg .NewBlock (_eb ,_efdd );_aab .SetPos (_aca ,_bfc );
_aab .Draw (_bae );_ad ._bfe =append (_ad ._bfe ,_aab );};};};};};};if _fdg .CxnSp !=nil {_gea :=_ad .getConnectors (_fdg .CxnSp );_ad ._bfe =append (_ad ._bfe ,_gea ...);};if _fdg .GrpSp !=nil {_eedb :=0.0;_fef :=0.0;if _ede :=_fdg .GrpSp .GrpSpPr .Xfrm ;
_ede !=nil {_eedb ,_fef =_f .GetGroupOffsetFromXfrm (_ede );};for _ ,_dbe :=range _fdg .GrpSp .GroupShapeChoice {if _dbe .CxnSp !=nil {_aga :=_ad .getGroupConnectors (_dbe .CxnSp ,_eedb ,_fef );_ad ._bfe =append (_ad ._bfe ,_aga ...);};};};if _fdg .Pic !=nil {_ace :=false ;
var _afd ,_cec ,_fga ,_dag float64 ;if _dbd :=_fdg .Pic .SpPr ;_dbd !=nil {if _bca :=_dbd .Xfrm ;_bca !=nil {_afd ,_cec ,_fga ,_dag =_f .GetDataFromXfrm (_bca );_ace =true ;};};var _cb _bf .ST_PlaceholderType ;var _ece *uint32 ;if _cga :=_fdg .Pic .NvPicPr ;
_cga !=nil {if _gec :=_cga .NvPr ;_gec !=nil {if _fgd :=_gec .Ph ;_fgd !=nil {_cb =_fgd .TypeAttr ;_ece =_fgd .IdxAttr ;};};};_acaf ,_ ,_ ,_ ,_ :=_gfff (_ad ._eba .CSld ,_cb ,_ece );_eeb ,_ ,_ ,_ ,_ :=_gfff (_ad ._fgdf .CSld ,_cb ,_ece );if _eeb ==nil {_eeb =_acaf ;
};if _eeb !=nil &&!_ace {_afd ,_cec ,_fga ,_dag =_f .GetDataFromXfrm (_eeb );};if _bba :=_fdg .Pic .BlipFill ;_bba !=nil {_age :=_ad .getShapeFromBlipFill (_bba ,_afd ,_cec ,_fga ,_dag ,_gb );_ad ._bfe =append (_ad ._bfe ,_age );};};};};};};func (_cgcd *textboxContext )assignPropsToCurrentParagraph (_baea *_ca .CT_TextParagraphProperties ){_bdgc :=12.4;
if _baea ==nil {_cgcd ._baab ._aeab =_bdgc ;return ;};if _eab :=_baea .DefRPr ;_eab !=nil {_dac :=_eab .SzAttr ;if _dac !=nil {_acee :=float64 (*_dac )/1200;if _bdgc <=_acee {_bdgc =_acee ;};};};if _fbbg :=_baea .MarLAttr ;_fbbg !=nil {_cgcd ._baab ._bde =_fd .FromEMU (int64 (*_fbbg ));
};_cgcd ._baab ._dca =_cgcd ._edfa ;if _abd :=_baea .MarRAttr ;_abd !=nil {_cgcd ._baab ._dca -=_fd .FromEMU (int64 (*_abd ));};if _cccb :=_baea .IndentAttr ;_cccb !=nil {_cgcd ._baab ._dbg =_fd .FromEMU (int64 (*_cccb ));};if _bdef :=_baea .LatinLnBrkAttr ;
_bdef !=nil {_cgcd ._baab ._bfef =*_bdef ;};if _gcefb :=_baea .LnSpc ;_gcefb !=nil &&_gcefb .TextSpacingChoice !=nil {if _aba :=_gcefb .TextSpacingChoice .SpcPct ;_aba !=nil {if _acg :=_aba .ValAttr .ST_TextSpacingPercent ;_acg !=nil {_bdgc =float64 (*_acg )/5000;
};};};var _bgd float64 ;if _eggag :=_baea .SpcBef ;_eggag !=nil &&_eggag .TextSpacingChoice !=nil {if _ceaa :=_eggag .TextSpacingChoice .SpcPts ;_ceaa !=nil {_bgd =float64 (_ceaa .ValAttr )/100;};};_ccgcb :=_cgcd ._gaf ;if len (_ccgcb )> 0{_bgd -=_ccgcb [len (_ccgcb )-1]._dbdg ;
if _bgd < 0{_bgd =0;};};_cgcd ._baab ._efbe =_bgd ;if _bdb :=_baea .SpcAft ;_bdb !=nil &&_bdb .TextSpacingChoice !=nil {if _agc :=_bdb .TextSpacingChoice .SpcPts ;_agc !=nil {_cgcd ._baab ._dbdg =float64 (_agc .ValAttr )/100;};};_cgcd ._baab ._aeab =_bdgc ;
_cgcd ._baab ._gcef =_baea .AlgnAttr ;};func (_fae *convertContext )makePdfBlockFromTable (_bgca *_ca .Tbl ,_dfc float64 )*_bg .Table {_edbg :=_bgca .TblGrid ;if _edbg ==nil {return nil ;};_bfd :=len (_edbg .GridCol );if _bfd ==0{return nil ;};_fgfb :=[]float64 {};
_bced :=0.0;for _ ,_dagd :=range _edbg .GridCol {_fee :=_fd .FromEMU (_f .FromSTCoordinate (_dagd .WAttr ));_fgfb =append (_fgfb ,_fee );_bced +=_fee ;};_gbaa :=[]float64 {};for _fbf :=0;_fbf < _bfd ;_fbf ++{_gbaa =append (_gbaa ,_fgfb [_fbf ]/_bced );
};_fcdb :=_fae ._gcaa .NewTable (_bfd );_fcdb .SetColumnWidths (_gbaa ...);_caeb :=_bgca .TblPr ;var _dcba *_ca .CT_TableStyle ;if _cfb :=_caeb .TablePropertiesChoice ;_cfb !=nil {if _cfb .TableStyle !=nil {_dcba =_cfb .TableStyle ;}else if _cfb .TableStyleId !=nil {_dcba =_fae ._dfg .GetTableStyleById (*_cfb .TableStyleId );
};};_abf :=_ca .NewCT_TablePartStyle ();_abf .TcStyle =_ca .NewCT_TableStyleCellStyle ();_abf .TcTxStyle =_ca .NewCT_TableStyleTextStyle ();if _dcba !=nil {if _dcba .WholeTbl !=nil {*_abf =*_dcba .WholeTbl ;};if _dcba .TblBg !=nil {if _abf .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_abf .TcStyle .ThemeableFillStyleChoice .Fill =_dcba .TblBg .ThemeableFillStyleChoice .Fill ;
};};};if _abf .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_abf .TcStyle .ThemeableFillStyleChoice .Fill =_ca .NewCT_FillProperties ();_abf .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .NoFill =_caeb .FillPropertiesChoice .NoFill ;
_abf .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .SolidFill =_caeb .FillPropertiesChoice .SolidFill ;};_cede :=len (_bgca .Tr );_cca :=_bgca .TblPr .BandRowAttr !=nil &&*_bgca .TblPr .BandRowAttr ;_adad :=_bgca .TblPr .FirstRowAttr !=nil &&*_bgca .TblPr .FirstRowAttr ;
_afbe :=_bgca .TblPr .LastRowAttr !=nil &&*_bgca .TblPr .LastRowAttr ;_gdeb :=_bgca .TblPr .BandColAttr !=nil &&*_bgca .TblPr .BandColAttr ;_def :=_bgca .TblPr .FirstColAttr !=nil &&*_bgca .TblPr .FirstColAttr ;_feb :=_bgca .TblPr .LastColAttr !=nil &&*_bgca .TblPr .LastColAttr ;
for _bfa ,_acf :=range _bgca .Tr {_gdda :=_bfa ==0;_cfbe :=_bfa ==_cede -1;_ccad :=_bfa %2==0;_adfa :=len (_acf .Tc );var _fcde *_ca .CT_TablePartStyle ;if _dcba !=nil {if _gdda &&_adad {_fcde =_dcba .FirstRow ;}else if _cfbe &&_afbe {_fcde =_dcba .LastRow ;
}else if _ccad &&_cca {_fcde =_dcba .Band2H ;}else if _cca {_fcde =_dcba .Band1H ;};};var _gfce float64 ;for _fcgd ,_egcc :=range _acf .Tc {_fafc :=_fcgd ==0;_efee :=_fcgd ==_adfa -1;_geaa :=_fcgd %2==0;var _edbb *_ca .CT_TablePartStyle ;if _dcba !=nil {if _fafc &&_def {_edbb =_dcba .FirstCol ;
}else if _efee &&_feb {_edbb =_dcba .LastCol ;}else if _geaa &&_gdeb {_edbb =_dcba .Band2V ;}else if _gdeb {_edbb =_dcba .Band1V ;};};_ebe :=_adgfe (_adgfe (_edbb ,_fcde ),_abf );_ceae :=_fae .addCellToTable (_fcdb ,_egcc ,_ebe ,_dfc *_gbaa [_fcgd ],_gdda ,_cfbe ,_fafc ,_efee );
if _ceae > _gfce {_gfce =_ceae ;};};_degfg :=_fd .FromEMU (_f .FromSTCoordinate (_acf .HAttr ));if _degfg < _gfce {_degfg =_gfce ;};if _degfg < _ebdf (4){_degfg =_ebdf (4);};_fcdb .SetRowHeight (_fcdb .CurRow (),_degfg );};return _fcdb ;};func (_egfb *textboxContext )addCurrentWordToParagraph (){if _egfb ._afea &&_egfb ._dfff ._fdgd +_egfb ._dgad ._dedf > _egfb ._dfff ._affc {_egfb .newLine ();
};if !_egfb ._dgad ._aaed ||len (_egfb ._dfff ._dec )> 0{_egfb ._dgad ._aedb =_egfb ._dfff ._fdgd ;_egfb ._dfff ._dec =append (_egfb ._dfff ._dec ,_egfb ._dgad );_egfb ._dfff ._fdgd +=_egfb ._dgad ._dedf ;for _ ,_babf :=range _egfb ._dgad ._edef {_egfb .adjustHeights (_babf ._ffg );
};};};func (_bage *textboxContext )alignSymbolsVertically (){for _ ,_dgef :=range _bage ._gaf {for _ ,_cbfb :=range _dgef ._cbc {_gaa :=0.0;for _ ,_bfaa :=range _cbfb ._dec {for _ ,_adc :=range _bfaa ._edef {if _adc ._ffg > _gaa {_gaa =_adc ._ffg ;};};
};for _ ,_deag :=range _cbfb ._dec {for _ ,_cece :=range _deag ._edef {if _cece ._bcf < _gaa {_cece ._fbeg =_gaa -_cece ._bcf ;};};};};};};func (_bacaf *textboxContext )alignVertically (_gfee _ca .ST_TextAnchoringType ){_bacaf .alignParagraphsVertically (_gfee );
_bacaf .alignSymbolsVertically ();};func (_ccf *textboxContext )alignParagraph (){_dbdd :=_ccf ._baab ;if _dbdd ._gcef ==_ca .ST_TextAlignTypeL {return ;};_cecc :=len (_dbdd ._cbc )-1;for _abe ,_fdf :=range _dbdd ._cbc {_cccg :=true ;_daag :=len (_fdf ._dec );
_cbga :=0.0;for _becd :=len (_fdf ._dec )-1;_becd >=0;_becd --{_fbad :=_fdf ._dec [_becd ];if _cccg &&_fbad ._aaed {_daag =_becd ;}else {_cccg =false ;for _ ,_ecab :=range _fbad ._edef {_cbga +=_ecab ._gdca ;};};};_fdf ._dec =_fdf ._dec [:_daag ];_dfce :=_fdf ._affc -_fdf ._cbf -_cbga ;
switch _dbdd ._gcef {case _ca .ST_TextAlignTypeR :_fdf .moveRight (_dfce );case _ca .ST_TextAlignTypeCtr :_fdf .moveRight (_dfce /2);case _ca .ST_TextAlignTypeJust :if _abe !=_cecc {_gfgg :=[]*word {};for _ ,_geea :=range _fdf ._dec {if _geea ._aaed {_gfgg =append (_gfgg ,_geea );
};};_cafe :=_dfce /float64 (len (_gfgg ));for _ ,_dbaa :=range _gfgg {_dbaa ._dedf +=_cafe ;};var _eff *word ;for _ ,_cdeg :=range _fdf ._dec {if _eff !=nil {_cdeg ._aedb =_eff ._aedb +_eff ._dedf ;};_eff =_cdeg ;};};};};};func (_ccbc *line )moveRight (_bdbd float64 ){for _ ,_bfce :=range _ccbc ._dec {_bfce ._aedb +=_bdbd ;
};};func (_fdbgf *textboxContext )addCurrentParagraph (){_fdbgf ._gddf =_fdbgf ._baab ._cfbee +_fdbgf ._baab ._efbe +_fdbgf ._baab ._dfcc +_fdbgf ._baab ._dbdg ;_fdbgf ._gaf =append (_fdbgf ._gaf ,_fdbgf ._baab );_fdbgf .alignParagraph ();};func _fffd (_cagea float64 )float64 {return _cagea *_fd .Inch };


// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_ddb .PdfFont ){_f .RegisterFont (name ,style ,font );};func (_bbcf *textboxContext )drawParagraphs (){_bbcf ._adg .NewPage ();for _ ,_aaec :=range _bbcf ._gaf {for _ ,_gbdbg :=range _aaec ._cbc {for _ ,_gdcf :=range _gbdbg ._dec {for _ ,_aeca :=range _gdcf ._edef {_gcbb :=_bbcf ._adg .NewStyledParagraph ();
if _aeca ._ffgg {_aeca ._fbeg =0;}else if _aeca ._eafc {_aeca ._fbeg =1.2*_gbdbg ._abfa -_aeca ._bcf ;};_gddge :=_gdcf ._aedb +_aeca ._afdg ;_fbee :=_aaec ._cfbee +_gbdbg ._fgea +_aeca ._fbeg ;_gcbb .SetPos (_gddge ,_fbee );_ccefd :=_gcbb .Append (_aeca ._agdc );
if _aeca ._ccbg !=nil {_ccefd .Style =*_aeca ._ccbg ;};_bbcf ._adg .Draw (_gcbb );if _aeca ._eccc {_eagb :=_fbee +_aeca ._bcf +2;_f .DrawLine (_bbcf ._adg ,_gddge ,_eagb ,_gddge +_aeca ._gdca ,_eagb ,1,_aeca ._ccbg .Color );};};};};};};func (_fabg *convertContext )getShapesFromSpPr (_fbe *_ca .CT_ShapeProperties ,_baca *_ca .CT_ShapeStyle ,_cege bool ,_gef float64 ,_bab float64 )([]_bg .Drawable ,float64 ,float64 ,float64 ,float64 ,_bg .Color ,bool ){_ecf :=[]_bg .Drawable {};
var _fcf ,_fcff ,_edbe ,_dab ,_ab float64 ;var _cad ,_ggc ,_eda ,_fcffc _bg .Color ;var _ecfb *_ca .CT_BlipFillProperties ;_bfbf ,_ggcb :=1.0,1.0;if _baca !=nil {_cad ,_ggc ,_fcffc =_fabg .getStyleColors (_baca );};if _eceb :=_fbe .Ln ;_eceb !=nil {if _eceb .LineFillPropertiesChoice .NoFill !=nil {_eda ,_ab =nil ,0;
}else {_eda ,_ab ,_bfbf =_fabg .getInfoFromLn (_eceb );if _eda ==nil {_eda =_fcffc ;};};};if _fbe .FillPropertiesChoice .NoFill !=nil {_ggc ,_ggcb =nil ,0;}else if _cege {_ggc =_fabg ._bgfac ._dbf ;_ggcb =_fabg ._bgfac ._faec ;_ecfb =_fabg ._bgfac ._abga ;
}else if _dad :=_fbe .FillPropertiesChoice .SolidFill ;_dad !=nil {_ggc ,_ggcb =_fabg .getColorFromSolidFill (_dad );};var _cf bool ;if _agec :=_fbe .Xfrm ;_agec !=nil {_fcf ,_fcff ,_edbe ,_dab =_f .GetDataFromXfrm (_agec );_fcf +=_gef ;_fcff +=_bab ;_cf =true ;
};if _ddg :=_fbe .GeometryChoice .CustGeom ;_ddg !=nil {_agaa :=[]_ac .Point {};_ga ,_aaa :=1.0,1.0;if _dfeg :=_ddg .PathLst ;_dfeg !=nil {for _ ,_fdd :=range _dfeg .Path {if _fdd !=nil {if _aabd :=_fdd .WAttr ;_aabd !=nil {_ga =_edbe /_fd .FromEMU (*_aabd );
};if _gge :=_fdd .HAttr ;_gge !=nil {_aaa =_dab /_fd .FromEMU (*_gge );};for _ ,_cade :=range _fdd .Path2DChoice {if _cade .Close !=nil {};if _gfg :=_cade .MoveTo ;_cade .MoveTo !=nil {if _gfg !=nil &&_gfg .Pt !=nil {_cae ,_fdbg :=_fag (_gfg .Pt );_agaa =append (_agaa ,_ac .Point {X :_cae *_ga +_fcf ,Y :_fdbg *_aaa +_fcff });
};};if _edg :=_cade .LnTo ;_edg !=nil &&_edg .Pt !=nil {_ff ,_fabd :=_fag (_edg .Pt );_agaa =append (_agaa ,_ac .Point {X :_ff *_ga +_fcf ,Y :_fabd *_aaa +_fcff });};};_dgfg :=_fabg ._gcaa .NewPolygon ([][]_ac .Point {_agaa });_dgfg .SetFillColor (_ggc );
_dgfg .SetFillOpacity (_ggcb );_dgfg .SetBorderWidth (_ab );if _eda !=nil {_dgfg .SetBorderColor (_eda );_dgfg .SetBorderOpacity (_bfbf );};_ecf =append (_ecf ,_dgfg );};};};};if _gca :=_fbe .GeometryChoice .PrstGeom ;_gca !=nil {switch _gca .PrstAttr {case _ca .ST_ShapeTypeRect :if _ecfb !=nil {_fefa :=_fabg .getShapeFromBlipFill (_ecfb ,_fcf ,_fcff ,_edbe ,_dab ,false );
_ecf =append (_ecf ,_fefa );}else {_ada :=_fabg ._gcaa .NewRectangle (_fcf ,_fcff ,_edbe ,_dab );_edee :=_ggc !=nil &&_ggcb > 0;if _edee {_ada .SetFillColor (_ggc );_ada .SetFillOpacity (_ggcb );};_agac :=_eda !=nil &&_bfbf > 0&&_ab > 0;if _agac {_ada .SetBorderWidth (_ab );
_ada .SetBorderColor (_eda );_ada .SetBorderOpacity (_bfbf );};if _edee ||_agac {_ecf =append (_ecf ,_ada );};};case _ca .ST_ShapeTypeLine :_ccgc :=_fabg ._gcaa .NewLine (_fcf ,_fcff ,_fcf +_edbe ,_fcff +_dab );_ccgc .SetLineWidth (_ab );if _eda !=nil {_ccgc .SetColor (_eda );
};_ecf =append (_ecf ,_ccgc );};};return _ecf ,_fcf ,_fcff ,_edbe ,_dab ,_cad ,_cf ;};type line struct{_fgea float64 ;_cbf float64 ;_affc float64 ;_fdgd float64 ;_abfa float64 ;_dec []*word ;};func (_cdaa *textboxContext )addTextSymbol (_bbbab *symbol ){_bec :=_bg .New ();
_egaf :=_bec .NewStyledParagraph ();_egaf .SetMargins (0,0,0,0);_eafb :=_egaf .Append (_bbbab ._agdc );_bfcc :=0.0;if _bbbab ._ccbg !=nil {_eafb .Style =*_bbbab ._ccbg ;if _bbbab ._ccbg .CharSpacing !=0{_bfcc =_bbbab ._ccbg .CharSpacing ;};};_bbbab ._bcf =_egaf .Height ();
_bbbab ._ffg =_egaf .Height ()*1.2;if _bbbab ._gdca ==0{_bbbab ._gdca =_egaf .Width ()+_bfcc ;};if len (_cdaa ._dgad ._edef )> 0{_deca :=_cdaa ._dgad ._edef [len (_cdaa ._dgad ._edef )-1]._agdc ;if _cdaa ._baab ._bfef ||_f .IsNoSpaceLanguage (_deca )||(_deca =="\u0020")!=(_bbbab ._agdc =="\u0020"){_cdaa .addCurrentWordToParagraph ();
_cdaa .newWord ();};};_cdaa ._dgad ._edef =append (_cdaa ._dgad ._edef ,_bbbab );_bbbab ._afdg =_cdaa ._dgad ._dedf ;_cdaa ._dgad ._dedf +=_bbbab ._gdca ;if _bbbab ._agdc !="\u0020"{_cdaa ._dgad ._aaed =false ;};if _cdaa ._dgad ._dedf >=_cdaa ._baab ._dca -_cdaa ._baab ._bde {_cdaa .addCurrentWordToParagraph ();
_cdaa .newLine ();_cdaa .newWord ();};};func (_bbfb *textboxContext )addPrefix (_cega *prefixData ,_gdea *_bg .TextStyle ){_add :=_gce (_cega ._ffdf );_fgff :=*_gdea ;if _cega ._gcff {_fgff .Font =_f .AssignStdFontByName (_fgff ,"\u0053\u0079\u006d\u0062\u006f\u006c");
};for _ ,_dbdge :=range _add {_dbdge ._ccbg =&_fgff ;_bbfb .addTextSymbol (_dbdge );};_adgf :=-(_cega ._bdgf +_bbfb ._dgad ._dedf );if _adgf < 0{_adgf =0;};_dcfc :=&symbol {_agdc :"\u0020",_gdca :_adgf };_bbfb .addTextSymbol (_dcfc );_bbfb ._dgad ._aedb +=(_cega ._bdgf +_cega ._ffdc );
};func (_adb *convertContext )getShapes (_gfcc *_bf .CT_Shape ,_cgag bool ,_dcc bool )[]_bg .Drawable {_bff :=[]_bg .Drawable {};_daac :=_gfcc .SpPr ;if _daac ==nil {return _bff ;};var _cdf bool ;if _gbd :=_gfcc .UseBgFillAttr ;_gbd !=nil {_cdf =*_gbd ;
};_aed ,_cgd ,_adf ,_dff ,_bbba ,_acea ,_bed :=_adb .getShapesFromSpPr (_daac ,_gfcc .Style ,_cdf ,0.0,0.0);if !_dcc {_bff =append (_bff ,_aed ...);};if _daed :=_gfcc .TxBody ;_daed !=nil &&!_cgag {_gdd ,_ccbe ,_efb ,_aea ,_afb ,_bgcf :=_adb .getPhData (_gfcc );
if _dcc &&!(_aea ||_afb ){return _bff ;};if _gdd !=nil &&!_bed {_cgd ,_adf ,_dff ,_bbba =_f .GetDataFromXfrm (_gdd );};_bfb ,_fge :=_adb .makePdfBlockFromTxBody (_daed ,_ccbe ,_efb ,_dff ,_bbba ,_acea ,_aea ,_bgcf );if _fge !=nil {_ed .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_fge );
}else if _bfb !=nil {_bfb .SetPos (_cgd ,_adf );_bff =append (_bff ,_bfb );};};return _bff ;};func (_dbdea *convertContext )getShapeFromBlipFill (_ggcd *_ca .CT_BlipFillProperties ,_cfee ,_agecf ,_bfbe ,_faee float64 ,_dfb bool )_bg .Drawable {_fec ,_egcd ,_faff :=_dbdea .makePdfImageFromBlipFill (_ggcd ,_dfb );
if _faff !=nil {_ed .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_faff );
return nil ;};if _fec ==nil {return nil ;};if _cfed :=_ggcd .FillModePropertiesChoice .Tile ;_cfed !=nil {_fec =_dbdea .tileImage (_fec ,_ggcd .FillModePropertiesChoice .Tile ,_bfbe ,_faee );};if _ecffd :=_ggcd .FillModePropertiesChoice .Stretch ;_ecffd !=nil {_fec ,_cfee ,_agecf =_dbdea .stretchImage (_fec ,_ggcd .FillModePropertiesChoice .Stretch ,_cfee ,_agecf ,_bfbe ,_faee );
};if _fec ==nil {return nil ;};if len (_egcd )==0{_fec .SetPos (_cfee ,_agecf );return _fec ;};_fec =_dbdea .applyBlipEffectsOnImg (_fec ,_cfee ,_agecf ,_egcd );_fec .SetPos (_cfee ,_agecf );return _fec ;};func (_geeb *textboxContext )newParagraph (){_befg :=&paragraph {};
_befg ._cfbee =_geeb ._gddf ;_geeb ._baab =_befg ;};func (_gac *convertContext )getColorFromSolidFill (_acgc *_ca .CT_SolidColorFillProperties )(_bg .Color ,float64 ){if _acgc ==nil {return nil ,1;};var _bgfd string ;_gab :=1.0;if _cdae :=_acgc .SrgbClr ;
_cdae !=nil {_bgfd =_cdae .ValAttr ;_gab =_f .GetOpacityFromColorTransform (_cdae .EG_ColorTransform );}else if _bagf :=_acgc .SchemeClr ;_bagf !=nil {_bgfd =_f .GetColorStringFromDmlColor (_gac ._dgag .GetColorBySchemeColor (_bagf .ValAttr ));_bgfd =_f .AdjustColor (_bgfd ,_bagf .EG_ColorTransform );
_gab =_f .GetOpacityFromColorTransform (_bagf .EG_ColorTransform );};if _bgfd !=""{_caeg :=_bg .ColorRGBFromHex ("\u0023"+_bgfd );return _caeg ,_gab ;};return nil ,1;};type prefixData struct{_ffdf string ;_gcff bool ;_ffdc float64 ;_bdgf float64 ;};type symbolStyle struct{_fcgg *string ;
_bgbb *float64 ;_cfd *string ;_bacc *bool ;_bdgg *bool ;_baf *bool ;_ccef *bool ;_faea *bool ;};func (_aebc *convertContext )getInfoFromLn (_dee *_ca .CT_LineProperties )(_bg .Color ,float64 ,float64 ){if _dee ==nil ||_dee .LineFillPropertiesChoice .NoFill !=nil {return nil ,0,0;
};var _fgef float64 ;_bbbc ,_bcg :=_aebc .getColorFromSolidFill (_dee .LineFillPropertiesChoice .SolidFill );if _ddd :=_dee .WAttr ;_ddd !=nil {_fgef =_fd .FromEMU (int64 (*_ddd ));}else {_fgef =1;};return _bbbc ,_fgef ,_bcg ;};func (_dbbd *textboxContext )adjustHeights (_cbg float64 ){if _dbbd ._dfff ._abfa < _cbg {_dbbd ._baab ._dfcc +=(_cbg -_dbbd ._dfff ._abfa );
_dbbd ._dfff ._abfa =_cbg ;};};var _ddea =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func (_becc *convertContext )getColorFromMatrixReference (_ffge *_ca .CT_StyleMatrixReference )_bg .Color {if _ffge ==nil {return nil ;};var _fce _bg .Color ;
var _dbdec string ;if _bgcd :=_ffge .SrgbClr ;_bgcd !=nil {_dbdec =_bgcd .ValAttr ;}else if _gcfa :=_ffge .SchemeClr ;_gcfa !=nil {_dbdec =_f .GetColorStringFromDmlColor (_becc ._dfg .GetColorBySchemeColor (_gcfa .ValAttr ));_dbdec =_f .AdjustColor (_dbdec ,_gcfa .EG_ColorTransform );
};if _dbdec !=""{_fce =_bg .ColorRGBFromHex ("\u0023"+_dbdec );};return _fce ;};var _caf =_ebdf (1.9);func (_gbc *textboxContext )addTextRun (_cdag *_ca .EG_TextRun ,_cfba *_ca .CT_TextCharacterProperties ,_ffbb _bg .Color ,_egb *prefixData ){if _baad :=_cdag .TextRunChoice .Br ;
_baad !=nil {_gbc .addCurrentWordToParagraph ();_gbc .newLine ();_gbc .newWord ();}else if _efcaf :=_cdag .TextRunChoice .R ;_efcaf !=nil {var _bfeg _bg .Color ;if _efcaf .RPr !=nil &&_efcaf .RPr .FillPropertiesChoice .SolidFill !=nil {_bfeg ,_ =_gbc ._gddaa .getColorFromSolidFill (_efcaf .RPr .FillPropertiesChoice .SolidFill );
}else if _ffbb !=nil {_bfeg =_ffbb ;}else if _cfba .FillPropertiesChoice .SolidFill !=nil {_bfeg ,_ =_gbc ._gddaa .getColorFromSolidFill (_cfba .FillPropertiesChoice .SolidFill );}else {_bfeg =_bg .ColorBlack ;};_cef :=_cbfg (_efcaf .RPr ,_cfba );_ffe ,_fcdg ,_baee ,_egaa :=_gbc ._gddaa .makeStyleFromRPr (_cef );
_ffe .Color =_bfeg ;if _egb !=nil {_gbc .addPrefix (_egb ,_ffe );};_gag :=_gce (_efcaf .T );for _ ,_aec :=range _gag {_aec ._ccbg =_ffe ;_aec ._ffgg =_fcdg ;_aec ._eafc =_baee ;_aec ._eccc =_egaa ;if _cef .CapAttr ==_ca .ST_TextCapsTypeAll {_aec ._agdc =_b .ToUpper (_aec ._agdc );
};_gbc .addTextSymbol (_aec );};};};func _ccbef (_caef ,_abaf *_ca .CT_TextBody )(*_ca .CT_TextBodyProperties ,*_ca .CT_TextListStyle ){if _caef ==nil &&_abaf ==nil {return nil ,nil ;};if _caef ==nil {return _abaf .BodyPr ,_abaf .LstStyle ;};if _abaf ==nil {return _caef .BodyPr ,_caef .LstStyle ;
};_fed ,_bbef :=_caef .BodyPr ,_caef .LstStyle ;_ddda ,_aaeg :=_abaf .BodyPr ,_abaf .LstStyle ;_dadcd :=_ffc (_fed ,_ddda );_gcg :=_ebgb (_bbef ,_aaeg );return _dadcd ,_gcg ;};func (_ecc *convertContext )makePdfBlockFromTxBody (_bdf *_ca .CT_TextBody ,_dfee *_ca .CT_TextBodyProperties ,_cge *_ca .CT_TextListStyle ,_bffg ,_cab float64 ,_gbbe _bg .Color ,_aaaf ,_gdb bool )(*_bg .Block ,error ){var _dga *_ca .CT_TextParagraphProperties ;
if _eec :=_bdf .LstStyle ;_eec !=nil {var _aef *_ca .CT_TextParagraphProperties ;if _eec .Lvl1pPr !=nil {_aef =_eec .Lvl1pPr ;};_dga =_dede (_aef ,_eec .DefPPr );};var _gbaf *_ca .CT_TextParagraphProperties ;if _dga !=nil {if _aaaf {_gbaf =_ecc ._deb [0];
}else if _gdb {_gbaf =_ecc ._cfgd [0];}else {_gbaf =_ecc ._bfea [0];};if _cge !=nil {_gbaf =_dede (_dede (_cge .Lvl1pPr ,_cge .DefPPr ),_gbaf );};_gbaf =_dede (_dga ,_gbaf );}else {if _aaaf {_gbaf =_ecc ._gfcd ;}else if _gdb {_gbaf =_ecc ._eeee ;}else {_gbaf =_ecc ._bebfg ;
};};_aag ,_fdbb :=_ebdf (2.5),_ebdf (2.5);_gbg ,_egc :=_ebdf (1.3),_ebdf (1.3);_badg :=true ;_bbaf :=_ca .ST_TextAnchoringTypeT ;if _dfee !=nil {if _dfeb :=_dfee .AnchorAttr ;_dfeb !=_ca .ST_TextAnchoringTypeUnset {_bbaf =_dfeb ;};};if _aabf :=_bdf .BodyPr ;
_aabf !=nil {if _afed :=_aabf .LInsAttr ;_afed !=nil {_aag =_fd .FromEMU (_f .FromSTCoordinate32 (*_afed ));};if _ffaa :=_aabf .TInsAttr ;_ffaa !=nil {_gbg =_fd .FromEMU (_f .FromSTCoordinate32 (*_ffaa ));};if _dgbe :=_aabf .RInsAttr ;_dgbe !=nil {_fdbb =_fd .FromEMU (_f .FromSTCoordinate32 (*_dgbe ));
};if _dba :=_aabf .BInsAttr ;_dba !=nil {_egc =_fd .FromEMU (_f .FromSTCoordinate32 (*_dba ));};_badg =_aabf .WrapAttr !=_ca .ST_TextWrappingTypeNone ;if _eaa :=_aabf .AnchorAttr ;_eaa !=_ca .ST_TextAnchoringTypeUnset {_bbaf =_aabf .AnchorAttr ;};};_adbc :=_f .MakeTempCreator (_bffg ,_cab );
_adbc .SetPageMargins (_aag ,_fdbb ,_gbg ,_egc );_dcf :=&textboxContext {_gddaa :_ecc ,_afea :_badg ,_edfa :_bffg -_aag -_fdbb ,_aceaf :_cab -_gbg -_egc ,_adg :_adbc ,_gaf :[]*paragraph {}};_bcc :=1;for _ ,_cac :=range _bdf .P {if _cac !=nil {_beaf :=_cac .PPr ;
var _bgf *prefixData ;if _beaf !=nil &&_beaf .TextBulletChoice .BuNone ==nil {var _affd string ;var _efeg bool ;if _aee :=_beaf .TextBulletChoice .BuAutoNum ;_aee !=nil {var _bgg string ;if _fgf :=_aee .StartAtAttr ;_fgf !=nil {_bcc =int (*_fgf );};var _gae string ;
switch _aee .TypeAttr {case _ca .ST_TextAutonumberSchemeAlphaUcParenBoth ,_ca .ST_TextAutonumberSchemeAlphaUcParenR ,_ca .ST_TextAutonumberSchemeAlphaUcPeriod :_gae =_fdde (_bcc ,true );case _ca .ST_TextAutonumberSchemeAlphaLcParenBoth ,_ca .ST_TextAutonumberSchemeAlphaLcParenR ,_ca .ST_TextAutonumberSchemeAlphaLcPeriod :_gae =_fdde (_bcc ,false );
case _ca .ST_TextAutonumberSchemeRomanUcParenBoth ,_ca .ST_TextAutonumberSchemeRomanUcParenR ,_ca .ST_TextAutonumberSchemeRomanUcPeriod :_gae =_adff (_bcc ,true );case _ca .ST_TextAutonumberSchemeRomanLcParenBoth ,_ca .ST_TextAutonumberSchemeRomanLcParenR ,_ca .ST_TextAutonumberSchemeRomanLcPeriod :_gae =_adff (_bcc ,false );
default:_gae =_dg .Itoa (_bcc );};switch _aee .TypeAttr {case _ca .ST_TextAutonumberSchemeAlphaLcPeriod ,_ca .ST_TextAutonumberSchemeAlphaUcPeriod ,_ca .ST_TextAutonumberSchemeArabicPeriod ,_ca .ST_TextAutonumberSchemeRomanLcPeriod ,_ca .ST_TextAutonumberSchemeRomanUcPeriod ,_ca .ST_TextAutonumberSchemeArabicDbPeriod ,_ca .ST_TextAutonumberSchemeEa1ChsPeriod ,_ca .ST_TextAutonumberSchemeEa1ChtPeriod ,_ca .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_ca .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_ca .ST_TextAutonumberSchemeThaiAlphaPeriod ,_ca .ST_TextAutonumberSchemeThaiNumPeriod ,_ca .ST_TextAutonumberSchemeHindiAlphaPeriod ,_ca .ST_TextAutonumberSchemeHindiNumPeriod ,_ca .ST_TextAutonumberSchemeHindiAlpha1Period :_bgg ="\u002e";
case _ca .ST_TextAutonumberSchemeAlphaLcParenR ,_ca .ST_TextAutonumberSchemeAlphaUcParenR ,_ca .ST_TextAutonumberSchemeArabicParenR ,_ca .ST_TextAutonumberSchemeRomanLcParenR ,_ca .ST_TextAutonumberSchemeRomanUcParenR ,_ca .ST_TextAutonumberSchemeThaiAlphaParenR ,_ca .ST_TextAutonumberSchemeThaiNumParenR ,_ca .ST_TextAutonumberSchemeHindiNumParenR :_bgg ="\u0029";
};_affd =_gae +_bgg ;_bcc ++;}else if _efegg :=_beaf .TextBulletChoice .BuChar ;_efegg !=nil {_bgcb :=_efegg .CharAttr ;if _gfcf ,_ddga :=_ddea [_bgcb ];_ddga {_bgcb =string (rune (_gfcf ));}else {_bgcb ="\u2022";};_affd =_bgcb ;_efeg =true ;};if _affd !=""{var _aabb ,_egga float64 ;
if _beaf .MarLAttr !=nil {_aabb =_fd .FromEMU (int64 (*_beaf .MarLAttr ));};if _beaf .IndentAttr !=nil {_egga =_fd .FromEMU (int64 (*_beaf .IndentAttr ));};_bgf =&prefixData {_ffdf :_affd ,_gcff :_efeg ,_ffdc :_aabb ,_bdgf :_egga };};};_beaf =_dede (_beaf ,_gbaf );
_eag :=_cbfg (_cac .EndParaRPr ,_beaf .DefRPr );_dcf .newParagraph ();_dcf .assignPropsToCurrentParagraph (_beaf );_dcf .newLine ();_dcf .newWord ();for _ggfc ,_cgc :=range _cac .EG_TextRun {_dcf .addTextRun (_cgc ,_eag ,_gbbe ,_bgf );if _ggfc > 0{_bgf =nil ;
};};_dcf .addCurrentWordToParagraph ();};_dcf .addCurrentParagraph ();};_dcf .alignVertically (_bbaf );_dcf .drawParagraphs ();return _f .MakeBlockFromCreator (_adbc );};func (_gff *convertContext )drawSlide (){_gff ._gcaa .NewPage ();for _ ,_ecd :=range _gff ._bfe {if _ecd !=nil {_gff ._gcaa .MoveTo (0,0);
_gff ._gcaa .Draw (_ecd );};};};func (_gde *convertContext )stretchImage (_bdgd *_bg .Image ,_eeda *_ca .CT_StretchInfoProperties ,_efcc ,_cdb ,_daec ,_fb float64 )(*_bg .Image ,float64 ,float64 ){_gfc :=_eeda .FillRect ;if _gfc ==nil {_acc :=_bdgd .Width ()/_bdgd .Height ();
_dedb :=_daec /_fb ;var _fac ,_edb float64 ;if _acc > _dedb {_edb =_fb ;_fac =_fb *_acc ;}else {_fac =_daec ;_edb =_daec /_acc ;};_bdgd .Scale (_fac /_bdgd .Width (),_edb /_bdgd .Height ());return _bdgd ,_efcc ,_cdb ;};var _bbb ,_bdga ,_fgad ,_acag float64 ;
if _edc :=_gfc .LAttr ;_edc !=nil {_fgad =_f .FromSTPercentage (_edc );};if _gfb :=_gfc .TAttr ;_gfb !=nil {_bbb =_f .FromSTPercentage (_gfb );};if _ggae :=_gfc .RAttr ;_ggae !=nil {_acag =_f .FromSTPercentage (_ggae );};if _bbf :=_gfc .BAttr ;_bbf !=nil {_bdga =_f .FromSTPercentage (_bbf );
};_ega :=_daec *(1-_fgad -_acag );_bgb :=_fb *(1-_bbb -_bdga );_bdgd .Scale (_ega /_bdgd .Width (),_bgb /_bdgd .Height ());return _bdgd ,_efcc +_fgad *_daec ,_cdb +_bbb *_fb ;};func (_ecg *convertContext )getColorFromFontReference (_fcce *_ca .CT_FontReference )_bg .Color {var _bgcag _bg .Color ;
var _fgae string ;if _fgbc :=_fcce .SrgbClr ;_fgbc !=nil {_fgae =_fgbc .ValAttr ;}else if _geag :=_fcce .SchemeClr ;_geag !=nil {_fgae =_f .GetColorStringFromDmlColor (_ecg ._dfg .GetColorBySchemeColor (_geag .ValAttr ));_fgae =_f .AdjustColor (_fgae ,_geag .EG_ColorTransform );
};if _fgae !=""{_bgcag =_bg .ColorRGBFromHex ("\u0023"+_fgae );};return _bgcag ;};func _acd (_cefc *bool )bool {return _cefc !=nil &&*_cefc };type convertContext struct{_gcaa *_bg .Creator ;_afcd *_f .Rectangle ;_dfg *_gg .Presentation ;_dgag *_gg .Slide ;
_eba *_bf .SldMaster ;_fgdf *_bf .SldLayout ;_cgf float64 ;_ccc float64 ;_bfe []_bg .Drawable ;_bgfac *background ;_bebfg *_ca .CT_TextParagraphProperties ;_eggg *_ca .CT_TextCharacterProperties ;_gfcd *_ca .CT_TextParagraphProperties ;_eecdd *_ca .CT_TextCharacterProperties ;
_eeee *_ca .CT_TextParagraphProperties ;_fggf *_ca .CT_TextCharacterProperties ;_bfea []*_ca .CT_TextParagraphProperties ;_deb []*_ca .CT_TextParagraphProperties ;_cfgd []*_ca .CT_TextParagraphProperties ;_facc *_ca .Theme ;_fbb *_ca .CT_ColorMappingOverride ;
};func (_gbe *convertContext )makeStyleFromRPr (_cfg *_ca .CT_TextCharacterProperties )(*_bg .TextStyle ,bool ,bool ,bool ){var _cage ,_edca ,_gddg bool ;_dbbad :=_gbe ._gcaa .NewTextStyle ();if _cfg !=nil {_abc :=_f .FontStyle_Regular ;_ddbb :=_acd (_cfg .BAttr );
_cda :=_acd (_cfg .IAttr );if _ddbb &&_cda {_abc =_f .FontStyle_BoldItalic ;}else if _ddbb {_abc =_f .FontStyle_Bold ;}else if _cda {_abc =_f .FontStyle_Italic ;};_gddg =_cfg .UAttr !=_ca .ST_TextUnderlineTypeUnset &&_cfg .UAttr !=_ca .ST_TextUnderlineTypeNone ;
_efca :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _adbf :=_cfg .Latin ;_adbf !=nil {_efca =_adbf .TypefaceAttr ;}else if _abg :=_cfg .Ea ;_abg !=nil {_efca =_abg .TypefaceAttr ;}else if _ffb :=_cfg .Cs ;_ffb !=nil {_efca =_ffb .TypefaceAttr ;}else if _ggec :=_cfg .Sym ;
_ggec !=nil {_efca =_ggec .TypefaceAttr ;};if _gfa ,_cgge :=_f .StdFontsMap [_efca ];_cgge {_dbbad .Font =_f .AssignStdFontByName (_dbbad ,_gfa [_abc ]);}else if _gbgd :=_f .GetRegisteredFont (_efca ,_abc );_gbgd !=nil {_dbbad .Font =_gbgd ;}else {_ed .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_efca ,_abc );
_dbbad .Font =_f .AssignStdFontByName (_dbbad ,_f .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_abc ]);};var _dce float64 ;if _eecd :=_cfg .SzAttr ;_eecd !=nil {_dce =_cc .Round (float64 (*_eecd )/100)-0.5;}else {_dce =_f .DefaultFontSize ;};
if _bcee :=_cfg .BaselineAttr ;_bcee !=nil {if _fcgae :=_bcee .ST_PercentageDecimal ;_fcgae !=nil {if *_fcgae > 0{_cage =true ;}else if *_fcgae < 0{_edca =true ;};};};if _cage ||_edca {_dce =_cc .Round (_dce *0.64);};_dbbad .FontSize =_dce ;_bge :=0.0;
if _dfdc :=_cfg .SpcAttr ;_dfdc !=nil {if _degf :=_dfdc .ST_TextPointUnqualified ;_degf !=nil &&*_degf > 0{_bge =float64 (*_degf )/100;};};_dbbad .CharSpacing =_bge ;};return &_dbbad ,_cage ,_edca ,_gddg ;};func (_ceaac *convertContext )getPhData (_cbeb *_bf .CT_Shape )(*_ca .CT_Transform2D ,*_ca .CT_TextBodyProperties ,*_ca .CT_TextListStyle ,bool ,bool ,bool ){_ffdb ,_cgdc :=_dada (_cbeb );
_effd ,_aebd ,_bdcg ,_dcbaa ,_baae :=_gfff (_ceaac ._eba .CSld ,_ffdb ,_cgdc );_degd ,_degg ,_ebfb ,_cbgc ,_dfdd :=_gfff (_ceaac ._fgdf .CSld ,_ffdb ,_cgdc );if _degd ==nil {_degd =_effd ;};_cfef ,_fffe :=_ccbef (_degg ,_aebd );var _dcca ,_bdbc ,_agfe bool ;
if _ebfb ==nil {if _bdcg !=nil {_dcca =*_bdcg ;};}else {_dcca =*_ebfb ;};if _dfdd ==nil {if _baae !=nil {_agfe =*_baae ;};}else {_agfe =*_dfdd ;};if _cbgc ==nil {if _dcbaa !=nil {_bdbc =*_dcbaa ;};}else {_bdbc =*_cbgc ;};return _degd ,_cfef ,_fffe ,_dcca ,_bdbc ,_agfe ;
};func (_cgeg *convertContext )renderPageWithDrawableToGoImage (_ddgcb _bg .Drawable )(_cg .Image ,error ){_cbgd :=_f .MakeTempCreator (_cgeg ._ccc ,_cgeg ._cgf );_cbgd .NewPage ();_cbgd .Draw (_ddgcb );_cabd ,_fade :=_f .GetPageFromCreator (_cbgd );if _fade !=nil {return nil ,_fade ;
};return _bd .NewImageDevice ().Render (_cabd );};func (_dgdf *textboxContext )alignParagraphsVertically (_dccb _ca .ST_TextAnchoringType ){if _dccb ==_ca .ST_TextAnchoringTypeT {return ;};_cefg :=0.0;for _ ,_bdeb :=range _dgdf ._gaf {_cefg +=_bdeb ._efbe +_bdeb ._dfcc +_bdeb ._dbdg ;
};var _daeff float64 ;switch _dccb {case _ca .ST_TextAnchoringTypeCtr :_daeff =(_dgdf ._aceaf -_cefg )/2;case _ca .ST_TextAnchoringTypeB :_daeff =_dgdf ._aceaf -_cefg ;};for _ ,_deda :=range _dgdf ._gaf {_deda ._cfbee +=_daeff ;};};func (_eggd *convertContext )getStyleColors (_aacb *_ca .CT_ShapeStyle )(_bg .Color ,_bg .Color ,_bg .Color ){var _dadc ,_adfb ,_fbec _bg .Color ;
if _agca :=_aacb .LnRef ;_agca !=nil {_adfb =_eggd .getColorFromMatrixReference (_agca );};if _bebd :=_aacb .FillRef ;_bebd !=nil {_fbec =_eggd .getColorFromMatrixReference (_bebd );};if _ccaeb :=_aacb .FontRef ;_ccaeb !=nil {_dadc =_eggd .getColorFromFontReference (_ccaeb );
};return _dadc ,_fbec ,_adfb ;};func _ffee (_aagd *_ca .CT_TableCellProperties ,_eafcg *_ca .CT_TableStyleCellStyle ,_fgdfd ,_ffef ,_fgc ,_edaa bool )*_ca .CT_TableCellProperties {_ecaf :=_ca .NewCT_TableCellProperties ();if _aagd !=nil {*_ecaf =*_aagd ;
};if _eafcg ==nil {return _ecaf ;};if _fcac :=_eafcg .ThemeableFillStyleChoice .FillRef ;_fcac !=nil {_fage :=_ca .NewCT_SolidColorFillProperties ();_fage .ScrgbClr =_fcac .ScrgbClr ;_fage .SrgbClr =_fcac .SrgbClr ;_fage .HslClr =_fcac .HslClr ;_fage .SysClr =_fcac .SysClr ;
_fage .SchemeClr =_fcac .SchemeClr ;_fage .PrstClr =_fcac .PrstClr ;_ecaf .FillPropertiesChoice .SolidFill =_fage ;};if _ecaf .FillPropertiesChoice .NoFill ==nil &&_ecaf .FillPropertiesChoice .SolidFill ==nil {if _edcae :=_eafcg .ThemeableFillStyleChoice .Fill ;
_edcae !=nil {if _ecaf .FillPropertiesChoice .NoFill ==nil {_ecaf .FillPropertiesChoice .NoFill =_edcae .FillPropertiesChoice .NoFill ;};if _ecaf .FillPropertiesChoice .SolidFill ==nil {_ecaf .FillPropertiesChoice .SolidFill =_edcae .FillPropertiesChoice .SolidFill ;
};};};if _dgea :=_eafcg .TcBdr ;_dgea !=nil {if _ecaf .LnL ==nil {var _ggcc *_ca .CT_ThemeableLineStyle ;if _fgc {_ggcc =_dgea .Left ;}else {_ggcc =_dgea .InsideV ;};if _ggcc !=nil {_ecaf .LnL =_ggcc .ThemeableLineStyleChoice .Ln ;};};if _ecaf .LnR ==nil {var _ebdfd *_ca .CT_ThemeableLineStyle ;
if _edaa {_ebdfd =_dgea .Right ;}else {_ebdfd =_dgea .InsideV ;};if _ebdfd !=nil {_ecaf .LnR =_ebdfd .ThemeableLineStyleChoice .Ln ;};};if _ecaf .LnT ==nil {var _ebaf *_ca .CT_ThemeableLineStyle ;if _fgdfd {_ebaf =_dgea .Top ;}else {_ebaf =_dgea .InsideH ;
};if _ebaf !=nil {_ecaf .LnT =_ebaf .ThemeableLineStyleChoice .Ln ;};};if _ecaf .LnB ==nil {var _addf *_ca .CT_ThemeableLineStyle ;if _ffef {_addf =_dgea .Bottom ;}else {_addf =_dgea .InsideH ;};if _addf !=nil {_ecaf .LnB =_addf .ThemeableLineStyleChoice .Ln ;
};};};return _ecaf ;};type background struct{_dbf _bg .Color ;_faec float64 ;_abga *_ca .CT_BlipFillProperties ;};func _ebgb (_bbbg ,_ebec *_ca .CT_TextListStyle )*_ca .CT_TextListStyle {_deac :=_ca .NewCT_TextListStyle ();if _bbbg !=nil {*_deac =*_bbbg ;
};if _ebec ==nil {return _deac ;};_deac .DefPPr =_dede (_deac .DefPPr ,_ebec .DefPPr );_deac .Lvl1pPr =_dede (_deac .Lvl1pPr ,_ebec .Lvl1pPr );_deac .Lvl2pPr =_dede (_deac .Lvl2pPr ,_ebec .Lvl2pPr );_deac .Lvl3pPr =_dede (_deac .Lvl3pPr ,_ebec .Lvl3pPr );
_deac .Lvl4pPr =_dede (_deac .Lvl4pPr ,_ebec .Lvl4pPr );_deac .Lvl5pPr =_dede (_deac .Lvl5pPr ,_ebec .Lvl5pPr );_deac .Lvl6pPr =_dede (_deac .Lvl6pPr ,_ebec .Lvl6pPr );_deac .Lvl7pPr =_dede (_deac .Lvl7pPr ,_ebec .Lvl7pPr );_deac .Lvl8pPr =_dede (_deac .Lvl8pPr ,_ebec .Lvl8pPr );
_deac .Lvl9pPr =_dede (_deac .Lvl9pPr ,_ebec .Lvl9pPr );return _deac ;};func (_baeg *convertContext )getBorderStyle (_ddge *_ca .CT_LineProperties )(_bg .CellBorderStyle ,*_bg .Color ,float64 ){if _ddge ==nil ||_ddge .LineFillPropertiesChoice .NoFill !=nil {return _bg .CellBorderStyleNone ,nil ,0;
};var _gee _bg .Color ;if _gcc :=_ddge .LineFillPropertiesChoice .SolidFill ;_gcc !=nil {_gee ,_ =_baeg .getColorFromSolidFill (_gcc );};_cee :=0.0;if _ddgb :=_ddge .WAttr ;_ddgb !=nil {_cee =_fd .FromEMU (int64 (*_ddgb ));};return _bg .CellBorderStyleSingle ,&_gee ,_cee ;
};func _adgfe (_dbbda ,_edd *_ca .CT_TablePartStyle )*_ca .CT_TablePartStyle {_ggdc :=_ca .NewCT_TablePartStyle ();if _dbbda !=nil {*_ggdc =*_dbbda ;};if _edd ==nil {return _ggdc ;};if _ggdc .TcTxStyle ==nil {_ggdc .TcTxStyle =_edd .TcTxStyle ;}else {_ggdc .TcTxStyle =_ffgb (_ggdc .TcTxStyle ,_edd .TcTxStyle );
};if _ggdc .TcStyle ==nil {_ggdc .TcStyle =_edd .TcStyle ;}else {_ggdc .TcStyle =_gdfe (_ggdc .TcStyle ,_edd .TcStyle );};return _ggdc ;};func _ffgb (_cddc ,_aeba *_ca .CT_TableStyleTextStyle )*_ca .CT_TableStyleTextStyle {_bece :=_ca .NewCT_TableStyleTextStyle ();
if _cddc !=nil {*_bece =*_cddc ;};if _aeba ==nil {return _bece ;};if _bece .BAttr ==_ca .ST_OnOffStyleTypeUnset {_bece .BAttr =_aeba .BAttr ;};if _bece .IAttr ==_ca .ST_OnOffStyleTypeUnset {_bece .IAttr =_aeba .IAttr ;};if _bece .ThemeableFontStylesChoice .Font ==nil {_bece .ThemeableFontStylesChoice .Font =_aeba .ThemeableFontStylesChoice .Font ;
};if _bece .ThemeableFontStylesChoice .FontRef ==nil {_bece .ThemeableFontStylesChoice .FontRef =_aeba .ThemeableFontStylesChoice .FontRef ;};if _bece .ScrgbClr ==nil {_bece .ScrgbClr =_aeba .ScrgbClr ;};if _bece .SrgbClr ==nil {_bece .SrgbClr =_aeba .SrgbClr ;
};if _bece .HslClr ==nil {_bece .HslClr =_aeba .HslClr ;};if _bece .SysClr ==nil {_bece .SysClr =_aeba .SysClr ;};if _bece .SchemeClr ==nil {_bece .SchemeClr =_aeba .SchemeClr ;};if _bece .PrstClr ==nil {_bece .PrstClr =_aeba .PrstClr ;};return _bece ;
};func _cbfg (_cfea ,_edgg *_ca .CT_TextCharacterProperties )*_ca .CT_TextCharacterProperties {_ccba :=_ca .NewCT_TextCharacterProperties ();if _cfea !=nil {*_ccba =*_cfea ;};if _edgg ==nil {return _ccba ;};if _ccba .KumimojiAttr ==nil {_ccba .KumimojiAttr =_edgg .KumimojiAttr ;
};if _ccba .LangAttr ==nil {_ccba .LangAttr =_edgg .LangAttr ;};if _ccba .AltLangAttr ==nil {_ccba .AltLangAttr =_edgg .AltLangAttr ;};if _ccba .SzAttr ==nil {_ccba .SzAttr =_edgg .SzAttr ;};if _ccba .BAttr ==nil {_ccba .BAttr =_edgg .BAttr ;};if _ccba .IAttr ==nil {_ccba .IAttr =_edgg .IAttr ;
};if _ccba .UAttr ==_ca .ST_TextUnderlineTypeUnset {_ccba .UAttr =_edgg .UAttr ;};if _ccba .StrikeAttr ==_ca .ST_TextStrikeTypeUnset {_ccba .StrikeAttr =_edgg .StrikeAttr ;};if _ccba .KernAttr ==nil {_ccba .KernAttr =_edgg .KernAttr ;};if _ccba .CapAttr ==_ca .ST_TextCapsTypeUnset {_ccba .CapAttr =_edgg .CapAttr ;
};if _ccba .SpcAttr ==nil {_ccba .SpcAttr =_edgg .SpcAttr ;};if _ccba .NormalizeHAttr ==nil {_ccba .NormalizeHAttr =_edgg .NormalizeHAttr ;};if _ccba .BaselineAttr ==nil {_ccba .BaselineAttr =_edgg .BaselineAttr ;};if _ccba .NoProofAttr ==nil {_ccba .NoProofAttr =_edgg .NoProofAttr ;
};if _ccba .DirtyAttr ==nil {_ccba .DirtyAttr =_edgg .DirtyAttr ;};if _ccba .ErrAttr ==nil {_ccba .ErrAttr =_edgg .ErrAttr ;};if _ccba .SmtCleanAttr ==nil {_ccba .SmtCleanAttr =_edgg .SmtCleanAttr ;};if _ccba .SmtIdAttr ==nil {_ccba .SmtIdAttr =_edgg .SmtIdAttr ;
};if _ccba .BmkAttr ==nil {_ccba .BmkAttr =_edgg .BmkAttr ;};if _ccba .Ln ==nil {_ccba .Ln =_edgg .Ln ;};if _ccba .FillPropertiesChoice .NoFill ==nil {_ccba .FillPropertiesChoice .NoFill =_edgg .FillPropertiesChoice .NoFill ;};if _ccba .FillPropertiesChoice .SolidFill ==nil {_ccba .FillPropertiesChoice .SolidFill =_edgg .FillPropertiesChoice .SolidFill ;
};if _ccba .FillPropertiesChoice .BlipFill ==nil {_ccba .FillPropertiesChoice .BlipFill =_edgg .FillPropertiesChoice .BlipFill ;};if _ccba .EffectPropertiesChoice .EffectLst ==nil {_ccba .EffectPropertiesChoice .EffectLst =_edgg .EffectPropertiesChoice .EffectLst ;
};if _ccba .EffectPropertiesChoice .EffectDag ==nil {_ccba .EffectPropertiesChoice .EffectDag =_edgg .EffectPropertiesChoice .EffectDag ;};if _ccba .Highlight ==nil {_ccba .Highlight =_edgg .Highlight ;};if _ccba .TextUnderlineLineChoice .ULnTx ==nil {_ccba .TextUnderlineLineChoice .ULnTx =_edgg .TextUnderlineLineChoice .ULnTx ;
};if _ccba .TextUnderlineLineChoice .ULn ==nil {_ccba .TextUnderlineLineChoice .ULn =_edgg .TextUnderlineLineChoice .ULn ;};if _ccba .TextUnderlineFillChoice .UFillTx ==nil {_ccba .TextUnderlineFillChoice .UFillTx =_edgg .TextUnderlineFillChoice .UFillTx ;
};if _ccba .TextUnderlineFillChoice .UFill ==nil {_ccba .TextUnderlineFillChoice .UFill =_edgg .TextUnderlineFillChoice .UFill ;};if _ccba .Latin ==nil {_ccba .Latin =_edgg .Latin ;};if _ccba .Ea ==nil {_ccba .Ea =_edgg .Ea ;};if _ccba .Cs ==nil {_ccba .Cs =_edgg .Cs ;
};if _ccba .Sym ==nil {_ccba .Sym =_edgg .Sym ;};if _ccba .Rtl ==nil {_ccba .Rtl =_edgg .Rtl ;};return _ccba ;};func (_cbed *convertContext )renderCurrentStateToGoImage ()(_cg .Image ,error ){_gaebc :=_f .MakeTempCreator (_cbed ._ccc ,_cbed ._cgf );_gaebc .NewPage ();
for _ ,_cdgf :=range _cbed ._bfe {if _cdgf !=nil {_gaebc .MoveTo (0,0);_gaebc .Draw (_cdgf );};};_fded ,_befd :=_f .GetPageFromCreator (_gaebc );if _befd !=nil {return nil ,_befd ;};return _bd .NewImageDevice ().Render (_fded );};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_gg .Presentation )*_bg .Creator {return ConvertToPdfWithOptions (pr ,nil )};func _dfa (_geb *_ca .CT_TextCharacterProperties ,_agbd *_ca .CT_TableStyleTextStyle )*_ca .CT_TextCharacterProperties {_bfbb :=_ca .NewCT_TextCharacterProperties ();
if _geb !=nil {*_bfbb =*_geb ;};if _agbd ==nil {return _bfbb ;};if _bfbb .BAttr ==nil &&_agbd .BAttr !=_ca .ST_OnOffStyleTypeUnset {_egab :=_agbd .BAttr ==_ca .ST_OnOffStyleTypeOn ;_bfbb .BAttr =&_egab ;};if _bfbb .IAttr ==nil &&_agbd .IAttr !=_ca .ST_OnOffStyleTypeUnset {_cfedd :=_agbd .IAttr ==_ca .ST_OnOffStyleTypeOn ;
_bfbb .IAttr =&_cfedd ;};if _bfbb .FillPropertiesChoice .NoFill ==nil &&_bfbb .FillPropertiesChoice .SolidFill ==nil {_bfbb .FillPropertiesChoice .SolidFill =_ca .NewCT_SolidColorFillProperties ();_bfbb .FillPropertiesChoice .SolidFill .ScrgbClr =_agbd .ScrgbClr ;
_bfbb .FillPropertiesChoice .SolidFill .SrgbClr =_agbd .SrgbClr ;_bfbb .FillPropertiesChoice .SolidFill .HslClr =_agbd .HslClr ;_bfbb .FillPropertiesChoice .SolidFill .SysClr =_agbd .SysClr ;_bfbb .FillPropertiesChoice .SolidFill .SchemeClr =_agbd .SchemeClr ;
_bfbb .FillPropertiesChoice .SolidFill .PrstClr =_agbd .PrstClr ;};if _bbac :=_agbd .ThemeableFontStylesChoice .Font ;_bbac !=nil &&_bfbb .Latin ==nil &&_bfbb .Ea ==nil &&_bfbb .Cs ==nil {_bfbb .Latin =_bbac .Latin ;_bfbb .Ea =_bbac .Ea ;_bfbb .Cs =_bbac .Cs ;
};return _bfbb ;};func _ebdf (_gbf float64 )float64 {return _gbf *_fd .Millimeter };func (_aeb *convertContext )makePdfDivisionFromTxBody (_fba *_ca .CT_TextBody ,_bga *_ca .CT_TableStyleTextStyle )*_bg .Division {_bcd :=_aeb ._gcaa .NewDivision ();_agd :=_aeb ._bebfg ;
_bbg :=_ca .ST_TextAnchoringTypeT ;if _beac :=_fba .BodyPr ;_beac !=nil {if _dage :=_beac .AnchorAttr ;_dage !=_ca .ST_TextAnchoringTypeUnset {_bbg =_beac .AnchorAttr ;};};if _cfa :=_fba .LstStyle ;_cfa !=nil {var _fcc *_ca .CT_TextParagraphProperties ;
if _cfa .Lvl1pPr !=nil {_fcc =_cfa .Lvl1pPr ;}else {_fcc =_aeb ._bfea [0];};_agd =_dede (_fcc ,_dede (_cfa .DefPPr ,_agd ));};for _ ,_gdf :=range _fba .P {if _gdf !=nil {_dea :=_aeb ._gcaa .NewStyledParagraph ();_daea :=_dede (_gdf .PPr ,_agd );_bdd :=_cbfg (_gdf .EndParaRPr ,_daea .DefRPr );
switch _daea .AlgnAttr {case _ca .ST_TextAlignTypeR :_dea .SetTextAlignment (_bg .TextAlignmentRight );case _ca .ST_TextAlignTypeCtr :_dea .SetTextAlignment (_bg .TextAlignmentCenter );case _ca .ST_TextAlignTypeJust :_dea .SetTextAlignment (_bg .TextAlignmentJustify );
};if len (_gdf .EG_TextRun )==0{_dea .Append ("\u000a");_bcd .Add (_dea );continue ;};for _ ,_gfbd :=range _gdf .EG_TextRun {if _bfbd :=_gfbd .TextRunChoice .Br ;_bfbd !=nil {_dea .Append ("\u000a");}else if _ccgd :=_gfbd .TextRunChoice .R ;_ccgd !=nil {_gad :=_dfa (_ccgd .RPr ,_bga );
_gad =_cbfg (_gad ,_bdd );var _bcdg _bg .Color ;if _gad .FillPropertiesChoice .SolidFill !=nil {_bcdg ,_ =_aeb .getColorFromSolidFill (_gad .FillPropertiesChoice .SolidFill );}else {_bcdg =_bg .ColorBlack ;};_ged ,_ffa ,_gbb ,_ :=_aeb .makeStyleFromRPr (_gad );
_ged .Color =_bcdg ;if _ffa {_ged .TextRise =0.5;}else if _gbb {_ged .TextRise =-0.5;};_fde :=_ccgd .T ;if _gad .CapAttr ==_ca .ST_TextCapsTypeAll {for _ ,_aac :=range _fde {_aac =[]rune (_b .ToUpper (string (_aac )))[0];};};_bebf :=_dea .Append (_fde );
_bebf .Style =*_ged ;};};_ =_bbg ;_bcd .Add (_dea );};};return _bcd ;};func (_eeg *convertContext )tileImage (_dgf *_bg .Image ,_dc *_ca .CT_TileInfoProperties ,_ggf ,_faf float64 )*_bg .Image {_gfec ,_eg :=1.0,1.0;if _efe :=_dc .SxAttr ;_efe !=nil {_gfec =_f .FromSTPercentage (_efe );
};if _ccb :=_dc .SyAttr ;_ccb !=nil {_eg =_f .FromSTPercentage (_ccb );};_dbba :=_f .MakeTempCreator (_ggf ,_faf );_dgf .Scale (_gfec ,_eg );_efa ,_de :=_dgf .Width (),_dgf .Height ();var _bcag ,_dfd float64 ;if _bgc :=_dc .TxAttr ;_bgc !=nil {_bcag =_fd .FromEMU (_f .FromSTCoordinate (*_bgc ));
};if _dcb :=_dc .TyAttr ;_dcb !=nil {_dfd =_fd .FromEMU (_f .FromSTCoordinate (*_dcb ));};if _bcag > 0{_bcag -=_efa ;};if _dfd > 0{_dfd -=_de ;};_eebc :=_eeg ._ccc /_efa +1;_bbcd :=_eeg ._cgf /_de +1;for _ead :=0.0;_ead <=_eebc ;_ead ++{_ded :=_ead *_efa ;
for _cdgb :=0.0;_cdgb <=_bbcd ;_cdgb ++{_ccg :=_cdgb *_de ;_dgf .SetPos (_ded +_bcag ,_ccg +_dfd );_dbba .Draw (_dgf );};};_ecdb ,_fefb :=_f .GetPageFromCreator (_dbba );if _fefb !=nil {_ed .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_fefb );
return nil ;};_afe ,_fefb :=_bd .NewImageDevice ().Render (_ecdb );if _fefb !=nil {_ed .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_fefb );return nil ;};
_fca ,_fefb :=_eeg ._gcaa .NewImageFromGoImage (_afe );if _fefb !=nil {_ed .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_fefb );
return nil ;};return _fca ;};func _fdde (_ddgc int ,_daef bool )string {_aeg :=(_ddgc -1)/26+1;_dbbb :=byte ((_ddgc -1)%26);if _daef {_dbbb +=byte (65);}else {_dbbb +=byte (97);};_feg :=_d .NewBuffer ([]byte {});for _dcd :=0;_dcd < _aeg ;_dcd ++{_feg .Write ([]byte {_dbbb });
};return _feg .String ();};func _dede (_beafa ,_bbfa *_ca .CT_TextParagraphProperties )*_ca .CT_TextParagraphProperties {_aade :=_ca .NewCT_TextParagraphProperties ();if _beafa !=nil {*_aade =*_beafa ;};if _bbfa ==nil {return _aade ;};if _aade .MarLAttr ==nil {_aade .MarLAttr =_bbfa .MarLAttr ;
};if _aade .MarRAttr ==nil {_aade .MarRAttr =_bbfa .MarRAttr ;};if _aade .LvlAttr ==nil {_aade .LvlAttr =_bbfa .LvlAttr ;};if _aade .IndentAttr ==nil {_aade .IndentAttr =_bbfa .IndentAttr ;};if _aade .AlgnAttr ==_ca .ST_TextAlignTypeUnset {_aade .AlgnAttr =_bbfa .AlgnAttr ;
};if _aade .DefTabSzAttr ==nil {_aade .DefTabSzAttr =_bbfa .DefTabSzAttr ;};if _aade .RtlAttr ==nil {_aade .RtlAttr =_bbfa .RtlAttr ;};if _aade .EaLnBrkAttr ==nil {_aade .EaLnBrkAttr =_bbfa .EaLnBrkAttr ;};if _aade .FontAlgnAttr ==_ca .ST_TextFontAlignTypeUnset {_aade .FontAlgnAttr =_bbfa .FontAlgnAttr ;
};if _aade .LatinLnBrkAttr ==nil {_aade .LatinLnBrkAttr =_bbfa .LatinLnBrkAttr ;};if _aade .HangingPunctAttr ==nil {_aade .HangingPunctAttr =_bbfa .HangingPunctAttr ;};if _aade .LnSpc ==nil {_aade .LnSpc =_bbfa .LnSpc ;};if _aade .SpcBef ==nil {_aade .SpcBef =_bbfa .SpcBef ;
};if _aade .SpcAft ==nil {_aade .SpcAft =_bbfa .SpcAft ;};if _aade .TextBulletColorChoice .BuClrTx ==nil {_aade .TextBulletColorChoice .BuClrTx =_bbfa .TextBulletColorChoice .BuClrTx ;};if _aade .TextBulletColorChoice .BuClr ==nil {_aade .TextBulletColorChoice .BuClr =_bbfa .TextBulletColorChoice .BuClr ;
};if _aade .TextBulletSizeChoice .BuSzTx ==nil {_aade .TextBulletSizeChoice .BuSzTx =_bbfa .TextBulletSizeChoice .BuSzTx ;};if _aade .TextBulletSizeChoice .BuSzPct ==nil {_aade .TextBulletSizeChoice .BuSzPct =_bbfa .TextBulletSizeChoice .BuSzPct ;};if _aade .TextBulletSizeChoice .BuSzPts ==nil {_aade .TextBulletSizeChoice .BuSzPts =_bbfa .TextBulletSizeChoice .BuSzPts ;
};if _aade .TextBulletTypefaceChoice .BuFontTx ==nil {_aade .TextBulletTypefaceChoice .BuFontTx =_bbfa .TextBulletTypefaceChoice .BuFontTx ;};if _aade .TextBulletTypefaceChoice .BuFont ==nil {_aade .TextBulletTypefaceChoice .BuFont =_bbfa .TextBulletTypefaceChoice .BuFont ;
};if _aade .TextBulletChoice .BuNone ==nil {_aade .TextBulletChoice .BuNone =_bbfa .TextBulletChoice .BuNone ;};if _aade .TextBulletChoice .BuAutoNum ==nil {_aade .TextBulletChoice .BuAutoNum =_bbfa .TextBulletChoice .BuAutoNum ;};if _aade .TextBulletChoice .BuChar ==nil {_aade .TextBulletChoice .BuChar =_bbfa .TextBulletChoice .BuChar ;
};if _aade .TextBulletChoice .BuBlip ==nil {_aade .TextBulletChoice .BuBlip =_bbfa .TextBulletChoice .BuBlip ;};if _aade .TabLst ==nil {_aade .TabLst =_bbfa .TabLst ;};if _aade .ExtLst ==nil {_aade .ExtLst =_bbfa .ExtLst ;};_aade .DefRPr =_cbfg (_aade .DefRPr ,_bbfa .DefRPr );
return _aade ;};func _gfff (_bfed *_bf .CT_CommonSlideData ,_fffa _bf .ST_PlaceholderType ,_affe *uint32 )(*_ca .CT_Transform2D ,*_ca .CT_TextBody ,*bool ,*bool ,*bool ){_bdcb :=_affe ==nil ;if _bfed !=nil &&(_fffa !=_bf .ST_PlaceholderTypeUnset ||!_bdcb ){if _ccag :=_bfed .SpTree ;
_ccag !=nil {for _ ,_gdga :=range _ccag .GroupShapeChoice {if _gdga !=nil {if _gdga .Sp !=nil {_aagc ,_aefb :=_dada (_gdga .Sp );if _fffa ==_aagc {if (_bdcb &&_aefb ==nil )||(!_bdcb &&_aefb !=nil &&*_aefb ==*_affe ){var _baabg *_ca .CT_Transform2D ;if _gdga .Sp .SpPr !=nil {_baabg =_gdga .Sp .SpPr .Xfrm ;
};_gbaac :=_fffa ==_bf .ST_PlaceholderTypeTitle ||_fffa ==_bf .ST_PlaceholderTypeCtrTitle ;_adce :=_fffa ==_bf .ST_PlaceholderTypeSubTitle ;_ccbb :=!_gbaac &&_fffa !=_bf .ST_PlaceholderTypeUnset ;return _baabg ,_gdga .Sp .TxBody ,&_gbaac ,&_adce ,&_ccbb ;
};};};};};};};return nil ,nil ,nil ,nil ,nil ;};func (_fbc *textboxContext )newLine (){if _fbc ._baab ==nil {_fbc .newParagraph ();};_gaee :=_fbc ._baab ._dfcc +_fbc ._baab ._efbe ;_dega :=&line {};_dega ._cbf =_fbc ._baab ._bde ;if len (_fbc ._baab ._cbc )==0{_dega ._cbf +=_fbc ._baab ._dbg ;
};_dega ._affc =_fbc ._baab ._dca ;_dega ._fdgd =_dega ._cbf ;_dega ._fgea =_gaee ;_fbc ._baab ._cbc =append (_fbc ._baab ._cbc ,_dega );_fbc ._dfff =_dega ;};func (_aage *convertContext )makePdfImageFromBlipFill (_fdc *_ca .CT_BlipFillProperties ,_agb bool )(*_bg .Image ,[]*_ca .CT_BlipChoice ,error ){if _bcage :=_fdc .Blip ;
_bcage !=nil {if _ebb :=_bcage .EmbedAttr ;_ebb !=nil {var _edab _dd .ImageRef ;var _gadg bool ;if _agb {_edab ,_gadg =_aage ._dgag .GetLayoutImageByRelID (*_ebb );}else {_edab ,_gadg =_aage ._dgag .GetImageByRelID (*_ebb );};if _gadg {_beddc ,_bfbde :=_da .Open (_edab .Path ());
if _bfbde !=nil {_ed .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_bfbde );return nil ,nil ,_bfbde ;};defer _beddc .Close ();_adec ,_ ,_bfbde :=_cg .Decode (_beddc );if _bfbde !=nil {_ed .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_bfbde );
return nil ,nil ,_bfbde ;};if _acfe :=_fdc .SrcRect ;_acfe !=nil {_edfc :=_adec .Bounds ().Size ();_efcg :=_edfc .X ;_aece :=_edfc .Y ;var _bcaa ,_effe ,_aecc ,_ccae int ;var _edbf bool ;if _baba :=_acfe .LAttr ;_baba !=nil {_bcaa =int (float64 (_efcg )*_f .FromSTPercentage (_baba ));
_edbf =true ;}else {_bcaa =0;};if _gage :=_acfe .TAttr ;_gage !=nil {_aecc =int (float64 (_aece )*_f .FromSTPercentage (_gage ));_edbf =true ;}else {_aecc =0;};if _acbe :=_acfe .RAttr ;_acbe !=nil {_effe =int (float64 (_efcg )*(1-_f .FromSTPercentage (_acbe )));
_edbf =true ;}else {_effe =_efcg ;};if _caba :=_acfe .BAttr ;_caba !=nil {_ccae =int (float64 (_aece )*(1-_f .FromSTPercentage (_caba )));_edbf =true ;}else {_ccae =_aece ;};if _edbf {_adec =_f .CropImageByRect (_adec ,_cg .Rect (_bcaa ,_aecc ,_effe +1,_ccae +1));
};};_bbd ,_bfbde :=_aage ._gcaa .NewImageFromGoImage (_adec );_bbd .SetEncoder (_cd .NewFlateEncoder ());if _b .ToLower (_edab .Format ())=="\u006a\u0070\u0067"||_b .ToLower (_edab .Format ())=="\u006a\u0070\u0065\u0067"{_bbd .SetEncoder (_cd .NewDCTEncoder ());
};if _bfbde !=nil {_ed .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_bfbde );
return nil ,nil ,_bfbde ;};return _bbd ,_bcage .BlipChoice ,nil ;};};};return nil ,nil ,nil ;};func (_aege *convertContext )applyBlipEffectsOnImg (_efbg *_bg .Image ,_bagec ,_gebg float64 ,_ddc []*_ca .CT_BlipChoice )*_bg .Image {if len (_ddc )==0{return _efbg ;
};_efbg .SetPos (_bagec ,_gebg );_fdbc ,_eeeg :=_aege .renderPageWithDrawableToGoImage (_efbg );if _eeeg !=nil {_ed .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_eeeg );
return _efbg ;};_abbc ,_eeeg :=_aege .renderCurrentStateToGoImage ();if _eeeg !=nil {_ed .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_eeeg );
return _efbg ;};_defa :=_fdbc .Bounds ();_aaab :=_cg .NewRGBA (_defa );_aaf ,_befe :=_efbg .Width (),_efbg .Height ();for _ ,_gcbc :=range _ddc {if _acbc :=_gcbc .AlphaModFix ;_acbc ==nil {continue ;};if _aecec :=_gcbc .AlphaModFix .AmtAttr ;_aecec !=nil {if _bcgf :=_aecec .ST_PositivePercentageDecimal ;
_bcgf !=nil {_fgbb :=uint8 (255*(*_bcgf )/100000);_gacd :=_cg .NewUniform (_a .Alpha {_fgbb });_c .Draw (_aaab ,_defa ,_abbc ,_cg .Point {0,0},_c .Src );_c .DrawMask (_aaab ,_defa ,_fdbc ,_cg .Point {0,0},_gacd ,_cg .Point {0,0},_c .Over );};};};_afbc :=_cg .Rect (int (_bagec ),int (_gebg ),int (_bagec +_aaf )+1,int (_gebg +_befe )+1);
_afbb :=_f .CropImageByRect (_aaab ,_afbc );_ggb ,_eeeg :=_aege ._gcaa .NewImageFromGoImage (_afbb );if _eeeg !=nil {_ed .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_eeeg );
return _efbg ;};return _ggb ;};