//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_bb "bytes";_eg "errors";_bbd "github.com/unidoc/unioffice/v2/common";_fd "github.com/unidoc/unioffice/v2/common/logger";_cd "github.com/unidoc/unioffice/v2/common/tempstorage";_ef "github.com/unidoc/unioffice/v2/internal/convertutils";
_d "github.com/unidoc/unioffice/v2/measurement";_aa "github.com/unidoc/unioffice/v2/presentation";_bba "github.com/unidoc/unioffice/v2/schema/soo/dml";_cb "github.com/unidoc/unioffice/v2/schema/soo/dml/chart";_aac "github.com/unidoc/unioffice/v2/schema/soo/pml";
_g "github.com/unidoc/unipdf/v4/contentstream/draw";_ce "github.com/unidoc/unipdf/v4/core";_dc "github.com/unidoc/unipdf/v4/creator";_bc "github.com/unidoc/unipdf/v4/model";_de "github.com/unidoc/unipdf/v4/render";_c "image";_b "image/color";_a "image/draw";
_cg "math";_f "strconv";_bf "strings";);func (_fgd *textboxContext )alignVertically (_ecgd _bba .ST_TextAnchoringType ){_fgd .alignParagraphsVertically (_ecgd );_fgd .alignSymbolsVertically ();};

// ConvertToPdfWithOptions convert a presentation to PDF with given options.
func ConvertToPdfWithOptions (pr *_aa .Presentation ,opts *Options )*_dc .Creator {_feg :=pr .X ().SldSz ;_efa :=_d .FromEMU (int64 (_feg .CxAttr ));_baf :=_d .FromEMU (int64 (_feg .CyAttr ));_ge :=_dc .PageSize {_efa ,_baf };if (_ge ==_dc .PageSize {}){_ge =_ef .GetDefaultPageSize ();
if opts !=nil &&opts .DefaultPageSize !=_ef .DefaultPageSize {_ge =_ef .GetPageDimensions (opts .DefaultPageSize );};};_af :=_dc .New ();_af .SetPageSize (_ge );var _egc *_bba .Theme ;if len (pr .Themes ())> 0{_egc =pr .Themes ()[0];};for _ ,_afb :=range pr .Slides (){if _afb .X ()==nil {continue ;
};_gb :=&convertContext {_fefe :_af ,_ffca :&_afb ,_egdc :_afb .GetSlideLayout (),_aadf :pr .SlideMasters ()[0].X (),_eebg :pr ,_dcee :_egc ,_dfd :_afb .X ().ClrMapOvr ,_bae :_ge [1],_aaab :_ge [0]};_gb .extractDefaultProperties ();_gb .makeSlide ();_gb .drawSlide ();
};return _af ;};type word struct{_afae []*symbol ;_gbbg float64 ;_gga float64 ;_abbb bool ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_agff *textboxContext )alignParagraph (){_fbfd :=_agff ._gcfd ;
if _fbfd ._ebbc ==_bba .ST_TextAlignTypeL {return ;};_dae :=len (_fbfd ._ega )-1;for _gefgf ,_bbaeg :=range _fbfd ._ega {_ecaa :=true ;_fbcb :=len (_bbaeg ._fbfc );_acgc :=0.0;for _afda :=len (_bbaeg ._fbfc )-1;_afda >=0;_afda --{_gded :=_bbaeg ._fbfc [_afda ];
if _ecaa &&_gded ._abbb {_fbcb =_afda ;}else {_ecaa =false ;for _ ,_cdd :=range _gded ._afae {_acgc +=_cdd ._gbeg ;};};};_bbaeg ._fbfc =_bbaeg ._fbfc [:_fbcb ];_gbfa :=_bbaeg ._aga -_bbaeg ._ggc -_acgc ;switch _fbfd ._ebbc {case _bba .ST_TextAlignTypeR :_bbaeg .moveRight (_gbfa );
case _bba .ST_TextAlignTypeCtr :_bbaeg .moveRight (_gbfa /2);case _bba .ST_TextAlignTypeJust :if _gefgf !=_dae {_aaeda :=[]*word {};for _ ,_cefb :=range _bbaeg ._fbfc {if _cefb ._abbb {_aaeda =append (_aaeda ,_cefb );};};_feee :=_gbfa /float64 (len (_aaeda ));
for _ ,_ddf :=range _aaeda {_ddf ._gga +=_feee ;};var _gdb *word ;for _ ,_ccb :=range _bbaeg ._fbfc {if _gdb !=nil {_ccb ._gbbg =_gdb ._gbbg +_gdb ._gga ;};_gdb =_ccb ;};};};};};func (_fgcb *convertContext )makePdfImageFromBlipFill (_gffg *_bba .CT_BlipFillProperties ,_aeeg bool )(*_dc .Image ,[]*_bba .CT_BlipChoice ,error ){if _aecb :=_gffg .Blip ;
_aecb !=nil {if _dcdf :=_aecb .EmbedAttr ;_dcdf !=nil {var _fgeb _bbd .ImageRef ;var _gfge bool ;if _aeeg {_fgeb ,_gfge =_fgcb ._ffca .GetLayoutImageByRelID (*_dcdf );}else {_fgeb ,_gfge =_fgcb ._ffca .GetImageByRelID (*_dcdf );};if _gfge {_gcgdc ,_bccg :=_cd .Open (_fgeb .Path ());
if _bccg !=nil {_fd .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_bccg );return nil ,nil ,_bccg ;};defer _gcgdc .Close ();_gcdg ,_ ,_bccg :=_c .Decode (_gcgdc );if _bccg !=nil {_fd .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_bccg );
return nil ,nil ,_bccg ;};if _fcfc :=_gffg .SrcRect ;_fcfc !=nil {_aefa :=_gcdg .Bounds ().Size ();_cedab :=_aefa .X ;_dgfdg :=_aefa .Y ;var _fbbea ,_degc ,_bdbf ,_cdbe int ;var _ccbf bool ;if _ccggd :=_fcfc .LAttr ;_ccggd !=nil {_fbbea =int (float64 (_cedab )*_ef .FromSTPercentage (_ccggd ));
_ccbf =true ;}else {_fbbea =0;};if _cac :=_fcfc .TAttr ;_cac !=nil {_bdbf =int (float64 (_dgfdg )*_ef .FromSTPercentage (_cac ));_ccbf =true ;}else {_bdbf =0;};if _dea :=_fcfc .RAttr ;_dea !=nil {_degc =int (float64 (_cedab )*(1-_ef .FromSTPercentage (_dea )));
_ccbf =true ;}else {_degc =_cedab ;};if _cfg :=_fcfc .BAttr ;_cfg !=nil {_cdbe =int (float64 (_dgfdg )*(1-_ef .FromSTPercentage (_cfg )));_ccbf =true ;}else {_cdbe =_dgfdg ;};if _ccbf {_gcdg =_ef .CropImageByRect (_gcdg ,_c .Rect (_fbbea ,_bdbf ,_degc +1,_cdbe +1));
};};_acfbg ,_bccg :=_fgcb ._fefe .NewImageFromGoImage (_gcdg );_acfbg .SetEncoder (_ce .NewFlateEncoder ());if _bf .ToLower (_fgeb .Format ())=="\u006a\u0070\u0067"||_bf .ToLower (_fgeb .Format ())=="\u006a\u0070\u0065\u0067"{_acfbg .SetEncoder (_ce .NewDCTEncoder ());
};if _bccg !=nil {_fd .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_bccg );
return nil ,nil ,_bccg ;};return _acfbg ,_aecb .BlipChoice ,nil ;};};};return nil ,nil ,nil ;};func _bfee (_bedf *bool )bool {return _bedf !=nil &&*_bedf };func _ddag (_fddc *_aac .CT_Shape )(_aac .ST_PlaceholderType ,*uint32 ){if _gffcb :=_fddc .NvSpPr ;
_gffcb !=nil {if _gbac :=_gffcb .NvPr ;_gbac !=nil {if _ffcc :=_gbac .Ph ;_ffcc !=nil {return _ffcc .TypeAttr ,_ffcc .IdxAttr ;};};};return _aac .ST_PlaceholderTypeUnset ,nil ;};func (_cdcc *textboxContext )newLine (){if _cdcc ._gcfd ==nil {_cdcc .newParagraph ();
};_cgf :=_cdcc ._gcfd ._eggf +_cdcc ._gcfd ._dage ;_eec :=&line {};_eec ._ggc =_cdcc ._gcfd ._fcae ;if len (_cdcc ._gcfd ._ega )==0{_eec ._ggc +=_cdcc ._gcfd ._cdgf ;};_eec ._aga =_cdcc ._gcfd ._fbf ;_eec ._cfdgf =_eec ._ggc ;_eec ._bbfba =_cgf ;_cdcc ._gcfd ._ega =append (_cdcc ._gcfd ._ega ,_eec );
_cdcc ._acfd =_eec ;};func (_aeg *convertContext )makePdfDivisionFromTxBody (_aedd *_bba .CT_TextBody ,_fbc *_bba .CT_TableStyleTextStyle )*_dc .Division {_fdab :=_aeg ._fefe .NewDivision ();_beb :=_aeg ._fcgb ;_fcgdb :=_bba .ST_TextAnchoringTypeT ;if _eede :=_aedd .BodyPr ;
_eede !=nil {if _eaa :=_eede .AnchorAttr ;_eaa !=_bba .ST_TextAnchoringTypeUnset {_fcgdb =_eede .AnchorAttr ;};};if _gaadf :=_aedd .LstStyle ;_gaadf !=nil {var _acf *_bba .CT_TextParagraphProperties ;if _gaadf .Lvl1pPr !=nil {_acf =_gaadf .Lvl1pPr ;}else {_acf =_aeg ._dgg [0];
};_beb =_bdcg (_acf ,_bdcg (_gaadf .DefPPr ,_beb ));};for _ ,_ecbf :=range _aedd .P {if _ecbf !=nil {_cfb :=_aeg ._fefe .NewStyledParagraph ();_fcgc :=_bdcg (_ecbf .PPr ,_beb );_fdbe :=_bgba (_ecbf .EndParaRPr ,_fcgc .DefRPr );switch _fcgc .AlgnAttr {case _bba .ST_TextAlignTypeR :_cfb .SetTextAlignment (_dc .TextAlignmentRight );
case _bba .ST_TextAlignTypeCtr :_cfb .SetTextAlignment (_dc .TextAlignmentCenter );case _bba .ST_TextAlignTypeJust :_cfb .SetTextAlignment (_dc .TextAlignmentJustify );};if len (_ecbf .EG_TextRun )==0{_cfb .Append ("\u000a");_fdab .Add (_cfb );continue ;
};for _ ,_gbb :=range _ecbf .EG_TextRun {if _cdf :=_gbb .TextRunChoice .Br ;_cdf !=nil {_cfb .Append ("\u000a");}else if _ggdb :=_gbb .TextRunChoice .R ;_ggdb !=nil {_baff :=_ebae (_ggdb .RPr ,_fbc );_baff =_bgba (_baff ,_fdbe );var _eaac _dc .Color ;if _baff .FillPropertiesChoice .SolidFill !=nil {_eaac ,_ =_aeg .getColorFromSolidFill (_baff .FillPropertiesChoice .SolidFill );
}else {_eaac =_dc .ColorBlack ;};_gdc ,_ecbc ,_gaf ,_ :=_aeg .makeStyleFromRPr (_baff );_gdc .Color =_eaac ;if _ecbc {_gdc .TextRise =0.5;}else if _gaf {_gdc .TextRise =-0.5;};_ece :=_ggdb .T ;if _baff .CapAttr ==_bba .ST_TextCapsTypeAll {for _ ,_fgc :=range _ece {_fgc =[]rune (_bf .ToUpper (string (_fgc )))[0];
};};_bfd :=_cfb .Append (_ece );_bfd .Style =*_gdc ;};};_ =_fcgdb ;_fdab .Add (_cfb );};};return _fdab ;};type convertContext struct{_fefe *_dc .Creator ;_efec *_ef .Rectangle ;_eebg *_aa .Presentation ;_ffca *_aa .Slide ;_aadf *_aac .SldMaster ;_egdc *_aac .SldLayout ;
_bae float64 ;_aaab float64 ;_aeddc []_dc .Drawable ;_fegdf *background ;_fcgb *_bba .CT_TextParagraphProperties ;_dafc *_bba .CT_TextCharacterProperties ;_becd *_bba .CT_TextParagraphProperties ;_efg *_bba .CT_TextCharacterProperties ;_cgc *_bba .CT_TextParagraphProperties ;
_bedb *_bba .CT_TextCharacterProperties ;_dgg []*_bba .CT_TextParagraphProperties ;_gfc []*_bba .CT_TextParagraphProperties ;_bee []*_bba .CT_TextParagraphProperties ;_dcee *_bba .Theme ;_dfd *_bba .CT_ColorMappingOverride ;};func _dged (_dbgb ,_dcfe *_bba .CT_TablePartStyle )*_bba .CT_TablePartStyle {_gdba :=_bba .NewCT_TablePartStyle ();
if _dbgb !=nil {*_gdba =*_dbgb ;};if _dcfe ==nil {return _gdba ;};if _gdba .TcTxStyle ==nil {_gdba .TcTxStyle =_dcfe .TcTxStyle ;}else {_gdba .TcTxStyle =_gcdc (_gdba .TcTxStyle ,_dcfe .TcTxStyle );};if _gdba .TcStyle ==nil {_gdba .TcStyle =_dcfe .TcStyle ;
}else {_gdba .TcStyle =_eabcf (_gdba .TcStyle ,_dcfe .TcStyle );};return _gdba ;};type textboxContext struct{_cae *convertContext ;_fdcg float64 ;_cee float64 ;_ead *_dc .Creator ;_ebed float64 ;_edf []*paragraph ;_gcfd *paragraph ;_acfd *line ;_bbdd *word ;
_faceg bool ;};func (_gfcc *textboxContext )alignSymbolsVertically (){for _ ,_gffc :=range _gfcc ._edf {for _ ,_dgcb :=range _gffc ._ega {_gdef :=0.0;for _ ,_gbefg :=range _dgcb ._fbfc {for _ ,_bgbfc :=range _gbefg ._afae {if _bgbfc ._gced > _gdef {_gdef =_bgbfc ._gced ;
};};};for _ ,_bfbe :=range _dgcb ._fbfc {for _ ,_fff :=range _bfbe ._afae {if _fff ._fgae < _gdef {_fff ._aaed =_gdef -_fff ._fgae ;};};};};};};type prefixData struct{_ecgf string ;_gbfb bool ;_egce float64 ;_ccf float64 ;};func (_bef *convertContext )getBorderStyle (_egfb *_bba .CT_LineProperties )(_dc .CellBorderStyle ,*_dc .Color ,float64 ){if _egfb ==nil ||_egfb .LineFillPropertiesChoice .NoFill !=nil {return _dc .CellBorderStyleNone ,nil ,0;
};var _gfdab _dc .Color ;if _bade :=_egfb .LineFillPropertiesChoice .SolidFill ;_bade !=nil {_gfdab ,_ =_bef .getColorFromSolidFill (_bade );};_bed :=0.0;if _fagc :=_egfb .WAttr ;_fagc !=nil {_bed =_d .FromEMU (int64 (*_fagc ));};return _dc .CellBorderStyleSingle ,&_gfdab ,_bed ;
};func _ebae (_efba *_bba .CT_TextCharacterProperties ,_efecg *_bba .CT_TableStyleTextStyle )*_bba .CT_TextCharacterProperties {_fgfd :=_bba .NewCT_TextCharacterProperties ();if _efba !=nil {*_fgfd =*_efba ;};if _efecg ==nil {return _fgfd ;};if _fgfd .BAttr ==nil &&_efecg .BAttr !=_bba .ST_OnOffStyleTypeUnset {_ageb :=_efecg .BAttr ==_bba .ST_OnOffStyleTypeOn ;
_fgfd .BAttr =&_ageb ;};if _fgfd .IAttr ==nil &&_efecg .IAttr !=_bba .ST_OnOffStyleTypeUnset {_gggc :=_efecg .IAttr ==_bba .ST_OnOffStyleTypeOn ;_fgfd .IAttr =&_gggc ;};if _fgfd .FillPropertiesChoice .NoFill ==nil &&_fgfd .FillPropertiesChoice .SolidFill ==nil {_fgfd .FillPropertiesChoice .SolidFill =_bba .NewCT_SolidColorFillProperties ();
_fgfd .FillPropertiesChoice .SolidFill .ScrgbClr =_efecg .ScrgbClr ;_fgfd .FillPropertiesChoice .SolidFill .SrgbClr =_efecg .SrgbClr ;_fgfd .FillPropertiesChoice .SolidFill .HslClr =_efecg .HslClr ;_fgfd .FillPropertiesChoice .SolidFill .SysClr =_efecg .SysClr ;
_fgfd .FillPropertiesChoice .SolidFill .SchemeClr =_efecg .SchemeClr ;_fgfd .FillPropertiesChoice .SolidFill .PrstClr =_efecg .PrstClr ;};if _bbdb :=_efecg .ThemeableFontStylesChoice .Font ;_bbdb !=nil &&_fgfd .Latin ==nil &&_fgfd .Ea ==nil &&_fgfd .Cs ==nil {_fgfd .Latin =_bbdb .Latin ;
_fgfd .Ea =_bbdb .Ea ;_fgfd .Cs =_bbdb .Cs ;};return _fgfd ;};func (_abc *textboxContext )newWord (){_abc ._bbdd =&word {_abbb :true ,_gbbg :_abc ._acfd ._cfdgf }};func (_eab *textboxContext )addCurrentWordToParagraph (){if _eab ._faceg &&_eab ._acfd ._cfdgf +_eab ._bbdd ._gga > _eab ._acfd ._aga {_eab .newLine ();
};if !_eab ._bbdd ._abbb ||len (_eab ._acfd ._fbfc )> 0{_eab ._bbdd ._gbbg =_eab ._acfd ._cfdgf ;_eab ._acfd ._fbfc =append (_eab ._acfd ._fbfc ,_eab ._bbdd );_eab ._acfd ._cfdgf +=_eab ._bbdd ._gga ;for _ ,_ebff :=range _eab ._bbdd ._afae {_eab .adjustHeights (_ebff ._gced );
};};};func (_badb *textboxContext )drawParagraphs (){_badb ._ead .NewPage ();for _ ,_fab :=range _badb ._edf {for _ ,_gdfd :=range _fab ._ega {for _ ,_eggfe :=range _gdfd ._fbfc {for _ ,_ceee :=range _eggfe ._afae {_gfb :=_badb ._ead .NewStyledParagraph ();
if _ceee ._fdcad {_ceee ._aaed =0;}else if _ceee ._ebbe {_ceee ._aaed =1.2*_gdfd ._gefg -_ceee ._fgae ;};_eebb :=_eggfe ._gbbg +_ceee ._baee ;_cgbf :=_fab ._aggd +_gdfd ._bbfba +_ceee ._aaed ;_gfb .SetPos (_eebb ,_cgbf );_cbcc :=_gfb .Append (_ceee ._fbbe );
if _ceee ._fgba !=nil {_cbcc .Style =*_ceee ._fgba ;};_badb ._ead .Draw (_gfb );if _ceee ._ebea {_fgag :=_cgbf +_ceee ._fgae +2;_ef .DrawLine (_badb ._ead ,_eebb ,_fgag ,_eebb +_ceee ._gbeg ,_fgag ,1,_ceee ._fgba .Color );};};};};};};func (_aaeb *textboxContext )newParagraph (){_cad :=&paragraph {};
_cad ._aggd =_aaeb ._ebed ;_aaeb ._gcfd =_cad ;};var _deb =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
type paragraph struct{_cgca float64 ;_dage float64 ;_dagd float64 ;_cdgf float64 ;_fcae float64 ;_fbf float64 ;_aggd float64 ;_eggf float64 ;_ebbc _bba .ST_TextAlignType ;_agcb float64 ;_edae bool ;_ega []*line ;};func _bbaa (_eddb *_bba .CT_AdjPoint2D )(float64 ,float64 ){var _gcgdf ,_deeb float64 ;
_cdcdd ,_bbba :=_eddb .XAttr ,_eddb .YAttr ;if _dedf :=_cdcdd .ST_Coordinate ;_dedf !=nil {_gcgdf =_d .FromEMU (_ef .FromSTCoordinate (*_dedf ));};if _edaec :=_bbba .ST_Coordinate ;_edaec !=nil {_deeb =_d .FromEMU (_ef .FromSTCoordinate (*_edaec ));};return _gcgdf ,_deeb ;
};func _eabcf (_gbcc ,_fcgcb *_bba .CT_TableStyleCellStyle )*_bba .CT_TableStyleCellStyle {_edba :=_bba .NewCT_TableStyleCellStyle ();if _gbcc !=nil {*_edba =*_gbcc ;};if _fcgcb ==nil {return _edba ;};if _edba .TcBdr ==nil {_edba .TcBdr =_fcgcb .TcBdr ;
}else {if _edba .TcBdr .Left ==nil {_edba .TcBdr .Left =_fcgcb .TcBdr .Left ;};if _edba .TcBdr .Right ==nil {_edba .TcBdr .Right =_fcgcb .TcBdr .Right ;};if _edba .TcBdr .Top ==nil {_edba .TcBdr .Top =_fcgcb .TcBdr .Top ;};if _edba .TcBdr .Bottom ==nil {_edba .TcBdr .Bottom =_fcgcb .TcBdr .Bottom ;
};if _edba .TcBdr .InsideH ==nil {_edba .TcBdr .InsideH =_fcgcb .TcBdr .InsideH ;};if _edba .TcBdr .InsideV ==nil {_edba .TcBdr .InsideV =_fcgcb .TcBdr .InsideV ;};};if _edba .ThemeableFillStyleChoice .Fill ==nil {_edba .ThemeableFillStyleChoice .Fill =_fcgcb .ThemeableFillStyleChoice .Fill ;
};if _edba .ThemeableFillStyleChoice .FillRef ==nil {_edba .ThemeableFillStyleChoice .FillRef =_fcgcb .ThemeableFillStyleChoice .FillRef ;};return _edba ;};type line struct{_bbfba float64 ;_ggc float64 ;_aga float64 ;_cfdgf float64 ;_gefg float64 ;_fbfc []*word ;
};

// Options contains the options for convert process
type Options struct{

// DefaultPageSize is applied when there is no page size explicitly set in the document.
// A4 is the default option.
DefaultPageSize _ef .PageSize ;};type symbol struct{_fbbe string ;_baee float64 ;_gced float64 ;_fgae float64 ;_aaed float64 ;_gbeg float64 ;_fgba *_dc .TextStyle ;_bgf string ;_fdcad bool ;_ebbe bool ;_ebea bool ;};func (_fef *convertContext )stretchImage (_fag *_dc .Image ,_fcg *_bba .CT_StretchInfoProperties ,_edb ,_eea ,_ebd ,_edde float64 )(*_dc .Image ,float64 ,float64 ){_gcd :=_fcg .FillRect ;
if _gcd ==nil {_ceb :=_fag .Width ()/_fag .Height ();_bbe :=_ebd /_edde ;var _ceba ,_caf float64 ;if _ceb > _bbe {_caf =_edde ;_ceba =_edde *_ceb ;}else {_ceba =_ebd ;_caf =_ebd /_ceb ;};_fag .Scale (_ceba /_fag .Width (),_caf /_fag .Height ());return _fag ,_edb ,_eea ;
};var _bcc ,_cga ,_bgbb ,_bccb float64 ;if _dg :=_gcd .LAttr ;_dg !=nil {_bgbb =_ef .FromSTPercentage (_dg );};if _fcf :=_gcd .TAttr ;_fcf !=nil {_bcc =_ef .FromSTPercentage (_fcf );};if _fbb :=_gcd .RAttr ;_fbb !=nil {_bccb =_ef .FromSTPercentage (_fbb );
};if _edg :=_gcd .BAttr ;_edg !=nil {_cga =_ef .FromSTPercentage (_edg );};_ecbb :=_ebd *(1-_bgbb -_bccb );_edcd :=_edde *(1-_bcc -_cga );_fag .Scale (_ecbb /_fag .Width (),_edcd /_fag .Height ());return _fag ,_edb +_bgbb *_ebd ,_eea +_bcc *_edde ;};func _ada (_cccgb int ,_cfaa bool )string {_dadb :=_bb .NewBuffer ([]byte {});
for _ ,_bbc :=range _deb {for {if _cccgb < _bbc ._aea {break ;};_dadb .WriteString (_bbc ._fdcaa );_cccgb -=_bbc ._aea ;};};_ged :=_dadb .String ();if _cfaa {_ged =_bf .ToUpper (_ged );};return _ged ;};func (_gab *convertContext )tileImage (_bge *_dc .Image ,_gaa *_bba .CT_TileInfoProperties ,_egb ,_cf float64 )*_dc .Image {_aae ,_aebg :=1.0,1.0;
if _egg :=_gaa .SxAttr ;_egg !=nil {_aae =_ef .FromSTPercentage (_egg );};if _cbd :=_gaa .SyAttr ;_cbd !=nil {_aebg =_ef .FromSTPercentage (_cbd );};_edd :=_ef .MakeTempCreator (_egb ,_cf );_bge .Scale (_aae ,_aebg );_fdag ,_fc :=_bge .Width (),_bge .Height ();
var _eeb ,_fdae float64 ;if _bbfg :=_gaa .TxAttr ;_bbfg !=nil {_eeb =_d .FromEMU (_ef .FromSTCoordinate (*_bbfg ));};if _eca :=_gaa .TyAttr ;_eca !=nil {_fdae =_d .FromEMU (_ef .FromSTCoordinate (*_eca ));};if _eeb > 0{_eeb -=_fdag ;};if _fdae > 0{_fdae -=_fc ;
};_gdf :=_gab ._aaab /_fdag +1;_gdac :=_gab ._bae /_fc +1;for _cdc :=0.0;_cdc <=_gdf ;_cdc ++{_egff :=_cdc *_fdag ;for _aaf :=0.0;_aaf <=_gdac ;_aaf ++{_bab :=_aaf *_fc ;_bge .SetPos (_egff +_eeb ,_bab +_fdae );_edd .Draw (_bge );};};_cdcd ,_efe :=_ef .GetPageFromCreator (_edd );
if _efe !=nil {_fd .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_efe );return nil ;};_dcb ,_efe :=_de .NewImageDevice ().Render (_cdcd );
if _efe !=nil {_fd .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_efe );return nil ;};_dbba ,_efe :=_gab ._fefe .NewImageFromGoImage (_dcb );if _efe !=nil {_fd .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_efe );
return nil ;};return _dbba ;};func _geeg (_gacgg ,_efcd *_bba .CT_TextListStyle )*_bba .CT_TextListStyle {_cfcb :=_bba .NewCT_TextListStyle ();if _gacgg !=nil {*_cfcb =*_gacgg ;};if _efcd ==nil {return _cfcb ;};_cfcb .DefPPr =_bdcg (_cfcb .DefPPr ,_efcd .DefPPr );
_cfcb .Lvl1pPr =_bdcg (_cfcb .Lvl1pPr ,_efcd .Lvl1pPr );_cfcb .Lvl2pPr =_bdcg (_cfcb .Lvl2pPr ,_efcd .Lvl2pPr );_cfcb .Lvl3pPr =_bdcg (_cfcb .Lvl3pPr ,_efcd .Lvl3pPr );_cfcb .Lvl4pPr =_bdcg (_cfcb .Lvl4pPr ,_efcd .Lvl4pPr );_cfcb .Lvl5pPr =_bdcg (_cfcb .Lvl5pPr ,_efcd .Lvl5pPr );
_cfcb .Lvl6pPr =_bdcg (_cfcb .Lvl6pPr ,_efcd .Lvl6pPr );_cfcb .Lvl7pPr =_bdcg (_cfcb .Lvl7pPr ,_efcd .Lvl7pPr );_cfcb .Lvl8pPr =_bdcg (_cfcb .Lvl8pPr ,_efcd .Lvl8pPr );_cfcb .Lvl9pPr =_bdcg (_cfcb .Lvl9pPr ,_efcd .Lvl9pPr );return _cfcb ;};var _adbe =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};


// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_ef .FontStyle ;func _bgba (_babd ,_agab *_bba .CT_TextCharacterProperties )*_bba .CT_TextCharacterProperties {_bea :=_bba .NewCT_TextCharacterProperties ();if _babd !=nil {*_bea =*_babd ;};if _agab ==nil {return _bea ;};if _bea .KumimojiAttr ==nil {_bea .KumimojiAttr =_agab .KumimojiAttr ;
};if _bea .LangAttr ==nil {_bea .LangAttr =_agab .LangAttr ;};if _bea .AltLangAttr ==nil {_bea .AltLangAttr =_agab .AltLangAttr ;};if _bea .SzAttr ==nil {_bea .SzAttr =_agab .SzAttr ;};if _bea .BAttr ==nil {_bea .BAttr =_agab .BAttr ;};if _bea .IAttr ==nil {_bea .IAttr =_agab .IAttr ;
};if _bea .UAttr ==_bba .ST_TextUnderlineTypeUnset {_bea .UAttr =_agab .UAttr ;};if _bea .StrikeAttr ==_bba .ST_TextStrikeTypeUnset {_bea .StrikeAttr =_agab .StrikeAttr ;};if _bea .KernAttr ==nil {_bea .KernAttr =_agab .KernAttr ;};if _bea .CapAttr ==_bba .ST_TextCapsTypeUnset {_bea .CapAttr =_agab .CapAttr ;
};if _bea .SpcAttr ==nil {_bea .SpcAttr =_agab .SpcAttr ;};if _bea .NormalizeHAttr ==nil {_bea .NormalizeHAttr =_agab .NormalizeHAttr ;};if _bea .BaselineAttr ==nil {_bea .BaselineAttr =_agab .BaselineAttr ;};if _bea .NoProofAttr ==nil {_bea .NoProofAttr =_agab .NoProofAttr ;
};if _bea .DirtyAttr ==nil {_bea .DirtyAttr =_agab .DirtyAttr ;};if _bea .ErrAttr ==nil {_bea .ErrAttr =_agab .ErrAttr ;};if _bea .SmtCleanAttr ==nil {_bea .SmtCleanAttr =_agab .SmtCleanAttr ;};if _bea .SmtIdAttr ==nil {_bea .SmtIdAttr =_agab .SmtIdAttr ;
};if _bea .BmkAttr ==nil {_bea .BmkAttr =_agab .BmkAttr ;};if _bea .Ln ==nil {_bea .Ln =_agab .Ln ;};if _bea .FillPropertiesChoice .NoFill ==nil {_bea .FillPropertiesChoice .NoFill =_agab .FillPropertiesChoice .NoFill ;};if _bea .FillPropertiesChoice .SolidFill ==nil {_bea .FillPropertiesChoice .SolidFill =_agab .FillPropertiesChoice .SolidFill ;
};if _bea .FillPropertiesChoice .BlipFill ==nil {_bea .FillPropertiesChoice .BlipFill =_agab .FillPropertiesChoice .BlipFill ;};if _bea .EffectPropertiesChoice .EffectLst ==nil {_bea .EffectPropertiesChoice .EffectLst =_agab .EffectPropertiesChoice .EffectLst ;
};if _bea .EffectPropertiesChoice .EffectDag ==nil {_bea .EffectPropertiesChoice .EffectDag =_agab .EffectPropertiesChoice .EffectDag ;};if _bea .Highlight ==nil {_bea .Highlight =_agab .Highlight ;};if _bea .TextUnderlineLineChoice .ULnTx ==nil {_bea .TextUnderlineLineChoice .ULnTx =_agab .TextUnderlineLineChoice .ULnTx ;
};if _bea .TextUnderlineLineChoice .ULn ==nil {_bea .TextUnderlineLineChoice .ULn =_agab .TextUnderlineLineChoice .ULn ;};if _bea .TextUnderlineFillChoice .UFillTx ==nil {_bea .TextUnderlineFillChoice .UFillTx =_agab .TextUnderlineFillChoice .UFillTx ;
};if _bea .TextUnderlineFillChoice .UFill ==nil {_bea .TextUnderlineFillChoice .UFill =_agab .TextUnderlineFillChoice .UFill ;};if _bea .Latin ==nil {_bea .Latin =_agab .Latin ;};if _bea .Ea ==nil {_bea .Ea =_agab .Ea ;};if _bea .Cs ==nil {_bea .Cs =_agab .Cs ;
};if _bea .Sym ==nil {_bea .Sym =_agab .Sym ;};if _bea .Rtl ==nil {_bea .Rtl =_agab .Rtl ;};return _bea ;};func (_aca *convertContext )getColorFromFontReference (_fggd *_bba .CT_FontReference )_dc .Color {var _gacg _dc .Color ;var _egcc string ;if _deg :=_fggd .SrgbClr ;
_deg !=nil {_egcc =_deg .ValAttr ;}else if _cdbg :=_fggd .SchemeClr ;_cdbg !=nil {_egcc =_ef .GetColorStringFromDmlColor (_aca ._eebg .GetColorBySchemeColor (_cdbg .ValAttr ));_egcc =_ef .AdjustColor (_egcc ,_cdbg .EG_ColorTransform );};if _egcc !=""{_gacg =_dc .ColorRGBFromHex ("\u0023"+_egcc );
};return _gacg ;};func (_dede *convertContext )getStyleColors (_abe *_bba .CT_ShapeStyle )(_dc .Color ,_dc .Color ,_dc .Color ){var _cdfb ,_afbe ,_efef _dc .Color ;if _efac :=_abe .LnRef ;_efac !=nil {_afbe =_dede .getColorFromMatrixReference (_efac );
};if _bcgg :=_abe .FillRef ;_bcgg !=nil {_efef =_dede .getColorFromMatrixReference (_bcgg );};if _fdfe :=_abe .FontRef ;_fdfe !=nil {_cdfb =_dede .getColorFromFontReference (_fdfe );};return _cdfb ,_efef ,_afbe ;};func (_gfcb *textboxContext )addPrefix (_edcc *prefixData ,_gbgb *_dc .TextStyle ){_afac :=_fdbg (_edcc ._ecgf );
_gbeb :=*_gbgb ;if _edcc ._gbfb {_gbeb .Font =_ef .AssignStdFontByName (_gbeb ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_bgbbc :=range _afac {_bgbbc ._fgba =&_gbeb ;_gfcb .addTextSymbol (_bgbbc );};_aggc :=-(_edcc ._ccf +_gfcb ._bbdd ._gga );if _aggc < 0{_aggc =0;
};_aacd :=&symbol {_fbbe :"\u0020",_gbeg :_aggc };_gfcb .addTextSymbol (_aacd );_gfcb ._bbdd ._gbbg +=(_edcc ._ccf +_edcc ._egce );};func (_dbbd *convertContext )renderPageWithDrawableToGoImage (_aadc _dc .Drawable )(_c .Image ,error ){_ggbc :=_ef .MakeTempCreator (_dbbd ._aaab ,_dbbd ._bae );
_ggbc .NewPage ();_ggbc .Draw (_aadc );_agbeg ,_eedc :=_ef .GetPageFromCreator (_ggbc );if _eedc !=nil {return nil ,_eedc ;};return _de .NewImageDevice ().Render (_agbeg );};func (_ace *convertContext )makeStyleFromRPr (_cfbb *_bba .CT_TextCharacterProperties )(*_dc .TextStyle ,bool ,bool ,bool ){var _ggba ,_eefc ,_cbcd bool ;
_ebe :=_ace ._fefe .NewTextStyle ();if _cfbb !=nil {_dcd :=_ef .FontStyle_Regular ;_fbg :=_bfee (_cfbb .BAttr );_afd :=_bfee (_cfbb .IAttr );if _fbg &&_afd {_dcd =_ef .FontStyle_BoldItalic ;}else if _fbg {_dcd =_ef .FontStyle_Bold ;}else if _afd {_dcd =_ef .FontStyle_Italic ;
};_cbcd =_cfbb .UAttr !=_bba .ST_TextUnderlineTypeUnset &&_cfbb .UAttr !=_bba .ST_TextUnderlineTypeNone ;_bbgg :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _ddgf :=_cfbb .Latin ;_ddgf !=nil {_bbgg =_ddgf .TypefaceAttr ;}else if _cafe :=_cfbb .Ea ;_cafe !=nil {_bbgg =_cafe .TypefaceAttr ;
}else if _acfe :=_cfbb .Cs ;_acfe !=nil {_bbgg =_acfe .TypefaceAttr ;}else if _dda :=_cfbb .Sym ;_dda !=nil {_bbgg =_dda .TypefaceAttr ;};if _cdb ,_dgac :=_ef .StdFontsMap [_bbgg ];_dgac {_ebe .Font =_ef .AssignStdFontByName (_ebe ,_cdb [_dcd ]);}else if _adcb :=_ef .GetRegisteredFont (_bbgg ,_dcd );
_adcb !=nil {_ebe .Font =_adcb ;}else {_fd .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_bbgg ,_dcd );
_ebe .Font =_ef .AssignStdFontByName (_ebe ,_ef .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_dcd ]);};var _cbf float64 ;if _ded :=_cfbb .SzAttr ;_ded !=nil {_cbf =_cg .Round (float64 (*_ded )/100)-0.5;}else {_cbf =_ef .DefaultFontSize ;};if _gfe :=_cfbb .BaselineAttr ;
_gfe !=nil {if _abg :=_gfe .ST_PercentageDecimal ;_abg !=nil {if *_abg > 0{_ggba =true ;}else if *_abg < 0{_eefc =true ;};};};if _ggba ||_eefc {_cbf =_cg .Round (_cbf *0.64);};_ebe .FontSize =_cbf ;_gee :=0.0;if _cdaf :=_cfbb .SpcAttr ;_cdaf !=nil {if _afad :=_cdaf .ST_TextPointUnqualified ;
_afad !=nil &&*_afad > 0{_gee =float64 (*_afad )/100;};};_ebe .CharSpacing =_gee ;};return &_ebe ,_ggba ,_eefc ,_cbcd ;};func (_fce *convertContext )getShapes (_aecf *_aac .CT_Shape ,_cdcg bool ,_bcg bool )[]_dc .Drawable {_dge :=[]_dc .Drawable {};_cc :=_aecf .SpPr ;
if _cc ==nil {return _dge ;};var _gdab bool ;if _ebb :=_aecf .UseBgFillAttr ;_ebb !=nil {_gdab =*_ebb ;};_gaad ,_fcb ,_bafc ,_cba ,_bgbd ,_agg ,_fdaa :=_fce .getShapesFromSpPr (_cc ,_aecf .Style ,_gdab ,0.0,0.0);if !_bcg {_dge =append (_dge ,_gaad ...);
};if _bgg :=_aecf .TxBody ;_bgg !=nil &&!_cdcg {_fdg ,_bbfb ,_aba ,_ebg ,_egdg ,_gegf :=_fce .getPhData (_aecf );if _bcg &&!(_ebg ||_egdg ){return _dge ;};if _fdg !=nil &&!_fdaa {_fcb ,_bafc ,_cba ,_bgbd =_ef .GetDataFromXfrm (_fdg );};_bcf ,_gde :=_fce .makePdfBlockFromTxBody (_bgg ,_bbfb ,_aba ,_cba ,_bgbd ,_agg ,_ebg ,_gegf );
if _gde !=nil {_fd .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_gde );
}else if _bcf !=nil {_bcf .SetPos (_fcb ,_bafc );_dge =append (_dge ,_bcf );};};return _dge ;};var _gc =_badeg (1.9);

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_aa .Presentation )*_dc .Creator {return ConvertToPdfWithOptions (pr ,nil )};func (_cdea *textboxContext )adjustHeights (_eba float64 ){if _cdea ._acfd ._gefg < _eba {_cdea ._gcfd ._eggf +=(_eba -_cdea ._acfd ._gefg );_cdea ._acfd ._gefg =_eba ;
};};func (_bdb *convertContext )getGroupConnectors (_bad *_aac .CT_Connector ,_ea float64 ,_adgc float64 )[]_dc .Drawable {_dfg ,_ ,_ ,_ ,_ ,_ ,_ :=_bdb .getShapesFromSpPr (_bad .SpPr ,_bad .Style ,false ,_ea ,_adgc );return _dfg ;};func (_dfa *convertContext )getColorFromSolidFill (_gfad *_bba .CT_SolidColorFillProperties )(_dc .Color ,float64 ){if _gfad ==nil {return nil ,1;
};var _ddgcd string ;_dagg :=1.0;if _dafe :=_gfad .SrgbClr ;_dafe !=nil {_ddgcd =_dafe .ValAttr ;_dagg =_ef .GetOpacityFromColorTransform (_dafe .EG_ColorTransform );}else if _dcbd :=_gfad .SchemeClr ;_dcbd !=nil {_ddgcd =_ef .GetColorStringFromDmlColor (_dfa ._ffca .GetColorBySchemeColor (_dcbd .ValAttr ));
_ddgcd =_ef .AdjustColor (_ddgcd ,_dcbd .EG_ColorTransform );_dagg =_ef .GetOpacityFromColorTransform (_dcbd .EG_ColorTransform );};if _ddgcd !=""{_ecbcd :=_dc .ColorRGBFromHex ("\u0023"+_ddgcd );return _ecbcd ,_dagg ;};return nil ,1;};func (_adec *convertContext )applyBlipEffectsOnImg (_dgfa *_dc .Image ,_dbbb ,_cbgd float64 ,_dbf []*_bba .CT_BlipChoice )*_dc .Image {if len (_dbf )==0{return _dgfa ;
};_dgfa .SetPos (_dbbb ,_cbgd );_ddd ,_gacc :=_adec .renderPageWithDrawableToGoImage (_dgfa );if _gacc !=nil {_fd .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_gacc );
return _dgfa ;};_eagb ,_gacc :=_adec .renderCurrentStateToGoImage ();if _gacc !=nil {_fd .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_gacc );
return _dgfa ;};_cbde :=_ddd .Bounds ();_dgec :=_c .NewRGBA (_cbde );_gfbg ,_eggd :=_dgfa .Width (),_dgfa .Height ();for _ ,_ebc :=range _dbf {if _fbge :=_ebc .AlphaModFix ;_fbge ==nil {continue ;};if _ddac :=_ebc .AlphaModFix .AmtAttr ;_ddac !=nil {if _bffb :=_ddac .ST_PositivePercentageDecimal ;
_bffb !=nil {_fgca :=uint8 (255*(*_bffb )/100000);_abcfa :=_c .NewUniform (_b .Alpha {_fgca });_a .Draw (_dgec ,_cbde ,_eagb ,_c .Point {0,0},_a .Src );_a .DrawMask (_dgec ,_cbde ,_ddd ,_c .Point {0,0},_abcfa ,_c .Point {0,0},_a .Over );};};};_aded :=_c .Rect (int (_dbbb ),int (_cbgd ),int (_dbbb +_gfbg )+1,int (_cbgd +_eggd )+1);
_ffgc :=_ef .CropImageByRect (_dgec ,_aded );_dbfg ,_gacc :=_adec ._fefe .NewImageFromGoImage (_ffgc );if _gacc !=nil {_fd .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_gacc );
return _dgfa ;};return _dbfg ;};func (_ad *convertContext )addShapes (_aff *_aac .CT_CommonSlideData ,_db bool ){if _aff ==nil {return ;};_gec :=&background {};if _ffa :=_aff .Bg ;_ffa !=nil {if _ceg :=_ffa .BackgroundChoice .BgPr ;_ceg !=nil {if _ceg .FillPropertiesChoice .NoFill ==nil {if _df :=_ceg .FillPropertiesChoice .SolidFill ;
_df !=nil {_gf ,_ag :=_ad .getColorFromSolidFill (_df );if _gf !=nil {_gec ._cccgg =_gf ;_gec ._dgfd =_ag ;};}else if _ab :=_ceg .FillPropertiesChoice .BlipFill ;_ab !=nil {_gec ._gdgg =_ab ;};};};};_ad ._fegdf =_gec ;if _bda :=_aff .SpTree ;_bda !=nil {for _ ,_ed :=range _bda .GroupShapeChoice {if _ed !=nil {if _ed .Sp !=nil {_aeb :=_ad .getShapes (_ed .Sp ,_db ,false );
_ad ._aeddc =append (_ad ._aeddc ,_aeb ...);};if _ed .GraphicFrame !=nil {var _dca ,_bbf ,_fea ,_cgd float64 ;if _fdb :=_ed .GraphicFrame .Xfrm ;_fdb !=nil {_dca ,_bbf ,_fea ,_cgd =_ef .GetDataFromXfrm (_fdb );};if _fea ==0&&_cgd ==0{_fea =_ad ._aaab ;
_cgd =_ad ._bae ;};if _ecb :=_ed .GraphicFrame .Graphic ;_ecb !=nil {if _be :=_ecb .GraphicData ;_be !=nil {for _ ,_aacc :=range _be .Any {if _gfg ,_da :=_aacc .(*_cb .Chart );_da {_eb ,_acd :=_ad .makePdfBlockFromChart (_gfg ,_fea ,_cgd );if _acd !=nil {_fd .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_acd );
};if _eb !=nil {_eb .SetPos (_dca ,_bbf );_ad ._aeddc =append (_ad ._aeddc ,_eb );};}else if _edc ,_bgb :=_aacc .(*_bba .Tbl );_bgb {_ga :=_ad .makePdfBlockFromTable (_edc );if _ga !=nil {_dd :=_dc .NewBlock (_fea ,_cgd );_dd .SetPos (_dca ,_bbf );_fa :=_dd .Draw (_ga );
if _fa !=nil {_fd .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0064r\u0061\u0077\u0020\u0074\u0061b\u006c\u0065\u003a\u0020\u0025\u0073",_fa );if _fa ==_dc .ErrContentNotFit {_dd =_dc .NewBlock (_ad ._aaab -1.5*_dca ,_ad ._bae -1.5*_bbf );_dd .SetPos (_dca ,_bbf );
_fa =_dd .Draw (_ga );};};if _fa ==nil {_ad ._aeddc =append (_ad ._aeddc ,_dd );};};};};};};};if _ed .CxnSp !=nil {_dab :=_ad .getConnectors (_ed .CxnSp );_ad ._aeddc =append (_ad ._aeddc ,_dab ...);};if _ed .GrpSp !=nil {_gbf :=0.0;_dbb :=0.0;if _cdg :=_ed .GrpSp .GrpSpPr .Xfrm ;
_cdg !=nil {_gbf ,_dbb =_ef .GetGroupOffsetFromXfrm (_cdg );};for _ ,_bag :=range _ed .GrpSp .GroupShapeChoice {if _bag .CxnSp !=nil {_ede :=_ad .getGroupConnectors (_bag .CxnSp ,_gbf ,_dbb );_ad ._aeddc =append (_ad ._aeddc ,_ede ...);};};};if _ed .Pic !=nil {_dbg :=false ;
var _gd ,_dfc ,_gcf ,_ee float64 ;if _bce :=_ed .Pic .SpPr ;_bce !=nil {if _aee :=_bce .Xfrm ;_aee !=nil {_gd ,_dfc ,_gcf ,_ee =_ef .GetDataFromXfrm (_aee );_dbg =true ;};};var _egd _aac .ST_PlaceholderType ;var _aace *uint32 ;if _cbcf :=_ed .Pic .NvPicPr ;
_cbcf !=nil {if _gcb :=_cbcf .NvPr ;_gcb !=nil {if _ffg :=_gcb .Ph ;_ffg !=nil {_egd =_ffg .TypeAttr ;_aace =_ffg .IdxAttr ;};};};_gbg ,_ ,_ ,_ ,_ :=_dfag (_ad ._aadf .CSld ,_egd ,_aace );_afbb ,_ ,_ ,_ ,_ :=_dfag (_ad ._egdc .CSld ,_egd ,_aace );if _afbb ==nil {_afbb =_gbg ;
};if _afbb !=nil &&!_dbg {_gd ,_dfc ,_gcf ,_ee =_ef .GetDataFromXfrm (_afbb );};if _aec :=_ed .Pic .BlipFill ;_aec !=nil {_cda :=_ad .getShapeFromBlipFill (_aec ,_gd ,_dfc ,_gcf ,_ee ,_db );_ad ._aeddc =append (_ad ._aeddc ,_cda );};};};};};};func (_gccb *textboxContext )addCurrentParagraph (){_gccb ._ebed =_gccb ._gcfd ._aggd +_gccb ._gcfd ._dage +_gccb ._gcfd ._eggf +_gccb ._gcfd ._dagd ;
_gccb ._edf =append (_gccb ._edf ,_gccb ._gcfd );_gccb .alignParagraph ();};func (_dbe *textboxContext )addTextSymbol (_ebeb *symbol ){_bcgf :=_dc .New ();_ege :=_bcgf .NewStyledParagraph ();_ege .SetMargins (0,0,0,0);_cde :=_ege .Append (_ebeb ._fbbe );
_geff :=0.0;if _ebeb ._fgba !=nil {_cde .Style =*_ebeb ._fgba ;if _ebeb ._fgba .CharSpacing !=0{_geff =_ebeb ._fgba .CharSpacing ;};};_ebeb ._fgae =_ege .Height ();_ebeb ._gced =_ege .Height ()*1.2;if _ebeb ._gbeg ==0{_ebeb ._gbeg =_ege .Width ()+_geff ;
};if len (_dbe ._bbdd ._afae )> 0{_cfaf :=_dbe ._bbdd ._afae [len (_dbe ._bbdd ._afae )-1]._fbbe ;if _dbe ._gcfd ._edae ||_ef .IsNoSpaceLanguage (_cfaf )||(_cfaf =="\u0020")!=(_ebeb ._fbbe =="\u0020"){_dbe .addCurrentWordToParagraph ();_dbe .newWord ();
};};_dbe ._bbdd ._afae =append (_dbe ._bbdd ._afae ,_ebeb );_ebeb ._baee =_dbe ._bbdd ._gga ;_dbe ._bbdd ._gga +=_ebeb ._gbeg ;if _ebeb ._fbbe !="\u0020"{_dbe ._bbdd ._abbb =false ;};if _dbe ._bbdd ._gga >=_dbe ._gcfd ._fbf -_dbe ._gcfd ._fcae {_dbe .addCurrentWordToParagraph ();
_dbe .newLine ();_dbe .newWord ();};};func _add (_edgc ,_eac *_bba .CT_TextBodyProperties )*_bba .CT_TextBodyProperties {_ggcg :=_bba .NewCT_TextBodyProperties ();if _edgc !=nil {*_ggcg =*_edgc ;};if _eac ==nil {return _ggcg ;};if _ggcg .RotAttr ==nil {_ggcg .RotAttr =_eac .RotAttr ;
};if _ggcg .SpcFirstLastParaAttr ==nil {_ggcg .SpcFirstLastParaAttr =_eac .SpcFirstLastParaAttr ;};if _ggcg .VertOverflowAttr ==_bba .ST_TextVertOverflowTypeUnset {_ggcg .VertOverflowAttr =_eac .VertOverflowAttr ;};if _ggcg .HorzOverflowAttr ==_bba .ST_TextHorzOverflowTypeUnset {_ggcg .HorzOverflowAttr =_eac .HorzOverflowAttr ;
};if _ggcg .VertAttr ==_bba .ST_TextVerticalTypeUnset {_ggcg .VertAttr =_eac .VertAttr ;};if _ggcg .WrapAttr ==_bba .ST_TextWrappingTypeUnset {_ggcg .WrapAttr =_eac .WrapAttr ;};if _ggcg .LInsAttr ==nil {_ggcg .LInsAttr =_eac .LInsAttr ;};if _ggcg .TInsAttr ==nil {_ggcg .TInsAttr =_eac .TInsAttr ;
};if _ggcg .RInsAttr ==nil {_ggcg .RInsAttr =_eac .RInsAttr ;};if _ggcg .BInsAttr ==nil {_ggcg .BInsAttr =_eac .BInsAttr ;};if _ggcg .NumColAttr ==nil {_ggcg .NumColAttr =_eac .NumColAttr ;};if _ggcg .SpcColAttr ==nil {_ggcg .SpcColAttr =_eac .SpcColAttr ;
};if _ggcg .RtlColAttr ==nil {_ggcg .RtlColAttr =_eac .RtlColAttr ;};if _ggcg .AnchorAttr ==_bba .ST_TextAnchoringTypeUnset {_ggcg .AnchorAttr =_eac .AnchorAttr ;};if _ggcg .AnchorCtrAttr ==nil {_ggcg .AnchorCtrAttr =_eac .AnchorCtrAttr ;};if _ggcg .ForceAAAttr ==nil {_ggcg .ForceAAAttr =_eac .ForceAAAttr ;
};if _ggcg .UprightAttr ==nil {_ggcg .UprightAttr =_eac .UprightAttr ;};if _ggcg .CompatLnSpcAttr ==nil {_ggcg .CompatLnSpcAttr =_eac .CompatLnSpcAttr ;};if _ggcg .PrstTxWarp ==nil {_ggcg .PrstTxWarp =_eac .PrstTxWarp ;};if _ggcg .TextAutofitChoice .NoAutofit ==nil {_ggcg .TextAutofitChoice .NoAutofit =_eac .TextAutofitChoice .NoAutofit ;
};if _ggcg .TextAutofitChoice .NormAutofit ==nil {_ggcg .TextAutofitChoice .NormAutofit =_eac .TextAutofitChoice .NormAutofit ;};if _ggcg .TextAutofitChoice .SpAutoFit ==nil {_ggcg .TextAutofitChoice .SpAutoFit =_eac .TextAutofitChoice .SpAutoFit ;};if _ggcg .Scene3d ==nil {_ggcg .Scene3d =_eac .Scene3d ;
};if _ggcg .Text3DChoice .Sp3d ==nil {_ggcg .Text3DChoice .Sp3d =_eac .Text3DChoice .Sp3d ;};if _ggcg .Text3DChoice .FlatTx ==nil {_ggcg .Text3DChoice .FlatTx =_eac .Text3DChoice .FlatTx ;};if _ggcg .ExtLst ==nil {_ggcg .ExtLst =_eac .ExtLst ;};return _ggcg ;
};func (_eeaf *convertContext )getShapeFromBlipFill (_egae *_bba .CT_BlipFillProperties ,_fdfc ,_ebad ,_agbd ,_egfa float64 ,_egcg bool )_dc .Drawable {_bbgb ,_gbea ,_dcea :=_eeaf .makePdfImageFromBlipFill (_egae ,_egcg );if _dcea !=nil {_fd .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_dcea );
return nil ;};if _bbgb ==nil {return nil ;};if _dggc :=_egae .FillModePropertiesChoice .Tile ;_dggc !=nil {_bbgb =_eeaf .tileImage (_bbgb ,_egae .FillModePropertiesChoice .Tile ,_agbd ,_egfa );};if _ecgfa :=_egae .FillModePropertiesChoice .Stretch ;_ecgfa !=nil {_bbgb ,_fdfc ,_ebad =_eeaf .stretchImage (_bbgb ,_egae .FillModePropertiesChoice .Stretch ,_fdfc ,_ebad ,_agbd ,_egfa );
};if _bbgb ==nil {return nil ;};if len (_gbea )==0{_bbgb .SetPos (_fdfc ,_ebad );return _bbgb ;};_bbgb =_eeaf .applyBlipEffectsOnImg (_bbgb ,_fdfc ,_ebad ,_gbea );_bbgb .SetPos (_fdfc ,_ebad );return _bbgb ;};func (_efb *convertContext )makePdfBlockFromChart (_bg *_cb .Chart ,_fda ,_efc float64 )(*_dc .Block ,error ){_ba :=_bg .CT_RelId .IdAttr ;
_fe :=_efb ._ffca .GetChartSpaceByRelId (_ba );if _fe ==nil {return nil ,_eg .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _egf *_bba .Theme ;_ec :=_efb ._eebg .Themes ();if len (_ec )> 0{_egf =_ec [0];};
return _ef .MakeBlockFromChartSpace (_fe ,_fda ,_efc ,_egf );};func (_fecc *textboxContext )alignParagraphsVertically (_gfac _bba .ST_TextAnchoringType ){if _gfac ==_bba .ST_TextAnchoringTypeT {return ;};_bdcc :=0.0;for _ ,_cgcb :=range _fecc ._edf {_bdcc +=_cgcb ._dage +_cgcb ._eggf +_cgcb ._dagd ;
};var _ffgg float64 ;switch _gfac {case _bba .ST_TextAnchoringTypeCtr :_ffgg =(_fecc ._cee -_bdcc )/2;case _bba .ST_TextAnchoringTypeB :_ffgg =_fecc ._cee -_bdcc ;};for _ ,_bggg :=range _fecc ._edf {_bggg ._aggd +=_ffgg ;};};func _bff (_bcb float64 )float64 {return _bcb *_d .Inch };
type background struct{_cccgg _dc .Color ;_dgfd float64 ;_gdgg *_bba .CT_BlipFillProperties ;};func (_fcbb *convertContext )getColorFromMatrixReference (_feed *_bba .CT_StyleMatrixReference )_dc .Color {if _feed ==nil {return nil ;};var _fgda _dc .Color ;
var _dggf string ;if _fagf :=_feed .SrgbClr ;_fagf !=nil {_dggf =_fagf .ValAttr ;}else if _fedg :=_feed .SchemeClr ;_fedg !=nil {_dggf =_ef .GetColorStringFromDmlColor (_fcbb ._eebg .GetColorBySchemeColor (_fedg .ValAttr ));_dggf =_ef .AdjustColor (_dggf ,_fedg .EG_ColorTransform );
};if _dggf !=""{_fgda =_dc .ColorRGBFromHex ("\u0023"+_dggf );};return _fgda ;};func (_egfg *line )moveRight (_eaab float64 ){for _ ,_bbb :=range _egfg ._fbfc {_bbb ._gbbg +=_eaab ;};};func (_bfab *convertContext )renderCurrentStateToGoImage ()(_c .Image ,error ){_gcgdfg :=_ef .MakeTempCreator (_bfab ._aaab ,_bfab ._bae );
_gcgdfg .NewPage ();for _ ,_ccca :=range _bfab ._aeddc {if _ccca !=nil {_gcgdfg .MoveTo (0,0);_gcgdfg .Draw (_ccca );};};_cagf ,_gbcd :=_ef .GetPageFromCreator (_gcgdfg );if _gbcd !=nil {return nil ,_gbcd ;};return _de .NewImageDevice ().Render (_cagf );
};func _dadf (_dfe *_bba .CT_TableCellProperties ,_gea *_bba .CT_TableStyleCellStyle ,_fedcd ,_fgde ,_bafe ,_cca bool )*_bba .CT_TableCellProperties {_dabf :=_bba .NewCT_TableCellProperties ();if _dfe !=nil {*_dabf =*_dfe ;};if _gea ==nil {return _dabf ;
};if _gcag :=_gea .ThemeableFillStyleChoice .FillRef ;_gcag !=nil {_cbb :=_bba .NewCT_SolidColorFillProperties ();_cbb .ScrgbClr =_gcag .ScrgbClr ;_cbb .SrgbClr =_gcag .SrgbClr ;_cbb .HslClr =_gcag .HslClr ;_cbb .SysClr =_gcag .SysClr ;_cbb .SchemeClr =_gcag .SchemeClr ;
_cbb .PrstClr =_gcag .PrstClr ;_dabf .FillPropertiesChoice .SolidFill =_cbb ;};if _dabf .FillPropertiesChoice .NoFill ==nil &&_dabf .FillPropertiesChoice .SolidFill ==nil {if _cfgc :=_gea .ThemeableFillStyleChoice .Fill ;_cfgc !=nil {if _dabf .FillPropertiesChoice .NoFill ==nil {_dabf .FillPropertiesChoice .NoFill =_cfgc .FillPropertiesChoice .NoFill ;
};if _dabf .FillPropertiesChoice .SolidFill ==nil {_dabf .FillPropertiesChoice .SolidFill =_cfgc .FillPropertiesChoice .SolidFill ;};};};if _dgea :=_gea .TcBdr ;_dgea !=nil {if _dabf .LnL ==nil {var _cfdc *_bba .CT_ThemeableLineStyle ;if _bafe {_cfdc =_dgea .Left ;
}else {_cfdc =_dgea .InsideV ;};if _cfdc !=nil {_dabf .LnL =_cfdc .ThemeableLineStyleChoice .Ln ;};};if _dabf .LnR ==nil {var _caca *_bba .CT_ThemeableLineStyle ;if _cca {_caca =_dgea .Right ;}else {_caca =_dgea .InsideV ;};if _caca !=nil {_dabf .LnR =_caca .ThemeableLineStyleChoice .Ln ;
};};if _dabf .LnT ==nil {var _ggag *_bba .CT_ThemeableLineStyle ;if _fedcd {_ggag =_dgea .Top ;}else {_ggag =_dgea .InsideH ;};if _ggag !=nil {_dabf .LnT =_ggag .ThemeableLineStyleChoice .Ln ;};};if _dabf .LnB ==nil {var _agee *_bba .CT_ThemeableLineStyle ;
if _fgde {_agee =_dgea .Bottom ;}else {_agee =_dgea .InsideH ;};if _agee !=nil {_dabf .LnB =_agee .ThemeableLineStyleChoice .Ln ;};};};return _dabf ;};func _bcffg (_dgcg int ,_cbga bool )string {_cff :=(_dgcg -1)/26+1;_dcbf :=byte ((_dgcg -1)%26);if _cbga {_dcbf +=byte (65);
}else {_dcbf +=byte (97);};_aedg :=_bb .NewBuffer ([]byte {});for _gcgf :=0;_gcgf < _cff ;_gcgf ++{_aedg .Write ([]byte {_dcbf });};return _aedg .String ();};func _fdbg (_gdg string )[]*symbol {_fdd :=[]*symbol {};for _ ,_fedf :=range _gdg {_fdd =append (_fdd ,&symbol {_fbbe :string (_fedf )});
};return _fdd ;};func (_bgfg *convertContext )getPhData (_abbg *_aac .CT_Shape )(*_bba .CT_Transform2D ,*_bba .CT_TextBodyProperties ,*_bba .CT_TextListStyle ,bool ,bool ,bool ){_bbdg ,_ggbg :=_ddag (_abbg );_gdefd ,_eag ,_fcaed ,_gbbf ,_bcef :=_dfag (_bgfg ._aadf .CSld ,_bbdg ,_ggbg );
_dfgb ,_gcdgg ,_bbaae ,_cbff ,_bfc :=_dfag (_bgfg ._egdc .CSld ,_bbdg ,_ggbg );if _dfgb ==nil {_dfgb =_gdefd ;};_cfcbb ,_abcf :=_gceae (_gcdgg ,_eag );var _dcc ,_efefd ,_bfa bool ;if _bbaae ==nil {if _fcaed !=nil {_dcc =*_fcaed ;};}else {_dcc =*_bbaae ;
};if _bfc ==nil {if _bcef !=nil {_bfa =*_bcef ;};}else {_bfa =*_bfc ;};if _cbff ==nil {if _gbbf !=nil {_efefd =*_gbbf ;};}else {_efefd =*_cbff ;};return _dfgb ,_cfcbb ,_abcf ,_dcc ,_efefd ,_bfa ;};func _dfag (_eabc *_aac .CT_CommonSlideData ,_cdeag _aac .ST_PlaceholderType ,_ccce *uint32 )(*_bba .CT_Transform2D ,*_bba .CT_TextBody ,*bool ,*bool ,*bool ){_fbef :=_ccce ==nil ;
if _eabc !=nil &&(_cdeag !=_aac .ST_PlaceholderTypeUnset ||!_fbef ){if _bcee :=_eabc .SpTree ;_bcee !=nil {for _ ,_bfbac :=range _bcee .GroupShapeChoice {if _bfbac !=nil {if _bfbac .Sp !=nil {_cec ,_gad :=_ddag (_bfbac .Sp );if _cdeag ==_cec {if (_fbef &&_gad ==nil )||(!_fbef &&_gad !=nil &&*_gad ==*_ccce ){var _cdgga *_bba .CT_Transform2D ;
if _bfbac .Sp .SpPr !=nil {_cdgga =_bfbac .Sp .SpPr .Xfrm ;};_egbg :=_cdeag ==_aac .ST_PlaceholderTypeTitle ||_cdeag ==_aac .ST_PlaceholderTypeCtrTitle ;_dcae :=_cdeag ==_aac .ST_PlaceholderTypeSubTitle ;_affb :=!_egbg &&_cdeag !=_aac .ST_PlaceholderTypeUnset ;
return _cdgga ,_bfbac .Sp .TxBody ,&_egbg ,&_dcae ,&_affb ;};};};};};};};return nil ,nil ,nil ,nil ,nil ;};func (_edac *convertContext )getInfoFromLn (_cafc *_bba .CT_LineProperties )(_dc .Color ,float64 ,float64 ){if _cafc ==nil ||_cafc .LineFillPropertiesChoice .NoFill !=nil {return nil ,0,0;
};var _cdfg float64 ;_fggdb ,_gacf :=_edac .getColorFromSolidFill (_cafc .LineFillPropertiesChoice .SolidFill );if _bagc :=_cafc .WAttr ;_bagc !=nil {_cdfg =_d .FromEMU (int64 (*_bagc ));}else {_cdfg =1;};return _fggdb ,_cdfg ,_gacf ;};func (_eeac *convertContext )getConnectors (_caff *_aac .CT_Connector )[]_dc .Drawable {_dbc ,_ ,_ ,_ ,_ ,_ ,_ :=_eeac .getShapesFromSpPr (_caff .SpPr ,_caff .Style ,false ,0.0,0.0);
return _dbc ;};func (_ffad *convertContext )makePdfBlockFromTable (_abbd *_bba .Tbl )*_dc .Table {_fdc :=_abbd .TblGrid ;if _fdc ==nil {return nil ;};_cfdg :=len (_fdc .GridCol );if _cfdg ==0{return nil ;};_ebdd :=[]float64 {};_dcag :=0.0;for _ ,_aafd :=range _fdc .GridCol {_efcb :=_d .FromEMU (_ef .FromSTCoordinate (_aafd .WAttr ));
_ebdd =append (_ebdd ,_efcb );_dcag +=_efcb ;};_ggg :=[]float64 {};for _dcf :=0;_dcf < _cfdg ;_dcf ++{_ggg =append (_ggg ,_ebdd [_dcf ]/_dcag );};_fga :=_ffad ._fefe .NewTable (_cfdg );_fga .SetColumnWidths (_ggg ...);_fcd :=_abbd .TblPr ;var _ddgc *_bba .CT_TableStyle ;
if _agbc :=_fcd .TablePropertiesChoice ;_agbc !=nil {if _agbc .TableStyle !=nil {_ddgc =_agbc .TableStyle ;}else if _agbc .TableStyleId !=nil {_ddgc =_ffad ._eebg .GetTableStyleById (*_agbc .TableStyleId );};};_dgc :=_bba .NewCT_TablePartStyle ();_dgc .TcStyle =_bba .NewCT_TableStyleCellStyle ();
_dgc .TcTxStyle =_bba .NewCT_TableStyleTextStyle ();if _ddgc !=nil {if _ddgc .WholeTbl !=nil {*_dgc =*_ddgc .WholeTbl ;};if _ddgc .TblBg !=nil {if _dgc .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_dgc .TcStyle .ThemeableFillStyleChoice .Fill =_ddgc .TblBg .ThemeableFillStyleChoice .Fill ;
};};};if _dgc .TcStyle .ThemeableFillStyleChoice .Fill ==nil {_dgc .TcStyle .ThemeableFillStyleChoice .Fill =_bba .NewCT_FillProperties ();_dgc .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .NoFill =_fcd .FillPropertiesChoice .NoFill ;
_dgc .TcStyle .ThemeableFillStyleChoice .Fill .FillPropertiesChoice .SolidFill =_fcd .FillPropertiesChoice .SolidFill ;};_bdee :=len (_abbd .Tr );_ggf :=_abbd .TblPr .BandRowAttr !=nil &&*_abbd .TblPr .BandRowAttr ;_gef :=_abbd .TblPr .FirstRowAttr !=nil &&*_abbd .TblPr .FirstRowAttr ;
_bgdd :=_abbd .TblPr .LastRowAttr !=nil &&*_abbd .TblPr .LastRowAttr ;_eee :=_abbd .TblPr .BandColAttr !=nil &&*_abbd .TblPr .BandColAttr ;_geb :=_abbd .TblPr .FirstColAttr !=nil &&*_abbd .TblPr .FirstColAttr ;_ecd :=_abbd .TblPr .LastColAttr !=nil &&*_abbd .TblPr .LastColAttr ;
for _gegg ,_ade :=range _abbd .Tr {_cgg :=_gegg ==0;_fge :=_gegg ==_bdee -1;_gbe :=_gegg %2==0;_fdce :=len (_ade .Tc );var _facb *_bba .CT_TablePartStyle ;if _ddgc !=nil {if _cgg &&_gef {_facb =_ddgc .FirstRow ;}else if _fge &&_bgdd {_facb =_ddgc .LastRow ;
}else if _gbe &&_ggf {_facb =_ddgc .Band2H ;}else if _ggf {_facb =_ddgc .Band1H ;};};var _ebdg float64 ;for _fddf ,_feag :=range _ade .Tc {_eeba :=_fddf ==0;_cge :=_fddf ==_fdce -1;_bfed :=_fddf %2==0;var _acfg *_bba .CT_TablePartStyle ;if _ddgc !=nil {if _eeba &&_geb {_acfg =_ddgc .FirstCol ;
}else if _cge &&_ecd {_acfg =_ddgc .LastCol ;}else if _bfed &&_eee {_acfg =_ddgc .Band2V ;}else if _eee {_acfg =_ddgc .Band1V ;};};_gcfb :=_dged (_dged (_acfg ,_facb ),_dgc );_efbc :=_ffad .addCellToTable (_fga ,_feag ,_gcfb ,_cgg ,_fge ,_eeba ,_cge );
if _efbc > _ebdg {_ebdg =_efbc ;};};_edee :=_d .FromEMU (_ef .FromSTCoordinate (_ade .HAttr ));if _edee < _ebdg {_edee =_ebdg ;};if _edee < _badeg (4){_edee =_badeg (4);};_fga .SetRowHeight (_fga .CurRow (),_edee );};return _fga ;};func (_cbc *convertContext )extractDefaultProperties (){_ac :=_cbc ._eebg .X ();
_bd :=_ac .DefaultTextStyle ;var _dce ,_fb ,_ae ,_ca ,_bdg ,_efd ,_cag ,_cef ,_efce ,_ff *_bba .CT_TextParagraphProperties ;if _bd !=nil {_dce =_bd .DefPPr ;_fb =_bdcg (_bd .Lvl1pPr ,_dce );_ae =_bdcg (_bd .Lvl2pPr ,_dce );_ca =_bdcg (_bd .Lvl3pPr ,_dce );
_bdg =_bdcg (_bd .Lvl4pPr ,_dce );_efd =_bdcg (_bd .Lvl5pPr ,_dce );_cag =_bdcg (_bd .Lvl6pPr ,_dce );_cef =_bdcg (_bd .Lvl7pPr ,_dce );_efce =_bdcg (_bd .Lvl8pPr ,_dce );_ff =_bdcg (_bd .Lvl9pPr ,_dce );_cbc ._fcgb =_dce ;_cbc ._dafc =_dce .DefRPr ;};
_cbc ._dgg =make ([]*_bba .CT_TextParagraphProperties ,9);_cbc ._dgg [0]=_fb ;_cbc ._dgg [1]=_ae ;_cbc ._dgg [2]=_ca ;_cbc ._dgg [3]=_bdg ;_cbc ._dgg [4]=_efd ;_cbc ._dgg [5]=_cag ;_cbc ._dgg [6]=_cef ;_cbc ._dgg [7]=_efce ;_cbc ._dgg [8]=_ff ;_bbg :=_cbc ._eebg .SlideMasters ()[0].X ();
_geg :=_bbg .TxStyles ;_aab :=_geg .TitleStyle ;_cbc ._becd =_bdcg (_aab .DefPPr ,_dce );_cbc ._efg =_cbc ._becd .DefRPr ;_cbc ._gfc =make ([]*_bba .CT_TextParagraphProperties ,9);_cbc ._gfc [0]=_bdcg (_aab .Lvl1pPr ,_fb );_cbc ._gfc [1]=_bdcg (_aab .Lvl2pPr ,_ae );
_cbc ._gfc [2]=_bdcg (_aab .Lvl3pPr ,_ca );_cbc ._gfc [3]=_bdcg (_aab .Lvl4pPr ,_bdg );_cbc ._gfc [4]=_bdcg (_aab .Lvl5pPr ,_efd );_cbc ._gfc [5]=_bdcg (_aab .Lvl6pPr ,_cag );_cbc ._gfc [6]=_bdcg (_aab .Lvl7pPr ,_cef );_cbc ._gfc [7]=_bdcg (_aab .Lvl8pPr ,_efce );
_cbc ._gfc [8]=_bdcg (_aab .Lvl9pPr ,_ff );_gcc :=_geg .BodyStyle ;_cbc ._cgc =_bdcg (_gcc .DefPPr ,_dce );_cbc ._bedb =_cbc ._cgc .DefRPr ;_cbc ._bee =make ([]*_bba .CT_TextParagraphProperties ,9);_cbc ._bee [0]=_bdcg (_gcc .Lvl1pPr ,_fb );_cbc ._bee [1]=_bdcg (_gcc .Lvl2pPr ,_ae );
_cbc ._bee [2]=_bdcg (_gcc .Lvl3pPr ,_ca );_cbc ._bee [3]=_bdcg (_gcc .Lvl4pPr ,_bdg );_cbc ._bee [4]=_bdcg (_gcc .Lvl5pPr ,_efd );_cbc ._bee [5]=_bdcg (_gcc .Lvl6pPr ,_cag );_cbc ._bee [6]=_bdcg (_gcc .Lvl7pPr ,_cef );_cbc ._bee [7]=_bdcg (_gcc .Lvl8pPr ,_efce );
_cbc ._bee [8]=_bdcg (_gcc .Lvl9pPr ,_ff );};func _gceae (_caeg ,_fcgbg *_bba .CT_TextBody )(*_bba .CT_TextBodyProperties ,*_bba .CT_TextListStyle ){if _caeg ==nil &&_fcgbg ==nil {return nil ,nil ;};if _caeg ==nil {return _fcgbg .BodyPr ,_fcgbg .LstStyle ;
};if _fcgbg ==nil {return _caeg .BodyPr ,_caeg .LstStyle ;};_bgad ,_gfgb :=_caeg .BodyPr ,_caeg .LstStyle ;_fbcc ,_bca :=_fcgbg .BodyPr ,_fcgbg .LstStyle ;_eaea :=_add (_bgad ,_fbcc );_ecbbg :=_geeg (_gfgb ,_bca );return _eaea ,_ecbbg ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_bc .PdfFont ){_ef .RegisterFont (name ,style ,font );};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _ef .RegisterFontsFromDirectory (dirName )};type symbolStyle struct{_eae *string ;_bbae *float64 ;_fgg *string ;_cfde *bool ;_cgcc *bool ;_ebbee *bool ;_dfcdg *bool ;_gfef *bool ;};func (_gbgf *convertContext )makePdfBlockFromTxBody (_ccg *_bba .CT_TextBody ,_fca *_bba .CT_TextBodyProperties ,_efae *_bba .CT_TextListStyle ,_eefg ,_gbc float64 ,_fecg _dc .Color ,_ccgg ,_gba bool )(*_dc .Block ,error ){var _bga *_bba .CT_TextParagraphProperties ;
if _bcgd :=_ccg .LstStyle ;_bcgd !=nil {var _fbdc *_bba .CT_TextParagraphProperties ;if _bcgd .Lvl1pPr !=nil {_fbdc =_bcgd .Lvl1pPr ;};_bga =_bdcg (_fbdc ,_bcgd .DefPPr );};var _bfb *_bba .CT_TextParagraphProperties ;if _bga !=nil {if _ccgg {_bfb =_gbgf ._gfc [0];
}else if _gba {_bfb =_gbgf ._bee [0];}else {_bfb =_gbgf ._dgg [0];};if _efae !=nil {_bfb =_bdcg (_bdcg (_efae .Lvl1pPr ,_efae .DefPPr ),_bfb );};_bfb =_bdcg (_bga ,_bfb );}else {if _ccgg {_bfb =_gbgf ._becd ;}else if _gba {_bfb =_gbgf ._cgc ;}else {_bfb =_gbgf ._fcgb ;
};};_bged ,_afga :=_badeg (2.5),_badeg (2.5);_bcd ,_aada :=_badeg (1.3),_badeg (1.3);_abb :=true ;_gce :=_bba .ST_TextAnchoringTypeT ;if _fca !=nil {if _bfba :=_fca .AnchorAttr ;_bfba !=_bba .ST_TextAnchoringTypeUnset {_gce =_bfba ;};};if _ffcb :=_ccg .BodyPr ;
_ffcb !=nil {if _ffb :=_ffcb .LInsAttr ;_ffb !=nil {_bged =_d .FromEMU (_ef .FromSTCoordinate32 (*_ffb ));};if _afaa :=_ffcb .TInsAttr ;_afaa !=nil {_bcd =_d .FromEMU (_ef .FromSTCoordinate32 (*_afaa ));};if _ced :=_ffcb .RInsAttr ;_ced !=nil {_afga =_d .FromEMU (_ef .FromSTCoordinate32 (*_ced ));
};if _cbgg :=_ffcb .BInsAttr ;_cbgg !=nil {_aada =_d .FromEMU (_ef .FromSTCoordinate32 (*_cbgg ));};_abb =_ffcb .WrapAttr !=_bba .ST_TextWrappingTypeNone ;if _aaaf :=_ffcb .AnchorAttr ;_aaaf !=_bba .ST_TextAnchoringTypeUnset {_gce =_ffcb .AnchorAttr ;};
};_efbd :=_ef .MakeTempCreator (_eefg ,_gbc );_efbd .SetPageMargins (_bged ,_afga ,_bcd ,_aada );_bec :=&textboxContext {_cae :_gbgf ,_faceg :_abb ,_fdcg :_eefg -_bged -_afga ,_cee :_gbc -_bcd -_aada ,_ead :_efbd ,_edf :[]*paragraph {}};_efea :=1;for _ ,_feb :=range _ccg .P {if _feb !=nil {_bcff :=_feb .PPr ;
var _bggb *prefixData ;if _bcff !=nil &&_bcff .TextBulletChoice .BuNone ==nil {var _bcfc string ;var _cdce bool ;if _ddg :=_bcff .TextBulletChoice .BuAutoNum ;_ddg !=nil {var _dac string ;if _bbee :=_ddg .StartAtAttr ;_bbee !=nil {_efea =int (*_bbee );
};var _age string ;switch _ddg .TypeAttr {case _bba .ST_TextAutonumberSchemeAlphaUcParenBoth ,_bba .ST_TextAutonumberSchemeAlphaUcParenR ,_bba .ST_TextAutonumberSchemeAlphaUcPeriod :_age =_bcffg (_efea ,true );case _bba .ST_TextAutonumberSchemeAlphaLcParenBoth ,_bba .ST_TextAutonumberSchemeAlphaLcParenR ,_bba .ST_TextAutonumberSchemeAlphaLcPeriod :_age =_bcffg (_efea ,false );
case _bba .ST_TextAutonumberSchemeRomanUcParenBoth ,_bba .ST_TextAutonumberSchemeRomanUcParenR ,_bba .ST_TextAutonumberSchemeRomanUcPeriod :_age =_ada (_efea ,true );case _bba .ST_TextAutonumberSchemeRomanLcParenBoth ,_bba .ST_TextAutonumberSchemeRomanLcParenR ,_bba .ST_TextAutonumberSchemeRomanLcPeriod :_age =_ada (_efea ,false );
default:_age =_f .Itoa (_efea );};switch _ddg .TypeAttr {case _bba .ST_TextAutonumberSchemeAlphaLcPeriod ,_bba .ST_TextAutonumberSchemeAlphaUcPeriod ,_bba .ST_TextAutonumberSchemeArabicPeriod ,_bba .ST_TextAutonumberSchemeRomanLcPeriod ,_bba .ST_TextAutonumberSchemeRomanUcPeriod ,_bba .ST_TextAutonumberSchemeArabicDbPeriod ,_bba .ST_TextAutonumberSchemeEa1ChsPeriod ,_bba .ST_TextAutonumberSchemeEa1ChtPeriod ,_bba .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_bba .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_bba .ST_TextAutonumberSchemeThaiAlphaPeriod ,_bba .ST_TextAutonumberSchemeThaiNumPeriod ,_bba .ST_TextAutonumberSchemeHindiAlphaPeriod ,_bba .ST_TextAutonumberSchemeHindiNumPeriod ,_bba .ST_TextAutonumberSchemeHindiAlpha1Period :_dac ="\u002e";
case _bba .ST_TextAutonumberSchemeAlphaLcParenR ,_bba .ST_TextAutonumberSchemeAlphaUcParenR ,_bba .ST_TextAutonumberSchemeArabicParenR ,_bba .ST_TextAutonumberSchemeRomanLcParenR ,_bba .ST_TextAutonumberSchemeRomanUcParenR ,_bba .ST_TextAutonumberSchemeThaiAlphaParenR ,_bba .ST_TextAutonumberSchemeThaiNumParenR ,_bba .ST_TextAutonumberSchemeHindiNumParenR :_dac ="\u0029";
};_bcfc =_age +_dac ;_efea ++;}else if _fgf :=_bcff .TextBulletChoice .BuChar ;_fgf !=nil {_accf :=_fgf .CharAttr ;if _fae ,_dgf :=_adbe [_accf ];_dgf {_accf =string (rune (_fae ));}else {_accf ="\u2022";};_bcfc =_accf ;_cdce =true ;};if _bcfc !=""{var _agf ,_babf float64 ;
if _bcff .MarLAttr !=nil {_agf =_d .FromEMU (int64 (*_bcff .MarLAttr ));};if _bcff .IndentAttr !=nil {_babf =_d .FromEMU (int64 (*_bcff .IndentAttr ));};_bggb =&prefixData {_ecgf :_bcfc ,_gbfb :_cdce ,_egce :_agf ,_ccf :_babf };};};_bcff =_bdcg (_bcff ,_bfb );
_bgd :=_bgba (_feb .EndParaRPr ,_bcff .DefRPr );_bec .newParagraph ();_bec .assignPropsToCurrentParagraph (_bcff );_bec .newLine ();_bec .newWord ();for _bage ,_dfcd :=range _feb .EG_TextRun {_bec .addTextRun (_dfcd ,_bgd ,_fecg ,_bggb );if _bage > 0{_bggb =nil ;
};};_bec .addCurrentWordToParagraph ();};_bec .addCurrentParagraph ();};_bec .alignVertically (_gce );_bec .drawParagraphs ();return _ef .MakeBlockFromCreator (_efbd );};type romanMatch struct{_aea int ;_fdcaa string ;};func _bdcg (_fggg ,_ebab *_bba .CT_TextParagraphProperties )*_bba .CT_TextParagraphProperties {_bafb :=_bba .NewCT_TextParagraphProperties ();
if _fggg !=nil {*_bafb =*_fggg ;};if _ebab ==nil {return _bafb ;};if _bafb .MarLAttr ==nil {_bafb .MarLAttr =_ebab .MarLAttr ;};if _bafb .MarRAttr ==nil {_bafb .MarRAttr =_ebab .MarRAttr ;};if _bafb .LvlAttr ==nil {_bafb .LvlAttr =_ebab .LvlAttr ;};if _bafb .IndentAttr ==nil {_bafb .IndentAttr =_ebab .IndentAttr ;
};if _bafb .AlgnAttr ==_bba .ST_TextAlignTypeUnset {_bafb .AlgnAttr =_ebab .AlgnAttr ;};if _bafb .DefTabSzAttr ==nil {_bafb .DefTabSzAttr =_ebab .DefTabSzAttr ;};if _bafb .RtlAttr ==nil {_bafb .RtlAttr =_ebab .RtlAttr ;};if _bafb .EaLnBrkAttr ==nil {_bafb .EaLnBrkAttr =_ebab .EaLnBrkAttr ;
};if _bafb .FontAlgnAttr ==_bba .ST_TextFontAlignTypeUnset {_bafb .FontAlgnAttr =_ebab .FontAlgnAttr ;};if _bafb .LatinLnBrkAttr ==nil {_bafb .LatinLnBrkAttr =_ebab .LatinLnBrkAttr ;};if _bafb .HangingPunctAttr ==nil {_bafb .HangingPunctAttr =_ebab .HangingPunctAttr ;
};if _bafb .LnSpc ==nil {_bafb .LnSpc =_ebab .LnSpc ;};if _bafb .SpcBef ==nil {_bafb .SpcBef =_ebab .SpcBef ;};if _bafb .SpcAft ==nil {_bafb .SpcAft =_ebab .SpcAft ;};if _bafb .TextBulletColorChoice .BuClrTx ==nil {_bafb .TextBulletColorChoice .BuClrTx =_ebab .TextBulletColorChoice .BuClrTx ;
};if _bafb .TextBulletColorChoice .BuClr ==nil {_bafb .TextBulletColorChoice .BuClr =_ebab .TextBulletColorChoice .BuClr ;};if _bafb .TextBulletSizeChoice .BuSzTx ==nil {_bafb .TextBulletSizeChoice .BuSzTx =_ebab .TextBulletSizeChoice .BuSzTx ;};if _bafb .TextBulletSizeChoice .BuSzPct ==nil {_bafb .TextBulletSizeChoice .BuSzPct =_ebab .TextBulletSizeChoice .BuSzPct ;
};if _bafb .TextBulletSizeChoice .BuSzPts ==nil {_bafb .TextBulletSizeChoice .BuSzPts =_ebab .TextBulletSizeChoice .BuSzPts ;};if _bafb .TextBulletTypefaceChoice .BuFontTx ==nil {_bafb .TextBulletTypefaceChoice .BuFontTx =_ebab .TextBulletTypefaceChoice .BuFontTx ;
};if _bafb .TextBulletTypefaceChoice .BuFont ==nil {_bafb .TextBulletTypefaceChoice .BuFont =_ebab .TextBulletTypefaceChoice .BuFont ;};if _bafb .TextBulletChoice .BuNone ==nil {_bafb .TextBulletChoice .BuNone =_ebab .TextBulletChoice .BuNone ;};if _bafb .TextBulletChoice .BuAutoNum ==nil {_bafb .TextBulletChoice .BuAutoNum =_ebab .TextBulletChoice .BuAutoNum ;
};if _bafb .TextBulletChoice .BuChar ==nil {_bafb .TextBulletChoice .BuChar =_ebab .TextBulletChoice .BuChar ;};if _bafb .TextBulletChoice .BuBlip ==nil {_bafb .TextBulletChoice .BuBlip =_ebab .TextBulletChoice .BuBlip ;};if _bafb .TabLst ==nil {_bafb .TabLst =_ebab .TabLst ;
};if _bafb .ExtLst ==nil {_bafb .ExtLst =_ebab .ExtLst ;};_bafb .DefRPr =_bgba (_bafb .DefRPr ,_ebab .DefRPr );return _bafb ;};func _gcdc (_dceg ,_egceg *_bba .CT_TableStyleTextStyle )*_bba .CT_TableStyleTextStyle {_ccgf :=_bba .NewCT_TableStyleTextStyle ();
if _dceg !=nil {*_ccgf =*_dceg ;};if _egceg ==nil {return _ccgf ;};if _ccgf .BAttr ==_bba .ST_OnOffStyleTypeUnset {_ccgf .BAttr =_egceg .BAttr ;};if _ccgf .IAttr ==_bba .ST_OnOffStyleTypeUnset {_ccgf .IAttr =_egceg .IAttr ;};if _ccgf .ThemeableFontStylesChoice .Font ==nil {_ccgf .ThemeableFontStylesChoice .Font =_egceg .ThemeableFontStylesChoice .Font ;
};if _ccgf .ThemeableFontStylesChoice .FontRef ==nil {_ccgf .ThemeableFontStylesChoice .FontRef =_egceg .ThemeableFontStylesChoice .FontRef ;};if _ccgf .ScrgbClr ==nil {_ccgf .ScrgbClr =_egceg .ScrgbClr ;};if _ccgf .SrgbClr ==nil {_ccgf .SrgbClr =_egceg .SrgbClr ;
};if _ccgf .HslClr ==nil {_ccgf .HslClr =_egceg .HslClr ;};if _ccgf .SysClr ==nil {_ccgf .SysClr =_egceg .SysClr ;};if _ccgf .SchemeClr ==nil {_ccgf .SchemeClr =_egceg .SchemeClr ;};if _ccgf .PrstClr ==nil {_ccgf .PrstClr =_egceg .PrstClr ;};return _ccgf ;
};func (_gggg *textboxContext )assignPropsToCurrentParagraph (_edad *_bba .CT_TextParagraphProperties ){_gegd :=12.4;if _edad ==nil {_gggg ._gcfd ._agcb =_gegd ;return ;};if _dbgg :=_edad .DefRPr ;_dbgg !=nil {_gbca :=_dbgg .SzAttr ;if _gbca !=nil {_agga :=float64 (*_gbca )/1200;
if _gegd <=_agga {_gegd =_agga ;};};};if _efag :=_edad .MarLAttr ;_efag !=nil {_gggg ._gcfd ._fcae =_d .FromEMU (int64 (*_efag ));};_gggg ._gcfd ._fbf =_gggg ._fdcg ;if _cgccb :=_edad .MarRAttr ;_cgccb !=nil {_gggg ._gcfd ._fbf -=_d .FromEMU (int64 (*_cgccb ));
};if _dfdd :=_edad .IndentAttr ;_dfdd !=nil {_gggg ._gcfd ._cdgf =_d .FromEMU (int64 (*_dfdd ));};if _dcac :=_edad .LatinLnBrkAttr ;_dcac !=nil {_gggg ._gcfd ._edae =*_dcac ;};if _gaac :=_edad .LnSpc ;_gaac !=nil &&_gaac .TextSpacingChoice !=nil {if _eebcg :=_gaac .TextSpacingChoice .SpcPct ;
_eebcg !=nil {if _bedd :=_eebcg .ValAttr .ST_TextSpacingPercent ;_bedd !=nil {_gegd =float64 (*_bedd )/5000;};};};var _gcec float64 ;if _eeag :=_edad .SpcBef ;_eeag !=nil &&_eeag .TextSpacingChoice !=nil {if _acec :=_eeag .TextSpacingChoice .SpcPts ;_acec !=nil {_gcec =float64 (_acec .ValAttr )/100;
};};_gac :=_gggg ._edf ;if len (_gac )> 0{_gcec -=_gac [len (_gac )-1]._dagd ;if _gcec < 0{_gcec =0;};};_gggg ._gcfd ._dage =_gcec ;if _fcaa :=_edad .SpcAft ;_fcaa !=nil &&_fcaa .TextSpacingChoice !=nil {if _fdbb :=_fcaa .TextSpacingChoice .SpcPts ;_fdbb !=nil {_gggg ._gcfd ._dagd =float64 (_fdbb .ValAttr )/100;
};};_gggg ._gcfd ._agcb =_gegd ;_gggg ._gcfd ._ebbc =_edad .AlgnAttr ;};func (_ebf *convertContext )getShapesFromSpPr (_fbe *_bba .CT_ShapeProperties ,_ccc *_bba .CT_ShapeStyle ,_cfa bool ,_fdf float64 ,_gecc float64 )([]_dc .Drawable ,float64 ,float64 ,float64 ,float64 ,_dc .Color ,bool ){_abd :=[]_dc .Drawable {};
var _fegc ,_cea ,_afbg ,_cfd ,_cdgd float64 ;var _bceb ,_fbbb ,_bdd ,_cgb _dc .Color ;var _gca *_bba .CT_BlipFillProperties ;_fcgd ,_ecg :=1.0,1.0;if _ccc !=nil {_bceb ,_fbbb ,_cgb =_ebf .getStyleColors (_ccc );};if _ebgg :=_fbe .Ln ;_ebgg !=nil {if _ebgg .LineFillPropertiesChoice .NoFill !=nil {_bdd ,_cdgd =nil ,0;
}else {_bdd ,_cdgd ,_fcgd =_ebf .getInfoFromLn (_ebgg );if _bdd ==nil {_bdd =_cgb ;};};};if _fbe .FillPropertiesChoice .NoFill !=nil {_fbbb ,_ecg =nil ,0;}else if _cfa {_fbbb =_ebf ._fegdf ._cccgg ;_ecg =_ebf ._fegdf ._dgfd ;_gca =_ebf ._fegdf ._gdgg ;
}else if _dcad :=_fbe .FillPropertiesChoice .SolidFill ;_dcad !=nil {_fbbb ,_ecg =_ebf .getColorFromSolidFill (_dcad );};var _agd bool ;if _ggb :=_fbe .Xfrm ;_ggb !=nil {_fegc ,_cea ,_afbg ,_cfd =_ef .GetDataFromXfrm (_ggb );_fegc +=_fdf ;_cea +=_gecc ;
_agd =true ;};if _afg :=_fbe .GeometryChoice .CustGeom ;_afg !=nil {_afa :=[]_g .Point {};_ffgd ,_cdgg :=1.0,1.0;if _eed :=_afg .PathLst ;_eed !=nil {for _ ,_gcg :=range _eed .Path {if _gcg !=nil {if _dga :=_gcg .WAttr ;_dga !=nil {_ffgd =_afbg /_d .FromEMU (*_dga );
};if _ffgb :=_gcg .HAttr ;_ffgb !=nil {_cdgg =_cfd /_d .FromEMU (*_ffgb );};for _ ,_gfda :=range _gcg .Path2DChoice {if _gfda .Close !=nil {};if _ggd :=_gfda .MoveTo ;_gfda .MoveTo !=nil {if _ggd !=nil &&_ggd .Pt !=nil {_ffc ,_fde :=_bbaa (_ggd .Pt );_afa =append (_afa ,_g .Point {X :_ffc *_ffgd +_fegc ,Y :_fde *_cdgg +_cea });
};};if _deea :=_gfda .LnTo ;_deea !=nil &&_deea .Pt !=nil {_fed ,_acdc :=_bbaa (_deea .Pt );_afa =append (_afa ,_g .Point {X :_fed *_ffgd +_fegc ,Y :_acdc *_cdgg +_cea });};};_bfe :=_ebf ._fefe .NewPolygon ([][]_g .Point {_afa });_bfe .SetFillColor (_fbbb );
_bfe .SetFillOpacity (_ecg );_bfe .SetBorderWidth (_cdgd );if _bdd !=nil {_bfe .SetBorderColor (_bdd );_bfe .SetBorderOpacity (_fcgd );};_abd =append (_abd ,_bfe );};};};};if _cbg :=_fbe .GeometryChoice .PrstGeom ;_cbg !=nil {switch _cbg .PrstAttr {case _bba .ST_ShapeTypeRect :if _gca !=nil {_cebad :=_ebf .getShapeFromBlipFill (_gca ,_fegc ,_cea ,_afbg ,_cfd ,false );
_abd =append (_abd ,_cebad );}else {_fagd :=_ebf ._fefe .NewRectangle (_fegc ,_cea ,_afbg ,_cfd );_cfc :=_fbbb !=nil &&_ecg > 0;if _cfc {_fagd .SetFillColor (_fbbb );_fagd .SetFillOpacity (_ecg );};_eeda :=_bdd !=nil &&_fcgd > 0&&_cdgd > 0;if _eeda {_fagd .SetBorderWidth (_cdgd );
_fagd .SetBorderColor (_bdd );_fagd .SetBorderOpacity (_fcgd );};if _cfc ||_eeda {_abd =append (_abd ,_fagd );};};case _bba .ST_ShapeTypeLine :_gff :=_ebf ._fefe .NewLine (_fegc ,_cea ,_fegc +_afbg ,_cea +_cfd );_gff .SetLineWidth (_cdgd );if _bdd !=nil {_gff .SetColor (_bdd );
};_abd =append (_abd ,_gff );};};return _abd ,_fegc ,_cea ,_afbg ,_cfd ,_bceb ,_agd ;};func (_caa *convertContext )makeSlide (){_aef :=_caa ._ffca .GetSlideLayout ().CSld ;_caa .addShapes (_aef ,true );_aef =_caa ._ffca .X ().CSld ;_caa .addShapes (_aef ,false );
};func (_agb *convertContext )drawSlide (){_agb ._fefe .NewPage ();for _ ,_agc :=range _agb ._aeddc {if _agc !=nil {_agb ._fefe .MoveTo (0,0);_agb ._fefe .Draw (_agc );};};};func _badeg (_eebcd float64 )float64 {return _eebcd *_d .Millimeter };func (_abbe *convertContext )addCellToTable (_dfge *_dc .Table ,_efcg *_bba .CT_TableCell ,_bceg *_bba .CT_TablePartStyle ,_face ,_gebc ,_fddd ,_adf bool )float64 {var _gggd *_dc .TableCell ;
_aegg :=1;if _efcg .GridSpanAttr !=nil {_aegg =int (*_efcg .GridSpanAttr );};_gggd =_dfge .MultiColCell (_aegg );_daf :=_efcg .TcPr ;var _dde *_bba .CT_TableStyleTextStyle ;if _bceg !=nil {_daf =_dadf (_daf ,_bceg .TcStyle ,_face ,_gebc ,_fddd ,_adf );
_dde =_bceg .TcTxStyle ;};_cbdf :=_gc ;_cdab :=_dc .CellVerticalAlignmentMiddle ;_afc :=_bff (0.05);_gfa :=_bff (0.05);if _daf !=nil {if _cbfb :=_daf .LnL ;_cbfb !=nil {_gcea ,_dad ,_aadab :=_abbe .getBorderStyle (_cbfb );_gggd .SetBorder (_dc .CellBorderSideLeft ,_gcea ,_aadab );
if _dad !=nil &&*_dad !=nil {_gggd .SetSideBorderColor (_dc .CellBorderSideLeft ,*_dad );};};if _adb :=_daf .LnT ;_adb !=nil {_ceda ,_fdca ,_cdfe :=_abbe .getBorderStyle (_adb );_gggd .SetBorder (_dc .CellBorderSideTop ,_ceda ,_cdfe );if _fdca !=nil &&*_fdca !=nil {_gggd .SetSideBorderColor (_dc .CellBorderSideTop ,*_fdca );
};};if _dcgb :=_daf .LnR ;_dcgb !=nil {_gbef ,_cgdc ,_ffbg :=_abbe .getBorderStyle (_dcgb );_gggd .SetBorder (_dc .CellBorderSideRight ,_gbef ,_ffbg );if _cgdc !=nil &&*_cgdc !=nil {_gggd .SetSideBorderColor (_dc .CellBorderSideRight ,*_cgdc );};};if _gfgf :=_daf .LnB ;
_gfgf !=nil {_gceb ,_fegd ,_acfb :=_abbe .getBorderStyle (_gfgf );_gggd .SetBorder (_dc .CellBorderSideBottom ,_gceb ,_acfb );if _fegd !=nil &&*_fegd !=nil {_gggd .SetSideBorderColor (_dc .CellBorderSideBottom ,*_fegd );};};if _ddgb :=_daf .MarLAttr ;_ddgb !=nil {_cbdf =float64 (_ef .FromSTCoordinate32 (*_ddgb ));
};switch _daf .AnchorAttr {case _bba .ST_TextAnchoringTypeT :_cdab =_dc .CellVerticalAlignmentTop ;case _bba .ST_TextAnchoringTypeB :_cdab =_dc .CellVerticalAlignmentBottom ;};if _daf .FillPropertiesChoice .NoFill ==nil {if _faf :=_daf .FillPropertiesChoice .SolidFill ;
_faf !=nil {_cbfe ,_afe :=_abbe .getColorFromSolidFill (_faf );_gggd .SetOpacity (_afe );_gggd .SetBackgroundColor (_cbfe );};};if _aade :=_daf .MarBAttr ;_aade !=nil {_afc =float64 (_ef .FromSTCoordinate32 (*_aade ));};if _caaf :=_daf .MarTAttr ;_caaf !=nil {_gfa =float64 (_ef .FromSTCoordinate32 (*_caaf ));
};};_gggd .SetVerticalAlignment (_cdab );_gggd .SetIndent (_cbdf );var _dag float64 ;if _dfb :=_efcg .TxBody ;_dfb !=nil {_fedc :=_abbe .makePdfDivisionFromTxBody (_dfb ,_dde );_dag =_fedc .Height ()+_gfa +_afc ;_gggd .SetContent (_fedc );};return _dag ;
};func (_ffbd *textboxContext )addTextRun (_faa *_bba .EG_TextRun ,_bbgga *_bba .CT_TextCharacterProperties ,_ccfe _dc .Color ,_dade *prefixData ){if _cggb :=_faa .TextRunChoice .Br ;_cggb !=nil {_ffbd .addCurrentWordToParagraph ();_ffbd .newLine ();_ffbd .newWord ();
}else if _dcgd :=_faa .TextRunChoice .R ;_dcgd !=nil {var _gdaa _dc .Color ;if _dcgd .RPr !=nil &&_dcgd .RPr .FillPropertiesChoice .SolidFill !=nil {_gdaa ,_ =_ffbd ._cae .getColorFromSolidFill (_dcgd .RPr .FillPropertiesChoice .SolidFill );}else if _ccfe !=nil {_gdaa =_ccfe ;
}else if _bbgga .FillPropertiesChoice .SolidFill !=nil {_gdaa ,_ =_ffbd ._cae .getColorFromSolidFill (_bbgga .FillPropertiesChoice .SolidFill );}else {_gdaa =_dc .ColorBlack ;};_agbe :=_bgba (_dcgd .RPr ,_bbgga );_ebeg ,_bfg ,_acea ,_cbfec :=_ffbd ._cae .makeStyleFromRPr (_agbe );
_ebeg .Color =_gdaa ;if _dade !=nil {_ffbd .addPrefix (_dade ,_ebeg );};_accc :=_fdbg (_dcgd .T );for _ ,_gbff :=range _accc {_gbff ._fgba =_ebeg ;_gbff ._fdcad =_bfg ;_gbff ._ebbe =_acea ;_gbff ._ebea =_cbfec ;if _agbe .CapAttr ==_bba .ST_TextCapsTypeAll {_gbff ._fbbe =_bf .ToUpper (_gbff ._fbbe );
};_ffbd .addTextSymbol (_gbff );};};};